var b4w="object"===typeof b4w?b4w:function(a){var p={};a.module=p;var e={};a.register=function(a,c){p[a]||(p[a]=c)};a.require=function(a,c){if(!p[a])throw Error('Module "'+a+'" not found');c=c||"__b4w_default";e[c]||(e[c]=function(a){return function(b){var c=p[b];if(!c)throw Error('Module "'+b+'" not found');c.oj||(c.oj={});c.oj[a]||(c.oj[a]={},c(c.oj[a],e[a]));return c.oj[a]}}(c));return e[c](a)};a.module_check=function(a){return p[a]?!0:!1};a.get_namespace=function(a){for(var c in e)if(e[c]==a)return c;
return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});"object"==typeof module&&module.Ko&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function p(){var a=e,b=a.getDate(),b=10>b?"0"+String(b):String(b),f=a.getMonth()+1,f=10>f?"0"+String(f):String(f),l=String(a.getFullYear()),h=a.getHours(),h=10>h?"0"+String(h):String(h),t=a.getMinutes(),t=10>t?"0"+String(t):String(t),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return b+"."+f+"."+l+" "+h+":"+t+":"+a}var e=new Date(2015,9,29,15,51,5),b=[15,10];a.version=function(){return b};a.version_str=function(){for(var a="",e=0;e<b.length;e++)a=1==e?a+(10>b[e]?
"0"+b[e]:b[e]):a+b[e],e!=b.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.date=function(){return e};a.date_str=p;a.timestamp=function(){var a=p(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.Ko&&b4w.module.__version(exports);b4w.module.__config=function(a,p){function e(){return b4w.module_check(a.lc.Al)}function b(){for(var b=a.lc,e=null,h=document.getElementsByTagName("script"),m=0;m<h.length;m++){for(var d=h[m].src,g=0;g<b.bu.length;g++)if(0<=d.indexOf(b.bu[g])){e=d;break}if(null!==e)break}e||(c.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),e=document.location.href);b=e.indexOf("?");0<=b&&(e=e.substring(0,b));return e.substring(0,e.lastIndexOf("/")+1)}var c=p("__print"),
m=p("__util");a.P_LOW=1;a.P_HIGH=2;a.P_ULTRA=3;a.P_CUSTOM=4;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.Hz=m.qa(a.context);a.q={alpha_sort:!0,alpha_sort_threshold:.1,Dn:!1,ah:[5,7],Id:1E4,console_verbose:!1,do_not_load_resources:!1,kn:!1,gt:1.5,aB:10,background_color:[0,0,0,0],Xg:.01,canvas_resolution_factor:1,Pk:3,allow_cors:!1,Po:!1,nl:!0,show_hud_debug_info:!1,NH:!0,Li:!0,anaglyph_use:!1,Ek:!0,oc:!0,ie:!0,Vh:!0,fi:!0,xl:!0,bh:!0,Rh:!0,antialiasing:!0,smaa:!1,wireframe_debug:!1,Ew:!1,
Zh:!0,yk:!0,Lb:!0,Jm:!0,water_dynamic:!0,shore_smoothing:!0,Mi:!0,ub:1024,qi:512,jw:!0,precision:"highp",quality:a.P_HIGH,Cn:!0,mD:!1,qv:!1,Bo:!1,tw:!1,Tg:!1,Co:!1,Es:!1,Pt:!1,eo:!1,iJ:!1,Ik:!1,allow_hidpi:!1,gyro_use:!1,dt:!1,Kp:!1,enable_selectable:!0,enable_outlining:!0,Ke:!0,mu:128,kp:!1,Rt:!1,VC:!1,Cp:[0,0],Tj:!1,Tu:!0,Pr:!1,iw:null,fv:!1};a.zA=m.qa(a.q);a.sg={bm:-1,ht:!1,Ng:1};a.controls={jD:1/120};a.Sd={dir:"ASSETS=../../assets/",dD:15,bq:!0,Ip:!1,xo:!1};a.Ky=m.qa(a.Sd);a.lc={shaders_dir:"",
JE:"include/",fJ:"postprocessing/",Al:"built_in_data",bu:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js USER_DEFINED_MODULE".split(" "),cv:"./",smaa_search_texture_path:"",smaa_area_texture_path:""};a.m={enabled:!0,Id:60,Uk:"",Yn:!1,ping:!1,Yk:!0};a.xD=m.qa(a.m);a.Ji={em:1024,Ol:384,Ks:32,rA:128,qA:256,Lu:.25,ED:.5,DD:1};a.kE=m.qa(a.Ji);a.w={lr:!0,xm:!1,Xr:!1,vs:!1,Ts:!1};a.IE=m.qa(a.w);a.Ab={outlining_overview_mode:!1,Se:[1,.4,.05],Di:.2,Ei:3.8,Fi:1};a.yo={enabled:!1,
jF:"MAIN_OPAQUE",iF:0,ME:"COLOR"};a.vA=m.qa(a.yo);a.Gy=function(){var b=a.q,c=a.m,e=a.Ji;switch(b.quality){case a.P_ULTRA:b.Li=!0;b.shore_smoothing=!0;b.ie=!0;b.Vh=!0;b.fi=!0;b.xl=!0;b.Ek=!0;b.oc=!0;b.Zh=!0;b.yk=!0;b.Lb=!0;b.Jm=!0;e.em=2048;b.Pk=3;b.nl=!0;b.kn=!1;b.precision="highp";b.water_dynamic=!0;b.Mi=!0;b.antialiasing=!0;b.smaa=!1;b.Rh=!0;b.bh=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.Ke=!0;c.Id=120;break;case a.P_HIGH:b.Li=!0;b.shore_smoothing=!0;b.ie=!0;b.Vh=!0;b.fi=!0;b.xl=!0;b.Ek=!0;b.oc=
!0;b.Zh=!0;b.yk=!0;b.Lb=!0;b.Jm=!0;e.em=1024;b.Pk=3;b.nl=!0;b.kn=!1;b.precision="highp";b.water_dynamic=!0;b.Mi=!0;b.antialiasing=!0;b.smaa=!1;b.Rh=!0;b.bh=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.Ke=!0;c.Id=60;break;case a.P_LOW:b.Li=!1,b.shore_smoothing=!1,b.ie=!1,b.Vh=!1,b.fi=!1,b.xl=!1,b.Ek=!1,b.oc=!1,b.Zh=!1,b.yk=!1,b.Lb=!1,b.Jm=!1,e.em=512,b.Pk=2,b.nl=!1,b.kn=!0,b.precision="mediump",b.water_dynamic=!1,b.Mi=!1,b.antialiasing=!1,b.smaa=!1,b.Rh=!1,b.bh=!1,b.allow_hidpi=!1,b.enable_outlining=
!1,b.Ke=!1,c.Id=60}};a.set=function(b,e){switch(b){case "allow_cors":a.q.allow_cors=e;break;case "allow_hidpi":a.q.allow_hidpi=e;break;case "alpha":a.context.alpha=e;break;case "alpha_sort":a.q.alpha_sort=e;break;case "alpha_sort_threshold":a.q.alpha_sort_threshold=e;break;case "anaglyph_use":a.q.anaglyph_use=e;break;case "animation_framerate":a.sg.bm=e;break;case "antialiasing":a.q.antialiasing=e;break;case "assets_dds_available":a.Sd.xo=e;break;case "assets_min50_available":a.Sd.Ip=e;break;case "audio":a.w.lr=
e;break;case "background_color":a.q.background_color=e;break;case "built_in_module_name":a.lc.Al=e;break;case "canvas_resolution_factor":a.q.canvas_resolution_factor=e;break;case "console_verbose":a.q.console_verbose=e;break;case "do_not_load_resources":a.q.do_not_load_resources=e;break;case "gyro_use":a.q.gyro_use=e;break;case "physics_enabled":a.m.enabled=e;break;case "physics_uranium_path":a.m.Uk=e;break;case "physics_calc_fps":a.m.Yn=e;break;case "physics_use_workers":a.m.Yk=e;break;case "precision":a.q.precision=
e;break;case "quality":a.q.quality=e;break;case "sfx_mix_mode":a.w.xm=e;break;case "shaders_dir":a.lc.shaders_dir=e;break;case "show_hud_debug_info":a.q.show_hud_debug_info=e;break;case "smaa":a.q.smaa=e;break;case "smaa_search_texture_path":a.lc.smaa_search_texture_path=e;break;case "smaa_area_texture_path":a.lc.smaa_area_texture_path=e;break;case "wireframe_debug":a.q.wireframe_debug=e;break;case "enable_selectable":a.q.enable_selectable=e;break;case "enable_outlining":a.q.enable_outlining=e;break;
case "outlining_overview_mode":a.Ab.outlining_overview_mode=e;break;case "glow_materials":a.q.Ke=e;break;case "url_params":a.q.iw=e;break;default:c.error("Unknown config property: "+b)}};a.get=function(b){switch(b){case "allow_cors":return a.q.allow_cors;case "allow_hidpi":return a.q.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.q.alpha_sort;case "alpha_sort_threshold":return a.q.alpha_sort_threshold;case "anaglyph_use":return a.q.anaglyph_use;case "animation_framerate":return a.sg.bm;
case "antialiasing":return a.q.antialiasing;case "assets_dds_available":return a.Sd.xo;case "assets_min50_available":return a.Sd.Ip;case "audio":return a.w.lr;case "background_color":return a.q.background_color;case "built_in_module_name":return a.lc.Al;case "canvas_resolution_factor":return a.q.canvas_resolution_factor;case "console_verbose":return a.q.console_verbose;case "do_not_load_resources":return a.q.do_not_load_resources;case "gyro_use":return a.q.gyro_use;case "physics_enabled":return a.m.enabled;
case "physics_uranium_path":return a.m.Uk;case "physics_calc_fps":return a.m.Yn;case "physics_use_workers":return a.m.Yk;case "precision":return a.q.precision;case "quality":return a.q.quality;case "sfx_mix_mode":return a.w.xm;case "shaders_dir":return a.lc.shaders_dir;case "show_hud_debug_info":return a.q.show_hud_debug_info;case "smaa":return a.q.smaa;case "smaa_search_texture_path":return a.lc.smaa_search_texture_path;case "smaa_area_texture_path":return a.lc.smaa_area_texture_path;case "wireframe_debug":return a.q.wireframe_debug;
case "enable_selectable":return a.q.enable_selectable;case "enable_outlining":return a.q.enable_outlining;case "outlining_overview_mode":return a.Ab.outlining_overview_mode;case "glow_materials":return a.q.Ke;case "url_params":return a.q.iw;default:c.error("Unknown config property: "+b)}};a.reset=function(){a.context=m.qa(a.Hz);a.q=m.qa(a.zA);a.Sd=m.qa(a.Ky);a.m=m.qa(a.xD);a.Ji=m.qa(a.kE);a.w=m.qa(a.IE);a.yo=m.qa(a.vA)};a.lC=e;a.zE=function(){var c=a.lc,l=a.m;e()||""!=c.shaders_dir||(c.shaders_dir=
b()+"../shaders/");if(e())c.smaa_search_texture_path="smaa_search_texture.png",c.smaa_area_texture_path="smaa_area_texture.png";else if(""==c.smaa_search_texture_path||""==c.smaa_area_texture_path){var h=b()+c.cv;c.smaa_search_texture_path=c.smaa_search_texture_path||h+"smaa_search_texture.png";c.smaa_area_texture_path=c.smaa_area_texture_path||h+"smaa_area_texture.png"}l.enabled&&""==l.Uk&&(h=b()+c.cv,l.Uk=h+"uranium.js")};a.get_std_assets_path=function(){return a.Sd.dir.replace("ASSETS=","")}};b4w.module.__anchors=function(a,p){function e(a,k){var e=document.createElement("div"),f=e.style;f.position="absolute";f.backgroundColor="black";f.borderRadius="20px 20px 20px 0px";f.boxShadow="0px 0px 10px rgb(180, 180, 200)";f.opacity=1;f.padding="8px 12px";f.lineHeight="15px";f.visibility="hidden";f.fontSize="12px";var n=d.get_container();n.appendChild(e);var u=g.get_meta_tags(a);if(u)var G=u.title||a.name,E=u.description;else G=a.name,E="";var r=document.createElement("span"),K=r.style;r.innerHTML=
G;K.fontWeight="bold";K.fontSize="12px";K.lineHeight="15px";K.color="#fff";K.fontFamily="Arial";m(r);e.appendChild(r);if(E){var u=document.createElement("div"),z=u.style;z.position="absolute";z.bottom="0px";z.left="0px";z.backgroundColor="#000";z.borderRadius="20px 20px 20px 0px";z.boxShadow="0px 0px 10px rgb(180, 180, 200)";z.visibility="hidden";z.padding="8px 12px";z.overflow="hidden";z.lineHeight="15px";z.fontSize="12px";z.zIndex="2";e.appendChild(u);var G=document.createElement("span"),H=G.style;
G.innerHTML=E;H.fontSize="12px";H.fontFamily="Arial";H.fontWeight="bold";H.lineHeight="15px";H.color="#fff";H.visibility="hidden";u.appendChild(G);var l=!1,x=!1;n.addEventListener("click",function(a){if(!(l||x||A))if(a.target!=r&&a.target!=e||"hidden"!=z.visibility||1!=f.opacity)"visible"==z.visibility&&(f.visibility="visible",K.visibility="visible",z.visibility="hidden",H.visibility="hidden");else{f.visibility="hidden";K.visibility="hidden";z.visibility="visible";l=x=!0;a=e.offsetWidth-24;var d=
e.offsetHeight-16,q=Math.min(k,b(E)),n=c(E,q);n==d&&(z.height=n+"px");q!=a?I.animate(a,q,200,function(a){a==q&&("visible"==z.visibility&&(H.visibility="visible"),l=!1);z.width=a+"px"}):l=!1;n!=d?I.animate(d,n,200,function(a){a==n&&("visible"==z.visibility&&(H.visibility="visible"),x=!1);z.height=a+"px"}):x=!1;x||l||(H.visibility="visible")}},!1)}return e}function b(a){var b=document.createElement("div"),c=document.createElement("span"),d=b.style;c.innerHTML=a;c.style.fontSize="12px";c.style.fontFamily=
"Arial";c.style.fontWeight="bold";c.style.color="#fff";c.style.visibility="hidden";d.lineHeight="15px";b.appendChild(c);d.position="absolute";d.visibility="hidden";d.fontSize="12px";d.display="inline-block";d.lineHeight="15px";document.body.appendChild(b);a=b.offsetWidth+1;document.body.removeChild(b);return a}function c(a,b){var c=document.createElement("div"),d=document.createElement("span"),k=c.style;d.innerHTML=a;d.style.fontSize="12px";d.style.fontFamily="Arial";d.style.fontWeight="bold";d.style.color=
"#fff";d.style.visibility="hidden";k.lineHeight="15px";c.appendChild(d);k.position="absolute";k.visibility="hidden";k.fontSize="12px";k.display="inline-block";k.width=b+"px";k.lineHeight="15px";document.body.appendChild(c);d=c.offsetHeight;document.body.removeChild(c);return d}function m(a){a.style["-webkit-touch-callout"]="none";a.style["-webkit-user-select"]="none";a.style["-khtml-user-select"]="none";a.style["-moz-user-select"]="none";a.style["-ms-user-select"]="none";a.style["user-select"]="none";
a.style.cursor="default"}function f(){for(var a=0,b=0;b<B.length;b++)B[b].Th&&a++;y=new Float32Array(3*a)}function l(a,b){return b.depth-a.depth}var h=p("__batch"),t=p("__camera"),d=p("__container"),g=p("__objects"),k=p("__print"),n=p("__renderer"),x=p("__scenes"),I=p("__time");p("__util");p("__config");var A=!1,B=[],y=new Float32Array(0),v=new Uint8Array(16),F=new Float32Array(2),u=new Float32Array(3);a.append=function(a){var b;a:{for(b=0;b<B.length;b++)if(B[b].obj==a){b=!0;break a}b=!1}if(!b){b=
a.anchor.Th&&Boolean(x.ea(x.ei(),"ANCHOR_VISIBILITY"));b={type:a.anchor.type,obj:a,x:0,y:0,depth:0,Lh:"out",Th:b,element:null,vi:null,ky:a.anchor.eD,Qr:0,Wl:a.anchor.Wl};switch(b.type){case "ANNOTATION":b.element=e(a,b.ky);b.Qr=b.element.offsetHeight;break;case "ELEMENT":b.element=document.getElementById(a.anchor.Wl),b.element||(k.warn("Anchor HTML element was not found, making it generic"),b.type="GENERIC")}B.push(b);f()}};a.remove=function(a){for(var b=0;b<B.length;b++){var c=B[b];if(c.obj==a){"ANNOTATION"==
c.type&&(a=c,d.get_container().removeChild(a.element));B.splice(b,1);f();break}}};a.update=function(){for(var a=0,b=B.length;b--;){var c=B[b];c.Th&&(y.set(c.obj.f.i,3*a),a++);var d,k=c,e=u;d=x.di(x.ei());d=e=t.project_point(d,k.obj.f.i,e);k=d[0];e=d[1];d=d[2];if(k!=c.x||e!=c.y||d!=c.depth){switch(c.type){case "ANNOTATION":var f=c.element;f.style.left=Math.floor(k)+"px";f.style.top=Math.floor(e-c.Qr)+"px";break;case "ELEMENT":var f=c.element,E=f.getBoundingClientRect();f.style.cssText+="left:"+Math.floor(k-
E.width/2)+"px;top:"+Math.floor(e-E.height/2)+"px;"}c.x=k;c.y=e;c.depth=d;c.vi&&c.vi(k,e,c.Lh,c.obj,f)}}B.sort(l);for(b=0;b<B.length;b++)c=B[b],"GENERIC"!=c.type&&(c.element.style.zIndex=b);0<a&&(a=x.ea(x.ei(),"ANCHOR_VISIBILITY").p[0].B,h.yF(a,y))};a.hw=function(){for(var a=d.get_container(),b=B.length;b--;){var c=B[b],k=c.obj,e=c.x,f=c.y,u=c.depth,u=0>e||0>f||0>u||1<u||x.is_hidden(k)||e>=a.clientWidth||f>=a.clientHeight?"out":"visible";if(c.Th&&"out"!=u){var u=c,E=x.ea(x.ei(),"ANCHOR_VISIBILITY").k,
r=d.bo(u.x,u.y,F,E);n.Zu(E.Ie,r[0],E.height-r[1],2,2,v);u=1020==v[0]+v[4]+v[8]+v[12]?"visible":"out"==u.Lh||0==v[0]+v[4]+v[8]+v[12]?"covered":u.Lh}if(u!=c.Lh){switch(c.type){case "ANNOTATION":case "ELEMENT":var K=c.element;if(!K)break;"out"==u?(K.style.visibility="hidden",K.children.length&&(K.children[0].style.visibility="hidden"),"ANNOTATION"==c.type&&1<K.children.length&&(E=K.children[1],E.style.visibility="hidden",E.children.length&&(E.children[0].style.visibility="hidden"))):"visible"==u?(K.style.visibility=
"visible",K.children.length&&(K.children[0].style.visibility="visible"),K.style.opacity=1):(K.style.visibility="visible",K.style.opacity=.1,K.children.length&&(K.children[0].style.visibility="visible"),"ANNOTATION"==c.type&&1<K.children.length&&(E=K.children[1],E.style.visibility="hidden",E.children.length&&(E.children[0].style.visibility="hidden")))}c.Lh=u;c.vi&&c.vi(e,f,c.Lh,k,K)}}};a.attach_move_cb=function(a,b){for(var c=0;c<B.length;c++)B[c].obj==a&&(B[c].vi=b)};a.detach_move_cb=function(a){for(var b=
0;b<B.length;b++)B[b].obj==a&&(B[b].vi=null)};a.cleanup=function(){for(var a=0;a<B.length;a++){var b=B[a];"ANNOTATION"==b.type&&d.get_container().removeChild(b.element)}B.length=0};a.is_anchor=function(a){for(var b=0;b<B.length;b++)if(B[b].obj==a)return!0;return!1};a.get_element_id=function(a){for(var b=0;b<B.length;b++)if(B[b].obj==a)return B[b].Wl;return!1};a.pause=function(){A=!0};a.resume=function(){A=!1}};b4w.module.__armature=function(a,p){function e(a){a=a.f;for(var b=a.Wm,c=a.nu,d=0;d<b.length;d++){for(var k=b[d],e=c[d],f=0;f<e.length;f+=2)for(var n=e[f],q=e[f+1],g=0;4>g;g++)k.Bc[n+g]=a.Bc[q+g],k.Xc[n+g]=a.Xc[q+g],k.Gc[n+g]=a.Gc[q+g],k.ed[n+g]=a.ed[q+g];k.sd=a.sd}}function b(a,c,k,e){var f=a.Wq,n=a.bg,g=a.Rk,u=a.Wp;u?(u=u.Rk,c?m.multiply(u,f,g):(c=d,m.invert(u,c),m.multiply(c,g,f))):c?m.copy(f,g):m.copy(g,f);f=t;m.invert(n,f);m.multiply(g,f,f);n=a.lf;k[4*n]=f[0];k[4*n+1]=f[1];k[4*n+2]=f[2];k[4*
n+3]=f[3];e[4*n]=f[4];e[4*n+1]=f[5];e[4*n+2]=f[6];e[4*n+3]=f[7];a=a.Ss;for(n=0;n<a.length;n++)g=a[n],g.Sa||b(g,!0,k,e)}var c=p("__util"),m=p("__tsr"),f=p("__quat"),l=p("__mat4"),h=p("__vec3"),t=new Float32Array(8),d=new Float32Array(8),g=new Float32Array(4),k=new Float32Array(4),n=new Float32Array(4);a.wh=function(a,b){for(var d=a.data.bones,k=a.pose.bones,e={},f=0;f<k.length;f++){var n=k[f],u=n.bone,q=u.name,g=e[q]={lf:0,uw:-1,Wp:null,Ss:[],Dl:[],Sa:null,Qk:m.create(),Wq:m.create(),bg:m.create(),
Rk:m.create(),cn:m.create(),Xq:m.create(),dn:!1,Vv:new Float32Array(3)},q=new Float32Array(u.matrix_local),w=new Float32Array(16);l.invert(q,w);var n=new Float32Array(n.matrix_basis),J=g.Vv;h.subtract(u.tail_local,u.head_local,J);c.rG(J,w,J);m.from_mat4(q,g.bg);m.from_mat4(n,g.cn);m.copy(g.bg,g.Rk)}for(f=0;f<d.length;f++){q=d[f].name;n=c.keysearch("name",q,k);g=e[q];u=n.parent_recursive;g.Dl.push(g);for(w=0;w<u.length;w++)n=u[w],n=n.name,n=e[n],g.Dl.push(n);u.length?(n=u[0],n=n.name,n=e[n],g.Wp=n,
m.invert(n.bg,t),m.multiply(t,g.bg,g.Qk),n.Ss.push(g)):m.copy(g.bg,g.Qk);g.lf=f;g.name=q;m.multiply(g.Qk,g.cn,g.Wq)}b.f.ld=e};a.get_bone_tsr=function(a,b,c,e,l){var v=a.f,h=v.sd;b=v.ld[b];var u=b.lf;a=b.bg;var q=v.Gc,D=v.ed,w=v.Bc,v=v.Xc,J=q[4*u+1],C=q[4*u+2],M=q[4*u+3],G=D[4*u+1],E=D[4*u+2],r=D[4*u+3];g[0]=(1-h)*q[4*u]+h*D[4*u];g[1]=(1-h)*J+h*G;g[2]=(1-h)*C+h*E;g[3]=(1-h)*M+h*r;k[0]=w[4*u];k[1]=w[4*u+1];k[2]=w[4*u+2];k[3]=w[4*u+3];n[0]=v[4*u];n[1]=v[4*u+1];n[2]=v[4*u+2];n[3]=v[4*u+3];f.slerp(k,n,
h,k);h=t;m.set_transcale(g,h);m.set_quat(k,h);c?(c=d,m.translate(a,b.Vv,c),m.multiply(h,c,h)):m.multiply(h,a,h);if(e){if(e=b.Wp)c=d,m.invert(e.Rk,c),m.multiply(c,h,h);e=d;m.invert(b.Qk,e);m.multiply(e,h,h)}m.copy(h,l)};a.set_bone_tsr=function(a,c,d,k){var f=a.f;c=f.ld[c];var n=f.Gc,g=f.Bc;k?m.multiply(c.Qk,d,c.Wq):m.copy(d,c.Rk);b(c,k,n,g);f.sd=0;e(a)};a.WF=e;a.FF=b;a.yj=function(a,b){return b in a.f.ld}};b4w.module.__boundings=function(a,p){function e(a,b){for(var c=a[0],d=a[1],e=a[2],f=a[0],g=a[1],l=a[2],h=3;h<a.length;h+=3)var u=a[h],q=a[h+1],D=a[h+2],c=Math.max(c,u),d=Math.max(d,q),e=Math.max(e,D),f=Math.min(f,u),g=Math.min(g,q),l=Math.min(l,D);b.max_x=c;b.max_y=d;b.max_z=e;b.min_x=f;b.min_y=g;b.min_z=l;return b}function b(a,b){b||(b=new Float32Array(24));var c=a.max_x,d=a.max_y,e=a.max_z,f=a.min_x,g=a.min_y,l=a.min_z;b[0]=f;b[1]=g;b[2]=l;b[3]=c;b[4]=g;b[5]=l;b[6]=c;b[7]=d;b[8]=l;b[9]=f;b[10]=
d;b[11]=l;b[12]=f;b[13]=g;b[14]=e;b[15]=c;b[16]=g;b[17]=e;b[18]=c;b[19]=d;b[20]=e;b[21]=f;b[22]=d;b[23]=e;return b}function c(a,b,c){l.add(b,c,a.F);l.scale(a.F,.5,a.F);a.Ua=l.distance(a.F,b);return a}var m=p("__tsr"),f=p("__util"),l=p("__vec3"),h=new Float32Array(24),t=new Float32Array(3),d=new Float32Array(3),g=new Float32Array(3);a.Il=function(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z};a.vH=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,
min_y:-1E12,max_z:1E12,min_z:-1E12}};a.Ad=function(a){a||(a={});a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0;return a};a.Xs=function(a,b){var c=a.max_y,d=a.max_z,e=a.min_x,f=a.min_y,g=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,d);a.min_x=Math.min(b.min_x,e);a.min_y=Math.min(b.min_y,f);a.min_z=Math.min(b.min_z,g)};a.Sy=e;a.Un=function(c,d,g){g||(g=a.Ad());c=b(c,h);f.Mf(c,d,c);return e(c,g)};a.TA=b;a.hJ=function(b,c,d){d||(d=a.Ad());
var e=c.min_x,f=c.max_x,g=c.min_y,l=c.max_y,h=c.min_z;c=c.max_z;if(e>=b.max_x||f<=b.min_x||g>=b.max_y||l<=b.min_y||h>=b.max_z||c<=b.min_z)return d.min_x=-.1,d.max_x=.1,d.min_y=-.1,d.max_y=.1,d.min_z=-.2,d.max_z=-.1,d;d.min_x=Math.max(b.min_x,e);d.max_x=Math.min(b.max_x,f);d.min_y=Math.max(b.min_y,g);d.max_y=Math.min(b.max_y,l);d.min_z=Math.max(b.min_z,h);d.max_z=Math.min(b.max_z,c);return d};a.lJ=function(b,c,d){d||(d=a.Ad());var e=b.max_x-b.min_x,f=b.max_y-b.min_y,g=b.max_z-b.min_z;d.min_x=b.min_x-
.5*(c-1)*e;d.max_x=b.max_x+.5*(c-1)*e;d.min_y=b.min_y-.5*(c-1)*f;d.max_y=b.max_y+.5*(c-1)*f;d.min_z=b.min_z-.5*(c-1)*g;d.max_z=b.max_z+.5*(c-1)*g;return d};a.Wn=function(b,c,d){d||(d=a.al());l.transformMat4(b.F,c,d.F);d.Ua=b.Ua*f.Gp(c);return d};a.Vn=function(a,b,c){c||(c={Td:new Float32Array(3),Ud:new Float32Array(3),Vd:new Float32Array(3),F:new Float32Array([0,0,0])});m.transform_vec3(a.F,b,c.F);l.copy(a.Td,c.Td);l.copy(a.Ud,c.Ud);l.copy(a.Vd,c.Vd);m.transform_dir_vec3(c.Td,b,c.Td);m.transform_dir_vec3(c.Ud,
b,c.Ud);m.transform_dir_vec3(c.Vd,b,c.Vd);return c};a.Ll=function(a,b){return{Ua:a,F:new Float32Array(b)}};a.al=function(){return{F:new Float32Array([0,0,0]),Ua:0}};a.Kl=function(a,b,c,d){return{Td:new Float32Array(a),Ud:new Float32Array(b),Vd:new Float32Array(c),F:new Float32Array([d[0],d[1],d[2]])}};a.Ty=function(){return{F:new Float32Array([0,0,0]),Ua:1E12}};a.PA=function(a,b){var c=l.subtract(b.F,a.F,l.create());0==l.length(c)&&l.set(1,0,0,c);var d=l.normalize(c,l.create()),c=l.scale(d,a.Ua,l.create());
l.add(c,a.F,c);var e=l.scale(d,-a.Ua,l.create());l.add(e,a.F,e);var f=l.scale(d,b.Ua,l.create());l.add(f,b.F,f);var g=l.scale(d,-b.Ua,l.create());l.add(g,b.F,g);c=[c,e,f,g];d=l.normalize(d,l.create());e=c[0];f=c[0];for(g=1;g<c.length;g++){var h=l.dot(c[g],d);h<l.dot(e,d)&&(e=c[g]);h>l.dot(f,d)&&(f=c[g])}d=[e,f];c=d[0];d=d[1];a.F=l.scale(l.add(c,d,l.create()),.5,l.create());a.Ua=l.length(l.subtract(d,c,l.create()))/2};a.Fs=function(a,b){var c=b.max_y,d=b.min_y,e=Math.max(0,c-d-2*a);return{Ua:a,height:e,
F:new Float32Array([0,(c+d)/2,0])}};a.Hs=function(a,b){var c=b.max_y,d=b.min_y,e=Math.max(0,c-d);return{Ua:a,height:e,F:new Float32Array([0,(c+d)/2,0])}};a.Gs=function(a,b){var c=b.max_y,d=b.min_y,e=Math.max(0,c-d);return{Ua:a,height:e,F:new Float32Array([0,(c+d)/2,0])}};a.zH=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.QD=function(a){for(var b=0,c=0,d=0,e=0,f=0,g=0,l=0,h=0,u=0;u<a.submeshes.length;u++){var q=
a.submeshes[u];if(q.position.length){b=e=q.position[0];c=f=q.position[1];d=g=q.position[2];break}}for(u=0;u<a.submeshes.length;u++)for(var q=a.submeshes[u],q=q.position,D=0;D<q.length/3;D++)var w=q[3*D],m=q[3*D+1],C=q[3*D+2],b=Math.max(w,b),c=Math.max(m,c),d=Math.max(C,d),e=Math.min(w,e),f=Math.min(m,f),g=Math.min(C,g),l=Math.max(Math.sqrt(w*w+m*m+C*C),l),h=Math.max(Math.sqrt(w*w+C*C),h);a.b4w_bounding_box.max_x=b;a.b4w_bounding_box.min_x=e;a.b4w_bounding_box.max_y=c;a.b4w_bounding_box.min_y=f;a.b4w_bounding_box.max_z=
d;a.b4w_bounding_box.min_z=g;a.b4w_bounding_box_source.max_x=b;a.b4w_bounding_box_source.min_x=e;a.b4w_bounding_box_source.max_y=c;a.b4w_bounding_box_source.min_y=f;a.b4w_bounding_box_source.max_z=d;a.b4w_bounding_box_source.min_z=g;a.b4w_bounding_sphere_radius=l;a.b4w_bounding_cylinder_radius=h};a.KB=function(b){var e=b.subarray(0,3),h=b.subarray(6,9),m=b.subarray(12,15),A=b.subarray(18,21);b=l.subtract(h,e,t);l.normalize(b,b);var B=f.OB(e,h,m,d),B=l.cross(B,b,B);l.normalize(B,B);var y=l.create(),
v=l.create();l.subtract(h,e,g);v[0]=l.dot(g,b);v[1]=l.dot(g,B);h=l.create();l.subtract(m,e,g);h[0]=l.dot(g,b);h[1]=l.dot(g,B);m=l.create();l.subtract(A,e,g);m[0]=l.dot(g,b);m[1]=l.dot(g,B);A=a.al();m=[y,v,h,m];y=c(A,m[0],m[1]);for(A=2;A<m.length;A++)if(l.distance(y.F,m[A])>y.Ua){for(var F=y,y=m,v=m[A],h=A-1,F=c(F,v,y[0]),u=1;u<=h;u++)if(l.distance(F.F,y[u])>F.Ua){for(var q=F,F=y,D=v,w=y[u],J=u-1,q=c(q,D,w),C=0;C<=J;C++)if(l.distance(q.F,F[C])>q.Ua){var M=D,G=w,E=F[C],r=l.subtract(G,E,g),r=l.squaredLength(r),
K=l.subtract(M,E,g),z=l.squaredLength(K),K=l.subtract(M,G,g),H=l.squaredLength(K),K=r*(z+H-r),V=z*(H+r-z),r=H*(r+z-H),z=K+V+r;l.copy(M,q.F);l.scale(q.F,K/z,q.F);l.scaleAndAdd(q.F,G,V/z,q.F);l.scaleAndAdd(q.F,E,r/z,q.F);q.Ua=l.distance(q.F,M)}F=q}y=F}A=y;b=l.scale(b,A.F[0],g);l.scaleAndAdd(b,B,A.F[1],b);l.add(b,e,A.F);return A}};b4w.module.__compat=function(a,p){function e(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function b(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function c(){return!window.ActiveXObject&&"ActiveXObject"in window}var m=p("__config"),f=p("__extensions"),l=p("__print");
p("__util");var h="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";"),t=m.sg,d=m.q,g=m.context,k=m.Ji,n=m.w,x=m.m;a.DA=function(a){a.getError()==a.INVALID_ENUM&&l.warn("Possible Tegra invalid enum issue detected, ignoring")};a.sE=function(a){d.mu=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS);d.ub=a.getParameter(a.MAX_TEXTURE_SIZE);d.qi=
a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE);var m=Boolean(f.FB());e("Firefox/28.0")&&(e("Linux")||e("Macintosh"))&&(l.warn("Firefox 28 detected, applying depth hack"),m=!1);e("Windows Phone")||(e("iPad")||e("iPhone")?(l.warn("iOS detected, applying alpha hack, applying vertex animation mix normals hack, applying ios depth hack and disable smaa. Disable ssao for performance. Disable video textures. Initialize WebAudio context with empty sound."),g.alpha||(d.background_color[3]=1),d.tw=!0,d.smaa=!1,
d.ie=!1,d.precision="highp",d.Pt=!0,d.Rt=!0):e("Mac OS X")&&e("Safari")&&!e("Chrome")&&(l.warn("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),d.fv=!0,n.Xr=!0,n.vs=!0));e("Windows")&&(e("Chrome/40")||e("Firefox/33")||e("Firefox/34")||e("Firefox/35")||e("Firefox/36"))&&(l.warn("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),d.eo=!0);b()&&(l.warn("Mobile detected, applying various hacks for video textures."),
d.Tg=!0,e("iPad")||e("iPhone")||e("Windows Phone")||(l.warn("Mobile (not iOS) detected, disable playback rate for video textures."),n.Ts=!0));(e("Firefox/35.0")||e("Firefox/36.0"))&&e("Windows")&&(l.warn("Windows/Firefox 35/36 detected, applying shadows slink hack"),d.dt=!0);if(e("iPhone")||c()||e("Edge"))l.warn("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),d.Ik=!0;10>a.getParameter(a.MAX_VARYING_VECTORS)&&(l.warn("Not enough varyings, disable shadows on blend objects"),
d.Bo=!0);e("Windows Phone")&&(l.warn("Windows Phone detected. Disable wireframe mode, glow materials, ssao, smaa, shadows, reflections, refractions."),d.wireframe_debug=!1,d.precision="highp",d.Ke=!1,d.ie=!1,d.smaa=!1,d.Li=!1,d.Ek=!1,d.oc=!1,d.Tu=!1);e("Firefox")&&d.Tg&&(l.warn("Mobile Firefox detected, applying depth hack, disable workers."),m=x.Yk=!1);var B=f.At();if(B){e("Macintosh")&&-1<a.getParameter(B.UNMASKED_RENDERER_WEBGL).indexOf("Intel HD Graphics 3000")&&(l.warn("OS X / Intel HD 3000 detected, applying depth hack"),
m=!1);-1<a.getParameter(B.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(B.UNMASKED_RENDERER_WEBGL).indexOf("Mali-400")&&(l.warn("ARM Mali-400 detected, applying depth and frames blending hacks"),m=!1,t.ht=!0);-1<a.getParameter(B.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(B.UNMASKED_RENDERER_WEBGL).indexOf("Mali-T604")&&(l.warn('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),d.precision="highp",d.Li=!1);-1<a.getParameter(B.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&
-1<a.getParameter(B.UNMASKED_RENDERER_WEBGL).indexOf("Mali-T760")&&(l.warn('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),d.precision="highp",d.ie=!1);-1<a.getParameter(B.UNMASKED_VENDOR_WEBGL).indexOf("Qualcomm")&&-1<a.getParameter(B.UNMASKED_RENDERER_WEBGL).indexOf("Adreno")&&(l.warn("Qualcomm Adreno detected, applying shader constants hack."),d.qv=!0,-1<a.getParameter(B.UNMASKED_RENDERER_WEBGL).indexOf("305")&&(l.warn('Qualcomm Adreno305 detected, set "highp" precision.'),d.precision=
"highp"),-1<a.getParameter(B.UNMASKED_RENDERER_WEBGL).indexOf("330")&&(l.warn('Qualcomm Adreno330 detected, set "highp" precision.'),d.precision="highp"));-1<a.getParameter(B.UNMASKED_VENDOR_WEBGL).indexOf("NVIDIA")&&-1<a.getParameter(B.UNMASKED_RENDERER_WEBGL).indexOf("Tegra 3")&&(l.warn("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),d.Po=!0);e("Windows")&&e("Chrome")&&!e("Edge")&&a.getParameter(B.UNMASKED_RENDERER_WEBGL).match(/NVIDIA GeForce 8..0/)&&(l.warn("Chrome / Windows / NVIDIA GeForce 8000 series detected, setting max cubemap size to 256."),
d.qi=256);a:{for(var y=0;y<h.length;y++)if(-1<a.getParameter(B.UNMASKED_RENDERER_WEBGL).indexOf(h[y])){B=h[y];break a}B=""}B&&(l.warn("Architecture "+B+" detected. Blending between frames and shadows on blend objects will be disabled."),d.Pr=!0,d.Bo=!0)}0==a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS)&&(l.warn("Vertex textures are not allowed. Disabling vertex textures"),d.Cn=!1);m||(d.Zh=!1,d.yk=!1,d.Lb=!1,d.water_dynamic=!1,d.shore_smoothing=!1,d.Mi=!1,d.smaa=!1);d.jw=Boolean(f.Bt());d.Oj=m;
0===a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision&&(d.precision="mediump");c()&&(l.warn("IE11 detected. Set sky cubemap texture size to 512 (power of two)."),k.Ol=512);if(c()&&e("Touch")||e("Edge"))l.warn("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),d.kp=!0;128>=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS)&&(l.warn("Not enough fragment uniforms, force low quality for B4W_LEVELS_OF_QUALITY nodes."),d.Po=!0);e("Chrome")&&!e("Edge")&&
(l.log("Chrome detected. Some of deprecated functions related to the Doppler effect won't be called."),d.Es=!0);if(e("Chrome")&&!e("Edge")||e("Firefox"))d.Co=!0;if(c()||e("iPad"))l.warn("iPad or Internet Explorer detected. Applying alpha clip hack."),d.Dn=!0;b()&&e("Firefox")&&(l.log("Mobile firefox detected. Applying autoplay media hack."),d.Kp=!0);e("Edge")&&(l.warn("Microsoft Edge detected, set up new minimal texture size."),d.Tj=!0)};a.detect_mobile=b;a.Ey=function(){e("Firefox/35.0")&&e("Windows")&&
(l.warn("Windows/Firefox 35 detected, forcing context's alpha"),m.context.alpha=!0)};a.qp=c};b4w.module.__constraints=function(a,p){function e(a){var b={};b.type=a;return b}function b(a,b){a.Sa&&a.Sa.O&&c(a.Sa.O,a);if(b.O){var d=b.O;if(-1==d.Dd.indexOf(a))d.Dd.push(a);else throw"Descendant object override is forbidden";}a.Sa=b}function c(a,b){var c=a.Dd.indexOf(b);if(-1!=c)a.Dd.splice(c,1);else throw"No descendant object";}function m(a,b,c){switch(b.type){case 1:var r=a.f.quat,e=b.O.f.aa;c=b.O.f.quat;b.cc?(g.copy(b.cc,r),g.multiply(c,r,r)):g.copy(c,r);x.transformMat4(b.offset,e,a.f.i);a.f.scale=
b.Hk*b.O.f.scale;break;case 9:var z=a.f.i,r=a.f.quat,e=b.O.f.aa;c=b.O.f.quat;g.multiply(g.invert(b.kh,b.kh),r,r);g.multiply(c,r,r);x.transformMat4(b.offset,e,z);g.copy(c,b.kh);break;case 10:z=a.f.i;r=a.f.quat;e=b.O.f.aa;c=b.O.f.quat;g.multiply(g.invert(b.kh,b.kh),r,r);g.multiply(c,r,r);x.transformMat4(b.offset,e,z);g.copy(c,b.kh);z=a.f.quat;r=g.multiply(b.O.f.quat,b.cc,q);r=t.qt(r,A);z=t.qt(z,B);t.rotate_eye_camera(a,n.mf(z[0],r[0]+b.Az,r[0]+b.zz),n.mf(z[1],r[1]+b.yz,r[1]+b.Bz));break;case 13:var z=
a.f.i,r=a.f.quat,e=b.O.f.aa,H=b.O.f.i,f=b.OE,u=y,v=q;x.transformMat4(b.offset,e,u);n.smooth_v(u,z,c,f,z);e=y;x.sub(H,z,e);x.normalize(e,e);var m=r,z=D,H=z.subarray(0,3),u=z.subarray(3,6),F=z.subarray(6,9);x.copy(e,u);x.negate(u,u);x.normalize(u,u);Boolean(.999999<Math.abs(x.dot(e,n.AXIS_Y)))?(e=d.fromQuat(g.normalize(m,v),w),x.copy(e.subarray(0,3),H)):x.cross(n.AXIS_Y,u,H);x.normalize(H,H);x.cross(H,u,F);x.normalize(F,F);g.fromMat3(z,v);g.normalize(v,v);n.Cv(v,r,c,.16*f,r);break;case 2:r=a.f.quat;
c=J;I.get_bone_tsr(b.O,b.xg,!0,!1,c);k.multiply(b.O.f.Ba,c,c);r[0]=c[4];r[1]=c[5];r[2]=c[6];r[3]=c[7];b.cc&&(g.copy(b.cc,r),g.multiply(r,b.cc,r));a.f.scale=b.Hk*c[3];k.transform_vec3(b.offset,c,a.f.i);break;case 3:z=a.f.i;r=a.f.quat;c=b.O.f.i;l(z,r,c);break;case 4:z=a.f.i;r=a.f.quat;c=b.target;l(z,r,c);break;case 5:z=a.f.i;r=a.f.quat;c=b.O.f.i;l(z,r,c);r=x.dist(z,c);if(r=r>b.dist_max?r-b.dist_max:r<b.Qj?r-b.Qj:0)x.sub(c,z,y),x.normalize(y,y),x.scale(y,r,y),x.add(z,y,z);break;case 6:z=a.f.i;r=a.f.quat;
c=b.target;l(z,r,c);r=x.dist(z,c);if(r=r>b.dist_max?r-b.dist_max:r<b.Qj?r-b.Qj:0)x.sub(c,z,y),x.normalize(y,y),x.scale(y,r,y),x.add(z,y,z);break;case 7:e=b.O.f.aa;x.transformMat4(b.offset,e,a.f.i);break;case 8:H=b.O.f.i;z=a.f.i;x.add(H,b.offset,z);break;case 14:r=a.f.quat;e=b.O.f.aa;c=b.O.f.quat;b.cc?(g.copy(b.cc,r),g.multiply(c,r,r)):g.copy(c,r);x.transformMat4(b.offset,e,a.f.i);break;case 11:z=b.O.f;c=k.create_sep(z.i,z.scale,z.quat,J);z=b.en;k.multiply(c,z,c);z=a.f.i;z[0]=c[0];z[1]=c[1];z[2]=c[2];
a.f.scale=c[3];r=a.f.quat;r[0]=c[4];r[1]=c[5];r[2]=c[6];r[3]=c[7];break;case 12:z=b.en;c=J;I.get_bone_tsr(b.O,b.xg,!0,!1,c);k.multiply(b.O.f.Ba,c,c);k.multiply(c,z,c);z=a.f.i;z[0]=c[0];z[1]=c[1];z[2]=c[2];a.f.scale=c[3];r=a.f.quat;r[0]=c[4];r[1]=c[5];r[2]=c[6];r[3]=c[7];break;case 15:c=b.O,r=t.IB(c),z=a.f.i,f=t.dm(r,"TOP"),v=t.dm(r,"BOTTOM"),e=f-v,b.fu?(H=t.dm(r,"LEFT"),z[0]=H+e*b.wp):(H=t.dm(r,"RIGHT"),z[0]=H-e*b.wp),z[2]=b.Zv?-(f-e*b.Rq):-(v+e*b.Rq),t.tC(r)?z[1]=-b.distance:(z[1]=-1,x.normalize(z,
z),x.scale(z,b.distance/Math.abs(z[1]),z)),k.transform_dir_vec3(z,c.f.Ba,z),x.add(c.f.i,z,z),r=a.f.quat,b.cc?(g.copy(b.cc,r),g.multiply(c.f.quat,r,r)):g.copy(c.f.quat,r)}"CAMERA"==a.f.type&&(z=n.AXIS_Y,10==b.type&&(c=b.O.f.quat,z=x.transformQuat(z,c,C)),t.Zq(a),h(a,z))}function f(a,b){switch(b.type){case 1:var c=b.target.f.Ba,r=J;k.invert(a.f.Ba,r);k.multiply(r,c,r);I.set_bone_tsr(a,b.xg,r,!1)}a.Np=!0}function l(a,b,c){var r=y;n.quat_to_dir(b,n.AXIS_MY,r);x.normalize(r,r);var d=v;x.subtract(c,a,d);
x.normalize(d,d);a=n.fE(r,d,u);g.multiply(a,b,b);g.normalize(b,b)}function h(a,b){var c=a.f,r=c.quat,d=n.quat_to_dir(c.quat,n.AXIS_Y,y);x.normalize(d,d);if(.999999<Math.abs(x.dot(b,d)))d=g.identity(q);else{var z=x.cross(b,d,v);x.normalize(z,z);if(c.La==t.MS_TARGET_CONTROLS)c.Oq&&x.negate(z,z);else{var e=n.quat_to_dir(c.quat,n.AXIS_Z,F);0<x.dot(e,b)&&x.negate(z,z)}c=n.quat_to_dir(c.quat,n.AXIS_X,F);x.normalize(c,c);var e=n.clamp(x.dot(c,z),-1,1),f=Math.acos(e),d=-.999999>=e?g.setAxisAngle(d,f,q):g.rotationTo(c,
z,q);g.normalize(d,d)}g.multiply(d,r,r);t.Zq(a)}var t=p("__camera"),d=p("__mat3"),g=p("__quat"),k=p("__tsr"),n=p("__util"),x=p("__vec3"),I=p("__armature");a.TG=1;a.SG=2;a.XG=3;a.YG=4;a.NG=5;a.OG=6;a.UG=7;a.MG=8;a.RG=9;a.QG=10;a.KG=11;a.LG=12;a.PG=13;a.VG=14;a.WG=15;a.JG=1;var A=new Float32Array(2),B=new Float32Array(2),y=new Float32Array(3),v=new Float32Array(3),F=new Float32Array(3),u=new Float32Array(4),q=new Float32Array(4),D=new Float32Array(9),w=new Float32Array(9),J=new Float32Array(8),C=new Float32Array(3);
a.Rr=function(a,c,d,r,f){var z=e(1);z.O=c;z.offset=new Float32Array(d);z.cc=r?new Float32Array(r):null;z.Hk=f;b(a,z);m(a,z,0)};a.wy=function(a,c,d,r,f,z){var H=e(2);H.O=c;H.xg=d;H.offset=new Float32Array(r);H.cc=f?new Float32Array(f):null;H.Hk=z;b(a,H);m(a,H,0)};a.vy=function(a,c,d,r){var f=e(9),z=a.f.quat,H=c.f.quat;f.O=c;f.offset=new Float32Array(d);f.kh=new Float32Array(H);r&&(g.copy(r,z),g.multiply(H,z,z));b(a,f);m(a,f,0)};a.uy=function(a,c,d,r,f,z,H,k){var u=e(10),q=a.f.quat,w=c.f.quat;u.O=c;
u.offset=new Float32Array(d);u.kh=new Float32Array(w);u.zz=n.angle_wrap_0_2pi(f);u.Az=n.angle_wrap_0_2pi(z);u.Bz=n.angle_wrap_periodic(H,-Math.PI,Math.PI);u.yz=n.angle_wrap_periodic(k,-Math.PI,Math.PI);r?(u.cc=new Float32Array(r),g.copy(r,q),g.multiply(w,q,q)):u.cc=g.create();b(a,u);m(a,u,0)};a.ty=function(a,c,d,r){var f=e(13);f.O=c;f.offset=new Float32Array(d);f.OE=r;b(a,f);m(a,f,0)};a.zy=function(a,c,d,r){var f=e(14);f.O=c;f.offset=new Float32Array(d);f.Hk=1;f.cc=r?new Float32Array(r):null;b(a,
f);m(a,f,0)};a.$I=c;a.Ay=function(a,c){var d=e(3);d.O=c;b(a,d);m(a,d,0)};a.By=function(a,c){var d=e(4);d.target=new Float32Array(c);b(a,d);m(a,d,0)};a.py=function(a,c,d,r){var f=e(5);f.O=c;f.Qj=d;f.dist_max=r;b(a,f);m(a,f,0)};a.qy=function(a,c,d,r){var f=e(6);f.target=new Float32Array(c);f.Qj=d;f.dist_max=r;b(a,f);m(a,f,0)};a.yy=function(a,c,d){var r=e(7);r.O=c;r.offset=new Float32Array(d);b(a,r);m(a,r,0)};a.oy=function(a,c,d){var r=e(8);r.O=c;r.offset=new Float32Array(d);b(a,r);m(a,r,0)};a.my=function(a,
c,d){var r=e(11);r.O=c;r.en=new Float32Array(d);b(a,r);m(a,r,0)};a.ny=function(a,c,d,r){var f=e(12);f.O=c;f.xg=d;f.en=new Float32Array(r);b(a,f);m(a,f,0)};a.append_stiff_viewport=function(a,c,d){var r=e(15);r.O=c;if("left"in d)r.fu=!0,r.wp=d.left;else if("right"in d)r.fu=!1,r.wp=d.right;else{m_print.error("append_stiff_viewport: Wrong positioning params");return}if("top"in d)r.Zv=!0,r.Rq=d.top;else if("bottom"in d)r.Zv=!1,r.Rq=d.bottom;else{m_print.error("append_stiff_viewport: Wrong positioning params");
return}"distance"in d?(r.distance=d.distance,r.cc="rotation"in d?new Float32Array(d.rotation):null,b(a,r),m(a,r,0)):m_print.error("append_stiff_viewport: Wrong positioning params")};a.LF=function(a,b){a.Sa&&m(a,a.Sa,b)};a.xy=function(a,b,c,r,d){var z=e(1);z.xg=c;z.target=b;z.offset=new Float32Array(r);z.cc=d?new Float32Array(d):null;z.Hk=1;b=z.target;c=z.xg;r=a.f.ld[c];d=b.lo;for(var H=0;H<d;H++){var k=d[H];if(k[0]==a&&k[1]==c){d.splice(H,1);break}}b.lo.push([a,c]);r.Sa=z;f(a,z)};a.EF=function(a,
b){var c=a.f.ld[b];c.Sa&&f(a,c.Sa)};a.eE=l;a.correct_up=h;a.qz=function(a){return a.Sa?!0:!1};a.remove=function(a){a.Sa.O&&c(a.Sa.O,a);a.Sa=null};a.nI=function(a){return a.Sa?a.Sa.type:null};a.ud=function(a){a=a.Sa;return!a||11!=a.type&&12!=a.type?!1:!0};a.cm=function(a){if((a=a.Sa)&&11==a.type)return a.O.f.Ba;if(a&&12==a.type){var b=J;I.get_bone_tsr(a.O,a.xg,!0,!1,b);k.multiply(a.O.f.Ba,b,b);return b}return null};a.td=function(a){a=a.Sa;return!a||11!=a.type&&12!=a.type?null:a.en}};b4w.module.__container=function(a,p){var e,b,c,m,f;function l(a,c){e=a;b=c}function h(){var a=F.getBoundingClientRect();l(a.left,a.top)}function t(){return v.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}var d=p("__anchors"),g=p("__config"),k=p("__data"),n=p("__hud");p("__objects");var x=p("__print"),I=p("__scenes"),A=p("__time"),B=p("__transform"),y=p("__util"),v=g.q,F=null,u=null,q=null,D=!1;m=c=0;f=1;e=b=0;var w=null;a.vn=320;a.un=240;a.$c=function(a){w=a};a.get_canvas=function(){return F};a.get_canvas_hud=
function(){return u};a.get_container=function(){return q};a.init=function(a,b){a&&a.parentNode?(F=a,u=b,q=a.parentNode):y.U("canvas container is not available")};a.insert_to_container=function(a,b){b=b||"LAST";switch(b){case "FIRST":q.insertBefore(a,q.firstElementChild);break;case "JUST_BEFORE_CANVAS":q.insertBefore(a,F);break;case "JUST_AFTER_CANVAS":F.nextElementSibling?q.insertBefore(a,F.nextElementSibling):q.appendChild(a,F);break;case "LAST":q.appendChild(a,F);break;default:x.error(b+" invalid stack order")}};
a.XB=function(){return c};a.WB=function(){return m};a.set_canvas_offsets=l;a.update_canvas_offsets=h;a.HE=function(a,b,d){c=a;m=b;f=d;h()};a.force_offsets_updating=function(){D=!0};a.client_to_canvas_coords=function(a,c,d){d||(d=new Float32Array(2));var f=d;D&&(h(),D=!1);f[0]=a-e;a=d;D&&(h(),D=!1);a[1]=c-b;return d};a.bo=function(a,b,d,e){d||(d=new Float32Array(2));d[0]=a*f;d[1]=b*f;e&&(a=e.width/c,d[0]*=a,d[1]*=a);return d};a.wG=function(a,b,d,e){d||(d=new Float32Array(2));d[0]=a/f;d[1]=b/f;e&&(a=
e.width/c,d[0]/=a,d[1]/=a)};a.Tt=function(b){return b&&b.parentNode?b.parentNode==q?!0:a.Tt(b.parentNode):!1};a.pC=t;a.ct=function(a){var b=document.getElementsByTagName("script");a=y.rk(a);for(var c=0;c<b.length;c++)if(b[c].src==a)return b[c];return null};a.resize=function(b,c,e){if(!b||!c){b=a.vn;c=a.un;var f=q;f.style.width=a.vn+"px";f.style.height=a.un+"px"}var f=F,g=u;!1!==e&&(f.style.width=b+"px",f.style.height=c+"px",g&&(g.style.width=b+"px",g.style.height=c+"px"));g&&(g.width=b,g.height=c,
n.Sk());if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))v.canvas_resolution_factor=1;e=Math.floor(b*v.canvas_resolution_factor);c=Math.floor(c*v.canvas_resolution_factor);t()&&(e*=window.devicePixelRatio,c*=window.devicePixelRatio);k.is_primary_loaded()&&(g=I.get_active().j,e=Math.floor(e*g.yd),c=Math.floor(c*g.yd));f.width=e;f.height=c;if(e>w.drawingBufferWidth||c>w.drawingBufferHeight)x.warn("Canvas size exceeds platform limits, downscaling"),
g=Math.min(w.drawingBufferWidth/e,w.drawingBufferHeight/c),e*=g,c*=g,f.width=e,f.height=c;I.pv(e,c,e/b);I.ka()&&B.o(I.get_active().ng);k.QF(f.width,f.height);k.is_primary_loaded()&&(d.update(),I.update(A.get_timeline(),0),d.hw())}};b4w.module.__controls=function(a,p){function e(a){return{type:a,value:0,ja:null,Fd:!1,key:0,Ia:"",Xd:!1,io:null,ho:function(){},fo:null,xs:function(){},We:null,from:new Float32Array(3),to:new Float32Array(3),St:!1,im:!1,Yu:0,Xu:function(){},axis:"",dd:0,bj:new Float32Array(3),Lm:new Float32Array(4),threshold:0,Uu:new Float32Array(4),tl:0,sl:0,ev:0,ul:0,Vc:0,repeat:!1,Yr:!1,hm:0,gm:0,fm:0,fp:0,ep:0,dp:0}}function b(a,b){a.value=Number(b)}function c(a){for(var b=a.Nd,c=a.nE,r=0;r<b.length;r++)c[r]=
b[r].value;return a.UC(c)}function m(a){a=r.indexOf(a);-1<a?r.splice(a,1):q.error("Wrong object")}function f(a,b){for(var c=0,r=0;r<b.length;r++)for(var d=b[r].Rf,z=0;z<d.length;z++)for(var e=d[z].Nd,f=0;f<e.length;f++)e[f]===a&&c++;return c}function l(a,b){switch(a.type){case 80:D.remove_collision_test(a.io,a.Ia,a.ho);a.Fd=!0;break;case 90:D.clear_collision_impulse_test(a.fo);a.Fd=!0;break;case 100:D.remove_ray_test(a.Yu);a.Fd=!0;break;case 130:a.Fd=!0}var c=b.indexOf(a);-1<c&&b.splice(c,1)}function h(a){for(var c=
0;c<K.length;c++){var r=K[c];20==r.type&&a.keyCode==r.key&&b(r,1)}O&&a.preventDefault();la&&la(a)}function t(a){for(var c=0;c<K.length;c++){var r=K[c];20==r.type&&0==a.keyCode&&16==r.key&&b(r,0);20==r.type&&a.keyCode==r.key&&b(r,0)}O&&a.preventDefault();la&&la(a)}function d(a){var c=!1,r=null;Q=!0;X=a.clientX;fa=a.clientY;V=a.clientX;ba=a.clientY;for(var d=0;d<K.length;d++){var z=K[d];50==z.type&&(b(z,1),z.ja=a.which);160==z.type&&(c||(c=F.client_to_canvas_coords(a.clientX,a.clientY,na),r=u.pick_object(c[0],
c[1]),c=!0),z.value=r==z.We?1:0)}S&&a.preventDefault();ea&&ea(a)}function g(a){for(var c=0;c<K.length;c++){var r=K[c];50==r.type&&b(r,0);160==r.type&&r.Yr&&(r.value=0)}Q=!1;S&&!oa&&a.preventDefault();ea&&ea(a)}function k(a){var c=a.clientX,r=a.clientY;V=c;ba=r;if(!E.kp||Q)for(var d=c-X,z=r-fa,e=Math.sqrt(d*d+z*z),f=0;f<K.length;f++){var H=K[f];if(40===H.type)switch(H.axis){case "X":b(H,d);H.ja=c;break;case "Y":b(H,z);H.ja=r;break;case "XY":b(H,e),H.ja[0]=c,H.ja[1]=r}}S&&!oa&&a.preventDefault();ea&&
ea(a)}function n(a){F.Tt(a.relatedTarget)||g(a)}function x(a){var c=a.wheelDelta||-40*a.detail,c=c*G.jD;H+=c;for(c=0;c<K.length;c++){var r=K[c];30===r.type&&b(r,H)}ua&&a.preventDefault();Y&&Y(a)}function I(a){var b=a.targetTouches;if(1==b.length){for(var c=b[0],b=c.clientX,c=c.clientY,r=!1,d=null,z=0;z<K.length;z++){var e=K[z];160==e.type&&(r||(r=F.client_to_canvas_coords(b,c,na),d=u.pick_object(r[0],r[1]),r=!0),e.value=d==e.We)}R[0]=b;R[1]=-1;W[0]=c;W[1]=-1}else 1<b.length&&(da=ja=y(b),R[0]=b[0].clientX,
R[1]=b[1].clientX,W[0]=b[0].clientY,W[1]=b[1].clientY);ha.set(R);aa.set(W);U&&U(a)}function A(c){var r=c.targetTouches;if(0!==r.length){if(1===r.length){ha[0]=r[0].clientX;ha[1]=-1;aa[0]=r[0].clientY;aa[1]=-1;var r=ha[0]-R[0],d=aa[0]-W[0],z=Math.sqrt(r*r+d*d);if(-1!=R[1]&&-1!=W[1]){var e=ha[0]-R[1],f=aa[0]-W[1],H=Math.sqrt(e*e+f*f);H<z&&(r=e,d=f,z=H)}for(H=0;H<K.length;H++){var g=K[H];if(60===g.type)switch(g.ja=a.PL_SINGLE_TOUCH_MOVE,g.axis){case "X":b(g,r);break;case "Y":b(g,d);break;case "XY":b(g,
z)}}}else if(1<r.length){ha[0]=r[0].clientX;ha[1]=r[1].clientX;aa[0]=r[0].clientY;aa[1]=r[1].clientY;da=y(r);z=da-ja;e=na;e[0]=(ha[0]+ha[1])/2;e[1]=(aa[0]+aa[1])/2;f=ia;f[0]=(R[0]+R[1])/2;f[1]=(W[0]+W[1])/2;var k,r=e[0],d=e[1],H=f[0],g=f[1];k=Math.sqrt((r-H)*(r-H)+(d-g)*(d-g));for(H=0;H<K.length;H++)if(g=K[H],70===g.type&&Math.abs(k)<Math.abs(z)&&(g.ja=a.PL_MULTITOUCH_MOVE_ZOOM,b(g,z)),60===g.type&&Math.abs(k)>Math.abs(z))switch(g.ja=a.PL_MULTITOUCH_MOVE_PAN,g.axis){case "X":r=e[0]-f[0];b(g,r);break;
case "Y":d=e[1]-f[1];b(g,d);break;case "XY":b(g,k)}}P&&c.preventDefault();U&&U(c)}}function B(a){for(var c=0;c<K.length;c++){var r=K[c];if(170==r.type||180==r.type)r.gm=a.beta,r.hm=a.gamma,r.fm=a.alpha,r.value||(r.fp=a.gamma,r.ep=a.beta,r.dp=a.alpha,b(r,1))}}function y(a){var b=a[0],c=a[1];a=b.clientX;var b=b.clientY,r=c.clientX,c=c.clientY;return Math.sqrt((a-r)*(a-r)+(b-c)*(b-c))}var v=p("__config"),F=p("__container"),u=p("__objects"),q=p("__print"),D=p("__physics"),w=p("__quat"),J=p("__time"),
C=p("__util"),M=p("__vec3"),G=v.controls,E=v.q,r=[],K=[],z={},H=0,V=0,ba=0,X=0,fa=0,Q=!1,ha=new Float32Array(2),aa=new Float32Array(2),R=new Float32Array(2),W=new Float32Array(2),na=new Float32Array(2),ia=new Float32Array(2),da=0,ja=0,ga=!1,L=0,O=!1,S=!1,ua=!1,P=!1,oa=!1,la=null,ea=null,Y=null,U=null;a.CT_CONTINUOUS=10;a.CT_TRIGGER=20;a.CT_SHOT=30;a.CT_LEVEL=40;a.CT_CHANGE=50;a.PL_SINGLE_TOUCH_MOVE=0;a.PL_MULTITOUCH_MOVE_ZOOM=1;a.PL_MULTITOUCH_MOVE_PAN=2;a.update=function(d,e){for(var f=0;f<K.length;f++){var g=
K[f],k=d,u=e;if(u)switch(g.type){case 110:var q=g.We,n=q.f.i,q=q.f.quat,E=M.dist(g.bj,n),l=g.Uu;w.invert(g.Lm,l);w.multiply(q,l,l);w.normalize(l,l);l=Math.abs(2*Math.acos(l[3]));E/=u;g.tl=C.smooth(E,g.tl,u,.3);g.ja[0]=E;E=l/u;g.sl=C.smooth(E,g.sl,u,.3);g.ja[1]=E;g.tl>=g.threshold||g.sl>=g.ev?b(g,1):b(g,0);M.copy(n,g.bj);w.copy(q,g.Lm);g.dd=k;break;case 120:q=g.We;n=q.f.i;q=Math.abs(n[1]-g.bj[1])/u;g.ul=C.smooth(q,g.ul,u,.3);g.ja=q;g.ul>=g.threshold?b(g,1):b(g,0);M.copy(n,g.bj);g.dd=k;break;case 130:!g.Fd&&
0<=g.Vc&&k-g.dd>=g.Vc&&(b(g,1),g.repeat?g.dd=k:g.Vc=-g.Vc);break;case 140:g.dd||(g.dd=k);b(g,k-g.dd);g.dd=k;break;case 150:b(g,k);break;case 170:g.ja[0]=Math.PI*(g.hm-g.fp)/180;g.ja[1]=Math.PI*(g.gm-g.ep)/180;g.ja[2]=Math.PI*(g.fm-g.dp)/180;g.fp=g.hm;g.ep=g.gm;g.dp=g.fm;break;case 180:g.ja[0]=Math.PI*g.hm/180,g.ja[1]=Math.PI*g.gm/180,g.ja[2]=Math.PI*g.fm/180}}for(f=0;f<r.length;f++)for(u=r[f],g=u.Rf,k=0;k<g.length;k++)if(n=g[k],n.aw!=L){n.aw=L;l=n;q=0;switch(l.type){case a.CT_CONTINUOUS:q=l.Me;(E=
c(l))?(q=1,l.Me=1):1==q?(q=-1,l.Me=-1):q=0;break;case a.CT_TRIGGER:q=l.Me;(E=c(l))&&-1==q?(q=1,l.Me=1):E||1!=q?q=0:(q=-1,l.Me=-1);break;case a.CT_SHOT:q=l.Me;(E=c(l))&&-1==q?(q=1,l.Me=1):E||1!=q?q=0:(q=0,l.Me=-1);break;case a.CT_LEVEL:E=c(l);l.cu!=E?(q=1,l.cu=E):q=0;break;case a.CT_CHANGE:for(var E=l.Nd,l=l.zC,h=0;h<E.length;h++){var v=E[h].value;q||v==l[h]||(q=1);l[h]=v}break;default:C.U("Wrong sensor manifold type: "+l.type)}if(q&&(E=u==z?null:u,ga=!1,n.callback(E,n.id,q,n.fz),ga)){f=-1;break}}for(f=
0;f<r.length;f++)for(u=r[f],g=u.Rf,k=0;k<g.length;k++)for(n=g[k],u=n.Nd,n=0;n<u.length;n++)switch(q=u[n],q.type){case 30:b(q,0);break;case 40:b(q,0);break;case 60:b(q,0);break;case 70:b(q,0);break;case 130:b(q,0)}H=0;X=V;fa=ba;R.set(ha);W.set(aa);ja=da;L++};a.create_custom_sensor=function(a){var c=e(10);b(c,a);return c};a.create_keyboard_sensor=function(a){var b=e(20);b.key=a;return b};a.create_collision_sensor=function(a,c,r){if(!a||!D.H(a))return q.error("Wrong collision object"),null;var d=e(80);
d.io=a;d.Ia=c;d.Xd=r;d.ja={coll_obj:null,coll_pos:r?new Float32Array(3):null,coll_norm:r?new Float32Array(3):null,coll_dist:0};d.ho=function(a,c,r,z,e){b(d,a);a=d.ja;a.coll_obj=c;d.Xd&&(a.coll_pos.set(r),a.coll_norm.set(z),a.coll_dist=e)};d.Fd=!0;return d};a.create_collision_impulse_sensor=function(a){if(!a||!a.m)return q.error("Wrong collision impulse object"),null;var c=e(90);c.fo=a;c.xs=function(a){b(c,a)};c.Fd=!0;return c};a.create_ray_sensor=function(a,c,r,d,z,f,H){var g=e(100);g.We=a;g.from=
c;g.to=r;g.Ia=d;g.St=z;g.Xd=f;g.im=H;g.ja={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3)};g.Xu=function(a,c,r,d,z,e){g.St?b(g,-1==c?0:1):b(g,c);g.ja.hit_fract=c;g.ja.obj_hit=r;g.ja.hit_time=d;g.Xd&&(g.ja.hit_pos.set(z),g.ja.hit_norm.set(e))};g.Fd=!0;return g};a.create_mouse_click_sensor=function(){return e(50)};a.create_mouse_wheel_sensor=function(){return e(30)};a.create_mouse_move_sensor=function(a){var b=e(40);b.axis=a||"XY";b.ja="XY"==b.axis?new Float32Array(2):
0;return b};a.create_touch_move_sensor=function(a){var b=e(60);b.axis=a||"XY";b.ja=0;return b};a.create_touch_zoom_sensor=function(){var a=e(70);a.ja=0;return a};a.create_motion_sensor=function(a,b,c){if(!a)return q.error("Wrong collision object"),null;var r=e(110);r.We=a;var d=a.f.i;a=a.f.quat;r.Uu=new Float32Array(4);r.bj=new Float32Array(d);r.Lm=new Float32Array(a);r.tl=0;r.sl=0;r.threshold=b||.1;r.ev=c||.1;r.dd=0;r.ja=new Float32Array([0,0]);return r};a.create_vertical_velocity_sensor=function(a,
b){if(!a)return q.error("Wrong collision object"),null;var c=e(120);c.We=a;var r=a.f.quat;c.bj=new Float32Array(a.f.i);c.Lm=new Float32Array(r);c.ul=0;c.threshold=b||1;c.dd=0;c.ja=0;return c};a.create_timer_sensor=function(a,b){var c=e(130);c.Vc=a;c.repeat=b;c.Fd=!0;return c};a.reset_timer_sensor=function(a,b,c,r){a=a||z;a=a.Md;if(!a||!a[b])return q.error("reset_timer_sensor(): wrong object"),null;b=a[b].Nd[c];if(!b)return q.error("reset_timer_sensor(): sensor not found"),null;b.dd=J.get_timeline();
b.Vc=r};a.create_elapsed_sensor=function(){var a=e(140);a.dd=0;return a};a.create_gyro_delta_sensor=function(){var a=e(170);a.ja=new Float32Array(3);return a};a.create_gyro_angles_sensor=function(){var a=e(180);a.ja=new Float32Array(3);return a};a.create_timeline_sensor=function(){return e(150)};a.create_selection_sensor=function(a,b){var c=e(160);c.We=a;c.Yr=b;return c};a.mE=b;a.get_sensor_value=function(a,b,c){a=a||z;a=a.Md;if(!a||!a[b])return q.error("get_sensor_value(): wrong object"),null;b=
a[b].Nd[c];return b?b.value:(q.error("get_sensor_value(): sensor not found"),null)};a.get_sensor_payload=function(a,b,c){a=a||z;a=a.Md;if(!a||!a[b])return q.error("get_sensor_payload(): wrong object"),null;b=a[b].Nd[c];return b?b.ja:(q.error("get_sensor_payload(): sensor not found"),null)};a.cleanup=function(){r=[];K=[];z={}};a.check_sensor_manifold=function(a,b){a=a||z;if(!a.Md)return!1;if(b&&a.Md[b])return!0;if(!b)for(var c in a.Md)return!0;return!1};a.remove_sensor_manifold=function(a,b){a=a||
z;var c=a.Md;if(c){var d=a.Rf;if(b){var e=c[b];if(e){for(var H=e.Nd,g=0;g<H.length;g++)1===f(H[g],r)&&l(H[g],K);delete c[b];e=d.indexOf(e);-1<e?d.splice(e,1):C.U("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||m(a)}}else{for(b in c){e=c[b];H=e.Nd;for(g=0;g<H.length;g++)1===f(H[g],r)&&l(H[g],K);delete c[b];e=d.indexOf(e);-1<e?d.splice(e,1):C.U("Incorrect manifolds array")}m(a);ga=!0}}};a.create_sensor_manifold=function(a,b,c,d,e,H,g){a=a||z;a.Rf=a.Rf||[];a.Md=a.Md||{};var q=a.Md,
k=a.Rf,u=q[b];if(u){d=u.Nd;for(var n=0;n<d.length;n++)1===f(d[n],r)&&l(d[n],K);u=k.indexOf(u);-1<u?k.splice(u,1):C.U("Incorrect manifolds array")}c={id:b,type:c,Nd:d.slice(0),UC:e,nE:Array(d.length),callback:H,fz:g,Me:-1,cu:0,zC:Array(d.length),aw:-1};q[b]=c;k.push(c);-1==r.indexOf(a)&&r.push(a);a=c.Nd;for(b=0;b<a.length;b++){q=a[b];if(q.Fd){switch(q.type){case 80:D.append_collision_test(q.io,q.Ia,q.ho,q.Xd);break;case 90:D.apply_collision_impulse_test(q.fo,q.xs);break;case 100:q.Yu=D.append_ray_test(q.We,
q.from,q.to,q.Ia,q.Xu,!1,!1,q.Xd,q.im);break;case 130:q.dd=J.get_timeline(),0>q.Vc&&(q.Vc=-q.Vc)}q.Fd=!1}-1==K.indexOf(q)&&K.push(q)}ga=!0};a.Ps=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.yA=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.reset=function(){for(var a=0;a<r.length;a++){var b=r[a],c=b.Md,b=b.Rf,d;for(d in c)delete c[d];b.splice(0,b.length)}for(a=0;a<K.length;a++)l(K[a],K),a--;r.splice(0,r.length)};a.debug=function(){q.log(String(r.length)+
" objects with manifolds",r);q.log(String(K.length)+" sensors",K);for(var a=[],b=[],c=0;c<K.length;c++){var d=K[c];80==d.type&&a.push(d);100==d.type&&b.push(d)}q.log(String(a.length)+" collision sensors",a);q.log(String(b.length)+" ray sensors",b)};a.register_keyboard_events=function(a,b){a.addEventListener("keydown",h,!1);a.addEventListener("keyup",t,!1);O=b};a.register_mouse_events=function(a,b,c){if(c)var r=window;else r=a,r.addEventListener("mouseout",n,!1);a.addEventListener("mousedown",d,!1);
r.addEventListener("mousemove",k,!1);r.addEventListener("mouseup",g,!1);S=b;oa=c};a.register_wheel_events=function(a,b){a.addEventListener("mousewheel",x,!1);a.addEventListener("DOMMouseScroll",x,!1);ua=b};a.register_touch_events=function(a,b){a.addEventListener("touchstart",I,!1);a.addEventListener("touchmove",A,!1);document.addEventListener("touchstart",function(){});P=b};a.register_device_orientation=function(){window.DeviceOrientationEvent&&E.gyro_use&&window.addEventListener("deviceorientation",
B,!1)};a.unregister_keyboard_events=function(a){a.removeEventListener("keydown",h,!1);a.removeEventListener("keyup",t,!1)};a.unregister_mouse_events=function(a){a.removeEventListener("mousedown",d,!1);a.removeEventListener("mousemove",k,!1);a.removeEventListener("mouseout",n,!1);a.removeEventListener("mouseup",g,!1)};a.unregister_wheel_events=function(a){a.removeEventListener("mousewheel",x,!1);a.removeEventListener("DOMMouseScroll",x,!1)};a.unregister_touch_events=function(a){a.removeEventListener("touchstart",
I,!1);a.removeEventListener("touchmove",A,!1);document.removeEventListener("touchstart",function(){})};a.unregister_device_orientation=function(){window.DeviceOrientationEvent&&E.gyro_use&&window.removeEventListener("deviceorientation",B,!1)};a.nH=function(a){la=a};a.oH=function(a){ea=a};a.qH=function(a){Y=a};a.pH=function(a){U=a}};b4w.module.__curve=function(a,p){function e(a,b,c,e,d){var g=e.length;d||(d=new Float32Array(g));for(var k=g+a,n=new Float32Array(k),m=1;m<=k-1;m++)n[m-1]=b>=c[m-1]&&b<c[m+1-1]?1:0;for(var p=2;p<=a;p++)for(m=1;m<=k-p;m++)n[m-1]=(0!=n[m-1]?(b-c[m-1])*n[m-1]/(c[m+p-1-1]-c[m-1]):0)+(0!=n[m+1-1]?(c[m+p-1]-b)*n[m+1-1]/(c[m+p-1]-c[m+1-1]):0);b==c[k-1]&&(n[g-1]=1);a=0;for(m=1;m<=g;m++)a+=n[m-1]*e[m-1];for(m=1;m<=g;m++)d[m-1]=0!=a?n[m-1]*e[m-1]/a:0;return d}function b(a){a=a.qm;return a[a.length-1]}function c(a){a=
a.Ls;return a[a.length-1]}p("__print");var m=p("__util");a.hA=function(a){var b={},c=a.data;a=c.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var m=a.order_u;b.Gf=m;a=a.points;var d=a.length/5,g=[],k=d+m,d=d+2;g[0]=0;for(var n=2;n<=k;n++)g[n-1]=n>m&&n<d?g[n-2]+1:g[n-2];b.qm=g;if("2D"==c.dimensions)b.Af=!1;else if("3D"==c.dimensions)b.Af=!0;else throw"Wrong curve dimensions";m=[];g=[];for(c=0;c<a.length;c+=5)m.push(a[c]),m.push(a[c+1]),m.push(a[c+2]),b.Af&&m.push(a[c+3]),g.push(a[c+
4]);b.no=m;b.mr=g;a=[];for(var c=b.no,m=b.Af?4:3,g=b.mr,k=b.qm,d=b.Gf,n=c.length/m,x=n+d,p=0,A=k[x-1]/999,B=0;1E3>B;B++){5E-6>k[x-1]-p&&(p=k[x-1]);for(var y=e(d,p,k,g),v=0;v<m;v++)for(var F=a[m*B+v]=0;F<n;F++)a[m*B+v]+=y[F]*c[m*F+v];p+=A}m=b.Af?4:3;g=new Float32Array(1E3);g[0]=0;for(c=1;1E3>c;c+=1)k=a[(c-1)*m],d=a[(c-1)*m+1],n=a[(c-1)*m+2],x=a[c*m],p=a[c*m+1],A=a[c*m+2],g[c]=g[c-1]+Math.sqrt((x-k)*(x-k)+(p-d)*(p-d)+(A-n)*(A-n));b.Ls=g;return b};a.ZE=function(a,c,m){m||(m=[]);var t=c,d=Math.max(t,
0);c=d=Math.min(t,b(a));var t=a.no,d=a.Af?4:3,g=a.mr,k=a.qm,n=a.Gf;a=t.length/d;var x=a+n;5E-6>k[x-1]-c&&(c=k[x-1]);x=new Float32Array(a);e(n,c,k,g,x);for(c=0;c<d;c++)for(g=m[c]=0;g<a;g++)m[c]+=x[g]*t[d*g+c]};a.WE=function(a,b,c){c||(c=[]);var e=a.no,d=a.Af?4:3,g=a.mr,k=a.qm,n=a.Gf;a=e.length/d;var m=a+n;5E-6>k[m-1]-b&&(b=k[m-1]);var m=new Float32Array(a),p=b;b=m;var A=g.length;b||(b=new Float32Array(A));var B=new Float32Array(A),y=new Float32Array(A),v=B,F=y;v||(v=new Float32Array(A));F||(F=new Float32Array(A));
for(var u=A+n,q=new Float32Array(u),D=new Float32Array(u),w=1;w<=u-1;w++)q[w-1]=p>=k[w-1]&&p<k[w+1-1]?1:0;p==k[u-1]&&(q[A-1]=1);for(var J=2;J<=n;J++)for(w=1;w<=u-J;w++){var C=0!=q[w-1]?q[w-1]/(k[w+J-1-1]-k[w-1]):0,M=0!=q[w+1-1]?-q[w+1-1]/(k[w+J-1]-k[w+1-1]):0,G=0!=D[w-1]?(p-k[w-1])*D[w-1]/(k[w+J-1-1]-k[w-1]):0,E=0!=D[w+1-1]?(k[w+J-1]-p)*D[w+1-1]/(k[w+J-1]-k[w+1-1]):0;q[w-1]=(0!=q[w-1]?(p-k[w-1])*q[w-1]/(k[w+J-1-1]-k[w-1]):0)+(0!=q[w+1-1]?(k[w+J-1]-p)*q[w+1-1]/(k[w+J-1]-k[w+1-1]):0);D[w-1]=C+M+G+E}for(w=
1;w<=A;w++)v[w-1]=q[w-1],F[w-1]=D[w-1];k=0;for(n=1;n<=A;n++)k+=B[n-1]*g[n-1];p=0;for(n=1;n<=A;n++)p+=y[n-1]*g[n-1];for(n=1;n<=A;n++)b[n-1]=0!=k?y[n-1]*g[n-1]/k+B[n-1]*g[n-1]*p/(k*k):0;for(g=0;g<d;g++)for(k=c[g]=0;k<a;k++)c[g]+=m[k]*e[d*k+g]};a.jJ=b;a.YE=c;a.XE=function(a,e){if(0>=e)return 0;var h=b(a);if(e>=c(a))return h;var t=a.Ls,d=m.wl(t,e,0,t.length-1);return h*(d+(e-t[d])/(t[d+1]-t[d]))/1E3}};b4w.module.__dds=function(a,p){function e(a,b,c,d){var e=new Uint16Array(4),f=new Uint16Array(c*d),l=0,m=0,h=0,F=m=l=0,u=0,q=0,D=0,w=c/4;d/=4;for(var t=0;t<d;t++)for(var C=0;C<w;C++)h=b+4*(t*w+C),e[0]=a[h],e[1]=a[h+1],l=e[0]&31,m=e[0]&2016,F=e[0]&63488,u=e[1]&31,q=e[1]&2016,D=e[1]&63488,e[2]=5*l+3*u>>3|5*m+3*q>>3&2016|5*F+3*D>>3&63488,e[3]=5*u+3*l>>3|5*q+3*m>>3&2016|5*D+3*F>>3&63488,l=a[h+2],m=4*t*c+4*C,f[m]=e[l&3],f[m+1]=e[l>>2&3],f[m+2]=e[l>>4&3],f[m+3]=e[l>>6&3],m+=c,f[m]=e[l>>8&3],f[m+1]=e[l>>
10&3],f[m+2]=e[l>>12&3],f[m+3]=e[l>>14],l=a[h+3],m+=c,f[m]=e[l&3],f[m+1]=e[l>>2&3],f[m+2]=e[l>>4&3],f[m+3]=e[l>>6&3],m+=c,f[m]=e[l>>8&3],f[m+1]=e[l>>10&3],f[m+2]=e[l>>12&3],f[m+3]=e[l>>14];return f}function b(a,b,c,m){var p=new Int32Array(c,0,31),A,B,y,v,F,u;if(542327876!=p[0])return l.error("Invalid magic number in DDS header"),0;if(!p[20]&4)return l.error("Unsupported format, must contain a FourCC code"),0;A=p[21];switch(A){case h:B=8;y=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case t:B=16;y=
b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case d:B=16;y=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return l.error("Unsupported FourCC code:",f(A)),null}u=1;p[2]&131072&&!1!==m&&(u=Math.max(1,p[7]));v=p[4];F=p[3];p=p[1]+4;if(b)for(A=0;A<u;++A)m=Math.max(4,v)/4*Math.max(4,F)/4*B,b=new Uint8Array(c,p,m),a.compressedTexImage2D(a.TEXTURE_2D,A,y,v,F,0,b),p+=m,v=Math.max(.5*v,1),F=Math.max(.5*F,1);else if(A==h)Math.max(4,v),Math.max(4,F),b=new Uint16Array(c),c=e(b,p/2,v,F),a.texImage2D(a.TEXTURE_2D,
0,a.RGB,v,F,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,c),m&&a.generateMipmap(a.TEXTURE_2D);else return l.error("No manual decoder for",f(A),"and no native support"),0;return u}function c(a,c,d,e,f,l){var m=new XMLHttpRequest;m.open("GET",d,!0);m.responseType="arraybuffer";m.onload=function(){if(200==m.status){a.bindTexture(a.TEXTURE_2D,e);var d=b(a,c,m.response,f);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<d?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}l&&
l(e)};m.send(null);return e}function m(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function f(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var l=p("__print"),h=m("DXT1"),t=m("DXT3"),d=m("DXT5");a.QH=e;a.ZF=b;a.Dt=function(a){a=new Int32Array(a,0,31);return{width:a[4],height:a[3]}};a.DB=function(a){var b=1;a=(new Int32Array(a,0,31))[21];switch(a){case h:b=6;break;case t:case d:b=4;break;default:l.error("Unsupported FourCC code:",f(a))}return b};
a.NI=c;a.MI=function(a,b,d,e){var f=a.createTexture();c(a,b,d,f,!0,e);return f}};b4w.module.__debug=function(a,p){function e(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function b(a,b){typeof a!=typeof b&&h.U("Structure assertion failed: incompatible types");if(null!==a&&null!==b&&"object"==typeof a){for(var c in a)c in b||h.U("Structure assertion failed: missing key in the first object: "+c);for(c in b)c in a||h.U("Structure assertion failed: missing key in the second object: "+c),typeof a[c]!=typeof b[c]&&h.U("Structure assertion failed: incompatible types for key "+
c)}}var c=p("__extensions"),m=p("__print"),f=p("__textures"),l=p("__time"),h=p("__util"),t=p("__graph"),d=null,g={},k=!1,n={},x=[],I=-1,A=null,B=!1;a.WM_NONE=0;a.WM_OPAQUE_WIREFRAME=1;a.WM_TRANSPARENT_WIREFRAME=2;a.WM_FRONT_BACK_VIEW=3;a.WM_DEBUG_SPHERES=4;a.$c=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;for(c in b){var e=b[c];e in a&&(g[a[e]]=e)}d=a};a.sz=function(a){if(k){var b=d.getError();b!=d.NO_ERROR&&
(b in g?h.U("GL Error: "+b+", gl."+g[b]+" ("+a+")"):h.U("Unknown GL error: "+b+" ("+a+")"))}};a.nz=function(){if(k)switch(d.checkFramebufferStatus(d.FRAMEBUFFER)){case d.FRAMEBUFFER_COMPLETE:break;case d.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:m.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case d.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:m.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case d.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:m.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");
break;case d.FRAMEBUFFER_UNSUPPORTED:m.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;default:m.error("FRAMEBUFFER CHECK FAILED")}};a.rs=function(){if(-1!=I)return I;d.bindFramebuffer(d.FRAMEBUFFER,d.createFramebuffer());var a=f.Nl("DEBUG",f.nj);f.resize(a,1,1);d.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,a.xb,a.Qa,0);d.checkFramebufferStatus(d.FRAMEBUFFER)!=d.FRAMEBUFFER_COMPLETE?(I=!0,m.warn("depth-only issue was found")):I=!1;d.bindFramebuffer(d.FRAMEBUFFER,null);return I};
a.tz=function(a,b,c){if(k&&!d.getShaderParameter(a,d.COMPILE_STATUS))throw c=e(c),m.error("shader compilation failed:\n"+c+"\n"+d.getShaderInfoLog(a)+" ("+b+")"),"Engine failed: see above for error messages";};a.uz=function(a,b,f,g,n,w){if(k&&!d.getProgramParameter(a,d.LINK_STATUS)){var l=c.st();l&&(n=l.getTranslatedShaderSource(f),w=l.getTranslatedShaderSource(g));n=e(n);w=e(w);m.error("shader linking failed:\n"+n+"\n\n\n"+w+"\n"+d.getProgramInfoLog(a)+" ("+b+")");throw"Engine failed: see above for error messages";
}};a.set_check_gl_errors=function(a){k=a};a.RH=function(a){n[a]=a in n?n[a]+1:1};a.update=function(){for(var a in n)m.log(a,n[a]),n[a]=0};a.fbmsg=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(h.is_vector(c))for(var d=0;d<c.length;d++)a.push(c[d]);else a.push(arguments[b])}x.push(a)};a.msg=function(){for(var a=1,b=0;b<x.length;b++){var c=x[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],h.is_vector(a))for(var d=0;d<a.length;d++)c.push(a[d]);
else c.push(arguments[b]);x.push(c)};var y=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.print_telemetry=function(a){a||(a=1);for(var b=0,c={},d=Math.max(0,performance.now()-1E3*a),e=0;e<x.length;e++){var f=x[e];a=f[0];if(!(a<d)){var g=String(f[1]);c[g]||(c[g]=y[b++%y.length]);a=["%c"+(a/1E3).toFixed(6),c[g],g];for(g=2;g<f.length;g++)a.push(f[g]);m.log.apply(this,a)}}x.splice(0)};a.plot_telemetry=function(a){a||(a=1);for(var b={},c=Math.max(0,performance.now()-
1E3*a),d=0;d<x.length;d++){var e=x[d];a=e[0];if(!(a<c))for(var f=2;f<e.length;f++){var g=String(e[1]);3<e.length&&(g+="_"+String(f-2));b[g]||(b[g]=g+"\n");b[g]+=String(a)+" "+e[f]+"\n"}}a="";for(g in b)a+=b[g]+"\n\n";m.log(a);x.splice(0)};a.AH=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&
b("trident")&&b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.check_finite=function(a){if(h.is_vector(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.kH=function(a,b){a.constructor!=b&&h.U("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.lH=b;a.mH=function(a){B?b(a,A):B=!0;A=a};a.fake_load=
function(a,b,c,d,e){(a=a||null)||h.U("Stage load callback is undefined");b=b||5E3;c=c||0;d=d||100;100<d&&h.U("Max percentage must be less than 100");0>c&&h.U("Min percentage must be greater than 0");c>d&&h.U("Max percentage must be greater than min percentage");var f=l.animate(c,d,b,function(b){b=b.toFixed();a(b);100==b&&(l.clear_animation(f),e&&e())})};a.UI=function(a){return t.uA(a,function(a,b){return b.type},function(b,c,d){b=t.Ja(a,b);c=t.Ja(a,c);return b.la[d[0]].identifier+"\n==>\n"+c.C[d[1]].identifier})}};b4w.module.__extensions=function(a,p){function e(a){if(a in m)return m[a];var e=c.getExtension(a)||null;m[a]=e;b.log("%cGET EXTENSION","color: #"+(e?"0a0":"a00"),a);return e}var b=p("__print"),c=null,m={};a.$c=function(a){c=a};a.Bt=function(){return e("WEBGL_compressed_texture_s3tc")||e("WEBKIT_WEBGL_compressed_texture_s3tc")||e("MOZ_WEBGL_compressed_texture_s3tc")};a.FB=function(){return e("WEBGL_depth_texture")||e("WEBKIT_WEBGL_depth_texture")||e("MOZ_WEBGL_depth_texture")};a.xB=function(){return e("EXT_texture_filter_anisotropic")||
e("WEBKIT_EXT_texture_filter_anisotropic")||e("MOZ_EXT_texture_filter_anisotropic")};a.st=function(){return e("WEBGL_debug_shaders")};a.At=function(){return e("WEBGL_debug_renderer_info")};a.tt=function(){return e("OES_element_index_uint")};a.SB=function(){return e("OES_standard_derivatives")};a.cleanup=function(){m={}}};b4w.module.__graph=function(a,p){function e(a,c,r){r||(r=null);if(b(a,c))throw"Graph already has node with given ID";a.J.push(c,r)}function b(a,b){for(var c=a.J,r=0;r<c.length;r+=2)if(c[r]==b)return!0;return!1}function c(a,c,r,d){d||(d=null);if(b(a,c)&&b(a,r))a.Y.push(c,r,d);else throw"Wrong node IDs";}function m(a,c){if(!b(a,c))throw"Node not found";for(var r=a.J,d=0;d<r.length;d+=2)r[d]==c&&(r.splice(d,2),d-=2)}function f(a,b,c,r){if(!J(a,b,c))throw"Edge not found";a=a.Y;for(var d=0,e=0;e<a.length;e+=
3)if(a[e]==b&&a[e+1]==c){if(-1==r)a.splice(e,3);else{if(r==d){a.splice(e,3);break}d++}e-=3}}function l(a){a=a.J;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function h(a,b){for(var c=a.J,r=0;r<c.length;r+=2)if(c[r+1]==b)return c[r];return-1}function t(a){var b=[],c={};d(a,c);for(var r=a.J,e=0;e<r.length;e+=2)0==q(a,r[e])&&g(a,r[e],c,b);return{J:b,Y:a.Y.slice(0)}}function d(a,b){for(var c=a.J,r=0;r<c.length;r+=2)b[c[r]]=!1}function g(a,b,c,r){if(!c[b]){c[b]=!0;for(var d=0;d<u(a,b);d++)g(a,
D(a,b,d),c,r);r.unshift(b,F(a,b))}}function k(a,b,c,r){if(!c[b]){c[b]=!0;if(10==r||30==r)for(var d=0;d<u(a,b);d++){var e=D(a,b,d);k(a,e,c,r)}if(20==r||30==r)for(d=0;d<q(a,b);d++)e=w(a,b,d),k(a,e,c,r)}}function n(a){for(var c=a.Y,r=0;r<c.length;r+=3){var d=c[r+1];b(a,c[r])&&b(a,d)||(c.splice(r,3),r-=3)}}function x(a){for(var b=[],c=a.J,r=0;r<c.length;r+=2){var d=c[r];u(a,d)||b.push(d)}return b}function I(a){var b=a.J;a=a.Y;for(var c=[],r=[],d=[],e=0;e<b.length;e++)d[b[2*e]]=e,c.push(e,b[2*e+1]);for(e=
0;e<a.length;e+=3)r.push(d[a[e]],d[a[e+1]],a[e+2]);return{J:c,Y:r}}function A(a,b,c){if(c.Yd==c.Ef){for(var d=0,e=0;d<c.Ef;d++)-1!=c.ye[d]&&(a[e]=d,b[e]=c.ye[d],e++);return!0}if(c.Ef>c.xi||c.Xf>c.Yf||c.Zi>c.aj||c.Yi>c.$i)return!1;for(var e=d=-1,f=!1;!f&&B(c,r,d,e);)if(d=r[0],e=r[1],y(c,d,e)){var g;g=c;f={};f.bk=g.bk;f.ck=g.ck;f.Pp=g.Pp;f.Vl=g.Vl;f.Ef=g.Ef;f.xi=g.xi;f.Gf=g.Gf;f.Yd=f.Am=g.Yd;f.Yi=g.Yi;f.Zi=g.Zi;f.Xf=g.Xf;f.$i=g.$i;f.aj=g.aj;f.Yf=g.Yf;f.qj=-1;f.ye=g.ye;f.Cg=g.Cg;f.Qg=g.Qg;f.Rg=g.Rg;
f.hh=g.hh;f.ih=g.ih;f.Um=g.Um;g.Um[0]+=1;var f=g=f,k=d,n=e,E=f.bk,l=f.ck,m=f.Ef,h=f.xi,G=f.ye,M=f.Cg,x=f.Qg,C=f.Rg,L=f.hh,O=f.ih;v(k<m);v(n<h);v(f.Yd<m);v(f.Yd<h);m=++f.Yd;f.qj=k;x[k]||(x[k]=m,f.Yi++,L[k]&&f.Xf++);L[k]||(L[k]=m,f.Zi++,x[k]&&f.Xf++);C[n]||(C[n]=m,f.$i++,O[n]&&f.Yf++);O[n]||(O[n]=m,f.aj++,C[n]&&f.Yf++);G[k]=n;M[n]=k;for(G=0;G<q(E,k);G++)M=w(E,k,G),x[M]||(x[M]=m,f.Yi++,L[M]&&f.Xf++);for(G=0;G<u(E,k);G++)M=D(E,k,G),L[M]||(L[M]=m,f.Zi++,x[M]&&f.Xf++);for(G=0;G<q(l,n);G++)M=w(l,n,G),C[M]||
(C[M]=m,f.$i++,O[M]&&f.Yf++);for(G=0;G<u(l,n);G++)M=D(l,n,G),O[M]||(O[M]=m,f.aj++,C[M]&&f.Yf++);f=A(a,b,g);v(1>=g.Yd-g.Am);v(-1!=g.qj);M=g.bk;k=g.ck;n=g.Yd;E=g.qj;l=g.ye;x=g.Cg;m=g.Qg;C=g.Rg;h=g.hh;L=g.ih;if(g.Am<n){m[E]==n&&(m[E]=0);for(O=0;O<q(M,E);O++)G=w(M,E,O),m[G]==n&&(m[G]=0);h[E]==n&&(h[E]=0);for(O=0;O<u(M,E);O++)G=D(M,E,O),h[G]==n&&(h[G]=0);M=l[E];C[M]==n&&(C[M]=0);for(O=0;O<q(k,M);O++)G=w(k,M,O),C[G]==n&&(C[G]=0);L[M]==n&&(L[M]=0);for(O=0;O<u(k,M);O++)G=D(k,M,O),L[G]==n&&(L[G]=0);l[E]=-1;
x[M]=-1;g.Yd=g.Am;g.qj=-1}}return f}function B(a,b,c,r){-1==c&&(c=0);-1==r?r=0:r++;var d=a.Xf,e=a.Yf,f=a.Zi,g=a.aj,k=a.Yi,q=a.$i,u=a.Yd,n=a.Ef,E=a.xi,l=a.ye,w=a.Cg,m=a.Qg,h=a.Rg,L=a.hh,D=a.ih;if(d>u&&e>u)for(;c<n&&(-1!=l[c]||0==L[c]||0==m[c]);)c++,r=0;else if(f>u&&g>u)for(;c<n&&(-1!=l[c]||0==L[c]);)c++,r=0;else if(k>u&&q>u)for(;c<n&&(-1!=l[c]||0==m[c]);)c++,r=0;else if(0==c&&0!=a.Gf){for(m=0;m<n&&-1!=l[c=a.Gf[m]];)m++;m==n&&(c=n)}else for(;c<n&&-1!=l[c];)c++,r=0;if(d>u&&e>u)for(;r<E&&(-1!=w[r]||0==
D[r]||0==h[r]);)r++;else if(f>u&&g>u)for(;r<E&&(-1!=w[r]||0==D[r]);)r++;else if(k>u&&q>u)for(;r<E&&(-1!=w[r]||0==h[r]);)r++;else for(;r<E&&-1!=w[r];)r++;return c<n&&r<E?(b[0]=c,b[1]=r,!0):!1}function y(a,b,c){var r=a.bk,d=a.ck,e=a.xi,f=a.ye,g=a.Cg,k=a.Qg,n=a.Rg,E=a.hh,l=a.ih;v(b<a.Ef);v(c<e);v(-1==f[b]);v(-1==g[c]);if(!(0,a.Pp)(F(r,b),F(d,c)))return!1;for(var m=e=0,h=0,G=0,M=0,x=0,L=0;L<u(r,b);L++){var O=D(r,b,L);if(-1!=f[O]){var S=f[O];if(!J(d,c,S)||!C(a.Vl,r,b,O,d,c,S))return!1}else k[O]&&h++,E[O]&&
e++,k[O]||E[O]||M++}for(L=0;L<q(r,b);L++)if(O=w(r,b,L),-1!=f[O]){if(S=f[O],!J(d,S,c)||!C(a.Vl,r,O,b,d,S,c))return!1}else k[O]&&h++,E[O]&&e++,k[O]||E[O]||M++;for(L=0;L<u(d,c);L++)if(S=D(d,c,L),-1!=g[S]){if(O=g[S],!J(r,b,O))return!1}else n[S]&&G++,l[S]&&m++,n[S]||l[S]||x++;for(L=0;L<q(d,c);L++)if(S=w(d,c,L),-1!=g[S]){if(O=g[S],!J(r,O,b))return!1}else n[S]&&G++,l[S]&&m++,n[S]||l[S]||x++;return h<=G&&e<=m&&M<=x}function v(a){if(!a)throw"Assertion failed";}function F(a,b){for(var c=a.J,r=0;r<c.length;r+=
2)if(c[r]==b)return c[r+1];return null}function u(a,b){for(var c=a.Y,r=0,d=0;d<c.length;d+=3)c[d]==b&&r++;return r}function q(a,b){for(var c=a.Y,r=0,d=0;d<c.length;d+=3)c[d+1]==b&&r++;return r}function D(a,b,c){a=a.Y;for(var r=0,d=0;d<a.length;d+=3)if(a[d]==b){if(r==c)return a[d+1];r++}return-1}function w(a,b,c){a=a.Y;for(var r=0,d=0;d<a.length;d+=3)if(a[d+1]==b){if(r==c)return a[d];r++}return-1}function J(a,b,c){a=a.Y;for(var r=0;r<a.length;r+=3)if(a[r]==b&&a[r+1]==c)return!0;return!1}function C(a,
b,c,r,d,e,f){for(var g=M(b,c,r),k=M(d,e,f),q=0;q<g;q++){for(var u=!1,n=0;n<k;n++)if(a(G(b,c,r,q),G(d,e,f,n))){u=!0;break}if(!u)return!1}return!0}function M(a,b,c){var r=0;a=a.Y;for(var d=0;d<a.length;d+=3)a[d]==b&&a[d+1]==c&&r++;return r}function G(a,b,c,r){a=a.Y;for(var d=0,e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==c){if(d==r)return a[e+2];d++}return null}p("__print");var E=p("__util"),r=[-1,-1];a.xr=-1;a.$G=10;a.tn=20;a.dH=30;a.create=function(){for(var a=arguments,b=[],c=[],r=0;r<a.length;r++){var d=
a[r];switch(d.length){case 2:b.push(d[0],d[1]);break;case 3:c.push(d[0],d[1],d[2]);break;default:throw"Wrong graph constructor params";}}return{J:b,Y:c}};a.clone=function(a,b,c){if(b)for(var r=Array(a.J.length),d=0;d<a.J.length;d+=2)r[d]=a.J[d],r[d+1]=b(a.J[d+1]);else r=E.qa(a.J);if(c)for(b=Array(a.Y.length),d=0;d<a.Y.length;d+=3)b[d]=a.Y[d],b[d+1]=a.Y[d+1],b[d+2]=c(a.Y[d+2]);else b=E.qa(a.Y);return a={J:r,Y:b}};a.HH=function(a,b){for(var c=[],r=[],d=0;d<a.length;d++)c.push(a[d][0],a[d][1]);for(d=
0;d<b.length;d++)r.push(b[d][0],b[d][1],b[d][2]);return{J:c,Y:r}};a.Mh=e;a.sI=b;a.Zb=c;a.Qf=m;a.ph=f;a.Pm=function(a,b,c,r){if(!J(a,b,c))throw"Edge not found";a=a.Y;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c&&a[d+2][0]==r[0]&&a[d+2][1]==r[1]){a.splice(d,3);break}};a.u=function(a,b){if(-1==h(a,b)){var c=l(a);e(a,c,b);return c}throw"Non-unique attribute";};a.ZD=function(a,b,c,r,d){a=a.Y;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&a[e+2]==r&&(a[e+2]=d)};a.dk=l;a.dh=h;a.n=function(a,b,r,d){b=
h(a,b);r=h(a,r);if(-1!=b&&-1!=r)c(a,b,r,d);else throw"Attributes not found";};a.W=function(a,b){for(var c=a.J,r=0;r<c.length&&!b(c[r],c[r+1]);r+=2);};a.ne=function(a,b){for(var c=a.Y,r=0;r<c.length&&!b(c[r],c[r+1],c[r+2]);r+=3);};a.af=function(a,b,c){for(var r=a.Y,d=0;d<r.length;d+=3)if(r[d+1]==b){var e=r[d];if(c(e,F(a,e),r[d+2]))break}};a.ag=function(a,b,c){for(var r=a.Y,d=0;d<r.length;d+=3)if(r[d]==b){var e=r[d+1];if(c(e,F(a,e),r[d+2]))break}};a.Sq=t;a.pF=function(a){a=t(a).J;for(var b=[],c=0;c<
a.length;c+=2)b.push(a[c+1]);return b};a.DI=function(){};a.Hq=function(a,c,r){if(!b(a,c))throw"No such node";var e={};d(a,e);k(a,c,e,r);c=[];for(var f in e)e[f]&&(f=Number(f),c.push(f,F(a,f)));a={J:c,Y:a.Y.slice(0)};n(a);return a};a.Cz=n;a.RB=function(a){for(var b=[],c=a.J,r=0;r<c.length;r+=2){var d=c[r];q(a,d)||b.push(d)}return b};a.$o=x;a.match=function(a,b,c,r){var d={};d.bk=I(a);d.ck=I(b);d.Pp=c||function(a,b){return a==b};d.Vl=r||function(a,b){return a==b};r=a.J.length/2;var e=b.J.length/2;d.Ef=
r;d.xi=e;d.Gf=0;d.Yd=d.Am=0;d.Xf=d.Yi=d.Zi=0;d.Yf=d.$i=d.aj=0;d.qj=-1;d.ye=Array(r);d.Cg=Array(e);d.Qg=Array(r);d.Rg=Array(e);d.hh=Array(r);d.ih=Array(e);d.Um=[1];for(c=0;c<r;c++)d.ye[c]=-1,d.Qg[c]=0,d.hh[c]=0;for(c=0;c<e;c++)d.Cg[c]=-1,d.Rg[c]=0,d.ih[c]=0;e=Array(r);r=Array(r);if(A(e,r,d)){for(c=0;c<e.length;c++)e[c]=a.J[2*e[c]],r[c]=b.J[2*r[c]];return[e,r]}return null};a.Ja=F;a.Hf=u;a.lp=q;a.wf=D;a.fk=w;a.hI=M;a.Je=G;a.replace=function(a,b,c){for(var r=a.Y,d=l(a),f=0;f<b.length;f++){var g=b[f];
m(a,g);for(var k=0;k<r.length;k+=3)r[k]==g&&(r[k]=d),r[k+1]==g&&(r[k+1]=d),r[k]==r[k+1]&&(r.splice(k,3),k-=3)}e(a,d,c)};a.RD=function(a,b,c,r,d){if(!J(a,b,c))throw"Edge not found";a=a.Y;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&(a[e]=r,a[e+1]=d)};a.NA=function(a,b){function c(a,b){if(-1!=k.indexOf(a)){var r=k.slice(k.indexOf(a));if(-1!=d[r[r.length-1]].indexOf(r[0])){q.push([a,r[r.length-1]]);return}}k.push(a);for(r=0;r<b.length;r++)b[r]in d&&c(b[r],d[b[r]])}b||(b=x(a)[0]);var r=a.Y;if(r.length){for(var d=
{},e=0,g=0;g<r.length;g+=3)r[g+1]in d?d[r[g+1]].push(r[g]):d[r[g+1]]=[r[g]],e++;var k=[],q=[];c(b,d[b]);for(g=0;g<q.length;g++)for(var u=e=0;u<r.length;u+=3)q[g][1]==r[u+1]&&q[g][0]==r[u]&&f(a,r[u],r[u+1],e),e++}};a.uA=function(a,b,c){var r=a.J;a=a.Y;var d;d="digraph debug {\n    node [shape=box];\n";for(var e=0;e<r.length;e+=2){var f=r[e],g=r[e+1],g=b?b(f,g):String(f);d+="    ";d+=String(f)+' [label="'+g.replace(/\"/g,'\\"')+'"];\n'}for(e=0;e<a.length;e+=3)b=a[e],r=a[e+1],g=a[e+2],d+="    ",d+=String(b)+
" -> "+String(r),c&&(d+=' [label="'+c(b,r,g)+'"]'),d+=";\n";return d+="}"}};b4w.module.__ipc=function(a,p){function e(a,b,c){for(var d=0;d<k.length;d+=2)k[d+1]==a&&(g[d+Number(!b)]=c)}function b(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,e;for(e in c){var f=c[e];switch(f.constructor){case Float32Array:d+=f.length;break;case Number:d+=1}}--d;c.len=d}}a.Xw=0;var c=a.Pw=1,m=a.Rw=2;a.Qw=3;a.Tw=4;a.Uw=5;a.Vw=6;a.Yw=7;var f=a.$w=8,l=a.wr=9,h=a.ax=10;a.bx=11;var t=a.cx=12;a.dx=13;a.Zw=14;a.Ww=15;a.Sw=16;a.Ex=100;a.fx=101;a.gx=102;a.hx=103;a.ix=104;a.kx=105;a.jx=106;a.lx=107;
a.mx=108;a.nx=109;a.ox=110;a.px=111;a.qx=112;a.sx=113;a.tx=114;a.Hx=115;a.ux=116;a.vx=117;a.wx=118;a.yx=119;a.zx=120;a.Ax=121;a.Cx=122;a.Dx=123;a.Fx=124;a.rx=125;a.Jx=126;a.xx=127;a.zr=128;a.Ix=129;a.Kx=130;a.Lx=131;a.Mx=132;a.Nx=133;a.Ox=134;a.Px=135;a.Qx=136;a.Rx=137;a.Sx=138;a.Tx=139;a.Ar=140;var d=a.gl=141;a.Ux=142;a.yr=143;a.Vx=144;a.Wx=145;a.Gx=146;a.Bx=147;a.Xx=148;var g=b4w.worker_listeners,k=b4w.worker_namespaces,n={Uc:t,t:0,time:0,i:new Float32Array(3),quat:new Float32Array(4),be:new Float32Array(3),
Rd:new Float32Array(3),len:0},x={Uc:f,co:0,cq:0,i:new Float32Array(3),quat:new Float32Array(4),len:0},I={Uc:l,id:0,Ph:0,hit_fract:0,hit_time:0,len:0},A={Uc:h,id:0,Ph:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},B={Uc:c,vg:0,wg:0,result:0,len:0},y={Uc:m,vg:0,wg:0,result:0,Bg:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},v={Uc:d,t:0,i:new Float32Array(3),quat:new Float32Array(4),len:0},F=[n,x,I,A,B,y,v];a.nA=function(a,b){var c={pm:a?
!0:!1,jg:null,Wd:[],Ge:""};if(b)if(c.jg={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");e(c.Ge,c.pm,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");e(c.Ge,c.pm,null)},postMessage:function(a){var b;a:{for(b=0;b<k.length;b+=2)if(k[b+1]==c.Ge){b=g[b+Number(!!c.pm)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<k.length;a+=2)if(k[a+1]==c.Ge){g.splice(a,2);k.splice(a,2);break}}},c.pm){var d=p("__util"),f=p("__container"),
n=b4w.get_namespace(p),d=d.cj(n+"_worker");k.push(n);k.push(d);g.push(null);g.push(null);c.Ge=d;f.ct(a)?(f=f.ct(a),f.addEventListener("load",function(){b4w.require("__bindings",c.Ge)},!1)):(f=document.createElement("script"),f.src=a,f.defer="defer",f.async="async",f.addEventListener("load",function(){b4w.require("__bindings",c.Ge)},!1),document.head.appendChild(f))}else c.Ge=b4w.get_namespace(p);else c.jg=a?new Worker(a):self;return c};a.Py=function(a,e){function g(b){if(b.constructor==ArrayBuffer)b=
new Float32Array(b);else if(b[0].constructor==ArrayBuffer){for(var k=0;k<b.length;k++)g(b[k]);return}k=b[0]|0;switch(k){case t:var C=n;C.t=b[1]|0;C.time=b[2];C.i[0]=b[3];C.i[1]=b[4];C.i[2]=b[5];C.quat[0]=b[6];C.quat[1]=b[7];C.quat[2]=b[8];C.quat[3]=b[9];C.be[0]=b[10];C.be[1]=b[11];C.be[2]=b[12];C.Rd[0]=b[13];C.Rd[1]=b[14];C.Rd[2]=b[15];break;case f:C=x;C.co=b[1]|0;C.cq=b[2]|0;C.i[0]=b[3];C.i[1]=b[4];C.i[2]=b[5];C.quat[0]=b[6];C.quat[1]=b[7];C.quat[2]=b[8];C.quat[3]=b[9];break;case l:C=I;C.id=b[1]|
0;C.Ph=b[2]|0;C.hit_fract=b[3];C.hit_time=b[4];break;case h:C=A;C.id=b[1]|0;C.Ph=b[2]|0;C.hit_fract=b[3];C.hit_time=b[4];C.hit_pos[0]=b[5];C.hit_pos[1]=b[6];C.hit_pos[2]=b[7];C.hit_norm[0]=b[8];C.hit_norm[1]=b[9];C.hit_norm[2]=b[10];break;case c:C=B;C.vg=b[1]|0;C.wg=b[2]|0;C.result=!!b[3];break;case m:C=y;C.vg=b[1]|0;C.wg=b[2]|0;C.result=!!b[3];C.Bg[0]=b[4];C.Bg[1]=b[5];C.Bg[2]=b[6];C.coll_norm[0]=b[7];C.coll_norm[1]=b[8];C.coll_norm[2]=b[9];C.coll_dist=b[10];break;case d:C=v;C.t=b[1]|0;C.i[0]=b[2];
C.i[1]=b[3];C.i[2]=b[4];C.quat[0]=b[5];C.quat[1]=b[6];C.quat[2]=b[7];C.quat[3]=b[8];break;default:C=b}e(a,k,C)}b(F);a.jg.addEventListener("message",function(a){g(a.data)},!1)};a.cleanup=function(){};a.v=function(a,b){if(a)switch(b){case t:var e=n,g=new Float32Array(e.len);g[0]=e.Uc;g[1]=e.t;g[2]=e.time;g[3]=e.i[0];g[4]=e.i[1];g[5]=e.i[2];g[6]=e.quat[0];g[7]=e.quat[1];g[8]=e.quat[2];g[9]=e.quat[3];g[10]=e.be[0];g[11]=e.be[1];g[12]=e.be[2];g[13]=e.Rd[0];g[14]=e.Rd[1];g[15]=e.Rd[2];a.Wd.push(g.buffer);
break;case f:e=x;g=new Float32Array(e.len);g[0]=e.Uc;g[1]=e.co;g[2]=e.cq;g[3]=e.i[0];g[4]=e.i[1];g[5]=e.i[2];g[6]=e.quat[0];g[7]=e.quat[1];g[8]=e.quat[2];g[9]=e.quat[3];a.Wd.push(g.buffer);break;case l:e=I;g=new Float32Array(e.len);g[0]=e.Uc;g[1]=e.id;g[2]=e.Ph;g[3]=e.hit_fract;g[4]=e.hit_time;a.Wd.push(g.buffer);break;case h:e=A;g=new Float32Array(e.len);g[0]=e.Uc;g[1]=e.id;g[2]=e.Ph;g[3]=e.hit_fract;g[4]=e.hit_time;g[5]=e.hit_pos[0];g[6]=e.hit_pos[1];g[7]=e.hit_pos[2];g[8]=e.hit_norm[0];g[9]=e.hit_norm[1];
g[10]=e.hit_norm[2];a.Wd.push(g.buffer);break;case c:e=B;g=new Float32Array(e.len);g[0]=e.Uc;g[1]=e.vg;g[2]=e.wg;g[3]=e.result;a.Wd.push(g.buffer);break;case m:e=y;g=new Float32Array(e.len);g[0]=e.Uc;g[1]=e.vg;g[2]=e.wg;g[3]=e.result;g[4]=e.Bg[0];g[5]=e.Bg[1];g[6]=e.Bg[2];g[7]=e.coll_norm[0];g[8]=e.coll_norm[1];g[9]=e.coll_norm[2];g[10]=e.coll_dist;a.Wd.push(g.buffer);break;case d:e=v;g=new Float32Array(e.len);g[0]=e.Uc;g[1]=e.t;g[2]=e.i[0];g[3]=e.i[1];g[4]=e.i[2];g[5]=e.quat[0];g[6]=e.quat[1];g[7]=
e.quat[2];g[8]=e.quat[3];a.Wd.push(g.buffer);break;default:g=[];for(e=1;e<arguments.length;e++)g.push(arguments[e]);a.jg.postMessage(g)}};a.HD=function(a){a&&a.Wd.length&&(a.jg.postMessage(a.Wd),a.Wd.length=0)};a.yt=function(a){switch(a){case t:return n;case f:return x;case l:return I;case h:return A;case c:return B;case m:return y;case d:return v;default:return null}};a.terminate=function(a){a.jg.terminate();a.jg=null};a.mm=function(a){return!!a.jg};a.Ut=function(a){return!!a.Ge}};b4w.module.__hud=function(a,p){function e(a){a.font="bold 15px Courier";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function b(a){c(' SCENE "'+a.name+'"');if(a.j){var b=0,d=0;h.W(a.j.nb,function(a,e){if("SINK"==e.type)c(" (F)",e.type);else{var g=e.type,f=Math.round(e.k.width)+"x"+Math.round(e.k.height),k=e.p.length,l=e.Mj;"MAIN_CUBE_REFLECT"==e.type&&(k*=6);var u=e.enqueue&&e.tb;u?c(" (A)",g,e.tk,f,l,"of",k):c(" (P)",g,e.tk,f,l,"of",k);e.Mj=0;u&&(b+=k,d+=l)}});return[b,d]}c("No INFO")}
function c(){for(var a=80+20*g[0],b=arguments[0],c=1;c<arguments.length;c++){for(var e="",f=0;f<t[c]-String(arguments[c]).length;f++)e+=" ";b+=e+arguments[c]}g[0]++;d.fillText(b,30,a)}function m(a,b,c){b*=a.Wa;c.x=a.x+b;c.y=a.y;c.Wa=a.Wa-2*b;c.Pa=a.Pa}function f(a){return a.x+a.Wa/2}function l(a){var b=d,c={x:0,y:0,Wa:0,Pa:0},e=b.canvas.width,b=b.canvas.height;c.x=0;c.y=0;c.Wa=e;c.Pa=b;m(c,.01,c);e=.02*c.Pa;c.x=c.x;c.y+=e;c.Wa=c.Wa;c.Pa-=2*e;e=c.Wa/8;c.x+=e*a;c.y=c.y;c.Wa=e;c.Pa=c.Pa;m(c,.02,c);return c}
var h=p("__graph");p("__print");var t=[5,19,3,10,4,3,5],d=null,g=[0,0];a.init=function(a){a=a.getContext("2d");e(a);return d=a};a.Sk=function(){d&&e(d)};a.reset=function(){var a=d;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),g[0]=0,g[1]=0)};a.LE=function(a,e){var f=d;if(f){f.textAlign="left";f.fillStyle="rgba(0,255,0,255)";c(" FPS",(1/e).toFixed(2));g[0]++;for(var l=f=0,m=0;m<a.length;m++){var h=b(a[m]),f=f+h[0],l=
l+h[1];g[0]++}c(" -----------------------------------------------");c("    ","TOTAL ACTIVE","","",l,"of",f)}};a.print=function(){var a=d;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",c.apply(Math,arguments))};a.plot_array=function(a,b,c,e,g,m,h){var v=d;if(v){b=l(b);var t=b.Pa/5;b.x=b.x;b.y+=4*t;b.Wa=b.Wa;b.Pa=t;v.textAlign="center";v.fillStyle="#00FF00";d.fillText(a,f(b),b.y-10);v.strokeStyle="#00FF00";v.lineWidth=.5;v.beginPath();v.moveTo(b.x,b.y);v.lineTo(b.x+b.Wa,b.y);v.lineTo(b.x+b.Wa,
b.y+b.Pa);v.lineTo(b.x,b.y+b.Pa);v.closePath();v.stroke();if(!m&&!h)for(m=1E6,h=-1E6,a=0;a<c.length;a++)m=Math.min(m,c[a]),h=Math.max(h,c[a]);v.textAlign="right";d.fillText(String(m),b.x-10,b.y+b.Pa);d.fillText(String(h),b.x-10,b.y);v.textAlign="center";d.fillText(String(e),b.x,b.y+b.Pa+15);d.fillText(String(g),b.x+b.Wa,b.y+b.Pa+15);v.strokeStyle="#FF0000";v.lineWidth=1.5;v.beginPath();e=b.Wa/(c.length-1);h=b.Pa/(h-m);for(a=0;a<c.length;a++)g=b.x+e*a,t=b.y+b.Pa-(c[a]-m)*h,0==a?v.moveTo(g,t):v.lineTo(g,
t);v.stroke()}};a.draw_mixer_strip=function(a,b,c,e,g,m,h){var v=d;if(v)for(v.textAlign="center",v.fillStyle="#00FF00",v.font="bold 12px Courier",c=l(c),d.fillText(b?"["+a+"]":a,f(c),c.y),0<=m&&d.fillText(m?"[M]":"[ ]",f(c)-15,c.y+30),0<=h&&d.fillText(h?"[S]":"[ ]",f(c)+15,c.y+30),a={x:0,y:0,Wa:0,Pa:0},b=0;b<e.length;b++){m=e[b];var t="VOLUME"==m[0];if(t){h=c.y+350;var u=c.Wa,q=a;q.x=c.x;q.y=h;q.Wa=u;q.Pa=250}else{h=c.y+10+50*b;var u=c.Wa,q=c.Pa,D=a;D.x=c.x;D.y=h;D.Wa=u;D.Pa=q}h=v;var u=a,D=b==g,
w=m[0],q=m[1],p=m[2],C=m[3],M=(C-p)/m[4],M=1>M?Math.floor(1/M-1E-5).toFixed(0).length:0;m=m[5]?Math.log(q/p)/Math.log(C/p):(q-p)/(C-p);h.textAlign="center";D?h.fillText("["+w+"]",f(u),u.y):h.fillText(w,f(u),u.y);h.strokeStyle="#00FF00";h.lineWidth=t?3:1;t?(h.textAlign="right",h.fillText(C.toFixed(M),f(u)-10,u.y+15),h.textAlign="right",h.fillText(p.toFixed(M),f(u)-10,u.y+u.Pa-15)):(h.textAlign="right",h.fillText(p.toFixed(M),u.x+28,u.y+15),h.textAlign="left",h.fillText(C.toFixed(M),u.x+u.Wa-28,u.y+
15));h.beginPath();if(t){var G=u.y+15+(u.Pa-30)*(1-m);h.moveTo(f(u),u.y+15);h.lineTo(f(u),u.y+u.Pa-15);h.moveTo(f(u)-5,u.y+15);h.lineTo(f(u)+5,u.y+15);h.moveTo(f(u)-5,u.y+u.Pa-15);h.lineTo(f(u)+5,u.y+u.Pa-15);h.moveTo(f(u)-5,G);h.lineTo(f(u)+5,G)}else{var E=u.x+30+(u.Wa-60)*m;h.moveTo(u.x+30,u.y+15);h.lineTo(u.x+u.Wa-30,u.y+15);h.moveTo(u.x+30,u.y+15-5);h.lineTo(u.x+30,u.y+15+5);h.moveTo(u.x+u.Wa-30,u.y+15-5);h.lineTo(u.x+u.Wa-30,u.y+15+5);h.moveTo(E,u.y+15-5);h.lineTo(E,u.y+15+5)}h.stroke();"EQ_Q"==
w?(m=Math.log(1+1/(2*q*q)+Math.sqrt((2+1/(q*q))*(2+1/(q*q))/4-1))/Math.log(2),t?(h.textAlign="left",h.fillText(q.toFixed(M),f(u)+10,G),h.textAlign="left",h.fillText("("+m.toFixed(M+1)+")",f(u)+10,G+10)):(h.textAlign="right",h.fillText(q.toFixed(M),E,u.y+30),h.textAlign="left",h.fillText("("+m.toFixed(M+1)+")",E,u.y+30))):t?(h.textAlign="left",h.fillText(q.toFixed(M),f(u)+10,G)):(h.textAlign="center",h.fillText(q.toFixed(M),E,u.y+30))}}};b4w.module.__renderer=function(a,p){function e(a){for(var b=a.k,d=a.p,e=0;e<d.length;e++){var g=d[e];if(g.tb){var f=a,k=b,l=g.Jd,E=g.B,r=E.Ub;v.useProgram(r.mh);for(var g=E.N,h=E.rl,z=r.$v,H=z.length;H--;){var V=z[H];V.So(v,V.Wg,f,l,E,k)}k=E.ys;v.colorMask(k,k,k,k);v.depthMask(E.da);E.bb?v.enable(v.CULL_FACE):v.disable(v.CULL_FACE);k=E.T;for(E=0;E<k.length;E++)z=k[E],v.activeTexture(v.TEXTURE0+E),v.bindTexture(z.xb,z.Qa);if("SKY"==f.type){k=f;r=r.vh;E=k.k.zb.Qa;z=k.Lj;for(H=0;6>H;H++)if(V=m(H),n.eo?
(v.bindTexture(v.TEXTURE_CUBE_MAP,E),v.texImage2D(V,0,v.RGBA,1,1,0,v.RGBA,v.UNSIGNED_BYTE,y)):(v.uniformMatrix4fv(r.u_cube_view_matrix,!1,z[H]),v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,V,E,0),c(g,h,l.er)),k.ym&&3!=H){var V=k,x=H,t=F;n.eo?t.set(y):(v.readPixels(191,191,1,1,v.RGBA,v.UNSIGNED_BYTE,t),255!=t[0]&&255!=t[1]&&255!=t[2]||v.readPixels(191,220,1,1,v.RGBA,v.UNSIGNED_BYTE,t));var p=t[0],B=t[1],t=t[2],p=p/255,B=B/255,t=t/255;2===x?(V.Mc[3]=p,V.Mc[7]=B,V.Mc[11]=t):2>x?(V.Mc[4*x]=
p,V.Mc[4*x+1]=B,V.Mc[4*x+2]=t):(V.Mc[4*(x-2)]=p,V.Mc[4*(x-2)+1]=B,V.Mc[4*(x-2)+2]=t)}f.Mj+=6}else c(g,h,l.er),f.Mj++}}}function b(a){if(a){var b=(a.pa?v.COLOR_BUFFER_BIT:0)|(a.xa?v.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case "MAIN_GLOW":a=B;break;case "SHADOW_CAST":a=x;break;case "DEPTH":a=I;break;case "COLOR_PICKING":case "COLOR_PICKING_XRAY":case "ANCHOR_VISIBILITY":a=A;break;case "OUTLINE_MASK":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_EDGE_DETECTION":a=B;break;default:a=n.background_color}}else b=
v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT,a=n.background_color;v.colorMask(!0,!0,!0,!0);v.depthMask(!0);v.clearColor(a[0],a[1],a[2],a[3]);v.clear(b)}function c(a,b,c){v.bindBuffer(v.ARRAY_BUFFER,a.cg);for(var d=0;d<b.length;d++){var e=b[d];v.enableVertexAttribArray(e.Wg);v.vertexAttribPointer(e.Wg,e.ee,v.FLOAT,!1,0,e.Qy+e.bB*c)}a.Le?(v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,a.Le),v.drawElements(a.mode,a.count,a.jp,0)):v.drawArrays(a.mode,0,a.count);for(d=0;d<b.length;d++)e=b[d],v.disableVertexAttribArray(e.Wg)}
function m(a){switch(a){case 0:return v.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return v.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return v.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return v.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return v.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return v.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function f(a){var b=a.vh,c=[],d=[],e={},g;for(g in b){var f=!1;switch(g){case "u_proj_matrix":var k=function(a,b,c,d,e,f){a.uniformMatrix4fv(b,!1,f.Ga)},f=!0;break;case "u_view_matrix":case "u_view_matrix_frag":k=
function(a,b,c,d,e,f){a.uniformMatrix4fv(b,!1,f.za)};f=!0;break;case "u_shadow_cast_billboard_view_matrix":k=function(a,b,c,d,e,f){a.uniformMatrix4fv(b,!1,f.sv)};f=!0;break;case "u_view_proj_prev":k=function(a,b,c,d,e,f){a.uniformMatrix4fv(b,!1,f.ND)};f=!0;break;case "u_view_proj_inverse":k=function(a,b,c,d,e,f){a.uniformMatrix4fv(b,!1,f.jj)};f=!0;break;case "u_sky_vp_inverse":k=function(a,b,c,d,e,f){a.uniformMatrix4fv(b,!1,f.ge)};f=!0;break;case "u_camera_eye":case "u_camera_eye_frag":k=function(a,
b,c,d,e,f){a.uniform3fv(b,f.vf)};f=!0;break;case "u_camera_eye_last":k=function(a,b,c,d,e,f){a.uniform3fv(b,f.bt)};f=!0;break;case "u_camera_quat":k=function(a,b,c,d,e,f){a.uniform4fv(b,f.quat)};f=!0;break;case "u_view_max_depth":k=function(a,b,c,d,e,f){a.uniform1f(b,f.mb)};f=!0;break;case "u_camera_range":k=function(a,b,c,d,e,f){a.uniform2f(b,f.ob,f.mb)};break;case "u_csm_center_dists":k=function(a,b,c,d,e,f){a.uniform4fv(b,f.Js)};break;case "u_cam_water_depth":k=function(a,b,c){a.uniform1f(b,c.$n)};
f=!0;break;case "u_waves_height":k=function(a,b,c){a.uniform1f(b,c.ig)};break;case "u_waves_length":k=function(a,b,c){a.uniform1f(b,c.Hh)};break;case "u_fog_color_density":k=function(a,b,c){a.uniform4fv(b,c.gc)};break;case "u_fog_params":k=function(a,b,c){a.uniform4fv(b,c.am)};break;case "u_underwater_fog_color_density":k=function(a,b,c){a.uniform4fv(b,c.Pd)};break;case "u_bloom_key":k=function(a,b,c){a.uniform1f(b,c.bloom_key)};break;case "u_bloom_edge_lum":k=function(a,b,c){a.uniform1f(b,c.bloom_edge_lum)};
break;case "u_time":k=function(a,b,c){a.uniform1f(b,c.time)};f=!0;break;case "u_wind":k=function(a,b,c){a.uniform3fv(b,c.bf)};f=!0;break;case "u_sky_tex_dvar":k=function(a,b,c){a.uniform1f(b,c.yv)};break;case "u_sky_tex_fac":k=function(a,b,c){a.uniform4fv(b,c.zv)};break;case "u_sky_tex_color":k=function(a,b,c){a.uniform3fv(b,c.xv)};break;case "u_horizon_color":k=function(a,b,c){a.uniform3fv(b,c.yf)};break;case "u_zenith_color":k=function(a,b,c){a.uniform3fv(b,c.kg)};break;case "u_environment_energy":k=
function(a,b,c){a.uniform1f(b,c.uf)};break;case "u_sky_color":k=function(a,b,c){a.uniform3fv(b,c.Pi)};break;case "u_rayleigh_brightness":k=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":k=function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":k=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":k=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":k=function(a,b,c){a.uniform1f(b,
c.rayleigh_strength)};break;case "u_mie_strength":k=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":k=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":k=function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":k=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":k=function(a,b,c){a.uniform3fv(b,c.tm)};break;case "u_light_directions":k=function(a,b,c){a.uniform3fv(b,
c.yp)};break;case "u_light_color_intensities":k=function(a,b,c){a.uniform3fv(b,c.sm)};break;case "u_light_factors":k=function(a,b,c){a.uniform4fv(b,c.zp)};break;case "u_sun_quaternion":k=function(a,b,c){a.uniform4fv(b,c.Rv)};break;case "u_sun_intensity":k=function(a,b,c){a.uniform3fv(b,c.Qv)};break;case "u_sun_direction":k=function(a,b,c){a.uniform3fv(b,c.Jq)};break;case "u_height":k=function(a,b,c,d,e,f){a.uniform1f(b,f.height)};f=!0;break;case "u_model_matrix":k=function(a,b,c,d){a.uniformMatrix4fv(b,
!1,d.aa)};f=!0;break;case "u_transb":k=function(a,b,c,d){a.uniform4fv(b,d.Gc)};f=!0;break;case "u_transa":k=function(a,b,c,d){a.uniform4fv(b,d.ed)};f=!0;break;case "u_arm_rel_trans":k=function(a,b,c,d){a.uniform4fv(b,d.Hn)};f=!0;break;case "u_arm_rel_quat":k=function(a,b,c,d){a.uniform4fv(b,d.Gn)};f=!0;break;case "u_quat":k=function(a,b,c,d){a.uniform4fv(b,d.quat)};f=!0;break;case "u_quatsb":k=function(a,b,c,d){a.uniform4fv(b,d.Bc)};f=!0;break;case "u_quatsa":k=function(a,b,c,d){a.uniform4fv(b,d.Xc)};
f=!0;break;case "u_frame_factor":k=function(a,b,c,d){a.uniform1f(b,d.sd)};f=!0;break;case "au_center_pos":k=function(){};f=!0;break;case "au_wind_bending_amp":k=function(a,b,c,d){a.uniform1f(b,d.pe)};f=!0;break;case "au_wind_bending_freq":k=function(a,b,c,d){a.uniform1f(b,d.cf)};f=!0;break;case "au_detail_bending_freq":k=function(a,b,c,d){a.uniform1f(b,d.Ae)};f=!0;break;case "au_detail_bending_amp":k=function(a,b,c,d){a.uniform1f(b,d.ze)};f=!0;break;case "au_branch_bending_amp":k=function(a,b,c,d){a.uniform1f(b,
d.ue)};f=!0;break;case "u_node_values":k=function(a,b,c,d){a.uniform1fv(b,d.Oe)};f=!0;break;case "u_node_rgbs":k=function(a,b,c,d){a.uniform3fv(b,d.Tc)};f=!0;break;case "u_diffuse_color":k=function(a,b,c,d,e){a.uniform4fv(b,e.vc)};f=!0;break;case "u_diffuse_intensity":k=function(a,b,c,d,e){a.uniform1f(b,e.sf)};f=!0;break;case "u_diffuse_params":k=function(a,b,c,d,e){a.uniform2fv(b,e.Oc)};f=!0;break;case "u_emit":k=function(a,b,c,d,e){a.uniform1f(b,e.Ee)};f=!0;break;case "u_ambient":k=function(a,b,
c,d,e){a.uniform1f(b,e.se)};f=!0;break;case "u_specular_color":k=function(a,b,c,d,e){a.uniform3fv(b,e.he)};f=!0;break;case "u_specular_alpha":k=function(a,b,c,d,e){a.uniform1f(b,e.Bq)};f=!0;break;case "u_specular_params":k=function(a,b,c,d,e){a.uniform3fv(b,e.Fc)};f=!0;break;case "u_reflect_factor":k=function(a,b,c,d,e){a.uniform1f(b,e.reflect_factor)};f=!0;break;case "u_mirror_factor":k=function(a,b,c,d,e){a.uniform1f(b,e.Jp)};f=!0;break;case "u_grass_map_dim":k=function(a,b,c,d,e){a.uniform3fv(b,
e.wc)};f=!0;break;case "u_grass_size":k=function(a,b,c,d,e){a.uniform1f(b,e.cp)};f=!0;break;case "u_scale_threshold":k=function(a,b,c,d,e){a.uniform1f(b,e.Et)};f=!0;break;case "u_cube_fog":k=function(a,b,c,d,e){a.uniformMatrix4fv(b,!1,e.Mc)};break;case "u_jitter_amp":k=function(a,b,c,d,e){a.uniform1f(b,e.$t)};f=!0;break;case "u_jitter_freq":k=function(a,b,c,d,e){a.uniform1f(b,e.au)};f=!0;break;case "u_wireframe_mode":k=function(a,b,c,d,e){a.uniform1i(b,e.wireframe_mode)};break;case "u_wireframe_edge_color":k=
function(a,b,c,d,e){a.uniform3fv(b,e.wireframe_edge_color)};break;case "u_subpixel_jitter":k=function(a,b,c){a.uniform2fv(b,c.uC)};f=!0;break;case "u_subsample_indices":k=function(a,b,c){a.uniform4fv(b,c.vC)};f=!0;break;case "u_refr_bump":k=function(a,b,c,d,e){a.uniform1f(b,e.av)};f=!0;break;case "u_lamp_light_positions":k=function(a,b,c,d,e){a.uniform3fv(b,e.up)};break;case "u_lamp_light_directions":k=function(a,b,c,d,e){a.uniform3fv(b,e.sp)};break;case "u_lamp_light_color_intensities":k=function(a,
b,c,d,e){a.uniform3fv(b,e.rp)};break;case "u_lamp_light_factors":k=function(a,b,c,d,e){a.uniform4fv(b,e.tp)};break;case "u_halo_size":k=function(a,b,c,d,e){a.uniform1f(b,e.Kt)};f=!0;break;case "u_halo_hardness":k=function(a,b,c,d,e){a.uniform1f(b,e.Ht)};f=!0;break;case "u_halo_rings_color":k=function(a,b,c,d,e){a.uniform3fv(b,e.Jt)};f=!0;break;case "u_halo_lines_color":k=function(a,b,c,d,e){a.uniform3fv(b,e.It)};f=!0;break;case "u_halo_stars_blend":k=function(a,b,c,d,e){a.uniform1f(b,e.Lt)};f=!0;
break;case "u_halo_stars_height":k=function(a,b,c,d,e){a.uniform1f(b,e.Mt)};f=!0;break;case "u_fresnel_params":k=function(a,b,c,d,e){a.uniform4fv(b,e.Hd)};f=!0;break;case "u_texture_scale":k=function(a,b,c,d,e){a.uniform3fv(b,e.Zf)};f=!0;break;case "u_parallax_scale":k=function(a,b,c,d,e){a.uniform1f(b,e.parallax_scale)};f=!0;break;case "u_color_id":k=function(a,b,c,d){a.uniform3fv(b,d.Fl)};f=!0;break;case "u_line_points":k=function(a,b,c,d,e){a.uniform3fv(b,e.LI)};f=!0;break;case "u_diffuse_color_factor":k=
function(a,b,c,d,e){a.uniform1f(b,e.rf)};f=!0;break;case "u_alpha_factor":k=function(a,b,c,d,e){a.uniform1f(b,e.hf)};f=!0;break;case "u_specular_color_factor":k=function(a,b,c,d,e){a.uniform1f(b,e.th)};f=!0;break;case "u_normal_factor":k=function(a,b,c,d,e){a.uniform1f(b,e.vu)};f=!0;break;case "u_normalmap0_scale":k=function(a,b,c,d,e){a.uniform2fv(b,e.eh[0])};f=!0;break;case "u_normalmap1_scale":k=function(a,b,c,d,e){a.uniform2fv(b,e.eh[1])};f=!0;break;case "u_normalmap2_scale":k=function(a,b,c,
d,e){a.uniform2fv(b,e.eh[2])};f=!0;break;case "u_normalmap3_scale":k=function(a,b,c,d,e){a.uniform2fv(b,e.eh[3])};f=!0;break;case "u_foam_factor":k=function(a,b,c,d,e){a.uniform1f(b,e.foam_factor)};f=!0;break;case "u_foam_uv_freq":k=function(a,b,c,d,e){a.uniform2fv(b,e.ft)};f=!0;break;case "u_foam_mag":k=function(a,b,c,d,e){a.uniform2fv(b,e.et)};f=!0;break;case "u_foam_scale":k=function(a,b,c,d,e){a.uniform2fv(b,e.Oo)};f=!0;break;case "u_water_norm_uv_velocity":k=function(a,b,c,d,e){a.uniform1f(b,
e.kj)};f=!0;break;case "u_shallow_water_col":k=function(a,b,c,d,e){a.uniform3fv(b,e.shallow_water_col)};f=!0;break;case "u_shore_water_col":k=function(a,b,c,d,e){a.uniform3fv(b,e.shore_water_col)};f=!0;break;case "u_water_shallow_col_fac":k=function(a,b,c,d,e){a.uniform1f(b,e.shallow_water_col_fac)};f=!0;break;case "u_water_shore_col_fac":k=function(a,b,c,d,e){a.uniform1f(b,e.shore_water_col_fac)};f=!0;break;case "u_p_length":k=function(a,b,c,d,e){a.uniform1f(b,e.va.Wv)};f=!0;break;case "u_p_cyclic":k=
function(a,b,c,d,e){a.uniform1i(b,e.va.cyclic)};f=!0;break;case "u_p_max_lifetime":k=function(a,b,c,d,e){a.uniform1f(b,e.va.gu)};f=!0;break;case "u_p_fade_in":k=function(a,b,c,d,e){a.uniform1f(b,e.va.Jg)};f=!0;break;case "u_p_fade_out":k=function(a,b,c,d,e){a.uniform1f(b,e.va.Pc)};f=!0;break;case "u_p_size":k=function(a,b,c,d,e){a.uniform1f(b,e.va.size)};f=!0;break;case "u_p_alpha_start":k=function(a,b,c,d,e){a.uniform1f(b,e.va.Or)};f=!0;break;case "u_p_alpha_end":k=function(a,b,c,d,e){a.uniform1f(b,
e.va.Nr)};f=!0;break;case "u_p_nfactor":k=function(a,b,c,d,e){a.uniform1f(b,e.va.Op)};f=!0;break;case "u_p_gravity":k=function(a,b,c,d,e){a.uniform1f(b,e.va.Ft)};f=!0;break;case "u_p_mass":k=function(a,b,c,d,e){a.uniform1f(b,e.va.ce)};f=!0;break;case "u_p_size_ramp":k=function(a,b,c,d,e){a.uniform2fv(b,e.va.uv)};f=!0;break;case "u_p_color_ramp":k=function(a,b,c,d,e){a.uniform4fv(b,e.va.zs)};f=!0;break;case "u_p_wind_fac":k=function(a,b,c,d,e){a.uniform1f(b,e.va.Fw)};f=!0;break;case "u_texel_size":k=
function(a,b,c){a.uniform2fv(b,c.Qq)};f=!0;break;case "u_p_time":k=function(a,b,c,d,e){a.uniform1f(b,e.va.time)};f=!0;break;case "u_position":k=function(a,b,c,d,e){a.uniform3fv(b,e.Hi)};f=!0;break;case "u_va_frame_factor":k=function(a,b,c,d){a.uniform1f(b,d.ow)};f=!0;break;case "u_perspective_cast_far_bound":k=function(a,b,c){a.uniform1f(b,c.wD)};break;case "u_normal_offset":k=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_pcf_blur_radii":k=function(a,b,c,d,e,f){a.uniform4fv(b,
f.Gm)};break;case "u_v_light_matrix":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.nw)};f=!0;break;case "u_b_light_matrix":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.$r)};break;case "u_p_light_matrix0":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.jh[0])};f=!0;break;case "u_p_light_matrix1":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.jh[1])};f=!0;break;case "u_p_light_matrix2":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.jh[2])};f=!0;break;case "u_p_light_matrix3":k=function(a,b,c){a.uniformMatrix4fv(b,
!1,c.jh[3])};f=!0;break;case "u_motion_blur_exp":k=function(a,b,c){a.uniform1f(b,c.ou)};f=!0;break;case "u_motion_blur_decay_threshold":k=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};f=!0;break;case "u_refl_plane":k=function(a,b,c,d){a.uniform4fv(b,d.mc)};f=!0;break;case "u_radial_blur_step":k=function(a,b,c){a.uniform1f(b,c.Nm)};break;case "u_god_rays_intensity":k=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":k=function(a,b,c){a.uniform1f(b,c.Ti)};
break;case "u_ssao_blur_discard_value":k=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};f=!0;break;case "u_ssao_influence":k=function(a,b,c){a.uniform1f(b,c.Si)};break;case "u_ssao_dist_factor":k=function(a,b,c){a.uniform1f(b,c.Ri)};break;case "u_dof_dist":k=function(a,b,c,d,e,f){a.uniform1f(b,f.dof_distance)};f=!0;break;case "u_dof_front":k=function(a,b,c,d,e,f){a.uniform1f(b,f.dof_front)};f=!0;break;case "u_dof_rear":k=function(a,b,c,d,e,f){a.uniform1f(b,f.dof_rear)};f=!0;break;case "u_outline_intensity":k=
function(a,b,c,d){a.uniform1f(b,d.If)};f=!0;break;case "u_outline_color":k=function(a,b,c){a.uniform3fv(b,c.Se)};break;case "u_draw_outline":k=function(a,b,c){a.uniform1f(b,c.Eo)};f=!0;break;case "u_glow_mask_small_coeff":k=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};f=!0;break;case "u_glow_mask_large_coeff":k=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};f=!0;break;case "u_brightness":k=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":k=function(a,b,c){a.uniform1f(b,
c.contrast)};break;case "u_exposure":k=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":k=function(a,b,c){a.uniform1f(b,c.saturation)};break;default:k=null}k&&(k={name:g,So:k,Wg:b[g]},f?c.push(k):(d.push(k),e[g]=k))}a.$v=c;a.Ak=d;a.Yp=e}var l=p("__camera"),h=p("__config"),t=p("__debug"),d=p("__textures"),g=p("__util"),k=p("__batch"),n=h.q,x=[1,1,1,1],I=[1,1,1,1],A=[0,0,0,1],B=[0,0,0,0],y=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,
.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var v=null,F=new Uint8Array(4);a.$c=function(a){var b=n.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);v=a};a.Rj=function(a){if(a.tb){var c=a.k;v.bindFramebuffer(v.FRAMEBUFFER,c.Ie);if(a.In){var d=c.zb;v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,
d.xb,d.Qa,0)}v.viewport(0,0,c.width,c.height);"MAIN_CUBE_REFLECT"!=a.type&&b(a);a.Ra?v.enable(v.BLEND):v.disable(v.BLEND);a.Sb?v.enable(v.DEPTH_TEST):v.disable(v.DEPTH_TEST);if(a.ua){for(var c=a.k,d=a.p,g=0;g<d.length;g++){var k=d[g],h=k.B,x=h.Ub;v.useProgram(x.mh);k=k.Jd;x.Ak.length||f(x);for(var x=x.Ak,G=x.length;G--;){var E=x[G];E.So(v,E.Wg,a,k,h,c)}}a.ua=!1}switch(a.type){case "DEPTH":n.Rt?(v.enable(v.POLYGON_OFFSET_FILL),v.polygonOffset(5,5)):v.disable(v.POLYGON_OFFSET_FILL);v.cullFace(v.BACK);
break;case "SHADOW_CAST":v.enable(v.POLYGON_OFFSET_FILL);v.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);v.cullFace(v.BACK);break;case "MAIN_PLANE_REFLECT":v.disable(v.POLYGON_OFFSET_FILL);v.cullFace(v.FRONT);break;default:v.disable(v.POLYGON_OFFSET_FILL),v.cullFace(v.BACK)}if("MAIN_CUBE_REFLECT"==a.type)for(c=a.k,d=c.zb.Qa,g=0;6>g;g++){h=m(g);c.za=a.Lj[g];l.Zn(c);v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,h,d,0);b(a);h=a.p;for(k=0;k<h.length;k++)h[k].tb=h[k].Do[g];
e(a)}else e(a);t.sz("draw subscene: "+a.type);v.bindFramebuffer(v.FRAMEBUFFER,null)}};a.clear=function(a){v.bindFramebuffer(v.FRAMEBUFFER,a.k.Ie);b(a)};a.Tr=function(a){var b=a.rl;b.length=0;var c=a.N;a=a.Ub;c&&a||g.U("Incomplete batch");c=c.Tb;a=a.attributes;for(var d in a){var e=c[d];b.push({Wg:a[d],Qy:4*e.offset,bB:1<e.frames?4*e.length:0,ee:e.ee})}};a.Oy=f;a.Vr=function(a){var b=a.Ub,c=a.T;a=a.Vb;v.useProgram(b.mh);for(var d=0;d<c.length;d++)v.uniform1i(b.vh[a[d]],d)};a.Zu=function(a,b,c,d,e,
f){d||(d=1);e||(e=1);f||(f=new Uint8Array(4*d*e));f.length!=4*d*e&&g.U("read_pixels(): Wrong storage");v.bindFramebuffer(v.FRAMEBUFFER,a);v.readPixels(b,c,d,e,v.RGBA,v.UNSIGNED_BYTE,f);v.bindFramebuffer(v.FRAMEBUFFER,null);return f};a.DF=function(a){var b=a.Ub;v.useProgram(b.mh);b.Ak.length||f(b);b=b.Yp.u_cube_fog;b.So(v,b.Wg,null,null,a,null)};a.YD=function(a,b){var c=v.createFramebuffer();v.bindFramebuffer(v.FRAMEBUFFER,c);if(a){var e=a,f=e.Qa,e=e.xb==v.TEXTURE_CUBE_MAP?v.TEXTURE_CUBE_MAP_NEGATIVE_Z:
e.xb;v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,e,f,0)}d.Wt(b)?v.framebufferRenderbuffer(v.FRAMEBUFFER,v.DEPTH_ATTACHMENT,v.RENDERBUFFER,b.fg):d.ok(b)&&(e=b,f=e.Qa,e=e.xb,v.framebufferTexture2D(v.FRAMEBUFFER,v.DEPTH_ATTACHMENT,e,f,0));t.nz();v.bindFramebuffer(v.FRAMEBUFFER,null);return c};a.XD=function(a,b,c,e,f){null==a?(v.bindFramebuffer(v.FRAMEBUFFER,a),v.viewport(0,0,e,f),v.clear(v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT)):(d.ok(b)&&v.deleteTexture(b.Qa),d.Wt(c)?v.deleteRenderbuffer(c.fg):
d.ok(c)&&v.deleteTexture(c.Qa),v.deleteFramebuffer(a))};a.wI=function(){};a.GA=function(a,b,d,e,f,g){a=a.Qa;v.viewport(0,0,d,d);v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,b,a,0);b=k.Ml("FLIP_CUBEMAP_COORDS");a=b.Ub;v.activeTexture(v.TEXTURE0);v.bindTexture(v.TEXTURE_2D,f);var n=f=0;d!=e&&(f=1/(6*e),n=1/(4*e));v.uniform1i(a.vh.u_tex_number,g);v.uniform2fv(a.vh.u_delta,[f,n]);v.useProgram(a.mh);c(b.N,b.rl,0);v.bindTexture(v.TEXTURE_2D,null)};a.HA=function(a,b,d,e,f){v.bindFramebuffer(v.FRAMEBUFFER,
e);e=a.Qa;a=a.xb;v.bindTexture(a,e);v.viewport(0,0,b,d);v.texImage2D(a,0,v.RGBA,b,d,0,v.RGBA,v.UNSIGNED_BYTE,null);v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,a,e,0);b=k.Ml("NONE");d=b.Ub;v.bindTexture(a,null);v.activeTexture(v.TEXTURE0);v.bindTexture(a,f);v.useProgram(d.mh);c(b.N,b.rl,0);v.bindFramebuffer(v.FRAMEBUFFER,null);v.bindTexture(a,null)};a.cleanup=function(){}};b4w.module.__shaders=function(a,p){function e(a,c,d){var e=a.tf;"string"==typeof d&&(a=b(a,d))&&(d=a[1]);for(a=0;a<e.length;a++)if(e[a][0]==c){e[a][1]=d;return}e.push([c,d])}function b(a,b){for(var c=a.tf,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function c(a,b){var c=a+b;if(y[c])return y[c];if(v){var d=v[b];if(!d)return null;d=p("__gpp_parser").XI.parse(d)}else if(d=p("shader_texts")[b],!d)return null;return y[c]=d}function m(a,b,d){function e(b){b=b.a;for(var d=0;d<b.length;d++){var n=
b[d];switch(n.type){case "condition":a:for(var n=n.a,u=0;u<n.length;u++){var H=n[u];switch(H.type){case "if":case "elif":if(g(H.c)){e(H.group);break a}break;case "else":e(H.group);break a;case "ifdef":H.name in z&&e(H.group);break;case "ifndef":H.name in z||e(H.group)}}break;case "include":n=c(A.shaders_dir,A.JE+n.file);e(n);break;case "var":case "export":case "import":break;case "define":u=n.name;z[u]=n.b;n.K&&(l[u]=n.K);break;case "error":throw"Shader error: #error "+n.b.join(" ");case "line":break;
case "pragma":q.push("#pragma "+n.name+" "+n.b.join(" "));break;case "undef":n=n.name;delete z[n];delete l[n];break;case "warning":x.warn("Shader warning: #warning "+n.b.join(" "));break;case "extension":n=f(n.b,z,l,!1);q.push("#extension "+n.join(" "));break;case "#":break;case "node":m[n.name]=n;break;case "nodes_global":n=r;for(u=0;u<n.length;u++){var H=n[u],C=m[H.id];if(C)for(var p=0,L=0;L<C.h.length;L++){var O=C.h[L];"node_param"==O.type&&(O=O.qualifier.join(" ")+" ","vert"==a?O+=H.eg[p]:"frag"==
a&&(O+=H.K[p],null!==H.Dm[p]&&(O+=" = "+H.Dm[p])),O+=";",q.push(O),p++)}}break;case "nodes_main":n=r;for(u=0;u<n.length;u++)if(H=n[u],C=m[H.id]){p={};L={};for(O=0;O<H.qd.length;O++)L[H.qd[O][0]]=[H.qd[O][1]];t=D=v=0;for(var O=H,S=C.h,y=p,F=L,B=0;B<S.length;B++){var I=S[B];switch(I.type){case "node_in":var J=O.C[v];if(null!==O.np[v]){if(("MATERIAL_BEGIN"==O.id&&3===v||!F.MATERIAL_EXT&&("MATERIAL_BEGIN"==O.id&&4===v||"MATERIAL_END"==O.id&&3===v||"MATERIAL_END"==O.id&&4===v||"MATERIAL_END"==O.id&&5===
v)||"TEXTURE_COLOR"==O.id||"TEXTURE_NORMAL"==O.id)&&I.e){y[I.name]=O.np[v];v++;continue}var fa=I.qualifier.join(" ")+" ",fa=fa+J,fa=fa+(" = "+O.np[v]),fa=fa+";";q.push(fa)}y[I.name]=J;v++;break;case "node_out":J=O.la[D];if(!I.e||-1<h.indexOf(J))fa=I.qualifier.join(" ")+" ",fa+=J,fa+=";",q.push(fa),y[I.name]=J;-1<h.indexOf(J)&&(F["USE_OUT_"+I.name]=[1]);D++;break;case "node_param":"vert"==a?J=O.eg[t]:"frag"==a&&(J=O.K[t]),y[I.name]=J,t++}}q.push("{");k(H,C.g,p,L);q.push("}")}break;case "textline":n=
f(n.b,z,l,!1);q.push(n.join(" "));break;default:throw"Unknown element type: "+n.type;}}}function g(a,b){var c;c=f(a,z,l,!0,b);for(var d=[],e=0;e<c.length;e++)if(c[e]instanceof Object)switch(c[e].type){case "conditional_expr":var r=d.pop(),k=d.pop();d.pop()?d.push(k):d.push(r);break;case "logical_or_expr":r=d.pop();for(k=0;k<c[e].d-1;k++)q=d.pop(),r=r||q;d.push(r);break;case "logical_and_expr":r=d.pop();for(k=0;k<c[e].d-1;k++)q=d.pop(),r=r&&q;d.push(r);break;case "logical_bitor_expr":r=d.pop();for(k=
0;k<c[e].d-1;k++)r|=d.pop();d.push(r);break;case "logical_bitxor_expr":r=d.pop();for(k=0;k<c[e].d-1;k++)r^=d.pop();d.push(r);break;case "logical_bitand_expr":r=d.pop();for(k=0;k<c[e].d-1;k++)r&=d.pop();d.push(r);break;case "equal_expr":r=d.pop();k=d.pop();d.push(k==r);break;case "non_equal_expr":r=d.pop();k=d.pop();d.push(k!=r);break;case "le_expr":r=d.pop();k=d.pop();d.push(k<=r);break;case "ge_expr":r=d.pop();k=d.pop();d.push(k>=r);break;case "l_expr":r=d.pop();k=d.pop();d.push(k<r);break;case "g_expr":r=
d.pop();k=d.pop();d.push(k>r);break;case "left_shift_expr":k=d.pop();r=d.pop();d.push(k<<r);break;case "right_shift_expr":k=d.pop();r=d.pop();d.push(k>>r);break;case "add_expr":k=d.pop();r=d.pop();d.push(k+r);break;case "sub_expr":k=d.pop();r=d.pop();d.push(k-r);break;case "mul_expr":k=d.pop();r=d.pop();d.push(k*r);break;case "div_expr":k=d.pop();r=d.pop();d.push(k/r);break;case "mod_expr":k=d.pop();r=d.pop();d.push(k%r);break;case "pre_inc_expr":case "post_inc_expr":q=d.pop();d.push(++q);break;case "pre_dec_expr":case "post_dec_expr":q=
d.pop();d.push(--q);break;case "positive_expr":q=d.pop();d.push(+q);break;case "negative_expr":q=d.pop();d.push(-q);break;case "one_compl_expr":q=d.pop();d.push(~q);break;case "logic_negative_expr":q=d.pop();d.push(!q);break;default:I.U("Unknown operation type: "+c[e].type)}else{var q=c[e];/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(q)?d.push(0):d.push(parseFloat(c[e]))}1==d.length?c=d[0]:(I.U("Incorrect expression: "+c.join(" ")),c=void 0);return c}function k(a,b,c,d){for(var e=0;e<b.length;e++){var r=b[e];
switch(r.type){case "node_condition":a:for(var n=a,r=r.a,m=c,h=d,u=0;u<r.length;u++){var H=r[u];switch(H.type){case "node_if":case "node_elif":if(g(H.c,h)){k(n,H.g,m,h);break a}break;case "node_else":k(n,H.g,m,h);break a;case "node_ifdef":(H.name in z||H.name in h)&&k(n,H.g,m,h);break;case "node_ifndef":H.name in z||H.name in h||k(n,H.g,m,h)}}break;case "textline":n=[];for(m=0;m<r.b.length;m++)h=r.b[m],h in c?n.push(c[h]):n.push(h);n=f(n,z,l,!0,d);q.push(n.join(" "))}}}var r=d.Ff;d=d.tf||[];for(var q=
[],z={},n=0;n<d.length;n++)z[d[n][0]]=[d[n][1]];for(n=0;n<r.length;n++)z["USE_NODE_"+r[n].id]=[1];var l={},m={},h=[];for(n in r)for(var u in r[n].C)h.push(r[n].C[u]);e(b);var v=0,D=0,t=0;return q.join("\n")}function f(a,b,c,d,e){var f=[];l(a,b,c,d,f,e);return f}function l(a,b,c,d,e,f){for(var r=0;r<a.length;r++){var g=a[r];g in b||f&&g in f?(g=f&&f[g]||b[g],0==g.length&&d?e.push(0):l(g,b,c,d,e,f)):e.push(g)}}function h(a,b,c,d){d=a.createShader(d);a.shaderSource(d,c);a.compileShader(d);n.tz(d,b,c);
return d}function t(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return d(a);case 2:return"vec2("+d(a[0])+","+d(a[1])+")";case 3:return"vec3("+d(a[0])+","+d(a[1])+","+d(a[2])+")";case 4:return"vec4("+d(a[0])+","+d(a[1])+","+d(a[2])+","+d(a[3])+")";case 9:return"mat3("+d(a[0])+","+d(a[1])+","+d(a[2])+","+d(a[3])+","+d(a[4])+","+d(a[5])+","+d(a[6])+","+d(a[7])+","+d(a[8])+")";case 16:return"mat4("+d(a[0])+","+d(a[1])+","+d(a[2])+","+d(a[3])+","+d(a[4])+","+d(a[5])+","+d(a[6])+","+d(a[7])+
","+d(a[8])+","+d(a[9])+","+d(a[10])+","+d(a[11])+","+d(a[12])+","+d(a[13])+","+d(a[14])+","+d(a[15])+")";default:throw"Wrong glsl value dimension";}}function d(a){return a%1?String(a):String(a)+".0"}var g=p("__assets"),k=p("__config"),n=p("__debug"),x=p("__print"),I=p("__util"),A=k.lc,B={},y={},v=null,F="anchors.glslf anchors.glslv color_id.glslf color_id.glslv depth.glslf depth.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv main.glslf main.glslv main_stack.glslf main_stack.glslv particles_color.glslf particles_color.glslv particles_texture.glslf particles_texture.glslv procedural_skydome.glslf procedural_skydome.glslv special_lens_flares.glslf special_lens_flares.glslv special_skydome.glslf special_skydome.glslv special_water.glslf special_water.glslv wireframe.glslf wireframe.glslv postprocessing/anaglyph.glslf postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/std_enums.glsl include/to_world.glslv include/wind_bending.glslv".split(" "),
u=[],q=null,D=!1;a.$c=function(a){q=a};a.G=e;a.GB=b;a.EI=function(a,b){for(var c=a.tf,d=0;d<c.length;d++)if(c[d][0]==b&&1==c[d][1])return!0;return!1};a.pE=function(a){a.tf=[];for(var b="ALPHA ALPHA_CLIP BEND_CENTER_ONLY BILLBOARD_PRES_GLOB_ORIENTATION CAUSTICS CSM_BLEND_BETWEEEN_CASCADES CSM_FADE_LAST_CASCADE CSM_SECTION0 CSM_SECTION1 CSM_SECTION2 CSM_SECTION3 DEBUG_SPHERE DEBUG_SPHERE_DYNAMIC DEPTH_RGBA DISABLE_FOG DOUBLE_SIDED_LIGHTING DYNAMIC DYNAMIC_GRASS DYNAMIC_GRASS_COLOR DYNAMIC_GRASS_SIZE FOAM FRAMES_BLENDING BILLBOARD_JITTERED BILLBOARD_SPHERICAL HAIR_BILLBOARD SHADOW_TEX_RES MAIN_BEND_COL MAX_BONES NODES_GLOW NUM_NORMALMAPS PARALLAX PARALLAX_STEPS PERSPECTIVE_SHADOW_CAST PROCEDURAL_FOG PROCEDURAL_SKYDOME REFLECTION REFLECTION_PASS REFLECTION_TYPE REFRACTIVE USE_REFRACTION USE_REFRACTION_CORRECTION SHORE_SMOOTHING SKINNED SKY_COLOR SKY_TEXTURE SSAO_HEMISPHERE SSAO_BLUR_DEPTH SSAO_ONLY SSAO_WHITE STATIC_BATCH TEXTURE_COLOR TEXTURE_NORM TEXTURE_SPEC TEXTURE_STENCIL_ALPHA_MASK VERTEX_ANIM VERTEX_ANIM_MIX_NORMALS_FACTOR VERTEX_COLOR WATER_EFFECTS WIND_BEND DETAIL_BEND SHORE_PARAMS ALPHA_AS_SPEC DEPTH_RGBA MTEX_NEGATIVE MTEX_RGBTOINT NUM_LIGHTS NUM_LFACTORS NUM_LAMP_LIGHTS MAX_STEPS BILLBOARD_ALIGN SHADOW_USAGE POST_EFFECT SSAO_QUALITY TEXTURE_BLEND_TYPE TEXTURE_COORDS AA_METHOD AU_QUALIFIER BILLBOARD BILLBOARD_RANDOM PRECISION EPSILON USE_ENVIRONMENT_LIGHT USE_FOG WO_SKYBLEND WO_SKYPAPER WO_SKYREAL WO_SKYTEX WOMAP_BLEND WOMAP_HORIZ WOMAP_ZENUP WOMAP_ZENDOWN WIREFRAME_QUALITY SIZE_RAMP_LENGTH COLOR_RAMP_LENGTH PARTICLES_SHADELESS".split(" "),
c=0;c<b.length;c++){var d=b[c],f;switch(d){case "ALPHA":case "ALPHA_CLIP":case "BILLBOARD_PRES_GLOB_ORIENTATION":case "CAUSTICS":case "CSM_SECTION0":case "CSM_SECTION1":case "CSM_SECTION2":case "CSM_SECTION3":case "DEBUG_SPHERE":case "DEBUG_SPHERE_DYNAMIC":case "DEPTH_RGBA":case "DISABLE_FOG":case "DOUBLE_SIDED_LIGHTING":case "DYNAMIC":case "DYNAMIC_GRASS":case "DYNAMIC_GRASS_COLOR":case "DYNAMIC_GRASS_SIZE":case "FOAM":case "FRAMES_BLENDING":case "BILLBOARD_JITTERED":case "MAIN_BEND_COL":case "MAX_BONES":case "MTEX_NEGATIVE":case "MTEX_RGBTOINT":case "NODES_GLOW":case "NUM_LIGHTS":case "NUM_LFACTORS":case "NUM_NORMALMAPS":case "PARALLAX":case "PARALLAX_STEPS":case "PERSPECTIVE_SHADOW_CAST":case "PROCEDURAL_FOG":case "PROCEDURAL_SKYDOME":case "REFLECTION":case "REFLECTION_PASS":case "REFLECTION_TYPE":case "REFRACTIVE":case "USE_REFRACTION":case "USE_REFRACTION_CORRECTION":case "SHORE_SMOOTHING":case "SKINNED":case "SKY_COLOR":case "SKY_TEXTURE":case "SSAO_HEMISPHERE":case "SSAO_BLUR_DEPTH":case "SSAO_ONLY":case "SSAO_WHITE":case "STATIC_BATCH":case "TEXTURE_COLOR":case "TEXTURE_NORM":case "TEXTURE_SPEC":case "TEXTURE_STENCIL_ALPHA_MASK":case "VERTEX_ANIM":case "VERTEX_COLOR":case "WATER_EFFECTS":case "WIND_BEND":case "DETAIL_BEND":case "SHORE_PARAMS":case "BILLBOARD":case "BILLBOARD_RANDOM":case "HAIR_BILLBOARD":case "USE_ENVIRONMENT_LIGHT":case "USE_FOG":case "WO_SKYBLEND":case "WO_SKYPAPER":case "WO_SKYREAL":case "WO_SKYTEX":case "WOMAP_BLEND":case "WOMAP_HORIZ":case "WOMAP_ZENUP":case "WOMAP_ZENDOWN":case "WIREFRAME_QUALITY":case "SIZE_RAMP_LENGTH":case "COLOR_RAMP_LENGTH":case "PARTICLES_SHADELESS":case "SMAA_JITTER":f=
0;break;case "ALPHA_AS_SPEC":case "BEND_CENTER_ONLY":case "CSM_BLEND_BETWEEEN_CASCADES":case "CSM_FADE_LAST_CASCADE":case "DEPTH_RGBA":case "BILLBOARD_SPHERICAL":case "NUM_LAMP_LIGHTS":case "MAX_STEPS":f=1;break;case "SHADOW_TEX_RES":f=t(2048);break;case "AA_METHOD":f="AA_METHOD_FXAA_QUALITY";break;case "AU_QUALIFIER":f="NOT_ASSIGNED";break;case "BILLBOARD_ALIGN":f="BILLBOARD_ALIGN_VIEW";break;case "POST_EFFECT":f="POST_EFFECT_NONE";break;case "SHADOW_USAGE":f="NO_SHADOWS";break;case "SSAO_QUALITY":f=
"SSAO_QUALITY_32";break;case "TEXTURE_BLEND_TYPE":f="TEXTURE_BLEND_TYPE_MIX";break;case "TEXTURE_COORDS":f="TEXTURE_COORDS_UV_ORCO";break;case "PRECISION":f=k.q.precision;break;case "EPSILON":f="highp"==k.q.precision?1E-6:1E-4;break;case "VERTEX_ANIM_MIX_NORMALS_FACTOR":f="u_va_frame_factor";break;default:x.error("Unknown directive ("+a.hj+", "+a.$h+"): "+d)}e(a,d,f)}};a.pI=function(a){return a.hj};a.ut=function(a){return a.$h};a.xI=function(a,c){for(var d=c.tf,f=0;f<d.length;f++){var g=d[f][0],k=
d[f][1];b(a,g)&&e(a,g,k)}};a.CB=function(a){var b=JSON.stringify(a),d=B[b];if(d)return d;var e=a.$h,d=c(A.shaders_dir,a.hj),e=c(A.shaders_dir,e);if(!d||!e)return null;var f=m("vert",d,a),g=m("frag",e,a),d=q,r=h(d,b,f,d.VERTEX_SHADER),k=h(d,b,g,d.FRAGMENT_SHADER),e=d.createProgram();d.attachShader(e,r);d.attachShader(e,k);d.linkProgram(e);d.validateProgram(e);d.getProgramParameter(e,d.VALIDATE_STATUS)==d.ZG&&x.error("shader program is not valid",b);n.uz(e,b,r,k,f,g);a={kr:r,it:k,mh:e,attributes:{},
vh:{},Ak:[],Yp:{},$v:[],ib:a};g=d.getProgramParameter(e,d.ACTIVE_ATTRIBUTES);for(f=0;f<g;f++)r=d.getActiveAttrib(e,f).name,a.attributes[r]=d.getAttribLocation(e,r);g=d.getProgramParameter(e,d.ACTIVE_UNIFORMS);for(f=0;f<g;f++)r=d.getActiveUniform(e,f).name.split("[0]").join(""),a.vh[r]=d.getUniformLocation(e,r);return B[b]=d=a};a.NC=function(){D=!1;if(b4w.module_check("shader_texts"))D=!0;else{for(var a=[],b=g.AT_TEXT,c=0;c<F.length;c++){var d=I.rk(A.shaders_dir+F[c]);a.push({id:F[c],type:b,url:d})}b=
function(a,b){v||(v={});v[b]=a};a.length?g.enqueue(a,b,function(){D=!0}):x.error("Shaders have not been found.")}};a.vz=function(){return D};a.KH=function(){return u};a.rt=function(){return B};a.cleanup=function(){for(var a in B){var b=B[a];q.deleteProgram(b.mh);q.deleteShader(b.kr);q.deleteShader(b.it);delete B[a]}for(var c in y)delete y[c];for(var d in u)delete u[d]};a.LH=function(a){var b=a.tf;x.log("Shader: "+a.hj+" "+a.$h+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)x.log("  "+
b[a][0],b[a][1])};a.r=t;a.us=function(a,b){return b in a.vh?!0:!1};a.VB=function(a){return(q.getShaderSource(a).match(/(?:^|\s)varying(?=\s)/g)||[]).length}};b4w.module.__geometry=function(a,p){function e(a){return 65536<a.P?u.tt()?!1:!0:!1}function b(a){return 0<a.ra.length?!0:!1}function c(a,c,d){if(!b(a))return a;d||q.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.P*(c||1)+", will use drawArrays","color: #aa0");c=a.ra;d=a.P;var e=a.M,f=a.A,g;for(g in e){var k=e[g],n=x(k,d);e[g]=m(c,k,n)}for(e=0;e<f.length;e++){var l=f[e];for(g in l)k=l[g],n=x(k,d),l[g]=m(c,k,n)}for(e=0;e<a.ba.length;e++){g=a.ba[e].hc;for(var h in g)k=g[h],
n=x(k,d),g[h]=m(c,k,n)}a.P=c.length;a.ra=new Uint16Array(0);return a}function m(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),e=0;e<a.length;e++)for(var f=a[e],g=0;g<c;g++)d[c*e+g]=b[c*f+g];return d}function f(a,b){var c=a.gd,d=a.Tb[b];if(d)return c.subarray(d.offset,d.offset+d.length);throw"extract_array() failed; invalid name: "+b;}function l(b,c){var d,e;switch(c){case a.mj:case a.fl:d=E.TRIANGLES;e=E.STATIC_DRAW;break;case a.vr:d=E.POINTS;e=E.STATIC_DRAW;
break;case a.el:d=E.TRIANGLES;e=E.DYNAMIC_DRAW;break;case a.ur:d=E.POINTS;e=E.DYNAMIC_DRAW;break;case a.Mw:d=E.LINES;e=E.STATIC_DRAW;break;default:throw"Wrong draw_mode";}b.mode=d;b.Vk=e}function h(a){a.zf?(a.Le||(a.Le=E.createBuffer()),E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,a.Le),E.bufferData(E.ELEMENT_ARRAY_BUFFER,a.zf,a.Vk),a.Ql=a.zf.byteLength):a.Ql=0;a.cg||(a.cg=E.createBuffer());E.bindBuffer(E.ARRAY_BUFFER,a.cg);E.bufferData(E.ARRAY_BUFFER,a.gd,a.Vk);a.Os=a.gd.byteLength}function t(a){for(var b=
w.Eb("JOIN_"+a.length+"_SUBMESHES"),c=0,d=0;d<a.length;d++)c+=a[d].ra.length;b.ra=new Uint32Array(c);var e=c=0,f=0;if(0<a[0].ba.length)for(var g=0;g<a[0].ba.length;g++){for(d=0;d<a.length;d++)c+=a[d].ba[g].hc.a_position.length,e+=a[d].ba[g].hc.a_normal.length,f+=a[d].ba[g].hc.a_tangent.length;d={a_position:new Float32Array(c),a_normal:new Float32Array(e),a_tangent:new Float32Array(f)};b.ba.push({lm:a[0].ba[g].lm,hc:d})}for(d=c=0;d<a.length;d++)c+=a[d].P;b.P=c;var e=a[0],k;for(k in e.M){for(d=c=0;d<
a.length;d++)c+=a[d].M[k].length;b.M[k]=new Float32Array(c)}for(k in e.A[0]){for(d=c=0;d<a.length;d++)c+=a[d].A[0][k].length;for(d=0;d<e.A.length;d++)b.A[d]=b.A[d]||{},b.A[d][k]=new Float32Array(c)}for(k=e=c=0;k<a.length;k++){for(var f=a[k],q=f.ra,g=f.P,n=f.M,d=0;d<q.length;d++)b.ra[c+d]=q[d]+e;var c=c+q.length,l;for(l in n){var q=n[l],m=e*x(q,g);b.M[l].set(q,m)}for(d=0;d<f.A.length;d++){var n=f.A[d],h=b.A[d];for(l in n)q=n[l],m=e*x(q,g),h[l].set(q,m)}e+=g}if(0<b.ba.length)for(k=0;k<b.ba.length;k++)for(l=
b.ba[k].hc,d=f=e=c=0;d<a.length;d++)g=a[d].ba[k].hc,l.a_position.set(g.a_position,c),l.a_normal.set(g.a_normal,e),l.a_tangent.set(g.a_tangent,f),c+=g.a_position.length,e+=g.a_normal.length,f+=g.a_tangent.length;return b}function d(a,b,d,e,f,l){var m=w.Eb("SUBMESH_"+a.name+"_"+b),h=a.submeshes[b],u=h.base_length,v=a.materials[b];m.P=u;var D=!1;if(k(d,"a_texcoord")){var x=null,E=a.materials[b];b=a.submeshes[b];if(E.texture_slots.length)switch(E=E.texture_slots[0],E.texture_coords){case "UV":E=a.uv_textures.indexOf(E.uv_layer);
0==E?x=new Float32Array(b.texcoord):1==E&&(x=new Float32Array(b.texcoord2));break;case "ORCO":for(var t=a.b4w_bounding_box_source,x=new Float32Array(2*b.base_length),E=(t.max_x+t.min_x)/2,C=(t.max_z+t.min_z)/2,G=t.max_x-t.min_x,t=t.max_z-t.min_z,M=0,p=0;p<b.position.length;p+=3)x[M++]=(b.position[p]-E)/G+.5,x[M++]=(C-b.position[p+2])/t+.5}null===x&&(x=new Float32Array(2*b.base_length));b=x}else b=new Float32Array(0);if(k(d,"a_orco_tex_coord")){x=a.b4w_bounding_box_source;E=new Float32Array(3*h.base_length);
C=x.max_x-x.min_x;G=x.max_y-x.min_y;t=x.max_z-x.min_z;for(p=M=0;p<h.position.length;p+=3)0==C?E[M++]=.5:E[M++]=w.clamp(parseFloat(((h.position[p]-x.min_x)/C).toFixed(5)),0,1),0==t?E[M++]=.5:E[M++]=w.clamp(parseFloat(((x.max_z-h.position[p+2])/t).toFixed(5)),0,1),0==G?E[M++]=.5:E[M++]=w.clamp(parseFloat(((h.position[p+1]-x.min_y)/G).toFixed(5)),0,1);x=E}else x=new Float32Array(0);var L,E=h.group;if(k(d,"a_influence")&&e){C=new Float32Array(4*u);G=E.length/u;t=new Float32Array(G);for(M=0;M<G;M++)for(L in t[M]=
-1,e)if(p=e[L],p.uw===M){t[M]=p.zo;break}var O=3<G?G:4;e=new Float32Array(O);L=new Uint32Array(O);for(var M=new Float32Array(4),p=new Float32Array(O),O=new Uint32Array(O),S=new Float32Array(4),F=0;F<u;F++)e.set(p),L.set(O),M.set(S),C.set(n(E,G,F,u,t,e,L,M),4*F)}else C=new Float32Array(0);L=C;e=f?w.qa(f):{};e.a_color={Og:!0};e.a_color.src=k(d,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,vd:7}]:[];f={a_texcoord:b,a_influence:L,a_orco_tex_coord:x};L=h.vertex_colors;b=h.color;x=a.name;E=[];
for(C=0;C<L.length;C++)E.push(L[C].name);for(var B in e)if(C=e[B].src,C.length){for(t=G=0;t<C.length;t++)G+=w.qh(C[t].vd);f[B]=new Float32Array(G*u);for(t=M=0;t<C.length;t++){var A=C[t].name,p=C[t].vd,O=w.dv(p),I=E.indexOf(A);-1==I&&w.U('vertex color "'+A+'" for mesh "'+x+'" not found.');S=L[I].mask;F=w.qh(S);(p&S)!==p&&q.error("Wrong color extraction from "+A+" to "+B+".");for(var J=A=0;J<I;J++)A+=w.qh(L[J].mask);I=A*u;for(A=0;A<u;A++)for(J=0;3>J;J++)O[J]&&(f[B][A*G+(M+w.Gk(p,J))]=b[I+A*F+w.Gk(S,
J)]);M+=F}}else f[B]=new Float32Array(0);B=a.uv_textures;e=h.texcoord;L=h.texcoord2;if(l)for(var Y in l){b=B.indexOf(Y);if(0==b)var U=new Float32Array(e);else 1==b&&(U=new Float32Array(L));f[l[Y]]=U}m.M=f;m.ra=new Uint32Array(h.indices);l=h.position.length/u/3;U=(Y=k(d,"a_normal")&&h.normal.length?!0:!1)&&k(d,"a_tangent")&&h.tangent.length?!0:!1;B=v.texture_slots[0];B=Y&&v.texture_slots.length&&k(d,"a_tangent")&&"ORCO"==B.texture_coords&&B.use_map_normal?!0:!1;0<a.b4w_shape_keys.length&&(D=!0);for(f=
0;f<l;f++){v=g(h,d,u,Y,U,B,f,a.name);if(D)if(e={},e.name=a.b4w_shape_keys[f].name,m.ba.push(e),0!=f){e.hc=v;e.lm=a.b4w_shape_keys[f].value;continue}else e.hc=g(h,d,u,Y,U,B,f,a.name),e.lm=1;m.A.push(v)}if(1<l&&!D){a=m.A[0];var v={},ya;for(ya in a)v[ya]=new Float32Array(a[ya]);m.A.push(v)}k(d,"a_polyindex")&&(c(m,1,!0),m.M.a_polyindex=y(m));return m}function g(a,b,c,d,e,f,g,n){var l={},m=new Float32Array(3*c),h=new Float32Array(d?3*c:0),u=new Float32Array(e||f?4*c:0),v=g*c*3;m.set(a.position.subarray(v,
v+3*c),0);d&&(v=g*c*3,h.set(a.normal.subarray(v,v+3*c),0));if(e)v=g*c*4,u.set(a.tangent.subarray(v,v+4*c),0);else if(f)for(a=u,q.warn('Not precise tangents calculation for normalmap using GENERATED texture coordinates in mesh: "'+n+'". Please add a UV-map.'),n=0;n<c;n++)b=C,d=M,b[0]=h[3*n],b[1]=h[3*n+1],b[2]=h[3*n+2],J.cross(b,w.AXIS_Z,d),0==J.length(d)&&J.cross(b,w.AXIS_X,d),J.normalize(d,d),a[4*n]=d[0],a[4*n+1]=d[1],a[4*n+2]=d[2],a[4*n+3]=1;else if(d&&k(b,"a_tangent"))for(u=new Float32Array(4*c),
c=0;c<u.length;c++)u[c]=1;l.a_position=m;l.a_normal=h;l.a_tangent=u;return l}function k(a,b){return-1<a.indexOf(b)?!0:!1}function n(b,c,d,e,f,g,k,q){for(var n=!0,l=0;l<c;l++){var m=b[l*e+d];if(-1!==m){var h=f[l];-1!==h&&(g[l]=m,k[l]=h,n=!1)}}if(n)return q;I(g,k,a.yn,!1);for(l=b=0;4>l;l++)b+=g[l];if(.01>b)return q;for(l=0;4>l;l++)g[l]/=b;if(.01>Math.abs(g[0]-1))q[0]=k[0]+1;else for(l=0;4>l;l++)q[l]=k[l]+g[l];return q}function x(a,b){if(0==b)return 0;var c=a.length,d=c/b;if(d!=Math.floor(d))throw"Array size mismatch during geometry calculation: array length="+
c+", base length="+b;return d}function I(b,c,d,e){for(var f=b.length,g=f,k=!1,q=e?-1:1;1<g||k;){1<g&&(g=Math.floor(g/1.247330950103979));for(var k=!1,n=0;g+n<f;n++)if(d==a.yn?0>q*(b[n]-b[n+g]):b[n]<b[n+g]&&e)k=b[n],b[n]=b[n+g],b[n+g]=k,k=c[n],c[n]=c[n+g],c[n+g]=k,k=!0}}function A(a,b,c){var d=[],e=[];J.subtract(b,a,d);J.subtract(c,a,e);J.normalize(d,d);J.normalize(e,e);return Math.acos(J.dot(d,e))}function B(a,c,d){c||(c=[]);d=d?a.A[0].a_normal:a.A[0].a_position;if(b(a)){a=a.ra;for(var e=a.length/
3,f=0;f<e;f++){var g=new Float32Array(9),k=a[3*f];g[0]=d[3*k];g[1]=d[3*k+1];g[2]=d[3*k+2];k=a[3*f+1];g[3]=d[3*k];g[4]=d[3*k+1];g[5]=d[3*k+2];k=a[3*f+2];g[6]=d[3*k];g[7]=d[3*k+1];g[8]=d[3*k+2];c[f]=g}}else for(f=0;f<d.length;f++)g=new Float32Array(9),g[0]=d[9*f],g[1]=d[9*f+1],g[2]=d[9*f+2],g[3]=d[9*f+3],g[4]=d[9*f+4],g[5]=d[9*f+5],g[6]=d[9*f+6],g[7]=d[9*f+7],g[8]=d[9*f+8],c[f]=g;return c}function y(a){for(var b=new Float32Array(a.P),c=0;c<a.P;c++)b[c]=c%3;return b}function v(a,b,c){var d=J.dist(a,
b);a=J.dist(a,c);b=J.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function F(a,b,c,d,e){c-=b;for(var f=0;f<c;f+=d)f%d==e&&vec3.normalize(a.subarray(f+b-e,f+b+1),a.subarray(f+b-e,f+b+1))}var u=p("__extensions"),q=p("__print"),D=p("__tsr"),w=p("__util"),J=p("__vec3"),C=new Float32Array(3),M=new Float32Array(3),G=new Float32Array(3);a.re=10;a.Er=20;a.eH=30;a.fl=10;a.vr=20;a.el=30;a.ur=40;a.Mw=50;a.yn=0;a.Yx=1;a.mj=a.fl;var E=null;a.$c=function(a){E=a};a.MH=function(a){var b=_buffers[a];E.deleteBuffer(b.Le);
E.deleteBuffer(b.cg);delete _buffers[a]};a.hF=function(d,f,g,k){e(d)&&c(d);var n=d.ra,q=d.P,m=d.A,u={},v;for(v in d.M)v in k&&!k[v].Og||(u[v]=d.M[v]);k={zf:null,gd:null,jp:0,count:0,Tb:{},mode:0,Vk:0,Ql:0,Os:0,cg:null,Le:null,jm:null,ba:null};if(0<d.ba.length){v=m[0];for(var D=1;D<d.ba.length;D++){for(var t=d.ba[D].hc,w=t.a_position,C=t.a_normal,G=v.a_position,M=v.a_normal,p=w.length,y=d.ba[D].lm,F=0;F<p;F++)G[F]+=y*w[F],M[F]+=y*C[F];t=t.a_tangent;w=v.a_tangent;C=t.length;for(F=0;F<C;F++)w[F]+=y*
t[F]}}if(n.length)if(v=n.length,65536>=q)var D=new Uint16Array(n),L=E.UNSIGNED_SHORT;else D=new Uint32Array(n),L=E.UNSIGNED_INT;else v=q,D=null;var y=0,F=m.length,O;for(O in m[0])t=m[0][O],y+=t.length*F;for(O in u)t=u[O],y+=t.length;O=new Float32Array(y);var y=0,F={},S;for(S in u)if(w=u[S],t=w.length)O.set(w,y),F[S]={rH:S,ee:x(w,q),offset:y,frames:1,length:t},y+=t;u=m.length;for(S in m[0])if(w=m[0][S],t=w.length,w=x(w,q),t)for(F[S]={ee:w,offset:y,frames:u,length:t},1<u&&(F[S+"_next"]={ee:w,offset:y+
t,frames:u,length:t}),C=0;C<u;C++)w=m[C][S],O.set(w,y),y+=t;k.count=v;k.zf=D;k.gd=O;k.jp=L;k.Tb=F;l(k,g);h(k);f!=a.re&&b(d)&&(k.jm={gD:new Float32Array(n.length),hD:new Float32Array(n.length),FA:new Float32Array(n.length/3),type:f});k.ba=d.ba;return k};a.rC=e;a.qC=b;a.$m=c;a.HF=function(a,b,c){l(a,b);a.count=c.length;a.zf=c;a.jp=c instanceof Uint16Array?E.UNSIGNED_SHORT:E.UNSIGNED_INT};a.gn=function(a,b,c,d){var e=a.gd,f=a.Tb,g=f[b];g?(c&&g.ee!=c&&w.U('invalid num_comp for "'+b+'"'),e.set(d,g.offset)):
(e=e.length,g=new Float32Array(e+d.length),g.set(a.gd),g.set(d,e),a.gd=g,f[b]={ee:c,offset:e});h(a)};a.SA=f;a.RI=function(a){a.Vk=E.STATIC_DRAW};a.YC=function(a){a.Vk=E.DYNAMIC_DRAW};a.dw=h;a.ws=function(a){a.Le&&E.deleteBuffer(a.Le);a.cg&&E.deleteBuffer(a.cg)};a.Nt=function(a,b){return a.submeshes[b].base_length?!1:!0};a.Ov=function(a,b){for(var c=0;c<a.A.length;c++){var d=a.A[c].a_position;D.transform_vectors(d,b,d,0);d=a.A[c].a_normal;0<d.length&&D.transform_dir_vectors(d,b,d,0);d=a.A[c].a_tangent;
0<d.length&&D.transform_tangents(d,b,d,0)}(c=a.M.au_center_pos)&&c.length&&D.transform_vectors(c,b,c,0);return a};a.fF=function(a,b){var c=a.M.au_center_pos;if(c&&c.length){var d=new Float32Array(c);D.transform_vectors(d,b,d,0);for(var e=0;e<a.A.length;e++)for(var f=0;f<d.length;f++)a.A[e].a_position[f]+=d[f]-c[f];c.set(d)}else throw'Attribute "au_center_pos" is missing in particle submesh';};a.eF=function(a,b){var c=a.P,d;for(d in b){var e=b[d].length;a.M[d]=new Float32Array(e*c);for(var f=0;f<c;f++)for(var g=
0;g<e;g++)a.M[d][f*e+g]=b[d][g]}};a.gF=t;a.XC=function(a,b,d){if(!a.P)return w.Eb("EMPTY");var e=d.length;65536<a.P*e&&!u.tt()&&c(a,e);var f=a.ra,g=a.P,k=a.M;a=a.A;for(var n in b){var q=b[n].length,l=q*g;k[n]=new Float32Array(l);for(var m=0;m<g;m++)for(l=0;l<q;l++)k[n][m*q+l]=b[n][l]}b=w.Eb("CLONE_"+e+"_SUBMESHES");b.P=g*e;b.ra=new Uint32Array(f.length*e);for(m=0;m<e;m++)for(q=f.length*m,n=g*m,l=0;l<f.length;l++)b.ra[q+l]=f[l]+n;for(var h in k)for(f=k[h],l=f.length*e,q=x(f,g),b.M[h]=new Float32Array(l),
m=0;m<e;m++)n=g*q*m,b.M[h].set(f,n);for(h in a[0])for(m=0;m<a.length;m++)for(f=a[m][h],l=f.length*e,q=x(f,g),b.A[m]=b.A[m]||{},b.A[m][h]=new Float32Array(l),l=0;l<e;l++)switch(k=d[l],n=g*q*l,h){case "a_position":D.transform_vectors(f,k,b.A[m][h],n);break;case "a_normal":D.transform_dir_vectors(f,k,b.A[m][h],n);break;case "a_tangent":D.transform_tangents(f,k,b.A[m][h],n);break;default:throw"Wrong attribute name: "+h;}return b};a.$s=d;a.VA=function(a){var b=a.P,c=a.A[0].a_position,d=new Float32Array(12*
b),e=new Float32Array(8*b);a=new Uint32Array(4*a.ra.length);for(var f=0;f<b;f++)d[12*f]=c[3*f],d[12*f+1]=c[3*f+1],d[12*f+2]=c[3*f+2],d[12*f+3]=c[3*f],d[12*f+4]=c[3*f+1],d[12*f+5]=c[3*f+2],d[12*f+6]=c[3*f],d[12*f+7]=c[3*f+1],d[12*f+8]=c[3*f+2],d[12*f+9]=c[3*f],d[12*f+10]=c[3*f+1],d[12*f+11]=c[3*f+2],e[8*f]=-.5,e[8*f+1]=-.5,e[8*f+2]=-.5,e[8*f+3]=.5,e[8*f+4]=.5,e[8*f+5]=.5,e[8*f+6]=.5,e[8*f+7]=-.5,a[6*f]=4*f+2,a[6*f+1]=4*f+1,a[6*f+2]=4*f,a[6*f+3]=4*f+2,a[6*f+4]=4*f,a[6*f+5]=4*f+3;c=w.Eb("HALO");c.A=
[];c.A[0]={};c.P=4*b;c.A[0].a_position=d;c.M.a_halo_bb_vertex=e;c.ra=a;return c};a.bC=k;a.at=function(a,b,c){for(var e=[],f=0;f<a.submeshes.length;f++){var g=d(a,f,b,null,c,null);g.P&&e.push(g)}return 0==e.length?w.Eb("EMPTY"):1==e.length?e[0]:t(e)};a.GF=function(a,b,c){for(var d=a.zf,e=f(a,"a_position"),g=a.jm,k=g.gD,n=g.hD,g=g.FA,q=d,l=q.length/3,m=0;m<l;m++){var h=q[3*m],u=q[3*m+1],v=q[3*m+2],D=e[3*h+1],x=e[3*h+2],t=e[3*u+1],C=e[3*u+2],L=e[3*v+1],O=e[3*v+2];k[3*m]=(e[3*h]+e[3*u]+e[3*v])/3;k[3*
m+1]=(D+t+L)/3;k[3*m+2]=(x+C+O)/3}w.Mf(k,b,n);b=n.length/3;for(e=0;e<b;e++)k=n[3*e]-c[0],q=n[3*e+1]-c[1],l=n[3*e+2]-c[2],g[e]=k*k+q*q+l*l;c=d;d=g.length;if(!(2>d))for(n=d,e=!1;1<n||e;)for(1<n&&(n=Math.floor(n/1.247330950103979)),e=!1,b=0;n+b<d;b++)0>g[b]-g[b+n]&&(e=g[b],g[b]=g[b+n],g[b+n]=e,e=c,k=b,q=b+n,l=e[3*k],m=e[3*k+1],h=e[3*k+2],e[3*k]=e[3*q],e[3*k+1]=e[3*q+1],e[3*k+2]=e[3*q+2],e[3*q]=l,e[3*q+1]=m,e[3*q+2]=h,e=!0);d=c;E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,a.Le);E.bufferData(E.ELEMENT_ARRAY_BUFFER,
d,E.DYNAMIC_DRAW)};a.Dv=I;a.hs=function(a,b,c){for(var d=b.length/3,e=a.length/3,f=[],g=Array(3),k=Array(3),n=Array(3),q=0;q<e;q++){for(var l=a[3*q],m=a[3*q+1],h=a[3*q+2],u=0;3>u;u++)g[u]=b[3*l+u],k[u]=b[3*m+u],n[u]=b[3*h+u];if(c)var u=A(g,k,n),v=A(k,n,g),D=Math.PI-u-v;else D=v=u=1;var x=f,E;E=g;var L=n,t=[],S=[],w=[];J.subtract(k,E,t);J.subtract(L,E,S);J.cross(t,S,w);J.normalize(w,w);E=w;for(L=0;3>L;L++)t=3*m+L,S=3*h+L,x[3*l+L]=u*E[L],x[t]=v*E[L],x[S]=D*E[L]}if(c)for(var C in c)for(q=c[C],a=0;3>
a;a++){b=3*q[0]+a;for(e=1;e<q.length;e++)g=3*q[e]+a,f[b]+=f[g];for(e=1;e<q.length;e++)g=3*q[e]+a,f[g]=f[b]}for(q=0;q<d;q++){c=q;C=f;a=new Float32Array(3);for(b=0;3>b;b++)e=3*c+b,a[b]=C[e];J.normalize(a,a);for(b=0;3>b;b++)e=3*c+b,C[e]=a[b]}return f};a.js=function(a,b,c){for(var d={},e=b.length/3,f=0;f<e;f++){var g=String(b[3*f])+String(b[3*f+1])+String(b[3*f+2]);d[g]=[]}e=a.length;for(f=0;f<e;f++)b=a[f],g=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),g in d&&d[g].push(b);return d};a.Vo=function(a,
b,c,d){var e=B(a,null,!1);if(c)var f=B(a,null,!0);var g=e.length,k=new Float32Array(g),n=C,q=M;for(a=0;a<g;a++){var l=e[a];n.set(l.subarray(0,3));q.set(l.subarray(3,6));G.set(l.subarray(6));k[a]=Math.sqrt(v(n,q,G))}n=new Float32Array(g);n[0]=k[0];for(a=1;a<g;a++)n[a]=n[a-1]+k[a];g=n[k.length-1];k=[];for(a=0;a<b;a++){var q=g*w.xd(d),q=w.wl(n,q,0,n.length-1),l=c?f[q]:e[q],q=a,m=l,h=d,l=void 0,l=new Float32Array(3),u=m[0],D=m[1],x=m[2],E=m[3],t=m[4],L=m[5],O=m[6],S=m[7],p=m[8],m=w.xd(h),h=w.xd(h);1<
m+h&&(m=1-m,h=1-h);var y=1-m-h,D=y*D+m*t+h*S,x=y*x+m*L+h*p;l[0]=y*u+m*E+h*O;l[1]=D;l[2]=x;k[q]=l}return k};a.SH=B;a.Mo=y;a.oJ=v;a.gv=function(a,b,c){a=a.A[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.Sr=function(a,b,c){var d=a.V[0].S;a=a.f.Tf;for(var e=1;e<a.length;e++)a[e].name==b&&(a[e].value=c);for(e=0;e<d.length;e++)if(!d[e].Mg&&d[e].oe&&!d[e].Eg){c=d[e].N.Tb;b=d[e].N.gd;E.bindBuffer(E.ARRAY_BUFFER,d[e].N.cg);
var f=c.a_position,g=d[e],k=b,n=a;if(f){for(var q=f.offset,f=f.length+q,l=g.N.ba[0].hc.a_position,m=q;m<f;m++)k[m]=l[m-q];for(m=1;m<g.N.ba.length;m++){var l=g.N.ba[m].hc.a_position,h=n[m].value;if(h)for(var u=q;u<f;u++)k[u]+=h*l[u-q]}E.bufferSubData(E.ARRAY_BUFFER,4*q,k.subarray(q))}f=c.a_normal;g=d[e];k=b;n=a;if(f){q=f.offset;f=f.length+q;l=g.N.ba[0].hc.a_normal;for(m=q;m<f;m++)k[m]=l[m-q];for(m=1;m<g.N.ba.length;m++)if(l=g.N.ba[m].hc.a_normal,h=n[m].value)for(u=q;u<f;u++)k[u]+=h*l[u-q];F(k,q,f,
3,2);E.bufferSubData(E.ARRAY_BUFFER,4*q,k.subarray(q))}n=c.a_tangent;c=d[e];g=a;if(n){k=n.offset;n=n.length+k;f=c.N.ba[0].hc.a_tangent;for(q=k;q<n;q++)b[q]=f[q-k];for(q=1;q<c.N.ba.length;q++)if(f=c.N.ba[q].hc.a_tangent,m=g[q].value)for(l=k;l<n;l++)b[l]+=m*f[l-k];F(b,k,n,4,3);E.bufferSubData(E.ARRAY_BUFFER,4*k,b.subarray(k))}}};a.check_shape_keys=function(a){return a.f.oe};a.get_shape_keys_names=function(a){var b=[];if(a.f)for(var c=1;c<a.f.Tf.length;c++)b.push(a.f.Tf[c].name);return b};a.get_shape_key_value=
function(a,b){if(a.f)for(var c=1;c<a.f.Tf.length;c++)if(b==a.f.Tf[c].name)return a.f.Tf[c].value;return 0};a.hp=function(a,b){var c=a.f.Tf;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.gi=function(a){return a&&a.f&&a.f.Zd?!0:!1}};b4w.module.__objects=function(a,p){function e(a){a.f.If=0;a=ia.indexOf(a);-1!=a&&ia.splice(a,1)}function b(a){if(a.Xh)for(var b=a.V,c=0;c<b.length;c++)K.NF(b[c].na,a)}function c(a,b){for(var c=a.V,d=b.V,e=0;e<c.length;e++){for(var f=!1,g=0;g<d.length;g++)if(c[e].na==d[g].na){f=!0;break}f||m(b,c[e].na)&&J.pl(b,c[e].na)}}function m(a,b){return!b.Hr&&"SPEAKER"==a.type||!b.ey&&("LAMP"==a.type||"CAMERA"==a.type)?!1:!0}function f(a,b){if(a.dg_parent&&a.dg_parent.Fr||a.parent&&a.parent.Fr)return!0;switch(a.type){case "MESH":var c=
a.b4w_do_not_batch,d=a.b4w_collision,e=a.b4w_vehicle,f=a.b4w_floating,g=a.b4w_character,k=C.dC(a),r=w.fs(a),q=0<a.data.b4w_shape_keys.length,n=a.b4w_dynamic_geometry;if(!(c=A.gs(a,b)||c||d||e||q||f))a:{c=a.data;for(d=0;d<c.materials.length;d++)if("LENS_FLARES"===c.materials[d].name){c=!0;break a}c=!1}return c||k||g||r||n;case "EMPTY":return g=w.fs(a),k=a.b4w_do_not_batch,A.gs(a,b)||g||k;default:return!0}}function l(a,b,c,d,e,f,g,k,r){for(var q=0;q<a.nodes.length;q++){var n=a.nodes[q];if("VALUE"==
n.type){var m=t(b,n.name);d.push(n.outputs[0].default_value);e.push(m,e.length/2)}else"RGB"==n.type?(m=t(b,n.name),n=n.outputs[0].default_value.slice(0,3),g.push(n[0],n[1],n[2]),k.push(m,k.length/2)):"GROUP"==n.type&&(m=n.node_group.node_tree,l(m,t(b,n.name),m.animation_data,d,e,f,g,k,r))}if(c)for((a=c.action)&&a.j.type==A.sr&&h(a,b,f,e,r,k),c=c.nla_tracks,d=0;d<c.length;d++)for(g=c[d].strips,q=0;q<c[d].strips.length;q++)(a=g[q].action)&&a.j.type==A.sr&&h(a,b,f,e,r,k)}function h(a,b,c,e,f,g){var k=
a.j.K,r;for(r in k){var q=t(b,r.match(/"(.*?)"/)[1]),k=d(e,q);null!=k?(q=t(a.name,r),c.push(q,k)):(k=d(g,q),null!=k&&(q=t(a.name,r),f.push(q,k)))}}function t(a,b){return a+"%join%"+b}function d(a,b){for(var c=0;c<a.length;c+=2)if(a[c]==b)return a[c+1];return null}function g(a,b){for(var c=a.f.$g,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null}function k(a,b){for(var c=a.f.Zg,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null}function n(a,b,c){b=aa[b]||[];for(var d=[],e=0;e<b.length;e++){var f=
b[e];if(f.f.uc==c||-1==c)for(var g=f.V,k=0;k<g.length;k++)g[k].na==a&&d.push(f)}return d}function x(a,b,c,d){for(var e=null,f=0;f<b.length;f++){var g=b[f];if((c?g.gh:g.name)==a&&(g.f.uc==d||-1==d)&&(e=g,!J.get_dg_parent(e)))break}return e}function I(a){aa.ALL.push(a);aa[a.type]||(aa[a.type]=[]);aa[a.type].push(a);var b=a.f.Wc;if(null!=b)for(var c=0;c<na.length;c++){var d=na[c];d.f.Wc==b&&d.Fk.push(a)}}var A=p("__animation"),B=p("__batch"),y=p("__boundings"),v=p("__camera"),F=p("__config"),u=p("__constraints"),
q=p("__geometry"),D=p("__lights"),w=p("__nla"),J=p("__obj_util"),C=p("__particles"),M=p("__physics"),G=p("__print"),E=p("__primitives"),r=p("__quat"),K=p("__scenes"),z=p("__sfx"),H=p("__transform"),V=p("__tsr"),ba=p("__util"),X=p("__vec3"),fa=p("__armature"),Q=F.q,ha=F.Ab,aa={ALL:[]},R=0,W=0,na=[],ia=[],da=new Float32Array(3),ja=new Float32Array(4);a.xn=0;a.wn=1;a.jd=2;a.DATA_ID_ALL=-1;a.update=function(a){for(var b=aa.ALL,c=aa.ARMATURE,d=0;d<b.length;d++)for(var f=b[d],g=f.V,k=0;k<g.length;k++){var r=
g[k].na;if(r.j.outline){if(-1!=ia.indexOf(f)){var q=f,n=a,m=0,l=q.Du;0==l.an&&(l.an=n);n-=l.an;if(l.iq&&n/l.Vc>=l.iq)e(q);else{n%=l.Vc;if(n<l.Up)switch(l=n/(l.Up/5),n=Math.floor(l),n){case 0:m=(l-n)/2;break;case 1:m=(l-n)/2+.5;break;case 2:m=1;break;case 3:m=1-(l-n)/2;break;case 4:m=.5-(l-n)/2}q.f.If=m}}f.f.If&&K.aE(r)}}if(c)for(d=0;d<c.length;d++)a=c[d],a.Np&&(H.o(a),a.Np=!1)};a.apply_outline_anim=function(a,b,c,d){var e=a.Du;e.an=0;e.Up=b;e.Vc=c;e.iq=d;-1==ia.indexOf(a)&&ia.push(a)};a.clear_outline_anim=
e;a.wh=function(a,b){b.zh=a.uuid;b.zl=!0;var c=a.animation_data,d=a.data.animation_data;c&&c.action&&(c=c.action,(c.j.type==A.Lw||c.j.type==A.Jw&&"ARMATURE"==b.type||c.j.type==A.Kw&&"LAMP"==b.type)&&b.actions.push(c));d&&d.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.actions.push(d.action);"MESH"==b.type&&b.actions.push.apply(b.actions,A.AB(a));a.Fr=b.sa=f(a,b);a.fH=!0;b.xc=a.b4w_vehicle;b.is_character=a.b4w_character;b.Sg=a.b4w_floating;b.fj=a.b4w_collision;b.Ia=a.b4w_collision_id;b.Jl=a.b4w_correct_bounding_offset;
d=a.game;b.Kd={Hm:d.physics_type,Xk:d.use_ghost,mw:d.use_sleep,ce:d.mass,rw:d.velocity_min,qw:d.velocity_max,wo:d.damping,nq:d.rotation_damping,OC:d.lock_location_x,PC:d.lock_location_y,QC:d.lock_location_z,RC:d.lock_rotation_x,SC:d.lock_rotation_y,TC:d.lock_rotation_z,Dj:d.collision_margin,Bj:d.collision_group,Ej:d.collision_mask,br:d.use_collision_bounds,El:d.collision_bounds_type,Wk:d.use_collision_compound};if(d=a.b4w_vehicle_settings)b.Hc={name:d.name,zc:d.part,kF:d.suspension_rest_length,Kq:d.suspension_compression,
Mq:d.suspension_stiffness,Lq:d.suspension_damping,nr:d.wheel_friction,lq:d.roll_influence,Hp:d.max_suspension_travel_cm,Xj:d.force_max,vj:d.brake_max,Vi:d.steering_max,ti:d.max_speed_angle,Nj:d.delta_tach_angle,Kk:d.speed_ratio,Nk:d.steering_ratio,ik:d.inverse_control,Kg:d.floating_factor,Fh:d.water_lin_damp,Gh:d.water_rot_damp,Sv:d.synchronize_position};if(d=a.b4w_floating_settings)b.Yh={name:d.name,zc:d.part,Kg:d.floating_factor,Fh:d.water_lin_damp,Gh:d.water_rot_damp,Sv:d.synchronize_position};
if(d=a.b4w_character_settings)b.qs={zG:d.walk_speed,gE:d.run_speed,bF:d.step_height,wC:d.jump_strength,BG:d.waterline};for(d=0;d<a.constraints.length;d++)c=a.constraints[d],"RIGID_BODY_JOINT"==c.type&&b.Zp.push({target:c.target.fa,zD:c.pivot_type,AD:c.pivot_x,BD:c.pivot_y,CD:c.pivot_z,Td:c.axis_x,Ud:c.axis_y,Vd:c.axis_z,eG:c.use_limit_x,fG:c.use_limit_y,gG:c.use_limit_z,$F:c.use_angular_limit_x,aG:c.use_angular_limit_y,bG:c.use_angular_limit_z,GC:c.limit_max_x,HC:c.limit_max_y,IC:c.limit_max_z,JC:c.limit_min_x,
KC:c.limit_min_y,LC:c.limit_min_z,AC:c.limit_angle_max_x,BC:c.limit_angle_max_y,CC:c.limit_angle_max_z,DC:c.limit_angle_min_x,EC:c.limit_angle_min_y,FC:c.limit_angle_min_z});d=b.f=J.Sh("MESH"===b.type?b.sa?"DYNAMIC":"STATIC":b.type);a.parent?(b.parent=a.parent.fa,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(b.zk=a.parent_bone)):a.dg_parent&&(b.parent=a.dg_parent.fa,b.Kf=!0);var c=a.location,e=a.scale[0];ba.dq(a.rotation_quaternion,ja);H.set_translation(b,c);H.set_rotation(b,ja);H.set_scale(b,
e);b.jn=a.b4w_use_default_animation;b.ml=A.jy(a.b4w_anim_behavior);a.b4w_object_tags&&(b.wm={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,category:a.b4w_object_tags.category});switch(a.type){case "ARMATURE":fa.wh(a,b);var c=d.ld,g=A.dz(c);a.b4w_animation_mixing?(d.Bc=new Float32Array(g.ma),d.Xc=new Float32Array(g.ma),d.Gc=new Float32Array(g.i),d.ed=new Float32Array(g.i)):(d.Bc=g.ma,d.Xc=g.ma,d.Gc=g.i,d.ed=g.i);for(var k in c)e=c[k],1==e.Dl.length&&fa.FF(e,!0,g.i,g.ma);d.$p=
g;d.sd=0;d.rg=a.b4w_animation_mixing;break;case "MESH":d.Tl=a.b4w_do_not_render;d.Oh=B.Ry(a.data.b4w_bounding_box);d.Ve=ha.outlining_overview_mode||a.b4w_selectable;d.Cm=a.b4w_selectable;d.Ab=ha.outlining_overview_mode||a.b4w_outlining;d.Bm=a.b4w_outlining;d.Eu=ha.outlining_overview_mode||a.b4w_outline_on_select;d.Cd=a.b4w_billboard;d.Pn=a.b4w_pres_glob_orientation;d.tj="BASIC";d.sj="SPHERICAL"==a.b4w_billboard_geometry;k=d.Ci;k.Di=a.b4w_outline_settings.outline_duration;k.Ei=a.b4w_outline_settings.outline_period;
k.Fi=a.b4w_outline_settings.outline_relapses;d.Ve&&(d.Fl=ba.jt(R),R++);for(k=0;k<a.data.b4w_vertex_anim.length;k++)c=a.data.b4w_vertex_anim[k],b.Wb.push({name:c.name,I:c.frame_start,Z:c.frame_end,tH:c.averaging,uH:c.averaging_interval,hy:c.allow_nla});b.f.Wb=b.Wb.length?!0:!1;if("MESH"!=a.type)throw"Wrong object type: "+a.name;k=b.f;if(a.data.b4w_shape_keys.length)for(k.oe=!0,c=0;c<a.data.b4w_shape_keys.length;c++)e={},e.value=a.data.b4w_shape_keys[c].value,e.name=a.data.b4w_shape_keys[c].name,k.Tf.push(e);
else k.oe=!1;if(k=A.pt(a)){var q=k.fa,c=q.f.$p,e=b.f,n=a.data;b.ql=q;n=n.vertex_groups;if(n.length){var q=q.f.ld,m=0,h={};for(g in q){var u=ba.keysearch("name",g,n);u&&(h[g]={uw:u.index,lf:q[g].lf,zo:m++})}e.Qh=h;g=m;n=A.xt();e.Pe=g;g>2*n?(e.li=!1,G.error('too many bones for "'+a.name+'" / '+e.Pe+" bones (max "+n+" with blending, "+2*n+" without blending). Skinning will be disabled.")):e.li=!0}g=A.WA(c.i,c.ma,d.Qh);k.b4w_animation_mixing?(d.Bc=new Float32Array(g.ma),d.Xc=new Float32Array(g.ma),d.Gc=
new Float32Array(g.i),d.ed=new Float32Array(g.i)):(d.Bc=g.ma,d.Xc=g.ma,d.Gc=g.i,d.ed=g.i);d.Hn=new Float32Array(4);d.Gn=r.create();d.$p=g;d.sd=0}g=b.f;k=a.data.materials;c=[];e=[];n=[];q=[];m=[];h=[];for(u=0;u<k.length;u++){var N=k[u],x=N.node_tree;x&&l(x,N.name,x.animation_data,c,e,n,q,m,h)}g.Oe=c;g.$g=e;g.um=n;g.Tc=q;g.Zg=m;g.vm=h;d.ad=a.b4w_shadow_cast;d.Ec=a.b4w_shadow_receive;d.Dc=a.b4w_shadow_cast_only&&d.ad;d.nc=a.b4w_reflexible;d.bc=a.b4w_reflexible_only&&d.nc;d.Cc=a.b4w_reflective;d.fe=a.b4w_reflection_type;
d.we=a.b4w_caustics;d.hd=a.b4w_wind_bending;d.$k=a.b4w_wind_bending_angle;g=B.CG(a.b4w_wind_bending_angle,d.Oh,a.scale[0]);d.pe=g;d.cf=a.b4w_wind_bending_freq;d.Ae=a.b4w_detail_bending_freq;d.ze=a.b4w_detail_bending_amp;d.ue=a.b4w_branch_bending_amp;d.ii=!1;d.Ne=a.b4w_main_bend_stiffness_col;g=a.b4w_detail_bend_colors;d.$b={};d.$b.eu=g.leaves_stiffness_col;d.$b.du=g.leaves_phase_col;d.$b.Fu=g.overall_stiffness_col;d.Uh=a.b4w_do_not_cull;d.Sl=a.b4w_disable_fogging;d.Zd=a.b4w_dynamic_geometry;if("MESH"!==
a.type)throw"Wrong object";g=a.data.materials[0];d.$j=g.physics.friction;d.Uj=g.physics.elasticity;d.qk=0;d.Cf=1E4;d.Xg=a.b4w_lod_transition;d.rm=!0;break;case "CAMERA":v.gz(a,b);v.Ly(b);break;case "LAMP":D.xC(a,b);break;case "SPEAKER":b.w=z.eA();d=!1;for(g=0;g<b.V.length;g++)if(b.V[g].na.b4w_enable_audio){d=!0;break}d&&z.wh(a,b);break;case "EMPTY":d.Qb=y.Ad(),g=y.al(),d.nd=g,a.field&&(b.Xh={type:a.field.type,Mv:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,Th:a.b4w_anchor.detect_visibility,
Wl:a.b4w_anchor.element_id,eD:a.b4w_anchor.max_width})}I(b)};a.RF=function(a,b){var d=b.f;if(b.parent){var e=d.i,f=d.quat,g=d.scale;!b.Kf&&b.Kd.Wk&&b.parent.Kd.Wk&&(b.fj=!1);var k=b.Kd;b.xc||b.Sg||M.is_character(b)||b.fj&&!k.Xk&&0<k.ce&&("DYNAMIC"==k.Hm||"RIGID_BODY"==k.Hm)?(e=b.Kf?V.create_sep(e,g,f):d.Ba,V.multiply(b.parent.f.Ba,e,d.Ba),H.set_translation(b,V.get_trans_view(d.Ba)),H.set_scale(b,V.get_scale(d.Ba)),H.set_rotation(b,V.get_quat_view(d.Ba))):b.Kf||!b.zk?(e=V.create_sep(e,g,f),u.my(b,
b.parent,e)):(e=V.create_sep(e,g,f),u.ny(b,b.parent,b.zk,e))}if("ARMATURE"==b.type)for(e=a.pose.bones,f=0;f<e.length;f++)if(g=e[f],k=g.constraints)for(var r=0;r<k.length;r++){var q=k[r];"COPY_TRANSFORMS"!=q.type||q.subtarget||q.mute||u.xy(b,q.target.fa,g.name,ba.Cr,ba.Br)}if("MESH"==b.type&&d.Cc)if(d=b.f,"CUBE"==d.fe)d.od=W++;else if("PLANE"==d.fe){a:{e=a.constraints;for(f=0;f<e.length;f++)if(g=e[f],"LOCKED_TRACK"==g.type&&"REFLECTION PLANE"==g.name){if(g.target.fa){e=g.target.fa;break a}G.warn('Reflection plane target "'+
g.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}e=null}e||(e=ba.cj("%reflection%"),e=J.Jj(e,"EMPTY"),f=J.Sh("EMPTY"),e.f=f,c(b,e),u.Rr(e,b,[0,0,0],null,1),I(e));f=null;for(g=0;g<na.length;g++)if(na[g]==e){f=g;break}null==f&&(f=na.length,na.push(e));e.f.Wc=f;d.Wc=f;e.Fk.push(b)}};a.cw=b;a.FH=c;a.pz=m;a.SF=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.f||"DYNAMIC"!=c.f.type&&"CAMERA"!=c.f.type||H.o(c);c.jn&&A.Cu(c)&&(A.apply_def(c),c.D.length&&
A.play(c,null,A.SLOT_ALL))}};a.get_meta_tags=function(a){return ba.qa(a.wm)};a.cleanup=function(){W=R=0;na=[];ia.length=0;aa={ALL:[]}};a.copy=function(a,b,d){var e=b,f=J.get_dg_parent(a);b=f?J.kt(f.name,b):b;if(x(b,aa.ALL,!1,-1)){for(var f=1,g;;){g="."+(3>String(f).length?("000"+String(f)).slice(-3):String(f));if(!x(b+g,aa.ALL,!1,-1))break;f++}G.error('Object "'+b+'" already exists. Name was replaced by "'+b+g+'".');e+=g;b+=g}e=J.Jj(b,a.type,e);e.zl=a.zl;e.sa=a.sa;e.mk=a.mk;e.jn=a.jn;e.f=J.pf(a.f);
e.wm=J.pf(a.wm);c(a,e);e.Kh=J.mo(a.Kh);e.parent=J.mo(a.parent);e.Kf=a.Kf;e.zk=a.zk;!a.m||a.xc||a.is_character||a.Sg||(e.fj=a.fj,e.m=J.pf(a.m));e.Ia=a.Ia;e.Jl=a.Jl;e.Kd=J.pf(a.Kd);b=[];for(f=0;f<a.V.length;f++){var k=e.V[f];g=a.V[f].S;if(d){for(var k=k.S,r=0;r<g.length;r++)g[r].Mg||(k.push(J.pf(g[r])),b.push(g[r].N));for(r=0;r<g.length;r++)if(g[r].Mg){var n=J.pf(g[r]);k.push(n);for(var m=0;m<b.length;m++)b[m]==g[r].N&&(n.N=k[m].N)}for(r=0;r<k.length;r++)k[r].N&&q.dw(k[r].N),k[r].Bi=e.zh,B.AF(k[r],
B.ez(e.f))}else k.S=J.mo(g)}J.pq(e,!1);I(e);e.f.pp=!0;e.f.Fl=ba.jt(R);R++;return e};a.oI=g;a.kI=k;a.update_boundings=function(a){for(var b=a.f,c=a.V[0].S,d,e,f,g,k,r,n=0;n<c.length;n++){var m=c[n];if("MAIN"==m.type){var m=m.N.gd,l=c[n].N.Tb,h=l.a_position.offset,l=l.a_position.length+h;d=g=m[h];e=k=m[h+1];f=r=m[h+2];for(var u=h;u<l;u+=3){var h=m[u],z=m[u+1],v=m[u+2];d=Math.max(h,d);e=Math.max(z,e);f=Math.max(v,f);g=Math.min(h,g);k=Math.min(z,k);r=Math.min(v,r)}}}var Z={max_x:parseFloat(d.toFixed(3)),
max_y:parseFloat(e.toFixed(3)),max_z:parseFloat(f.toFixed(3)),min_x:parseFloat(g.toFixed(3)),min_y:parseFloat(k.toFixed(3)),min_z:parseFloat(r.toFixed(3))},x=d-g,D=e-k,t=f-r;g=.5*(d+g);var pa=.5*(e+k),ma=.5*(f+r),wa=g,sb=ma;k=Math.max(x,Math.max(D,t))/2;r=Math.max(x,t)/2;var w=[g/(x?x:1),pa/(D?D:1),ma/(t?t:1)],C=.5;if(b.Cd)h=Math.max(Math.abs(Z.max_x),Math.abs(Z.min_x)),z=Math.max(Math.abs(Z.max_y),Math.abs(Z.min_y)),v=Math.max(Math.abs(Z.max_z),Math.abs(Z.min_z)),k=Math.sqrt(h*h+z*z+v*v),r=Math.sqrt(h*
h+z*z),Z.max_x=Z.max_y=Z.max_z=k,Z.min_x=Z.min_y=Z.min_z=-k,g=new Float32Array([0,0,0]),t=new Float32Array([k,k,k]),D=new Float32Array([0,0,0]);else{for(n=0;n<c.length;n++)if(m=c[n],"MAIN"==m.type)for(m=m.N.gd,l=c[n].N.Tb,h=l.a_position.offset,l=l.a_position.length+h,u=h;u<l;u+=3){var h=m[u],z=m[u+1],v=m[u+2],G=Math.sqrt((g-h)*(g-h)+(pa-z)*(pa-z)+(ma-v)*(ma-v));if(G>k){var M=g-k*(h-g)/G,p=pa-k*(z-pa)/G,G=ma-k*(v-ma)/G;g=(M+h)/2;pa=(p+z)/2;ma=(G+v)/2;k=Math.sqrt((g-h)*(g-h)+(pa-z)*(pa-z)+(ma-v)*(ma-
v))}p=Math.sqrt((wa-h)*(wa-h)+(sb-v)*(sb-v));p>r&&(M=wa-r*(h-wa)/p,G=sb-r*(v-sb)/p,wa=(M+h)/2,sb=(G+v)/2,r=Math.sqrt((wa-h)*(wa-h)+(sb-v)*(sb-v)));h/=x?x:1;z/=D?D:1;v/=t?t:1;G=Math.sqrt((w[0]-h)*(w[0]-h)+(w[1]-z)*(w[1]-z)+(w[2]-v)*(w[2]-v));G>C&&(M=w[0]-C*(h-w[0])/G,p=w[1]-C*(z-w[1])/G,G=w[2]-C*(v-w[2])/G,w[0]=(M+h)/2,w[1]=(p+z)/2,w[2]=(G+v)/2,C=Math.sqrt((w[0]-h)*(w[0]-h)+(w[1]-z)*(w[1]-z)+(w[2]-v)*(w[2]-v)))}n=x?x*w[0]:d;e=D?D*w[1]:e;f=t?t*w[2]:f;x*=C;D*=C;t*=C;g=new Float32Array([g,pa,ma]);t=new Float32Array([x,
D,t]);D=new Float32Array([n,e,f]);r=parseFloat(r.toFixed(3))}b.Qb=Z;B.xE(b,r,r,Z);Z=y.Ll(k,g);b.nd=Z;Z=y.Kl([t[0],0,0],[0,t[1],0],[0,0,t[2]],D);b.kf=Z;H.o(a);if(Q.wireframe_debug)for(n=0;n<c.length;n++)if("WIREFRAME"===c[n].type&&c[n].Eg){a=E.Uo(1,Z.F);q.gv(a,[Z.Td[0],Z.Ud[1],Z.Vd[2]],Z.F);q.$m(a,1,!0);a.M.a_polyindex=q.Mo(a);B.zF(c[n],a);break}};a.Aa=n;a.PB=function(a,b){for(var c=aa.ALL||[],d=[],e=0;e<c.length;e++){var f=c[e];if((f.f.uc==b||-1==b)&&f.zl)for(var g=f.V,k=0;k<g.length;k++)g[k].na==
a&&d.push(f)}return d};a.get_all_objects=function(a){var b=aa.ALL;if(-1==a)return b;for(var c=[],d=0;d<b.length;d++){var e=b[d];e.f.uc==a&&c.push(e)}return c};a.QE=function(a){var b=n(a,"LAMP",-1);if(b.length==a.j.VI){for(var c=[],d=0;d<b.length;d++){var e=b[d],e=J.Oa(e,a);c[e.ni]=d}for(d=0;d<c.length-1;d++)for(e=d+1;e<c.length;e++){var f=b[c[d]].Fa,g=b[c[e]].Fa;if(g.ej&&g.yh&&(!f.ej||!f.yh)||!f.ej&&(g.ej||!f.yh&&g.yh))f=c[d],c[d]=c[e],c[e]=f}for(d=0;d<c.length;d++)e=b[c[d]],J.Oa(e,a).ni=d,K.hn(b[c[d]],
a)}};a.xF=function(a){for(var b=n(a,"LAMP",-1),c=n(a,"MESH",-1),d=0;d<c.length;d++)for(var e=J.Oa(c[d],a).S,f=0;f<e.length;f++){var g=e[f];"MAIN"==g.type&&(B.BF(g,b,a),B.Bb(g))}};a.QB=function(){for(var a=[],b=aa.MESH,c=0;c<b.length;c++){var d=b[c];d.f.Ve&&a.push(d)}return a};a.ic=function(b,c,d,e){var f=null,g=aa.ALL;switch(b){case a.xn:f=x(c,g,!0,d);break;case a.wn:a:{for(b=0;b<g.length;b++)if(f=g[b],f.gh==d&&(f.f.uc==e||-1==e)){var k=J.get_dg_parent(f);if(k&&k.gh==c)break a}f=null}break;case a.jd:a:{for(e=
0;e<g.length;e++){b=g[e];for(var f=c.length-1,k=b,r=!0;0<=f&&r;)r=k&&k.gh==c[f]&&(k.f.uc==d||-1==d),k&&(k=J.get_dg_parent(k)),f--;if(r&&!k){f=b;break a}}f=null}}return f};a.pick_object=function(b,c){var d=K.ei();if(!d)return G.error("No active scene"),null;var e=K.yD(d,b,c);if(!e)return null;for(var d=n(d,"MESH",-1),f=0;f<d.length;f++){var g=d[f].f,k=g.Fl;if(k&&3>Math.abs(255*k[0]-e[0])&&3>Math.abs(255*k[1]-e[1])&&3>Math.abs(255*k[2]-e[2]))return g.Ab&&g.Eu&&(ha.outlining_overview_mode?a.apply_outline_anim(d[f],
ha.Di,ha.Ei,ha.Fi):(e=g.Ci,a.apply_outline_anim(d[f],e.Di,e.Ei,e.Fi))),d[f]}return null};a.set_wind_params=function(a,c){for(var d=n(a,"EMPTY",-1),e=0;e<d.length;e++){var f=d[e];if(f.Xh&&"WIND"===f.Xh.type)var g=f}if(!g)return G.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(X.set(-Math.PI/2,c.wind_dir/180*Math.PI,0,da),ba.euler_to_quat(da,ja),H.set_rotation(g,ja),b(g));"number"==typeof c.wind_strength&&(g.Xh.Mv=c.wind_strength,b(g));K.$q(a)};a.remove_object=function(a){u.qz(a)&&
u.remove(a);var b=aa.ALL,c=aa[a.type],d=b.indexOf(a);a=c.indexOf(a);-1!=d&&b.splice(d,1);-1!=a&&c.splice(a,1)};a.rD=I;a.sD=function(a){return aa[a.type]&&-1<aa[a.type].indexOf(a)};a.set_nodemat_rgb=function(a,b,c,d,e){b=b.join("%join%");var f=k(a,b);null!=f?(a.f.Tc[3*f]=c,a.f.Tc[3*f+1]=d,a.f.Tc[3*f+2]=e):G.error('The RGB node "'+b+'" was not found in the object "'+a.name+'".')};a.set_nodemat_value=function(a,b,c){b=b.join("%join%");var d=g(a,b);null!=d?a.f.Oe[d]=c:G.error('The Value node "'+b+'" was not found in the object "'+
a.name+'".')}};b4w.module.__obj_util=function(a,p){function e(a){if(!(a instanceof Object))return a;var b=null,c=null,f=null;a.T&&(b=a.T,a.T=null);a.Vb&&(c=a.Vb,a.Vb=null);a.ba&&(f=a.ba,a.ba=null);var m;m=a.constructor;switch(m){case Float32Array:case Uint32Array:case Uint16Array:m=new m(a);break;case Array:m=new m(a.length);for(var l=0;l<a.length;l++)m[l]=e(a[l]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:m=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:m=null;break;case Function:m=
a;break;default:for(l in m=new m,a)m[l]=e(a[l])}b&&(m.T=b,a.T=b);c&&(m.Vb=c,a.Vb=c);f&&(m.ba=f,a.ba=f);return m}function b(a,b){for(var c=a.V,e=0;e<c.length;e++){var f=c[e];if(f.na==b)return f}return null}function c(a){return a.Kf?a.parent:a.parent?c(a.parent):null}var m=p("__mat4");p("__print");var f=p("__quat"),l=p("__tsr"),h=p("__util"),t=p("__vec4");new Float32Array(4);new Float32Array(4);new Float32Array(4);new Float32Array(8);new Float32Array(8);a.Sh=function(a){a={type:a,uc:0,aC:[0,0],i:new Float32Array(3),
quat:new Float32Array(4),Ba:new Float32Array(8),aa:new Float32Array(16),Qt:new Float32Array(16),ac:new Float32Array(3),kc:new Float32Array(3),ji:0,ki:0,pp:!1,Fl:null,If:0,Oq:!1,kw:!1,La:0,gr:1,fr:1,hr:1,dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,Ce:null,vF:!1,Be:0,Gg:0,rb:!1,jc:null,qc:null,Ob:null,Go:!0,R:null,Ci:{Di:1,Ei:1,Fi:0},od:null,Wc:null,mc:new Float32Array(4),$j:0,Uj:0,qk:0,Xg:0,Tl:!1,ad:!1,Ec:!1,Dc:!1,nc:!1,bc:!1,Cc:!1,fe:"",we:!1,hd:!1,Sl:!1,Zd:!1,Lb:!1,Uh:!1,ii:!1,rm:!1,Ve:!1,
Cm:!1,Ab:!1,Bm:!1,Eu:!1,om:!1,is_visible:!1,Qo:!1,$k:0,pe:0,cf:0,Ae:0,ze:0,ue:0,Ne:"",$b:null,vl:!1,Cd:!1,Pn:!1,tj:"",sj:!1,sd:0,time:0,er:0,ow:0,Pe:0,Zj:!1,Wb:!1,oe:!1,Tf:[],li:!1,rg:!1,jf:1,Fn:0,En:1,fn:new Int8Array([-1,-1]),Wm:[],nu:[],wv:[],Bc:null,Xc:null,Gc:null,ed:null,ld:null,Qh:null,$p:null,Hn:null,Gn:null,Oe:null,$g:null,um:null,Tc:null,Zg:null,vm:null,Oh:null,Qb:null,Mn:null,Kn:null,Ln:null,sb:null,nd:null,Rb:null,kf:null,ug:null,scale:1,Cf:1E4};f.identity(a.quat);l.identity(a.Ba);m.identity(a.aa);
m.identity(a.Qt);return a};a.Jj=function(a,b,c){c||(c=a);return{name:a,zh:h.To(),gh:c,type:b,zl:!1,sa:!1,mk:!1,jn:!1,f:null,Sa:null,w:null,Fa:null,ql:null,anchor:null,Xh:null,wm:null,V:[],Wb:[],Dd:[],lo:[],D:[],Fk:[],wd:[],Kh:[],Md:null,Rf:[],parent:null,Kf:!1,zk:"",fj:!1,Ia:"",Jl:"AUTO",xc:!1,is_character:!1,Sg:!1,m:null,l:null,rd:null,Hc:null,Yh:null,qs:null,Zp:[],Kd:{Hm:"NO_COLLISION",Xk:!1,mw:!1,ce:0,rw:0,qw:0,wo:0,nq:0,OC:!1,PC:!1,QC:!1,RC:!1,SC:!1,TC:!1,Dj:0,Bj:0,Ej:0,br:!1,El:"BOX",Wk:!1},
Du:{an:0,Up:0,Vc:0,iq:0},ml:0,actions:[],Np:!1}};a.mo=function(a){return a instanceof Array?a.slice():a};a.pf=e;a.sa=function(a){return a.sa};a.jk=function(a){return"MESH"==a.type&&a.sa};a.pl=function(a,b){a.V.push({na:b,mm:!1,S:[],Lf:null,qf:null,tv:[],ni:0,Bu:!1})};a.ol=function(a,c,e){b(a,c).S.push(e)};a.aJ=function(a,b){for(var c=a.V,e=0;e<c.length;e++)if(c[e].na==b){c.splice(e,1);break}};a.Oa=b;a.fw=function(a,b){for(var c=0;c<a.length;c++)t.copy(b,a[c].f.mc)};a.pq=function(a,b,c){for(var e=
0;e<a.V.length;e++){var f=a.V[e];c&&f.na!=c||(f.mm=b)}};a.Zo=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.Fa.mt)return c}return null};a.kt=function(a,b){return a+"*"+b};a.get_parent=function(a){return a.Kf?null:a.parent};a.get_dg_parent=c;a.Xo=function(a,b){for(var e=[],f=0;f<b.length;f++){var m=b[f];c(m)==a&&e.push(m)}return e};a.is_mesh=function(a){return"MESH"===a.type};a.is_armature=function(a){return"ARMATURE"===a.type};a.is_speaker=function(a){return"SPEAKER"===a.type};a.is_camera=
function(a){return"CAMERA"===a.type};a.is_lamp=function(a){return"LAMP"===a.type};a.is_empty=function(a){return"EMPTY"===a.type}};b4w.module.__particles=function(a,p){function e(){throw"_rand() undefined";}function b(a,b,c,e,f,m,h){var v=a.Rl,t=a.Gd,u=a.time;a=a.Pu;for(var q=b?4:1,D=0;D<v.length;D+=q){var w=v[D];if(u>a&&u>=w&&w>a||u<a&&(w>a||u>=w))for(w=0;8>w;w++)t[8*D+w]=f[w];for(w=0;8>w;w++)d[w]=t[8*D+w];w=g;w[0]=c[3*D];w[1]=c[3*D+1];w[2]=c[3*D+2];l.transform_vec3(w,d,w);m[3*D]=w[0];m[3*D+1]=w[1];m[3*D+2]=w[2];var p=g;p[0]=e[3*D];p[1]=e[3*D+1];p[2]=e[3*D+2];l.transform_dir_vec3(p,d,p);h[3*D]=p[0];h[3*D+1]=p[1];h[3*D+2]=p[2];
if(b)for(w=1;4>w;w++)m[3*(D+w)]=m[3*D],m[3*(D+w)+1]=m[3*D+1],m[3*(D+w)+2]=m[3*D+2],h[3*(D+w)]=p[0],h[3*(D+w)+1]=p[1],h[3*(D+w)+2]=p[2]}}function c(a){a?(h.$E(a),e=function(){return h.PD()}):e=function(){return Math.random()}}p("__config");var m=p("__geometry");p("__scenes");var f=p("__time"),l=p("__tsr"),h=p("__util"),t=p("__vec3"),d=new Float32Array(8),g=new Float32Array(3);a.Ai=function(a){a=a.V;for(var b=0;b<a.length;b++)for(var c=a[b].S,d=0;d<c.length;d++)if(c[d].va)return!0;return!1};a.Tp=function(a){a=
a.V;for(var b=0;b<a.length;b++)for(var c=a[b].S,d=0;d<c.length;d++){var e=c[d].va;if(e&&"EMITTER"==e.Vp)return!0}return!1};a.$y=function(a){return 0<a.particle_systems.length};a.Zy=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;return!1};a.dC=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.hC=function(a,b,c){var d=a.va={name:b.name,
Vp:b.settings.type,time:0,Pu:-1,dr:!1,I:0,Z:0,Wv:0,xp:0,gu:0,cyclic:!1,ce:0,Op:0,Ft:0,Jg:0,Pc:0,Fw:0,size:0,Or:0,Nr:0,vv:0,As:0,uv:new Float32Array(8),zs:new Float32Array(16),Hi:null,Mu:null,wu:null,xu:null,Rl:null,Ao:null,Gd:null};d.I=b.settings.frame_start;d.Z=b.settings.frame_end;d.Wv=(d.Z-d.I)/f.Nb();d.xp=b.settings.lifetime;d.gu=d.xp/f.Nb();d.cyclic=b.settings.b4w_cyclic?1:0;d.ce=b.settings.mass;d.Op=b.settings.normal_factor;d.Ft=9.81*b.settings.effector_weights.gravity;d.Jg=b.settings.b4w_fade_in/
f.Nb();d.Pc=b.settings.b4w_fade_out/f.Nb();d.Fw=b.settings.effector_weights.wind;d.dr="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var e,g;a.Pg?(a=c.halo.size,e=c.halo.hardness,30>e?(e=.5,g=.9):40>e?(e=.1,g=1):50>e?(e=0,g=.8):(e=0,g=.5)):(a=b.settings.particle_size,g=e=1);d.size=a;d.Or=e;d.Nr=g;a=b.settings.texture_slots;b=[-1,0,-1,0,-1,0,-1,0];if(a[0]&&a[0].use_map_size&&a[0].texture&&"BLEND"==a[0].texture.type&&a[0].texture.use_color_ramp){a=a[0].texture.color_ramp.elements;e=Math.min(2*a.length,
b.length);for(g=0;g<e;g+=2){var m=a[g/2];b[g]=m.position;b[g+1]=(m.color[0]+m.color[1]+m.color[2])/3}d.vv=a.length}d.uv.set(b);b=c.texture_slots;c=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(b[0]&&"STRAND"==b[0].texture_coords&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp){a=b[0].texture.color_ramp.elements;e=Math.min(4*a.length,c.length);for(g=0;g<e;g+=4)m=a[g/4],c[g]=m.position,c[g+1]=m.color[0],c[g+2]=m.color[1],c[g+3]=m.color[2];d.As=a.length}d.zs.set(c)};a.mB=function(a,
d,g,l){var p=a.va,B=g.settings.count,y=g.settings.frame_start/f.Nb(),v=g.settings.frame_end/f.Nb(),F=g.settings.lifetime/f.Nb(),u=g.settings.lifetime_random,q=g.settings.emit_from,D=g.settings.factor_random,w=g.settings.angular_velocity_mode,J=g.settings.angular_velocity_factor,C=g.settings.b4w_randomize_emission,M=g.settings.b4w_cyclic,G=!a.Pg;c(g.seed);d=m.at(d,["a_position","a_normal"],null);switch(q){case "VERT":g=d.A[0].a_position;d=d.A[0].a_normal;for(var E=g.length/3,q=[],r=0;r<B;r++){var K=
Math.round((E-1)*e());q.push(K);G&&(q.push(K),q.push(K),q.push(K))}E=[];for(r=0;r<q.length;r++)E.push(g[3*q[r]]),E.push(g[3*q[r]+1]),E.push(g[3*q[r]+2]);g=new Float32Array(E);E=[];for(r=0;r<q.length;r++)E.push(d[3*q[r]]),E.push(d[3*q[r]+1]),E.push(d[3*q[r]+2]);q=new Float32Array(E);break;case "FACE":g=[];q=[];r=[];h.km(0,r);E=m.Vo(d,B,!1,r);h.km(0,r);d=m.Vo(d,B,!0,r);for(r=0;r<E.length;r++)g.push(E[r][0],E[r][1],E[r][2]),G&&(g.push(E[r][0],E[r][1],E[r][2]),g.push(E[r][0],E[r][1],E[r][2]),g.push(E[r][0],
E[r][1],E[r][2])),q.push(d[r][0],d[r][1],d[r][2]),G&&(q.push(d[r][0],d[r][1],d[r][2]),q.push(d[r][0],d[r][1],d[r][2]),q.push(d[r][0],d[r][1],d[r][2]));g=new Float32Array(g);q=new Float32Array(q);break;case "VOLUME":throw"Particle emission from volume is not supported";default:throw"Wrong emit from option";}q=[g,q];d=q[0];q=q[1];p.Hi=new Float32Array(d);p.wu=new Float32Array(q);p.Mu=new Float32Array(d.length);p.xu=new Float32Array(q.length);g=[];v=(v-y)/B;for(E=0;E<B;E++)r=C?v*E+10*v*(.5-e()):v*E,
M||(r+=y),g.push(r),G&&(g.push(r),g.push(r),g.push(r));y=new Float32Array(g);p.Rl=new Float32Array(y);p.Ao=new Float32Array(y);p.Gd=new Float32Array(8*y.length);for(C=0;C<8*y.length;C++)for(M=0;8>M;M++)p.Gd[8*C+M]=l[M];p.dr&&b(p,G,d,q,l,d,q);l=h.Eb("EMITTER_PARTICLES");p=h.Ed();p.a_position=d;p.a_normal=q;l.A[0]=p;if(G){a.De=m.el;a=[];for(p=0;p<B;p++)a.push(4*p,4*p+2,4*p+1,4*p,4*p+3,4*p+2);a=new Uint16Array(a);l.ra=a;a=l.M;p=[];for(C=0;C<B;C++)p.push(-.5,-.5,-.5,.5,.5,.5,.5,-.5);p=new Float32Array(p);
a.a_p_bb_vertex=p}else a.De=m.ur,l.ra=new Uint16Array(0);l.P=d.length/3;l.M.a_p_delay=y;a=l.M;p=[];u*=F;for(y=0;y<B;y++)C=u*e(),p.push(F-C),G&&(p.push(F-C),p.push(F-C),p.push(F-C));F=new Float32Array(p);a.a_p_lifetime=F;F=l.M;u=[];for(a=0;a<B;a++){p=[e()-.5,e()-.5,e()-.5];t.normalize(p,p);u.push(D*p[0]);u.push(D*p[1]);u.push(D*p[2]);switch(w){case "NONE":u.push(0);break;case "SPIN":case "VELOCITY":u.push(J);break;case "RAND":u.push(2*J*(e()-.5));break;default:throw"Undefined velocity factor";}if(G)for(p=
u.slice(-4),y=0;12>y;y++)u.push(p[y%4])}B=new Float32Array(u);F.a_p_vels=B;return l};a.MF=function(a,c){for(var d=0;d<c.length;d++){var e=c[d],f=c[d].va;if(f){var g=e.N;if(!f.dr)break;var l=f.Mu,h=f.xu;b(f,!e.Pg,f.Hi,f.wu,a.f.Ba,l,h);m.YC(g);m.gn(g,"a_position",3,l);m.gn(g,"a_normal",3,h)}}};a.BE=function(a,b,c){a=a.V;for(var d=0;d<a.length;d++)for(var e=a[d].S,f=0;f<e.length;f++){var g=e[f].va;g&&g.name==b&&(g.Pu=g.time,g.time=c)}};a.JD=function(a){for(var b=a.P,c=a.A[0].a_position,d=a.M.a_texcoord,
e=[],f=[],g=0;g<b;g++)f.push(c[3*g]),f.push(c[3*g+1]),e.push(c[3*g+2]);e=new Float32Array(e);f=new Float32Array(f);a.M.a_lf_dist=e;a.M.a_lf_bb_vertex=f;a.M.a_texcoord=d;return a};a.set_size=function(a,b,c){a=a.V;for(var d=0;d<a.length;d++)for(var e=a[d].S,f=0;f<e.length;f++){var g=e[f].va;g&&g.name==b&&(g.size=c)}};a.set_normal_factor=function(a,b,c){a=a.V;for(var d=0;d<a.length;d++)for(var e=a[d].S,f=0;f<e.length;f++){var g=e[f].va;g&&g.name==b&&(g.Op=c)}};a.set_factor=function(a,b,c){a=a.V;for(var d=
0;d<a.length;d++)for(var e=a[d].S,f=0;f<e.length;f++){var g=e[f],l=g.va;if(l&&l.name==b){var h=l.Rl;if(1==c)l=h;else if(0==c)for(var u=!g.Pg,q=u?4:1,l=l.Ao,D=0;D<l.length;D+=q)l[D]=1E4,u&&(l[D+1]=l[D],l[D+2]=l[D],l[D+3]=l[D]);else for(var t=1/c,l=l.Ao,q=(u=!g.Pg)?4:1,p=0,D=0;D<l.length;D+=q)D>=p?(l[D]=h[D],p+=t):l[D]=1E4,u&&(l[D+1]=l[D],l[D+2]=l[D],l[D+3]=l[D]);m.gn(g.N,"a_p_delay",1,l)}}};a.YF=function(a,b,c){a=a.V;for(var d=0;d<a.length;d++)for(var e=a[d].S,f=0;f<e.length;f++){var g=e[f].va;if(g)for(var m=
0;m<8*g.Rl.length;m++)g.Gd[8*m]=b[0],g.Gd[8*m+1]=b[1],g.Gd[8*m+2]=b[2],g.Gd[8*m+3]=b[3],g.Gd[8*m+4]=c[0],g.Gd[8*m+5]=c[1],g.Gd[8*m+6]=c[2],g.Gd[8*m+7]=c[3]}}};b4w.module.__primitives=function(a,p){function e(a,b,c,e){for(var f=[],m=[],l=[],t=[],p=2*c/(a-1),v=2*e/(b-1),F=0;F<a;F++)for(var u=-c+F*p,q=0;q<b;q++)if(m.push(u,0,-e+q*v),l.push(0,1,0),t.push(F/(a-1),q/(b-1)),F&&q){var D=F*b+q,w=D-1,J=(F-1)*b+q,C=J-1;f.push(D,w,J);f.push(w,C,J)}a=h.Ed();a.a_position=new Float32Array(m);a.a_normal=new Float32Array(l);l=h.Eb("GRID_PLANE");l.A[0]=a;l.M.a_texcoord=new Float32Array(t);l.ra=new Uint32Array(f);l.P=m.length/3;return l}function b(a){var b=a.length;if(b%
4)throw"Wrong array";for(var c=[],e=[],f=0;f<b;f+=4){var l=a[f+1],t=a[f+2],p=a[f+3];m(a[f],e);m(l,e);m(t,e);m(p,e);c.push(f,f+1,f+2);c.push(f,f+2,f+3)}a=h.Ed();a.a_position=new Float32Array(e);b=h.Eb("FROM_QUADS");b.A[0]=a;b.ra=new Uint32Array(c);b.P=e.length/3;return b}function c(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function m(a,b){b.push(a[0],a[1],a[2])}var f=p("__config"),l=p("__geometry");p("__print");var h=p("__util"),t=f.q;a.eI=function(a){for(var b=h.Eb("LINE"),c=[],e=0;e<2*a;e++)c.push(e);
e=h.Ed();e.a_point=new Float32Array(c);b.A[0]=e;b.ra=new Uint32Array(c);b.P=2*a;return b};a.fI=function(a,b){var c=e(2,2,a,b);c.name="PLANE";return c};a.dI=e;a.rB=function(a,b,c){function e(a,b){return 1==a%2&&(0==b||b==B-1)||1==b%2&&(0==a||a==p-1)?!0:!1}var f=c/=Math.pow(2,a-1),m=c,p=b+1,B=b+1;b=[];c=[];for(var y=0,v=0,F=-1,u=[],q=0;q<a;q++){for(var D=2*f/(p-1),w=2*m/(B-1),J=[],C=[],M=0,G=0;G<p;G++){for(var E=-f+G*D,r=[],K=0;K<B;K++){var z=-m+K*w;if(E>-y&&E<y&&z>-v&&z<v)r.push(-1),M++;else{for(var H=
null,V=0;V<u.length;V+=3)if(E==u[V]&&z==u[V+1]){H=u[V+2];break}V=null!==H?H:F+1;e(G,K)?(r.push(-2),M++):(null==H&&(0==K||K==B-1||0==G||G==p-1?(H=q==a-1?D:2*D,J.push(E,z,V)):H=D,c.push(E,H,z),F++),r.push(V));if(G&&K)if(1==G)if(e(G-1,K)){if(1<K){var z=V-1,H=C[G-1][K+1],ba=H-1;b.push(V,z,ba)}else H=C[G-1][K+1],ba=H-1;b.push(V,ba,H)}else e(G,K)||(z=V-1,H=C[G-1][K],b.push(V,z,H));else if(G==p-1){if(!e(G,K))if(K==B-1)z=V-1,H=C[G-1][K-1],ba=C[G-2][K],b.push(V,z,H),b.push(V,H,ba);else{var z=V-1,H=C[G-1][K],
ba=H-1,X=H+1;b.push(V,z,ba);b.push(V,ba,H);b.push(V,H,X);2==K&&(X=C[G-2][K-2],b.push(z,X,ba))}}else 1==K?e(G,K-1)?(z=C[G-1][K],H=C[G-1][K-1],b.push(V,H,z)):(z=r[K-1],H=C[G-1][K],ba=C[G-2][K-1],b.push(V,z,H),b.push(z,ba,H)):K==B-1?e(G,K)||(z=r[K-1],H=C[G-1][K-1],ba=C[G-2][K],b.push(V,z,H),b.push(V,H,ba)):-1!=C[G-1][K]&&-1!=C[G-1][K-1]&&-1!=r[K-1]?(z=r[K-1],H=C[G-1][K],ba=C[G-1][K-1],b.push(V,z,H),b.push(z,ba,H),K==B-2&&e(G,K+1)&&(X=C[G-1][K+1],b.push(V,H,X))):K==B-2&&e(G,K+1)&&(H=C[G-1][K],X=C[G-1][K+
1],b.push(V,H,X))}}C.push(r)}u=J;y=f;v=m;f*=2;m*=2}2E4>y&&(a=-(2*y)/(p-1),c.push(-2E4,a,-2E4),c.push(-2E4,a,2E4),c.push(-y,a,-v),c.push(-y,a,v),c.push(2E4,a,-2E4),c.push(2E4,a,2E4),c.push(y,a,-v),c.push(y,a,v),V=F+1,b.push(V+3,V+2,V+1,V+2,V+0,V+1,V+6,V+4,V+2,V+4,V+0,V+2,V+5,V+7,V+1,V+7,V+3,V+1,V+5,V+4,V+7,V+7,V+4,V+6));a=h.Ed();a.a_position=new Float32Array(c);f=h.Eb("multigrid_plane");f.A[0]=a;f.ra=new Uint32Array(b);f.P=c.length/3;t.Ew&&(l.$m(f,1,!0),a.a_polyindex=l.Mo(f));return f};a.cI=function(a){var b=
a.length;if(b%3)throw"Wrong array";for(var c=[],e=[],f=0;f<b;f+=3){var l=a[f+1],t=a[f+2];m(a[f],e);m(l,e);m(t,e);c.push(f,f+1,f+2)}a=h.Ed();a.a_position=new Float32Array(e);b=h.Eb("FROM_TRIANGLES");b.A[0]=a;b.ra=new Uint32Array(c);b.P=e.length/3;return b};a.bI=b;a.nB=function(a){a=h.sG(a);var c=[];c.push(a[0],a[1],a[2],a[3]);c.push(a[0],a[3],a[5],a[4]);c.push(a[3],a[2],a[6],a[5]);c.push(a[1],a[7],a[6],a[2]);c.push(a[0],a[4],a[7],a[1]);c.push(a[4],a[5],a[6],a[7]);a=b(c);a.name="FRUSTUM";return a};
a.Fb=function(){var a=h.Eb("FULLSCREEN_TRI"),b=h.Ed();b.a_position=new Float32Array([0,0,1,0,0,1]);a.A[0]=b;a.ra=new Uint32Array([0,1,2]);a.P=3;return a};a.oB=function(){var a=h.Eb("FULLSCREEN_QUAD"),b=h.Ed();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.A[0]=b;a.ra=new Uint32Array([0,2,1,1,2,3]);a.P=4;return a};a.jB=function(){var a=h.Eb("BILLBOARD"),b=h.Ed();b.a_bb_vertex=new Float32Array([-.5,-.5,-.5,.5,.5,.5,.5,-.5]);a.A[0]=b;a.ra=new Uint32Array([0,2,1,0,3,2]);a.P=4;return a};a.kB=function(){var a=
h.Eb("CUBEMAP_BOARD"),b=h.Ed();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.A[0]=b;a.ra=new Uint32Array([0,2,1,0,3,2]);a.P=4;return a};a.Uo=function(a,b){var e=h.Eb("UV_SPHERE"),f,t,p=[],A=[],B=[];for(t=0;8>=t;t++)for(f=0;16>=f;f++){var y=f/16,v=t/8;A.push(-a*Math.cos(2*y*Math.PI)*Math.sin(v*Math.PI)+b[0],a*Math.cos(v*Math.PI)+b[1],a*Math.sin(2*y*Math.PI)*Math.sin(v*Math.PI)+b[2])}for(t=y=0;8>t;t++)for(f=0;16>f;f++){var v=c(A,17*t+f+1),F=c(A,17*t+f),u=c(A,17*(t+1)+f),q=c(A,17*(t+1)+f+1);
Math.abs(v[1])==a+b[1]?(m(v,p),m(u,p),m(q,p),B.push(y,y+1,y+2),y+=3):Math.abs(u[1])==a+b[1]?(m(v,p),m(F,p),m(u,p),B.push(y,y+1,y+2),y+=3):(m(v,p),m(F,p),m(u,p),m(q,p),B.push(y,y+1,y+2),B.push(y,y+2,y+3),y+=4)}f={};f.a_position=p;A=l.js(B,A,p);f.a_normal=l.hs(B,p,A);f.a_tangent=[];e.M.a_influence=[];e.M.a_color=[];e.M.a_texcoord=[];e.A[0]=f;e.ra=B;e.P=p.length/3;return e};a.lt=function(a){var b=h.Eb("INDEX"),c=h.Ed();c.a_index=new Float32Array(a);for(var e=0;e<a;e++)c.a_index[e]=e;b.A[0]=c;b.ra=new Uint16Array(0);
b.P=a;return b}};b4w.module.__prerender=function(a,p){function e(a,b){var d=a.Jd,e=b.k;d.is_visible=!1;var f;if(!(f=!d||d.ii)){var m=e.vf,h=d.Rb.F;f=d.Cf;m=Math.sqrt((h[0]-m[0])*(h[0]-m[0])+(h[1]-m[1])*(h[1]-m[1])+(h[2]-m[2])*(h[2]-m[2]));h=d.Xg*d.Rb.Ua;f=!(m>=d.qk&&m<f+h)}if(f)return!1;d.is_visible=!0;(f="OUTLINE_MASK"==b.type&&!Boolean(d.If))||(e=e.ak,d.Uh?f=!1:("STATIC"===d.type?(f=d.Rb,d=f.F,d=l.VE(d,e,f.Ua)):(f=d.ug,d=f.F,d=l.MA(d,e,f.Td,f.Ud,f.Vd)),f=d));return f?!1:"WIREFRAME"==b.type?a.B.wireframe_mode==c.WM_DEBUG_SPHERES?
a.B.Eg:!a.B.Eg:!0}var b=p("__config"),c=p("__debug"),m=p("__geometry"),f=p("__renderer"),l=p("__util"),h=p("__vec3"),t=b.q,d="MAIN_OPAQUE MAIN_BLEND MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_GLOW SHADOW_CAST DEPTH OUTLINE_MASK WIREFRAME COLOR_PICKING MAIN_XRAY COLOR_PICKING_XRAY".split(" ");a.aq=function(a){if(-1<d.indexOf(a.type)){for(var b=!1,c=a.p,l=0;l<c.length;l++){var p=c[l];if("MAIN_CUBE_REFLECT"==a.type)for(var A=0;6>A;A++)a.k.ak=a.ro[A],p.Do[A]=e(p,a),p.Do[A]&&(b=!0);else p.tb=e(p,a),p.tb&&
(b=!0)}switch(a.type){case "WIREFRAME":break;default:"MAIN_OPAQUE"===a.type||"DEPTH"===a.type||"MAIN_GLOW"===a.type||b?a.tb=!0:(a.tb&&f.clear(a),a.tb=!1)}}if("MAIN_BLEND"==a.type&&t.alpha_sort&&a.p){b=a.k.vf;c=h.dist(b,a.Iw)>t.alpha_sort_threshold;for(l=0;l<a.p.length;l++)if(A=a.p[l],p=A.Jd,p.Qo||c){var B=A.B;if(B&&B.Ra&&B.ff!=m.re){B=B.N;if(!B||!A.tb)continue;(A=B.jm)&&A.type==m.Er&&m.GF(B,p.aa,b)}p.Qo=!1}c&&h.copy(b,a.Iw)}}};b4w.module.__print=function(a){function p(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var e=1;e<a.length;e++)c.push(a[e]);return c}var e=!1,b=0,c=0;a.CE=function(a){e=a};a.Dp=function(){console.log.apply(console,arguments)};a.log=function(){if(e){var a=p(arguments,"B4W LOG");console.log.apply(console,a)}};a.error=function(){b++;var a=p(arguments,"B4W ERROR");console.error.apply(console,a)};a.warn=function(){c++;var a=p(arguments,"B4W WARN");console.warn.apply(console,
a)};a.info=function(){var a=p(arguments,"B4W INFO");console.info.apply(console,a)};a.QA=function(){b++;var a=p(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.RA=function(){c++;var a=p(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){e&&console.time.apply(console,arguments)};a.timeEnd=function(){e&&console.timeEnd.apply(console,arguments)};a.group=function(){e&&console.group.apply(console,arguments)};a.groupCollapsed=function(){e&&console.groupCollapsed.apply(console,
arguments)};a.groupEnd=function(){e&&console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)};a.YB=function(){return c};a.HB=function(){return b};a.clear_errors_warnings=function(){b=c=0}};b4w.module.print=b4w.module.__print;b4w.module.__reformer=function(a,p){function e(a){switch(a.type){case "MAPPING":a.vector_type||(a.vector_type="POINT",c("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,c("node material",a,"alpha"));"darkness"in a||(a.darkness=1,c("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,c("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,c("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in
a||(a.diffuse_intensity=1,c("node material",a,"diffuse_intensity"));"specular_shader"in a||(a.specular_shader="COOKTORR",c("node material",a,"specular_shader"));"specular_ior"in a||(a.specular_ior=4,c("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,c("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,c("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,c("node material",a,"specular_toon_size"));
"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,c("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,c("node material",a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",c("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,c("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,c("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,c("node material",
a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,c("node "+a.type,a,"use_clamp"));break;case "GROUP":switch(a.node_tree_name=a.node_tree_name.replace(/\.[0-9]{3,}$/g,""),a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}}}
function b(a){if(a=a.nla_tracks)for(var b=0;b<a.length;b++)for(var d=a[b],e=0;e<d.strips.length;e++){var f=d.strips[e];"action"in f||(f.action=null,c("strip",f,"action"));"action_frame_start"in f||(f.action_frame_start=0,c("strip",f,"action_frame_start"));"action_frame_end"in f||(f.action_frame_end=f.frame_end-f.frame_start,c("strip",f,"action_frame_end"));"repeat"in f||(f.repeat=1,c("strip",f,"repeat"));"use_reverse"in f||(f.use_reverse=!1,c("strip",f,"use_reverse"));"scale"in f||(f.scale=1,c("strip",
f,"scale"))}}function c(a,b,c){c=c+">>"+a;c in A||(A[c]={Gq:[],bv:"undefined",type:a});A[c].Gq.push(b.name)}function m(a,b,c){c=c+">>"+a;c in A||(A[c]={Gq:[],bv:"deprecated",type:a});A[c].Gq.push(b.name)}function f(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var e=k.zg(a);a.materials=c;a.submeshes=d;e.name=b;e.materials=a.materials.slice(0);e.submeshes=[];for(c=0;c<d.length;c++){var f=k.Aj(d[c]);e.submeshes.push(f)}return e}var l=p("__boundings"),h=
p("__curve"),t=p("__mat4"),d=p("__print"),g=p("__quat"),k=p("__util"),n=p("__vec3"),x=p("__vec4"),I=[5,4],A={};a.ts=function(a){return-1!=k.sw(a,I)};a.oz=function(a){A={};var f=a.worlds;if(0==f.length){d.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var g={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,
intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};f.push(g)}for(var f=a.worlds,l=0;l<f.length;l++){g=f[l];"use_sky_blend"in g||(c("world",g,"use_sky_blend"),g.use_sky_blend=!1);"use_sky_paper"in g||(c("world",g,"use_sky_paper"),g.use_sky_paper=!1);"use_sky_real"in g||(c("world",g,"use_sky_real"),g.use_sky_real=!1);"b4w_sky_settings"in g&&"rayleigh_brightness"in g.b4w_sky_settings||
(c("world",g,"rayleigh_brightness"),g.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in g||(c("world",g,"fog_settings"),g.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},
"b4w_fog_color"in g&&(g.fog_settings.use_custom_color=!0,g.fog_settings.color=g.b4w_fog_color),"b4w_fog_density"in g&&0<g.b4w_fog_density&&(g.fog_settings.depth=1/g.b4w_fog_density));"render_sky"in g.b4w_sky_settings||(c("world",g,"render_sky"),g.b4w_sky_settings.render_sky=!1);for(var h=g.texture_slots,g=0;g<h.length;g++){var q=h[g];"blend_type"in q||(q.blend_type="MIX",c("world_texture_slot",q,"blend_type"));"use_map_blend"in q||(q.use_map_blend=!1,c("world_texture_slot",q,"use_map_blend"));"use_map_horizon"in
q||(q.use_map_horizon=!0,c("world_texture_slot",q,"use_map_horizon"));"use_map_zenith_up"in q||(q.use_map_zenith_up=!1,c("world_texture_slot",q,"use_map_zenith_up"));"use_rgb_to_intensity"in q||(q.use_rgb_to_intensity=!1,c("world_texture_slot",q,"use_rgb_to_intensity"));"invert"in q||(q.invert=!1,c("world_texture_slot",q,"invert"));"color"in q||(q.color=[1,0,1],c("world_texture_slot",q,"color"));"blend_factor"in q||(q.blend_factor=0,c("world_texture_slot",q,"blend_factor"));"horizon_factor"in q||
(q.horizon_factor=1,c("world_texture_slot",q,"horizon_factor"));"zenith_up_factor"in q||(q.zenith_up_factor=0,c("world_texture_slot",q,"zenith_up_factor"));"zenith_down_factor"in q||(q.zenith_down_factor=0,c("world_texture_slot",q,"zenith_down_factor"));"default_value"in q||(q.default_value=1,c("world_texture_slot",q,"default_value"))}}g=a.scenes;for(l=0;l<g.length;l++)h=g[l],q=h.world,"timeline_markers"in h||(h.timeline_markers=null,c("scene",h,"timeline_markers")),"b4w_reflection_quality"in h||
(h.b4w_reflection_quality="MEDIUM",c("scene",h,"b4w_reflection_quality")),"b4w_use_nla"in h||(h.b4w_use_nla=!1,c("scene",h,"b4w_use_nla")),"fps"in h||(h.fps=24,c("scene",h,"fps")),"b4w_nla_cyclic"in h||(h.b4w_nla_cyclic=!1,c("scene",h,"b4w_nla_cyclic")),"b4w_logic_nodes"in h||(h.b4w_logic_nodes=[],c("scene",h,"b4w_logic_nodes")),"b4w_detect_collisions"in h&&(m("scene",h,"b4w_detect_collisions"),delete h.b4w_detect_collisions),"audio_doppler_speed"in h||(h.audio_doppler_speed=343.3),"audio_doppler_factor"in
h||(h.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in h||(h.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},c("scene",h,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in h||(h.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in h||(h.b4w_enable_bloom=!1,c("scene",h,"b4w_enable_bloom")),"b4w_enable_motion_blur"in h||(h.b4w_enable_motion_blur=!1,c("scene",h,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in h||(h.b4w_enable_color_correction=
!1,c("scene",h,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in h||(h.b4w_antialiasing_quality="MEDIUM",c("scene",h,"b4w_antialiasing_quality")),"b4w_tags"in h||(h.b4w_tags={title:"",description:""},c("scene",h,"b4w_tags")),"b4w_enable_object_selection"in h||(h.b4w_enable_object_selection="AUTO",c("scene",h,"b4w_enable_object_selection")),"b4w_enable_outlining"in h||(h.b4w_enable_outlining="AUTO",c("scene",h,"b4w_enable_outlining")),"b4w_enable_glow_materials"in h||(h.b4w_enable_glow_materials=
"AUTO",c("scene",h,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in h||(h.b4w_enable_anchors_visibility="AUTO",c("scene",h,"b4w_enable_anchors_visibility")),"b4w_outline_color"in h||(h.b4w_outline_color=[1,1,1],c("scene",h,"b4w_outline_color")),"b4w_outline_factor"in h||(h.b4w_outline_factor="b4w_glow_factor"in h?h.b4w_glow_factor:1,c("scene",h,"b4w_outline_factor")),"b4w_shadow_settings"in h||(c("scene",h,"b4w_shadow_settings"),f=q.b4w_shadow_settings,h.b4w_shadow_settings=f?f:{csm_resolution:2048,
self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),f=h.b4w_shadow_settings,"csm_resolution"in f||(c("scene",h,"b4w_shadow_settings.csm_resolution"),f.csm_resolution=2048),"self_shadow_polygon_offset"in f||(c("scene",h,"b4w_shadow_settings.self_shadow_polygon_offset"),f.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in f||
(c("scene",h,"b4w_shadow_settings.self_shadow_normal_offset"),f.self_shadow_normal_offset=.01),"b4w_enable_csm"in f||(c("scene",h,"b4w_shadow_settings.b4w_enable_csm"),f.b4w_enable_csm=!1),"csm_num"in f||(c("scene",h,"b4w_shadow_settings.csm_num"),f.csm_num=1),"csm_first_cascade_border"in f||(c("scene",h,"b4w_shadow_settings.csm_first_cascade_border"),f.csm_first_cascade_border=10),"first_cascade_blur_radius"in f||(c("scene",h,"b4w_shadow_settings.first_cascade_blur_radius"),f.first_cascade_blur_radius=
3),"csm_last_cascade_border"in f||(c("scene",h,"b4w_shadow_settings.csm_last_cascade_border"),f.csm_last_cascade_border=100),"last_cascade_blur_radius"in f||(c("scene",h,"b4w_shadow_settings.last_cascade_blur_radius"),f.last_cascade_blur_radius=1.5),"fade_last_cascade"in f||(c("scene",h,"b4w_shadow_settings.fade_last_cascade"),f.fade_last_cascade=!0),"blend_between_cascades"in f||(c("scene",h,"b4w_shadow_settings.blend_between_cascades"),f.blend_between_cascades=!0),"b4w_ssao_settings"in h||(c("scene",
h,"b4w_ssao_settings"),f=q.b4w_ssao_settings,h.b4w_ssao_settings=f?f:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),f=h.b4w_ssao_settings,"dist_factor"in f||(c("scene",h,"b4w_ssao_settings.dist_factor"),f.dist_factor=0),"samples"in f||(c("scene",h,"b4w_ssao_settings.samples"),f.samples=16),"hemisphere"in f||(c("scene",h,"b4w_ssao_settings.hemisphere"),f.hemisphere=!1),"blur_depth"in f||(c("scene",h,"b4w_ssao_settings.blur_depth"),f.blur_depth=!1),"blur_discard_value"in
f||(c("scene",h,"b4w_ssao_settings.blur_discard_value"),f.blur_discard_value=1),"b4w_bloom_settings"in h||(c("scene",h,"b4w_bloom_settings"),f=q.b4w_bloom_settings,h.b4w_bloom_settings=f?f:{key:.2,blur:4,edge_lum:1}),"key"in h.b4w_bloom_settings||(c("scene",h,"b4w_bloom_settings.key"),h.b4w_bloom_settings.key=.2),"blur"in h.b4w_bloom_settings||(c("scene",h,"b4w_bloom_settings.blur"),h.b4w_bloom_settings.blur=4),"edge_lum"in h.b4w_bloom_settings||(c("scene",h,"b4w_bloom_settings.edge_lum"),h.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in h||(c("scene",h,"b4w_motion_blur_settings"),f=q.b4w_motion_blur_settings,h.b4w_motion_blur_settings=f?f:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in h.b4w_motion_blur_settings||(c("scene",h,"b4w_motion_blur_settings.motion_blur_factor"),h.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in h.b4w_motion_blur_settings||(c("scene",h,"b4w_motion_blur_settings.motion_blur_decay_threshold"),h.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in h||(c("scene",h,"b4w_color_correction_settings"),f=q.b4w_color_correction_settings,h.b4w_color_correction_settings=f?f:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in h||(c("scene",h,"b4w_god_rays_settings"),f=q.b4w_god_rays_settings,h.b4w_god_rays_settings=f?f:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in h.b4w_god_rays_settings||(c("scene",h,"b4w_god_rays_settings.steps_per_pass"),h.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in h||(c("scene",h,"b4w_glow_settings"),h.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},f=h.b4w_glow_settings,"b4w_render_glow_over_blend"in q&&(f.render_glow_over_blend=q.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in q&&(f.small_glow_mask_coeff=q.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in q&&(f.large_glow_mask_coeff=q.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
q&&(f.small_glow_mask_width=q.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in q&&(f.large_glow_mask_width=q.b4w_large_glow_mask_width)),q=h.b4w_render_shadows,"AUTO"!=q&&"OFF"!=q&&"ON"!=q&&(h.b4w_render_shadows=q?"ON":"OFF"),q=h.b4w_render_reflections,"OFF"!=q&&"ON"!=q&&(h.b4w_render_reflections=q?"ON":"OFF"),q=h.b4w_render_refractions,"AUTO"!=q&&"OFF"!=q&&"ON"!=q&&(h.b4w_render_refractions=q?"ON":"OFF"),h.b4w_nla_script&&m("scene",h,"b4w_nla_script");h=a.meshes;for(l=0;l<h.length;l++){q=
h[l];q.b4w_bounding_box||(c("mesh",q,"b4w_bounding_box"),q.b4w_bounding_box={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0});q.b4w_bounding_box_source||(c("mesh",q,"b4w_bounding_box_source"),q.b4w_bounding_box_source=q.b4w_bounding_box);q.uv_textures||(c("mesh",q,"uv_textures"),q.uv_textures=[]);q.b4w_bounding_sphere_center||(q.b4w_bounding_sphere_center=[0,0,0]);q.b4w_bounding_cylinder_center||(q.b4w_bounding_cylinder_center=[0,0,0]);q.b4w_bounding_ellipsoid_center||(q.b4w_bounding_ellipsoid_center=
[0,0,0]);q.b4w_bounding_ellipsoid_axes||(g=q.b4w_bounding_box,q.b4w_bounding_ellipsoid_axes=[(g.max_x-g.min_x)/2,(g.max_y-g.min_y)/2,(g.max_z-g.min_z)/2]);"b4w_shape_keys"in q||(q.b4w_shape_keys=[],c("mesh",q,"b4w_shape_keys"));for(var g=q,f=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],n=null,t=0;t<f.length;t++)g[f[t]]&&(n?(g[f[t]]=!1,d.warn('WARNING property "'+f[t]+'" of object "'+g.name+'" has been set to "false". Foreground property "'+
n+'" already exists.')):n=f[t]);for(g=0;g<q.b4w_vertex_anim.length;g++)f=q.b4w_vertex_anim[g],"allow_nla"in f||(c('mesh["b4w_vertex_anim"]',q,"allow_nla"),f.allow_nla=!0)}g=a.cameras;for(l=0;l<g.length;l++)h=g[l],h.type||(h.type="PERSP",c("camera",h,"type")),"b4w_eye_target_dist"in h&&(delete h.b4w_eye_target_dist,m("camera",h,"b4w_eye_target_dist")),"b4w_hover_zero_level"in h||(h.b4w_hover_zero_level=0,c("camera",h,"b4w_hover_zero_level")),"b4w_trans_velocity"in h||(h.b4w_trans_velocity=1,c("camera",
h,"b4w_trans_velocity")),"b4w_rot_velocity"in h||(h.b4w_rot_velocity=1,c("camera",h,"b4w_rot_velocity")),"b4w_zoom_velocity"in h||(h.b4w_zoom_velocity=.1,c("camera",h,"b4w_zoom_velocity")),"b4w_use_distance_limits"in h||(h.b4w_use_distance_limits=!1,c("camera",h,"b4w_use_distance_limits")),"b4w_distance_min"in h||(h.b4w_distance_min=1,c("camera",h,"b4w_distance_min")),"b4w_distance_max"in h||(h.b4w_distance_max=100,c("camera",h,"b4w_distance_max")),"b4w_horizontal_translation_min"in h||(h.b4w_horizontal_translation_min=
-100,c("camera",h,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in h||(h.b4w_horizontal_translation_max=100,c("camera",h,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in h||(h.b4w_vertical_translation_min=-100,c("camera",h,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in h||(h.b4w_vertical_translation_max=100,c("camera",h,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in h||(h.b4w_use_horizontal_clamping=!1,c("camera",h,"b4w_use_horizontal_clamping")),
"b4w_rotation_left_limit"in h||(h.b4w_rotation_left_limit=-Math.PI,c("camera",h,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in h||(h.b4w_rotation_right_limit=Math.PI,c("camera",h,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in h||(h.b4w_horizontal_clamping_type="LOCAL",c("camera",h,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in h||(h.b4w_use_vertical_clamping=!1,c("camera",h,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in h||(h.b4w_rotation_down_limit=
-Math.PI/2,c("camera",h,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in h||(h.b4w_rotation_up_limit=Math.PI/2,c("camera",h,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in h||(h.b4w_vertical_clamping_type="LOCAL",c("camera",h,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in h||(h.b4w_hover_angle_min=Math.PI/6,c("camera",h,"b4w_hover_angle_min")),"b4w_hover_angle_max"in h||(h.b4w_hover_angle_max=Math.PI/6,c("camera",h,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in h||
(h.b4w_enable_hover_hor_rotation=!0,c("camera",h,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in h||(h.b4w_use_panning=!0,c("camera",h,"b4w_use_panning"));g=a.lamps;for(l=0;l<g.length;l++)h=g[l],"b4w_generate_shadows"in h||(h.b4w_generate_shadows=!1,c("lamp",h,"b4w_generate_shadows")),"b4w_dynamic_intensity"in h||(h.b4w_dynamic_intensity=!1,c("lamp",h,"b4w_dynamic_intensity")),"use_diffuse"in h||(h.use_diffuse=!0,c("lamp",h,"use_diffuse")),"use_specular"in h||(h.use_specular=!0,c("lamp",h,"use_specular"));
g=a.speakers;for(l=0;l<g.length;l++)h=g[l],"b4w_behavior"in h||(h.b4w_behavior=h.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_disable_doppler"in h||(h.b4w_disable_doppler=!1),"b4w_delay"in h||(h.b4w_delay=0),"b4w_delay_random"in h||(h.b4w_delay_random=0),"b4w_volume_random"in h||(h.b4w_volume_random=0),"b4w_pitch_random"in h||(h.b4w_pitch_random=0),"b4w_fade_in"in h||(h.b4w_fade_in=0),"b4w_fade_out"in h||(h.b4w_fade_out=0),"b4w_loop"in h||(h.b4w_loop=!1),"b4w_loop_count"in h||(h.b4w_loop_count=
0),"b4w_loop_count_random"in h||(h.b4w_loop_count_random=0),"b4w_playlist_id"in h||(h.b4w_playlist_id=""),h.animation_data&&b(h.animation_data);g=a.textures;for(l=0;l<g.length;l++)h=g[l],"b4w_anisotropic_filtering"in h||(h.b4w_anisotropic_filtering="OFF",c("texture",h,"b4w_anisotropic_filtering")),"b4w_water_foam"in h||(h.b4w_water_foam=!1,c("texture",h,"b4w_water_foam")),"b4w_foam_uv_freq"in h||(h.b4w_foam_uv_freq=[1,1],c("texture",h,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in h||(h.b4w_foam_uv_magnitude=
[1,1],c("texture",h,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in h||(h.b4w_parallax_steps=5,c("material",h,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in h||(h.b4w_parallax_lod_dist=10,c("material",h,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in h||(h.b4w_shore_dist_map=!1,c("texture",h,"b4w_shore_dist_map")),"b4w_shore_boundings"in h||(h.b4w_shore_boundings=new Float32Array(4),h.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],c("texture",h,"b4w_shore_boundings")),"b4w_max_shore_dist"in h||(h.b4w_max_shore_dist=
100,c("texture",h,"b4w_max_shore_dist")),"b4w_disable_compression"in h||(h.b4w_disable_compression=!1,c("texture",h,"b4w_disable_compression")),"b4w_source_type"in h||(h.b4w_source_type="",c("texture",h,"b4w_source_type")),"b4w_source_id"in h||(h.b4w_source_id="",c("texture",h,"b4w_source_id")),"b4w_source_size"in h||(h.b4w_source_size=1024,c("texture",h,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in h||(h.b4w_enable_canvas_mipmapping=!0,c("texture",h,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in
h||(h.b4w_nla_video=!1,c("texture",h,"b4w_nla_video"));f=a.materials;for(l=0;l<f.length;l++){n=f[l];"ALPHA_ANTIALIASING"==n.game_settings.alpha_blend&&(n.game_settings.alpha_blend="CLIP");"b4w_node_mat_type"in n&&m("material",n,"b4w_node_mat_type");"b4w_skydome"in n&&m("material",n,"b4w_skydome");"b4w_procedural_skydome"in n&&m("material",n,"b4w_procedural_skydome");n.b4w_water&&("b4w_water_shore_smoothing"in n||(n.b4w_water_shore_smoothing=!1,c("material",n,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in
n||(n.b4w_water_dynamic=!1,c("material",n,"b4w_water_dynamic")),"b4w_waves_height"in n||(n.b4w_waves_height=1,c("material",n,"b4w_waves_height")),"b4w_waves_length"in n||(n.b4w_waves_length=1,c("material",n,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in n||(n.b4w_water_dst_noise_scale0=.05,c("material",n,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in n||(n.b4w_water_dst_noise_scale1=.03,c("material",n,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in n||(n.b4w_water_dst_noise_freq0=
1.3,c("material",n,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in n||(n.b4w_water_dst_noise_freq1=1,c("material",n,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in n||(n.b4w_water_dir_min_shore_fac=.4,c("material",n,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in n||(n.b4w_water_dir_freq=.5,c("material",n,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in n||(n.b4w_water_dir_noise_scale=.05,c("material",n,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in
n||(n.b4w_water_dir_noise_freq=.07,c("material",n,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in n||(n.b4w_water_dir_min_noise_fac=.5,c("material",n,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in n||(n.b4w_water_dst_min_fac=.2,c("material",n,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in n||(n.b4w_water_waves_hor_fac=5,c("material",n,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in n||(n.b4w_water_absorb_factor=6,c("material",n,"b4w_water_absorb_factor")),"b4w_water_fog_color"in
n||(n.b4w_water_fog_color=new Float32Array(3),n.b4w_water_fog_color=[.5,.7,.7],c("material",n,"b4w_water_fog_color")),"b4w_foam_factor"in n||(n.b4w_foam_factor=5,c("material",n,"b4w_foam_factor")),"b4w_generated_mesh"in n||(n.b4w_generated_mesh=!1,c("material",n,"b4w_generated_mesh")),"b4w_water_num_cascads"in n||(n.b4w_water_num_cascads=5,c("material",n,"b4w_water_num_cascads")),"b4w_water_subdivs"in n||(n.b4w_water_subdivs=64,c("material",n,"b4w_water_subdivs")),"b4w_water_detailed_dist"in n||(n.b4w_water_detailed_dist=
1E3,c("material",n,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in n||(n.b4w_water_enable_caust=!1,c("material",n,"b4w_water_enable_caust")),"b4w_water_caust_scale"in n||(n.b4w_water_caust_scale=.25,c("material",n,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in n||(n.b4w_water_caust_brightness=.5,c("material",n,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in n||(n.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in n||(n.b4w_dynamic_grass_color="");"diffuse_intensity"in
n||(n.diffuse_intensity=1,c("material",n,"diffuse_intensity"));"b4w_use_ghost"in n||(n.b4w_use_ghost=!1);"b4w_collision_margin"in n||(n.b4w_collision_margin=.04,c("material",n,"b4w_collision_margin"));"b4w_collision_group"in n||(n.b4w_collision_group=128,c("material",n,"b4w_collision_group"));"b4w_collision_mask"in n||(n.b4w_collision_mask=127,c("material",n,"b4w_collision_mask"));"b4w_do_not_render"in n||(n.b4w_do_not_render=!1,c("material",n,"b4w_do_not_render"));"HALO"!=n.type||"b4w_halo_sky_stars"in
n||(n.b4w_halo_sky_stars=!1,c("material",n,"b4w_halo_sky_stars"));"HALO"!=n.type||"b4w_halo_stars_blend_height"in n||(n.b4w_halo_stars_blend_height=10,c("material",n,"b4w_halo_stars_blend_height"));"HALO"!=n.type||"b4w_halo_stars_min_height"in n||(n.b4w_halo_stars_min_height=0,c("material",n,"b4w_halo_stars_min_height"));"specular_shader"in n||(n.specular_shader="COOKTORR",c("material",n,"specular_shader"));"diffuse_shader"in n||(n.diffuse_shader="LAMBERT",c("material",n,"diffuse_shader"));"roughness"in
n||(n.roughness=.5,c("material",n,"roughness"));"diffuse_fresnel"in n||(n.diffuse_fresnel=.1,c("material",n,"diffuse_fresnel"));"diffuse_fresnel_factor"in n||(n.diffuse_fresnel_factor=.5,c("material",n,"diffuse_fresnel_factor"));"specular_slope"in n||(n.specular_slope=.2,c("material",n,"specular_slope"));"specular_toon_size"in n||(n.specular_toon_size=.5,c("material",n,"specular_toon_size"));"specular_toon_smooth"in n||(n.specular_toon_smooth=.1,c("material",n,"specular_toon_smooth"));"specular_alpha"in
n||(n.specular_alpha=1,c("material",n,"specular_alpha"));"b4w_wettable"in n||(n.b4w_wettable=!1,c("material",n,"b4w_wettable"));"b4w_refractive"in n||(n.b4w_refractive=!1,c("material",n,"b4w_refractive"));"b4w_refr_bump"in n||(n.b4w_refr_bump=0,c("material",n,"b4w_refr_bump"));"b4w_shallow_water_col"in n||(n.b4w_shallow_water_col=[0,.8,.3],c("material",n,"b4w_shallow_water_col"));"b4w_shore_water_col"in n||(n.b4w_shore_water_col=[0,.9,.2],c("material",n,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in
n||(n.b4w_shallow_water_col_fac=1,c("material",n,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in n||(n.b4w_shore_water_col_fac=.5,c("material",n,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in n||(n.b4w_water_sss_strength=5.9,c("material",n,"b4w_water_sss_strength"));"b4w_water_sss_width"in n||(n.b4w_water_sss_width=.45,c("material",n,"b4w_water_sss_width"));"b4w_render_above_all"in n||(n.b4w_render_above_all=!1,c("material",n,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in
n||(n.b4w_water_norm_uv_velocity=.05,c("material",n,"b4w_water_norm_uv_velocity"));"specular_ior"in n||(n.specular_ior=1,c("material",n,"specular_ior"));"darkness"in n||(n.darkness=0,c("material",n,"darkness"));"diffuse_toon_size"in n||(n.diffuse_toon_size=0,c("material",n,"diffuse_toon_size"));"diffuse_toon_smooth"in n||(n.diffuse_toon_smooth=0,c("material",n,"diffuse_toon_smooth"));h=n.texture_slots;for(g=0;g<h.length;g++)q=h[g],"blend_type"in q||(q.blend_type="MIX",c("texture_slot",q,"blend_type"));
if(n.node_tree){h=n.node_tree.nodes;for(g=0;g<h.length;g++)e(h[g]);n.node_tree.animation_data&&b(n.node_tree.animation_data)}}q=a.node_groups;for(l=0;l<q.length;l++)for(h=q[l].node_tree.nodes,g=0;g<h.length;g++)e(h[g]);h=a.objects;for(l=0;l<h.length;l++){q=h[l];switch(q.type){case "MESH":"b4w_dynamic_geometry"in q||(q.b4w_dynamic_geometry=!1);"b4w_reflexible"in q||(q.b4w_reflexible=!1);"b4w_reflexible_only"in q||(q.b4w_reflexible_only=!1);"b4w_reflective"in q||(q.b4w_reflective=!1);"b4w_reflection_type"in
q||(q.b4w_reflection_type="PLANE",c("object",q,"b4w_reflection_type"));"b4w_wind_bending"in q||(q.b4w_wind_bending=!1,c("object",q,"b4w_wind_bending"));"b4w_wind_bending_angle"in q||(q.b4w_wind_bending_angle=10,q.b4w_wind_bending_freq=.25,c("object",q,"wind bending params"));"b4w_detail_bending_amp"in q||(q.b4w_detail_bending_amp=.1,q.b4w_branch_bending_amp=.3,c("object",q,"detail bending params"));"b4w_detail_bending_freq"in q||(q.b4w_detail_bending_freq=1,c("object",q,"b4w_detail_bending_freq"));
"b4w_main_bend_stiffness_col"in q||(q.b4w_main_bend_stiffness_col="",c("object",q,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in q||(q.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},c("object",q,"b4w_detail_bend_colors"));"b4w_caustics"in q||(q.b4w_caustics=!1);"vertex_groups"in q&&q.vertex_groups.length&&q.data&&0==q.data.vertex_groups.length&&(q.data.vertex_groups=q.vertex_groups,delete q.vertex_groups,c("object",q,"vertex_groups"));"b4w_vertex_anim"in
q&&q.b4w_vertex_anim.length&&q.data&&0==q.data.b4w_vertex_anim.length&&(q.data.b4w_vertex_anim=q.b4w_vertex_anim,delete q.b4w_vertex_anim,c("object",q,"b4w_vertex_anim"));"b4w_do_not_render"in q||(q.b4w_do_not_render=!1);"use_ghost"in q.game||(q.game.use_ghost=!1);"use_sleep"in q.game||(q.game.use_sleep=!1);"velocity_min"in q.game||(q.game.velocity_min=0);"velocity_max"in q.game||(q.game.velocity_max=0);"collision_group"in q.game||(q.game.collision_group=1);"collision_mask"in q.game||(q.game.collision_mask=
255);"b4w_vehicle_settings"in q?q.b4w_vehicle_settings&&("steering_ratio"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.steering_ratio=10),"steering_max"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.steering_max=1),"inverse_control"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.inverse_control=!1),"force_max"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.force_max=1500),"brake_max"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.brake_max=100),"speed_ratio"in q.b4w_vehicle_settings||
(q.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.suspension_damping=
2.3),"wheel_friction"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.floating_factor=3),"floating_factor"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in q.b4w_vehicle_settings||
(q.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in q.b4w_vehicle_settings||(q.b4w_vehicle_settings.water_rot_damp=.9)):(q.b4w_vehicle_settings=null,c("object",q,"b4w_vehicle_settings"));"b4w_floating_settings"in q?q.b4w_floating_settings&&("floating_factor"in q.b4w_floating_settings||(q.b4w_floating_settings.floating_factor=3),"water_lin_damp"in q.b4w_floating_settings||(q.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in q.b4w_floating_settings||(q.b4w_floating_settings.water_rot_damp=
.8)):(q.b4w_floating_settings=null,c("object",q,"b4w_floating_settings"));"b4w_character_settings"in q?q.b4w_character_settings&&("walk_speed"in q.b4w_character_settings||(q.b4w_character_settings.walk_speed=4),"run_speed"in q.b4w_character_settings||(q.b4w_character_settings.run_speed=8),"step_height"in q.b4w_character_settings||(q.b4w_character_settings.step_height=.25),"jump_strength"in q.b4w_character_settings||(q.b4w_character_settings.jump_strength=5),"waterline"in q.b4w_character_settings||
(q.b4w_character_settings.waterline=0)):(q.b4w_character_settings=null,c("object",q,"b4w_character_settings"));"b4w_selectable"in q||(q.b4w_selectable=!1,c("object",q,"b4w_selectable"));"b4w_outlining"in q||(q.b4w_outlining=!1,c("object",q,"b4w_outlining"));"b4w_outline_on_select"in q||(q.b4w_outline_on_select=!1,c("object",q,"b4w_outline_on_select"));"b4w_billboard"in q||(q.b4w_billboard=!1,c("object",q,"b4w_billboard"));"b4w_billboard_geometry"in q||(q.b4w_billboard_geometry="SPHERICAL",c("object",
q,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in q||(q.b4w_pres_glob_orientation=!1,c("object",q,"b4w_pres_glob_orientation"));"b4w_outline_settings"in q||("b4w_glow_settings"in q?q.b4w_outline_settings=q.b4w_glow_settings:(q.b4w_outline_settings={},q.b4w_outline_settings.outline_duration=1,q.b4w_outline_settings.outline_period=1,q.b4w_outline_settings.outline_relapses=0),c("object",q,"b4w_outline_settings"));"b4w_lod_transition"in q||(q.b4w_lod_transition=.01,c("object",q,"b4w_lod_transition"));
"lod_levels"in q||(q.lod_levels=[],c("object",q,"lod_levels"));"b4w_animation_mixing"in q||(q.b4w_animation_mixing=!1,c("object",q,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in q||(q.b4w_anchor=null,c("object",q,"b4w_anchor")),!q.b4w_anchor||"max_width"in q.b4w_anchor||(q.b4w_anchor.max_width=250)}"collision_margin"in q.game||(q.game.collision_margin=.04,c("object",q,"collision_margin"));"b4w_anim_behavior"in q||(q.b4w_anim_behavior=q.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",c("object",
q,"b4w_anim_behavior"));if(!("rotation_quaternion"in q)){g=[0,0,0,1];k.euler_to_quat(q.rotation_euler,g);var f=g,n=g[0],t=g[1],p=g[2];f[0]=g[3];f[1]=n;f[2]=t;f[3]=p;q.rotation_quaternion=g;c("object",q,"rotation_quaternion")}"webgl_do_not_batch"in q&&(q.b4w_do_not_batch=q.webgl_do_not_batch)&&m("object",q,"webgl_do_not_batch");"b4w_shadow_cast_only"in q||(q.b4w_shadow_cast_only=!1,c("object",q,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in q||(q.b4w_correct_bounding_offset="AUTO",c("object",
q,"b4w_correct_bounding_offset"));f=q.particle_systems;for(g=0;g<f.length;g++)n=f[g],t=n.settings,"use_rotation_dupli"in t||(t.use_rotation_dupli=!1,c("object",t,"use_rotation_dupli")),"use_whole_group"in t||(t.use_whole_group=!1,c("object",t,"use_whole_group")),n.transforms||(n.transforms=new Float32Array,c("particle_system",n,"transforms")),"b4w_billboard_align"in t||(t.b4w_billboard_align="VIEW",c("particle_settings",t,"b4w_billboard_align")),"b4w_dynamic_grass"in t||(t.b4w_dynamic_grass=!1,c("object",
t,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in t||(t.b4w_dynamic_grass_scale_threshold=.01,c("object",t,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in t||(t.b4w_initial_rand_rotation=!1,c("particle_settings",t,"b4w_initial_rand_rotation")),"b4w_rotation_type"in t||(t.b4w_rotation_type="Z",c("particle_settings",t,"b4w_rotation_type")),"b4w_rand_rotation_strength"in t||(t.b4w_rand_rotation_strength=1,c("particle_settings",t,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in
t||(t.b4w_hair_billboard=!1,c("particle_settings",t,"b4w_hair_billboard")),"b4w_hair_billboard_type"in t||(t.b4w_hair_billboard_type="BASIC",c("particle_settings",t,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in t||(t.b4w_hair_billboard_jitter_amp=0,c("particle_settings",t,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in t||(t.b4w_hair_billboard_jitter_freq=0,c("particle_settings",t,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in t||(t.b4w_hair_billboard_geometry=
"SPHERICAL",c("particle_settings",t,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in t||(t.b4w_wind_bend_inheritance="PARENT",c("particle_settings",t,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in t||(t.b4w_shadow_inheritance="PARENT",c("particle_settings",t,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in t||(t.b4w_reflection_inheritance="PARENT",c("particle_settings",t,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in t||(t.b4w_vcol_from_name="",c("particle_settings",
t,"b4w_vcol_from_name")),"b4w_vcol_to_name"in t||(t.b4w_vcol_to_name="",c("particle_settings",t,"b4w_vcol_to_name")),"b4w_coordinate_system"in t||(t.b4w_coordinate_system="LOCAL",c("particle_settings",t,"b4w_coordinate_system")),"b4w_allow_nla"in t||(t.b4w_allow_nla=!0,c("particle_settings",t,"b4w_allow_nla")),"b4w_enable_soft_particles"in t||(t.b4w_enable_soft_particles=!1,c("particle_settings",t,"b4w_enable_soft_particles")),"b4w_particles_softness"in t||(t.b4w_particles_softness=1,c("particle_settings",
t,"b4w_particles_softness"));"constraints"in q||(q.constraints=[],c("object",q,"constraints"));f=q.modifiers;for(g=0;g<f.length;g++){a:{n=f[g];switch(n.type){case "ARRAY":if(!("fit_type"in n)){d.error("WARNING Incomplete modifier "+String(n.type)+' for "'+q.name+'", reexport "'+a.b4w_filepath_blend+'" scene');n=!1;break a}}n=!0}n||(f.splice(g,1),g--)}"animation_data"in q||(q.animation_data={action:null,nla_tracks:[]},c("object",q,"animation_data"));q.animation_data&&("action"in q.animation_data||
(q.animation_data.action=null,d.warn("no action in animation data "+q.name)),"nla_tracks"in q.animation_data||(q.animation_data.nla_tracks=[],d.warn("no NLA in animation data "+q.name)),b(q.animation_data));"b4w_collision_id"in q||(q.b4w_collision_id="",c("material",q,"b4w_collision_id"));(0>q.scale[0]||0>q.scale[1]||0>q.scale[2])&&d.warn('negative scale for object "'+q.name+'", can lead to some errors');g=q.scale;0==g[0]&&0==g[1]&&0==g[2]?g=!0:(f=Math.abs((g[1]-g[2])/g[1]),g=.005>Math.abs((g[0]-
g[1])/g[0])&&.005>f);g||d.warn("non-uniform scale for object "+q.name)}for(var C in A)l=A[C],g=C.match(/.*?(?=>>|$)/i)[0],d.warn('Property "'+String(g)+'" is '+l.bv+' for "'+l.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.lz=function(a,b){"num_channels"in a||(a.num_channels=1,d.warn('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.Fy=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var d=b[c].type;if("ARRAY"==d||"CURVE"==
d){b=!0;break a}}b=!1}if(!b)return null;b=f(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var e=a[c];switch(e.type){case "ARRAY":for(var d=b,q=e,m=0,p=0,A=0,C=new Float32Array(16),e=[],M=1;M<q.count;M++){q.use_constant_offset&&(m+=q.constant_offset_displace[0],p+=q.constant_offset_displace[1],A+=q.constant_offset_displace[2]);if(q.use_relative_offset)var G=d.b4w_bounding_box,m=m+(G.max_x-G.min_x)*q.relative_offset_displace[0],p=p+(G.max_y-G.min_y)*q.relative_offset_displace[1],
A=A+(G.max_z-G.min_z)*q.relative_offset_displace[2];k.qF(m,p,A,C);for(var E=G=f(d),r=C,K=0;K<E.submeshes.length;K++){var z=E.submeshes[K];k.Mf(z.position,r,z.position,0);k.tG(z.normal,r,z.normal);k.lF(z.tangent,r,z.tangent)}e.push(G)}for(M=0;M<e.length;M++)for(q=d,m=e[M],p=0;p<q.submeshes.length;p++){A=q.submeshes[p];C=m.submeshes[p];G=A.base_length;E=A.indices.length;A.base_length+=C.base_length;for(var H in A)if("base_length"!=H)if("indices"==H)for(A[H]=k.uF(A[H],C[H]),r=E;r<A.indices.length;r++)A.indices[r]+=
G;else"vertex_colors"!=H&&(A[H]=k.$A(A[H],C[H]))}break;case "CURVE":for(var d=b,M=h.hA(e.object),q=new Float32Array(16),p=M.Af?4:3,m=new Float32Array(p),p=new Float32Array(p),A=new Float32Array(3),C=new Float32Array(4),G=new Float32Array(4),E=new Float32Array(3),r=new Float32Array(3),K=new Float32Array(3),z=new Float32Array(4),V=new Float32Array(4),ba=0;ba<d.submeshes.length;ba++){var I=d.submeshes[ba],fa=I.position,Q=I.normal,I=I.tangent,ha;a:switch(ha=e.deform_axis,ha){case "POS_X":case "NEG_X":ha=
0;break a;case "POS_Y":case "NEG_Y":ha=1;break a;case "POS_Z":case "NEG_Z":ha=2;break a;default:throw"Wrong deform axis value "+ha;}E[0]=0;E[1]=0;E[2]=0;E[ha]=1;for(var aa=h.YE(M),R=0;R<fa.length/3;R++){K[0]=fa[3*R];K[1]=fa[3*R+1];K[2]=fa[3*R+2];var W=K[ha],na=h.XE(M,W);h.ZE(M,na,m);A[0]=m[0];A[1]=m[1];A[2]=m[2];h.WE(M,na,p);r[0]=p[0];r[1]=0;r[2]=p[2];n.normalize(r,r);g.rotationTo(E,r,C);0>W?(m[0]=r[0],m[1]=r[1],m[2]=r[2],n.scale(m,W,m),n.add(A,m,A)):W>aa&&(m[0]=r[0],m[1]=r[1],m[2]=r[2],n.scale(m,
W-aa,m),n.add(A,m,A));t.fromRotationTranslation(C,A,q);M.Af&&(g.setAxisAngle(E,m[3],G),n.transformQuat(K,G,K));K[ha]=0;n.transformMat4(K,q,K);fa[3*R]=K[0];fa[3*R+1]=K[1];fa[3*R+2]=K[2];Q.length&&(z[0]=Q[3*R],z[1]=Q[3*R+1],z[2]=Q[3*R+2],z[3]=0,x.transformMat4(z,q,z),Q[3*R]=z[0],Q[3*R+1]=z[1],Q[3*R+2]=z[2]);I.length&&(V[0]=I[3*R],V[1]=I[3*R+1],V[2]=I[3*R+2],V[3]=0,x.transformMat4(V,q,V),I[3*R]=V[0],I[3*R+1]=V[1],I[3*R+2]=V[2])}}}l.QD(b)}return b};a.Yz=function(){return{name:"DEFAULT",uuid:k.To(),use_nodes:!1,
diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,
b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],
b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]}};a.My=function(a,b){for(var c=b.b4w_logic_nodes,e=0;e<c.length;e++)for(var f=c[e],g=0;g<f.length;g++){var h=f[g],k={register1:"variable1",register2:"variable2",registerd:"variabled"},n;for(n in k)n in h&&(h[k[n]]=h[n]);switch(h.type){case "SELECT":for(k=0;k<a.length;k++){var l=a[k];l.name==h.object&&(l.b4w_selectable=!0)}h.bools||(h.bools={});h.bools.not_wait||(h.bools.not_wait=!1);break;case "SELECT_PLAY":d.warn('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport scene "'+
b.name+'"');h.mute=!0;break;case "SHOW":case "HIDE":case "PLAY_ANIM":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":for(var m in h.objects_paths){var l=h.objects_paths[m],t=l[0];if(1<l.length)for(k=1;k<l.length;k++)t+="*"+l[k];for(k=0;k<a.length;k++)l=a[k],l.name==t&&(l.b4w_do_not_batch=!0)}break;case "PLAY":b.b4w_use_nla=!0}}}};b4w.module.__scenegraph=function(a,p){function e(a){a=qa.pf(a);a.Ie=null;a.zb=null;a.pd=null;return a}function b(a,b){var d=[];N.ne(a,function(b,c,e){-1<d.indexOf(e)?N.ZD(a,b,c,e,m(e)):d.push(e)});N.W(a,function(c,e){for(var f=0;f<e.wa.length;f++){var g=e.wa[f];b||"MAIN_PLANE_REFLECT"!=e.type&&"MAIN_CUBE_REFLECT"!=e.type&&"MAIN_XRAY"!=e.type||(g.xh=!0);-1<d.indexOf(g)?e.wa[f]=m(g):d.push(g)}"ANTIALIASING"==e.type&&N.af(a,c,function(a,b){if("MOTION_BLUR"==b.type)for(var c=0;c<b.wa.length;c++){var d=
b.wa[c];d.ia=T.s;d.ha=T.s}});b||N.af(a,c,function(a,b,c){"DEPTH"==c.from&&(c.xh=!0)})});N.W(a,function(b){var d={};c(a,b,d);for(var e in d){b=d[e];for(var f=b[0],g=0;g<b.length;g++)if(b[g].ia==T.s){f=b[g];break}for(var h=b[0],g=0;g<b.length;g++)if(b[g].ha==T.s){h=b[g];break}for(var k=b[0],g=0;g<b.length;g++)if(!b[g].xh){k=b[g];break}for(g=0;g<b.length;g++)b[g].ia=f.ia,b[g].ha=h.ha,b[g].xh=k.xh}})}function c(a,b,d){N.af(a,b,function(b,e,f){f.kb&&f.from==f.to&&(d[f.from]=d[f.from]||[],-1==d[f.from].indexOf(f)&&
d[f.from].push(f),c(a,b,d))});N.ag(a,b,function(a,b,c){c.kb&&(d[c.from]=d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});b=N.Ja(a,b);if("MOTION_BLUR"==b.type)for(var e=0;e<b.wa.length;e++){var f=b.wa[e];d[f.from].push(f)}}function m(a){if(a.Ha)throw"Failed to clone slink with attached texture";return Z.zg(a)}function f(a){var b=N.Sq(a),c=[];N.W(b,function(a,e){switch(e.type){case "MOTION_BLUR":case "SMAA_RESOLVE":case "SMAA_NEIGHBORHOOD_BLENDING":case "MAIN_PLANE_REFLECT":var f=[];break;
default:f=c}for(var g=0;g<e.wa.length;g++){var k=e.wa[g],r=d(f,k,l(k));k.Ha=r;e.le[g]=r}for(g=0;g<e.le.length;g++)r=e.le[g],t(f,r);switch(e.type){case "MOTION_BLUR":case "SMAA_RESOLVE":case "SMAA_NEIGHBORHOOD_BLENDING":case "MAIN_PLANE_REFLECT":f=[]}N.ag(b,a,function(c,e,g){if(!g.Ha){if((c=h(b,a,g.from))&&g.kb&&!g.Ha){e=f;for(var k=c,r=0;r<e.length;r++){var n=e[r];n.Pq===k&&n.Dk++}}else c=d(f,g,l(g));g.Ha=c}});N.af(b,a,function(a,b,c){t(f,c.Ha)});N.ag(b,a,function(a,b,c){c.Ha&&"NONE"==c.to&&t(f,c.Ha)})})}
function l(a){a=Z.zg(a);delete a.to;delete a.kb;delete a.Ha;return JSON.stringify(a)}function h(a,b,c){var d=null;N.af(a,b,function(a,b,e){if(e.kb&&e.from==e.to&&e.from==c&&e.Ha)return d=e.Ha,!0});N.ag(a,b,function(a,b,e){if(e.kb&&e.from==c&&e.Ha)return d=e.Ha,!0});return d}function t(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.Pq===b&&d.Dk&&d.Dk--}}function d(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=a[e];if(f.id==c&&0===f.Dk){d=f;break}}if(d&&!Ra.VC)return d.Dk++,d.Pq;b=g(b);a.push({id:c,
Dk:1,Pq:b});return b}function g(a){var b=a.Oi*a.size;switch(a.from){case "COLOR":var c=T.Nl("COLOR",T.Jh);T.resize(c,b,b);T.Jk(c,a.ia,a.ha);return c;case "DEPTH":return a.xh?(c=T.Nl("DEPTH_RBUF",T.Ih),T.resize(c,b,b)):(c=T.Nl("DEPTH_TEX",T.nj),T.resize(c,b,b),T.Jk(c,a.ia,a.ha)),c;case "CUBEMAP":return c=T.Pz(b);case "SCREEN":return null;default:throw"Wrong slink param: "+a.from;}}function k(a,b){var c=!1;N.ne(a,function(d,e,f){if(f&&(d=N.Ja(a,d),e=N.Ja(a,e),b(f,!1,d,e)))return c=!0});c||N.W(a,function(a,
c){for(var d=0;d<c.wa.length;d++)if(b(c.wa[d],!0,c,null))return!0})}function n(a){N.W(a,function(b,c){if("SINK"!=c.type){var d=c.k;N.ag(a,b,function(a,b,c){c.kb&&c.Ha&&(Y.Sm(d,c.from,c.Ha),c.from==c.to&&b.k&&Y.Sm(b.k,c.from,c.Ha))});for(var e=0;e<c.wa.length;e++){var f=c.wa[e];f.kb&&f.from==f.to&&Y.Sm(d,f.from,c.le[e])}!d.zb&&!d.pd||d.Ie||(d.Ie=sa.YD(d.zb,d.pd))}})}function x(a){var b=null,c=0;N.W(a,function(a,d){if(d.type==Ba.jF){if(c==Ba.iF)return b=d,!0;c++}});return b}function I(a,b){var c=N.dh(a,
b),d=q("NONE"),e=N.u(a,d),f=N.$o(a)[0];N.ne(a,function(b,c){c==f&&N.RD(a,b,f,b,e)});N.ne(a,function(e,f,g){if(e==c)return N.n(a,b,d,v(Ba.ME,"u_color",g.size,g.Oi,g.Sk)),!0});N.Zb(a,e,f,v("SCREEN","NONE",.5,.5,!0))}function A(a,b){a.tk=b;a.yp=new Float32Array(3*b);a.tm=new Float32Array(3*b);a.sm=new Float32Array(3*b);a.zp=new Float32Array(0==b%2?2*b:2*b+2)}function B(a,b,c){var d=y("SHADOW_CAST");d.po=a;d.self_shadow_polygon_offset=b.self_shadow_polygon_offset;switch(b.Ug){case "SPOT":case "POINT":d.k=
Y.Db(Y.Xb);Y.Tm(d.k,180*b.Ye/Math.PI,.1,2*b.distance);break;default:d.k=Y.Db(Y.mg)}A(d,c);return d}function y(a){a={type:a,$a:"",Ra:!1,Gu:!1,In:!1,ym:!1,Mj:0,time:0,k:null,Lj:null,ro:[],p:[],wa:[],le:[],bf:new Float32Array(3),Iw:new Float32Array(3),wc:new Float32Array(3),gc:new Float32Array(4),am:new Float32Array(4),Mc:new Float32Array(16),yv:0,uf:0,tk:0,yp:null,tm:null,sm:null,zp:null,yf:new Float32Array(3),kg:new Float32Array(3),zv:new Float32Array(4),Qv:new Float32Array([0,0,0]),Jq:new Float32Array(3),
Rv:new Float32Array(4),xv:new Float32Array(3),vk:0,Eo:0,lk:!1,Se:new Float32Array(3),gg:0,yb:null,mn:!1,Uf:new Float32Array(2),Vf:new Float32Array(2),Ni:0,si:0,$n:0,Pd:null,ig:0,Hh:0,hg:0,we:!1,ns:0,os:new Float32Array(2),ms:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,Pi:new Float32Array(3),ssao_hemisphere:0,
ssao_blur_depth:0,ssao_blur_discard_value:0,Ti:0,Si:0,Ri:0,Iv:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,ri:0,Nm:0,Xi:0,po:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,nw:null,$r:null,jh:null,bloom_key:0,bloom_blur:0,bloom_edge_lum:0,Rn:0,Lo:0,mb_decay_threshold:0,mb_factor:0,ou:0,Im:"",uC:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,Qq:new Float32Array(2),ab:new Float32Array(2),
tb:!0,enqueue:!0,pa:!0,xa:!0,Sb:!0,ua:!0,$e:1};a.ab[0]=1;a.ab[1]=1;return a}function v(a,b,c,d,e){return{from:a,to:b,size:c,Oi:d,Sk:e,kb:!0,Ha:null,xh:!1,ia:T.Ic,ha:T.Ic}}function F(a,b){for(var c=0,d=P(a,b),e=0;e<d.length;e++){var f=d[e];"SHADOW_CAST"==f.type&&(f=f.k,b.wD=f.mb/(f.mb-f.ob),b.nw=f.za,b.$r=new Float32Array([.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1]),b.jh=b.jh||[],b.jh[c]=f.Ga,c++)}}function u(){var a=y("GRASS_MAP");a.k=Y.Db(Y.gf);return a}function q(a){var b=y("POSTPROCESSING");b.pa=!1;
b.xa=!1;b.Sb=!1;b.k=Y.Db(Y.Jb);b.Im=a;switch(a){case "NONE":b.ab[0]=1;b.ab[1]=1;break;case "GRAYSCALE":b.ab[0]=1;b.ab[1]=1;break;case "X_BLUR":b.ab[0]=1;b.ab[1]=0;break;case "Y_BLUR":b.ab[0]=0;b.ab[1]=1;break;case "X_GLOW_BLUR":b.ab[0]=1;b.ab[1]=0;break;case "Y_GLOW_BLUR":b.ab[0]=0;b.ab[1]=1;break;case "X_EXTEND":b.ab[0]=1;b.ab[1]=0;break;case "Y_EXTEND":b.ab[0]=0;b.ab[1]=1;break;default:throw"Wrong postprocessing effect: "+a;}return b}function D(a){var b=y("BLOOM_BLUR");b.pa=!1;b.xa=!1;b.Sb=!1;b.k=
Y.Db(Y.Jb);b.Im=a;switch(a){case "X_BLUR":b.ab[0]=1;b.ab[1]=0;break;case "Y_BLUR":b.ab[0]=0;b.ab[1]=1;break;default:throw"Wrong postprocessing effect for bloom blur: "+a;}return b}function w(a,b){var c=y("GLOW_COMBINE");c.pa=!1;c.xa=!1;c.Sb=!1;c.small_glow_mask_coeff=b.xf.small_glow_mask_coeff;c.large_glow_mask_coeff=b.xf.large_glow_mask_coeff;c.small_glow_mask_width=b.xf.small_glow_mask_width;c.large_glow_mask_width=b.xf.large_glow_mask_width;c.k=a;return c}function J(a,b,c,d,e,f,g,h,k){var r=y("MAIN_"+
a);if("OPAQUE"===a)r.pa=!0,r.xa=c,r.Ra=!1;else if("BLEND"===a)r.pa=!1,r.xa=!1,r.Ra=!0;else if("XRAY"===a)r.pa=!1,r.xa=!0,r.Ra=!0;else if("PLANE_REFLECT"===a||"CUBE_REFLECT"===a)r.pa=!0,r.xa=!0,r.Ra=!1;else if("GLOW"===a)r.pa=!0,r.xa=!1,r.Ra=!1;else throw"wrong main subscene type";r.Ra&&h&&(r.self_shadow_normal_offset=h.self_shadow_normal_offset);r.k=b;if(a=g.yq)r.zv.set([a.Uy,a.fC,a.FG,a.EG]),r.xv.set(a.color),r.yv=a.Da;r.yf.set(g.yf);r.kg.set(g.kg);r.uf=g.uf;r.gc=f.gc;r.am=f.am;d&&(r.yb=d,d.gc&&
(r.Pd=new Float32Array(d.gc)),r.ig=d.waves_height,r.Hh=d.waves_length,r.hg=d.hg,d.we&&k&&(r.we=!0,r.ns=d.iz,r.os.set(d.jz),r.ms=d.hz),d.Vm&&(r.mn=!0,f=d.KE,r.Uf[0]=(f[0]+f[1])/2,r.Uf[1]=(f[2]+f[3])/2,r.Vf[0]=f[0]-f[1],r.Vf[1]=f[2]-f[3],r.Ni=d.Ni,r.si=d.si));A(r,e);return r}function C(a,b,c){var d=y("COLOR_PICKING");b&&(d.type+="_XRAY",d.pa=!1,d.xa=!0);d.enqueue=!1;d.k=a;A(d,c);return d}function M(a){var b=y("WIREFRAME");b.tb=!1;b.pa=!1;b.xa=!1;b.k=a;return b}function G(a){var b=y("ANCHOR_VISIBILITY");
b.pa=!0;b.xa=!1;b.k=a;return b}function E(a,b){var c=y("DEPTH");c.k=a;A(c,b);return c}function r(a,b,c){var d=y("SSAO");d.pa=!1;d.xa=!1;d.Sb=!1;d.k=a;d.gc=b.gc;d.Pd=new Float32Array(b.gc);d.Ti=c.radius_increase;d.ssao_hemisphere=c.eC;d.Si=c.influence;d.Ri=c.dist_factor;d.Iv=c.hE;return d}function K(a,b){var c=y("SSAO_BLUR");c.pa=!1;c.xa=!1;c.Sb=!1;c.k=a;c.ssao_blur_depth=b.Xy;c.ssao_blur_discard_value=b.es;return c}function z(a){var b=y("ANTIALIASING");b.pa=!1;b.xa=!1;b.Sb=!1;b.$e=1/a.yd;b.hB=a.Ir;
b.k=Y.Db(Y.Jb);return b}function H(a,b){var c=y(a);c.pa="SMAA_BLENDING_WEIGHT_CALCULATION"==a||"SMAA_EDGE_DETECTION"==a?!0:!1;c.xa=!1;c.Sb=!1;c.$e=1/b.yd;c.k=Y.Db(Y.Jb);"SMAA_BLENDING_WEIGHT_CALCULATION"==a&&(c.vC=new Float32Array(4));return c}function V(a,b,c,d){var e=y("COMPOSITING");e.pa=!1;e.xa=!1;e.Sb=!1;e.k=Y.Db(Y.Jb);e.brightness=a;e.contrast=b;e.exposure=c;e.saturation=d;return e}function ba(a,b){var c=y("MOTION_BLUR");c.pa=!1;c.xa=!1;c.Sb=!1;c.k=Y.Db(Y.Jb);c.In=!0;c.mb_decay_threshold=a;
c.mb_factor=b;return c}function X(a){var b=y("DOF");b.pa=!1;b.xa=!1;b.Sb=!1;b.k=a;b.$e=b.k.dof_power;return b}function fa(a,b){var c=y("OUTLINE_MASK");c.Sb=!1;c.k=a;A(c,b);return c}function Q(a){var b=y("OUTLINE");va.outlining_overview_mode?b.Se.set(va.Se):b.Se.set(a.Se);b.vk=a.vk;b.Lo=5;b.Rn=3;b.Sb=!1;b.k=Y.Db(Y.Jb);return b}function ha(){var a=y("REFRACT");a.pa=!1;a.xa=!1;a.Sb=!1;a.k=Y.Db(Y.Jb);return a}function aa(a,b,c,d,e,f,g){var h=y("GOD_RAYS");h.pa=!1;h.xa=!1;h.Sb=!1;h.yf=new Float32Array([1,
1,1]);h.kg=new Float32Array([1,1,1]);h.uf=1;h.Gu=d;h.gg=b;h.Nm=e;h.ri=c;h.Xi=g;h.k=a;A(h,f);return h}function R(a,b){var c=y("GOD_RAYS_COMBINE");c.pa=!1;c.xa=!1;c.Sb=!1;c.k=Y.Db(Y.Jb);c.god_rays_intensity=a;A(c,b);return c}function W(a,b){var c=y("SKY");c.enqueue=!1;c.pa=!1;c.xa=!1;c.Sb=!1;var d=Y.Db(Y.Jb);d.width=pa.Ol;d.height=pa.Ol;c.k=d;c.Lj=Z.lB();A(c,a);c.yf=new Float32Array([1,1,1]);c.kg=new Float32Array([1,1,1]);c.uf=1;c.Pi.set(b.Pi);c.procedural_skydome=b.procedural_skydome;c.use_as_environment_lighting=
b.use_as_environment_lighting;c.rayleigh_brightness=b.rayleigh_brightness;c.mie_brightness=b.mie_brightness;c.spot_brightness=b.spot_brightness;c.scatter_strength=b.scatter_strength;c.rayleigh_strength=b.rayleigh_strength;c.mie_strength=b.mie_strength;c.rayleigh_collection_power=b.rayleigh_collection_power;c.mie_collection_power=b.mie_collection_power;c.mie_distribution=b.mie_distribution;return c}function na(){var a=y("COPY");a.pa=!1;a.xa=!1;a.k=Y.Db(Y.Jb);return a}function ia(){var a=y("ANAGLYPH");
a.pa=!1;a.xa=!1;a.k=Y.Db(Y.Jb);return a}function da(){var a=y("LUMINANCE");a.pa=!1;a.xa=!1;a.k=Y.Db(Y.Jb);return a}function ja(){var a=y("AVERAGE_LUMINANCE");a.pa=!1;a.xa=!1;a.k=Y.Db(Y.Jb);return a}function ga(a,b,c,d){var e=y("LUMINANCE_TRUNCED");e.pa=!1;e.xa=!1;e.bloom_key=a;e.bloom_edge_lum=b;e.k=d;A(e,c);return e}function L(a){var b=y("BLOOM");b.pa=!1;b.xa=!1;b.k=Y.Db(Y.Jb);b.bloom_blur=a;return b}function O(){var a=y("SINK");a.enqueue=!1;return a}function S(a,b,c){if(b.type===c)return!0;b=oa(a,
b);for(var d=0;d<b.length;d++)if(S(a,b[d],c))return!0;return!1}function ua(a,b,c){if(b.type===c)return!0;b=P(a,b);for(var d=0;d<b.length;d++)if(ua(a,b[d],c))return!0;return!1}function P(a,b){var c=N.dh(a,b);if(c==N.xr)throw"Subscene not in graph";for(var d=[],e=N.lp(a,c),f=0;f<e;f++){var g=N.fk(a,c,f);g!=c&&d.push(N.Ja(a,g))}return d}function oa(a,b){var c=N.dh(a,b);if(c==N.xr)throw"Subscene not in graph";for(var d=[],e=N.Hf(a,c),f=0;f<e;f++){var g=N.wf(a,c,f);g!=c&&d.push(N.Ja(a,g))}return d}function la(a){var b=
[],c=[];k(a,function(a){a.Ha&&-1==b.indexOf(a.Ha)&&(b.push(a.Ha),c.push(a.Ha,b.length-1))});return c}function ea(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.Sk){var d=a.Oi;Math.round(d)!=d&&(d=d.toFixed(2));d=(1==d?"":d)+"S";c+=d+"x"+d}else c+=a.size+"x"+a.size;if("SCREEN"!=a.from){c+=" ";if(a.xh)c+="RR";else{var d=a.ia,e=a.ha,f="";d==T.s?f+="L":d==T.Ic&&(f+="N");e==T.s?f+="L":e==T.Ic&&(f+="N");c+=f}for(d=0;d<b.length;d+=2)b[d]==a.Ha&&(c+=" "+b[d+1])}return c+")\\n"}var Y=
p("__camera"),U=p("__config"),ya=p("__debug"),N=p("__graph"),qa=p("__obj_util"),sa=p("__renderer"),T=p("__textures"),Z=p("__util"),Ba=U.yo,Ra=U.q,va=U.Ab,pa=U.Ji;a.wz=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "NONE":return!1;default:return!0}};a.tF=k;a.bA=function(a,c,d){function g(b,d){var f=e(Ia[d]);c.R.push(f);f=J(b,f,!1,ea,la,Nb,cc,Ob,a.uh);l.push(f);N.u(h,f);N.n(h,k[d],f,t[d]);"XRAY"==b?f.wa.push(v("DEPTH","DEPTH",1,1,!0)):N.n(h,k[d],
f,p[d]);Ua&&(N.n(h,Ua,f,lb),N.n(h,Ua,f,Fb));if(Pb){for(var r=0;r<qa.length;r++)N.n(h,qa[r],f,P[r]);if(Zc.oc&&rc||U||Xa){var r=sc[d],n=e(r.k);c.R.push(n);var m=y("DEPTH_PACK");m.pa=!1;m.xa=!1;m.k=n;N.u(h,m);var n=v("DEPTH","u_depth",1,1,!0),q=v("COLOR","u_scene_depth",1,1,!0);q.ia=T.Ic;q.ha=T.Ic;N.n(h,r,m,n);N.n(h,m,f,q)}}if(va.length)for(m=va.length/Ia.length,r=0;r<m;r++)n=m*d+r,N.n(h,va[n],f,S[n]);if(ua.length)for(r=0;r<ua.length;r++)N.n(h,ua[r],f,oa[r]);A.length&&N.n(h,A[d],f,sa[d]);return f}var h=
N.create(),k=[],l=[],m=[],t=[],p=[],va=[],S=[],A=[],sa=[],qa=[],P=[],ua=[],oa=[],la=a.yC,ea=a.yb,U=a.shore_smoothing,Xa=a.NE,Ya=a.ie,Ub=a.fi,Zc=a.bD,Gb=a.Ii,Cc=a.Wy,Uc=a.bh,tc=a.Rh,Vc=a.antialiasing,cc=a.or,Nb=a.Hw,Ob=a.ec,Dc=a.fD,gc=a.kz,od=a.ZB,gd=a.uD,md=a.Vh,Pb=a.CA,rc=a.oc,eb=Boolean(d.length),Ia=[];if(a.anaglyph_use&&!eb){var Ec=c.R[0],xb=e(Ec);Y.lu(Ec,Y.Kb);Y.lu(xb,Y.Pb);Ia.push(Ec,xb);c.R.push(xb)}else{var Da=c.R[0];Ia.push(Da)}if(Ob){Y.Yq(Ia[0],Ob);for(var yb=Ob.csm_num,ca=0;ca<yb;ca++){var pb=
B(ca,Ob,la);N.u(h,pb);qa.push(pb);var Ga=Ob.csm_resolution,Da=pb.k;Da.width=Ga;Da.height=Ga;pb.pa=!1;P.push(v("DEPTH","u_shadow_map"+ca,Ga,1,!1));(ya.rs()||Ra.dt)&&pb.wa.push(v("COLOR","COLOR",Ga,1,!1))}}if(Gb&&Gb.zu&&!eb)for(ca=0;ca<Gb.zu;ca++){Da=Y.Db(Y.Xb);Da.width=a.Dg;Da.height=a.Dg;Y.Tm(Da,90,.1,100);Y.Sf(Da,Da.Na);var xa=J("CUBE_REFLECT",Da,!1,ea,la,Nb,cc,null,a.uh);xa.Lj=Z.pB();for(var Fa=0;6>Fa;Fa++)xa.ro.push(Y.Sz());N.u(h,xa);var La=v("CUBEMAP","u_cube_reflection",a.Dg,1,!1);La.ia=T.s;
La.ha=T.s;var Qb=v("DEPTH","DEPTH",a.Dg,1,!1);oa.push(La);xa.wa.push(Qb);ua.push(xa);Gb.qf.push(xa)}if(Gb&&0<Gb.$u.length&&!eb)for(ca=0;ca<Ia.length;ca++)for(Fa=0;Fa<Gb.$u.length;Fa++)Da=e(Ia[ca]),Da.mc=new Float32Array(4),c.R.push(Da),xa=J("PLANE_REFLECT",Da,!1,ea,la,Nb,cc,null,a.uh),N.u(h,xa),La=v("COLOR","u_plane_reflection",1,a.Bk,!0),La.ia=T.s,La.ha=T.s,Qb=v("DEPTH","DEPTH",1,a.Bk,!0),S.push(La),xa.wa.push(Qb),va.push(xa),Gb.Lf.push(xa);k=[];l=[];if(a.Lb){var Ua=u();N.u(h,Ua);Ga=pa.em;Ua.k.width=
Ga;Ua.k.height=Ga;var lb=v("DEPTH","u_grass_map_depth",Ga,1,!1);lb.ia=T.s;lb.ha=T.s;var Fb=v("COLOR","u_grass_map_color",Ga,1,!1);Fb.ia=T.s;Fb.ha=T.s}else Fb=lb=Ua=null;for(var Cb=[],uc=[],sc=[],hc=[],ca=0;ca<Ia.length;ca++){var Da=Ia[ca],Ta={};p.push(v("DEPTH","DEPTH",1,1,!0));if(Pb){var jb=e(Da);c.R.push(jb);Ta=E(jb,la);sc.push(Ta);N.u(h,Ta);if(Ob){Ta.self_shadow_normal_offset=Ob.self_shadow_normal_offset;for(Fa=0;Fa<qa.length;Fa++)pb=qa[Fa],N.n(h,pb,Ta,P[Fa]);var ic=v("COLOR","u_color",1,1,!0),
Jc=v("DEPTH","u_depth",1,1,!0);if(Ya){var Rb=e(Da);c.R.push(Rb);var ub=a.aF,zb=r(Rb,Nb,ub);N.u(h,zb);var Qa=v("COLOR","u_ssao_mask",1,1,!0);N.n(h,Ta,zb,ic);N.n(h,Ta,zb,Jc);var fb=e(Da);c.R.push(fb);var Vb=K(fb,ub);N.u(h,Vb);var Lb=v("COLOR","u_shadow_mask",1,1,!0);N.n(h,zb,Vb,Qa);N.n(h,Ta,Vb,Jc)}}else ya.rs()&&Ta.wa.push(v("COLOR","COLOR",1,1,!0));Ua&&(N.n(h,Ua,Ta,lb),N.n(h,Ua,Ta,Fb))}xa=J("OPAQUE",Da,!Pb,ea,la,Nb,cc,null,a.uh);N.u(h,xa);l.push(xa);uc.push(xa);Pb&&(N.n(h,Ta,xa,p[ca]),Qa?N.n(h,Vb,
xa,Lb):Ob&&N.n(h,Ta,xa,v("COLOR","u_shadow_mask",1,1,!0)));var Wb=v("COLOR","u_color",1,1,!0);t.push(v("COLOR","COLOR",1,1,!0));Ua&&(N.n(h,Ua,xa,lb),N.n(h,Ua,xa,Fb));if(va.length)for(var Db=va.length/Ia.length,Fa=0;Fa<Db;Fa++){var jc=Db*ca+Fa;N.n(h,va[jc],xa,S[jc])}if(ua.length)for(Fa=0;Fa<ua.length;Fa++)N.n(h,ua[Fa],xa,oa[Fa])}k=l;l=[];if(!eb&&a.Ez){Da=e(k[0].k);c.R.push(Da);var mb=C(Da,!1,la);N.u(h,mb);if(a.df){Da=e(k[0].k);c.R.push(Da);var Xb=C(Da,!0,la);N.u(h,Xb);N.n(h,mb,Xb,v("COLOR","COLOR",
1,1,!0));N.n(h,mb,Xb,v("DEPTH","DEPTH",1,1,!0))}}else mb=null;if(Zc.oc&&!eb)for(ca=0;ca<Ia.length;ca++){var Pa=ha();N.u(h,Pa);N.n(h,k[ca],Pa,Wb);A.push(Pa);sa.push(v("COLOR","u_refractmap",1,1,!0))}if(a.bp){for(ca=0;ca<Ia.length;ca++)xa=g("BLEND",ca),Cb.push(xa);k=l;l=[]}if(a.Ke){for(ca=0;ca<Ia.length;ca++){var gb=e(Ia[ca]);c.R.push(gb);var ab=J("GLOW",gb,!1,ea,la,Nb,cc);N.u(h,ab);N.n(h,uc[ca],ab,p[ca]);var Va=q("X_GLOW_BLUR");Va.$a="GLOW_MASK_SMALL";Va.$e=a.xf.small_glow_mask_width;var Za=v("COLOR",
"u_color",1,1,!0);Za.ia=T.s;Za.ha=T.s;N.u(h,Va);N.n(h,ab,Va,Za);var bb=q("Y_GLOW_BLUR");bb.$a="GLOW_MASK_SMALL";bb.$e=a.xf.small_glow_mask_width;var nb=v("COLOR","u_color",1,.5,!0);nb.ia=T.s;nb.ha=T.s;N.u(h,bb);N.n(h,Va,bb,nb);var Eb=q("X_GLOW_BLUR");Eb.$a="GLOW_MASK_LARGE";Eb.$e=a.xf.large_glow_mask_width;var Ca=v("COLOR","u_color",1,.5,!0);Ca.ia=T.s;Ca.ha=T.s;N.u(h,Eb);N.n(h,bb,Eb,Ca);var cb=q("Y_GLOW_BLUR");cb.$a="GLOW_MASK_LARGE";cb.$e=a.xf.large_glow_mask_width;var db=v("COLOR","u_color",1,.25,
!0);db.ia=T.s;db.ha=T.s;N.u(h,cb);N.n(h,Eb,cb,db);var Sb=e(Ia[ca]);c.R.push(Sb);var Ha=w(Sb,a);N.u(h,Ha);a.bp?N.n(h,Cb[ca],Ha,v("COLOR","u_src_color",1,1,!0)):N.n(h,uc[ca],Ha,v("COLOR","u_src_color",1,1,!0));var kc=v("COLOR","u_glow_mask_small",1,.5,!0);kc.ia=T.s;kc.ha=T.s;N.n(h,bb,Ha,kc);var lc=v("COLOR","u_glow_mask_large",1,.25,!0);lc.ia=T.s;lc.ha=T.s;N.n(h,cb,Ha,lc);m.push(Ha)}k=m;l=[]}if(!a.bp){for(ca=0;ca<Ia.length;ca++)xa=g("BLEND",ca),Cb.push(xa);k=l;l=[]}if(a.df){for(ca=0;ca<Ia.length;ca++){var Hb=
g("XRAY",ca);hc.push(Hb)}k=l;l=[]}if(Ra.wireframe_debug){for(ca=0;ca<Ia.length;ca++){Da=e(Ia[ca]);c.R.push(Da);var Ib=M(Da);l.push(Ib);N.u(h,Ib);N.n(h,k[ca],Ib,t[ca]);N.n(h,k[ca],Ib,p[ca]);Ua&&(N.n(h,Ua,Ib,lb),N.n(h,Ua,Ib,Fb))}k=l;l=[]}if(!eb&&a.iy){Da=e(Ia[0]);c.R.push(Da);var hb=G(Da);N.u(h,hb);N.n(h,k[0],hb,p[0])}if(Ub&&Pb&&!eb){for(ca=0;ca<Ia.length;ca++){var Ab=od.ri,dc=od.op,ib=od.Xi,Ea=k[ca],qb=ea?1:0,vc=v("DEPTH","u_input",1,1,!0);vc.ia=T.s;vc.ha=T.s;var ob=v("COLOR","u_input",1,.25,!0);ob.ia=
T.s;ob.ha=T.s;var Tb=Ab/ib,Jb=e(Ia[ca]);c.R.push(Jb);var Kb=aa(Jb,qb,Ab,!0,Tb,la,ib);N.u(h,Kb);N.n(h,Ea,Kb,vc);var Tb=Ab/ib*.5,vb=e(Ia[ca]);c.R.push(vb);var Na=aa(vb,qb,Ab,!1,Tb,la,ib);N.u(h,Na);N.n(h,Kb,Na,ob);var Tb=Ab/ib*.25,ec=e(Ia[ca]);c.R.push(ec);var Mb=aa(ec,qb,Ab,!1,Tb,la,ib);N.u(h,Mb);N.n(h,Na,Mb,ob);var wb=R(dc,la);l.push(wb);N.u(h,wb);N.n(h,Ea,wb,v("COLOR","u_main",1,1,!0));N.n(h,Mb,wb,v("COLOR","u_god_rays",1,1,!0))}k=l;l=[]}if(Cc&&!eb){for(ca=0;ca<Ia.length;ca++){var Ea=k[ca],Yb=da();
N.u(h,Yb);N.n(h,Ea,Yb,v("COLOR","u_input",1,1,!0));var mc=ja();N.u(h,mc);mc.k.width=Ra.Tj?2:1;mc.k.height=Ra.Tj?2:1;var wc=v("COLOR","u_input",1,.25,!0);wc.ia=T.s;wc.ha=T.s;var nc=v("COLOR","u_luminance",1,.25,!0);nc.ia=T.s;nc.ha=T.s;N.n(h,Yb,mc,wc);var oc=Cc.key,Fc=Cc.JA,Kc=e(Ia[ca]);c.R.push(Kc);var Zb=ga(oc,Fc,la,Kc);N.u(h,Zb);N.n(h,Ea,Zb,v("COLOR","u_main",1,1,!0));N.n(h,Yb,Zb,nc);N.n(h,mc,Zb,v("COLOR","u_average_lum",1,1,!1));var Ja=v("COLOR","u_color",1,.25,!0);Ja.ia=T.s;Ja.ha=T.s;Va=D("X_BLUR");
N.u(h,Va);N.n(h,Zb,Va,Ja);bb=D("Y_BLUR");N.u(h,bb);N.n(h,Va,bb,Ja);var Ma=L(Cc.blur);N.u(h,Ma);var Wc=v("COLOR","u_bloom",1,.25,!0);Wc.ia=T.s;Wc.ha=T.s;N.n(h,bb,Ma,Wc);N.n(h,Ea,Ma,v("COLOR","u_main",1,1,!0));l.push(Ma)}k=l;l=[]}if(Uc&&!eb){for(ca=0;ca<k.length;ca++){var pc=k[ca],qc=ba(Dc.mb_decay_threshold,Dc.mb_factor);l.push(qc);N.u(h,qc);N.n(h,pc,qc,v("COLOR","u_mb_tex_curr",1,1,!0));qc.wa.push(v("COLOR","u_mb_tex_accum",1,1,!0))}k=l;l=[]}if(md&&Pb&&!eb){for(ca=0;ca<k.length;ca++){var Ea=k[ca],
$b=e(Ia[ca]);c.R.push($b);Ja=v("COLOR","u_color",1,1,!0);Ja.ia=T.s;Ja.ha=T.s;var ac=q("X_BLUR");N.u(h,ac);N.n(h,Ea,ac,Ja);var xc=q("Y_BLUR");N.u(h,xc);N.n(h,ac,xc,Ja);var Ta=Cb[ca],Lc=X($b);$b.dof_distance=c.dof_distance;$b.Ce=c.Ce;$b.dof_front=c.dof_front;$b.dof_rear=c.dof_rear;$b.dof_power=c.dof_power;$b.dof_on=1;l.push(Lc);N.u(h,Lc);N.n(h,Ea,Lc,v("COLOR","u_sharp",1,1,!0));N.n(h,xc,Lc,v("COLOR","u_blurred",1,1,!0));N.n(h,Ta,Lc,v("DEPTH","u_depth",1,1,!0))}k=l;l=[]}if(!eb&&a.outline){for(ca=0;ca<
Ia.length;ca++){var Ea=k[ca],bc=e(Ia[ca]);c.R.push(bc);var $c=fa(bc,la);N.u(h,$c);var Pc=q("X_EXTEND"),ad=v("COLOR","u_color",1,1,!0),nd=v("COLOR","u_outline_mask",1,1,!0);Pc.lk=!0;N.u(h,Pc);N.n(h,$c,Pc,ad);var Qc=v("COLOR","u_color",1,.5,!0);Qc.ia=T.s;Qc.ha=T.s;var Gc=q("Y_EXTEND");Gc.lk=!0;N.u(h,Gc);N.n(h,Pc,Gc,Qc);ac=q("X_BLUR");ac.lk=!0;N.u(h,ac);N.n(h,Gc,ac,Qc);var Mc=v("COLOR","u_color",1,.25,!0);Mc.ia=T.s;Mc.ha=T.s;var bd=v("COLOR","u_outline_mask_blurred",1,.25,!0);bd.ia=T.s;bd.ha=T.s;xc=
q("Y_BLUR");xc.lk=!0;N.u(h,xc);N.n(h,ac,xc,Mc);var Nc=Q(gd);N.u(h,Nc);N.n(h,Ea,Nc,v("COLOR","u_outline_src",1,1,!0));N.n(h,$c,Nc,nd);N.n(h,xc,Nc,bd);l.push(Nc)}k=l;l=[]}if(tc&&!eb){for(ca=0;ca<k.length;ca++){var Ea=k[ca],cd=V(gc.brightness,gc.contrast,gc.exposure,gc.saturation);N.u(h,cd);N.n(h,Ea,cd,v("COLOR","u_color",1,1,!0));l.push(cd)}k=l;l=[]}if(Vc){for(ca=0;ca<k.length;ca++)if(Ea=k[ca],Ra.smaa){var Oc=v("COLOR","u_color",1,1,!0);Oc.ia=T.s;Oc.ha=T.s;var rb=H("SMAA_EDGE_DETECTION",a);N.u(h,rb);
N.n(h,Ea,rb,Oc);var Rc=H("SMAA_BLENDING_WEIGHT_CALCULATION",a);N.u(h,Rc);N.n(h,rb,Rc,Oc);var yc=v("COLOR","u_search_tex",1,1,!1),dd=v("COLOR","u_area_tex",1,1,!1);yc.ia=T.s;yc.ha=T.s;dd.ia=T.s;dd.ha=T.s;Rc.wa.push(yc);Rc.wa.push(dd);var Sc=H("SMAA_NEIGHBORHOOD_BLENDING",a);N.u(h,Sc);N.n(h,Ea,Sc,Oc);var Xc=v("COLOR","u_blend",1,1,!0);Xc.ia=T.s;Xc.ha=T.s;N.n(h,Rc,Sc,Xc);l.push(Sc)}else{var Hc=z(a);N.u(h,Hc);var ed=v("COLOR","u_color",1,1,!0);ed.ia=T.s;ed.ha=T.s;N.n(h,Ea,Hc,ed);l.push(Hc)}k=l;l=[]}if(a.anaglyph_use&&
!eb){var Yc=ia();N.u(h,Yc);N.n(h,k[0],Yc,v("COLOR","u_sampler_left",1,1,!0));N.n(h,k[1],Yc,v("COLOR","u_sampler_right",1,1,!0));l.push(Yc)}else l.push(k[0]);var hd=N.dh(h,k[0]);if("MOTION_BLUR"==k[0].type)var fd=!0;else fd=!1,N.af(h,hd,function(a,b,c){if(c.from==c.to)return fd=!0});if(fd){var zc=na();N.u(h,zc);N.n(h,k[0],zc,v("COLOR","u_color",1,1,!0));k=l;l=[];l.push(zc)}mb&&(Xb?l.push(Xb):l.push(mb));hb&&l.push(hb);if(!eb&&a.Ym.procedural_skydome){var pd=W(la,a.Ym);N.u(h,pd);l.push(pd)}var Tc=O();
N.u(h,Tc);for(ca=0;ca<l.length;ca++){var jd=l[ca];switch(jd.type){case "COLOR_PICKING":case "COLOR_PICKING_XRAY":N.n(h,jd,Tc,v("COLOR","NONE",1,1,!0));N.n(h,jd,Tc,v("DEPTH","NONE",1,1,!0));break;case "SKY":N.n(h,jd,Tc,v("CUBEMAP","u_sky",pa.Ol,1,!1));break;case "ANCHOR_VISIBILITY":N.n(h,jd,Tc,v("COLOR","NONE",1,1,!0));break;default:if(eb){var qd=d[0].j,kd=v("COLOR","OFFSCREEN",1,1,!0);kd.Ha=qd;N.n(h,l[ca],Tc,kd);for(Fa=1;Fa<d.length;Fa++){var rd=d[Fa].j,zc=na();N.u(h,zc);N.n(h,l[ca],zc,v("COLOR",
"u_color",1,1,!0));kd=v("COLOR","OFFSCREEN",1,rd.sh/qd.sh,!0);kd.Ha=rd;N.n(h,zc,Tc,kd)}}else N.n(h,l[ca],Tc,v("SCREEN","NONE",1,1,!0))}}if(Ba.enabled){var sd=x(h);sd&&I(h,sd)}b(h,Pb);f(h);n(h);if(Ob){for(ca=0;ca<sc.length;ca++)F(h,sc[ca]);for(ca=0;ca<Cb.length;ca++)F(h,Cb[ca]);for(ca=0;ca<hc.length;ca++)F(h,hc[ca])}return h};a.AI=y;a.Zc=function(a,b,c){var d=a.$e;a.Qq[0]=b*a.ab[0]*d;a.Qq[1]=c*a.ab[1]*d};a.dc=function(a,b){a.$e=b};a.WH=function(a){var b=null;N.W(a,function(a,c){return c.k&&null===
c.k.Ie?(b=c,!0):!1});return b};a.Xa=function(a,b,c){a=P(a,b);for(b=0;b<a.length;b++)if(a[b].type===c)return a[b];return null};a.rI=S;a.tI=ua;a.MB=P;a.jI=oa;a.Ya=function(a,b){var c=null;N.W(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.tA=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=la(a);N.W(a,function(a,d){var e=b+="    ",f="",f=d.type.replace(/_/g," ");"POSTPROCESSING"==
d.type&&(f+=" ("+d.Im.replace(/_/g," ")+")");if(d.k){for(var f=f+"\\n",g=0;g<c.length;g+=2)c[g]==d.k.zb&&(f+="C"+c[g+1]+" ");for(g=0;g<c.length;g+=2)c[g]==d.k.pd&&(f+="D"+c[g+1])}d.wa.length&&(f+="\\n-----\\n");for(g=0;g<d.wa.length;g++)f+=ea(d.wa[g],c);g="SINK"==d.type?"dotted":d.enqueue?"solid":"dashed";b=e+(String(a)+' [label="'+f+'" color="black" style="'+(g+",bold")+'"];\n')});N.ne(a,function(a,d,e){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+ea(e,c)+'" style="'+(e.kb?"solid":"dotted")+
'"];\n'});return b+="}"};a.cA=function(a){a=N.pF(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.enqueue&&b.push(d)}return b}};b4w.module.__textures=function(a,p){function e(){return{name:"",type:0,source:"",Aq:"",width:0,height:0,ko:1,ll:!0,sh:1024,Ws:!1,ve:null,xb:0,Qa:null,fg:null,fy:null,nk:!1,fc:-1,L:null,wi:0,ae:0,I:0,Ea:0,ai:0,de:!1,Te:1,pc:null,sq:0,rq:0,rh:-1,tq:!1,Rm:-1,pn:!1,cG:!1,dj:!1,ln:!1,repeat:!0}}function b(b,d,f,g){var h=b.type,k=new Uint8Array([204,204,204,255]),l=e();switch(h){case "DATA_TEX2D":case "IMAGE":var n=r.createTexture(),m=r.TEXTURE_2D;r.bindTexture(m,n);r.texImage2D(m,0,r.RGBA,1,1,0,r.RGBA,
r.UNSIGNED_BYTE,k);b.image&&"MOVIE"==b.image.source&&(l.nk=!0,l.I=b.frame_start,l.Ea=b.frame_offset,l.ai=b.frame_duration,l.cG=b.use_auto_refresh,l.dj=b.use_cyclic,l.wi=b.movie_length,l.ln=b.b4w_nla_video,0!=l.Ea&&v.warn('Frame offset for texture "'+b.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));break;case "NONE":n=r.createTexture();m=r.TEXTURE_2D;r.bindTexture(m,n);if("NONE"==b.b4w_source_type)return null;if("SCENE"==b.b4w_source_type)if(b.b4w_source_id&&(f=
u.keysearch("name",b.b4w_source_id,f)))l.sh=b.b4w_source_size,f.Qd=f.Qd||[],f.Qd.push(b),r.texImage2D(m,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,k);else return null;break;case "ENVIRONMENT_MAP":n=r.createTexture();m=r.TEXTURE_CUBE_MAP;r.bindTexture(m,n);f="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var q=0;6>q;q++)r.texImage2D(r["TEXTURE_CUBE_MAP_"+f[q]],0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,k);break;case "BLEND":return null;default:return v.error('texture "'+b.name+
'" has unsupported type "'+h+'"'),null}"NONE"==h&&(!b.b4w_enable_canvas_mipmapping||"CANVAS"!=b.b4w_source_type)||"DATA_TEX2D"==h||"IMAGE"==h&&"MOVIE"==b.image.source?r.texParameteri(m,r.TEXTURE_MIN_FILTER,r.LINEAR):r.texParameteri(m,r.TEXTURE_MIN_FILTER,K[D.Pk]);r.texParameteri(m,r.TEXTURE_MAG_FILTER,r.LINEAR);k=m;f=b.b4w_anisotropic_filtering;"DEFAULT"===f&&(f=d);"OFF"!==f&&D.nl&&(d=y.xB())&&(f=parseFloat(f.split("x")[0]),r.texParameterf(k,d.TEXTURE_MAX_ANISOTROPY_EXT,f));"REPEAT"!=b.extension||
b.b4w_shore_dist_map?(l.repeat=!1,r.texParameteri(m,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(m,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)):(r.texParameteri(m,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(m,r.TEXTURE_WRAP_T,r.REPEAT));l.type=a.Jh;l.width=1;l.height=1;l.Qa=n;l.xb=m;"CANVAS"==b.b4w_source_type&&"NONE"==h?(h=b.b4w_source_id,n=b.b4w_source_size,l.Ws=b.b4w_enable_canvas_mipmapping,l.Aq=h,l.source="CANVAS",m=document.createElement("canvas"),m.width=n,m.height=n,l.ve=m.getContext("2d"),g in
G||(G[g]={}),G[g][h]=l,c(l)):"SCENE"==b.b4w_source_type&&"NONE"==h?(l.Aq=b.b4w_source_id,l.source="SCENE"):(l.source=h,r.generateMipmap(m),r.bindTexture(m,null));l.name=b.name;return b.j=l}function c(a){if("CANVAS"!=a.source)throw"Wrong texture";var b=a.xb;r.bindTexture(b,a.Qa);var c=t(a),e=d(a),f=a.ve.canvas;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);r.texImage2D(b,0,c,c,e,f);r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1);a.Ws&&r.generateMipmap(b);r.bindTexture(b,null);a.width=f.width;a.height=f.height}function m(){J||
(J=document.createElement("canvas"));return J}function f(a,b,c,d,e){e||(l(r.TEXTURE_2D),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,b));r.bindTexture(r.TEXTURE_2D,null);q.HA(a,c,d,M,C)}function l(a){M||(M=r.createFramebuffer());r.bindTexture(a,null);C||(C=r.createTexture());r.bindTexture(a,C);r.texParameteri(a,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE);r.texParameteri(a,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);r.texParameteri(a,r.TEXTURE_MAG_FILTER,r.LINEAR);r.texParameteri(a,r.TEXTURE_MIN_FILTER,r.LINEAR)}
function h(a){return u.zj(a)?u.clamp(Math.pow(2,parseInt(a).toString(2).length),2,D.ub):a}function t(b){switch(b.type){case a.Jh:b=r.RGBA;break;case a.zn:b=r.RGB;break;case a.hl:b=r.RGBA;break;case a.il:b=r.RGB;break;case a.nj:b=r.DEPTH_COMPONENT;break;default:throw"Wrong texture type";}return b}function d(b){switch(b.type){case a.Jh:b=r.UNSIGNED_BYTE;break;case a.zn:b=r.UNSIGNED_BYTE;break;case a.hl:b=r.FLOAT;break;case a.il:b=r.FLOAT;break;case a.nj:b=r.UNSIGNED_INT;break;default:throw"Wrong texture type";
}return b}function g(a,b){if(b in E&&a in E[b]){var c=E[b][a];c.L?c.L.play():c.pc&&(c.tq=!0);return!0}return!1}function k(a,b){if(b in E&&a in E[b]){var c=E[b][a];c.L?c.L.pause():c.pc&&(c.tq=!1);return!0}return!1}function n(a,b){if(b in E&&a in E[b]){var c=E[b][a];c.L?c.L.currentTime=c.Ea/c.ae:c.pc&&(c.rh=I(c,c.Ea));return!0}return!1}function x(a){return a.L?!a.L.paused:a.pc?a.tq:!1}function I(a,b){return Math.round(b*a.sq/a.wi)}var A=p("__config"),B=p("__dds"),y=p("__extensions"),v=p("__print"),
F=p("__time"),u=p("__util"),q=p("__renderer"),D=A.q,w=A.w,J=null,C=null,M=null;a.Ic=0;a.s=0;a.by=0;a.$x=0;a.ay=0;a.Zx=0;a.Jh=10;a.zn=20;a.hl=30;a.il=40;a.nj=50;a.Ih=60;var G={},E={},r=null,K;a.$c=function(b){K=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.Ic=b.NEAREST;a.s=b.LINEAR;a.by=b.NEAREST_MIPMAP_NEAREST;a.$x=b.LINEAR_MIPMAP_NEAREST;a.ay=b.NEAREST_MIPMAP_LINEAR;a.Zx=b.LINEAR_MIPMAP_LINEAR;r=b};a.BB=function(a,b){return b in G&&a in G[b]?
G[b][a].ve:null};a.KF=function(a,b){return b in G&&a in G[b]?(c(G[b][a]),!0):!1};a.Nl=function(b,c){var d=e();d.name=b;d.type=c;d.source="NONE";if(c==a.Ih)d.fg=r.createRenderbuffer();else{var f=r.TEXTURE_2D,g=r.createTexture();r.bindTexture(f,g);r.texParameteri(f,r.TEXTURE_MAG_FILTER,r.LINEAR);r.texParameteri(f,r.TEXTURE_MIN_FILTER,r.LINEAR);r.texParameteri(f,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE);r.texParameteri(f,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);r.bindTexture(f,null);d.xb=f;d.Qa=g}return d};a.Pz=function(b){var c=
r.createTexture(),d=r.TEXTURE_CUBE_MAP;r.bindTexture(d,c);r.texParameteri(d,r.TEXTURE_MAG_FILTER,r.LINEAR);r.texParameteri(d,r.TEXTURE_MIN_FILTER,r.LINEAR);r.texParameteri(d,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE);r.texParameteri(d,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);for(var f="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),g=0;6>g;g++)r.texImage2D(r[f[g]],0,r.RGBA,b,b,0,r.RGBA,
r.UNSIGNED_BYTE,null);r.bindTexture(d,null);d=e();d.name="CUBEMAP";d.type=a.Jh;d.source="NONE";d.width=3*b;d.height=2*b;d.ko=1;d.Qa=c;d.xb=r.TEXTURE_CUBE_MAP;return d};a.Jk=function(b,c,d){if(b.type!=a.Ih){var e=b.xb;r.bindTexture(e,b.Qa);c&&r.texParameteri(e,r.TEXTURE_MIN_FILTER,c);d&&r.texParameteri(e,r.TEXTURE_MAG_FILTER,d);r.bindTexture(e,null)}};a.iI=function(b){if(b.type==a.Ih)return{min:a.Ic,WC:a.Ic};var c=b.xb;r.bindTexture(c,b.Qa);b=r.getTexParameter(c,r.TEXTURE_MIN_FILTER);var d=r.getTexParameter(c,
r.TEXTURE_MAG_FILTER);r.bindTexture(c,null);return{min:b,WC:d}};a.resize=function(b,c,e){c=Math.max(c,D.Tj?2:1);e=Math.max(e,D.Tj?2:1);if(b.width!=c||b.height!=e){if(b.type==a.Ih)r.bindRenderbuffer(r.RENDERBUFFER,b.fg),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,c,e),r.bindRenderbuffer(r.RENDERBUFFER,null);else{var f=b.xb;r.bindTexture(f,b.Qa);var g=t(b),h=d(b);r.texImage2D(f,0,g,c,e,0,g,h,null);r.bindTexture(f,null)}c>D.ub||e>D.ub?v.error('Slink texture "'+b.name+'" has unsupported size: '+
c+"x"+e+". Max available: "+D.ub+"x"+D.ub+"."):(b.width=c,b.height=e)}};a.kA=b;a.ar=function(a){var b=a.xb;r.bindTexture(b,a.Qa);r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);4!=a.L.length?a.de?f(a,a.L,a.width*a.Te,a.height*a.Te,!1):r.texImage2D(b,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,a.L):r.texImage2D(b,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,a.L);r.bindTexture(b,null)};a.gw=function(a){var b=a.xb;r.bindTexture(b,a.Qa);r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);a.de?f(a,a.pc[a.rh],a.width*a.Te,a.height*a.Te,!1):
r.texImage2D(b,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,a.pc[a.rh]);r.bindTexture(b,null)};a.Tk=function(a,b,c,d,e){var g=a.source,k=a.Qa,n=a.xb,t=1,p=1;r.bindTexture(n,k);if(4==b.length){var G=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==g)if(G)r.texImage2D(n,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(c){p=B.Dt(b);G=u.zj(p.width)||u.zj(p.height);if(p.width>D.ub||p.height>D.ub){v.error('Texture "'+d+'" has unsupported size: '+p.width+"x"+p.height+". Max available: "+
D.ub+"x"+D.ub+".");return}t=p.width;p=p.height;G&&(a.de=!0,l(n),t=h(t*a.Te),p=h(p*a.Te));B.ZF(r,y.Bt(),b,!0);a.de&&(f(a,null,t,p,!0),r.bindTexture(n,k),r.generateMipmap(n));a.width=t;a.height=p;a.ko=B.DB(b)}else{r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);a.nk?D.Ik?(t=b[0].width,p=b[0].height):(t=b.videoWidth,p=b.videoHeight):(t=b.width,p=b.height);a.width=t;a.height=p;if(t>D.ub||t>D.ub)v.warn('Texture "'+d+'" has unsupported size: '+t+"x"+p+". Max available: "+D.ub+"x"+D.ub+". Reduced image size will be used."),
a.Te=Math.min(D.ub/t,D.ub/p),a.de=!0;a.nk&&(D.Ik?(e in E||(E[e]={}),E[e][a.name]=a,a.pc=b,a.sq=b.length,a.ae=a.rq*a.wi/b.length,b=b[0]):(e in E||(E[e]={}),E[e][a.name]=a,a.L=b,a.L.loop=a.dj,a.ae=b.duration?a.wi/b.duration:F.Nb(),w.Ts||(b.playbackRate=F.Nb()/a.ae,w.vs&&2<b.playbackRate&&(b.playbackRate=2))));t=h(a.width*a.Te);p=h(a.height*a.Te);a.de?(d=m(),k=d.getContext("2d"),d.width=t,d.height=p,k.drawImage(b,0,0,a.width,a.height,0,0,t,p),r.texImage2D(n,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,d)):u.zj(a.width)||
u.zj(a.height)?(f(a,b,t,p,!1),a.de=!0):r.texImage2D(n,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,b);k=a.Qa;r.bindTexture(n,k);a.nk||r.generateMipmap(n);r.bindTexture(n,null);a.width=t;a.height=p}else if("ENVIRONMENT_MAP"==g)if(p=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],G){for(t=0;6>t;t++)r.texImage2D(r["TEXTURE_CUBE_MAP_"+p[t][0]],0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1);
if(b.width%3||b.height%2){v.error('Cubemap texture "'+d+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}t=b.width/3;if(t>D.qi)v.warn('Cubemap texture "'+d+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*D.qi+"x"+2*D.qi+". Reduced image size will be used."),d=h(D.qi/t*t),a.de=!0;else if(d=h(t),3*d>D.ub||2*d>D.ub)a.de=!0;if(a.de)for(k=d,G=0;6>G;G++)c=p[G],e=m(),e.width=k,e.height=k,g=e.getContext("2d"),
"POSITIVE_Y"==c[0]||"NEGATIVE_Y"==c[0]?(g.translate(0,k),g.scale(1,-1)):(g.translate(k,0),g.scale(-1,1)),g.drawImage(b,c[1]*t,c[2]*t,t,t,0,0,k,k),r.texImage2D(r["TEXTURE_CUBE_MAP_"+c[0]],0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e);else{p=b;b=d;l(r.TEXTURE_2D);r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,p);r.bindTexture(r.TEXTURE_2D,null);for(p=0;6>p;p++)r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+p,0,r.RGBA,b,b,0,r.RGBA,r.UNSIGNED_BYTE,null);r.bindTexture(a.xb,null);r.bindFramebuffer(r.FRAMEBUFFER,
M);for(p=0;6>p;p++)q.GA(a,r.TEXTURE_CUBE_MAP_POSITIVE_X+p,b,t,C,p);r.bindFramebuffer(r.FRAMEBUFFER,null);r.bindTexture(a.xb,a.Qa);r.texParameteri(a.xb,r.TEXTURE_MIN_FILTER,K[D.Pk]);r.texParameteri(a.xb,r.TEXTURE_MAG_FILTER,r.LINEAR)}a.width=3*d;a.height=2*d;r.generateMipmap(n)}else"DATA_TEX2D"==g&&(r.texImage2D(n,0,r.RGBA,b.width,b.height,0,r.RGBA,r.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);r.bindTexture(n,null)};a.BA=function(a){r.deleteTexture(a)};a.ok=function(a){return a&&a.name&&
(a.Qa||a.fg)?!0:!1};a.Wt=function(a){return a&&a.name&&a.fg?!0:!1};a.FI=function(b){return b.type==a.hl||b.type==a.il?!0:!1};a.UB=function(b){var c=0;switch(b.type){case a.Jh:case a.zn:c=4;break;case a.hl:case a.il:c=16;break;case a.nj:c=3;break;case a.Ih:c=2}return c};a.tB=function(a){var c=null,c={name:"special_ssao_texture",type:"DATA_TEX2D",extension:"REPEAT",b4w_anisotropic_filtering:"OFF"};b(c,null,a,0);c.image={filepath:null};return c};a.cleanup=function(){if(!D.Ik)for(var a in E)for(var b in E[a])E[a][b].L.pause(),
E[a][b].L.src="",E[a][b].L.load();G={};E={}};a.pause=function(){for(var a in E)for(var b in E[a]){var c=E[a][b];x(c)&&(k(b,a),c.pn=!0)}};a.reset=function(){for(var a in E)for(var b in E[a])n(b,a),E[a][b].pn=!1};a.play=function(a){for(var b in E)for(var c in E[b]){var d=E[b][c];if(!a||d.pn)g(c,b),d.pn=!1}};a.jr=function(a,b){return b in E&&a in E[b]?E[b][a].ln:!1};a.play_video=g;a.pause_video=k;a.reset_video=n;a.Ki=function(a,b,c){c in E&&a in E[c]&&(a=E[c][a],a.L?a.L.currentTime=b/a.ae:a.pc&&(a.rh=
b))};a.yw=x;a.zw=function(a){return a.L||a.pc?a.L?2<=a.L.readyState:!0:0};a.ww=function(a){return a.L||a.pc?a.L?Math.round(a.L.currentTime*a.ae):a.rh:0};a.vG=function(a){return a.L||a.pc?a.L?a.Ea:I(a,a.Ea):0};a.uG=function(a){if(!a.L&&!a.pc)return 0;var b=Math.min(a.ai,a.wi-a.Ea);return a.L?a.Ea+b:I(a,a.Ea+b)};a.kv=function(a,b){return Math.round(F.Nb()/a.ae*a.rq*b)};a.xw=function(a){return Math.min(a.ai,a.wi-a.Ea)};a.vw=I};b4w.module.__assets=function(a,p){function e(){return I.lC()?p(I.lc.Al).data:null}function b(){var a={jl:null,gy:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.jl=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=e();b&&a.jl in b&&(a.status=200,b[a.jl]&&(a.response=a.gy(b[a.jl])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function c(b){for(var c=0,e=0;e<b.length;e++){var g=b[e];20===g.state&&c++;if(c>=q.dD)break;if(10===g.state)switch(g.state=20,c++,g.type){case a.AT_ARRAYBUFFER:m(g,"arraybuffer");break;case a.AT_JSON:m(g,"json");break;case a.AT_TEXT:m(g,"text");break;case a.AT_AUDIOBUFFER:f(g);break;case a.AT_IMAGE_ELEMENT:l(g);
break;case a.AT_AUDIO_ELEMENT:h(g);break;case a.cl:t(g);break;case a.bl:d(g);break;default:v.U("Wrong asset type: "+g.type)}}}function m(c,d){var f=e(),g=f&&c.url in f?new b:new XMLHttpRequest;if("GET"==c.Yc)g.open("GET",c.url,!0);else if("POST"==c.Yc)switch(g.open("POST",c.url,!0),c.lh){case a.pr:g.setRequestHeader("Content-type","text/plain");break;case a.rn:g.setRequestHeader("Content-type","application/json")}"text"==d?(g.overrideMimeType("text/plain"),g.responseType="text"):"json"==d?(g.overrideMimeType("application/json"),
g.responseType="text"):g.responseType=d;g.onreadystatechange=function(){if(40!=c.state&&4==g.readyState){if(200==g.status||0==g.status){var a=g.response;if(a){if("json"==d&&"string"==typeof a)try{a=JSON.parse(a)}catch(b){B.error(b+" (parsing JSON "+c.url+")");c.Cb(null,c.id,c.type,c.url,c.Za);return}c.Cb(a,c.id,c.type,c.url,c.Za)}else B.error("empty responce when trying to get "+c.url),c.Cb(null,c.id,c.type,c.url,c.Za)}else B.error(g.status+" when trying to get "+c.url),c.Cb(null,c.id,c.type,c.url,
c.Za);c.state=30}};g.addEventListener("progress",function(a){a.lengthComputable&&c.Su(a.loaded/a.total)},!1);g.send(c.Nf)}function f(a){"GET"!=a.Yc&&v.U("Unsupported request type for audio buffer");var c=e(),d=c&&a.url in c?new b:new XMLHttpRequest;d.open("GET",a.url,!0);d.responseType="arraybuffer";d.onreadystatechange=function(){if(40!=a.state&&4==d.readyState)if(200==d.status||0==d.status){var b=d.response;b?y.xA(b,function(b){a.Cb(b,a.id,a.type,a.url,a.Za);a.state=30},function(){a.Cb(null,a.id,
a.type,a.url,a.Za);B.error("failed to decode "+a.url);a.state=30}):(a.Cb(null,a.id,a.type,a.url,a.Za),B.error("empty responce when trying to get "+a.url),a.state=30)}else a.Cb(null,a.id,a.type,a.url,a.Za),B.error(d.status+" when trying to get "+a.url),a.state=30};d.send(a.Nf)}function l(a){"GET"!=a.Yc&&v.U("Unsupported request type for image element");var b=document.createElement("img");u.allow_cors&&(b.crossOrigin="Anonymous");b.onload=function(){40!=a.state&&(a.Cb(b,a.id,a.type,a.url,a.Za),a.state=
30)};b.addEventListener("error",function(){40!=a.state&&(a.Cb(null,a.id,a.type,a.url,a.Za),B.error("could not load image: "+a.url),a.state=30)},!1);var c=e();if(c&&a.url in c)if(c[a.url]){var d=k(a.url);b.src="data:"+d+";base64,"+c[a.url]}else A.qp()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.url}function h(a){"GET"!=a.Yc&&v.U("Unsupported request type for audio element");var b=document.createElement("audio");
if(u.allow_cors||u.Es)b.crossOrigin="Anonymous";b.addEventListener("loadeddata",function(){40!=a.state&&(a.Cb(b,a.id,a.type,a.url,a.Za),a.state=30)},!1);b.addEventListener("error",function(){40!=a.state&&(a.Cb(null,a.id,a.type,a.url,a.Za),B.error("could not load sound: "+a.url),a.state=30)},!1);var c=e();if(c&&a.url in c)if(c[a.url]){var d=n(a.url);b.src="data:"+d+";base64,"+c[a.url];40!=a.state&&(a.Cb(b,a.id,a.type,a.url,a.Za),a.state=30)}else A.qp()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",
!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.url,u.Tg&&b.load();u.Kp&&(b.autoplay=!0,b.pause());setTimeout(function(){b.PE=1},5E3)}function t(a){function b(){40!=a.state&&(a.Cb(null,a.id,a.type,a.url),B.error("could not load video: "+a.url,a.Za),a.state=30)}"GET"!=a.Yc&&v.U("Unsupported request type for video element");var c=document.createElement("video");c.muted=!0;if(u.allow_cors||u.Tg)c.crossOrigin="Anonymous";c.addEventListener("loadeddata",function(){c.removeEventListener("error",
b,!1);40!=a.state&&(a.Cb(c,a.id,a.type,a.url,a.Za),a.state=30)},!1);c.addEventListener("error",b,!1);var d=e();if(d&&a.url in d)if(d[a.url]){var f=x(a.url);c.src="data:"+f+";base64,"+d[a.url];40!=a.state&&c.addEventListener("loadeddata",function(){a.Cb(c,a.id,a.type,a.url,a.Za);a.state=30},!1)}else A.qp()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),c.dispatchEvent(d);else c.src=a.url,u.Tg&&c.load();u.Kp&&(c.autoplay=!0,c.pause());setTimeout(function(){c.PE=
1},1E4)}function d(c){function d(a){c.Cb(a,c.id,c.type,c.url,c.Za);c.state=30}"GET"!=c.Yc&&v.U("Unsupported request type for seq video element");var f=e(),h=f&&c.url in f?new b:new XMLHttpRequest;if(null==c.lh&&null==c.Nf)h.open("GET",c.url,!0);else switch(h.open("POST",c.url,!0),c.lh){case a.pr:h.setRequestHeader("Content-type","text/plain");break;case a.rn:h.setRequestHeader("Content-type","application/json")}h.responseType="arraybuffer";h.onreadystatechange=function(){if(40!=c.state&&4==h.readyState)if(200==
h.status||0==h.status){var a=h.response;a?g(a,d):(c.Cb(null,c.id,c.type,c.url,c.Za),B.error("empty responce when trying to get "+c.url),c.state=30)}else c.Cb(null,c.id,c.type,c.url,c.Za),B.error(h.status+" when trying to get "+c.url),c.state=30};h.addEventListener("progress",function(a){a.lengthComputable&&c.Su(a.loaded/a.total)},!1);h.send(c.Nf)}function g(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],ds:[],ae:c[4]},g=20,h=0;h<e;h++){var k=c[g/4],l=new Blob([d.subarray(g+
4,g+4+k)],{type:"image/jpg"}),n=document.createElement("img");n.src=window.URL.createObjectURL(l);f.images.push(n);f.ds.push(l);g+=k+8-k%4}n.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.ds;b(f)}}function k(a){var b="image";switch(v.Yo(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function n(a){var b="audio";switch(v.Yo(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";
break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function x(a){var b="video";switch(v.Yo(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var I=p("__config"),A=p("__compat"),B=p("__print"),y=p("__sfx"),v=p("__util"),F=p("__version"),u=I.q,q=I.Sd;a.AT_ARRAYBUFFER=10;a.AT_JSON=20;a.AT_TEXT=30;a.AT_AUDIOBUFFER=40;a.AT_IMAGE_ELEMENT=50;a.AT_AUDIO_ELEMENT=60;a.cl=70;a.bl=80;a.rn=a.AT_JSON;a.pr=a.AT_TEXT;var D=[],w=0,J={};
a.Lk=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.mI=function(a){if(J[a])return J[a];var b=q.bq?a+F.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return J[a]=b;v.U("Error XHR: responce is empty, GET "+a)}else v.U("Error XHR: "+c.status+", GET "+a)};a.cleanup=function(){for(var a=0;a<D.length;a++)D[a].state=40;D=[];w=0;J={}};
a.enqueue=function(a,b,d,f){for(var g=0;g<a.length;g++){var h=a[g],h={id:h.id,type:h.type,url:h.url,Yc:h.Yc?h.Yc:"GET",lh:h.lh?h.lh:null,Nf:h.Nf?h.Nf:null,Za:h.Za?h.Za:null,state:10,Cb:b||function(){},Hu:d||function(){},Su:f||function(){},Iu:w};if(q.bq){var k=e();k&&h.url in k||(h.url+=F.timestamp())}D.push(h)}c(D);w++};a.update=function(){c(D);for(var a=D,b=0,d=!0,e=0;e<a.length;e++){var f=a[e];f.Iu===a[b].Iu?30!==f.state&&(d=!1):(d&&(a[e-1].Hu(),d=e-b,a.splice(b,d),e-=d),b=e,d=30===a[e].state?!0:
!1);e===a.length-1&&d&&(a[e].Hu(),a.splice(b))}}};b4w.module.__loader=function(a,p){function e(c,d,e,f){var g=y,h=I.create(),l;for(l in d){var n=b(d[l]);(f&&n.gb||!c&&n.vb)&&k(n);I.u(h,n)}for(l in d)for(n=d[l],n.name=l,c=0;c<n.C.length;c++)I.n(h,d[n.C[c]],n,null);d=b({name:"out",Ta:a.Nw,lb:function(a,b,c,d,e){b.Ka&&(g.Fq=!0);x(b)||(b.status=2);b.ju(b.id,!0);e(b,c);A.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},hb:5});if(e)e=I.$o(h);else{l=I.clone(h);do{e=I.$o(l);n=[];for(c=0;c<e.length;c++){f=e[c];var m=I.Ja(l,f);m.eb&&n.push(f)}for(c=
0;c<n.length;c++)I.Qf(l,n[c]);n.length&&I.Cz(l)}while(n.length)}I.u(h,d);for(c=0;c<e.length;c++)f=e[c],m=I.Ja(h,f),d.C.push(m.name),I.n(h,m,d,null);return h}function b(a){a.eb=a.eb||!1;a.Ta||0===a.Ta||(a.Ta=a.rc);a.C=a.C||[];a.kk=a.kk||!1;a.xq=a.xq||!1;a.hb=a.hb||0;a.gb=a.gb||!1;a.vb=a.vb||!1;a.status=0;a.OI=0;a.Bp=0;a.xj=a.xj||null;return a}function c(a,b){for(var c=[],d=[],e=0;e<b.length;e++){var f=b[e];I.Ja(a.je,f).kk&&(I.ag(a.je,f,function(d){var e=!0;I.af(a.je,d,function(a,b){if(!b.kk)return e=
!1,1});e&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(e))}for(e=d.length-1;0<=e;e--)b.splice(d[e],1);return c}function m(a){function b(c,d){var e=I.Ja(a.je,c),f=I.Ja(a.je,d),g=f.Ta-e.Ta;0==g&&(g=e.eb-f.eb);return g}var d=[],e=a.Ze,f=!1;do{var g=c(a,e);d.push.apply(d,e);0<g.length&&(f=!0);e=g}while(0<g.length);f&&d.sort(b);a.Ze=d;return a.Ze.length}function f(a,b,c){if(b.xq)return b.kk=!0,h(a,b),!1;if(!b.lb&&!b.nf&&!b.wj)return h(a,b),!1;if(0==b.status&&(b.status++,b.lb))return b.lb(c,a,
b,b.xj,h,t),!0;if(1==b.status){if(b.nf)return b.nf(c,a,b,b.xj,h,t),!0;b.status++}return 2==b.status&&(b.status++,b.wj)?(b.wj(c,a,b,b.xj,h,t),!0):!1}function l(a){if(0==a.Zm)return 100;var b=0;I.W(a.je,function(c,d){a.do_not_load_resources&&d.gb||(b+=d.Bp*d.hb)});return B.trunc(100*b/a.Zm)}function h(a,b){b.kk=!0;b.status=3;d(a,b,1)}function t(a,b,c){1>c?d(a,b,c):b.status++}function d(a,b,c){var d=y;if(b.lb||b.nf||b.wj)if(b.Bp=c,b=l(a),a.Ms!=b||1==c)a.Eq(b,performance.now()-a.Xv),a.Ms=b,d.Ep=!0}function g(a,
b){var c=null;I.W(a.je,function(a,d){if(d.name==b)return c=d,1});return c}function k(a){a.xq=!0;a.Bp=1}function n(a){a.Eq=null;a.jo=null;a.je=null;a.Ze=null}function x(a){return a&&(3==a.status||4==a.status)}var I=p("__graph"),A=p("__print"),B=p("__util");a.rc=0;a.lg=1;a.Nw=2;var y=null;a.Ct=function(){return y};a.dA=function(){var a={me:[],vo:0,kl:0,Fq:!1,Ep:!1};return y=a};a.lA=function(a,b,c,d,f,g,h,k){var l=y,n=l.me.length,m={id:n,Ka:0==n,status:0,He:b,bs:"",ju:c||function(){},iu:k||!1,sJ:g,Xv:0,
Ms:0,Zm:0,jq:!1,Eq:d||function(){},jo:f||function(){},je:null,Ze:null,ip:!1,gp:!1,mp:!1};a=e(m.Ka,a,g,h);m.je=a;b=[];c=I.RB(a);for(d=0;d<c.length;d++)b.push(c[d]);m.Ze=b;I.W(a,function(a,b){!(b.lb||b.nf||b.wj)||m.do_not_load_resources&&b.gb||(m.Zm+=b.hb)});l.me.push(m);l.kl++;return m.id};a.VF=function(b){var c=y;if(c&&0!=y.kl)if(c.Ep)c.Ep=!1;else{var d=performance.now();do{var e=c.me[c.vo],g=b[e.id];if(!x(e))if(0==e.status&&(e.status=1,e.Xv=performance.now(),e.Eq(0,0)),m(e)){var h=e,k=h.Ze.length;
do{var l=I.Ja(h.je,h.Ze[0]),t=f(h,l,g);l.Ta==a.lg&&(h.jq=!0);l=h.Ze.shift();h.Ze.push(l);k--}while(!t&&0!=k)}else h=c,k=e,k.jo(g,k),k.status=3,h.kl--,n(k);c.Fq&&(c.vo=(c.vo+1)%c.me.length);if(e.jq){e.jq=!1;break}}while(16>performance.now()-d)}};a.Jr=function(a){var b=y;a.jo(null,a);a.status=3;b.kl--;n(a);a.status=4;a.Ka&&(b.Fq=!0);a.ju(a.id,!1)};a.kJ=t;a.Xm=function(a,b){var c=g(a,b);null!==c&&k(c)};a.oF=x;a.is_primary_loaded=function(a){var b=y;if(!b)return!1;a|=0;return b.me[a]&&(3==b.me[a].status||
2==b.me[a].status)};a.$B=function(){A.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.cleanup=function(){y=null}};b4w.module.__logic_nodes=function(a,p){function e(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];for(var f=0;f<c.iv;f++)if(g.get_sensor_value(a,b,f)&&f==c.hv){if(e.yi&&e.zi==c.mF)c.state=-1;else if(!d.$f.Qn||c.md.no_wait)c.state=1;return}c.state=0}}function b(a,b,c){switch(b.state){case 1:h.error("Unknown node type: "+a.type);break;case 2:c.Ca=a.Va}}function c(a){var b=d.get("url_params");if(b&&a in b)return Number(b[a]);b=location.href.toString();if(-1==b.indexOf("?"))return 0;for(var b=b.split("?")[1].split("&"),
c=0;c<b.length;c++){var e=b[c].split("=");if(1<e.length&&e[0]==a)return Number(e[1])}return 0}function m(a){return f.ic(f.jd,a.Fo,0)}var f=p("__objects"),l=p("__scenes"),h=p("__print"),t=p("__nla"),d=p("__config"),g=p("__controls"),k=p("__util"),n=p("__animation"),x=p("__assets"),I=p("__batch"),A=p("__geometry"),B=p("__time"),y=p("__camera"),v=p("__vec3");p("__vec4");var F=p("__transform"),u=p("__sfx"),q=[],D=new Float32Array(3),w=new Float32Array(3),J=new Float32Array(2),C={ENTRYPOINT:function(a,
b,c){switch(b.state){case 2:c.Ca=a.Va}},HIDE:function(a,b,c){switch(b.state){case 1:a.obj=m(a);break;case 2:l.hide_object(a.obj),c.Ca=a.Va}},SHOW:function(a,b,c){switch(b.state){case 1:a.obj=m(a);break;case 2:l.show_object(a.obj),c.Ca=a.Va}},PAGEPARAM:function(a,b,d){switch(b.state){case 2:d.wb[a.Bh]=c(a.vD),d.Ca=a.Va}},SELECT:function(a,b,c){switch(b.state){case 1:c=b.Yg[c.nF];var d=m(a),k=f.QB(),l=k.indexOf(d);if(-1==l)h.error("logic script error: non-selectable object:",a.Fo[a.Fo.length-1]);else{a.state=
-1;a.iv=k.length;a.hv=l;for(var l=[],n=0;n<k.length;n++)l.push(g.create_selection_sensor(k[n],!0));g.create_sensor_manifold(d,"LOGIC_NODES_SELECT_"+a.label,g.CT_SHOT,l,g.yA,e(),[a,b,c])}break;case 2:if(-1<a.state){c.Ca=a.state?a.Bv:a.Va;a.state=-1;break}a.md.not_wait&&(c.Ca=a.Va)}},PLAY:function(a,b,c,d,e,f){switch(b.state){case 1:b.qu=!1;break;case 2:if(b.yi&&!a.hk){if(b.so==b.zi)break;b.yi=!1;for(e=0;e<b.Yg.length;e++){var g=b.Yg[e];g==b.zi&&(g.$f.Ca=g.J[g.$f.Ca].Va)}e=b.zi.J;for(g=0;g<e.length;g++)e[g].hk=
!1}d=t.cz(b.na.X,d,!1,f);a.hk?d>=a.Z&&(a.hk=!1,b.yi=!1,b.zi=null,c.Ca=a.Va):(t.lv(b.na,t.vt(b.na)+(a.I-d)),a.hk=!0,b.zi=b.so,b.yi=!0)}},REDIRECT:function(a,b){switch(b.state){case 2:window.location.href=a.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:b=-1==a.nn?a.Rp:c.wb[a.nn];var d=-1==a.on?a.yu:c.wb[a.on];switch(a.tD){case "ADD":c.wb[a.Bh]=b+d;break;case "MUL":c.wb[a.Bh]=b*d;break;case "SUB":c.wb[a.Bh]=b-d;break;case "DIV":0==d&&k.U("Division by zero in Logic script");c.wb[a.Bh]=b/
d;break;case "RAND":c.wb[a.Bh]=Math.random()*(d-b)+b}c.Ca=a.Va}},CONDJUMP:function(a,b,c){switch(b.state){case 2:b=-1==a.nn?a.Rp:c.wb[a.nn];var d=-1==a.on?a.yu:c.wb[a.on],e=!1;switch(a.Gz){case "EQUAL":b==d&&(e=!0);break;case "NOTEQUAL":b!=d&&(e=!0);break;case "LESS":b<d&&(e=!0);break;case "GREATER":b>d&&(e=!0);break;case "LEQUAL":b<=d&&(e=!0);break;case "GEQUAL":b>=d&&(e=!0)}c.Ca=e?a.Bv:a.Va}},REGSTORE:function(a,b,c){switch(b.state){case 2:c.wb[a.Bh]=a.Rp,c.Ca=a.Va}},PLAY_ANIM:function(a,b,c){var d=
n.SLOT_ALL;""==!a.Bd&&(d=n.SLOT_0);switch(b.state){case 1:a.obj=m(a);break;case 2:switch(n.is_play(a.obj,d)||0!=a.state||(a.state=1),a.state){case -1:""==a.Bd?n.apply_def(a.obj):n.apply(a.obj,a.Bd,d);a.md.not_wait||(c.Qn=!0);n.set_behavior(a.obj,n.AB_FINISH_STOP,d);n.set_first_frame(a.obj,d);n.play(a.obj,null,d);a.state=0;break;case 0:a.md.not_wait&&(c.Ca=a.Va,a.state=-1);break;case 1:a.md.not_wait||(c.Qn=!1);c.Ca=a.Va;a.state=-1;break;default:a.state=-1}}},SELECT_PLAY:function(a,b,c){switch(b.state){case 2:c.Ca=
a.Va}},SEND_REQ:function(a,b,c){function d(a,b,c,e,f){for(var g in a)for(var h in f[0].Ju)g==f[0].Ju[h]&&(f[1][g]=a[g]);f[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;if("GET"==a.Hj.request_type)x.enqueue([{id:a.url,type:x.AT_JSON,url:a.url,Za:[a,c.wb]}],d,null,null);else if("POST"==a.Hj.request_type){b={};for(var e=0;e<a.jv.length;e++){var f=a.jv[e];b[f]=c.wb[f]}x.enqueue([{id:a.url,type:x.AT_JSON,url:a.url,Yc:"POST",lh:x.rn,Nf:JSON.stringify(b),Za:[a,c.wb]}],d,null,null)}break;
case 1:a.state=-1,c.Ca=a.Va}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.pb["id"+b]=f.ic(f.jd,a.Re["id"+b],0);break;case 2:I.inherit_material(a.pb.id0,a.Fp.id0,a.pb.id1,a.Fp.id1),c.Ca=a.Va}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.Re.id0&&(a.pb.id0=f.ic(f.jd,a.Re.id0,0),a.Qp.id0.unshift(a.Fp.id0));break;case 2:"ShaderNodeRGB"==a.rv&&f.set_nodemat_rgb(a.pb.id0,a.Qp.id0,a.md.id0?c.wb[a.Ch.id0]:a.Lg.id0,a.md.id1?c.wb[a.Ch.id1]:a.Lg.id1,a.md.id2?c.wb[a.Ch.id2]:
a.Lg.id2),"ShaderNodeValue"==a.rv&&f.set_nodemat_value(a.pb.id0,a.Qp.id0,a.md.id0?c.wb[a.Ch.id0]:a.Lg.id0),c.Ca=a.Va}},DELAY:function(a,b,c,d,e){switch(b.state){case 2:-1==a.state?(a.state=0,a.bn=0):0==a.state&&(a.bn+=e,(a.md.dl?c.wb[a.Ch.dl]:a.Lg.dl)<a.bn&&(a.state=-1,c.Ca=a.Va))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.pb.id0=f.ic(f.jd,a.Re.id0,0);c=a.Hj.sk;A.check_shape_keys(b)?A.hp(b,c)||(h.error("Wrong key name:",c),a.mute=!0):(h.error("No shape keys in object:",b.name),a.mute=
!0);break;case 2:A.Sr(a.pb.id0,a.Hj.sk,a.md.skv?c.wb[a.Ch.skv]:a.Lg.skv),c.Ca=a.Va}},OUTLINE:function(a,b,c){switch(b.state){case 1:b=a.pb.id0=f.ic(f.jd,a.Re.id0,0);b&&b.f&&b.f.Ab||(h.error("Can't evaluate 'Outline' logic node: wrong object"),a.mute=!0);break;case 2:b=a.pb.id0;switch(a.Hj.outline_operation){case "PLAY":var d=b.f.Ci;f.apply_outline_anim(b,d.Di,d.Ei,d.Fi);break;case "STOP":f.clear_outline_anim(b);break;case "INTENSITY":b.f.If=a.md["in"]?c.wb[a.Ch["in"]]:a.Lg["in"]}c.Ca=a.Va}},MOVE_CAMERA:function(a,
b,c){switch(b.state){case 1:a.pb.ca=f.ic(f.jd,a.Re.id0,0);a.pb.tr=f.ic(f.jd,a.Re.id1,0);a.pb.ta=f.ic(f.jd,a.Re.id2,0);break;case 2:b=a.pb.ca;var d=a.pb.tr.f.i,e=a.pb.ta.f.i;switch(y.get_move_style(b)){case y.MS_TARGET_CONTROLS:y.set_trans_pivot(b,d,e);break;case y.MS_EYE_CONTROLS:case y.MS_STATIC:y.set_look_at(b,d,e,k.AXIS_Y);break;case y.MS_HOVER_CONTROLS:v.sub(e,d,D),v.normalize(D,D),y.set_hover_pivot(b,e),e=d=0,w[0]=D[0],w[1]=0,w[2]=D[2],d=v.dot(w,D),e=Math.acos(d/(v.length(w)*v.length(D))),d=
D[2]?Math.atan(D[0]/D[2]):0<D[0]?0:Math.PI,0<D[2]&&0<D[0]?J[1]=-(Math.PI+J[1]):0<D[2]&&0>D[0]?J[1]=-(Math.PI+J[1]):0>D[2]&&0>D[0]?(J[0]+=Math.PI,d=-(Math.PI-d)):0>D[2]&&0<D[0]&&(J[0]+=Math.PI,d-=Math.PI),y.rotate_hover_camera(b,d+Math.PI,-e,!0,!0),F.o(b)}c.Ca=a.Va}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 1:a.Yv=y.kD(a.common_usage_names.camera_move_style);break;case 2:y.set_move_style(l.di(c.na),a.Yv),c.Ca=a.Va}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.pb.id0=f.ic(f.jd,
a.Re.id0,0);break;case 2:u.play_def(a.pb.id0),c.Ca=a.Va}}};a.gC=function(a,c){var d={uc:c,jE:a.name,state:0,yi:!1,qu:!0,zi:null,na:a,so:null,Yg:[]};a.gH=d;var e=a.b4w_logic_nodes,f=d.Yg;d.state=1;for(var g=0;g<e.length;g++){var h={J:[],$f:{na:a,Ca:0,Qn:!1,nF:g,wb:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};f.push(h);for(var k=f[f.length-1],l=e[g],n=0;n<l.length;n++){var m=l[n],m={type:m.type,label:m.label,Va:m.slot_idx_order,Bv:m.slot_idx_jump,I:m.frame_range[0],Z:m.frame_range[1],hk:!1,state:-1,
iv:-1,hv:-1,Gz:m.condition,nn:m.variable1,on:m.variable2,Rp:m.number1,yu:m.number2,Bh:m.variabled,url:m.url,vD:m.param_name,tD:m.operation,mute:m.mute,Fo:m.object,obj:null,pb:{},Bd:m.anim_name,Ju:m.parse_resp_list,Re:m.objects_paths,Qp:m.nodes_paths,Lg:m.floats,md:m.bools,Ch:m.variables,Fp:m.materials_names,rv:m.shader_nd_type,Hj:m.common_usage_names,jv:m.send_req_vars_list,mF:k,Ru:C[m.type]?C[m.type]:b,Km:!1,bn:0,Yv:0};k.J.push(m)}for(l=0;l<k.J.length;l++)m=k.J[l],m.Ru(m,d,h.$f,0,0)}d.state=2;q.push(d)};
a.update=function(a,b){var c=t.TB();if(!(0>=c))for(var d=0;d<q.length;d++){for(var e=d,f=a,g=b,h=c,k=q[e],l=0;l<q[e].Yg.length;l++){k.so=q[e].Yg[l];var n=q[e].Yg[l],m=k,p=f,u=g,x=h,v=n.J;if(v.length){for(var w=0;w<v.length;w++)v[w].Km=!1;for(w=0;w<v.length;w++){if(0<=n.$f.Ca)var D=v[n.$f.Ca];else break;if(D.Km)break;if(D.mute)if("ENTRYPOINT"==D.type)break;else n.$f.Ca=D.Va,D.Km=!0;else D.Ru(D,m,n.$f,p,u,x),D.Km=!0}}}k.yi||k.qu||t.lv(k.na,t.vt(k.na)-B.Nb()*g)}};a.cleanup=function(){q=[]}};b4w.module.__nla=function(a,p){function e(a){a.L.WI=function(){y.ar(a)}}function b(){return{type:"CLIP",I:0,Z:0,Ue:!1,paused:!1,Bd:"",rj:"",Yb:0,og:0,pj:0,Zs:0,Ys:0,lw:!1,scale:1,repeat:1}}function c(a,b){if(a.animation_data){var d=a.animation_data.nla_tracks;if(d)for(var e=0;e<d.length;e++)b.push(d[e])}d=a.nodes;for(e=0;e<d.length;e++){var f=d[e];f.node_group&&(f=f.node_group.node_tree)&&c(f,b)}}function m(a,b){var c=Math.round(a)-b.I;b.dj&&(c%=b.ai,0>c&&(c+=b.ai));return b.Ea+c}function f(a,b,c,
d){b=(b-d)*v.Nb()+a.Ea;b>a.I&&(b-=a.I,a.cyclic&&c&&(b%=a.Z-a.I+1),b+=a.I);return b}function l(a,b){a=F.clamp(a,b.I,b.Z);var c=a-b.I,d=(b.Z-b.I)/b.repeat,c=c/d&&0==c%d?b.pj:b.og+c%d/b.scale;b.lw&&(c=b.pj-c+b.og);return c}function h(a,c){for(var d=[],e=0;e<a.length;e++){var f=a[e].strips;if(f)for(var g=0;g<f.length;g++){var h=f[g],k=b();k.type=h.type;k.I=h.frame_start;k.Z=h.frame_end;k.Yb=c;k.og=h.action_frame_start;k.pj=h.action_frame_end;k.lw=h.use_reverse;k.scale=h.scale;k.repeat=h.repeat;h.action&&
(k.Bd=h.action.name,k.rj=h.action.uuid);d.push(k)}}return d}function t(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function d(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}function g(a,b){var c=
A.get_active();c.X&&(c.X.Ea-=f(c.X,b,!0,q)-a,c.X.Yj=!0)}var k=p("__animation");p("__camera");p("__controls");p("__config");p("__lights");p("__loader");var n=p("__objects"),x=p("__obj_util"),I=p("__print"),A=p("__scenes"),B=p("__sfx"),y=p("__textures"),v=p("__time"),F=p("__util"),u=[],q=-1;a.wh=function(a,d){var e;e=null;for(var f=d.V.length-1;0<=f;f--){var g=d.V[f];if(g.na.b4w_use_nla&&(e=g,g.na.Hr))break}if(e){e.Bu=!0;var l=0;if((f=a.animation_data)&&f.nla_tracks.length){var n=f.nla_tracks;if(x.is_armature(d)||
x.is_camera(d)||x.is_mesh(d)||x.is_empty(d)||x.is_lamp(d)||x.is_speaker(d))n=h(n,l),n.length&&(d.wd=d.wd.concat(n),l++)}t(a)&&(n=a.data.animation_data.nla_tracks,n=h(n,l),n.length&&(d.wd=d.wd.concat(n),l++));if(x.is_mesh(d))for(g=a.data.materials,f=0;f<g.length;f++){var r=g[f];if(r.use_nodes&&r.node_tree&&(n=[],c(r.node_tree,n),n=h(n,l),n.length)){for(var r=l,m=n,q=k.nt(),p=[],u=0,v=0;v<m.length;v++){var y=m[v];""!=y.rj?y=F.keysearch("uuid",y.rj,q):(y=y.Bd,y=F.keysearch("name",y,q)||F.keysearch("name",
y+"_B4W_BAKED",q));if(y){var y=y.fcurves,A=[],B;for(B in y)A.push(B);p.push(A)}}for(v=0;v<p.length;v++){q=!1;for(y=0;y<v;y++)if(F.Jy(p[v],p[y])){m[v].Yb=m[y].Yb;q=!0;break}q||(m[v].Yb=l+u++)}l=r+u;d.wd=d.wd.concat(n)}}for(f=0;f<a.particle_systems.length;f++)g=a.particle_systems[f],B=g.settings,"EMITTER"==B.type&&B.b4w_allow_nla&&(B=b(),B.type="CLIP",B.I=e.na.frame_start,B.Z=e.na.frame_end+1,B.Bd=g.name,B.Yb=l,B.og=B.I,B.pj=B.Z,d.wd.push(B),l++);g=l+1;for(f=0;f<d.Wb.length;f++)n=d.Wb[f],n.hy&&(l=g,
B=b(),B.type="CLIP",B.I=e.na.frame_start,B.Z=e.na.frame_end+1,B.Bd=n.name,B.Yb=l,B.og=B.I,B.pj=B.Z,d.wd.push(B))}};a.UF=function(a,c,d){a.X||(a.X={I:a.frame_start,Z:a.frame_end,Ea:0,pk:-1,Om:a.frame_end,fq:a.frame_start,gj:null,cyclic:c,pb:[],T:[],jE:a.name,Bf:!1,Yj:!1,kq:!0});c=a.X;for(var f=n.PB(a,d),g=0;g<f.length;g++){var h=f[g];if(h.wd.length){for(var k=0;k<h.V.length;k++){var l=h.V[k];l.na==a&&l.Bu&&c.pb.push(h)}for(var k=h.wd,l=c,m=h.name,q=0;q<k.length;q++){var t=k[q],p=m+" ["+t.I+":"+t.Z+
"]",x=Math.max(l.I,t.I);t.og+=x-t.I;t.I=x;t.Z=Math.min(l.Z+1,t.Z);t.I>t.Z?(I.warn("NLA: out of scene range: "+p),k.splice(q,1),q--):t.Bd||"CLIP"!=t.type||(I.warn('NLA: no action in strip for object "'+m+'".'),k.splice(q,1),q--)}h=h.wd;k=c;for(l=0;l<h.length;l++){m=h[l];q=k.I;t=k.Z+1;for(p=0;p<h.length;p++)x=h[p],m.Yb==x.Yb&&(x.Z<=m.I&&(q=m.I),x.I>=m.Z&&(t=Math.min(t,x.I)));m.Zs=q;m.Ys=t}}}a=a.j.ij;for(g=0;g<a.length;g++)f=a[g].j,f.ln&&(f.L||f.pc)&&f.fc==d&&(h=b(),h.type="VIDEO",f.dj?(h.I=0,h.Z=c.Z):
(h.I=F.clamp(f.I,0,c.Z),h.Z=F.clamp(f.I+f.ai,0,c.Z)),h.Bd=a[g].name,f.fy=h,c.T.push(f),f.L&&e(f));u.push(c)};a.start=function(){q=0};a.TB=function(){return q};a.vt=function(a){return a.X?a.X.Ea:null};a.lv=function(a,b){a.X&&(a.X.Ea=b)};a.update=function(a,b){if(!(0>q)){0==q&&(q=a);for(var c=0;c<u.length;c++){var d=u[c];d.Bf&&(d.Ea-=v.Nb()*b);var e=f(d,a,!0,q);if((!d.Bf||d.Yj)&&e>=d.Om)if(d.cyclic){var e=d,h=a;e.gj&&e.gj();g(e.fq,h);e.kq=!0;e=f(e,h,!0,q)}else{var h=d,n=e;h.Bf=!0;h.Ea-=n-h.Om;h.gj&&
h.gj()}if(!d.Bf||d.Yj){for(var h=d,n=e,r=0;r<h.pb.length;r++){for(var t=h.pb[r],p=t.wd,x=0;x<p.length;x++){var A=p[x];"SOUND"==A.type&&n<h.pk-1E-6&&(A.Ue=!1)}for(x=0;x<p.length;x++)switch(A=p[x],A.type){case "CLIP":if(A.Zs<=n&&n<A.Ys&&!A.Ue){var I=t,X=A;""!=X.rj?k.Dy(I,X.rj,X.Yb):k.apply(I,X.Bd,X.Yb);k.set_behavior(I,k.AB_FINISH_STOP,X.Yb);var fa=l(X.I,X);k.set_frame(I,fa,X.Yb);for(I=0;I<p.length;I++)p[I]!=A&&p[I].Yb==A.Yb&&(p[I].Ue=!1);A.Ue=!0}A.Ue&&(I=t,X=l(n,A),fa=k.get_current_frame_float(I,A.Yb),
1E-6<Math.abs(X-fa)&&k.set_frame(I,X,A.Yb));break;case "SOUND":(n<h.pk-1E-6||h.pk<A.I)&&A.I<=n&&n<A.Z&&!A.Ue&&(B.play(t,(A.I-n)/v.Nb(),(A.Z-A.I)/v.Nb()),A.Ue=!0),h.pk<A.Z&&A.Z<=n&&A.Ue&&(A.Ue=!1)}}h=a;n=d;r=e;for(t=0;t<n.T.length;t++)if(p=n.T[t],p.L||p.pc){A=!1;I=F.clamp(m(r,p),p.Ea,p.Ea+y.xw(p)-1);x=y.vw(p,I);x==p.sq&&x--;if(n.Yj||n.kq)p.L?y.Ki(p.name,I,p.fc):y.Ki(p.name,x,p.fc),A=!0;if(!n.Bf){p.dj&&(p.L?I==p.Ea&&(y.Ki(p.name,p.Ea,p.fc),A=!0):(X=y.vw(p,p.Ea),x==X&&(y.Ki(p.name,x,p.fc),A=!0)));var X=
m(r,p),X=p.Ea<=X&&X<=p.Ea+y.xw(p),fa=y.yw(p),Q=y.ww(p);fa||(p.L?I!=Q&&y.Ki(p.name,I,p.fc):x!=Q&&(y.Ki(p.name,x,p.fc),A=!0));X&&!fa?y.play_video(p.name,p.fc):X&&fa?A=!0:!X&&fa&&(p.L?Math.round(p.L.currentTime*p.ae)<I?A=!0:y.pause_video(p.name,p.fc):y.pause_video(p.name,p.fc))}y.zw(p)&&A&&(p.L?y.ar(p):(A=y.kv(p,h),A!=p.Rm&&(p.rh=x,y.gw(p)),p.Rm=A))}d.pk=e}d.Yj=!1;d.kq=!1}}};a.cz=f;a.cleanup=function(){u.length=0;q=-1};a.fs=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||t(a)||d(a)?
!0:!1};a.set_frame=g;a.get_frame=function(a){var b=A.get_active();return b.X?f(b.X,a,!0,q):-1};a.cF=function(){var a=A.get_active();a.X&&(a.X.Bf=!0);for(var a=a.X.T,b=0;b<a.length;b++){var c=a[b];y.pause_video(c.name,c.fc)}};a.GD=function(a){var b=A.get_active();b.X&&(b.X.Bf=!1,b.X.gj=a?a:null)};a.get_frame_start=function(){var a=A.get_active();return a.X?a.X.I:-1};a.get_frame_end=function(){var a=A.get_active();return a.X?a.X.Z:-1};a.is_play=function(){var a=A.get_active();return a.X?!a.X.Bf:!1};
a.check_nla=function(){var a=A.get_active();return a.X?a.b4w_use_nla:!1};a.check_logic_nodes=function(){var a=A.get_active();return a.X?0<a.b4w_logic_nodes.length:!1};a.set_range=function(a,b){var c=A.get_active();if(c.X)c.X.fq=a,c.X.Om=b;else return!1};a.reset_range=function(){var a=A.get_active();if(a.X)a=a.X,a.fq=a.I,a.Om=a.Z;else return!1};a.set_cyclic=function(a){var b=A.get_active();if(b.X)b.X.cyclic=a;else return!1};a.clear_callback=function(){var a=A.get_active();a.X&&(a.X.gj=null)}};b4w.module.__camera=function(a,p){function e(b){b=b.f;switch(b.La){case a.MS_TARGET_CONTROLS:b.ji=W.dist(b.i,b.ac);b.ki=b.R[0].top;break;case a.MS_HOVER_CONTROLS:b.rb&&(b.ji=W.dist(b.i,b.kc),b.ki=b.R[0].top)}}function b(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),ob:new Float32Array([0,0,0,0]),mb:new Float32Array([0,0,0,0])}}function c(b){switch(b){case "STATIC":return a.MS_STATIC;case "TARGET":return a.MS_TARGET_CONTROLS;
case "EYE":return a.MS_EYE_CONTROLS;case "HOVER":return a.MS_HOVER_CONTROLS;default:throw"Unknown move style";}}function m(c){var d={type:c,name:"",Oi:1,width:0,height:0,Ie:null,zb:null,pd:null,Na:0,Rc:0,ob:0,mb:0,left:0,right:0,top:0,bottom:0,vf:new Float32Array(3),bt:new Float32Array(3),quat:new Float32Array(4),za:new Float32Array(16),wH:new Float32Array(16),Ga:new Float32Array(16),jj:new Float32Array(16),ND:new Float32Array(16),ge:new Float32Array(16),sv:new Float32Array(16),Od:new Float32Array(16),
dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,Ce:null,dof_on:0,ak:b(),Ok:0,ke:0,mc:null,Kj:null,qo:null,Js:new Float32Array(4),Gm:new Float32Array(4)};if(c==a.Jb)return d;switch(c){case a.Xb:t(d,40,.1,1E3);break;case a.kd:t(d,2.5,.1,1E3);break;case a.qe:break;case a.gf:break;case a.mg:break;case a.Kb:case a.Pb:throw"Stereo camera may only be created from perspective one";default:throw"Unknown camera type";}return d}function f(b,c,d){if(b.type!=a.Kb&&b.type!=a.Pb)throw"set_stereo_params(): wrong camera type";
b.Ok=c;b.ke=d;D(b,b.Na);if(ha.ka()&&(c=ha.get_active(),b=c.j.ec))for(c=ha.di(c).f.R,d=0;d<c.length;d++)G(c[d],b)}function l(a,b){return h(a.f.quat,b)}function h(a,b){var c=R.quat_to_dir(a,R.AXIS_Y,L),d=R.quat_to_dir(a,R.AXIS_Z,O),e=-Math.asin(c[1]/W.length(c)),c=Math.abs(e)>Math.PI/4?W.scale(d,-R.sign(e),S):W.scale(c,-R.sign(d[1]),S),f=Math.atan(Math.abs(c[0]/c[2]));0<d[1]&&(e=R.sign(e)*Math.PI-e);d=f;0>c[2]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=e;return b}function t(b,c,d,e,f){switch(b.type){case a.Xb:case a.Kb:case a.Pb:b.Rc=
c;b.Na=1;break;case a.kd:b.top=c;b.Na=1;break;case a.qe:delete b.Rc;b.Rc=c;b.Na=f/c;break;case a.gf:b.top=c;b.Na=f/c;break;default:fa.error("set_frustum(): Unsupported camera type: "+b.type)}b.ob=d;b.mb=e}function d(b,c){var d=c.f.i,e=c.f.quat,f=Y;ba.rotateX(c.f.aa,-Math.PI/2,f);ba.invert(f,b.za);if(b.mc){var f=b.mc[0],g=b.mc[1],h=b.mc[2],k=b.mc[3],l=Y;l[0]=1-2*f*f;l[1]=-2*f*g;l[2]=-2*f*h;l[3]=0;l[4]=-2*f*g;l[5]=1-2*g*g;l[6]=-2*g*h;l[7]=0;l[8]=-2*f*h;l[9]=-2*g*h;l[10]=1-2*h*h;l[11]=0;l[12]=-2*f*k;
l[13]=-2*g*k;l[14]=-2*h*k;l[15]=1;ba.multiply(b.za,l,b.za);D(b,b.Na,!0);f=oa;g=Y;ba.invert(b.za,g);ba.transpose(g,g);na.transformMat4(b.mc,g,f);g=la;g[0]=(R.sign(f[0])+b.Ga[8])/b.Ga[0];g[1]=(R.sign(f[1])+b.Ga[9])/b.Ga[5];g[2]=-1;g[3]=(1+b.Ga[10])/b.Ga[14];na.scale(f,2/(f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3]),f);b.Ga[2]=f[0];b.Ga[6]=f[1];b.Ga[10]=f[2]+1;b.Ga[14]=f[3]}b.type==a.Kb?b.za[12]+=b.ke/2:b.type==a.Pb&&(b.za[12]-=b.ke/2);ba.multiply(b.Ga,b.za,b.Od);J(b);w(b);W.copy(b.vf,b.bt);W.copy(d,b.vf);
Q.copy(e,b.quat)}function g(b,c,d,e){ba.lookAt(c,d,e,b.za);b.type==a.Kb?b.za[12]+=b.ke/2:b.type==a.Pb&&(b.za[12]-=b.ke/2);ba.multiply(b.Ga,b.za,b.Od);J(b);w(b);W.copy(c,b.vf)}function k(a,b,c,d,e){d[0]=a[0];d[1]=a[1];d[2]=a[2];ba.lookAt(a,b,c,Y);ba.invert(Y,Y);ba.rotateX(Y,Math.PI/2,Y);a=ea;V.fromMat4(Y,a);Q.fromMat3(a,e)}function n(a){var b=a.f.R;if(!b)throw"Wrong object";for(var c=a.f,e=0;e<b.length;e++){var f=b[e];d(f,a);R.Yl(f.Od,f.ak);if(f.Ce)if(f.dof_on){var g=c.i,h=aa.get_translation(f.Ce,
L),g=W.dist(g,h);f.dof_distance=g}else f.dof_distance=0}}function x(b){b=b.f;if(b.La==a.MS_TARGET_CONTROLS){var c=R.quat_to_dir(b.quat,R.AXIS_Z,L);b.Oq=0<c[1]}}function I(b,c){var d=b.f,e=d.jc;!e||d.La!=a.MS_EYE_CONTROLS&&d.La!=a.MS_TARGET_CONTROLS||(c&&(d=l(b,ja),e.left+=d[0],e.right+=d[0]),e.left=R.angle_wrap_0_2pi(e.left),e.right=R.angle_wrap_0_2pi(e.right))}function A(b,c){var d=b.f,e=d.qc;!e||d.La!=a.MS_EYE_CONTROLS&&d.La!=a.MS_TARGET_CONTROLS||(c&&(d=l(b,ja),e.qb+=d[1],e.fb+=d[1]),e.qb=R.angle_wrap_periodic(e.qb,
-Math.PI,Math.PI),e.fb=R.angle_wrap_periodic(e.fb,-Math.PI,Math.PI))}function B(b){var c=b.f;if(X.is_camera(b)){var d=c.R;if(d[0].type===a.kd){if(c.La===a.MS_TARGET_CONTROLS)var e=W.dist(c.i,c.ac),c=e/c.ji*c.ki;else c.rb&&c.La===a.MS_HOVER_CONTROLS?(e=W.distance(c.i,c.kc),c=e/c.ji*c.ki):c=d[0].top;for(e=0;e<d.length;e++){var f=d[e];f.top=c;D(f,f.Na)}n(b)}}}function y(a,b,c,d,e){var f=a.f,g=b,h=c;if(d||e)a=l(a,ga),d&&(g=b-a[0]),e&&(h=c-a[1]);if(g||h)b=Q.identity(ua),g&&(g=Q.setAxisAngle(R.AXIS_Y,g,
P),Q.multiply(b,g,b)),h&&(g=R.quat_to_dir(f.quat,R.AXIS_X,L),h=Q.setAxisAngle(g,h,P),Q.normalize(h,h),Q.multiply(b,h,b)),Q.multiply(b,f.quat,f.quat)}function v(a,b,c,d,e){var f=a.f,g=b,h=c;if(d||e){var k=l(a,ga);d&&(g=b-k[0]);e&&(h=c-k[1])}u(a,a.f.ac,g,h);a=l(a,ga);a=R.angle_wrap_periodic(a[1],-Math.PI,Math.PI);f.Oq=Math.abs(a)>Math.PI/2}function F(a,b,c,d,e){var f=a.f,g=b,h=c;if(d||e){var k=l(a,ga);d&&(g=b-k[0]);e&&(h=c-k[1])}f.Go||(g=0);u(a,f.kc,g,h);h&&q(a)}function u(a,b,c,d){var e=a.f;if(c||
d){var f=Q.identity(ua);c&&(c=Q.setAxisAngle(R.AXIS_Y,c,P),Q.multiply(f,c,f));a=M(a);d&&(!a||a&&e.rb)&&(a=R.quat_to_dir(e.quat,R.AXIS_X,L),d=Q.setAxisAngle(a,d,P),Q.normalize(d,d),Q.multiply(f,d,f));R.dE(e.i,b,f,e.i);Q.multiply(f,e.quat,e.quat)}}function q(a){var b=a.f;if(b.rb){var c=l(a,ja)[1];a=a.f;a.Ob.fb-a.Ob.qb?(c=(a.Ob.fb-c)/(a.Ob.fb-a.Ob.qb),c=Math.max(c,0)):c=0;c=c*(a.Gg-a.Be)+a.Be;a=R.quat_to_dir(b.quat,R.AXIS_MY,L);W.normalize(a,a);W.scale(a,c,a);W.subtract(b.kc,a,b.i)}}function D(b,c,d){switch(b.type){case a.Xb:if(!c)throw"No aspect ratio";
b.Na=c;case a.qe:ba.perspective(R.Mm(b.Rc),b.Na,b.ob,b.mb,b.Ga);break;case a.kd:if(!c)throw"No aspect ratio";b.Na=c;case a.gf:c=b.top*b.Na;ba.ortho(-c,c,-b.top,b.top,b.ob,b.mb,b.Ga);break;case a.mg:ba.ortho(b.left,b.right,b.bottom,b.top,b.ob,b.mb,b.Ga);break;case a.Kb:case a.Pb:if(!c)throw"No aspect ratio";b.Na=c;var e=Math.tan(b.Rc*Math.PI/360);c=b.ob*e;var f=b.Na*b.Ok*e;b.type==a.Kb?(e=f-b.ke/2,f+=b.ke/2):(e=f+b.ke/2,f-=b.ke/2);e=-(b.ob/b.Ok*e);f*=b.ob/b.Ok;ba.frustum(e,f,-c,c,b.ob,b.mb,b.Ga);b.left=
e;b.right=f;break;case a.Jb:return;default:throw"Wrong camera type: "+b.type;}d||(ba.multiply(b.Ga,b.za,b.Od),J(b),w(b))}function w(a){ba.copy(a.za,a.ge);a.ge[12]=0;a.ge[13]=0;a.ge[14]=0;a.ge[15]=1;ba.multiply(a.Ga,a.ge,a.ge);ba.invert(a.ge,a.ge)}function J(a){ba.copy(a.za,a.jj);ba.multiply(a.Ga,a.jj,a.jj);ba.invert(a.jj,a.jj)}function C(b,c,d,e,f){e||(e=new Float32Array(24));c||(c=b.ob);d||(d=b.mb);var g,h,k,l,n,m,r,q;switch(b.type){case a.Jb:throw"Extraction from NONE camera is not possible";case a.Xb:case a.qe:g=
c*Math.tan(b.Rc*Math.PI/360);l=-g;h=g*b.Na;k=-h;n=d/c*g;q=-n;m=n*b.Na;r=-m;break;case a.kd:case a.gf:k=b.top*b.Na;g=n=b.top;h=m=k;l=q=-b.top;k=r=-k;break;case a.mg:g=n=b.top;h=m=b.right;l=q=b.bottom;k=r=b.left;break;case a.Kb:case a.Pb:n=c/b.ob;g=c*Math.tan(b.Rc*Math.PI/360);l=-g;h=b.right*n;k=b.left*n;r=d/c;n=g*r;q=-n;m=h*r;r*=k;break;default:throw"Wrong camera type: "+b.type;}e[0]=k;e[1]=l;e[2]=-c;e[3]=h;e[4]=l;e[5]=-c;e[6]=h;e[7]=g;e[8]=-c;e[9]=k;e[10]=g;e[11]=-c;e[12]=r;e[13]=q;e[14]=-d;e[15]=
r;e[16]=n;e[17]=-d;e[18]=m;e[19]=n;e[20]=-d;e[21]=m;e[22]=q;e[23]=-d;f&&(c=Y,ba.invert(b.za,c),R.Mf(e,c,e,0));return e}function M(b){return X.is_camera(b)&&b.f&&b.f.La==a.MS_HOVER_CONTROLS?!0:!1}function G(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.Kj){var d=b.csm_num;a.Kj=Array(d);for(var e=0;e<d;e++)a.Kj[e]=new Float32Array(3);a.qo=new Float32Array(d)}for(d=0;d<c;d++){var e=0==d?a.ob:E(b,a,d-1),f=E(b,a,d),e=C(a,e,f,U),e=K.KB(e);a.Kj[d].set(e.F);a.qo[d]=e.Ua;a.Js[d]=W.length(e.F);a.Gm[d]=r(b.first_cascade_blur_radius,
b.last_cascade_blur_radius,c,d)}}else a.Gm[0]=b.first_cascade_blur_radius}function E(a,b,c){var d=a.csm_num,e=R.clamp(a.csm_first_cascade_border,b.ob,b.mb);a=R.clamp(a.csm_last_cascade_border,b.ob,b.mb);return R.clamp(r(e,a,d,c),b.ob,b.mb)}function r(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-1))}return a}var K=p("__boundings");p("__config");var z=p("__constraints"),H=p("__container"),V=p("__mat3"),ba=p("__mat4"),X=p("__obj_util"),fa=p("__print"),Q=p("__quat"),
ha=p("__scenes"),aa=p("__transform"),R=p("__util"),W=p("__vec3"),na=p("__vec4"),ia=p("__physics");a.Jb=10;a.Xb=20;a.kd=30;a.qe=40;a.gf=50;a.mg=60;a.Kb=70;a.Pb=80;a.MS_STATIC=0;a.MS_TARGET_CONTROLS=2;a.MS_EYE_CONTROLS=3;a.MS_HOVER_CONTROLS=4;var da=Math.PI/180/2,ja=new Float32Array(2),ga=new Float32Array(2),L=new Float32Array(3),O=new Float32Array(3),S=new Float32Array(3),ua=new Float32Array(4),P=new Float32Array(4),oa=new Float32Array(4),la=new Float32Array(4),ea=new Float32Array(16),Y=new Float32Array(16),
U=new Float32Array(24);a.gz=function(b,d){var f=d.f,g=b.data;switch(g.type){case "PERSP":var h=m(a.Xb);if(g.angle_y)var k=g.angle_y/Math.PI*180;t(h,k,g.clip_start,g.clip_end);break;case "ORTHO":h=m(a.kd),t(h,g.ortho_scale/2,g.clip_start,g.clip_end)}h.name=d.name;f.vF=!1;f.La=c(g.b4w_move_style);f.dof_distance=g.dof_distance;k=g.dof_object;f.Ce=k?k.fa:null;f.dof_front=g.b4w_dof_front;f.dof_rear=g.b4w_dof_rear;f.dof_power=g.b4w_dof_power;f.Go=g.b4w_enable_hover_hor_rotation;f.R=[h];f.gr=g.b4w_trans_velocity;
f.fr=g.b4w_rot_velocity;f.hr=g.b4w_zoom_velocity;f.La==a.MS_TARGET_CONTROLS&&(f.ac.set(g.b4w_target),x(d));g=d.f;k=g.La;if(k===a.MS_TARGET_CONTROLS||k===a.MS_EYE_CONTROLS||k===a.MS_HOVER_CONTROLS){var n=b.data,r=null,p=null,pa=null;k===a.MS_TARGET_CONTROLS||k===a.MS_EYE_CONTROLS?(n.b4w_use_panning&&(g.kw=n.b4w_use_panning),n.b4w_use_horizontal_clamping&&(r={left:n.b4w_rotation_left_limit,right:n.b4w_rotation_right_limit}),n.b4w_use_vertical_clamping&&(p={fb:n.b4w_rotation_down_limit,qb:n.b4w_rotation_up_limit}),
k===a.MS_TARGET_CONTROLS&&(g.rb=n.b4w_use_distance_limits&&n.b4w_distance_min<=n.b4w_distance_max,g.rb&&(g.Be=n.b4w_distance_min,g.Gg=n.b4w_distance_max))):k===a.MS_HOVER_CONTROLS&&(n.b4w_use_horizontal_clamping&&n.b4w_horizontal_translation_min<=n.b4w_horizontal_translation_max&&(r={left:n.b4w_horizontal_translation_min,right:n.b4w_horizontal_translation_max}),n.b4w_use_vertical_clamping&&n.b4w_vertical_translation_min<=n.b4w_vertical_translation_max&&(p={fb:n.b4w_vertical_translation_min,qb:n.b4w_vertical_translation_max}),
g.rb=n.b4w_use_distance_limits&&n.b4w_hover_angle_min<=n.b4w_hover_angle_max&&n.b4w_distance_min<=n.b4w_distance_max,g.rb&&(pa={fb:n.b4w_hover_angle_min,qb:n.b4w_hover_angle_max},g.Be=n.b4w_distance_min,g.Gg=n.b4w_distance_max));var u=r;u&&k==a.MS_EYE_CONTROLS&&(u.left*=-1,u.right*=-1);if(u=p)switch(k){case a.MS_TARGET_CONTROLS:u.fb*=-1;u.qb*=-1;break;case a.MS_HOVER_CONTROLS:var wa=-u.fb;u.fb=-u.qb;u.qb=wa}(u=pa)&&k==a.MS_HOVER_CONTROLS&&(u.fb*=-1,u.qb*=-1);g.jc=r;g.qc=p;g.Ob=pa;I(d,"LOCAL"==n.b4w_horizontal_clamping_type);
A(d,"LOCAL"==n.b4w_vertical_clamping_type)}if(f.La===a.MS_HOVER_CONTROLS)if(f=d.f,f.rb){g=d.f;k=R.quat_to_dir(g.quat,R.AXIS_MY,L);n=oa;n.set(R.AXIS_Y);n[3]=0;k=R.line_plane_intersect(n,-b.data.b4w_hover_zero_level,g.i,k,g.kc);n=l(d,ja)[1];if(!k||Math.abs(n)<da)fa.warn("Active hover camera view vector and the supporting plane are parallel to each other. Set hover pivot based on the camera position."),g.kc[0]=g.i[0],g.kc[1]=0,g.kc[2]=g.i[2];g=l(d,ja);f=R.mf(g[1],f.Ob.qb,f.Ob.fb);0<g[1]&&fa.warn("Active hover camera has wrong orientation");
f?F(d,0,f):q(d)}else f.Go=!1;h.type==a.kd&&e(d)};a.zI=e;a.Sz=b;a.kD=c;a.Db=m;a.xH=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.zb);case "DEPTH":return Boolean(a.pd);case "SCREEN":return!Boolean(a.zb)&&!Boolean(a.pd);default:throw"Wrong attachment type: "+b;}};a.Sm=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.zb=c;break;case "DEPTH":a.pd=c;break;case "SCREEN":a.zb=null;a.pd=null;break;default:throw"Wrong attachment type: "+b;}};a.gI=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.zb;
case "DEPTH":return a.pd;case "SCREEN":return null;default:throw"Wrong attachment type: "+b;}};a.lu=function(b,c){if(b.type!=a.Xb||c!=a.Kb&&c!=a.Pb)throw"make_stereo(): wrong camera type";b.type=c;f(b,6,.065)};a.AE=f;a.get_camera_angles=l;a.qt=h;a.get_camera_angles_char=function(a,b){l(a,b);b[0]=R.angle_wrap_0_2pi(b[0]+Math.PI);b[1]*=-1;return b};a.get_angles=function(a,b){var c=a.f,d=R.quat_to_dir(c.quat,R.AXIS_MY,L),e=Math.asin(d[1]/W.length(d));0==d[0]&&0==d[2]?c=0:(Math.abs(e)>Math.PI/4&&(d=0>=
e?R.quat_to_dir(c.quat,R.AXIS_MZ,O):R.quat_to_dir(c.quat,R.AXIS_Z,O)),c=Math.atan(Math.abs(d[0]/d[2])),0<d[2]&&(c=Math.PI-c),0<d[0]&&(c=2*Math.PI-c));b[0]=c;b[1]=e;return b};a.Tm=t;a.rE=function(b,c,d,e,f,g,h){switch(b.type){case a.mg:b.left=c;b.right=d;b.bottom=e;b.top=f;b.ob=g;b.mb=h;break;default:fa.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.get_move_style=function(a){return a.f.La};a.DE=d;a.dJ=g;a.ov=function(a,b,c){var d=L;d[0]=0;d[1]=-1;d[2]=0;W.transformQuat(d,
c,d);d[0]+=b[0];d[1]+=b[1];d[2]+=b[2];var e=O;e[0]=0;e[1]=0;e[2]=-1;W.transformQuat(e,c,e);g(a,b,d,e)};a.UH=k;a.JF=n;a.IF=function(b){var c=b.f,d=b.f;if(d.La===a.MS_TARGET_CONTROLS||d.La===a.MS_EYE_CONTROLS){if(d.jc){var e=d.jc.left,f=d.jc.right,g=l(b,ja);(g=d.La==a.MS_TARGET_CONTROLS?R.mf(g[0],e,f):R.mf(g[0],f,e))&&(d.La==a.MS_TARGET_CONTROLS?v(b,g,0):y(b,g,0))}d.qc&&(e=d.qc.fb,f=d.qc.qb,g=l(b,ja),(g=d.La==a.MS_TARGET_CONTROLS?R.mf(g[1],f,e):R.mf(g[1],e,f))&&(d.La==a.MS_TARGET_CONTROLS?v(b,0,g):
y(b,0,g)));d.La===a.MS_TARGET_CONTROLS&&d.rb&&(g=b.f,e=W.subtract(g.i,g.ac,L),f=W.length(e),f>g.Gg?(W.scale(e,g.Gg/f,e),W.add(g.ac,e,g.i)):f<g.Be&&(f=R.quat_to_dir(g.quat,R.AXIS_MY,O),W.scale(f,100*g.Be,f),W.add(e,f,e),W.scale(e,-g.Be/W.length(e),e),W.add(g.ac,e,g.i)))}d.La===a.MS_HOVER_CONTROLS&&(d=b.f,g=d.rb?d.kc:d.i,d.jc&&(e=R.clamp(g[0],d.jc.left,d.jc.right)-g[0],g[0]+=e,d.rb&&(d.i[0]+=e)),d.qc&&(e=R.clamp(g[2],d.qc.fb,d.qc.qb)-g[2],g[2]+=e,d.rb&&(d.i[2]+=e)),d=b.f,d.rb&&d.Ob&&(g=l(b,ja)[1],g=
R.mf(g,d.Ob.qb,d.Ob.fb),R.quat_to_dir(d.quat,R.AXIS_MY,L),g&&F(b,0,g)));B(b);switch(c.La){case a.MS_TARGET_CONTROLS:z.eE(c.i,c.quat,c.ac);z.correct_up(b,R.AXIS_Y);break;case a.MS_EYE_CONTROLS:b.Sa||z.correct_up(b,R.AXIS_Y)}x(b)};a.Zq=x;a.ID=I;a.MD=A;a.TF=B;a.rotate_eye_camera=y;a.rotate_target_camera=v;a.rotate_hover_camera=F;a.vI=q;a.GI=function(b){switch(b.type){case a.Xb:case a.kd:case a.Kb:case a.Pb:return!0;default:return!1}};a.vB=function(b){b=b.f.R[0];switch(b.type){case a.Xb:case a.qe:case a.Kb:case a.Pb:return Math.PI*
b.Rc/180;default:return fa.error("get_min_fov(): Unsupported camera type: "+b.type),0}};a.Sf=D;a.Zn=w;a.ls=J;a.UA=C;a.Ly=function(a){a=a.f;var b=K.Ad();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.Qb=b;var c=K.Ll(1,[0,0,0]);a.nd=c;a.Kn=K.Fs(1,b);a.Mn=K.Hs(1,b);a.Ln=K.Gs(1,b)};a.is_target_camera=function(b){return X.is_camera(b)&&b.f&&b.f.La==a.MS_TARGET_CONTROLS?!0:!1};a.is_eye_camera=function(b){return X.is_camera(b)&&b.f&&b.f.La==a.MS_EYE_CONTROLS?!0:!1};a.is_hover_camera=M;
a.Yq=G;a.pA=E;a.project_point=function(b,c,d){b=b.f.R[0];switch(b.type){case a.Xb:case a.qe:case a.kd:case a.gf:case a.Kb:case a.Pb:var e=oa;e.set(c);e[3]=1;na.transformMat4(e,b.Od,e);c=-e[1]/e[3];d[0]=(e[0]/e[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;H.wG(d[0],d[1],d,b);2<d.length&&(d[2]=(e[2]/Math.abs(e[3])+1)/2);return d;default:return fa.error("Non-compatible camera"),d}};a.IB=function(a){return a.f.R[0]};a.dm=function(b,c){switch(b.type){case a.Xb:case a.qe:case a.Kb:case a.Pb:var d=Math.tan(R.Mm(b.Rc)/
2);switch(c){case "LEFT":return-d*b.Na;case "RIGHT":return d*b.Na;case "TOP":return d;case "BOTTOM":return-d}break;case a.kd:case a.gf:switch(c){case "LEFT":return-b.top*b.Na;case "RIGHT":return b.top*b.Na;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.mg:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;default:R.U("Unknown camera type")}};a.tC=function(b){switch(b.type){case a.kd:case a.gf:case a.mg:return!0;
default:return!1}};a.get_fov=function(b,c){switch(b.type){case a.Xb:case a.qe:case a.Kb:case a.Pb:var d=R.Mm(b.Rc);return c?d*b.Na:d;default:return 0}};a.set_trans_pivot=function(a,b,c){W.copy(b,a.f.i);W.copy(c,a.f.ac);aa.o(a);ia.sync_transform(a)};a.set_look_at=function(a,b,c,d){var e=a.f;k(b,c,d,e.i,e.quat);aa.o(a);ia.sync_transform(a)};a.apply_hover_angle_limits=function(a,b,c){b=R.angle_wrap_periodic(b,-Math.PI,Math.PI);c=R.angle_wrap_periodic(c,-Math.PI,Math.PI);b=R.clamp(b,-Math.PI/2,0);c=R.clamp(c,
-Math.PI/2,0);a.f.Ob={fb:b,qb:c};q(a);aa.o(a);ia.sync_transform(a)};a.apply_distance_limits=function(a,b,c){var d=a.f;d.rb=!0;d.Be=b;d.Gg=c;aa.o(a);ia.sync_transform(a)};a.set_hover_pivot=function(a,b){var c=a.f;if(c.rb&&c.Ob){var d=W.subtract(b,c.kc,L),d=W.add(d,c.i,d);aa.set_translation(a,d)}W.copy(b,c.kc);aa.o(a);ia.sync_transform(a)};a.get_eye=function(a,b){b||(b=new Float32Array(3));W.copy(a.f.i,b);return b};a.set_move_style=function(b,c){b.f.La=c;b.f.jc=null;b.f.qc=null;b.f.Ob=null;b.f.rb=!1;
e(b);switch(c){case a.MS_TARGET_CONTROLS:var d=a.get_eye(b,L),f=R.quat_to_dir(b.f.quat,R.AXIS_MY,O),d=W.scaleAndAdd(d,f,10,f);W.copy(d,b.f.ac)}aa.o(b);ia.sync_transform(b);return!0}};b4w.module.__lights=function(a,p){function e(a){c.scale(a.color,a.Fe,a.Fj)}p("__print");var b=p("__util"),c=p("__vec3"),m=new Float32Array(3);a.xC=function(a,l){var h=a.data,t=l.Fa={name:"",type:h.type,Nu:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),Fj:new Float32Array(3),Qs:0,Ye:0,Mk:0,mt:!1,pu:!1,Vs:!1,ej:!0,yh:!0,Fe:1,distance:25,VH:"INVERSE_SQUARE"};t.name=l.name;t.ej=h.use_diffuse;t.yh=h.use_specular;var d=b.quat_to_dir(l.f.quat,b.AXIS_Y,m);c.normalize(d,d);t.direction.set(d);
t.color[0]=h.color[0];t.color[1]=h.color[1];t.color[2]=h.color[2];t.Fe=t.Qs=h.energy;e(t);t.distance=h.distance;if("POINT"===t.type||"SPOT"===t.type)t.distance=h.distance;"SPOT"===t.type?(t.Mk=h.spot_blend,t.Ye=h.spot_size):"POINT"===t.type&&(t.Ye=Math.PI/2);t.mt=h.b4w_generate_shadows;t.Vs=h.b4w_dynamic_intensity};a.mv=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];e(a)};a.vE=function(a,b){a.Mk=b};a.uE=function(a,b){a.distance=b};a.wE=function(a,b){a.Ye=b};a.uq=function(a,b){a.Fe=
b;e(a)};a.PF=function(a){if("LAMP"!=a.type)throw"Wrong light object";var e=a.Fa;if(e){b.quat_to_dir(a.f.quat,b.AXIS_Y,e.direction);c.normalize(e.direction,e.direction);if("SUN"==e.type){a=Math.acos(c.dot(e.Nu,b.Dr));var h=Math.acos(c.dot(e.direction,b.Dr));e.pu=Math.floor(a/.025)!=Math.floor(h/.025)?!0:!1}c.copy(e.direction,e.Nu)}}};b4w.module.__scenes=function(a,p){function e(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.Qd||!c.Qd.length)return c}return null}function b(){if(!Xa)throw"No active scene available";return Xa}function c(a,b,c){if(!Aa.Oj||!m(a,b,c))return null;a=a.b4w_shadow_settings;c={};a.csm_resolution>Aa.ub?(c.csm_resolution=Aa.ub,za.error("Shadow map texture has unsupported size. Changed to "+Aa.ub+".")):c.csm_resolution=a.csm_resolution;c.self_shadow_polygon_offset=a.self_shadow_polygon_offset;c.self_shadow_normal_offset=
a.self_shadow_normal_offset;c.enable_csm=a.b4w_enable_csm;if(b=ma.Zo(b)||b[0])c.Ug=b.Fa.type,c.Ye=b.Fa.Ye,c.distance=b.Fa.distance,"SPOT"!=c.Ug&&"POINT"!=c.Ug||!c.enable_csm||(za.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),c.enable_csm=!1);c.enable_csm?(c.csm_num=a.csm_num,c.csm_first_cascade_border=a.csm_first_cascade_border,c.first_cascade_blur_radius=a.first_cascade_blur_radius,c.csm_last_cascade_border=a.csm_last_cascade_border,c.last_cascade_blur_radius=
a.last_cascade_blur_radius,c.fade_last_cascade=a.fade_last_cascade,c.blend_between_cascades=a.blend_between_cascades):(c.csm_num=1,c.csm_first_cascade_border=a.csm_first_cascade_border,c.first_cascade_blur_radius=a.first_cascade_blur_radius,c.csm_last_cascade_border=a.csm_last_cascade_border,c.last_cascade_blur_radius=a.last_cascade_blur_radius,c.fade_last_cascade=!1,c.blend_between_cascades=!1);return c}function m(a,b,c){if(Aa.Li)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;
var d=!1,e=!1;a=Aa.ie&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var f=c[b];f.b4w_shadow_cast&&(d=!0);f.b4w_shadow_receive&&(e=!0);if((a||d)&&e)return!0}return!1}function f(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].Fa.type)return!0;return!1}function l(a){if(!Aa.shore_smoothing)return!1;a=na(a);for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function h(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,d=
0;d<c.length;d++){var e=c[d].settings;if(e.b4w_enable_soft_particles&&0<e.b4w_particles_softness)return!0}return!1}function t(a){for(var b=na(a),c=[],d=0;d<b.length;d++){var e=b[d];if(e.b4w_water){for(var f={},g=0;g<a.length;g++)for(var h=a[g],k=h.data.materials,n=0;n<k.length;n++)k[n]==e&&(f.hg=h.location[1]);f.gc=e.b4w_water_fog_color.slice(0);f.gc.push(e.b4w_water_fog_density);e.b4w_water_dynamic?(f.Sj=!0,f.waves_height=e.b4w_waves_height,f.waves_length=e.b4w_waves_length,f.dst_noise_scale0=e.b4w_water_dst_noise_scale0,
f.dst_noise_scale1=e.b4w_water_dst_noise_scale1,f.dst_noise_freq0=e.b4w_water_dst_noise_freq0,f.dst_noise_freq1=e.b4w_water_dst_noise_freq1,f.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,f.dir_freq=e.b4w_water_dir_freq,f.dir_noise_scale=e.b4w_water_dir_noise_scale,f.dir_noise_freq=e.b4w_water_dir_noise_freq,f.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,f.dst_min_fac=e.b4w_water_dst_min_fac,f.waves_hor_fac=e.b4w_water_waves_hor_fac):(f.Sj=!1,f.waves_height=0,f.waves_length=0);f.we=e.b4w_water_enable_caust;
f.iz=e.b4w_water_caust_scale;f.hz=e.b4w_water_caust_brightness;f.jz=new Float32Array([.3,.7]);f.Vm=null;e=e.texture_slots;for(g=0;g<e.length;g++)h=e[g].texture,!0===h.b4w_shore_dist_map&&(f.Vm=h.image,f.Ni=h.image.size[0],f.KE=h.b4w_shore_boundings,f.si=h.b4w_max_shore_dist);c.push(f)}}if(0<c.length){f=c[0];if(!f.Sj)for(d=0;d<c.length;d++)c[d].Sj&&(f=c[d]);return f}return null}function d(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d];"GROUP"==e.type&&e.node_group&&b(e.node_group.node_tree);
"GROUP"==e.type&&"B4W_REFRACTION"==e.node_tree_name&&(c.oc=!0)}}}var c={oc:!1};a=na(a);for(var d=0;d<a.length;d++){var e=a[d];e.b4w_refractive&&(c.oc=!0);e.node_tree&&b(e.node_tree)}return c}function g(a,b){if(Aa.Ek)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;for(var c=[],d=0,e=0;e<b.length;e++){var f=b[e];f.f.Cc&&"CUBE"==f.f.fe&&d++;if(f.Fk.length){for(var g=null,h=0;h<c.length;h++)if(c[h]==f){g=h;break}null==g&&c.push(f)}}return{$u:c,zu:d,qf:[],Lf:[]}}function k(a,b){var c=
a.b4w_sky_settings,d={};d.WD=c.render_sky;d.procedural_skydome=c.procedural_skydome&&b;d.use_as_environment_lighting=c.use_as_environment_lighting;d.Pi=c.color;d.rayleigh_brightness=c.rayleigh_brightness;d.mie_brightness=c.mie_brightness;d.spot_brightness=c.spot_brightness;d.scatter_strength=c.scatter_strength;d.rayleigh_strength=c.rayleigh_strength;d.mie_strength=c.mie_strength;d.rayleigh_collection_power=c.rayleigh_collection_power;d.mie_collection_power=c.mie_collection_power;d.mie_distribution=
c.mie_distribution;d.nc=c.reflexible;d.bc=c.reflexible_only;!b&&c.procedural_skydome&&za.warn("There is no sun on the scene. Procedural sky won't be rendered");return d}function n(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.eC=a.hemisphere;b.Xy=a.blur_depth;b.es=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.hE=a.samples;return b}function x(a){if(!(Aa.xl&&a.b4w_enable_bloom&&a.j.uh))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.JA=
a.edge_lum;b.key=a.key;return b}function I(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function A(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function B(a){var b={};a=a.b4w_god_rays_settings;b.op=a.intensity;b.ri=a.max_ray_length;b.Xi=a.steps_per_pass;return b}function y(a){var b={};b.Se=a.b4w_outline_color;
b.vk=a.b4w_outline_factor;return b}function v(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function F(a,b){var c=a.light_settings,d={};d.uf=c.environment_energy;d.cr=c.use_environment_light;d.Ho=c.environment_color;d.yf=a.horizon_color.slice(0);d.kg=a.zenith_color.slice(0);d.nG=a.use_sky_paper;d.mG=a.use_sky_blend;
d.oG=a.use_sky_real;d.Av=null;d.yq=null;d.Io=null;if(d.cr&&"SKY_TEXTURE"==d.Ho&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var c=null,e=0;e<a.texture_slots.length;e++)if(a.texture_slots[e].texture.b4w_use_as_environment_lighting){c=a.texture_slots[e];break}c?d.Io=c:(za.warn("environment lighting is set to 'Sky Texture', but there is no world texture with 'Sky Texture Usage' property set to 'ENVIRONMENT_LIGHTING'"),d.cr=!1)}for(e=0;e<a.texture_slots.length;e++)if(a.texture_slots[e].texture.b4w_use_as_skydome){c=
a.texture_slots[e];d.Av=c;d.yq={Uy:c.blend_factor,fC:c.horizon_factor,FG:c.zenith_up_factor,EG:c.zenith_down_factor,color:c.color,Da:c.default_value,invert:c.invert,lG:c.use_rgb_to_intensity,Vy:c.blend_type,hG:c.use_map_blend,iG:c.use_map_horizon,kG:c.use_map_zenith_up,jG:c.use_map_zenith_down};break}return d}function u(a){var b=a.fog_settings,c={};c.dG=b.use_fog;c.op=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.XA=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);
a=c.color;c.gc=new Float32Array([a[0],a[1],a[2],1/c.depth]);c.am=new Float32Array([c.op,c.depth,c.start,c.height]);return c}function q(a){if(!Aa.Lb)return!1;for(var b=!1,c=!1,d=0;d<a.length;d++){for(var e=a[d],f=e.data.materials,g=0;g<f.length;g++)f[g].b4w_terrain&&(b=!0);e=e.particle_systems;for(g=0;g<e.length;g++)f=e[g].settings,"HAIR"==f.type&&f.b4w_dynamic_grass&&(c=!0);if(b&&c)return!0}return!1}function D(a,b){if(Ac.outlining_overview_mode)return!0;if(Aa.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].fa.f.Ve)return!0;return!1}else return!1}function w(a,b){if(Ac.outlining_overview_mode)return!0;if(Aa.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].fa.f.Ab)return!0;return!1}else return!1}function J(a,b){if(Aa.Ke)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,
e=0;e<d.length;e++)if(pa.ss(d[e]))return!0;return!1}else return!1}function C(a,b){if(Aa.oc)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.oc}else return!1}function M(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,d=0;d<c.length;d++){var e=c[d],f=e.game_settings.alpha_blend;if(e.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}function G(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=
0;c<b.length;c++){var d=b[c].fa;if(d.anchor&&d.anchor.Th)return!0}return!1}}function E(a,b,c){var d=Ba.dh(a,b);Ba.af(a,d,function(a,b,d){if(d.kb){switch(d.from){case "COLOR":case "CUBEMAP":a=b.k.zb;break;case "DEPTH":a=b.k.pd;break;case "SCREEN":a=null;break;case "MAIN_CUBE_REFLECT":return;default:throw"Wrong slink";}switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "u_cube_reflection":case "u_plane_reflection":break;default:if(!a)throw"Connection of SCREEN is forbidden";
if(a.fg)throw"Batch texture can't use renderbuffer";ra.us(c.Ub,d.to)&&U.Nh(c,a,d.to)}}});for(a=0;a<b.wa.length;a++){var d=b.wa[a],e=b.le[a];switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":break;default:if(e.fg)throw"Batch texture can't use renderbuffer";ra.us(c.Ub,d.to)&&U.Nh(c,e,d.to)}}}function r(a,b){return{tb:!0,Do:[!0,!0,!0,!0,!0,!0],Jd:a,B:b}}function K(a,b,c,d,e,f){function g(a,b){return a==b?0:a>b?1:-1}for(var h=b.f,k=ma.Oa(b,e).S,n=0;n<k.length;n++){var l=
k[n];l.Dc||l.bc||"MAIN"!=l.type&&"NODES_GLOW"!=l.type&&"PARTICLES"!=l.type||!("OPAQUE"==l.$a&&"OPAQUE"==d||"BLEND"==l.$a&&"BLEND"==d||"XRAY"==l.$a&&"XRAY"==d||"NODES_GLOW"==l.type&&"GLOW"==d)||(f||(z(l,a,b,c,d,e),U.Bb(l),H(l)),a.p.push(r(h,l)),E(c,a,l),V(l))}a.p.sort(function(a,b){return a.B&&b.B?-g(a.B.Ra,b.B.Ra)||-g(a.B.qg,b.B.qg)||g(a.B.fh,b.B.fh):0})}function z(a,b,c,d,e,f){var g=c.f,h=ma.Oa(c,f),k="NO_SHADOWS";if((c=ka.Ya(d,"SHADOW_CAST"))&&a.Ec){switch(e){case "OPAQUE":k="SHADOW_MAPPING_OPAQUE";
break;case "BLEND":case "XRAY":k="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":k="NO_SHADOWS";break;case "DEPTH":k="SHADOW_MASK_GENERATION";break;default:throw"Wrong subscene type";}U.Ur(a,f.j.ec,c)}c=a.ib;ra.G(c,"SHADOW_USAGE",k);a.Lb&&(k=ka.Ya(d,"GRASS_MAP"))&&ba(a,k,g);if("DEPTH"!=a.type&&"COLOR_ID"!=e||a.hi)if(e=b.tk,ra.G(c,"NUM_LIGHTS",e),ra.G(c,"NUM_LFACTORS",0==e%2?e/2:Math.floor(e/2)+1),"special_skydome.glslf"==ra.ut(c)&&ra.G(c,"REFLECTION_PASS",0),ra.G(c,"SSAO_ONLY",
0),b.yb&&b.Pd?ra.G(c,"WATER_EFFECTS",1):ra.G(c,"WATER_EFFECTS",0),b.yb&&b.we&&g.we?(ra.G(c,"CAUSTICS",1),ra.G(c,"CAUST_SCALE",ra.r(b.ns)),ra.G(c,"CAUST_SPEED",ra.r(b.os,2)),ra.G(c,"CAUST_BRIGHT",ra.r(b.ms))):ra.G(c,"CAUSTICS",0),b.yb&&(ra.G(c,"WAVES_HEIGHT",ra.r(b.ig)),ra.G(c,"WAVES_LENGTH",ra.r(b.Hh)),ra.G(c,"WATER_LEVEL",ra.r(b.hg))),g=h.qf,h=h.Lf,-1!==a.Vb.indexOf("u_mirrormap")?ra.G(c,"REFLECTION_TYPE","REFL_MIRRORMAP"):a.Cc&&g?(g=g.k.zb,U.Nh(a,g,"u_cube_reflection"),ra.G(c,"REFLECTION_TYPE",
"REFL_CUBE")):a.Cc&&h?(g=h.k.zb,U.Nh(a,g,"u_plane_reflection"),ra.G(c,"REFLECTION_TYPE","REFL_PLANE")):ra.G(c,"REFLECTION_TYPE","REFL_NONE"),(h=ka.Ya(d,"SKY"))?a.Qu?(g=h.k.zb,U.Nh(a,g,"u_sky")):Aa.Jm?(a.Mc=h.Mc,ra.G(c,"PROCEDURAL_FOG",1)):ra.G(c,"PROCEDURAL_FOG",0):ra.G(c,"PROCEDURAL_FOG",0),g=f.j.or,g.cr&&(ra.G(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==g.Ho?(g=g.Io?U.zB(g.Io,!1):h.k.zb,ra.G(c,"SKY_TEXTURE",1),U.Nh(a,g,"u_sky_texture")):"SKY_COLOR"==g.Ho&&ra.G(c,"SKY_COLOR",1)),g=f.j.Hw,g.dG&&(ra.G(c,
"USE_FOG",1),ra.G(c,"FOG_TYPE",g.XA)),a.hq?(Aa.Oj&&ra.G(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.hi||"NODES_GLOW"==a.type?(ra.G(c,"REFRACTIVE",1),f.j.oc?ra.G(c,"USE_REFRACTION",1):ra.G(c,"USE_REFRACTION",0)):f.j.oc?ra.G(c,"REFRACTIVE",1):ra.G(c,"REFRACTIVE",0)):(ra.G(c,"REFRACTIVE",0),ra.G(c,"USE_REFRACTION",0),ra.G(c,"USE_REFRACTION_CORRECTION",0)),a.gg&&(Aa.shore_smoothing&&a.qn&&ka.Ya(d,"DEPTH")?ra.G(c,"SHORE_SMOOTHING",1):ra.G(c,"SHORE_SMOOTHING",0),a.water_dynamic&&b.yb&&b.ig?ra.G(c,
"DYNAMIC",1):ra.G(c,"DYNAMIC",0)),"PARTICLES"==a.type&&(ra.G(c,"SIZE_RAMP_LENGTH",a.va.vv),ra.G(c,"COLOR_RAMP_LENGTH",a.va.As)),!a.Mg)for(a=a.T,b=0;b<a.length;b++)if(g=a[b],"SCENE"==g.source)for(d=0;d<Ya.length;d++)for(c=Ya[d],h=Ya[d].Qd,e=0;e<h.length;e++)h[e].j==g&&Ba.n(Ub,c,f,null)}function H(a){var b=a.Ub.attributes,c=a.N.Tb,d;for(d in b)c[d]||Sa.U('missing data for "'+d+'" attribute');if("MAIN"==a.type||"NODES_GLOW"==a.type)if(b=ra.VB(a.Ub.kr),10<b&&("MAIN"==a.type&&za.warn("Varying limit exceeded for main shader - "+
b+', materials: "'+a.Sc.join(", ")+'"'),"MAIN"==a.type&&a.hi||"NODES_GLOW"==a.type))d=c=0,a.Ah&&(c=Sa.ek(a.Ah)),a.Ib&&(d=Sa.ek(a.Ib)),za.warn("Varying limit exceeded for node shader - "+b+", uv: "+c+", vc: "+d+', materials: "'+a.Sc.join(", ")+'"')}function V(a){8<a.T.length&&za.warn(a.type,"too many textures used - "+a.T.length+' (max 8), materials "'+a.Sc.join(", ")+'"')}function ba(a,b,c){a.wc=b.wc;var d=b.wc[0],e=b.wc[1],f=b.wc[2];c=c.Qb;c=Math.max(c.max_x-c.min_x,c.max_z-c.min_z);f=0==f?c:Math.max(f,
c);b.wc[2]=f;b=b.k;N.Tm(b,f/2,-e,-d,f/2);N.Sf(b);d=a.cp||0;d=0==d?c:Math.max(d,c);a.cp=d}function X(a){var b=ja(a,"MAIN_OPAQUE"),c=!0,d=a.j.ec;Ba.W(a.j.nb,function(a,e){"SHADOW_CAST"===e.type&&(Q(e,b.k,e.p,d,c),c=!1)})}function fa(a){Ba.W(a.j.nb,function(a,b){"OUTLINE"===b.type&&(b.Eo=1)})}function Q(a,b,c,d,e){if(0!=c.length){var f=a.k;kb.copy(b.vf,f.vf);va.copy(b.za,f.sv);if("SUN"===d.Ug||"HEMI"===d.Ug){var g=Nb;ya.Ad(g);for(var h=0;h<c.length;h++){var k=c[h].Jd;0==h?ya.Il(k.sb,g):ya.Xs(g,k.sb)}c=
ya.TA(g,Vc);Sa.Mf(c,f.za,c);if(d.enable_csm){d=kb.copy(b.Kj[a.po],Cc);g=va.invert(b.za,tc);Sa.Mf(d,g,d);Sa.Mf(d,f.za,d);a=b.qo[a.po];if(e)for(Dc=0,gc=-Infinity,e=2;e<c.length;e+=3)Dc=Math.min(Dc,c[e]),gc=Math.max(gc,c[e]);e=Nb;e.max_x=d[0]+a;e.max_y=d[1]+a;e.max_z=gc;e.min_x=d[0]-a;e.min_y=d[1]-a;e.min_z=Dc}else{a=e=Nb;b=cc;b.set(c);c=Zc/9;d=va.identity(tc);va.rotate(d,c,Sa.AXIS_MZ,d);h=g=-1;for(k=0;10>k;k++){var n=ya.Sy(b,Ob),l=(n.max_x-n.min_x)*(n.max_y-n.min_y);if(-1==g||l<g)g=l,h=k,ya.Il(n,a);
Sa.Mf(b,d,b)}c*=h;0<c&&(a=va.identity(tc),va.rotate(a,c,Sa.AXIS_MZ,a),va.multiply(a,f.za,f.za));c=e.max_x-e.min_x;a=e.max_y-e.min_y;c&&a&&(b=Math.abs(c-a)/2,2<c/a?(e.max_y+=b,e.min_y-=b):2<a/c&&(e.max_x+=b,e.min_x-=b));e.max_x+=.005;e.max_y+=.005;e.max_z+=.005;e.min_x-=.005;e.min_y-=.005;e.min_z-=.005}N.rE(f,e.min_x,e.max_x,e.min_y,e.max_y,-e.max_z,-e.min_z);N.Sf(f);Sa.Yl(f.Od,f.ak)}else"SPOT"!==d.Ug&&"POINT"!==d.Ug||N.Sf(f,f.Na)}}function ha(a,b,c,d,e){for(var f=b.f,g=ma.Oa(b,d).S,h=0;h<g.length;h++){var k=
g[h];"COLOR_ID"==k.type&&(e||(z(k,a,b,c,"COLOR_ID",d),U.Bb(k),H(k)),"COLOR_PICKING"==a.type&&"COLOR_ID"==k.$a||"COLOR_PICKING_XRAY"==a.type&&"COLOR_ID_XRAY"==k.$a)&&(e||(U.oa(k,"USE_OUTLINE",0),U.Bb(k),H(k)),a.p.push(r(f,k)))}}function aa(a,b,c,d,e){d||(e.Lb&&(d=ka.Ya(c,"GRASS_MAP"))&&ba(e,d,b),U.Bb(e),H(e));a.p.push(r(b,e));E(c,a,e);V(e)}function R(a,b){for(var c=da(b,$a),d=a.Fa,e=a.f,f=ma.Oa(a,b),g=f.ni,h=0;h<c.length;h++){var k=c[h];k.tm.set(e.i,3*g);k.yp.set(d.direction,3*g);k.sm.set(d.Fj,3*g);
switch(d.type){case "SUN":k.Rv.set(e.quat);k.Qv=d.Fj;"SKY"===k.type?(k.ym=d.pu,kb.copy(d.direction,k.Jq),W(b,k)):kb.copy(d.direction,k.Jq);break;case "HEMI":case "POINT":case "SPOT":break;default:za.error("Unknown light type: "+d.type+'".')}var n=Gb;n[0]=d.ej?1:0;n[1]=d.yh?1:0;k.zp.set(n,2*g);k.ua=!0;for(n=0;n<k.p.length;n++){var l=k.p[n].B;l.mi&&U.tE(l,a)}}c=ja(b,"MAIN_OPAQUE").k;f=f.tv;d=b.j.ec;for(h=0;h<f.length;h++)k=f[h],N.ov(k.k,e.i,e.quat),Q(k,c,k.p,d,!0)}function W(a,b){Ka.Rj(b);if(b.ym)for(var c=
da(a,["MAIN_OPAQUE","MAIN_BLEND","MAIN_XRAY","MAIN_GLOW"]),d=0;d<c.length;d++)for(var e=c[d].p,f=0;f<e.length;f++){var g=e[f];g.tb&&(g=g.B,U.mz(g)&&Ka.DF(g))}}function na(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].data,e=0;e<d.materials.length;e++){var f=d.materials[e];-1==b.indexOf(f)&&b.push(f)}return b}function ia(a,b,c){for(var d=a.j,e=a.ng.f.R,f=0;f<e.length;f++){var g=e[f];N.Sf(g,b/c);d.ec&&N.Yq(g,d.ec)}d.ec&&(d.zm=!0,ja(a,"DEPTH").ua=!0,ja(a,"MAIN_BLEND").ua=!0);var h=d.nb;ka.tF(h,function(d,
e,f){if(d.Sk){var g=d.Oi*b,k=d.Oi*c;if(e)for(e=0;e<f.wa.length;e++)f.wa[e]==d&&Wa.resize(d.Ha,g,k);else switch(Wa.ok(d.Ha)&&Wa.resize(d.Ha,g,k),d=f.k,d.width=g,d.height=k,f.type){case "DOF":ga(a,{dof_power:f.k.dof_power,dof_on:f.k.dof_on});break;case "GLOW_COMBINE":O(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case "BLOOM":L(a,{bloom_blur:f.bloom_blur});break;case "OUTLINE":f=ka.Xa(h,f,"POSTPROCESSING");g=ka.Xa(h,f,"POSTPROCESSING");k=ka.Xa(h,
g,"POSTPROCESSING");d=ka.Xa(h,k,"POSTPROCESSING");ka.Zc(f,1/b,1/c);ka.Zc(g,1/b,1/c);ka.Zc(k,1/b,1/c);ka.Zc(d,1/b,1/c);break;default:ka.Zc(f,1/b,1/c)}}})}function da(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];Ba.W(a.j.nb,function(a,b){b.type==e&&c.push(b)})}return c}function ja(a,b){return ka.Ya(a.j.nb,b)}function ga(a,b){var c=ja(a,"DOF");if(!c)return za.error("DOF is not enabled on the scene. Check camera settings"),0;var d=a.j.nb;"boolean"==typeof b.dof_on&&(c.k.dof_on=parseFloat(b.dof_on));
"number"==typeof b.dof_distance&&(c.k.dof_distance=b.dof_distance);"number"==typeof b.dof_front&&(c.k.dof_front=b.dof_front);"number"==typeof b.dof_rear&&(c.k.dof_rear=b.dof_rear);if("number"==typeof b.dof_power){c.k.dof_power=b.dof_power;var e=ka.Xa(d,c,"POSTPROCESSING"),d=ka.Xa(d,e,"POSTPROCESSING");ka.dc(e,c.k.dof_power);ka.Zc(e,1/c.k.width,1/c.k.height);ka.dc(d,c.k.dof_power);ka.Zc(d,1/c.k.width,1/c.k.height)}c.ua=!0}function L(a,b){var c=ja(a,"LUMINANCE_TRUNCED"),d=ja(a,"BLOOM");if(!c||!d)return za.error("Bloom is not enabled on the scene"),
0;"number"==typeof b.bloom_key&&(c.bloom_key=b.bloom_key,c.ua=!0);"number"==typeof b.bloom_edge_lum&&(c.bloom_edge_lum=b.bloom_edge_lum,c.ua=!0);if("number"==typeof b.bloom_blur){var e=a.j.nb,c=ka.Xa(e,d,"BLOOM_BLUR"),e=ka.Xa(e,c,"BLOOM_BLUR");d.bloom_blur=b.bloom_blur;ka.dc(c,b.bloom_blur);ka.Zc(c,1/d.k.width,1/d.k.height);ka.dc(e,b.bloom_blur);ka.Zc(e,1/d.k.width,1/d.k.height)}}function O(a,b){var c=ja(a,"GLOW_COMBINE");if(!c)return za.error("Glow is not enabled on the scene"),null;for(var d=a.j.nb,
e=ka.MB(d,c),f=0;f<e.length;++f){var g=e[f];if("POSTPROCESSING"===g.type&&"GLOW_MASK_LARGE"===g.$a)var h=g;if("POSTPROCESSING"===g.type&&"GLOW_MASK_SMALL"===g.$a)var k=g}e=ka.Xa(d,h,"POSTPROCESSING");d=ka.Xa(d,k,"POSTPROCESSING");"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.ua=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=b.large_glow_mask_coeff,c.ua=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,
ka.dc(k,b.small_glow_mask_width),ka.Zc(k,1/c.k.width,1/c.k.height),k.ua=!0,ka.dc(d,b.small_glow_mask_width),ka.Zc(d,1/c.k.width,1/c.k.height),d.ua=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,ka.dc(h,b.large_glow_mask_width),ka.Zc(h,1/c.k.width,1/c.k.height),h.ua=!0,ka.dc(e,b.large_glow_mask_width),ka.Zc(e,1/c.k.width,1/c.k.height),e.ua=!0)}function S(a,b){var c=ja(Xa,"MAIN_OPAQUE");if(!c||!c.yb)return za.error("get_water_surface_level() - no water parameters on the scene"),
0;var d=c.ig,e=c.Hh,f=c.hg,g=c.yb;if(!d||!g.Sj)return g.hg;var h=kb.length(c.bf),k=c.time;h&&(k*=h);var n=Gb;n[0]=20/e*(a-.25*k);n[1]=20/e*(b-.25*k);h=Sa.ps(n);n[0]=17/e*(b+.1*k);n[1]=17/e*(a+.1*k);var n=Sa.ps(n),h=h+n-1,l=g.dst_noise_scale0,n=g.dst_noise_scale1,m=g.dst_noise_freq0,r=g.dst_noise_freq1,q=Gb;q[0]=l*(a+m*k);q[1]=l*(b+m*k);l=Sa.zq(q);q[0]=n*(b-r*k);q[1]=n*(a-r*k);n=Sa.zq(q);n*=d*l;if(c.mn)if(r=(a-c.Uf[0])/c.Vf[0],q=(c.Uf[1]+b)/c.Vf[1],r+=.5,q+=.5,1<r||0>r||1<q||0>q)d=n;else var r=Sa.ot(Xa.j.vq,
c.Ni,r,q),l=g.dir_freq,t=g.dir_noise_scale,p=g.dir_noise_freq,m=g.dir_min_noise_fac,q=g.dst_min_fac,c=e/c.si/Math.PI,t=[t/e*(a+p*k),t/e*(b+p*k)],e=Math.sqrt(r),d=d*Math.max(r,g.dir_min_shore_fac)*Math.sin(e/c+l*k)*Math.max(Sa.zq(t),m),g=Math.max(e,q),d=d*(1-g)+n*g,h=h*r;else d=n;return f+(d+.05*h)}function ua(a,b){a.lk&&"POSTPROCESSING"==a.type&&b.tb!=a.tb&&(a.tb=b.tb);b.tb||"OUTLINE"!=a.type||(a.Eo=0)}function P(a,b,c,d){var e=Ba.Ja(a,b);N.Sm(e.k,c,d);e.In=!0;Ba.ag(a,b,function(b,e,f){f.kb&&f.from==
c&&ka.wz(f)&&oa(a,b,f.to,d)});Ba.af(a,b,function(b,e,f){f.kb&&f.from==c&&f.from==f.to&&P(a,b,c,d)})}function oa(a,b,c,d){a=Ba.Ja(a,b).p;for(b=0;b<a.length;b++)U.$D(a[b].B,d,c)}function la(a){var b=ja(a,"GRASS_MAP");if(b){var c=b.k,d=a.ng.f,e=d.i;a=Cc;a[0]=0;a[1]=-b.wc[2]/2;a[2]=0;kb.transformQuat(a,d.quat,a);a[0]+=e[0];a[1]=0;a[2]+=e[2];b=Uc;b[0]=0;b[1]=0;b[2]=0;b[3]=1;N.ov(c,a,b)}}function ea(a,b){Ba.W(a,function(c,d){if("MOTION_BLUR"==d.type){if(!d.wa[0]||!d.le[0])throw"Wrong MOTION_BLUR subscene";
var e=d.wa[0],f=d.le[0];d.le[0]=d.k.zb;Ba.ag(a,c,function(b,c,d){d.kb&&oa(a,b,d.to,f)});P(a,c,e.from,f);oa(a,c,e.to,d.le[0]);d.ou=Math.exp(-b/d.mb_factor)}})}function Y(a){return a.j.bf}var U=p("__batch"),ya=p("__boundings"),N=p("__camera");p("__compat");var qa=p("__config"),sa=p("__container");p("__constraints");var T=p("__debug"),Z=p("__geometry"),Ba=p("__graph"),Ra=p("__hud"),va=p("__mat4"),pa=p("__nodemat"),ma=p("__obj_util"),wa=p("__physics"),sb=p("__prerender"),ta=p("__primitives"),za=p("__print"),
Ka=p("__renderer"),ka=p("__scenegraph"),Bb=p("__sfx"),ra=p("__shaders"),Wa=p("__textures"),Sa=p("__util"),kb=p("__vec3"),Aa=qa.q,Ac=qa.Ab,Oa=qa.Ji,fc="GRASS_MAP SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY DEPTH OUTLINE_MASK WIREFRAME".split(" ");a.aH=fc;var $a="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT GOD_RAYS GOD_RAYS_COMBINE SKY LUMINANCE_TRUNCED DEPTH SHADOW_CAST COLOR_PICKING COLOR_PICKING_XRAY OUTLINE_MASK".split(" "),
tb="MAIN_OPAQUE SSAO MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),Bc="SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY DEPTH GOD_RAYS OUTLINE_MASK WIREFRAME".split(" "),ld="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),Ic=null,Xa=null,Ya=[],Ub=null,Zc=Math.PI/2,Gb=new Float32Array(2),Cc=new Float32Array(3),Uc=new Float32Array(4),tc=new Float32Array(16),
Vc=new Float32Array(24),cc=new Float32Array(24),Nb=ya.Ad(),Ob=ya.Ad(),Dc=0,gc=-Infinity;a.IH=function(){return{}};a.set_active=function(a){Xa=a;Bb.oE(a)};a.LD=function(a,b){var c=a.j,d=ka.cA(c.nb);if(a==b){ia(a,sa.XB(),sa.WB());for(var e=0;e<d.length;e++)a.j.oh.push(d[e])}else for(e=a.Qd[0],ia(a,e.j.sh,e.j.sh),e=0;e<d.length;e++)b.j.oh.push(d[e]);d=da(a,Bc);for(e=0;e<d.length;e++)d[e].bf.set(c.bf);for(e=0;e<c.oh.length;e++)"SHADOW_CAST"==c.oh[e].type&&Ka.Rj(c.oh[e])};a.ei=function(){Ic||(Ic=e(Ya));
return Ic};a.Zl=e;a.get_active=b;a.ka=function(){return Xa?!0:!1};a.di=function(a){return a.ng};a.ci=function(){return Ya};a.zt=function(){if(1==Ya.length)return Ya;for(var a=0;a<Ya.length;a++){var b=Ya[a].j.nb;Ba.W(b,function(b,c){for(var d=0;d<c.p.length;d++){for(var e=c.p[d].B.T,f=null,g=0;g<e.length;g++)if("SCENE"==e[g].source&&e[g].Aq==Ya[a].name&&"COPY"!=c.type){za.error('Texture-scene loop detected. A scene is rendered to texture "'+e[g].name+'" yet this texture belongs to the same scene.');
Ba.dh(Ub,Ya[a]);f=c.p[d].B;break}f&&(f.T=[],f.Vb=[],U.CF(f,null),U.Bb(f))}})}for(var c=[],a=0;a<Ya.length;a++)if(b=Ya[a],!b.Qd.length){b=Ba.dh(Ub,b);Ba.NA(Ub,b);b=Ba.Hq(Ub,b,Ba.tn);b=Ba.Sq(b);Ba.W(b,function(a,b){c.push(b)});break}return c};a.ry=function(a,b,e,r,m){a.Qd=a.Qd||[];a.X=null;var p=a.j,Z=a.ng.f;p.ij=[];var pa=a.world;p.yC=e.length;p.uh=f(e);p.Ym=k(pa,p.uh);p.or=F(pa,p.Ym);p.Hw=u(pa);p.iy=G(a,m);Z.R[0].type!=N.Xb&&Aa.anaglyph_use?(za.warn("Anaglyph stereo is disabled for the non-perspective camera"),
m=!1):m=Aa.anaglyph_use;p.anaglyph_use=m;p.Ii=g(a,b);p.Wy=x(a);p.fD=I(a);p.kz=A(a);p.ZB=B(a);p.uD=y(a);p.xf=v(a);p.Vh=Aa.Vh&&(0<Z.dof_distance||Z.Ce);p.bh=Aa.bh&&a.b4w_enable_motion_blur;p.Rh=Aa.Rh&&a.b4w_enable_color_correction;p.antialiasing=Aa.antialiasing&&"NONE"!=a.b4w_antialiasing_quality;p.ie=Aa.ie&&a.b4w_enable_ssao;p.fi=Aa.fi&&a.b4w_enable_god_rays&&p.uh;p.CA=Aa.Oj;p.bp=a.world.b4w_render_glow_over_blend;p.aF=n(a);m=d(r);p.bD=m;p.oc=C(a,m);p.ec=c(a,e,r);p.yb=t(r);p.df=M(r);p.NE=h(r);p.shore_smoothing=
l(r);p.Lb=q(r);p.Ez=D(a,r);p.outline=w(a,r);p.Ke=J(a,r);switch(a.b4w_reflection_quality){case "LOW":p.Dg=Oa.Ks;p.Bk=Oa.Lu;break;case "MEDIUM":p.Dg=Oa.rA;p.Bk=Oa.ED;break;case "HIGH":p.Dg=Oa.qA;p.Bk=Oa.DD;break;default:p.Dg=Oa.Ks,p.Bk=Oa.Lu}if(sa.pC())za.log("%cENABLE HIDPI MODE","color: #00a"),p.Ir="AA_QUALITY_LOW",p.yd=1;else switch(p.Ir="AA_QUALITY_"+a.b4w_antialiasing_quality,a.b4w_antialiasing_quality){case "LOW":p.antialiasing&&(p.yd=1);break;case "MEDIUM":Aa.quality==qa.P_LOW||Aa.quality==qa.P_HIGH?
p.yd=1:Aa.quality==qa.P_ULTRA&&(p.yd=1.33);break;case "HIGH":Aa.quality==qa.P_LOW?p.yd=1:Aa.quality==qa.P_HIGH?p.yd=1.33:Aa.quality==qa.P_ULTRA&&(p.yd=2);break;case "NONE":Aa.quality==qa.P_LOW||Aa.quality==qa.P_HIGH?p.yd=1:Aa.quality==qa.P_ULTRA&&(p.yd=2)}e=a.Qd.sort(function(a,b){return b.j.sh-a.j.sh});p.nb=ka.bA(p,Z,e);p.oh=[];p.zm=!1;p.Lp=!1;p.Mp=!1;p.bf=new Float32Array(3);Ya.push(a);Ub||(Ub=Ba.create());Ba.u(Ub,a);for(p=0;p<b.length;p++)ma.pq(b[p],!0,a);a=sa.get_container();sa.resize(a.clientWidth,
a.clientHeight,!0)};a.sy=function(a,b,c){for(var d=0;d<b.length;d++)b[d].j&&b[d].j.nk&&(b[d].j.fc=c,a.j.ij.push(b[d]))};a.wt=function(a){return a.j.nb};a.iB=function(a){Ba.W(a,function(b,c){var d=null;switch(c.type){case "POSTPROCESSING":d=U.Ml(c.Im);break;case "SSAO":d=U.iA(c);break;case "SSAO_BLUR":d=U.jA(c);break;case "DEPTH_PACK":d=U.Qz();break;case "REFRACT":case "COPY":d=U.Ml("NONE");break;case "GOD_RAYS":ka.Xa(a,c,"WIREFRAME")||ka.Xa(a,c,"MAIN_BLEND")||ka.Xa(a,c,"GOD_RAYS");d=U.Uz(c.Gu,c.gg,
c.Xi);break;case "GOD_RAYS_COMBINE":ka.Xa(a,c,"WIREFRAME")||ka.Xa(a,c,"MAIN_BLEND");ka.Xa(a,c,"GOD_RAYS");d=U.Vz();break;case "MOTION_BLUR":d=U.Zz();break;case "DOF":var d=U.Rz(),e=ka.Xa(a,c,"POSTPROCESSING"),f=ka.Xa(a,e,"POSTPROCESSING");ka.dc(e,c.k.dof_power);ka.dc(f,c.k.dof_power);break;case "OUTLINE":var d=U.$z(),e=ka.Xa(a,c,"POSTPROCESSING"),f=ka.Xa(a,e,"POSTPROCESSING"),g=ka.Xa(a,f,"POSTPROCESSING"),h=ka.Xa(a,g,"POSTPROCESSING");ka.dc(f,c.Rn);ka.dc(e,c.Rn);ka.dc(h,c.Lo*c.vk);ka.dc(g,c.Lo*c.vk);
break;case "GLOW_COMBINE":d=U.Tz();break;case "COMPOSITING":d=U.Oz();break;case "ANTIALIASING":d=U.Kz(c);break;case "SMAA_RESOLVE":case "SMAA_EDGE_DETECTION":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_NEIGHBORHOOD_BLENDING":d=U.gA(c.type);break;case "ANAGLYPH":d=U.Iz();break;case "SKY":d=U.aA();break;case "LUMINANCE":d=U.Wz();break;case "AVERAGE_LUMINANCE":d=U.Lz();break;case "LUMINANCE_TRUNCED":d=U.Xz();break;case "BLOOM_BLUR":d=U.Mz();break;case "BLOOM":d=ka.Xa(a,c,"BLOOM_BLUR");e=ka.Xa(a,
d,"BLOOM_BLUR");ka.dc(d,c.bloom_blur);ka.dc(e,c.bloom_blur);d=U.Nz();break;case "VELOCITY":d=U.mA();break;case "ANCHOR_VISIBILITY":d=U.Jz()}d&&(e=r(ma.Sh("NONE"),d),H(d),c.p.push(e),E(a,c,d),V(d))})};a.append_object=function(a,b,c){switch(b.type){case "MESH":var d=a.j.nb,e=b.f;!ka.Ya(d,"SHADOW_CAST")&&e.Ec&&(e.Ec=!1);e=da(a,fc);c&&wa.H(b)&&wa.append_object(b,a);for(var f=0;f<e.length;f++){var g=e[f],h=b,k=d,n=a,l=c;switch(g.type){case "MAIN_OPAQUE":K(g,h,k,"OPAQUE",n,l);break;case "MAIN_BLEND":K(g,
h,k,"BLEND",n,l);break;case "MAIN_XRAY":K(g,h,k,"XRAY",n,l);break;case "MAIN_GLOW":K(g,h,k,"GLOW",n,l);break;case "MAIN_PLANE_REFLECT":case "MAIN_CUBE_REFLECT":for(var m=h.f,q=ma.Oa(h,n).S,t=0;t<q.length;t++){var p=q[t];if(("MAIN"==p.type||"PARTICLES"==p.type)&&"REFLECT"==p.$a){if("MAIN_PLANE_REFLECT"==g.type){var Z;a:{Z=n.j.Ii.Lf;for(var pa=0;pa<Z.length;pa++)if(Z[pa]==g){Z=pa;break a}Z=null}if(Z==m.Wc)continue}else{a:{if(n.j.Ii)for(Z=n.j.Ii.qf,pa=0;pa<Z.length;pa++)if(Z[pa]==g){Z=pa;break a}Z=null}if(Z==
m.od)continue}l||(z(p,g,h,k,"REFLECT",n),Z=p.ib,ra.G(Z,"DISABLE_FOG",0),ra.G(Z,"WATER_EFFECTS",0),"special_skydome.glslf"==ra.ut(Z)&&ra.G(Z,"REFLECTION_PASS",1),ra.G(Z,"TEXTURE_NORM",0),U.Bb(p),H(p));g.p.push(r(m,p))}}break;case "DEPTH":m=ma.Oa(h,n).S;for(q=0;q<m.length;q++)t=m[q],"DEPTH"!=t.type||t.Dc||"DEPTH"!=t.$a&&"NODES"!=t.$a||(l||(z(t,g,h,k,"DEPTH",n),U.Bb(t),H(t)),g.p.push(r(h.f,t)),E(k,g,t),V(t));break;case "SHADOW_CAST":m=!1;q=h.f;h=ma.Oa(h,n).S;t=ka.Ya(k,"GRASS_MAP");for(p=0;p<h.length;p++)Z=
h[p],"DEPTH"==Z.type&&"SHADOW_CAST"==Z.$a&&(m=!0,l||(pa=g.tk,U.oa(Z,"NUM_LIGHTS",pa),U.oa(Z,"NUM_LFACTORS",0==pa%2?pa/2:Math.floor(pa/2)+1),ra.G(Z.ib,"SHADOW_USAGE","SHADOW_CASTING"),Z.Lb&&t&&ba(Z,t,q),U.oa(Z,"SHADOW_TEX_RES",ra.r(n.j.ec.csm_resolution)),U.Bb(Z),H(Z)),g.p.push(r(q,Z)));m&&(h=n.j.ec,n=ka.Ya(k,"MAIN_OPAQUE"),Q(g,n.k,g.p,h,!0));break;case "COLOR_PICKING":ha(g,h,k,n,l);break;case "COLOR_PICKING_XRAY":ha(g,h,k,n,l);break;case "OUTLINE_MASK":k=h.f;h=ma.Oa(h,n).S;for(n=0;n<h.length;n++)m=
h[n],"COLOR_ID"==m.type&&"OUTLINE"==m.$a&&(l||(U.oa(m,"USE_OUTLINE",1),U.Bb(m),H(m)),g.p.push(r(k,m)));break;case "GRASS_MAP":k=h.f;h=ma.Oa(h,n).S;for(n=0;n<h.length;n++)m=h[n],"GRASS_MAP"==m.type&&(l||(U.Bb(m),H(m)),g.p.push(r(k,m)),m=g.k,Z=k.sb,q=g.wc[0],t=g.wc[1],p=g.wc[2],0==q&&0==t?(q=Z.min_y,t=Z.max_y):(q=Math.min(q,Z.min_y),t=Math.max(t,Z.max_y)),Z=1E-4*(t-q),g.wc[0]=q-Z,g.wc[1]=t+Z,N.Tm(m,p/2,-t,-q,p/2),N.Sf(m));break;case "WIREFRAME":for(m=h.f,h=ma.Oa(h,n).S,n=0;n<h.length;n++)q=h[n],"WIREFRAME"==
q.type&&aa(g,m,k,l,q)}}break;case "LAMP":R(b,a)}ma.pq(b,!0,a)};a.qq=function(a){a.j.zm=!0};a.EB=function(a,b){for(var c=a.j.ec,d=new Float32Array(c.csm_num),e=0;e<c.csm_num;e++)d[e]=N.pA(c,b,e);return d};a.iH=aa;a.hide_object=function(a){a.f.ii=!0};a.show_object=function(a){a.f.ii=!1};a.is_hidden=function(a){return a.f.ii};a.UD=function(a,b,c){b=b.f;a=da(a,fc);for(var d=0;d<a.length;d++)for(var e=a[d].p,f=e.length-1;0<=f;f--){var g=e[f];g.Jd==b&&(g.B&&c&&Z.ws(g.B.N),e.splice(f,1))}};a.OF=function(a,
b){for(var c=a.Fa,d=ma.Oa(a,b).ni,e=da(b,$a),f=0;f<e.length;f++){var g=e[f];g.sm.set(c.Fj,3*d);g.ua=!0}};a.hn=R;a.cleanup=function(){for(var a=0;a<Ya.length;a++){var b=Ya[a];Ba.W(b.j.nb,function(a,b){if("SINK"!=b.type){var c=b.k;Ka.XD(c.Ie,c.zb,c.pd,c.width,c.height);for(var c=b.p,d=0;d<c.length;d++){var e=c[d].B;e&&U.Dz(e)}}});b.j.nb=[];b.j.oh=[]}Xa=Ic=null;Ya.length=0;Ub=null};a.ku=function(a,b,c){a=N.UA(a,a.ob,a.mb,null,!0);var d=ta.nB(a);a=ma.Sh("DYNAMIC");a.sb=a.Qb={max_x:1E12,min_x:-1E12,max_y:1E12,
min_y:-1E12,max_z:1E12,min_z:-1E12};a.Rb=a.nd=ya.Ty();var e=a.Rb.Ua;a.ug=a.kf=ya.Kl([e,0,0],[0,e,0],[0,0,e],a.Rb.F);c=U.fA(d,c);b.p.push(r(a,c))};a.lI=function(a){return[a.frame_start,a.frame_end]};a.pv=function(a,b,c){sa.HE(a,b,c);Xa&&ia(Xa,a,b)};a.eJ=ia;a.Pv=da;a.ea=ja;a.get_environment_colors=function(a){a=da(a,$a)[0];var b=a.yf,c=a.kg,d=[],e=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];e[0]=c[0];e[1]=c[1];e[2]=c[2];return[a.uf,d,e]};a.set_environment_colors=function(a,b,c,d){a=da(a,$a);for(var e=0;e<a.length;e++){var f=
a[e];isNaN(b)||(f.uf=b);c&&f.yf.set(c);d&&f.kg.set(d);f.ua=!0}};a.get_sky_params=function(a){if(a=ja(a,"SKY")){var b={};b.color=Array(3);kb.copy(a.Pi,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=
a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.set_sky_params=function(a,b){var c=ja(a,"SKY");c&&("number"==typeof b.procedural_skydome&&(c.procedural_skydome=b.procedural_skydome),"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.Pi.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),
"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&
(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.ua=!0,c.ym=!0,W(a,c))};a.get_fog_color_density=function(a,b){var c=b||[],d=da(a,tb)[0].gc;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.set_fog_color_density=function(a,b){for(var c=da(a,tb),d=0;d<c.length;d++){var e=c[d];e.gc.set(b);e.ua=!0}};a.get_ssao_params=function(a){var b=ja(a,"SSAO");a=ja(a,"SSAO_BLUR");if(!b)return null;var c=b.p[0].B,d={};d.ssao_quality=U.Mb(c,
"SSAO_QUALITY")[1];d.ssao_hemisphere=b.ssao_hemisphere;d.ssao_blur_depth=a.ssao_blur_depth;d.es=a.ssao_blur_discard_value;d.radius_increase=b.Ti;d.influence=b.Si;d.dist_factor=b.Ri;d.ssao_only=b.ssao_only;d.ssao_white=U.Mb(c,"SSAO_WHITE")[1];return d};a.set_ssao_params=function(a,b){var c=ja(a,"SSAO"),d=ja(a,"SSAO_BLUR");if(!c)return za.error("SSAO is not enabled on the scene"),0;if("string"==typeof b.ssao_quality){var e=c.p[0].B;U.oa(e,"SSAO_QUALITY",b.ssao_quality);U.Bb(e,!0)}"number"==typeof b.ssao_hemisphere&&
(e=c.p[0].B,U.oa(e,"SSAO_HEMISPHERE",b.ssao_hemisphere),U.Bb(e,!0));"number"==typeof b.ssao_blur_depth&&(e=d.p[0].B,U.oa(e,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),U.Bb(e,!0));"number"==typeof b.ssao_blur_discard_value&&(d.ssao_blur_discard_value=b.ssao_blur_discard_value);"number"==typeof b.Ti&&(c.Ti=b.Ti);"number"==typeof b.Si&&(c.Si=b.Si);"number"==typeof b.Ri&&(c.Ri=b.Ri);if("number"==typeof b.ssao_only){c=ja(a,"MAIN_OPAQUE");c.ssao_only=b.ssao_only;for(var f=0;f<c.p.length;f++)e=c.p[f].B,U.oa(e,
"SSAO_ONLY",b.ssao_only),U.Bb(e,!0)}"number"==typeof b.ssao_white&&(e=c.p[0].B,U.oa(e,"SSAO_WHITE",b.ssao_white),U.Bb(e,!0));c.ua=!0;d.ua=!0};a.get_dof_params=function(a){a=ja(a,"DOF");if(!a)return null;var b={};b.dof_distance=a.k.dof_distance;b.dof_front=a.k.dof_front;b.dof_rear=a.k.dof_rear;b.dof_power=a.k.dof_power;b.Ce=a.k.Ce;return b};a.set_dof_params=ga;a.get_god_rays_params=function(a){var b=da(a,["GOD_RAYS"]);a=ja(a,"GOD_RAYS_COMBINE");if(!b||!a)return null;var c={};c.god_rays_max_ray_length=
b[0].ri;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=U.Mb(b[0].p[0].B,"STEPS_PER_PASS")[1];return c};a.set_god_rays_params=function(a,b){var c=da(a,["GOD_RAYS"]),d=ja(a,"GOD_RAYS_COMBINE");if(!c||!d)return za.error("God Rays are not enabled on the scene"),0;"number"==typeof b.god_rays_intensity&&(d.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var e=b.god_rays_max_ray_length,f=0;f<c.length;f++)c[f].ri=e,c[f].Nm=e/c[f].Xi/(f+1),c[f].ua=!0;
if("number"==typeof b.god_rays_steps)for(var g=ra.r(b.god_rays_steps,1),e=c[0].ri,f=0;f<c.length;f++){c[f].Xi=g;c[f].Nm=e/g/(f+1);c[f].ua=!0;var h=c[f].p[0].B;U.oa(h,"STEPS_PER_PASS",g);U.Bb(h,!0)}d.ua=!0};a.get_bloom_params=function(a){var b=ja(a,"LUMINANCE_TRUNCED");a=ja(a,"BLOOM");if(!b||!a)return null;var c={};c.bloom_key=b.bloom_key;c.bloom_edge_lum=b.bloom_edge_lum;c.bloom_blur=a.bloom_blur;return c};a.set_bloom_params=L;a.get_glow_material_params=function(a){a=ja(a,"GLOW_COMBINE");if(!a)return null;
var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.set_glow_material_params=O;a.get_wind_params=function(a){a=Y(a);var b=kb.length(a);if(0==b)return null;var c={};c.wind_dir=180*Math.atan(a[0]/a[2])/Math.PI;c.wind_strength=b;return c};a.lE=function(a){a.j.Lp=!0};a.get_water_surface_level=S;a.get_water_mat_params=function(a,b){var c=ja(a,
"MAIN_OPAQUE");if(c&&(b.waves_height=c.ig,b.waves_length=c.Hh,c.Pd)){b.water_fog_density=c.Pd[3];var d=b.water_fog_color=[];d[0]=c.Pd[0];d[1]=c.Pd[1];d[2]=c.Pd[2]}};a.set_water_params=function(a,b){var c=ja(a,"MAIN_OPAQUE");if(!c||!c.yb)return za.error("set_water_params() - no water parameters on the scene"),null;c=c.yb;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&
(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&
(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.Sj=b.water_dynamic);for(var d=da(a,ld),e=0;e<d.length;e++){var f=d[e];"number"==typeof b.water_fog_density&&c.gc&&(f.Pd[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.gc&&f.Pd.set(b.water_fog_color);"number"==typeof b.waves_height&&(f.ig=b.waves_height);"number"==typeof b.waves_length&&(f.Hh=b.waves_length);f.ua=!0}};a.get_shore_dist=function(a,b){var c=
ja(Xa,"MAIN_OPAQUE");if(!c.mn)return 100;var d=c.si,e=c.hg,f=(a[0]-c.Uf[0])/c.Vf[0],g=(c.Uf[1]+a[2])/c.Vf[1],f=f+.5,g=g+.5;if(1<f||0>f||1<g||0>g)e=1;else return c=d*Sa.ot(Xa.j.vq,c.Ni,f,g),e=(e-a[1])*b,e=Math.sqrt(c*c+e*e)};a.update=function(a,c){for(var d=b().ng.f,e=0;e<Ya.length;e++){var f=Ya[e],g=f.j.nb,h=f.j;if(h.yb)var k=d.i[1]-S(d.i[0],d.i[2]);for(var n=0;n<h.ij.length;n++){var l=h.ij[n].j,m=l.L,r=l.pc;if(!(f.b4w_use_nla&&l.ln||!m&&!r)&&Wa.yw(l)){var r=Wa.ww(l),q=Wa.vG(l);m&&Aa.Tg&&(q-=5);var t=
Wa.uG(l);if(r>=t)if(l.dj)Wa.reset_video(l.name,l.fc),r=q;else{Wa.pause_video(l.name,l.fc);continue}r<q&&Wa.reset_video(l.name,l.fc);Wa.zw(l)&&(m?Wa.ar(l):(m=Wa.kv(l,a),m!=l.Rm&&(Wa.gw(l),l.rh++),l.Rm=m))}}Ba.W(g,function(b,c){-1<Bc.indexOf(c.type)&&(c.time=a);h.yb&&(c.$n=k)})}for(e=0;e<Ya.length;e++)if(f=Ya[e],h=f.j,g=h.nb,d=h.oh,d.length)for(h.zm&&(X(f),h.zm=!1),h.Lp&&(la(f),h.Lp=!1),h.Mp&&(fa(f),h.Mp=!1),h.bh&&ea(g,c),f=ka.Ya(g,"OUTLINE_MASK"),n=0;n<d.length;n++)g=d[n],sb.aq(g),f&&ua(g,f),Ka.Rj(g);
Aa.show_hud_debug_info&&Ra.LE(Ya,c)};a.aE=function(a){a.j.Mp=!0};a.Wo=function(a){var b=[];Ba.W(a.j.nb,function(a,c){b.push(c)});return b};a.get_cam_water_depth=function(){var a=ja(Xa,"MAIN_BLEND"),b=Xa;return a||b.j.yb?a.$n:null};a.get_object_data_id=function(a){return a.f.uc};a.$q=function(a){Ba.W(a.j.nb,function(a,b){b.ua=!0})};a.FE=function(a,b){a.tb=b!=T.WM_NONE;for(var c=0;c<a.p.length;c++)a.p[c].B.wireframe_mode=b;a.Ra=b==T.WM_TRANSPARENT_WIREFRAME;a.ua=!0};a.EE=function(a,b){for(var c=0;c<
a.p.length;c++)a.p[c].B.wireframe_edge_color=b,a.ua=!0};a.NF=function(a,b){var c=b.Xh,d=a.j.bf;if(c&&"WIND"==c.type&&d){Sa.quat_to_dir(b.f.quat,Sa.AXIS_Y,d);kb.normalize(d,d);kb.scale(d,c.Mv,d);for(var c=da(a,Bc),e=0;e<c.length;e++)c[e].bf.set(d)}};a.yD=function(a,b,c){var d=ja(a,"COLOR_PICKING");if(d)return b=sa.bo(b,c,Gb,d.k),sb.aq(d),Ka.Rj(d),(a=ja(a,"COLOR_PICKING_XRAY"))?(sb.aq(a),Ka.Rj(a),d=a.k):d=d.k,b[1]=d.height-b[1],Ka.Zu(d.Ie,b[0],b[1]);za.error("Object Selection is not available on the scene");
return null};a.set_outline_color=function(a){var c=b();if(c=ja(c,"OUTLINE"))c.Se.set(a),c.ua=!0};a.qI=Y;a.get_meta_tags=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.bw=function(a,b){var c=Cc;kb.negate(b,c);for(var d=0;6>d;d++){var e=a.Lj[d],f=a.ro[d],g=a.k;va.translate(Sa.Ow[d],c,e);va.multiply(g.Ga,e,g.Od);Sa.Yl(g.Od,f)}};a.ew=function(a,b,c){Sa.rF(b,c,Sa.AXIS_Y,a.k.mc)};a.Ny=function(a,b,c){var d=a.j.ec,e=a.j.Ii;
c=ma.Zo(c)||c[0];for(var f=0;f<b.length;f++){var g=b[f],h=ma.Oa(g,a);if(e)if(null!=g.f.Wc){var k=e.Lf;if(k.length){var n=g.f.Wc;h.Lf=k[n]}}else null!=g.f.od&&(k=e.qf,k.length&&(n=g.f.od,h.qf=k[n]));d&&g==c&&(h.tv=da(a,["SHADOW_CAST"]))}};a.marker_frame=function(a,b){return a.timeline_markers[b]}};b4w.module.__physics=function(a,p){function e(a,b){for(var c=a.Dd,d=0;d<c.length;d++)c[d].Kd.Wk&&b.push(c[d]),e(c[d],b)}function b(a,b,c){for(var d=a.jb.p,e=0;e<d.length;e++)for(var f=d[e].m,g=0;g<f.tc.length;g++){var h=f.tc[g];"ANY"!=h.Ia&&c!=h.Ia||F(h,a,b)}}function c(a,b,c){if(z.mm(a))switch(b){case z.Xw:var d=m(a);d.jb.Gw=!0;z.v(a,z.Ex,Date.now()-performance.now(),na.Id,na.Yn?ia.gt:0);break;case z.Yw:ba.Dp("URANIUM:",c.slice(1));break;case z.Tw:ba.error(c);break;case z.Uw:K.fbmsg.apply(this,c.slice(1));
break;case z.cx:var e=f(c.t);if(e){a=c.i;d=c.quat;b=c.be;var g=c.Rd,e=e.m;e.Pl=c.time;ha.set_sep(a,1,d,e.uo);R.copy(b,e.be);R.copy(g,e.Rd)}break;case z.$w:(a=f(c.co))&&ha.set_sep(c.i,1,c.quat,a.l.Ck[c.cq]);break;case z.Vw:if(d=f(c[1]))a=c[4],d=d.rd.yl[c[2]],Q.set_translation(d,c[3]),Q.set_rotation(d,a),Q.o(d);break;case z.dx:if(e=f(c[1]))e.l.speed=c[2];break;case z.Pw:d=m(a);l(d,c.vg,c.wg,c.result,null,null,0);break;case z.Rw:d=m(a);l(d,c.vg,c.wg,c.result,c.Bg,c.coll_norm,c.coll_dist);break;case z.Qw:if(e=
f(c[1]))a=e.m,a.Ag&&a.Ag(c[2]);break;case z.wr:case z.ax:d=m(a);if(a=d.jb.Of[c.id])if(d=f(c.Ph),b==z.wr)b=a.callback,b(a.id,c.hit_fract,d,c.hit_time);else{b=c.hit_fract;var g=c.hit_time,e=c.hit_pos,h=a.callback;e?h(a.id,b,d,g,e,c.hit_norm):h(a.id,b,d,g)}break;case z.bx:D(id);break;case z.Zw:a=ga.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case z.Ww:ja=c[1];break;
case z.Sw:a=ga.indexOf(a);console.log("Worker: #"+String(a));console.log(c[1]);break;default:ba.error("Wrong message: "+b)}}function m(a){for(var b=0;b<ga.length;b++)if(ga[b]==a)return L[b]}function f(a){return O[a]||null}function l(a,b,c,d,e,g,k){a=a.jb.p;for(var n=0;n<a.length;n++)for(var l=a[n].m,m=0;m<l.tc.length;m++){for(var r=l.tc[m],q=r.Jf,t=!1,p=0;p<q.length;p++){var u=q[p];if(u[0]===b&&u[1]===c){r.wk[p]=d;t=!0;break}}t&&(q=h(r),e&&r.Sn!=b&&(t=e,p=g,u=k,t[0]+=p[0]*u,t[1]+=p[1]*u,t[2]+=p[2]*
u,p[0]*=-1,p[1]*=-1,p[2]*=-1),r.callback(q,q?r.Sn==b?f(c):f(b):null,e,g,k))}}function h(a){a=a.wk;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function t(){P.body++;return P.body}function d(a){if("ANY"==a)return 0;var b=ua.indexOf(a);return-1==b?(ua.push(a),ua.length-1):b}function g(a){return{t:a,ce:0,nm:!1,Wf:!0,xc:!1,is_character:!1,nC:!1,Hl:null,Ia:"",Cj:0,DH:{},tc:[],Ag:null,Pl:0,uo:new Float32Array([0,0,0,1,0,0,0,1]),be:new Float32Array(3),Rd:new Float32Array(3),Cl:new Float32Array(3),
Bl:new Float32Array(4)}}function k(a,b){switch(a){case "BOX":var c=b.Qb;break;case "CYLINDER":c=b.Mn;break;case "CONE":c=b.Ln;break;case "SPHERE":c=b.nd;break;case "CAPSULE":c=b.Kn}return c}function n(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);
"object"===typeof a.F&&(b.center=a.F);"number"===typeof a.Ua&&(b.radius=a.Ua);"number"===typeof a.height&&(b.height=a.height);return b}function x(a,b,c,d,e){var f=a.f.i,g=b.f.aa,h=new Float32Array(16);H.invert(g,h);g=new Float32Array(3);R.transformMat4(f,h,g);switch(b.l.type){case 10:b=b.Hc;a=a.f.Qb;z.v(e,z.hx,c,g,b.kF,b.lq,(a.max_y-a.min_y)/2,d);break;case 20:z.v(e,z.gx,c,g,a.mJ)}}function I(a){return a.m&&a.m.Hl}function A(a,b,c,d,e,f,g,h,k,n){var l;P.Sa++;l=P.Sa.toString(16);var m=b.m.t;z.v(B(m),
z.ox,l,a,h,m,c,d,e.m.t,f,g,k,n);b.m.Hl=l}function B(a){for(var b=0;b<L.length;b++)for(var c=L[b].jb.p,d=0;d<c.length;d++)if(c[d].m.t==a)return ga[b];return null}function y(a){var b=a.m;if(b&&(0===b.ce||!0===b.nm||!1===b.Wf||"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type)&&(a.f.i[0]!=a.m.Cl[0]||a.f.i[1]!=a.m.Cl[1]||a.f.i[2]!=a.m.Cl[2]||a.f.quat[0]!=a.m.Bl[0]||a.f.quat[1]!=a.m.Bl[1]||a.f.quat[2]!=a.m.Bl[2])){var b=a.m,c=a.f;R.copy(c.i,b.Cl);X.copy(c.quat,b.Bl);var d=z.yt(z.gl);d.t=b.t;d.i=c.i;"DYNAMIC"==
b.type?X.identity(d.quat):d.quat=c.quat;z.v(B(b.t),z.gl)}a=a.Dd;for(b=0;b<a.length;b++)y(a[b])}function v(a,b,c,d,e){e=e||new Float32Array(3);a=a.f.quat;e[0]=b;e[1]=c;e[2]=d;R.transformQuat(e,a,e)}function F(a,b,c){var d=a.Jf,e=a.wk,f=a.Sn,g=[],h=a.Ia;if(!g)throw"At least one destination required";for(var k=0;k<b.jb.p.length;k++){var n=b.jb.p[k];if("ANY"==h||n.m.Ia==h)n=n.m.t,g&&-1==g.indexOf(n)&&g.push(n)}for(b=0;b<g.length;b++)h=g[b],f<h&&!u(d,f,h)?(d.push([f,h]),e.push(!1)):f>h&&!u(d,h,f)&&(d.push([h,
f]),e.push(!1));z.v(c,z.fx,f);z.v(c,z.nx,d,a.Xd)}function u(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function q(a){a.m&&a.m.Ag&&(a=a.m,z.v(B(a.t),z.Ax,a.t),a.Ag=null)}function D(a){var b=J(a),c=w(a).jb;c.Of[a]&&(delete c.Of[a],c.gq.splice(c.gq.indexOf,1),z.v(b,z.Jx,a))}function w(a){for(var b=0;b<L.length;b++){var c=L[b];if(c.jb.Of[a])return c}return null}function J(a){for(var b=0;b<L.length;b++)if(L[b].jb.Of[a])return ga[b];return null}function C(a,b,c){if(b.Wi){a=
a.m.t;var d=b.Wh*b.Xj,e=b.uj*b.vj,f=-b.Ui*b.Vi*2*Math.PI/b.Nk;b.ik&&(f*=-1);switch(b.type){case 10:z.v(c,z.Wx,a,d,e,f);break;case 20:z.v(c,z.Vx,a,d,e,f)}}}function M(a){return a.xc&&"CHASSIS"==a.Hc.zc}function G(a){return a.xc&&"HULL"==a.Hc.zc}function E(a){return a.Sg&&"MAIN_BODY"==a.Yh.zc}var r=p("__config");p("__constraints");var K=p("__debug"),z=p("__ipc"),H=p("__mat4"),V=p("__obj_util"),ba=p("__print"),X=p("__quat");p("__renderer");var fa=p("__scenes"),Q=p("__transform"),ha=p("__tsr"),aa=p("__util"),
R=p("__vec3"),W=p("__version"),na=r.m,ia=r.q,da=r.Sd,ja=0,ga=[],L=[],O={},S=[],ua=[],P={body:0,Sa:0,Wu:0},oa=new Float32Array(3),la=new Float32Array(4),ea=new Float32Array(4),Y=new Float32Array(16),U=new Float32Array(8),ya=new Float32Array(8);a.iC=function(a){a.jb={Gw:!1,p:[],Of:{},gq:[]};var b=na.Uk;da.bq&&(b+=W.timestamp());ba.log("%cLOAD PHYSICS","color: #0a0",na.Yk?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+na.Id);ba.log("%cPHYSICS PATH","color: #0a0",b);var d=z.nA(b,!na.Yk);
z.Py(d,c);ga.push(d);L.push(a);na.ping&&setInterval(function(){z.v(d,z.Gx,performance.now())},1E3)};a.xz=function(a){return a.jb?a.jb.Gw:!0};a.cleanup=function(){for(var a=0;a<ga.length;a++)z.terminate(ga[a]);ga.length=0;L.length=0;O={};S.length=0;ua.length=0;for(var b in P)P[b]=0};a.append_object=function(a,c){if(!a.f)throw"No object render: "+a.name;var f;a:{for(var h=0;h<L.length;h++)if(L[h]==c){f=ga[h];break a}f=void 0}var l=[];a.Kd.Wk&&e(a,l);var m=c.jb.p;if(M(a)||G(a)||a.is_character||E(a)||
a.fj){var r,q=a,p=f,u=q.f,wa=q.Kd,v=wa.Hm,w=t();if("CAMERA"==q.type)var y=wa.br?wa.El:"BOX",F=k(y,u),D=u.$j,B=u.Uj,D=.5,B=0;else"EMPTY"==q.type?(y="EMPTY",F=null,B=D=0):(y=wa.br?wa.El:"BOX",F=k(y,u),D=u.$j,B=u.Uj);var K=u.i,P=u.quat,ua=wa.Xk,J=wa.mw,da=wa.ce,oa=wa.rw,la=wa.qw,Q=wa.wo,ja=wa.nq,U=q.Ia,W=d(U),ha=wa.Dj,ya=wa.Bj,na=wa.Ej,Ya=u.nd.Ua,Ub=n(F),Zc=q.Jl,Gb;var Cc=y;if(l.length){var Uc=[],tc={};tc.quat=new Float32Array([0,0,0,1]);tc.trans=new Float32Array(3);tc.worker_bounding=Ub;tc.bounding_type=
Cc;Uc.push(tc);H.invert(u.aa,Y);X.invert(u.quat,ea);for(var Vc=0;Vc<l.length;Vc++){var cc={},Nb=l[Vc],Ob=Nb.Kd.El,Dc=new Float32Array(4),gc=new Float32Array(3);R.transformMat4(Nb.f.i,Y,gc);X.multiply(ea,Nb.f.quat,Dc);cc.trans=gc;cc.quat=Dc;cc.bounding_type=Ob;cc.worker_bounding=n(k(Ob,Nb.f));Uc.push(cc)}Gb=Uc}else Gb=[];z.v(p,z.kx,w,K,P,v,ua,J,da,oa,la,Q,ja,W,ha,ya,na,y,Ub,Ya,D,B,Gb,Zc);O[w]=q;S.push(q);var ia=g(w);ia.type=v;ia.ce=da;ia.nm=ua;ia.Ia=U;ia.Cj=W;r=ia;a.m=r;var gd={B:null,m:r};m.push(gd);
b(c,f,r.Ia)}else for(var md=V.Oa(a,c).S,Pb=0;Pb<md.length;Pb++){var rc=md[Pb],eb;if(eb="PHYSICS"==rc.type){var Ia;a:{for(var Ec=c.jb.p,xb=0;xb<Ec.length;xb++){var Da=Ec[xb].B;if(Da&&Da.id==rc.id){Ia=!0;break a}}Ia=!1}eb=!Ia}if(eb)if(rc.cd.P)if(rc.gg&&c.j.yb){var yb=rc,ca=c,pb=f,Ga=fa.ea(ca,"MAIN_OPAQUE");z.v(pb,z.tx,Ga.hg);if(Ga.yb&&yb.AG){var xa={};xa.dst_noise_scale0=yb.dst_noise_scale0;xa.dst_noise_scale1=yb.dst_noise_scale1;xa.dst_noise_freq0=yb.dst_noise_freq0;xa.dst_noise_freq1=yb.dst_noise_freq1;
xa.dir_min_shore_fac=yb.dir_min_shore_fac;xa.dir_freq=yb.dir_freq;xa.dir_noise_scale=yb.dir_noise_scale;xa.dir_noise_freq=yb.dir_noise_freq;xa.dir_min_noise_fac=yb.dir_min_noise_fac;xa.dst_min_fac=yb.dst_min_fac;xa.waves_hor_fac=yb.waves_hor_fac;var Fa=Ga.ig,La=Ga.Hh;Ga.mn?z.v(pb,z.yr,xa,Ga.Vf[0],Ga.Vf[1],Ga.Uf[0],Ga.Uf[1],Ga.si,Fa,La,Ga.Ni,ca.j.vq):z.v(pb,z.yr,xa,0,0,0,0,0,Fa,La,0,null)}}else{var Qb;if(rc.Xk){var Ua=a,lb=rc,Fb=f,Cb=t(),uc=lb.cd,sc=uc.A[0].a_position,hc=uc.ra||null,Ta=lb.Ia,jb=d(Ta);
z.v(Fb,z.qx,Cb,sc,hc,Ua.f.i,jb,lb.Dj,lb.Bj,lb.Ej);var ic=g(Cb);ic.nm=!0;ic.Ia=Ta;ic.Cj=jb;Qb=ic}else{var Jc=a,Rb=rc,ub=f,zb=t(),Qa=Rb.cd,fb=Qa.A[0].a_position,Vb=Qa.ra||null,Lb=Jc.f.i,Wb=Rb.$j,Db=Rb.Uj,jc=Rb.Ia,mb=d(jc);z.v(ub,z.sx,zb,fb,Vb,Lb,Wb,Db,mb,Rb.Dj,Rb.Bj,Rb.Ej);var Xb=g(zb);Xb.Ia=jc;Xb.Cj=mb;Qb=Xb}r=Qb;gd={B:rc,m:r};m.push(gd);b(c,f,r.Ia)}else ba.error("Object "+a.name+" has collision material with no assigned vertices")}if(M(a)||G(a)){var Pa=a,gb=f,ab=Pa.m.t;M(Pa)?(Pa.l.type=10,z.v(gb,
z.lx,ab,Pa.l.Kq,Pa.l.Mq,Pa.l.Lq,Pa.l.nr,Pa.l.Hp)):G(Pa)&&(Pa.l.type=20,z.v(gb,z.jx,ab,Pa.l.Kg,Pa.l.Fh,Pa.l.Gh));if(Pa.l.nh){var Va=Pa.l.nh;switch(Pa.l.type){case 10:x(Va[1],Pa,ab,!0,gb);x(Va[0],Pa,ab,!0,gb);x(Va[3],Pa,ab,!1,gb);x(Va[2],Pa,ab,!1,gb);break;case 20:for(var Za=0;Za<Va.length;Za++)x(Va[Za],Pa,ab,!1,gb)}}C(a,a.l,f)}else if(a.is_character){var bb=f,nb=a.f,Eb=a.m,Ca=nb.Qb.max_y-nb.Qb.min_y,cb=Eb.t,db=a.qs,Sb=db.zG,Ha=db.gE,kc=db.bF,lc=db.wC,Hb=db.BG,Ib=aa.EA(a);z.v(bb,z.mx,cb,Ib,Ca,Sb,Ha,
kc,lc,Hb);Eb.is_character=!0}else if(E(a)){var hb=a,Ab=f,dc=hb.m.t;z.v(Ab,z.px,dc,hb.rd.Kg,hb.rd.Fh,hb.rd.Gh);if(hb.rd.yl)for(var ib=hb.rd.yl,Ea=0;Ea<ib.length;Ea++){var qb=ib[Ea],vc=qb.f.i,ob=hb.f.aa,Tb=new Float32Array(16);H.invert(ob,Tb);var Jb=new Float32Array(3);R.transformMat4(vc,Tb,Jb);z.v(Ab,z.ix,dc,Jb,qb.Yy)}hb.m.nC=!0}for(Pb=0;Pb<S.length;Pb++)if(a=S[Pb],a.m){var Kb=a;if(!I(Kb))for(var vb=0;vb<Kb.Zp.length;vb++){var Na=Kb.Zp[vb],ec=Na.target,Mb=Na.zD;if(ec.m){var wb=new Float32Array([Na.AD,
Na.BD,Na.CD]),Yb,mc=new Float32Array([Na.Td,Na.Ud,Na.Vd]);Yb=aa.euler_to_quat(mc,new Float32Array(4));var wc=H.fromRotationTranslation(Yb,wb,new Float32Array(16)),nc=H.multiply(Kb.f.aa,wc,new Float32Array(16)),oc=H.invert(ec.f.aa,new Float32Array(16)),Fc=H.multiply(oc,nc,oc),Kc=aa.pi(Fc),Zb=aa.matrix_to_quat(Fc),Ja=Na,Ma={};Ma.use_limit_x=Ja.eG;Ma.use_limit_y=Ja.fG;Ma.use_limit_z=Ja.gG;Ma.use_angular_limit_x=Ja.$F;Ma.use_angular_limit_y=Ja.aG;Ma.use_angular_limit_z=Ja.bG;Ma.limit_max_x=Ja.GC;Ma.limit_min_x=
Ja.JC;Ma.limit_max_y=Ja.HC;Ma.limit_min_y=Ja.KC;Ma.limit_max_z=Ja.IC;Ma.limit_min_z=Ja.LC;Ma.limit_angle_max_x=Ja.AC;Ma.limit_angle_min_x=Ja.DC;Ma.limit_angle_max_y=Ja.BC;Ma.limit_angle_min_y=Ja.EC;Ma.limit_angle_max_z=Ja.CC;Ma.limit_angle_min_z=Ja.FC;A(Mb,Kb,wb,Yb,ec,Kc,Zb,Ma,null,null)}}}};a.ZA=f;a.update=function(a,b){for(var c=0;c<ga.length;c++){var d=ga[c],e=a;d&&z.Ut(d)&&z.v(d,z.Xx,e,b);for(var f=0;f<S.length;f++){var g=S[f],h=g.m;if(h.Wf&&h.Pl){var k=z.Ut(d)?e-h.Pl:performance.now()/1E3-h.Pl,
k=Math.min(k,10/na.Id),k=k-1/na.Id;ia.mD&&(k=0);var n=U;ha.jC(h.uo,k,h.be,h.Rd,U);Q.set_tsr(g,n);Q.o(g);y(g);if(g.l)for(var h=g,k=h.l.nh,n=h.f.Ba,l=U,m=0;m<k.length;m++){var r=k[m];ha.multiply(n,h.l.Ck[m],l);Q.set_tsr(r,l);Q.o(r)}g.l&&g.l.Wi&&(h=g.l,k=h.Wi)&&(n=g.l.Jv,r=Y,l=g.f.i,m=g.f.quat,aa.Uq(g.l.Kv,m,l,r),aa.pi(r,k.f.i),aa.matrix_to_quat(r,k.f.quat),r=la,aa.Vq(n,m,l,r),n=ea,X.setAxisAngle(r,-h.Ui*h.Vi*2*Math.PI,n),X.multiply(n,k.f.quat,k.f.quat),Q.o(k));g.l&&g.l.Dq&&(h=g.l,k=h.Dq)&&(l=g.l.Fv,
n=Y,m=g.f.i,r=g.f.quat,aa.Uq(g.l.Gv,r,m,n),aa.pi(n,k.f.i),aa.matrix_to_quat(n,k.f.quat),n=la,aa.Vq(l,r,m,n),l=ea,m=Math.abs(h.speed)*h.Kk,m>h.ti&&(m=h.ti),X.setAxisAngle(n,-m,l),X.multiply(l,k.f.quat,k.f.quat),Q.o(k));g.l&&g.l.Nq&&(h=g.l,k=h.Nq)&&(n=g.l.Tv,r=Y,l=g.f.i,m=g.f.quat,aa.Uq(g.l.Uv,m,l,r),aa.pi(r,k.f.i),aa.matrix_to_quat(r,k.f.quat),g=la,aa.Vq(n,m,l,g),n=ea,X.setAxisAngle(g,-Math.abs(h.Wh)*h.Nj,n),X.multiply(n,k.f.quat,k.f.quat),Q.o(k))}}z.HD(d);d=fa.ea(L[c],"MAIN_OPAQUE");d.yb&&0<d.yb.waves_height&&
(e=R.length(d.bf),z.v(ga[c],z.Ux,d.time*e))}};a.uB=function(){return L[0]};a.pause=function(){for(var a=0;a<ga.length;a++)z.v(ga[a],z.Fx)};a.resume=function(){for(var a=0;a<ga.length;a++)z.v(ga[a],z.Kx)};a.enable_simulation=function(a){a=a.m;if(!a)throw"No object physics";if(!a.Wf){var b=a.t,c=B(b);a.Wf=!0;z.v(c,z.Dx,b)}};a.disable_simulation=function(a){a=a.m;if(!a)throw"No object physics";if(a.Wf){var b=a.t,c=B(b);a.Wf=!1;z.v(c,z.Cx,b)}};a.Qm=function(a){return Boolean(a.jb)};a.H=function(a){return Boolean(a.m)};
a.has_dynamic_physics=function(a){return(a=a.m)&&a.Wf&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.ce&&0==a.nm?!0:!1};a.has_simulated_physics=function(a){return(a=a.m)&&a.Wf?!0:!1};a.set_gravity=function(a,b){var c=a.m.t;z.v(B(c),z.Tx,c,b)};a.cC=I;a.apply_constraint=A;a.clear_constraint=function(a){a=a.m;z.v(B(body_a),z.Ix,a.Hl);a.Hl=null};a.pull_to_constraint_pivot=function(b,c,d,e,f,g){c=ha.create_sep(c,1,d,U);f=ha.create_sep(f,1,g,ya);ha.invert(c,c);ha.multiply(f,c,c);Q.get_tsr(e,f);ha.multiply(f,
c,c);Q.set_tsr(b,c);Q.o(b);a.set_transform(b,b.f.i,b.f.quat)};a.set_transform=function(a,b,c){var d=a.m;ha.set_sep(a.f.i,1,a.f.quat,d.uo);a=z.yt(z.gl);a.t=d.t;a.i=b;a.quat=c;z.v(B(d.t),z.gl)};a.sync_transform=y;a.apply_velocity=function(a,b,c,d){v(a,b,c,d,oa);a=a.m.t;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);var e=Math.abs(oa[0]),f=Math.abs(oa[1]),g=Math.abs(oa[2]);oa[0]=e?oa[0]/e*Math.max(e,b):0;oa[1]=f?oa[1]/f*Math.max(f,c):0;oa[2]=g?oa[2]/g*Math.max(g,d):0;z.v(B(a),z.Ar,a,oa[0],oa[1],oa[2])};a.apply_velocity_world=
function(a,b,c,d){a=a.m.t;z.v(B(a),z.Ar,a,b,c,d)};a.apply_force=function(a,b,c,d){v(a,b,c,d,oa);a=a.m.t;z.v(B(a),z.ux,a,oa[0],oa[1],oa[2])};a.apply_torque=function(a,b,c,d){v(a,b,c,d,oa);a=a.m.t;z.v(B(a),z.wx,a,oa[0],oa[1],oa[2])};a.set_character_move_dir=function(a,b,c){a=a.m.t;z.v(B(a),z.Nx,a,b,c)};a.set_character_move_type=function(a,b){var c=a.m.t;z.v(B(c),z.Ox,c,b)};a.set_character_walk_velocity=function(a,b){var c=a.m.t;z.v(B(c),z.Sx,c,b)};a.set_character_run_velocity=function(a,b){var c=a.m.t;
z.v(B(c),z.Qx,c,b)};a.set_character_fly_velocity=function(a,b){var c=a.m.t;z.v(B(c),z.Lx,c,b)};a.character_jump=function(a){a=a.m.t;z.v(B(a),z.yx,a)};a.character_rotation_inc=function(a,b,c){a=a.m.t;z.v(B(a),z.zx,a,b,c)};a.set_character_rotation=function(a,b,c){a=a.m.t;z.v(B(a),z.Px,a,b,c)};a.set_character_rotation_h=function(a,b){var c=a.m.t;z.v(B(c),z.Mx,c,b)};a.set_character_rotation_v=function(a,b){var c=a.m.t;z.v(B(c),z.Rx,c,b)};a.append_collision_test=function(a,b,c,d){var e=a.m,f=e.t;b=b||
"ANY";for(var g=0;g<e.tc.length;g++)if(a=e.tc[g],a.Ia==b&&a.callback==c)return;a={Sn:f,Xd:d||!1,Ia:b,callback:c,Jf:[],wk:[]};e.tc.push(a);b=B(f);F(a,m(b),b)};a.remove_collision_test=function(a,b,c){a=a.m;for(var d=B(a.t),e=m(d),f=0;f<a.tc.length;f++){var g=a.tc[f];if(g.Ia==b&&g.callback==c){if(h(g)){var k=R.set(0,0,0,oa);g.callback(!1,null,k,k,0)}a.tc.splice(f,1);f--;for(var k=d,g=g.Jf,n=e.jb.p,l=0;l<n.length;l++)for(var r=n[l].m,q=0;q<r.tc.length;q++)for(var t=r.tc[q],p=0;p<t.Jf.length;p++)for(var u=
t.Jf[p],L=0;L<g.length;L++){var x=g[L];u[0]==x[0]&&u[1]==x[1]&&(g.splice(L,1),L--)}g.length&&z.v(k,z.zr,g)}}};a.apply_collision_impulse_test=function(a,b){a.m&&a.m.Ag&&q(a);var c=a.m;z.v(B(c.t),z.vx,c.t);c.Ag=b};a.clear_collision_impulse_test=q;a.append_ray_test=function(a,b,c,e,f,g,h,k,n){var l;P.Wu++;l=P.Wu;e=e||"ANY";a={id:l,t:a?a.m.t:0,from:new Float32Array(b),to:new Float32Array(c),Ia:e,Cj:d(e),Zr:g,bz:h,Xd:k,im:n,callback:f};b=B(a.t)||ga[0];c=m(b).jb;l=a.id;c.Of[l]=a;c.gq.push(a);z.v(b,z.rx,
a.id,a.t,a.from,a.to,a.Cj,a.Zr,a.bz,a.Xd,a.im);return l};a.remove_ray_test=D;a.change_ray_test_from_to=function(a,b,c){var d=J(a),e=w(a).jb.Of[a];e&&!e.Zr&&(e.from.set(b),e.to.set(c),z.v(d,z.xx,a,b,c))};a.Vt=function(a){return w(a).jb.Of[a]?!0:!1};a.vehicle_throttle=function(a,b){var c=a.l;c.Wh=b;C(a,c,B(a.m.t))};a.vehicle_steer=function(a,b){var c=a.l;c.Ui=b;C(a,c,B(a.m.t))};a.vehicle_brake=function(a,b){var c=a.l;c.uj=b;C(a,c,B(a.m.t))};a.is_vehicle_chassis=M;a.is_vehicle_hull=G;a.mC=function(a){if(!a.xc)return!1;
a=a.Hc.zc;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.kC=function(a){return a.xc?"BOB"==a.Hc.zc?!0:!1:!1};a.oC=function(a){return a.Sg?"BOB"==a.Yh.zc?!0:!1:!1};a.Yt=function(a){return a.xc&&"STEERING_WHEEL"==a.Hc.zc?!0:!1};a.Xt=function(a){return a.xc&&"SPEEDOMETER"==a.Hc.zc?!0:!1};a.Zt=function(a){return a.xc&&"TACHOMETER"==a.Hc.zc?!0:!1};a.get_vehicle_speed=function(a){return a.l.speed};a.DG=function(a){switch(a){case "WHEEL_FRONT_LEFT":return 0;
case "WHEEL_FRONT_RIGHT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.is_character=function(a){return a.is_character};a.HI=E;a.JB=function(){return ja};a.wA=function(){for(var a=0;a<ga.length;a++)z.v(ga[a],z.Bx)};a.TD=function(a){var b=S.indexOf(a);-1==b&&ba.error("Object "+a.name+" doesn't have bounding physics");for(var c=a.m.t,d=B(c),e=m(d),f=e.jb.p,g=[],k=0;k<f.length;k++)for(var n=f[k].m,l=0;l<n.tc.length;l++)for(var r=n.tc[l],t=0;t<r.Jf.length;t++){var p=r.Jf[t],
u=r.wk[t];if(p[0]==c||p[1]==c)r.Jf.splice(t,1),r.wk.splice(t,1),t--,u&&!h(r)&&(u=R.set(0,0,0,oa),r.callback(!1,null,u,u,0)),g.push(p)}g.length&&z.v(d,z.zr,g);a.m&&a.m.Ag&&q(a);delete O[c];S.splice(b,1);a=e.jb.p;for(b=0;b<a.length;b++)a[b].m.t==c&&(a.splice(b,1),b--);z.v(d,z.Hx,c)}};b4w.module.__data=function(a,p){function e(a,b){kb[b.id]=null;Aa[b.id]=null}function b(a,b,c){var d;a instanceof ArrayBuffer&&(a=P.Dt(a));d=a.width;a=a.height;Z.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(Ac)&&c&&Z.warn("image",b,"is not from app root.")}function c(a,b,c,d,e,f){d=b.He;if(!d)throw"Nothing requested";L.enqueue([{id:d,type:L.AT_JSON,url:d}],function(d,f,g,h){if(d){Z.log("%cLOAD METADATA","color: #616",h);f=za.Lv(d.b4w_format_version);
switch(za.sw(f,ka.ah)){case -1:f[0]<ka.ah[0]?za.U("JSON version is too old relative to B4W engine: "+za.dg(f)+", required: "+za.dg(ka.ah)+". Reexport scene with the latest B4W addon to fix it."):Z.warn("JSON version is a bit old relative to B4W engine: "+ +za.dg(f)+", required: "+za.dg(ka.ah)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>ka.ah[0]?za.U("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
Z.warn("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}ka.Cp=f;for(var k in d)a[k]=d[k];b.Ka&&(Oa=va.Zl(a.scenes));(d=a.binaries[0].binfile)?b.bs=d:(la.Xm(b,"load_binaries"),la.Xm(b,"prepare_bindata"));ka.Tg||la.Xm(b,"mobile_media_start");ka.antialiasing&&ka.smaa||la.Xm(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)k=a.b4w_export_errors[d],(b.Ka&&"PRIMARY"==k.type||"ALL"==k.type)&&
Z.QA(k.text);if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)k=a.b4w_export_warnings[d],(b.Ka&&"PRIMARY"==k.type||"ALL"==k.type)&&Z.RA(k.text);e(b,c)}else la.Jr(b)},null,function(a){f(b,c,a)})}function m(a,b,c,d,e,f){d=na(b.He)+b.bs;if(!d)throw"Binary data is missing";L.enqueue([{id:d,type:L.AT_ARRAYBUFFER,url:d}],function(d,f,g,k){d?(Z.log("%cLOAD BINARY","color: #616",k),a.bin_data=d,d=h(d),f=za.Lv(a.b4w_format_version),d[0]!=f[0]&&za.U("BIN version does not match to JSON version: "+
za.dg(d)+", required: "+za.dg(ka.ah)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=f[1]&&Z.warn("BIN version does not match to JSON version: "+ +za.dg(d)+", required: "+za.dg(ka.ah)+". Some compatibility issues can occur. Reexport scene to fix it."),e(b,c)):la.Jr(b)},null,function(a){f(b,c,a)})}function f(a,b,c,d,e){ma.vz()&&e(b,c)}function l(a,b,c,d,e){d=a.bin_data;var f=a.binaries[0],g=a.objects,k=a.meshes;a=a.actions;for(var n=za.rz(),l=h(d),l=5<=l[0]&&4<l[1]?12:0,m=["indices"],
r=["normal","tangent"],q=["color","group"],p=["position","texcoord","texcoord2"],Z=0;Z<k.length;Z++)for(var u=k[Z].submeshes,pa=0;pa<u.length;pa++)for(var L in u[pa]){var x=u[pa][L][1];if(-1!=m.indexOf(L)){var v=4*u[pa][L][0]+f["int"]+l,wa=u[pa],O=L,ma=d;if(n)var H=new Uint32Array(ma,v,x);else for(var H=new Uint32Array(x),ma=new DataView(ma),z=0;z<x;z++)H[z]=ma.getUint32(v+4*z,!0);wa[O]=H}else if(-1!=p.indexOf(L))v=4*u[pa][L][0]+f["float"]+l,u[pa][L]=t(d,v,x,n);else if(-1!=r.indexOf(L)){v=2*u[pa][L][0]+
f["short"]+l;wa=u[pa];O=L;ma=d;H=new Float32Array(x);ma=new DataView(ma);for(z=0;z<x;z++)H[z]=ma.getInt16(v+2*z,!0)/32767;wa[O]=H}else if(-1!=q.indexOf(L)){v=2*u[pa][L][0]+f.ushort+l;wa=u[pa];O=L;ma=d;H=new Float32Array(x);ma=new DataView(ma);for(z=0;z<x;z++)H[z]=ma.getUint16(v+2*z,!0)/65535;wa[O]=H}}for(L=0;L<g.length;L++)for(k=g[L].particle_systems,m=0;m<k.length;m++)r=k[m],r.transforms=t(d,4*r.transforms[0]+f["float"]+l,r.transforms[1],n);for(g=0;g<a.length;g++){L=a[g];k=L.fcurves;m=L.frame_range;
q=m[0];p=m[1];Z=ga.yB(q,p);m=null;0>Z&&(Z=0);var pa=u=!1,E;for(E in k)u|=-1<E.indexOf("rotation_euler"),pa|=-1<E.indexOf("rotation_quaternion");r=[];for(E in k)if(u&&pa&&-1<E.indexOf("rotation_euler"))delete k[E];else{var x=k[E],w;for(w in x)v=x[w],wa=t(d,f["float"]+4*v.bin_data_pos[0]+l,v.bin_data_pos[1],n),O=new Float32Array(Z),null===m&&(m=new Int8Array(Z)),ga.Hy(v,wa,O,m,q,p),v.Kc=O;-1<E.indexOf("rotation_euler")&&(ga.YA(k[E]),r.push(E))}for(q=0;q<r.length;q++)p=r[q],Z=p.replace("euler","quaternion"),
k[Z]=k[p],delete k[p];L.cy=m}e(b,c)}function h(a){var b=new Uint8Array(a,0,4),c=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];for(var d=0;d<b.length;d++)if("B4WB"[d]!=String.fromCharCode(b[d])){c=5;a=4;break}return[c,a]}function t(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+4*e,!0)}return d}function d(a,b,c,d,e){var f=a.cameras,h=a.groups,n=a.materials,l=a.meshes,m=a.node_groups,r=a.objects,q=a.particles,
t=a.scenes,p=a.speakers,u=a.lamps,L=a.textures,x=a.worlds;m||(Z.warn('"node_groups" datablock undefined. reexport main scene.'),m=a.node_groups=[]);for(var O="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),ma={},z=0;z<O.length;z++)for(var H=a[O[z]],E=0;E<H.length;E++){var w=H[E];ma[w.uuid]=w}for(var S=0;S<t.length;S++){for(var y=t[S],A=y.objects,ta=0;ta<A.length;ta++)F(A,ta,ma);y.camera&&F(y,"camera",
ma);y.world&&F(y,"world",ma)}for(S=0;S<h.length;S++)for(var D=h[S].objects,ta=0;ta<D.length;ta++)F(D,ta,ma);for(S=0;S<r.length;S++){var B=r[S];B.dupli_group&&F(B,"dupli_group",ma);B.parent&&F(B,"parent",ma);B.dg_parent&&F(B,"dg_parent",ma);if(B.animation_data){var G=B.animation_data;G.action&&F(G,"action",ma);if(G.nla_tracks)for(ta=0;ta<G.nla_tracks.length;ta++)for(var Ka=G.nla_tracks[ta],C=0;C<Ka.strips.length;C++)Ka.strips[C].action&&F(Ka.strips[C],"action",ma)}switch(B.type){case "MESH":if(!B.data)throw"mesh not found for object "+
B.name;F(B,"data",ma);for(var V=!1,I=B.modifiers,ta=0;ta<I.length;ta++){var P=I[ta];"ARMATURE"==P.type?(V&&Z.warn('Object "'+B.name+'" has more than one armature modifiers. Only the first one will be used.'),V=!0,F(P,"object",ma)):"CURVE"==P.type&&F(P,"object",ma)}var ua=B.particle_systems;if(ua)for(ta=0;ta<ua.length;ta++)F(ua[ta],"settings",ma);break;case "ARMATURE":F(B,"data",ma);for(var M=B.pose.bones,ka=B.data.bones,ta=0;ta<M.length;ta++){var J=M[ta];J.bone=ka[J.bone];var Bb=J.constraints;if(Bb)for(C=
0;C<Bb.length;C++){var ba=Bb[C];ba.target&&F(ba,"target",ma)}for(var Ra=J.parent_recursive,C=0;C<Ra.length;C++)Ra[C]=M[Ra[C]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":F(B,"data",ma)}if(Bb=B.constraints)for(ta=0;ta<Bb.length;ta++)ba=Bb[ta],ba.target&&F(ba,"target",ma);var X=B.lod_levels;if(X)for(ta=0;ta<X.length;ta++){var Sa=X[ta];Sa.object&&F(Sa,"object",ma)}}for(S=0;S<l.length;S++)for(var da=l[S].materials,ta=0;ta<da.length;ta++)F(da,ta,ma);for(S=0;S<n.length;S++){for(var oa=n[S],
N=oa.texture_slots,ta=0;ta<N.length;ta++)F(N[ta],"texture",ma);var la=oa.node_tree;la&&v(la,ma)}for(S=0;S<m.length;S++)(la=m[S].node_tree)&&v(la,ma);for(S=0;S<L.length;S++){var Wa=L[S],Q=Wa.type;"IMAGE"!=Q&&"ENVIRONMENT_MAP"!=Q||F(Wa,"image",ma)}for(S=0;S<f.length;S++){var Y=f[S];Y.dof_object&&F(Y,"dof_object",ma)}for(S=0;S<p.length;S++){var ea=p[S];ea.sound&&F(ea,"sound",ma);if(ea.animation_data&&(G=ea.animation_data,G.action&&F(G,"action",ma),G.nla_tracks))for(ta=0;ta<G.nla_tracks.length;ta++)for(Ka=
G.nla_tracks[ta],C=0;C<Ka.strips.length;C++)Ka.strips[C].action&&F(Ka.strips[C],"action",ma)}for(S=0;S<q.length;S++){for(var ja=q[S],N=ja.texture_slots,ta=0;ta<N.length;ta++)F(N[ta],"texture",ma);ja.dupli_group&&F(ja,"dupli_group",ma);ja.dupli_object&&F(ja,"dupli_object",ma)}for(S=0;S<u.length;S++){var fa=u[S];if(fa.animation_data&&(G=fa.animation_data,G.action&&F(G,"action",ma),G.nla_tracks))for(ta=0;ta<G.nla_tracks.length;ta++)for(Ka=G.nla_tracks[ta],C=0;C<Ka.strips.length;C++)Ka.strips[C].action&&
F(Ka.strips[C],"action",ma)}for(S=0;S<x.length;S++)if(N=x[S].texture_slots)for(ta=0;ta<N.length;ta++)F(N[ta],"texture",ma);Ba.oz(a);for(var kb=a.textures,R=b.Ka?a.scenes[0].b4w_anisotropic_filtering:Oa.b4w_anisotropic_filtering,U=0;U<kb.length;U++)b.Ka||"SCENE"!=kb[U].b4w_source_type||(kb[U].b4w_source_id=""),wa.kA(kb[U],R,a.scenes,b.id);for(var Ac={},aa=a.objects,W=0;W<aa.length;W++){var ha=aa[W];if("MESH"===ha.type&&!ha.particle_systems.length)for(var tb=ha.data,ya=tb.name,$a=tb.submeshes,fc=tb.materials,
na=0;na<$a.length;na++)0!==$a[na].base_length||Ac[ya]||(fc[na]&&Z.warn('material "'+fc[na].name+'" is not assigned to any face (object "'+ha.name+'").'),Ac[ya]=!0)}for(var Bc=a.meshes,ia=0;ia<Bc.length;ia++){var sa=Bc[ia];sa.materials.length||sa.uv_textures.length&&Z.warn('mesh "'+sa.name+'" has a UV map but has no exported material.')}a.materials.push(Ba.Yz());for(var Xa=a.meshes,Ic=za.keysearch("name","DEFAULT",a.materials),hb=0;hb<Xa.length;hb++){var Ab=Xa[hb];0==Ab.materials.length&&Ab.materials.push(Ic)}for(var dc=
a.actions,ib=b.id,Ea=0;Ea<dc.length;Ea++){var qb=dc[Ea];qb.dy=ib;ga.ly(qb)}for(var vc=a.scenes,ob=0;ob<vc.length;ob++){for(var Tb=vc[ob],Jb=[],Kb=[],vb=vc[ob].objects,Na=0;Na<vb.length;Na++){var ec=vb[Na];K(vb,ec,Jb,Kb);var Mb=ec.dupli_group;if(Mb)for(var wb=Mb.objects,Yb=0;Yb<wb.length;Yb++)K(wb,wb[Yb],Jb,Kb)}for(Na=0;Na<Kb.length;Na++)for(var mc=Kb[Na],wc=[Tb],nc=0;nc<wc.length;nc++){for(var oc=wc[nc].objects,Fc=0;Fc<oc.length;Fc++){var Kc=oc[Fc].dupli_group;if(Kc){var Zb=Kc.objects,Ja=Zb.indexOf(mc);
-1<Ja&&Zb.splice(Ja,1)}}var Ja=oc.indexOf(mc);-1<Ja&&oc.splice(Ja,1)}for(Na=0;Na<Jb.length;Na++)za.Cy(Jb[Na][0],Jb[Na][1])}!b.Ka&&1<a.scenes.length&&(a.scenes=[va.Zl(a.scenes)],Z.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var Ma=b.Ka?Oa:va.Zl(a.scenes);sb.qE(Oa.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Oa),1),a.scenes.unshift(Oa));for(var Wc=0;Wc<a.scenes.length;Wc++){var pc=a.scenes[Wc];pc.j={};pc.Hr=pc==Ma;pc.ey=b.Ka;ra.enabled&&pc.b4w_enable_physics&&
(b.Ka||!T.Qm(Oa)&&pc==va.Zl(a))&&T.iC(pc);b.Ka?pc.b4w_enable_audio&&pa.Wr(pc):pc.b4w_enable_audio&&!Oa.ga&&pa.Wr(Oa)}for(var qc=0;qc<a.scenes.length;qc++){var $b=a.scenes[qc],ac,xc=[];g($b.objects,"ALL",xc);ac=xc;$b.b4w_use_logic_editor&&Ba.My(ac,$b);for(var Lc=0;Lc<ac.length;Lc++){var bc=ac[Lc];qa.pz(bc,$b,a)&&(bc.sc||(bc.sc=[]),bc.sc.push(b.Ka?$b:Oa))}for(var $c=ac,Pc=0;Pc<$c.length;Pc++){var ad=$c[Pc];if(ad.sc)for(var nd=ad.particle_systems,Qc=0;Qc<nd.length;Qc++){var Gc=nd[Qc].settings;if("HAIR"==
Gc.type)if("OBJECT"==Gc.render_type){var Mc=Gc.dupli_object;Mc.sc||(Mc.sc=ad.sc.slice())}else if("GROUP"==Gc.render_type)for(var bd=Gc.dupli_group,Nc=0;Nc<bd.objects.length;Nc++)Mc=bd.objects[Nc],Mc.sc||(Mc.sc=ad.sc.slice())}}}for(var cd=a.scenes,Oc=[],rb=0;rb<cd.length;rb++)k(cd[rb].objects,0,b.Ka,Oc);Aa[b.id]=[];for(rb=0;rb<Oc.length;rb++)for(var Rc=Oc[rb],yc=0;yc<Rc.length;yc++)for(var dd=Rc[yc],Sc=0;Sc<dd.length;Sc++)Aa[b.id].push(dd[Sc]);for(var Xc=a.particles,rb=0;rb<Xc.length;rb++){var Hc=
Xc[rb].dupli_object;Hc&&(Hc.Gr=!0,Aa[b.id].push(Hc));var ed=Xc[rb].dupli_group;if(ed)for(var Yc=ed.objects,yc=0;yc<Yc.length;yc++)Hc=Yc[yc],Hc.Gr=!0,Aa[b.id].push(Hc)}for(var hd=Aa[b.id],rb=hd.length-1;0<=rb;rb--)hd[rb].sc||hd.splice(rb,1);for(var fd=Aa[b.id],qc=0;qc<fd.length;qc++)if(bc=fd[qc],!b.Ka&&bc.parent&&-1<ld.indexOf(bc.parent.type)&&(bc.parent=""),"MESH"==bc.type){var zc=Ba.Fy(bc);zc&&(a.meshes.push(zc),bc.data=zc)}e(b,c)}function g(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];"ALL"!=b&&
b!=e.type||c.push(e);(e=e.dupli_group)&&g(e.objects,b,c)}}function k(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var g=a[f],h=da(g);e[h]=e[h]||[];(c||-1==ld.indexOf(g.type))&&-1==e[h].indexOf(g)&&e[h].push(g);(g=g.dupli_group)&&k(g.objects,b+1,c,d)}}function n(a,b,c){var d=[];a=Aa[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==c||"ALL"==c)for(var g=0;g<f.sc.length;g++)b==f.sc[g]&&d.push(f)}return d}function x(a,b,c,d,e){var f=Aa[b.id];d=b.id;for(var g=0;g<f.length;g++){for(var h=
f[g],k=sa.Jj(h.name,h.type,h.origin_name),n=0;n<h.sc.length;n++)sa.pl(k,h.sc[n]);h.fa=k;qa.wh(h,k);k.f.uc=d;k.mk=h.Gr||!1}d=qa.get_all_objects(b.id);for(g=0;g<f.length;g++)h=f[g],k=h.fa,U.wh(h,k);if(b.Ka)for(g=b.id,h=0;h<a.scenes.length;h++)for(var k=a.scenes[h],n=0,l=qa.Aa(k,"LAMP",g),m=0;m<l.length;m++)sa.Oa(l[m],k).ni=n++;for(g=0;g<f.length;g++)h=f[g],k=h.fa,k.mk||(qa.RF(h,k),ta.o(k));for(a=0;a<f.length;a++)if(g=f[a],h=g.fa,sa.is_mesh(h)&&(k=g.lod_levels.length))for(n=h,l=0;l<k;l++)if(m=g.lod_levels[l].object){m=
m.fa;m.f.Xg=h.f.Xg;n.f.Cf=g.lod_levels[l].distance;m.f.qk=g.lod_levels[l].distance;if(g.lod_levels[l+1])m.f.Cf=g.lod_levels[l+1].distance;else{m.f.rm=!0;m.f.Cf=1E4;break}n.f.rm=!1;n=m}else{n.f.rm=!0;n.f.Cf=g.lod_levels[l].distance;break}for(f=0;f<d.length;f++)if(a=d[f],"MESH"==a.type&&(g=a.ql)){var g=g.f,h=a.f.Qh,k=[],r;for(r in h)n=h[r],k.push(4*n.zo,4*n.lf);g.nu.push(k);g.Wm.push(a.f)}f=r=-1;a=ga.xt();for(g=0;g<d.length;g++)h=d[g],k=h.f,sa.is_mesh(h)&&k.li&&(h=k.Pe,h>r&&(r=h),a>=h&&h>f&&(f=h));
for(g=0;g<d.length;g++)h=d[g],k=h.f,sa.is_mesh(h)&&k.li&&(k.Zj=!0,r<a?k.Pe=r:k.Pe<=a?k.Pe=f:(Z.warn('too many bones for "'+h.name+'" / '+k.Pe+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),k.Pe=r,k.Zj=!1),k.Zj=k.Zj&&!Wa.ht);for(r=0;r<d.length;r++)if(f=d[r],f.xc)if(a=f.Hc,"CHASSIS"==a.zc){f.l={};f.l.Xj=a.Xj;f.l.vj=a.vj;f.l.Kq=a.Kq;f.l.Mq=a.Mq;f.l.Lq=a.Lq;f.l.nr=a.nr;f.l.lq=a.lq;f.l.Hp=a.Hp;f.l.Wh=0;f.l.uj=1;f.l.Ui=0;f.l.speed=0;f.l.nh=[];f.l.Ck=
[];f.l.Wi=null;h=(g=sa.get_dg_parent(f))?sa.Xo(g,d):d;for(g=0;g<h.length;g++)k=h[g],k.xc&&(n=k.Hc,T.mC(k)&&a.name==n.name?(n=T.DG(k.Hc.zc),f.l.nh[n]=k,f.l.Ck[n]=new Float32Array(8)):T.Yt(k)&&a.name==n.name?(f.l.Wi=k,f.l.Vi=n.Vi,f.l.Nk=n.Nk,f.l.ik=n.ik,n=ea.invert(f.f.aa,new Float32Array(16)),k=ea.multiply(n,k.f.aa,n),f.l.Kv=k,n=new Float32Array([1,0,0,0]),Ka.transformMat4(n,k,n),f.l.Jv=n):T.Xt(k)&&a.name==n.name?(f.l.Dq=k,f.l.Kk=n.Kk,f.l.ti=n.ti,n=ea.invert(f.f.aa,new Float32Array(16)),k=ea.multiply(n,
k.f.aa,n),f.l.Gv=k,n=new Float32Array([1,0,0,0]),Ka.transformMat4(n,k,n),f.l.Fv=n):T.Zt(k)&&a.name==n.name&&(f.l.Nq=k,f.l.Nj=n.Nj,n=ea.invert(f.f.aa,new Float32Array(16)),k=ea.multiply(n,k.f.aa,n),f.l.Uv=k,n=new Float32Array([1,0,0,0]),Ka.transformMat4(n,k,n),f.l.Tv=n));if(4!=f.l.nh.length)throw"Not enough wheels for chassis "+f.name;}else if("HULL"==a.zc)for(f.l={},f.l.nh=[],f.l.Ck=[],f.l.Xj=a.Xj,f.l.vj=a.vj,f.l.Kg=a.Kg,f.l.Fh=a.Fh,f.l.Gh=a.Gh,f.l.Wh=0,f.l.uj=1,f.l.Ui=0,f.l.speed=0,f.l.Wi=null,h=
(g=sa.get_dg_parent(f))?sa.Xo(g,d):d,g=0;g<h.length;g++)k=h[g],k.xc&&(n=k.Hc,T.kC(k)&&a.name==n.name?(f.l.nh.push(k),f.l.Ck.push(new Float32Array(8))):T.Yt(k)&&a.name==n.name?(f.l.Wi=k,f.l.Vi=n.Vi,f.l.Nk=n.Nk,f.l.ik=n.ik,n=ea.invert(f.f.aa,new Float32Array(16)),k=ea.multiply(n,k.f.aa,n),f.l.Kv=k,n=new Float32Array([1,0,0,0]),Ka.transformMat4(n,k,n),f.l.Jv=n):T.Xt(k)&&a.name==n.name?(f.l.Dq=k,f.l.Kk=n.Kk,f.l.ti=n.ti,n=ea.invert(f.f.aa,new Float32Array(16)),k=ea.multiply(n,k.f.aa,n),f.l.Gv=k,n=new Float32Array([1,
0,0,0]),Ka.transformMat4(n,k,n),f.l.Fv=n):T.Zt(k)&&a.name==n.name&&(f.l.Nq=k,f.l.Nj=n.Nj,n=ea.invert(f.f.aa,new Float32Array(16)),k=ea.multiply(n,k.f.aa,n),f.l.Uv=k,n=new Float32Array([1,0,0,0]),Ka.transformMat4(n,k,n),f.l.Tv=n));for(r=0;r<d.length;r++)if(f=d[r],f.Sg&&(a=f.Yh,"MAIN_BODY"==a.zc))for(f.rd={},f.rd.Kg=a.Kg,f.rd.Fh=a.Fh,f.rd.Gh=a.Gh,f.rd.yl=[],g=(g=sa.get_dg_parent(f))?sa.Xo(g,d):d,h=0;h<g.length;h++)k=g[h],k.Sg&&(n=k.Yh,T.oC(k)&&a.name==n.name&&(f.rd.yl.push(k),k.Yy=k.Yh.Sv));e(b,c)}
function I(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];f.ng=f.camera.fa}for(d=0;d<a.scenes.length;d++){var f=b.Ka?a.scenes[d]:Oa,g=b.Ka?qa.Aa(f,"LAMP",b.id):qa.Aa(f,"LAMP",0),h=qa.Aa(f,"ALL",b.id),k=n(b.id,f,"MESH"),l=n(b.id,f,"EMPTY");b.Ka&&va.ry(f,h,g,k,l);for(var m=0;m<l.length;m++)qa.cw(l[m].fa);l=[];va.set_active(f);O.qB(f,k,g,l);h=va.wt(f);if(b.Ka){m=f.j.Ym;if(m.WD||m.procedural_skydome)m=O.sB(f,m),l.push(m);va.iB(h)}for(m=0;m<k.length;m++)O.Is(k[m].fa,h,f);for(m=0;m<l.length;m++)O.Is(l[m],
h,f),qa.rD(l[m]);h=qa.Aa(f,"ALL",b.id);va.Ny(f,h,g)}va.sy(Oa,a.textures,b.id);b.Ka&&Oa.j.ij.length&&(b.ip=!0);d=a.materials;if(Bb.xo&&ka.jw)for(a=0;a<d.length;a++){k=d[a];l=k.texture_slots;for(f=0;f<l.length;f++)if(h=l[f],m=h.texture,"IMAGE"==m.type||"ENVIRONMENT_MAP"==m.type)g=m.image,g.Jc||(-1<g.filepath.indexOf(".dds")?g.Jc=!0:(g.Jc=!m.b4w_disable_compression&&!h.use_map_normal&&"ENVIRONMENT_MAP"!=m.type&&!m.b4w_shore_dist_map&&"MOVIE"!=g.source,g.Jc&&(g.filepath+=".dds")));if(f=k.node_tree)for(k=
f.nodes,f=0;f<k.length;f++)g=k[f],"TEXTURE"==g.type&&(l=g.texture)&&(g=l.image)&&!g.Jc&&(g.Jc=l.j.ll&&!l.b4w_disable_compression&&"MOVIE"!=g.source&&"ENVIRONMENT_MAP"!=l.type,g.Jc&&(g.filepath+=".dds"))}else for(a=a.images,d=0;d<a.length;d++)f=a[d],f.Jc=Boolean("FILE"==f.source&&-1<f.filepath.indexOf(".dds"));e(b,c)}function A(a,b,c,d,e){d=a.groups;for(var f=a.objects,g={},h={},k={},n={},l=0;l<d.length;l++){var m=d[l];g[m.uuid]=m;k[m.uuid]=m}for(l=0;l<f.length;l++)m=f[l],h[m.uuid]=m,n[m.uuid]=m;a=
a.scenes;for(l=0;l<a.length;l++)B(a[l].objects,null,n,k);for(var r in k)r in g||d.push(k[r]);for(r in n)r in h||f.push(n[r]);e(b,c)}function B(a,b,c,d){for(var e=[],f=0;f<a.length;f++){var g=a[f],h=c[g.uuid];if(g=h.proxy){b&&-1==e.indexOf(g.uuid)&&e.push(g.uuid);for(var k=c[g.uuid],n=k.constraints,g=0;g<n.length;g++){var l=za.zg(n[g]);l.name+="_CLONE";h.constraints.push(l)}"b4w_proxy_inherit_anim"in h&&!h.b4w_proxy_inherit_anim||(h.animation_data&&(k.animation_data=za.zg(h.animation_data)),k.b4w_use_default_animation=
h.b4w_use_default_animation,k.b4w_auto_skel_anim=h.b4w_auto_skel_anim,k.b4w_anim_behavior=h.b4w_anim_behavior,k.b4w_cyclic_animation=h.b4w_cyclic_animation)}}for(f=0;f<e.length;f++)h=za.LB(a,e[f]),-1<h&&a.splice(h,1);e={};if(b)for(f=0;f<a.length;f++)g=a[f],h=c[g.uuid],n=za.zg(h),h="origin_name"in h?h.origin_name:h.name,n.name=sa.kt(b.name,h),n.origin_name=h,n.dg_parent={uuid:b.uuid},y(n),c[n.uuid]=n,e[g.uuid]=n.uuid,g.uuid=n.uuid;for(f=0;f<a.length;f++)g=a[f],h=c[g.uuid],h.dupli_group&&(g=h.dupli_group,
n=d[g.uuid],k=za.zg(n),k.name=za.cj(n.name+"_CLONE"),k.uuid=Y.Ot("Group"+k.name),d[k.uuid]=k,g.uuid=k.uuid,B(k.objects,h,c,d));if(b)for(f=0;f<a.length;f++){g=a[f];h=c[g.uuid];h.parent&&h.parent.uuid in e?h.parent.uuid=e[h.parent.uuid]:h.parent&&(Z.warn("Object's \""+h.name+'" parent is not in dupli group. Disabling parenting.'),h.parent=null);n=h.constraints;for(g=0;g<n.length;g++)b=n[g],b.target&&b.target.uuid in e&&(b.target.uuid=e[b.target.uuid]);if(b=h.pose)for(d=b.bones,g=0;g<d.length;g++)if(n=
d[g].constraints)for(k=0;k<n.length;k++)b=n[k],b.target&&b.target.uuid in e&&(b.target.uuid=e[b.target.uuid]);b=h.modifiers;for(g=0;g<b.length;g++)d=b[g],d.object&&d.object.uuid in e&&(d.object.uuid=e[d.object.uuid]);if((h=h.lod_levels)&&h.length)for(g=0;g<h.length;g++)b=h[g],b.object&&b.object.uuid in e&&(b.object.uuid=e[b.object.uuid])}for(var m in e)fc[m]=e[m]}function y(a){a.uuid=Y.Ot("Object"+a.name)}function v(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];"TEXTURE"==e.type&&e.texture&&
F(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in fc&&(e.lamp.uuid=fc[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&F(e,"node_group",b)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];u(f,"from_node",c);u(f,"to_node",c);q(f,"from_socket",f.from_node.outputs);q(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&F(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(e=c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&F(e.strips[f],
"action",b)}function F(a,b,c){(c=c[a[b].uuid])||Z.error("Dangling link found:",b,a);a[b]=c}function u(a,b,c){c=za.keysearch("name",a[b].name,c);a[b]=c}function q(a,b,c){c=za.keysearch("identifier",a[b].identifier,c);a[b]=c}function D(a,c,d,e,f,g){e=na(c.He);for(var h=a.images,k={},n=[],l=0;l<h.length;l++){var m=h[l],r=m.uuid;if("FILE"===m.source||"MOVIE"===m.source){var q=J(m,a.textures);if(!q.length)Z.warn("image ",m.name," has no users.");else if(!q[0].b4w_shore_dist_map){q=za.rk(e+m.filepath);
if("FILE"===m.source){var t=m.Jc?L.AT_ARRAYBUFFER:L.AT_IMAGE_ELEMENT;Bb.Ip&&ka.kn&&(q=L.Lk(q),"dds"==q[1]?(q=L.Lk(q[0]),q=q[0]+".min50."+q[1]+".dds"):q=q[0]+".min50."+q[1])}else"MOVIE"===m.source&&(ka.Ik?(q=L.Lk(q),q=q[0]+".altconv.seq",t=L.bl):(q=L.Lk(q),t=pa.detect_video_container(q[1]),q=t!=q[1]?q[0]+".altconv."+t:q[0]+"."+t,t=L.cl));n.push({id:r,type:t,url:q});k[r]=m}}}if(n.length){var p=0;L.enqueue(n,function(e,f,h,l){if(e){if(h==L.cl||h==L.bl){if(h==L.cl)var m=e.videoWidth,r=e.videoHeight;else m=
e.images[0].width,r=e.images[0].height;Z.log("%cLOAD VIDEO "+m+"x"+r,"color: #"+(2048<m||2048<r?"a00":1024<m||1024<r?"aa0":"0a0"),l);-1==l.indexOf(Ac)&&Z.warn("video",l,"is not from app root.")}else b(e,l,!0);f=k[f];l=J(f,a.textures);for(m=0;m<l.length;m++){var r=l[m],q=r.image.filepath;h==L.bl?(r.j.rq=e.ae,wa.Tk(r.j,e.images,f.Jc,q,c.id)):wa.Tk(r.j,e,f.Jc,q,c.id)}}e=++p/n.length;g(c,d,e)},function(){Z.log("%cLOADED ALL IMAGES","color: #0a0");f(c,d)})}else f(c,d)}function w(a,b,c,d,e){a=va.zt();for(d=
0;d<a.length;d++){var f=a[d];f.b4w_use_nla&&U.UF(f,f.b4w_nla_cyclic,b.id)}e(b,c)}function J(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];e.image===a&&c.push(e)}return c}function C(a,b,c,d,e,f){a=na(b.He);var g=[],h={};d=qa.get_all_objects(b.id);for(var k=0;k<d.length;k++){var n=d[k];if(M(n)){var l=n.w.zh;"BACKGROUND_MUSIC"==pa.ap(n)?(l=za.To(),b.gp=!0):"NONE"!=pa.ap(n)&&ka.Pt&&(b.mp=!0);if(!(l in h)){h[l]=[];var m=za.rk(a+n.w.He);switch(pa.Ev(n)){case pa.sn:var r=L.AT_AUDIOBUFFER;break;case pa.qr:r=
L.AT_AUDIO_ELEMENT}var m=L.Lk(m),q=pa.detect_audio_container(m[1]),m=q!=m[1]?m[0]+".altconv."+q:m[0]+"."+q;g.push({id:l,type:r,url:m})}h[l].push(n)}}if(g.length){var t=0;L.enqueue(g,function(a,d,e,k){if(a)for(Z.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf(Ac)&&Z.warn("sound",k,"is not from app root."),d=h[d],e=0;e<d.length;e++)pa.XF(d[e],a);a=++t/g.length;f(b,c,a)},function(){Z.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,c)})}else e(b,c)}function M(a){return sa.is_speaker(a)&&pa.Ev(a)!=pa.rr}
function G(a,b,c){a=qa.Aa(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];sa.is_speaker(d)&&(pa.is_cyclic(d)||c)&&pa.play_def(d)}}function E(a,b){for(var c=a.j.ij,d=0;d<c.length;d++){var e=c[d].j;a.b4w_use_nla&&c[d].b4w_nla_video||!c[d].use_auto_refresh||b!=e.fc||(wa.reset_video(e.name,b),wa.play_video(e.name,b))}}function r(a,b,c,d,e){U.start();Z.log("%cSTART NLA","color: #0a0");e(b,c)}function K(a,b,c,d){if(b.lod_levels&&b.lod_levels.length)for(var e=b.lod_levels.length,f=0;f<e;f++){var g=b.lod_levels[f],
h=g.object;if(h){var k=za.Aj(h);k.name=b.name+"_LOD_"+String(f+1);y(k);k.lod_levels=[];c.push([a,k]);d.push(h);g.object=k}}}function z(a,b,c,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!T.xz(a.scenes[f])){d=!1;break}d&&(e(b,c),Z.log("%cPHYSICS READY","color: #0a0"))}function H(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];if(b.Ka)var g=T.Qm(f);else g=T.Qm(Oa)||T.Qm(f),f=Oa;if(ra.enabled&&g)for(g=0;g<Ic.length;g++)for(var h=qa.Aa(f,Ic[g],b.id),k=0;k<h.length;k++){var n=h[k];n.f.uc==
b.id&&(T.append_object(n,f),b.iu&&T.H(n)&&T.disable_simulation(n))}}e(b,c)}function V(a,c,d,e,f){var g={};e=[];for(var h=a.scenes,k=0;k<a.scenes.length;k++){var n=h[k];if(n.j.yb&&(n=n.j.yb.Vm)&&"FILE"===n.source){var l=n.uuid,m=za.rk(na(c.He)+n.filepath);e.push({id:l,type:n.Jc?L.AT_ARRAYBUFFER:L.AT_IMAGE_ELEMENT,url:m});g[l]=n}}e.length?L.enqueue(e,function(d,e,f,k){if(d){b(d,k,!0);e=g[e];k=J(e,a.textures);for(f=0;f<k.length;f++){var n=k[f];wa.Tk(n.j,d,e.Jc,n.image.filepath,c.id)}for(f=0;f<h.length;f++)if(k=
h[f],k.j.yb.Vm===e){var l=d,m=document.createElement("canvas"),n=e.size[0],r=e.size[1];m.width=n;m.height=r;m=m.getContext("2d");m.drawImage(l,0,0);l=m.getImageData(0,0,n,r).data;m=new Float32Array(4);m[0]=1/16581375;m[1]=1/65025;m[2]=1/255;m[3]=1;for(var n=n*r,r=new Float32Array(n),q=0;q<n;q++)r[q]=m[1]*l[4*q+2]+m[2]*l[4*q+3];k.j.vq=r}}},function(){f(c,d)}):f(c,d)}function ba(a,c,d,e,f){e=a.scenes[0];a=[];for(var g=["SMAA_EDGE_DETECTION","SMAA_BLENDING_WEIGHT_CALCULATION","SMAA_NEIGHBORHOOD_BLENDING",
"SMAA_RESOLVE"],h=0;h<g.length;h++){var k=va.ea(e,g[h]);k&&a.push(k)}if(a.length){e=[];h=L.AT_IMAGE_ELEMENT;e.push({id:"SEARCH_TEXTURE",type:h,He:S.lc.smaa_search_texture_path});e.push({id:"AREA_TEXTURE",type:h,url:S.lc.smaa_area_texture_path});for(h=0;h<a.length;h++)if(g=a[h],"SMAA_BLENDING_WEIGHT_CALCULATION"==g.type){a=g.wa;for(h=0;h<a.length;h++)if(g=a[h],"u_search_tex"==g.to)var n=g.Ha;else if("u_area_tex"==g.to)var l=g.Ha;break}e.length?L.enqueue(e,function(a,d,e,f){a&&(b(a,f,!1),d="SEARCH_TEXTURE"==
d?n:l,d.source="IMAGE",d.sH=!0,wa.Tk(d,a,-1!=f.indexOf(".dds")?1:0,f,c.id),wa.Jk(d,wa.s,wa.s))},function(){f(c,d)}):f(c,d)}else f(c,d)}function X(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];b.Ka||(e=Oa);for(var f=qa.Aa(e,"LAMP",b.id),g=0;g<f.length;g++){var h=f[g];h.f.uc==b.id&&d.Bn.push({na:e,obj:h})}f=qa.Aa(e,"ALL",b.id);for(g=0;g<f.length;g++)h=f[g],"LAMP"!=h.type&&h.f.uc==b.id&&(b.iu&&sa.is_mesh(h)&&va.hide_object(h),d.Bn.push({na:e,obj:h}))}}function fa(a,b,c,d,e,f){var g=d.Bn;
e=d.Au;if(g.length){a=g[e].obj;e=g[e].na;var h=sa.Oa(a,e);va.append_object(e,a,!1);a.anchor&&ja.append(a);d=++d.Au/g.length;"LAMP"==a.type&&qa.QE(e);g=h.qf;null!=a.f.od&&g&&va.bw(g,a.f.i);g=a.Fk;g.length&&e.j.Ii&&(e=h.Lf,va.ew(e,a.f.i,a.f.quat),sa.fw(g,e.k.mc))}else d=1;f(b,c,d)}function Q(a,b,c,d,e){if(b.Ka){a=va.ei();d=va.zt();for(var f=0;f<d.length;f++){var g=d[f];va.LD(g,a);g.b4w_use_logic_editor&&ya.gC(g,b.id)}va.set_active(a)}else va.$q(Oa);a=qa.get_all_objects(b.id);qa.SF(a);e(b,c)}function ha(a,
b,c,d,e){if(b.Ka)for(d=0;d<a.scenes.length;d++)E(a.scenes[d],b.id),G(a.scenes[d],b.id);else E(Oa,b.id),G(Oa,b.id);e(b,c)}function aa(a,b,c,d,e){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;b.ip||b.gp||b.mp?$a||R(a,e,b,c):e(b,c)}function R(a,b,c,d){var e=Xa.parentElement;Bc=e.style.zIndex;e.style.zIndex="999";$a=document.createElement("div");$a.style.position="relative";$a.style.height="88px";$a.style.width="88px";var f=Math.round(Xa.offsetWidth/2-44);$a.style.top=Math.round(Xa.offsetHeight/
2-44).toString()+"px";$a.style.left=f.toString()+"px";$a.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
$a.style.backgroundSize="88px";tb=document.createElement("div");tb.style.position="relative";tb.style.height=Xa.offsetHeight.toString()+"px";tb.style.width=Xa.offsetWidth.toString()+"px";tb.style.background="rgba(0, 0, 0, 0.5)";tb.style.zIndex="999";e.appendChild(tb);tb.appendChild($a);$a.addEventListener("click",function(){c.ip&&(wa.play(),wa.pause(),wa.reset());if(c.gp){if(c.Ka)for(var e=0;e<a.scenes.length;e++)G(a.scenes[e],c.id,!0);else G(Oa,c.id,!0);pa.pause()}c.mp&&pa.FD();W();b(c,d)},!1)}function W(){if($a){var a=
Xa.parentElement;a.style.zIndex=Bc;tb.removeChild($a);a.removeChild(tb);$a=tb=null;Bc=0}}function na(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function ia(a,b,c){ga.is_animated(b)&&ga.remove(b);qa.clear_outline_anim(b);ua.check_sensor_manifold(b)&&ua.remove_sensor_manifold(b);T.H(b)&&T.TD(b);va.UD(a,b,c);sa.is_speaker(b)&&pa.SE(b);ja.is_anchor(b)&&ja.remove(b)}function da(a){return(a=a.parent||ga.pt(a))?1+da(a):0}var ja=p("__anchors"),ga=p("__animation"),L=p("__assets"),O=p("__batch");
p("__camera");var S=p("__config"),ua=p("__controls"),P=p("__dds"),oa=p("__extensions");p("__lights");var la=p("__loader"),ea=p("__mat4"),Y=p("__md5"),U=p("__nla"),ya=p("__logic_nodes"),N=p("__nodemat"),qa=p("__objects"),sa=p("__obj_util"),T=p("__physics"),Z=p("__print"),Ba=p("__reformer"),Ra=p("__renderer"),va=p("__scenes"),pa=p("__sfx"),ma=p("__shaders"),wa=p("__textures"),sb=p("__time"),ta=p("__transform"),za=p("__util"),Ka=p("__vec4"),ka=S.q,Bb=S.Sd,ra=S.m,Wa=S.sg,Sa=S.w,kb=null,Aa=null,Ac="",
Oa=null,fc={},$a=null,tb=null,Bc=0,ld=["LAMP","CAMERA"],Ic=["MESH","CAMERA","EMPTY"],Xa=null;a.is_primary_loaded=function(a){return la.is_primary_loaded(a)};a.update=function(){la.VF(kb)};a.GE=function(a){Xa=a};a.QF=function(a,b){if($a){tb.style.height=b.toString()+"px";tb.style.width=a.toString()+"px";var c=Math.round(a/2-44);$a.style.top=Math.round(b/2-44).toString()+"px";$a.style.left=c.toString()+"px"}};a.load=function(a,b,g,h,k){var n={load_main:{Ta:la.lg,eb:!1,C:[],gb:!1,hb:500,vb:!1,lb:c},
duplicate_objects:{Ta:la.rc,eb:!1,C:["load_main"],gb:!1,hb:50,vb:!1,lb:A},load_binaries:{Ta:la.lg,eb:!1,C:["load_main"],gb:!1,hb:500,vb:!1,lb:m},wait_for_shaders:{Ta:la.rc,eb:!1,C:[],gb:!1,hb:50,vb:!0,nf:f},prepare_bindata:{Ta:la.rc,eb:!1,C:["duplicate_objects","load_binaries"],gb:!1,hb:100,vb:!1,lb:l},prepare_bpy_data:{Ta:la.rc,eb:!1,C:["duplicate_objects","prepare_bindata"],gb:!1,hb:100,vb:!1,lb:d},process_objects:{Ta:la.rc,eb:!1,C:["prepare_bpy_data"],gb:!1,hb:150,vb:!1,lb:x},process_scenes:{Ta:la.rc,
eb:!1,C:["process_objects","wait_for_shaders"],gb:!1,hb:300,vb:!1,lb:I},load_smaa_textures:{Ta:la.lg,eb:!1,C:["process_scenes"],gb:!1,hb:30,vb:!0,lb:ba},load_shoremap:{Ta:la.lg,eb:!1,C:["process_scenes"],gb:!1,hb:30,vb:!0,lb:V},load_textures:{Ta:la.lg,eb:!0,C:["process_scenes"],gb:!0,hb:500,vb:!1,lb:D},update_scenes_nla:{Ta:la.rc,eb:!1,C:["process_scenes","load_textures"],gb:!1,hb:50,vb:!1,lb:w},wait_physics_workers:{Ta:la.rc,eb:!1,C:["load_shoremap"],gb:!1,hb:20,vb:!1,nf:z},add_physics_objects:{Ta:la.rc,
eb:!1,C:["wait_physics_workers"],gb:!1,hb:50,vb:!1,lb:H},add_objects:{Ta:la.rc,eb:!1,C:["add_physics_objects"],gb:!1,hb:600,vb:!1,lb:X,nf:fa,wj:Q,xj:{Bn:[],Au:0}},load_speakers:{Ta:la.lg,eb:!0,C:["add_objects"],gb:!0,hb:100,vb:!1,lb:C},mobile_media_start:{Ta:la.rc,eb:!1,C:["load_textures","update_scenes_nla","load_speakers"],gb:!0,hb:5,vb:!1,lb:aa,nf:aa},synchronize_media:{Ta:la.rc,eb:!0,C:["mobile_media_start"],gb:!0,hb:50,vb:!1,lb:ha},start_nla:{Ta:la.rc,eb:!0,C:["mobile_media_start"],gb:!1,hb:5,
vb:!0,lb:r}},q=la.Ct();q||(q=la.dA(),kb={},Aa={},fc={});kb[q.me.length]={};return la.lA(n,a,b,g,e,h||Sa.Xr,ka.do_not_load_resources,k)};a.unload=function(a){var b=la.Ct();if(!b||!b.me.length||a&&!la.oF(b.me[a]))Z.error("Unable to unload data!");else{if(0==a)Z.log("%cUNLOAD ALL","color: #00a"),ja.cleanup(),ga.cleanup(),pa.cleanup(),U.cleanup(),va.cleanup(),la.cleanup(),T.cleanup(),qa.cleanup(),za.cleanup(),Ra.cleanup(),N.cleanup(),ma.cleanup(),ua.cleanup(),oa.cleanup(),L.cleanup(),wa.cleanup(),ya.cleanup(),
Aa=null,fc={},kb=Oa=null;else{Z.log("%cUNLOAD DATA "+a,"color: #00a");ga.SD(a);for(var b=va.ci(),c=0;c<b.length;c++)for(var d=b[c],e=qa.Aa(d,"ALL",a),f=e.length-1;0<=f;f--){var g=e[f];ia(d,g,!0);e.splice(f,1);var h=qa.Aa(d,g.type,a),g=h.indexOf(g);-1!=g&&h.splice(g,1)}}W()}};a.KD=ia;a.set_debug_resources_root=function(a){Ac=a}};b4w.module.__batch=function(a,p){function e(a){a={type:a,$a:"",id:0,VD:0,Bi:"",T:[],Vb:[],Sc:[],Gj:[],Ah:null,Ib:{},Ub:null,ib:{hj:null,$h:null,tf:[],Ff:[]},rl:[],YI:null,N:null,oe:!1,Eg:!1,Ns:!1,wireframe_mode:0,num_vertices:0,num_triangles:0,$t:0,au:0,Et:0,cp:0,wc:new Float32Array(3),Mc:new Float32Array(16),qg:!1,Ra:!1,ys:!1,da:!1,df:!1,bb:!1,fd:!1,Zd:!1,ad:!1,Dc:!1,Ec:!1,nc:!1,bc:!1,Cc:!1,Lb:!1,Qu:!1,De:W.mj,ff:W.re,ao:!1,Mg:!1,OD:"",gJ:"",Gt:!1,Kt:0,Ht:0,Lt:0,Mt:0,Jt:new Float32Array(3),It:new Float32Array(3),
Pg:!1,se:0,Ee:0,sf:1,reflect_factor:0,th:0,Bq:1,parallax_scale:0,rf:0,hf:1,vu:0,Jp:0,fh:0,av:0,Oc:Array(2),Fc:new Float32Array(3),Zf:new Float32Array(3),he:new Float32Array(3),vc:new Float32Array(4),Hd:new Float32Array(4),mi:null,up:null,sp:null,rp:null,tp:null,hi:!1,gg:!1,water_dynamic:!1,qn:!1,Bw:!1,Cw:0,Dw:0,Aw:0,kj:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,ft:new Float32Array(2),et:new Float32Array(2),Oo:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),
eh:null,hq:!1,va:null};a.vc[3]=1;a.ys=!0;a.da=!0;return a}function b(a){switch(a.type){case "MAIN":case "PARTICLES":a.$a=a.Ra?a.df?"XRAY":"BLEND":"OPAQUE";break;case "DEPTH":a.$a=a.hi?"NODES":"DEPTH";break;case "COLOR_ID":a.$a=a.df?"COLOR_ID_XRAY":"COLOR_ID"}}function c(a){var b=a.N;a.N=null;var c=da.pf(a);a.N=b;c.N=b;return c}function m(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d],f=e.fa.f,g=fa.Ad();fa.Il(f.Oh,g);var k=e.data.b4w_bounding_cylinder_radius,n=e.data.b4w_bounding_sphere_radius,m=
e.data.b4w_bounding_sphere_center,r=e.data.b4w_bounding_ellipsoid_axes,q=e.data.b4w_bounding_ellipsoid_center;if(f.Cd){var k=Math.max(Math.abs(g.max_x),Math.abs(g.min_x)),n=Math.max(Math.abs(g.max_y),Math.abs(g.min_y)),t=Math.max(Math.abs(g.max_z),Math.abs(g.min_z)),t=Math.sqrt(k*k+n*n+t*t),k=Math.sqrt(k*k+n*n);g.max_x=g.max_y=g.max_z=t;g.min_x=g.min_y=g.min_z=-t;n=t;m[0]=m[1]=m[2]=0;r[0]=r[1]=r[2]=t;q[0]=q[1]=q[2]=0}f.Qb=g;t=fa.Un(g,f.aa);f.sb=t;h(f,k,k,g);g=fa.Ll(n,m);f.nd=g;g=fa.Wn(g,f.aa);f.Rb=
g;r=fa.Kl([r[0],0,0],[0,r[1],0],[0,0,r[2]],q);f.kf=r;r=fa.Vn(r,f.Ba);f.ug=r;c=c.concat(l(e,f,b))}return c}function f(a,b,c){for(var d=[],e=[],f={},g=0;g<a.length;g++){var h=a[g],k=h.fa.f,n=fa.Ad();fa.Il(k.Oh,n);var m=fa.Un(n,k.aa),r=fa.Ll(h.data.b4w_bounding_sphere_radius,h.data.b4w_bounding_sphere_center),q=fa.Wn(r,k.aa),t=h.data.b4w_bounding_ellipsoid_axes,t=fa.Kl([t[0],0,0],[0,t[1],0],[0,0,t[2]],h.data.b4w_bounding_ellipsoid_center),p=fa.Vn(t,k.Ba);k.Qb=n;k.sb=m;k.nd=r;k.Rb=q;k.kf=t;k.ug=p;n={};
n.ad=k.ad;n.Dc=k.Dc;n.Ec=k.Ec;n.Ve=k.Ve;n.Cm=k.Cm;n.Ab=k.Ab;n.Bm=k.Bm;n.Ci=k.Ci;n.nc=k.nc;n.bc=k.bc;n.Cc=k.Cc;n.od=k.od;n.Wc=k.Wc;n.fe=k.fe;n.we=k.we;n.hd=k.hd;n.Ne=k.Ne;n.$b=k.$b;n.Cd=k.Cd;n.tj=k.tj;n.sj=k.sj;n.Lb=k.Lb;n.Uh=k.Uh;n.Sl=k.Sl;n.Oe=k.Oe;n.$g=k.$g;n.um=k.um;n.Tc=k.Tc;n.Zg=k.Zg;n.vm=k.vm;n.Zd=k.Zd;m=k.Rb.F;n.aC=0==c?[0,0]:[Math.floor(m[0]/c),Math.floor(m[2]/c)];n.Cf=k.Cf;n.qk=k.qk;n.Xg=k.Xg;n.Tl=k.Tl;k=JSON.stringify(n);f[k]=f[k]||[];f[k].push(h)}for(var u in f){n=JSON.parse(u);c=f[u];
var h=da.Sh("STATIC"),L;for(L in n)h[L]=n[L];h.uc=a[0].fa.f.uc;h.pe=0;h.cf=0;h.Ae=0;h.ze=0;h.ue=0;h.ii=!1;for(g=0;g<c.length;g++)k=c[g].fa,0==g?(h.sb=ea.qa(k.f.sb),h.Rb=ea.qa(k.f.Rb),h.kf=ea.qa(k.f.kf),h.ug=ea.qa(k.f.ug)):(fa.Xs(h.sb,k.f.sb),fa.PA(h.Rb,k.f.Rb));h.Qb=ea.qa(h.sb);h.nd=ea.qa(h.Rb);e.push({f:h,az:c})}for(a=0;a<e.length;a++)for(f=e[a].f,g=e[a].az,u=0;u<g.length;u++){L=g[u];c=L.fa.f;h=l(L,f,b);c.Cd&&!c.Pn?(k=la.create(),la.set_trans(c.i,k)):k=la.create_sep(c.i,c.scale,c.quat);n={};if(f.hd||
f.Cd)n.au_center_pos=[k[0],k[1],k[2]];f.hd&&(n.au_wind_bending_amp=[c.pe],n.au_wind_bending_freq=[L.b4w_wind_bending_freq],n.au_detail_bending_amp=[L.b4w_detail_bending_amp],n.au_detail_bending_freq=[L.b4w_detail_bending_freq],n.au_branch_bending_amp=[L.b4w_branch_bending_amp]);for(m=0;m<h.length;m++)t=h[m].f,r=h[m].cd,q=h[m].B,t.om?t.Cd?W.fF(r,k):W.Ov(r,k):("COLOR_ID"==q.type&&(h[m].f=c,q.Bi=L.uuid,F(q,c),t=E(c),G(q,t)),r=W.Ov(r,k),W.eF(r,n));d=d.concat(h)}return d}function l(a,b,c){var f=[],g=t(c,
b),h=E(b),k=a.data,n=k.materials,l=Array(n.length),m=ua.Ya(c,"MAIN_OPAQUE"),r=!1;m&&(r=m.tm.length?!0:!1);for(var q=0;q<g.length;q++)for(var p=g[q],u=0;u<n.length;u++){var L=n[u];if(("LENS_FLARES"!=L.name||r)&&!W.Nt(k,u)){var x=e(p);"COLOR_ID"==p&&(x.ao=!(a.b4w_do_not_render||L.b4w_do_not_render));"MAIN"==p&&(l[u]=x);if(M(x,L)){"DEPTH"==p&&l[u]&&(x.fd=l[u].fd);x.De=b.oe||b.Zd?W.el:W.mj;F(x,b);for(var v=x,S=a.particle_systems,z=0;z<S.length;z++){var H=S[z].settings.b4w_vcol_from_name,y=S[z].settings.b4w_vcol_to_name;
""!==H&&""!==y&&(v.Ib[H]={Og:!1,src:[{name:H,vd:7}]})}"DYNAMIC"==b.type&&(x.Bi=a.uuid);G(x,h);var A=W.$s(k,u,x.Gj,b.Qh,x.Ib,x.Ah);"LENS_FLARES"==L.name&&(A=ja.JD(A));f.push({B:x,cd:A,yc:[L.name],f:b,Ld:[a]})}}}var B=a.particle_systems;if(0<B.length&&f.length){for(var D=!1,V=!1,q=0;q<B.length;q++){var I=B[q],K=I.settings;K.use_render_emitter&&(D=!0);"HAIR"!=K.type||"OBJECT"!=K.render_type&&"GROUP"!=K.render_type&&I.transforms.length||(V=!0);if(D&&V)break}var J=f[0].B.Ib,ba;if(V){var X;if(1<n.length){for(var da=
{},oa=0;oa<B.length;oa++){var N=B[oa].settings;if("HAIR"==N.type&&("OBJECT"==N.render_type||"GROUP"==N.render_type)){var la=N.b4w_vcol_from_name,Q=N.b4w_vcol_to_name;""!==la&&""!==Q&&(da[la]=ea.qa(J[la]))}}"a_bending_col_main"in J&&(da.a_bending_col_main=ea.qa(J.a_bending_col_main));"a_bending_col_detail"in J&&(da.a_bending_col_detail=ea.qa(J.a_bending_col_detail));X=W.at(k,[],da)}else X=f[0].cd;ba=X}else ba=null;for(var fa,ga=ba,R=a.fa,U=[],T=a.particle_systems,ha=a.data,na=0;na<T.length;na++){var ia=
T[na],qa=ia.settings;if(qa.count)if("EMITTER"==qa.type){if("DYNAMIC"==b.type){var sa=e("PARTICLES"),eb,Ia=ha.materials,Ec=ia.settings.material-1;Ec>=Ia.length&&(aa.warn('Wrong material used for rendering particle system "'+ia.name+'"'),Ec=0);eb=Ia[Ec];"HALO"===ia.settings.render_type&&(sa.Pg=!0);d(sa,eb);var xb=sa,Da=ia.settings;switch(Da.b4w_billboard_align){case "VIEW":w(xb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":w(xb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":w(xb,
"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":w(xb,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:throw"Wrong billboard align value";}w(xb,"BILLBOARD",0);w(xb,"SOFT_PARTICLES",Da.b4w_enable_soft_particles&&0<Da.b4w_particles_softness&&ya.Oj?1:0);w(xb,"SOFT_STRENGTH",P.r(Da.b4w_particles_softness));P.G(xb.ib,"WORLD_SPACE","WORLD"==Da.b4w_coordinate_system?1:0);sa.Zd=!0;sa.Bi=R.name+"_"+qa.uuid;sa.OD=ia.name;G(sa,h);ja.hC(sa,ia,eb);var yb=ja.mB(sa,ha,ia,R.f.Ba);U.push({B:sa,cd:yb,yc:[eb.name],
f:b,Ld:[a]})}}else if("HAIR"==qa.type){var ca=ea.km(ia.seed);qa.b4w_dynamic_grass&&(b.Uh=!0);var pb=O.ts(ya.Cp)&&!qa.b4w_initial_rand_rotation&&!qa.b4w_hair_billboard,Ga=4;pb&&(Ga=8);if(ia.transforms.length)var xa=ia.transforms;else for(var Fa=W.Vo(ga,qa.count,!1,ca),xa=new Float32Array(Fa.length*Ga),La=0;La<Fa.length;La++){var Qb=.75+.5*ea.xd(ca);xa[La*Ga]=Fa[La][0];xa[La*Ga+1]=Fa[La][1];xa[La*Ga+2]=Fa[La][2];xa[La*Ga+3]=Qb;pb&&(xa[La*Ga+4]=1,xa[La*Ga+5]=0,xa[La*Ga+6]=0,xa[La*Ga+7]=0)}var Ua=ua.Ya(c,
"GRASS_MAP")?!0:!1;if("OBJECT"==qa.render_type)var lb=[t(c,qa.dupli_object.fa.f,!0)],Fb=C(a,b,J,ga,[qa.dupli_object],lb,[xa],qa,ia,Ua,ca,!1),U=U.concat(Fb);else if("GROUP"==qa.render_type){for(var Cb=qa.dupli_group.objects,lb=[],La=0;La<Cb.length;La++){var uc=t(c,Cb[La].fa.f,!0);lb.push(uc)}for(var sc=!1,hc=[],La=0;La<Cb.length;La++)hc.push(Cb[La].fa);if(qa.use_whole_group){for(var Ta,jb=xa,ic=hc,Jc=pb,Rb=Ga,ub={},zb=new Float32Array([0,0,0,1]),Qa=0;Qa<jb.length;Qa+=Rb)for(var fb=0;fb<ic.length;fb++){var Vb=
Y.create();Y.scale(ic[fb].f.i,ic[fb].f.scale,Vb);var Lb=Y.clone([jb[Qa],jb[Qa+1],jb[Qa+2]]);ub[fb]||(ub[fb]=new Float32Array(jb.length));Jc&&(ub[fb][Qa+4]=zb[0]=jb[Qa+4],ub[fb][Qa+5]=zb[1]=jb[Qa+5],ub[fb][Qa+6]=zb[2]=jb[Qa+6],ub[fb][Qa+7]=zb[3]=jb[Qa+7],ea.dq(zb,zb),ea.sF(Vb,zb,Vb));Y.add(Lb,Vb,Lb);ub[fb][Qa]=Lb[0];ub[fb][Qa+1]=Lb[1];ub[fb][Qa+2]=Lb[2];ub[fb][Qa+3]=jb[Qa+3]}Ta=ub;sc=!0}else{var Wb;if(qa.use_group_count){for(var Db=xa,jc=hc,mb=qa.dupli_weights,Xb=ca,Pa=pb,gb=Ga,ab={},Va=[],Za=0;Za<
jc.length;Za++)for(var bb=jc[Za],nb=bb.gh||bb.name,Eb=0;Eb<mb.length;Eb++){var Ca=mb[Eb];nb==Ca.name&&Va.push(Ca)}mb.length!=Va.length&&aa.error("dupli weights match failed");for(Za=0;Za<Db.length;Za+=gb){for(var cb,db=Va,Sb=[0],Ha=0;Ha<db.length;Ha++)Sb[Ha+1]=Sb[Ha]+db[Ha].count;for(var kc=Sb[Sb.length-1]*ea.xd(Xb),lc=0,Ha=0;Ha<Sb.length;Ha++)if(kc>=Sb[Ha]&&kc<Sb[Ha+1]){lc=Ha;break}cb=lc;ab[cb]=ab[cb]||[];ab[cb].push(Db[Za],Db[Za+1],Db[Za+2],Db[Za+3]);Pa&&ab[cb].push(Db[Za+4],Db[Za+5],Db[Za+6],Db[Za+
7])}for(cb in ab)ab[cb]=new Float32Array(ab[cb]);Wb=ab}else{for(var Hb=xa,Ib=ca,hb=pb,Ab=Ga,dc=hc.length,ib={},Ea=0;Ea<Hb.length;Ea+=Ab){var qb=Math.floor(dc*ea.xd(Ib));ib[qb]=ib[qb]||[];ib[qb].push(Hb[Ea],Hb[Ea+1],Hb[Ea+2],Hb[Ea+3]);hb&&ib[qb].push(Hb[Ea+4],Hb[Ea+5],Hb[Ea+6],Hb[Ea+7])}for(qb in ib)ib[qb]=new Float32Array(ib[qb]);Wb=ib}Ta=Wb}Fb=C(a,b,J,ga,Cb,lb,Ta,qa,ia,Ua,ca,sc);U=U.concat(Fb)}"INSTANCE"==qa.b4w_wind_bend_inheritance&&R.f.hd&&aa.warn('Emitter object "'+R.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else throw"Unknown particle settings type";
}fa=U;f=D?f.concat(fa):fa}return f}function h(a,b,c,d){a.Mn=fa.Hs(b,d);a.Kn=fa.Fs(c,d);a.Ln=fa.Gs(b,d)}function t(a,b,c){var d;b.Tl&&!c?(d=[],b.Ve&&ua.Ya(a,"COLOR_PICKING")&&d.push("COLOR_ID")):(d=["MAIN","NODES_GLOW"],(b.Ve&&ua.Ya(a,"COLOR_PICKING")||b.Ab&&ua.Ya(a,"OUTLINE_MASK"))&&!c&&d.push("COLOR_ID"),ua.Ya(a,"WIREFRAME")&&d.push("WIREFRAME"),(ua.Ya(a,"DEPTH")||ua.Ya(a,"SHADOW_CAST"))&&d.push("DEPTH"),ua.Ya(a,"GRASS_MAP")&&d.push("GRASS_MAP"));d.push("PHYSICS");if(b.Dc||b.bc)for(a=null,b.Dc&&
(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","WIREFRAME"]),b.bc&&(b=["COLOR_ID","PHYSICS","DEPTH","WIREFRAME"],a=null!==a?ea.Iy(a,b):b),b=a,a=0;a<b.length;a++)c=d.indexOf(b[a]),-1!==c&&d.splice(c,1);return d}function d(a,b){var c;switch(a.type){case "MAIN":if(b.b4w_do_not_render)c=!1;else{if(b.use_nodes)y(a,b,"MAIN");else{k(a,b);var d=b.game_settings.alpha_blend;a.df=b.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.fh=b.offset_z;a.Zf.set([1,1,1]);var e=b.texture_slots;U.set(b.diffuse_color[0],b.diffuse_color[1],
b.diffuse_color[2],b.alpha,a.vc);switch(b.name){case "LENS_FLARES":K(a,"special_lens_flares.glslv","special_lens_flares.glslf");D(a,"a_position");D(a,"a_texcoord");var f=n(e[0],null);z(a,f);break;default:K(a,"main_stack.glslv","main_stack.glslf");b.use_shadeless||(c=ia.oo(b.uuid,b.name,{fd:b.use_shadeless,Pj:b.diffuse_shader,Qi:b.specular_shader}),a.ib.Ff=ia.Gl(c));var h=x("use_map_color_diffuse",e),l=x("use_map_color_spec",e),m=x("use_map_normal",e),r=x("use_map_mirror",e),f=x("use_stencil",e);c=
h[0];l=l[0];m=m[0];r=r[0];h=h[1];e=f[0]&&x("use_rgb_to_intensity",e)[0];if(c){switch(c.blend_type){case "MIX":w(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":w(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}f=n(c,null);z(a,f,"u_colormap0");ya.Dn&&"CLIP"==d&&oa.Jk(f,oa.Ic,oa.Ic);a.rf=c.diffuse_color_factor;a.hf=c.use_map_alpha?c.alpha_factor:0;a.Zf.set(c.scale)}d=c&&c==l;l&&(d||(f=n(l,null),z(a,f,"u_specmap0")),a.th=l.specular_color_factor);if(m&&(D(a,"a_normal"),D(a,
"a_tangent"),f=n(m,null),z(a,f,"u_normalmap0"),a.vu=m.normal_factor,f=m.texture,f.b4w_use_map_parallax&&ya.yk)){var q=P.r(f.b4w_parallax_steps),t=P.r(f.b4w_parallax_lod_dist);w(a,"PARALLAX",1);w(a,"PARALLAX_STEPS",q);w(a,"PARALLAX_LOD_DIST",t);a.parallax_scale=f.b4w_parallax_scale}r&&(f=n(r,null),z(a,f,"u_mirrormap"),a.Jp=r.mirror_factor);if(r=c&&h&&e?1:0)f=n(h,null),z(a,f,"u_colormap1"),f=n(e,null),z(a,f,"u_stencil0");(f=c||l||m)&&a.Zf.set(f.scale);w(a,"TEXTURE_SPEC",void 0==l?0:1);w(a,"ALPHA_AS_SPEC",
d?1:0);w(a,"TEXTURE_STENCIL_ALPHA_MASK",r);D(a,"a_position");D(a,"a_normal");(c||l||m)&&D(a,"a_texcoord");if(b.b4w_water){a.gg=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.Ra?(aa.warn('Material: "'+b.name+'" is opaque.',"Disabling shore smoothing."),a.qn=!1):a.qn=b.b4w_water_shore_smoothing;K(a,"special_water.glslv","special_water.glslf");d=ia.oo(b.uuid,b.name,{fd:!1,Pj:b.diffuse_shader,Qi:b.specular_shader});a.ib.Ff=ia.Gl(d);D(a,"a_position");ya.Ew?(D(a,"a_polyindex"),a.da=
!0,a.wireframe_edge_color=[0,0,0],w(a,"DEBUG_WIREFRAME",1)):w(a,"DEBUG_WIREFRAME",0);r=b.texture_slots;d=x("use_map_normal",r);f=x("use_map_mirror",r)[0];d.length&&(q=n(d[0]),z(a,q,"u_normalmap0"),a.kj=b.b4w_water_norm_uv_velocity);w(a,"NUM_NORMALMAPS",d.length);a.eh=Array(d.length);for(q=0;q<d.length;q++)a.eh[q]=new Float32Array(2),a.eh[q].set([d[q].scale[0],d[q].scale[1]]);f&&(q=n(f),z(a,q,"u_mirrormap"),a.Jp=f.mirror_factor);f=null;if(ya.Zh)for(q=0;q<r.length;q++){var p=r[q];if(!0===p.texture.b4w_water_foam){f=
p;break}}f?(w(a,"FOAM",1),q=n(f),z(a,q,"u_foam"),a.foam_factor=b.b4w_foam_factor,a.ft.set(f.texture.b4w_foam_uv_freq),a.et.set(f.texture.b4w_foam_uv_magnitude),a.Oo[0]=f.scale[0],a.Oo[1]=f.scale[1]):w(a,"FOAM",0);for(q=0;q<r.length;q++)if(p=r[q],!0===p.texture.b4w_shore_dist_map){var u=p;break}u&&ya.Cn?(u=n(u),z(a,u,"u_shore_dist_map"),w(a,"SHORE_PARAMS",1),u=p.texture.b4w_shore_boundings,w(a,"MAX_SHORE_DIST",P.r(p.texture.b4w_max_shore_dist)),w(a,"SHORE_MAP_SIZE_X",P.r(u[0]-u[1])),w(a,"SHORE_MAP_SIZE_Y",
P.r(u[2]-u[3])),w(a,"SHORE_MAP_CENTER_X",P.r((u[0]+u[1])/2)),w(a,"SHORE_MAP_CENTER_Y",P.r((u[2]+u[3])/2))):w(a,"SHORE_PARAMS",0);if(b.b4w_generated_mesh&&ya.Oj)w(a,"GENERATED_MESH",1),a.Bw=!0,a.Cw=b.b4w_water_num_cascads,a.Dw=b.b4w_water_subdivs,a.Aw=b.b4w_water_detailed_dist;else{D(a,"a_normal");if(f||d.length)D(a,"a_texcoord"),D(a,"a_tangent");w(a,"GENERATED_MESH",0)}if(b.b4w_water_dynamic){var p=P.r(b.b4w_water_dst_noise_scale0),u=P.r(b.b4w_water_dst_noise_scale1),d=P.r(b.b4w_water_dst_noise_freq0),
r=P.r(b.b4w_water_dst_noise_freq1),f=P.r(b.b4w_water_dir_min_shore_fac),q=P.r(b.b4w_water_dir_freq),t=P.r(b.b4w_water_dir_noise_scale),L=P.r(b.b4w_water_dir_noise_freq),v=P.r(b.b4w_water_dir_min_noise_fac),S=P.r(b.b4w_water_dst_min_fac),O=P.r(b.b4w_water_waves_hor_fac);w(a,"DST_NOISE_SCALE_0",p);w(a,"DST_NOISE_SCALE_1",u);w(a,"DST_NOISE_FREQ_0",d);w(a,"DST_NOISE_FREQ_1",r);w(a,"DIR_MIN_SHR_FAC",f);w(a,"DIR_FREQ",q);w(a,"DIR_NOISE_SCALE",t);w(a,"DIR_NOISE_FREQ",L);w(a,"DIR_MIN_NOISE_FAC",v);w(a,"DST_MIN_FAC",
S);w(a,"WAVES_HOR_FAC",O)}A(a,b);B(a,b);a.shallow_water_col.set(b.b4w_shallow_water_col);a.shore_water_col.set(b.b4w_shore_water_col);a.shallow_water_col_fac=b.b4w_shallow_water_col_fac;a.shore_water_col_fac=b.b4w_shore_water_col_fac;w(a,"ABSORB",P.r(b.b4w_water_absorb_factor));w(a,"SSS_STRENGTH",P.r(b.b4w_water_sss_strength));w(a,"SSS_WIDTH",P.r(b.b4w_water_sss_width))}"HALO"===b.type&&(p=b.halo,K(a,"halo.glslv","halo.glslf"),w(a,"NUM_RINGS",p.ring_count),w(a,"NUM_LINES",p.line_count),w(a,"NUM_STARS",
p.star_tip_count),w(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0),a.Gj=["a_position"],a.Kt=p.size,a.Ht=p.hardness/20,a.Jt.set(p.b4w_halo_rings_color),a.It.set(p.b4w_halo_lines_color),a.Lt=1/b.b4w_halo_stars_blend_height,a.Mt=b.b4w_halo_stars_min_height,a.Gt=!0);w(a,"TEXCOORD",0);w(a,"NORMAL_TEXCOORD",0);c&&g(a,c,"TEXTURE_COLOR0_CO");h&&g(a,h,"TEXTURE_COLOR1_CO");e&&g(a,e,"TEXTURE_STENCIL_ALPHA_MASK_CO");l&&g(a,l,"TEXTURE_SPEC_CO");m&&g(a,m,"TEXTURE_NORM_CO");w(a,"SHADELESS",b.use_shadeless?1:0);a.fd=b.use_shadeless}d=
b.game_settings.alpha_blend;w(a,"ALPHA","OPAQUE"===d?0:1);w(a,"ALPHA_CLIP","CLIP"===d?1:0);w(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);b.use_vertex_color_paint?(w(a,"VERTEX_COLOR",1),D(a,"a_color")):w(a,"VERTEX_COLOR",0);a.se=b.ambient;a.sf=b.diffuse_intensity;a.Ee=b.emit;a.he.set(b.specular_color);a.Bq=b.specular_alpha;A(a,b);B(a,b);b.b4w_wettable?w(a,"WETTABLE",1):w(a,"WETTABLE",0);I(a,b);a.hq=b.b4w_refractive;a.av=b.b4w_refr_bump}c=!0}break;case "NODES_GLOW":c=y(a,b,"GLOW");break;
case "DEPTH":if("LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type)c=!1;else if(k(a,b),a.Ra)c=!1;else{l=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==l?y(a,b,"DEPTH"):(K(a,"depth.glslv","depth.glslf"),U.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.vc));D(a,"a_position");D(a,"a_normal");w(a,"ALPHA","OPAQUE"===l?0:1);a.Zf.set([1,1,1]);if((c=x("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===l){a.Zf.set(c.scale);w(a,"TEXTURE_COLOR",1);D(a,"a_texcoord");
if("IMAGE"==c.texture.j.source||"ENVIRONMENT_MAP"==c.texture.j.source)l=n(c),z(a,l,"u_colormap0");"NONE"==c.texture.j.source&&(l=n(c),z(a,l,"u_colormap0"))}else w(a,"TEXTURE_COLOR",0);c=!0}break;case "PHYSICS":b.b4w_collision?(a.Xk=b.b4w_use_ghost,a.Ia=b.b4w_collision_id,a.Dj=b.b4w_collision_margin,a.Bj=b.b4w_collision_group,a.Ej=b.b4w_collision_mask,a.$j=b.physics.friction,a.Uj=b.physics.elasticity,c=!0):b.b4w_water?(a.gg=!0,a.AG=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,
a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if("LENS_FLARES"===b.name||
"HALO"===b.type)c=!1;else{k(a,b);a.ff=W.re;a.da=!0;a.Ra=!1;l=b.game_settings.alpha_blend;a.df=b.b4w_render_above_all&&"OPAQUE"!=l&&"CLIP"!=l;b.use_nodes&&"CLIP"==l?y(a,b,"COLOR_ID"):(K(a,"color_id.glslv","color_id.glslf"),U.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.vc));D(a,"a_position");w(a,"ALPHA","OPAQUE"===l?0:1);a.Zf.set([1,1,1]);if((c=x("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===l){a.Zf.set(c.scale);w(a,"TEXTURE_COLOR",1);D(a,"a_texcoord");if("IMAGE"==
c.texture.j.source||"ENVIRONMENT_MAP"==c.texture.j.source)l=n(c),z(a,l,"u_colormap0");"NONE"==c.texture.j.source&&(l=n(c),z(a,l,"u_colormap0"))}else w(a,"TEXTURE_COLOR",0);c=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?c=!1:(k(a,b),a.Ra=!1,a.ff=W.re,a.da=!0,K(a,"grass_map.glslv","grass_map.glslf"),D(a,"a_position"),c=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,l=b.b4w_dynamic_grass_color?b.b4w_dynamic_grass_color:null,a.Ib.a_grass_size={Og:!0,src:[]},c?(a.Ib.a_grass_size.src.push({name:c,
vd:4}),w(a,"DYNAMIC_GRASS_SIZE",1)):w(a,"DYNAMIC_GRASS_SIZE",0),a.Ib.a_grass_color={Og:!0,src:[]},l?(a.Ib.a_grass_color.src.push({name:l,vd:7}),w(a,"DYNAMIC_GRASS_COLOR",1)):w(a,"DYNAMIC_GRASS_COLOR",0),c=!0);break;case "WIREFRAME":"LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type?c=!1:(K(a,"wireframe.glslv","wireframe.glslf"),D(a,"a_position"),D(a,"a_normal"),D(a,"a_polyindex"),a.da=!0,a.wireframe_mode=0,a.wireframe_edge_color=[0,0,0],c=!0);break;case "PARTICLES":if(b.b4w_do_not_render)c=
!1;else{c=b.texture_slots;if(a.Pg)K(a,"particles_color.glslv","particles_color.glslf");else if(K(a,"particles_texture.glslv","particles_texture.glslf"),l=ia.oo(b.uuid,b.name,{fd:!1,Pj:b.diffuse_shader,Qi:b.specular_shader}),a.ib.Ff=ia.Gl(l),c=x("use_map_color_diffuse",c)[0]){w(a,"TEXTURE_COLOR",1);switch(c.blend_type){case "MIX":w(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":w(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.rf=c.diffuse_color_factor;a.hf=c.use_map_alpha?
c.alpha_factor:0;c=n(c);z(a,c)}U.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.vc);a.se=b.ambient;a.sf=b.diffuse_intensity;a.Ee=b.emit;a.he.set(b.specular_color);a.Bq=b.specular_alpha;D(a,"a_position");D(a,"a_normal");c=b.game_settings.alpha_blend;w(a,"ALPHA","OPAQUE"===c?0:1);w(a,"ALPHA_CLIP","CLIP"===c?1:0);w(a,"PARTICLES_SHADELESS",b.use_shadeless?1:0);A(a,b);B(a,b);k(a,b);c=b.game_settings.alpha_blend;a.df=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.fh=b.offset_z;
c=!0}break;default:throw"Wrong batch type: "+a.type;}return c}function g(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":w(a,c,"TEXTURE_COORDS_UV_ORCO");w(a,"TEXCOORD",1);break;case "NORMAL":w(a,c,"TEXTURE_COORDS_NORMAL");w(a,"NORMAL_TEXCOORD",1);break;default:w(a,c,0)}}function k(a,b){var c=b.game_settings,d=c.alpha_blend;switch(d){case "ALPHA_SORT":a.Ra=!0;a.ff=W.Er;a.da=!0;a.qg=!1;break;case "ALPHA":a.Ra=!0;a.ff=W.re;a.da=!0;a.qg=!1;break;case "CLIP":a.Ra=!1;a.ff=W.re;a.da=!0;a.qg=!0;break;
case "ADD":a.Ra=!0;a.ff=W.re;a.da=!1;a.qg=!1;break;case "OPAQUE":a.Ra=!1;a.ff=W.re;a.da=!0;a.qg=!1;break;default:throw Error("Unknown alpha blend mode: "+d);}a.bb=c.use_backface_culling}function n(a,b){var c=a.texture,d=c.j,c=c.image;d&&b&&c&&oa.Tk(d,b,c.Jc,c.filepath);return d}function x(a,b){for(var c=[],d=b.length,e=0;e<d;e++){var f=b[e];1==f[a]&&f.texture&&f.texture.j&&c.push(f)}return c}function I(a,b){var c=b.raytrace_transparency;a.Hd[0]=c.fresnel;a.Hd[1]=1-c.fresnel_factor/5;c=b.raytrace_mirror;
a.reflect_factor=c.reflect_factor;a.Hd[2]=c.fresnel;a.Hd[3]=1-c.fresnel_factor/5}function A(a,b){var c,d=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":c=b.specular_hardness;break;case "WARDISO":c=b.specular_slope;break;case "TOON":c=b.specular_toon_size;d=b.specular_toon_smooth;break;case "BLINN":c=b.specular_ior;d=b.specular_hardness;break;default:aa.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.Fc[0]=b.specular_intensity;a.Fc[1]=
c;a.Fc[2]=d}function B(a,b){switch(b.diffuse_shader){case "LAMBERT":a.Oc[0]=0;a.Oc[1]=0;break;case "OREN_NAYAR":a.Oc[0]=b.roughness;a.Oc[1]=0;break;case "FRESNEL":a.Oc[0]=b.diffuse_fresnel;a.Oc[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.Oc[0]=b.darkness;a.Oc[1]=0;break;case "TOON":a.Oc[0]=b.diffuse_toon_size;a.Oc[1]=b.diffuse_toon_smooth;break;default:aa.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.Oc[0]=0,a.Oc[1]=0}}function y(a,b,c){if(!b.use_nodes||
b.b4w_do_not_render)return!1;var d;switch(c){case "MAIN":K(a,"main.glslv","main.glslf");d=!1;break;case "GLOW":K(a,"main.glslv","main.glslf");d=!0;break;case "DEPTH":K(a,"depth.glslv","depth.glslf");d=!1;break;case "COLOR_ID":K(a,"color_id.glslv","color_id.glslf"),d=!1}c=ia.Fz(b.node_tree,b.uuid,!1,b.name,c);if(!c)return aa.error('Failed to create node graph for material "'+b.name+'", disable nodes'),v(a,b),!0;a.hi=!0;w(a,"NODES",1);w(a,"NODES_GLOW",d?1:0);var e=b.game_settings.alpha_blend;w(a,"ALPHA",
"OPAQUE"===e?0:1);w(a,"ALPHA_CLIP","CLIP"===e?1:0);w(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);D(a,"a_position");b.use_orco_tex_coord&&D(a,"a_orco_tex_coord");k(a,b);a.fh=b.offset_z;e=b.game_settings.alpha_blend;a.df=b.b4w_render_above_all&&"OPAQUE"!=e&&"CLIP"!=e;U.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.vc);a.Ee=b.emit;a.se=b.ambient;I(a,b);b.b4w_wettable?w(a,"WETTABLE",1):w(a,"WETTABLE",0);a.ib.Ff=ia.Gl(c);var f=!1;na.W(c,function(b,c){switch(c.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var d=
c.data.name,g=c.data.value;a.Ah||(a.Ah={});a.Ah[g]=d;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":d=c.data.name;a.Ib[d]={Og:!0,src:[{name:c.data.value}]};g=0;if("GEOMETRY_VC"==c.type)g=7;else for(var h=0;h<c.la.length;h++){var k="RGB".indexOf(c.la[h].identifier);-1<k&&(g|=1<<2-k)}a.Ib[d].src[0].vd=g;break;case "TEX_COORD_NO":case "GEOMETRY_NO":D(a,"a_normal");break;case "MATERIAL_BEGIN":D(a,"a_normal");f=!0;break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":d=
c.data.name;g=c.data.value;!1!==g.j.ll&&(g.j.ll="TEXTURE_ENVIRONMENT"!=c.type?!0:!1);z(a,g.j,d);ya.Dn&&"CLIP"==e&&oa.Jk(c.data.value.j,oa.Ic,oa.Ic);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":w(a,"CALC_TBN_SPACE",1);D(a,"a_normal");D(a,"a_tangent");d=c.data.name;g=c.data.value;g.j.ll=!1;z(a,g.j,d);break;case "LAMP":c.data&&(a.mi=c.data);break;case "B4W_REFRACTION":a.hq=!0}});f||(a.fd=!0);return!0}function v(a,b){switch(a.type){case "DEPTH":K(a,"depth.glslv","depth.glslf");break;case "COLOR_ID":K(a,
"color_id.glslv","color_id.glslf");break;default:K(a,"main_stack.glslv","main_stack.glslf")}w(a,"SHADELESS",1);D(a,"a_position");D(a,"a_normal");U.set(1,0,1,1,a.vc);if(b){var c=b.game_settings.alpha_blend;w(a,"ALPHA","OPAQUE"===c?0:1);w(a,"ALPHA_CLIP","CLIP"===c?1:0);w(a,"VERTEX_COLOR",0);a.fh=b.offset_z;k(a,b)}return!0}function F(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.om?w(a,"AU_QUALIFIER","attribute"):w(a,"AU_QUALIFIER","uniform"),w(a,"STATIC_BATCH",0)):(w(a,"AU_QUALIFIER","attribute"),
w(a,"STATIC_BATCH",1));"WIREFRAME"==a.type&&(R.SB()?w(a,"WIREFRAME_QUALITY",1):w(a,"WIREFRAME_QUALITY",0),a.Eg?(w(a,"DEBUG_SPHERE",1),a.Ns?w(a,"DEBUG_SPHERE_DYNAMIC",1):w(a,"DEBUG_SPHERE_DYNAMIC",0)):w(a,"DEBUG_SPHERE",0),w(a,"ALPHA",1));b.oe&&(a.oe=b.oe);b.hd?(""!==b.Ne?(a.Ib.a_bending_col_main={Og:!0,src:[{name:b.Ne,vd:4}]},D(a,"a_bending_col_main"),""!==b.$b.eu&&""!==b.$b.du&&""!==b.$b.Fu?(a.Ib.a_bending_col_detail={Og:!0,src:[{name:b.$b.eu,vd:4},{name:b.$b.du,vd:2},{name:b.$b.Fu,vd:1}]},D(a,"a_bending_col_detail"),
D(a,"a_normal"),w(a,"DETAIL_BEND",1)):w(a,"DETAIL_BEND",0),w(a,"MAIN_BEND_COL",1)):w(a,"MAIN_BEND_COL",0),w(a,"WIND_BEND",1)):w(a,"WIND_BEND",0);b.vl?w(a,"BEND_CENTER_ONLY",1):w(a,"BEND_CENTER_ONLY",0);w(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.Pn|0);b.Cd?w(a,"BILLBOARD",1):w(a,"BILLBOARD",0);b.Cd&&b.om?w(a,"HAIR_BILLBOARD",1):w(a,"HAIR_BILLBOARD",0);b.sj?w(a,"BILLBOARD_SPHERICAL",1):w(a,"BILLBOARD_SPHERICAL",0);switch(b.tj){case "RANDOM":w(a,"BILLBOARD_RANDOM",1);w(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":w(a,
"BILLBOARD_RANDOM",0);w(a,"BILLBOARD_JITTERED",1);break;default:w(a,"BILLBOARD_RANDOM",0),w(a,"BILLBOARD_JITTERED",0)}b.Lb&&ya.Cn?w(a,"DYNAMIC_GRASS",1):w(a,"DYNAMIC_GRASS",0);a.Lb=b.Lb;a.Zd=b.Zd;a.ad=b.ad;a.Dc=b.Dc;a.Ec=b.Ec&&!a.fd&&!(a.Ra&&ya.Bo);a.nc=b.nc;a.bc=b.bc;a.Cc=b.Cc;b.li?(D(a,"a_influence"),w(a,"SKINNED",1),ya.Pr?(w(a,"DISABLE_TANGENT_SKINNING",1),w(a,"FRAMES_BLENDING",0)):(w(a,"DISABLE_TANGENT_SKINNING",0),b.Zj?w(a,"FRAMES_BLENDING",1):w(a,"FRAMES_BLENDING",0)),w(a,"MAX_BONES",b.Pe)):
(w(a,"SKINNED",0),w(a,"FRAMES_BLENDING",0),w(a,"DISABLE_TANGENT_SKINNING",0));b.Wb?(w(a,"VERTEX_ANIM",1),ya.tw?w(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):w(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):w(a,"VERTEX_ANIM",0);if(b.li&&b.Wb)throw"Skinning and vertex animation are mutually exlusive";b.Sl?w(a,"DISABLE_FOG",1):w(a,"DISABLE_FOG",0);if(a.hi){for(var c=a.ib.Ff,d=b.$g,e=b.Zg,f=0;f<c.length;f++){var g=c[f];switch(g.id){case "VALUE":var h=g.Dm[0];if(h)for(var k=0;k<d.length;k+=2)if(d[k]==
h){g.qd.push(["VALUE_IND",d[k+1]]);break}break;case "RGB":if(h=g.Dm[0])for(k=0;k<e.length;k+=2)if(e[k]==h){g.qd.push(["RGB_IND",e[k+1]]);break}}}w(a,"NUM_VALUES",b.Oe.length);w(a,"NUM_RGBS",b.Tc.length)}}}function u(a,b,c){if(b.length){for(var d=da.Zo(b)||b[0],e=a.ib,f=0,g=0;g<a.ib.Ff.length;g++){var h=a.ib.Ff[g];if("LIGHTING_LAMP"==h.id){var k=b[f++%b.length],n=k.Fa;"AREA"==n.type&&(k=b[f++%b.length],n=k.Fa);var l=da.Oa(k,c);if("SPOT"==n.type||"POINT"==n.type)var m=Math.cos(n.Ye/2);if("SPOT"==n.type)var r=
n.Mk*(1-m);l=l.ni;k=k==d?0:-1;h.qd=[["LAMP_TYPE",n.type],["LAMP_IND",l],["LAMP_LIGHT_FACT_IND",Math.floor(l/2)],["LAMP_FAC_CHANNELS",0==l%2?"rg":"ba"],["LAMP_SPOT_SIZE",P.r(m||.01)],["LAMP_SPOT_BLEND",P.r(r||.01)],["LAMP_LIGHT_DIST",P.r(n.distance)],["LAMP_SHADOW_MAP_IND",k]]}}if(a.mi){c=0;for(var t in a.mi)c++;a.up=new Float32Array(3*c);a.sp=new Float32Array(3*c);a.rp=new Float32Array(3*c);a.tp=new Float32Array(4*c);P.G(e,"NUM_LAMP_LIGHTS",c);for(g=0;g<b.length;g++)q(a,b[g])}}}function q(a,b){if(b.zh in
a.mi){var c=a.mi[b.zh];a.up.set(b.f.i,3*c);a.sp.set(b.Fa.direction,3*c);a.rp.set(b.Fa.Fj,3*c);var d=sa,e=b.Fa;d[0]=-1;d[1]=-1;d[2]=-1;d[3]=e.yh?1:0;switch(e.type){case "POINT":d[2]=e.distance;break;case "SPOT":d[2]=e.distance;var f=d[0]=Math.cos(e.Ye/2);d[1]=e.Mk*(1-f)}a.tp.set(d,4*c)}}function D(a,b){var c=a.Gj;-1==c.indexOf(b)&&c.push(b)}function w(a,b,c){P.G(a.ib,b,c)}function J(a,b){if("PHYSICS"==a.type)a.cd=b;else{var c=a.ff,d=a.De;a.Gt&&(b=W.VA(b));a.Bw&&(b=ga.rB(a.Cw,a.Dw,a.Aw));c=W.hF(b,c,
d,a.Ib);a.N=c;a.Zd||c.jm||a.oe||(c.zf=null,c.gd=null);c=b.A.length;a.num_vertices=b.P*c;a:switch(a.De){case W.mj:case W.fl:case W.el:d=!0;break a;default:d=!1}d?W.qC(b)?a.num_triangles=b.ra.length/3*c:a.num_triangles=b.P/3*c:a.num_triangles=0}}function C(a,b,c,d,f,g,h,k,n,l,m,r){var q=a.fa,t=[],p=k.b4w_dynamic_grass;if(!l&&p)return t;for(var u="INSTANCE"==k.b4w_wind_bend_inheritance,x="INSTANCE"==k.b4w_shadow_inheritance,v="INSTANCE"==k.b4w_reflection_inheritance,S=[],z=[],H=0;H<f.length;H++){var w=
f[H].fa.f,y=ea.Aj(b);y.Cd=k.b4w_hair_billboard;y.tj=k.b4w_hair_billboard_type;y.sj="SPHERICAL"==k.b4w_hair_billboard_geometry;y.Lb=p;y.om=!0;y.Oe=w.Oe;y.$g=w.$g;y.Tc=w.Tc;y.Zg=w.Zg;u?(y.hd=w.hd,y.$k=w.$k,y.cf=w.cf,y.Ae=w.Ae,y.Ne=w.Ne,y.ze=w.ze,y.ue=w.ue,y.pe=w.pe,y.$b=w.$b,y.vl=!1):(y.hd=q.f.hd,y.$k=q.f.$k,y.cf=q.f.cf,y.Ae=q.f.Ae,y.Ne=q.f.Ne,y.ze=q.f.ze,y.ue=q.f.ue,y.pe=q.f.pe,y.$b=q.f.$b,y.vl=!0);x?(y.ad=w.ad,y.Dc=w.Dc,y.Ec=w.Ec):(y.ad=q.f.ad,y.Dc=q.f.Dc,y.Ec=q.f.Ec);v?(y.nc=w.nc,y.bc=w.bc,y.Cc=
w.Cc,y.od=w.od,y.Wc=w.Wc,y.fe=w.fe):(y.nc=q.f.nc,y.bc=q.f.bc,y.Cc=q.f.Cc,y.od=q.f.od,y.Wc=q.f.Wc,y.fe=q.f.fe);S.push(y);var A=h[H];A||(A=new Float32Array);r&&ea.km(n.seed,m);var B=new Float32Array(3),D=new Float32Array([0,0,0,1]),C=[],V=O.ts(ya.Cp)&&!k.b4w_initial_rand_rotation&&!k.b4w_hair_billboard,I=4;V&&(I=8);for(var K=0;K<A.length;K+=I){B[0]=A[K];B[1]=A[K+1];B[2]=A[K+2];var P=A[K+3]*w.scale;if(k.b4w_initial_rand_rotation){switch(k.b4w_rotation_type){case "XYZ":var ua=new Float32Array([ea.xd(m),
ea.xd(m),ea.xd(m)]);Y.normalize(ua,ua);break;case "Z":ua=new Float32Array([0,1,0]);break;default:throw"Unsupported random rotation type: "+k.b4w_rotation_type;}L.setAxisAngle(ua,k.b4w_rand_rotation_strength*(2*Math.PI*ea.xd(m)-Math.PI),D)}else V&&(D.set(A.subarray(K+4,K+8)),ea.dq(D,D),k.use_whole_group||(k.use_rotation_dupli?L.multiply(D,w.quat,D):L.multiply(D,qa,D)));var J=la.create_sep(B,P,D);C.push(J)}z.push(C)}for(var ba={},H=0;H<f.length;H++){var X=f[H],da=g[H],y=S[H],oa={};y.hd&&(oa.au_wind_bending_amp=
[y.pe],oa.au_wind_bending_freq=[y.cf],oa.au_detail_bending_freq=[y.Ae],oa.au_detail_bending_amp=[y.ze],oa.au_branch_bending_amp=[y.ue],y.pe=0,y.cf=0,y.Ae=0,y.ze=0,y.ue=0);var N=E(y),C=z[H];if(C.length)for(var Q=X.data,fa=Q.materials,ja=Array(fa.length),K=0;K<fa.length;K++)if(!W.Nt(Q,K))for(var ga=0;ga<da.length;ga++){var R=da[ga],T=e(R),ha=fa[K];"COLOR_ID"==R&&(T.ao=!(X.b4w_do_not_render||ha.b4w_do_not_render));"MAIN"==R&&(ja[K]=T);if(M(T,ha)){"DEPTH"==R&&ja[K]&&(T.fd=ja[K].fd);T.De=W.mj;F(T,y);T.Bi=
k.uuid;"JITTERED"==k.b4w_hair_billboard_type&&(T.$t=k.b4w_hair_billboard_jitter_amp,T.au=k.b4w_hair_billboard_jitter_freq);p&&(T.Et=k.b4w_dynamic_grass_scale_threshold);u||(delete T.Ib.a_bending_col_main,delete T.Ib.a_bending_col_detail);G(T,N);var na=W.$s(Q,K,T.Gj,b.Qh,T.Ib,T.Ah),ia=W.XC(na,oa,C),sa=ia,xb=C;sa.M.au_center_pos=new Float32Array(3*sa.P);for(var Da=xb.length,yb=sa.P/Da,ca=0;ca<Da;ca++)for(var pb=xb[ca],Ga=3*yb*ca,xa=0;xa<yb;xa++)sa.M.au_center_pos[Ga+3*xa]=pb[0],sa.M.au_center_pos[Ga+
3*xa+1]=pb[1],sa.M.au_center_pos[Ga+3*xa+2]=pb[2];ia=sa;if(y.hd&&y.vl){var Fa=ia,La=q.f.aa;Fa.M.a_emitter_center=new Float32Array(3*Fa.P);var Qb=U.fromValues(0,0,0,1);U.transformMat4(Qb,La,Qb);for(var Ua=0;Ua<Fa.P;Ua++)Fa.M.a_emitter_center[3*Ua]=Qb[0],Fa.M.a_emitter_center[3*Ua+1]=Qb[1],Fa.M.a_emitter_center[3*Ua+2]=Qb[2];ia=Fa}var lb=k.b4w_vcol_from_name,Fb=k.b4w_vcol_to_name,Cb=T,uc=c,sc=!u,hc=Q,Ta=[];if(""!==lb&&""!==Fb){var jb,ic=Fb,Jc=Cb.Ib,Rb=[],ub=void 0;for(ub in Jc)for(var zb=Jc[ub].src,
Qa=0,fb=0;fb<zb.length;fb++){var Vb=zb[fb].vd;ic==zb[fb].name&&Rb.push(ub,Vb,Qa);Qa+=ea.qh(Vb)}jb=Rb;if(0<jb.length)for(var Lb=0;Lb<jb.length;Lb+=3)Ta.push({Vj:lb,Xl:7,Em:jb[Lb],Fm:jb[Lb+1],Ul:jb[Lb+2]});else W.bC(Cb.Gj,"a_color")&&Fb==hc.active_vcol_name&&Ta.push({Vj:lb,Xl:7,Em:"a_color",Fm:7,Ul:0})}sc&&("a_bending_col_main"in uc&&Ta.push({Vj:"a_bending_col_main",Xl:4,Em:"a_bending_col_main",Fm:4,Ul:0}),"a_bending_col_detail"in uc&&Ta.push({Vj:"a_bending_col_detail",Xl:7,Em:"a_bending_col_detail",
Fm:7,Ul:0}));for(var Wb=ia,Db=C,jc=d,mb=Ta,Xb=T.Ib,Pa=!1,gb=0;gb<mb.length;gb++){var ab=mb[gb].Vj,Va=jc.M[ab];if(Va&&0<Va.length){Pa=!0;break}}if(Pa){var Za,bb=q.f.Qb,nb=jc.A[0].a_position,Eb=Db,Ca=ba,cb=new Float32Array(3),db=new Float32Array(3),Sb=new Uint32Array(Eb.length);if(!("verts_indices"in Ca)){Ca.xe=new Float32Array(3);Ca.te=new Float32Array(3);Ca.ir=new Uint32Array(nb.length/3);Ca.uk=new Uint32Array(nb.length/3);Ca.xe[0]=(bb.max_x-bb.min_x)/20;Ca.xe[1]=(bb.max_y-bb.min_y)/20;Ca.xe[2]=(bb.max_z-
bb.min_z)/20;Ca.te[0]=bb.min_x;Ca.te[1]=bb.min_y;Ca.te[2]=bb.min_z;for(var Ha=0;Ha<nb.length/3;Ha++){var kc=ea.trunc((nb[3*Ha]-Ca.te[0])/Ca.xe[0]),lc=ea.trunc((nb[3*Ha+1]-Ca.te[1])/Ca.xe[1]),Hb=ea.trunc((nb[3*Ha+2]-Ca.te[2])/Ca.xe[2]),kc=ea.clamp(kc,0,19),lc=ea.clamp(lc,0,19),Hb=ea.clamp(Hb,0,19);Ca.ir[Ha]=Ha;Ca.uk[Ha]=Hb*Math.pow(20,2)+20*lc+kc}W.Dv(Ca.uk,Ca.ir,W.yn,!0);Ca.Dh=new Uint32Array(Math.pow(20,3));for(Ha=0;Ha<Ca.uk.length;Ha++)Ca.Dh[Ca.uk[Ha]]++;delete Ca.uk;for(Ha=1;Ha<Ca.Dh.length;Ha++)Ca.Dh[Ha]+=
Ca.Dh[Ha-1]}for(var Ib=0;Ib<Eb.length;Ib++){cb[0]=Eb[Ib][0];cb[1]=Eb[Ib][1];cb[2]=Eb[Ib][2];for(var hb=1E10,Ab=-1,dc=ea.trunc((cb[0]-Ca.te[0])/Ca.xe[0]),ib=ea.trunc((cb[1]-Ca.te[1])/Ca.xe[1]),Ea=ea.trunc((cb[2]-Ca.te[2])/Ca.xe[2]),dc=ea.clamp(dc,0,19),ib=ea.clamp(ib,0,19),Ea=ea.clamp(Ea,0,19),qb=Ea*Math.pow(20,2)+20*ib+dc,vc=Ca.Dh[qb],ob=0==qb?0:Ca.Dh[qb-1];ob<vc;ob++){var Tb=Ca.ir[ob];db[0]=nb[3*Tb];db[1]=nb[3*Tb+1];db[2]=nb[3*Tb+2];Y.sub(db,cb,db);var Jb=Y.sqrLen(db);Jb<=hb&&(hb=Jb,Ab=Tb)}if(-1==
Ab)for(ob=0;ob<nb.length/3;ob++)db[0]=nb[3*ob],db[1]=nb[3*ob+1],db[2]=nb[3*ob+2],Y.sub(db,cb,db),Jb=Y.sqrLen(db),Jb<=hb&&(hb=Jb,Ab=ob);Sb[Ib]=Ab}Za=Sb;for(var Kb=Wb.P/Db.length,gb=0;gb<mb.length;gb++){var vb=mb[gb].Em,Na=mb[gb].Fm,ab=mb[gb].Vj,ec=mb[gb].Xl,Va=jc.M[ab];switch(vb){case "a_bending_col_main":var Mb=1;break;case "a_bending_col_detail":Mb=3;break;case "a_color":Mb=3;break;default:for(var wb=Mb=0;wb<Xb[vb].src.length;wb++)Mb+=ea.qh(Xb[vb].src[wb].vd)}if(Va&&0<Va.length){var Yb=ea.qh(ec),
mc=ea.qh(Na),wc=ec&Na,nc=ea.dv(wc);wc!=Na&&aa.error("Wrong color extraction from "+ab+" to "+vb+".");if("a_bending_col_main"==vb||"a_bending_col_detail"==vb)Wb.M[vb]=new Float32Array(Wb.P*mc);for(wb=0;wb<Db.length;wb++){var oc=Za[wb],Fc=oc*Yb,Kc=wb*Kb*Mb;if(-1!=oc)for(var Zb=0;Zb<Kb;Zb++)for(var Ja=Zb*Mb,Ma=0;Ma<nc.length;Ma++)nc[Ma]&&(Wb.M[vb][Kc+Ja+(mb[gb].Ul+ea.Gk(Na,Ma))]=Va[Fc+ea.Gk(ec,Ma)])}}else Wb.M[vb]=new Float32Array(0)}}ia=Wb;t.push({B:T,cd:ia,yc:[ha.name],f:y,Ld:[a]})}}}return t}function M(a,
b){var c=!0;"NODES_GLOW"==a.type&&(c=ia.ss(b));return c=c&&d(a,b)}function G(a,b){for(var c=null,d=null,e=0;e<a.T.length;e++){var f=a.T[e].ve;f&&(c||(c={}),c[e]=f,a.T[e].ve=null);if(f=a.T[e].L)d||(d={}),d[e]=f,a.T[e].L=null}a.id=0;a.VD=b;a.id=ea.ks(a,b);if(c)for(var g in c)a.T[g].ve=c[g];if(d)for(g in d)a.T[g].L=d[g]}function E(a){var b=a.ld;a.ld=null;var c=ea.ks(a,0);a.ld=b;return c}function r(a,b,c,d,f){var g=e("WIREFRAME");K(g,"wireframe.glslv","wireframe.glslf");g.wireframe_mode=0;g.Eg=!0;g.da=
!0;g.Bi=c;f&&(g.Ns=!0);F(g,b);b=E(b);G(g,b);d?(d=ga.Uo(1,a.F),W.gv(d,[a.Td[0],a.Ud[1],a.Vd[2]],a.F)):d=ga.Uo(a.Ua,a.F);W.$m(d,1,!0);d.M.a_polyindex=W.Mo(d);J(g,d);return g}function K(a,b,c){a.ib.hj=b;a.ib.$h=c;P.pE(a.ib)}function z(a,b,c){1==a.T.length&&0==a.Vb.length&&a.Vb.push("default0");c=c||"default"+String(a.T.length);-1==a.Vb.indexOf(c)&&(a.T.push(b),a.Vb.push(c));a.Ub&&S.Vr(a)}function H(a){if(!a.ib)throw"No shaders info for batch "+a.name;a.Ub=P.CB(a.ib);S.Oy(a.Ub);S.Tr(a);S.Vr(a)}function V(a,
b,c){a=a.V[0].S;for(var d=0;d<a.length;d++)if(a[d].type==c&&!a[d].Mg&&-1!=a[d].Sc.indexOf(b))return a[d];return null}function ba(a,b,c){a=a.V[0].S;for(var d=0;d<a.length;d++)if(a[d].type==c&&a[d].Mg&&-1!=a[d].Sc.indexOf(b))return a[d];return null}function X(a,b){a.vc.set(b.vc);a.sf=b.sf;a.he.set(b.he);a.th=b.th;a.Fc.set(b.Fc);a.Ee=b.Ee;a.se=b.se;a.rf=b.rf;a.hf=b.hf;a.reflect_factor=b.reflect_factor;a.Hd.set(b.Hd);a.parallax_scale=b.parallax_scale;a.shallow_water_col.set(b.shallow_water_col);a.shallow_water_col_fac=
b.shallow_water_col_fac;a.shore_water_col.set(b.shore_water_col);a.shore_water_col_fac=b.shore_water_col_fac;a.foam_factor=b.foam_factor;a.kj=b.kj}var fa=p("__boundings"),Q=p("__camera"),ha=p("__config"),aa=p("__print"),R=p("__extensions"),W=p("__geometry"),na=p("__graph"),ia=p("__nodemat"),da=p("__obj_util"),ja=p("__particles"),ga=p("__primitives"),L=p("__quat"),O=p("__reformer"),S=p("__renderer"),ua=p("__scenegraph"),P=p("__shaders"),oa=p("__textures"),la=p("__tsr"),ea=p("__util"),Y=p("__vec3"),
U=p("__vec4"),ya=ha.q,N=["MAIN"],qa=new Float32Array([0,-Math.sqrt(.5),0,Math.sqrt(.5)]),sa=new Float32Array(4);a.IG=T;var T="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" ");a.yI=e;a.qB=function(a,c,d,e){for(var g=[],h=[],k=0;k<c.length;k++){var n=c[k],l=n.fa;l.mk||(da.sa(l)?g.push(n):h.push(n))}for(var k=[],k=k.concat(m(g,a.j.nb)),l=k=k.concat(f(h,a.j.nb,a.b4w_batch_grid_size)),g=[],h=[],q={},k=0;k<l.length;k++){var t=l[k].B,p=l[k].f,L=null;if(t.id in q){for(var x=
q[t.id],v=h[x].B,S=h[x].f,H=null,O=null,n=0;n<t.T.length;n++){var z=t.T[n].ve;z&&(H||(H={}),H[n]=z,t.T[n].ve=null);if(z=t.T[n].L)O||(O={}),O[n]=z,t.T[n].L=null}ea.Nv(t,v)&&ea.Nv(p,S)&&(L=h[x]);if(H)for(n in H)t.T[n].ve=H[n];if(O)for(n in O)t.T[n].L=O[n];if(!L){do t.id++;while(q[t.id])}}L||(L={B:t,f:l[k].f,Ld:[],Iq:[],yc:[]},q[t.id]=h.length,h.push(L));L.Ld=L.Ld.concat(l[k].Ld);l[k].cd&&l[k].cd.P&&L.Iq.push(l[k].cd);if(L.yc.length)for(n=0;n<l[k].yc.length;n++)t=l[k].yc[n],-1==L.yc.indexOf(t)&&L.yc.push(t);
else L.yc=l[k].yc;W.Dv(L.yc,L.Iq,W.Yx,!1)}for(k=0;k<h.length;k++){l=h[k].Iq;if(0==l.length)n=ea.Eb(ea.cj("%empty"));else if(1==l.length)n=l[0];else{q=[];for(n=0;n<l.length;n++)W.rC(l[n])||q.push(n);if(q.length<l.length)for(n=0;n<q.length;n++)W.$m(l[q[n]]);n=W.gF(l)}g.push({B:h[k].B,f:h[k].f,cd:n,yc:h[k].yc,Ld:h[k].Ld})}for(h=0;h<g.length;h++)if(l=g[h].B,l.Sc=g[h].yc,J(l,g[h].cd),u(l,d,a),"STATIC"==g[h].f.type&&"COLOR_ID"!=l.type)k=ea.cj("%meta%"+l.type+"%"+l.Sc.join("%")+"%"),k=da.Jj(k,"MESH"),k.f=
g[h].f,da.pl(k,a),da.ol(k,a,l),e.push(k);else for(q=[],n=0;n<g[h].Ld.length;n++)k=g[h].Ld[n].fa,-1==q.indexOf(k.name)&&(da.ol(k,a,l),q.push(k.name));if(ya.wireframe_debug){for(h=0;h<g.length;h++)if(d=g[h].f,"DYNAMIC"==d.type&&(k=g[h].Ld[0].fa,-1<N.indexOf(g[h].B.type))){n=da.Oa(k,a);l=n.S;q=!1;for(n=0;n<l.length;n++)l[n].Eg&&(q=!0);q||(d=r(d.kf,d,k.name,!0,!0),da.ol(k,a,d))}for(h=0;h<e.length;h++)k=e[h],d=k.f,n=da.Oa(k,a),l=n.S,-1<N.indexOf(l[0].type)&&(d=r(d.nd,d,k.name,!1),da.ol(k,a,d))}for(h=0;h<
c.length;h++)for(n=da.Oa(c[h].fa,a),l=n.S,n=0;n<l.length;n++)b(l[n]);for(h=0;h<e.length;h++)for(n=da.Oa(e[h],a),l=n.S,n=0;n<l.length;n++)b(l[n])};a.sB=function(a,c){var d=a.j.or,f=e("MAIN");K(f,"special_skydome.glslv","special_skydome.glslf");if(c.procedural_skydome)w(f,"PROCEDURAL_SKYDOME",1),f.Qu=!0;else{var g=d.yq;if(g){w(f,"WO_SKYTEX",1);var h=n(d.Av,null);z(f,h,"u_sky");g.invert&&w(f,"MTEX_NEGATIVE",1);g.lG&&w(f,"MTEX_RGBTOINT",1);w(f,"BLENDTYPE",g.Vy);g.hG&&w(f,"WOMAP_BLEND",1);g.iG&&w(f,"WOMAP_HORIZ",
1);g.kG&&w(f,"WOMAP_ZENUP",1);g.jG&&w(f,"WOMAP_ZENDOWN",1)}d.mG&&w(f,"WO_SKYBLEND",1);d.nG&&w(f,"WO_SKYPAPER",1);d.oG&&w(f,"WO_SKYREAL",1)}c.nc&&(f.nc=!0,c.bc&&(f.bc=!0));f.fh=99999;D(f,"a_position");d=ga.oB();J(f,d);b(f);d=ea.cj("%meta_sky%");d=da.Jj(d,"MESH");da.pl(d,a);g=da.Oa(d,a);d.f=da.Sh("STATIC");d.f.Uh=!0;d.f.Qb=fa.Ad();d.f.nd=fa.al();d.f.sb=fa.Ad();d.f.Rb=fa.al();g.S.push(f);return d};a.Is=function(a,b,d){d=da.Oa(a,d).S;var e=[],f=ua.Ya(b,"SHADOW_CAST"),g=ua.Ya(b,"MAIN_PLANE_REFLECT"),h=
ua.Ya(b,"MAIN_CUBE_REFLECT"),k=ua.Ya(b,"OUTLINE_MASK");b=ua.Ya(b,"COLOR_PICKING");for(var n=0;n<d.length;n++){var l=d[n],m=null;"DEPTH"==l.type&&f&&l.ad&&(m=c(l),m.$a="SHADOW_CAST");"MAIN"!=l.type&&"PARTICLES"!=l.type||!g&&!h||l.Ra||!l.nc||(m=c(l),m.$a="REFLECT");"COLOR_ID"==l.type&&l.ao&&k&&a.f.Ab&&(b&&a.f.Ve?(m=c(l),m.$a="OUTLINE"):l.$a="OUTLINE");m&&(m.Mg=!0,G(m,a.f.id),e.push(m))}d.push.apply(d,e)};a.xE=h;a.CG=function(a,b,c){if(b)b=c*(b.max_y-b.min_y);else throw"No bounding box for mesh";return 0==
b?0:.5*(Math.sqrt(2*Math.sqrt(4*b*Math.tan(a/180*Math.PI)+1)+2)/2-1)/b};a.Ry=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.zB=n;a.CF=v;a.BF=u;a.tE=q;a.Ur=function(a,b,c){c&&c.k.type==Q.Xb&&w(a,"PERSPECTIVE_SHADOW_CAST",1);w(a,"CSM_SECTION0",0);w(a,"CSM_SECTION1",0);w(a,"CSM_SECTION2",0);w(a,"CSM_SECTION3",0);if(b){for(c=0;c<b.csm_num;c++)w(a,"CSM_SECTION"+String(c),1);w(a,"SHADOW_TEX_RES",P.r(b.csm_resolution));w(a,"CSM_FADE_LAST_CASCADE",
b.fade_last_cascade?1:0);w(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else w(a,"SHADOW_TEX_RES",0),w(a,"CSM_FADE_LAST_CASCADE",0),w(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.oa=w;a.Mb=function(a,b){return P.GB(a.ib,b)};a.zF=J;a.AF=G;a.ez=E;a.GH=r;a.Nh=z;a.$D=function(a,b,c){c=a.Vb.indexOf(c);-1<c&&(a.T[c]=b)};a.fA=function(a,b){var c=e("MAIN");c.Ra=!0;U.set(b[0],b[1],b[2],.5,c.vc);c.De=W.fl;J(c,a);K(c,"main_stack.glslv","main_stack.glslf");w(c,"SHADELESS",1);H(c);return c};a.Bb=H;a.mz=
function(a){return a.Ub.Ak.length?a.Ub.Yp.u_cube_fog?!0:!1:!1};a.Qz=function(){var a=e("DEPTH_PACK");a.bb=!0;a.da=!1;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");H(a);return a};a.Ml=function(a){var b=e("POSTPROCESSING");K(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":w(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":w(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":w(b,
"POST_EFFECT","POST_EFFECT_X_BLUR");break;case "Y_BLUR":w(b,"POST_EFFECT","POST_EFFECT_Y_BLUR");break;case "X_GLOW_BLUR":w(b,"POST_EFFECT","POST_EFFECT_X_GLOW_BLUR");break;case "Y_GLOW_BLUR":w(b,"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR");break;case "X_EXTEND":w(b,"POST_EFFECT","POST_EFFECT_X_EXTEND");break;case "Y_EXTEND":w(b,"POST_EFFECT","POST_EFFECT_Y_EXTEND");break;case "FLIP_CUBEMAP_COORDS":w(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:throw"Wrong postprocessing effect: "+a;}b.bb=!0;b.da=
!1;a=ga.Fb();J(b,a);H(b);return b};a.iA=function(a){var b=e("SSAO");b.da=!1;b.bb=!0;var c=ga.Fb();J(b,c);K(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");w(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.Iv);w(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={texture:oa.tB(a)};c={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,
25,203,0,117,73,12,0])};a=n(a,c);z(b,a,"u_ssao_special_tex");H(b);return b};a.jA=function(a){var b=e("SSAO_BLUR");b.da=!1;b.bb=!0;var c=ga.Fb();J(b,c);K(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");w(b,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);H(b);return b};a.Rz=function(){var a=e("DOF");a.da=!1;a.bb=!0;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");w(a,"DEPTH_RGBA",1);H(a);return a};a.$z=function(){var a=e("OUTLINE");a.da=!1;
a.bb=!0;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");H(a);return a};a.Tz=function(){var a=e("GLOW_COMBINE");a.da=!1;a.bb=!0;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");H(a);return a};a.Uz=function(a,b,c){var d=e("GOD_RAYS");d.da=!1;d.bb=!0;var f=ga.jB();J(d,f);K(d,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");w(d,"DEPTH_RGBA",a?1:0);w(d,"WATER_EFFECTS",b?1:0);w(d,"STEPS_PER_PASS",P.r(c,
1));H(d);return d};a.Vz=function(){var a=e("GOD_RAYS_COM");a.da=!1;a.bb=!0;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");w(a,"SAFARI_CANVAS_ALPHA_HACK",ya.fv?1:0);H(a);return a};a.aA=function(){var a=e("SKY");a.da=!1;a.bb=!0;var b=ga.kB();J(a,b);K(a,"procedural_skydome.glslv","procedural_skydome.glslf");w(a,"WATER_EFFECTS",1);H(a);return a};a.Kz=function(a){var b=e("ANTIALIASING");b.da=!1;b.bb=!0;var c=ga.Fb();J(b,c);K(b,"postprocessing/postprocessing.glslv",
"postprocessing/antialiasing.glslf");ya.Tu?(w(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),w(b,"AA_QUALITY",a.hB)):w(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");H(b);return b};a.gA=function(a){var b=e("SMAA"),c=ga.Fb();J(b,c);K(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");w(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");w(b,"SMAA_PASS",a);w(b,"SMAA_PREDICATION",0);w(b,"SMAA_REPROJECTION",0);H(b);b.da=!1;b.bb=!0;return b};a.Oz=function(){var a=e("COMPOSITING");a.da=!1;a.bb=!0;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv",
"postprocessing/compositing.glslf");H(a);return a};a.Zz=function(){var a=e("MOTION_BLUR");a.bb=!0;a.da=!1;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");H(a);return a};a.Iz=function(){var a=e("ANAGLYPH");a.bb=!0;a.da=!1;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/anaglyph.glslf");H(a);return a};a.Wz=function(){var a=e("LUMINANCE");a.da=!1;a.bb=!0;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");
H(a);return a};a.Lz=function(){var a=e("LUMINANCE");a.da=!1;a.bb=!0;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");H(a);return a};a.Xz=function(){var a=e("LUMINANCE_X_BLUR");a.da=!1;a.bb=!0;var b=ga.Fb();J(a,b);K(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");H(a);return a};a.Mz=function(){var a=e("POSTPROCESSING");a.bb=!0;a.da=!1;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");
H(a);return a};a.Nz=function(){var a=e("BLOOM");a.da=!1;a.bb=!0;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");H(a);return a};a.mA=function(){var a=e("VELOCITY");a.da=!1;a.bb=!0;var b=ga.Fb();J(a,b);K(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");H(a);return a};a.Jz=function(){var a=e("ANCHOR_VISIBILITY");a.da=!0;a.bb=!0;a.De=W.vr;K(a,"anchors.glslv","anchors.glslf");var b=ga.lt(1);J(a,b);w(a,"ANCHOR_NUM",1);H(a);a.Hi=
new Float32Array([0,0,0]);return a};a.yF=function(a,b){var c=b.length/3;if(c!=a.Hi.length/3){var d=ga.lt(c);J(a,d);w(a,"ANCHOR_NUM",c);H(a)}a.Hi=b};a.ya=V;a.Qc=ba;a.cJ=X;a.yH=function(a,b){for(var c=a.V[0].S,d=0;d<c.length;d++)if(c[d].type==b)return!0;return!1};a.Dz=function(a){for(var b=a.T,c=0;c<b.length;c++)oa.BA(b[c].Qa);W.ws(a.N)};a.inherit_material=function(a,b,c,d){for(var e=["MAIN","DEPTH","COLOR_ID"],f=!1,g=0;g<e.length;g++){var h=e[g],k=V(a,b,h),n=V(c,d,h);if(k&&n){var f=!0,l=ba(c,d,h);
"MAIN"==h&&(X(n,k),l&&X(l,k));for(h=0;h<n.Vb.length;h++){var m=n.Vb[h];if(-1!==T.indexOf(m)){var r=k.Vb.indexOf(m);-1!==r&&(n.T[h]=k.T[r],l&&(m=l.Vb.indexOf(m),-1!==m&&(l.T[m]=k.T[r])))}}}}f||aa.error("Wrong objects for inheriting material!")}};b4w.module.__nodemat=function(a,p){function e(a,c,d,m,r){var q=ya.get_active(),q=f(c,r,q.uuid);if(q in T)return T[q];if("DEPTH"!=r&&"COLOR_ID"!=r){var p=P.create(),u=a.nodes,L=a.links;c=a.animation_data;for(var v=0;v<u.length;v++)if(null==C(p,u[v],0,c,m,r))return T[q]=null;if(d&&-1==w(a,p,"GROUP_OUTPUT","group"))return null;v=ia(p);if(!da(p,L,v))return null;if(d)return p;for(v=0;v<L.length;v++){d=L[v];for(var u=n(d.from_node,p),S=n(d.to_node,p),H=0;H<u.length;H++)for(var O=0;O<S.length;O++){var z=
u[H],y=S[O],E=P.Ja(p,z),F=P.Ja(p,y);if(!W(p,z,y,E,F,d))return T[q]=null}}k(p);a="GLOW"==r?w(a,p,"B4W_GLOW_OUTPUT","material",!0):w(a,p,"OUTPUT","material",!1,!0);-1==a&&(p=h(),a=0);x(p);a=P.Hq(p,a,P.tn);b(a,c,m);t(a);A(a);D(a);g(a,c,m,r)}else m=e(a,c,d,m,"MAIN"),m=P.clone(m,function(a){var b=N.Aj(a);b.C=N.qa(a.C);b.la=N.qa(a.la);return b}),a=w(a,m,"OUTPUT","material",!1,!0),l(m,a),a=P.Hq(m,a,P.tn),t(a);return T[q]=a}function b(a,b,d){var e=[];P.W(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=
b.type||e.push({pD:a,node:b})});for(var f=0;f<e.length;++f){var g=e[f].pD,h=e[f].node,k=P.dk(a);P.Mh(a,k,h.data.$C);var n=P.dk(a);P.Mh(a,n,h.data.aD);P.Zb(a,k,n,[4,2]);for(var l={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},m=P.lp(a,g),r=[],q=[],t=[],p={},u=0;u<m;u++){var L=P.fk(a,g,u);L in p||(p[L]=0);var x=P.Je(a,L,g,p[L]++);r.push([L,g,x]);var v=l[x[1]];if(v)switch(v[0]){case "MATERIAL_END":q.push([L,n,[x[0],v[1]]]);break;case "LIGHTING_APPLY":t.push([L,
[x[0],v[1]]])}else q.push([L,k,x])}c(a,h.data.value,k,n,t,b,d);for(u=0;u<r.length;u++)P.Pm(a,r[u][0],r[u][1],r[u][2]);for(u=0;u<q.length;u++)P.Zb(a,q[u][0],q[u][1],q[u][2]);h=P.Hf(a,g);k=[];l=[];m={};for(u=0;u<h;u++)r=P.wf(a,g,u),r in m||(m[r]=0),x=P.Je(a,g,r,m[r]++),k.push([g,r,x]),l.push([n,r,x]);for(u=0;u<k.length;u++)P.Pm(a,k[u][0],k[u][1],k[u][2]);for(u=0;u<l.length;u++)P.Zb(a,l[u][0],l[u][1],l[u][2]);P.Qf(a,g)}}function c(a,b,c,d,e,f,g){var h={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},
k=C(a,h,0,f,g,null),n=k;m(a,c,k,"E");m(a,c,k,"A");m(a,c,k,"D");k=ya.get_active();k=ea.Aa(k,"LAMP",ea.DATA_ID_ALL);if(!b.fd)for(var l,r,q=0;q<k.length;q++){var t=k[q].Fa,h={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};l=C(a,h,0,f,g,null);h={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};r=C(a,h,0,f,g,null);m(a,n,r,"color");m(a,n,r,"specular");m(a,l,r,"ldir");m(a,c,r,"normal");m(a,c,r,"D");m(a,c,r,"S");m(a,l,r,"lcolorint");m(a,c,l,"shadow_factor");n="COOKTORR"==b.Qi?"SPECULAR_PHONG":"SPECULAR_"+b.Qi;h=
{name:n,type:n};h=C(a,h,0,f,g,null);m(a,l,h,"ldir");m(a,l,h,"lfac");m(a,c,h,"normal");m(a,h,r,"sfactor");"SPECULAR_PHONG"!=n&&"SPECULAR_BLINN"!=n||m(a,l,h,"norm_fac");m(a,c,h,"sp_params");n="HEMI"==t.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.Pj;h={name:n,type:n};h=C(a,h,0,f,g,null);m(a,l,h,"ldir");m(a,l,h,"lfac");m(a,c,h,"normal");m(a,l,h,"norm_fac");m(a,h,r,"lfactor");"DIFFUSE_LAMBERT"!=n&&m(a,c,h,"dif_params");for(l=0;l<e.length;l++)P.Zb(a,e[l][0],r,e[l][1]);n=r}m(a,n,d,"color");m(a,n,d,"specular")}function m(a,
b,c,d){for(var e=P.Ja(a,b),f=P.Ja(a,c),g,h=0;h<f.C.length;h++)if(d==f.C[h].identifier){g=h;break}for(var k,h=0;h<e.la.length;h++)if(d==e.la[h].identifier){k=h;break}void 0!=g&&void 0!=k&&P.Zb(a,b,c,[k,g])}function f(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "DEPTH":return a+c+"00";default:return a+c+"10"}}function l(a,b){P.ne(a,function(c,d,e){var f=P.Ja(a,d);d==b&&"Color"==f.C[e[1]].identifier&&P.Pm(a,c,d,e)})}function h(){var a=P.create(),b={data:null,qd:[],K:[],C:[{Da:new Float32Array([0,
0,0]),identifier:"Color",Gb:!1,name:"Color"},{Da:1,identifier:"Alpha",Gb:!1,name:"Alpha"}],la:[],type:"OUTPUT",eg:[]};P.Mh(a,0,b);return a}function t(a){P.W(a,function(b,c){for(var e=c.C,f=c.la,g=0;g<e.length;g++)d(a,e[g],b,g,1);for(g=0;g<f.length;g++)d(a,f[g],b,g,0)})}function d(a,b,c,d,e){if(b.Gb){var f=!0;P.ne(a,function(a,b,g){if(!e&&a==c&&g[0]==d||e&&b==c&&g[1]==d)f=!1});f&&(b.Gb=!1)}}function g(a,b,c,d){var e=[];P.ne(a,function(f,g,h){var k=P.Ja(a,f),n=P.Ja(a,g),k=N.is_vector(k.la[h[0]].Da),
n=N.is_vector(n.C[h[1]].Da);if(k!=n){var l,m={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},r={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};k&&!n?l=J("vector_to_scalar","B4W_VECTOSCAL",[m],[r]):!k&&n&&(l=J("scalar_to_vector","B4W_SCALTOVEC",[r],[m]));C(a,l,0,b,c,d);e.push([f,g,a.J[a.J.length-2],h])}});for(var f=0;f<e.length;++f)P.Pm(a,e[f][0],e[f][1],e[f][3]),P.Zb(a,e[f][0],e[f][2],[e[f][3][0],0]),P.Zb(a,e[f][2],e[f][1],[0,e[f][3][1]])}function k(a){var b=
[];P.W(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":P.ne(a,function(a,e,f){a==c&&"Translucency"==d.la[f[0]].name&&b.push(a,e,[f[0]+1,f[1]+1])})}});for(var c=0;c<b.length;c+=3)P.Zb(a,b[c],b[c+1],b[c+2])}function n(a,b){var c=[];P.W(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;throw"Node not found";}function x(a){var b=[];P.W(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],e=b[c+1];if("B4W_PARALLAX"==e.type){var f=
I(a,d);if(-1!=f){var g=P.fk(a,f,0);P.ph(a,f,d,-1);-1!=g&&P.ph(a,g,f,-1);d=P.Ja(a,f);e.data=d.data;e.K[0]=d.K[0];P.Qf(a,f)}e.C.splice(1,1)}else if("REROUTE"==e.type){for(var e=P.fk(a,d,0),h=P.Hf(a,d),f=[],g=[],k=[],n=0;n<h;n++){var l=P.wf(a,d,n),m=g.indexOf(l);-1!=m?k[m]+=1:(g.push(l),k.push(1),f.push(d,l))}if(-1!=e)for(h=P.Je(a,e,d,0)[0],n=0;n<g.length;n++)for(l=0;l<k[n];l++)m=P.Je(a,d,g[n],l)[1],P.Zb(a,e,g[n],[h,m]);for(n=0;n<f.length;n+=2)P.ph(a,f[n],f[n+1],-1)}}}function I(a,b){for(var c=a.Y,d=
0;d<c.length;d+=3)if(c[d+1]==b&&1==c[d+2][1])return c[d];return-1}function A(a){y(a);F(a);B(a)}function B(a){var b=[],c="",d="",e={};P.W(a,function(a,f){if("GEOMETRY_UV"==f.type||"UVMAP"==f.type||"TEX_COORD_UV"==f.type){b.push(a,f);var g=f.data.value;c?c==g||d||(d=g,e[d]=0):(c=g,e[c]=0);e[g]++}});for(var f in e)if(2>e[f]){for(var g=0;g<b.length;g+=2)b[g+1].data.value==f&&b.splice(g,2);delete e[f];c==f&&(c=d,d="");d==f&&(d="")}if(!(3>b.length)){var g={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,
name:"UV_geom"},h={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};f=J("merged_uv","UV_MERGED",[],[g,h]);f.uv_layer=c;C(a,f,0,null,"",void 0);var k=a.J[a.J.length-2];f=a.J[a.J.length-1];if(d){h=J("merged_uv","UV_MERGED",[],[g,h]);h.uv_layer=d;C(a,h,0,null,"",void 0);var n=a.J[a.J.length-2],h=a.J[a.J.length-1]}else h=null;for(var l=-1,m=null,g=0;g<b.length;g+=2){var r=b[g],t=b[g+1];q(t,b[1])?(l=k,m=f):h&&(l=n,m=h);for(var p=[],u=P.Hf(a,r),L={},x=0;x<u;x++){var v=P.wf(a,
r,x);v in L||(L[v]=0);var S=P.Je(a,r,v,L[v]++);p.push(r,v,S);S=S.splice(0,S.length);switch(t.type){case "GEOMETRY_UV":S[0]=0;m.la[0].Gb=!0;break;case "UVMAP":case "TEX_COORD_UV":S[0]=1,m.la[1].Gb=!0}P.Zb(a,l,v,S)}for(var x=0;x<p.length;x+=3)P.ph(a,p[x],p[x+1],0);P.Qf(a,r)}}}function y(a){var b=[];P.W(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type||b.push(a,c)});for(var c=
[],d=0;d<b.length;d+=2){for(var e=b[d],f=b[d+1],g=!0,h=0;h<c.length;h++){var k=c[h];if(u(f,k.Lc)){g=[];h=P.Hf(a,e);for(m=0;m<h;m++){var n=P.wf(a,e,m),l=P.Je(a,e,n,0);g.push(e,n,l);P.Zb(a,k.id,n,l)}for(var m=0;m<g.length;m+=3)P.ph(a,g[m],g[m+1],0);P.Qf(a,e);g=!1;break}}g&&(k={id:e,Lc:f},c.push(k))}}function v(a){for(var b={},c=0;c<a.J.length;c+=2)b[a.J[c]]=[];for(c=0;c<a.Y.length;c+=3){for(var d=a.Y[c],e=a.Y[c+1],f=b[e],g=d,h=0;h<=f.length;h++){if(h>=f.length||f[h]>g)f.splice(h,0,g);else if(f[h]!=
g)continue;break}for(var e=b[e],d=b[d],g=f=0,h=e.length+d.length,k=[],n=0;n<h;n++)f>e.length||e[f]>d[g]?k.push(d[g++]):k.push(e[f++])}return b}function F(a){var b=[];P.W(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=v(a),d=[],e=0;e<b.length;e+=2){for(var f=b[e],g=b[e+1],h=!0,k=0;k<d.length;k++){var n=d[k];if(!(3<=n.ui.length||!u(g,n.Lc)||-1<c[f].indexOf(n.id)||-1<c[n.id].indexOf(f))){for(var l=!1,m=0;m<n.ui.length;m++){var r=n.ui[m].id;if(-1<
c[f].indexOf(r)||-1<c[r].indexOf(f)){l=!0;break}}if(!l){for(var k=[],r=P.lp(a,f),q={},m=0;m<r;m++)l=P.fk(a,f,m),l in q||(q[l]=0),h=P.Je(a,l,f,q[l]++),k.push(l,f,h);for(var r=[],q=P.Hf(a,f),t={},m=0;m<q;m++)l=P.wf(a,f,m),l in t||(t[l]=0),h=P.Je(a,f,l,t[l]++),r.push(f,l,h);h=k.concat(r);for(m=0;m<h.length;m+=3)P.ph(a,h[m],h[m+1],0);P.Qf(a,f);m={id:f,Lc:g,KA:k,LA:r};n.ui.push(m);h=!1;break}}}h&&(n={id:f,Lc:g,ui:[]},d.push(n))}for(e=0;e<d.length;e++){n=d[e];c=n.ui.length;for(k=0;k<c;k++){g=n.ui[k];m=
g.Lc;f=g.KA;g=g.LA;n.Lc.C[k+1].Gb=m.C[0].Gb;n.Lc.C[k+1].Da=m.C[0].Da;n.Lc.la[2*(k+1)].Gb=m.la[0].Gb;n.Lc.la[2*(k+1)].Da=m.la[0].Da;n.Lc.la[2*(k+1)+1].Gb=m.la[1].Gb;n.Lc.la[2*(k+1)+1].Da=m.la[1].Da;for(m=0;m<f.length;m+=3)l=f[m],h=f[m+2],h[1]+=k+1,P.Zb(a,l,n.id,h);for(m=0;m<g.length;m+=3)l=g[m+1],h=g[m+2],h[0]+=2*(k+1),P.Zb(a,n.id,l,h);n.Lc.qd.push(["USE_uv"+(k+2),1])}P.Qf(a,n.id);P.Mh(a,n.id,n.Lc)}}}function u(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==
b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":return!0;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value==b.data.value;default:return!1}}function q(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:!1}function D(a){var b=[];P.W(a,function(a,c){"GEOMETRY_VC"==c.type&&b.push(a,c)});for(var c=0;c<b.length;c+=2){for(var d=b[c],e=b[c+
1],f=!1,g=[],h=[],k=[[],[],[]],n=P.Hf(a,d),l=0;l<n;l++){var m=P.wf(a,d,l);if("SEPRGB"!=P.Ja(a,m).type){f=!1;break}g.push(d,m);for(var r={},q=P.Hf(a,m),f=0;f<q;f++){var t=P.wf(a,m,f);t in r||(r[t]=0);var p=P.Je(a,m,t,r[t]++);g.push(m,t);k[p[0]].push(d,t,p)}h.push(m);f=!0}if(f){for(l=d=n=0;l<k.length;l++)k[l].length&&(n++,d|=1<<2-l);if(n){e.type+=n;e.la=[];for(l=0;l<k.length;l++)if(k[l].length)for(e.la.push({Da:0,identifier:"RGB"[l],Gb:!0,name:"RGB"[l]}),f=0;f<k[l].length;f+=3)k[l][f+2][0]=N.Gk(d,l);
for(l=0;l<g.length;l+=2)P.ph(a,g[l],g[l+1],0);for(l=0;l<h.length;l++)P.Qf(a,h[l]);for(l=0;l<k.length;l++)for(f=0;f<k[l].length;f+=3)P.Zb(a,k[l][f],k[l][f+1],k[l][f+2])}}}}function w(a,b,c,d,e,f){a=a.nodes;for(var g=null,h=0;h<a.length;h++){var k=a[h];e?"GROUP"==k.type&&k.node_tree_name==c&&(g=k):k.type==c&&(g=k)}return g?n(g,b)[0]:(f||Y.error('No "'+c+'" node in node '+d),-1)}function J(a,b,c,d){return{name:a,type:b,inputs:c,outputs:d}}function C(a,b,c,d,e,f){var g=b.name,h=b.type,k=[],n=[],l=[],
m=[],q=null,t=[];switch(h){case "BSDF_ANISOTROPIC":case "BSDF_DIFFUSE":case "BSDF_GLOSSY":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "EMISSION":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BUMP":case "NORMAL_MAP":case "VECT_TRANSFORM":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_IMAGE":case "TEX_ENVIRONMENT":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "LAYER_WEIGHT":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "PARTICLE_INFO":case "HAIR_INFO":case "OBJECT_INFO":case "SCRIPT":case "NEW_GEOMETRY":n=
ha(b);l=aa(b);Y.warn(h+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":case "MIX_SHADER":n=ha(b);l=aa(b);break;case "UVMAP":var p=b.uv_layer;p||(h="EMPTY_UV");if("EMPTY_UV"!=h){var q=r("param_"+h+"_a"),u=r("param_"+h+"_v");k.push(R(q));k.push(R(u));m.push(R(u));q={name:q,value:p}}l=aa(b);break;case "UV_MERGED":q=r("param_UV_MERGED_a");u=r("param_UV_MERGED_v");k.push(R(q));k.push(R(u));l.push(X(b,"UV_geom"));l.push(X(b,"UV_cycles"));m.push(R(u));q={name:q,value:b.uv_layer};
break;case "CAMERA":n=[];l=aa(b);break;case "COMBRGB":case "COMBHSV":n=ha(b);l=aa(b);break;case "CURVE_RGB":n=ha(b);l=aa(b);Y.warn("CURVE_RGB node is not fully supported.");break;case "CURVE_VEC":n=ha(b);l=aa(b);Y.warn("CURVE_VEC node is not fully supported.");break;case "GEOMETRY":if(!K(b))return!0;h=z(b,c);if(!h)return Y.error("Geometry output is not supported"),null;switch(h){case "GEOMETRY_UV":(p=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(q=r("param_GEOMETRY_UV_a"),u=r("param_GEOMETRY_UV_v"),
k.push(R(q)),k.push(R(u)),m.push(R(u)),q={name:q,value:p});l.push(X(b,"UV"));break;case "GEOMETRY_VC":(p=b.color_layer)||(h="EMPTY_VC");"EMPTY_VC"!=h&&(q=r("param_GEOMETRY_VC_a"),u=r("param_GEOMETRY_VC_v"),k.push(R(q)),k.push(R(u)),m.push(R(u)),q={name:q,value:p});l.push(X(b,"Vertex Color"));break;case "GEOMETRY_NO":l.push(X(b,"Normal"));break;case "GEOMETRY_FB":l.push(X(b,"Front/Back"));break;case "GEOMETRY_VW":l.push(X(b,"View"));break;case "GEOMETRY_GL":l.push(X(b,"Global"));break;case "GEOMETRY_LO":l.push(X(b,
"Local"));break;case "GEOMETRY_OR":p=r("param_GEOMETRY_OR_v"),k.push(R(p)),l.push(X(b,"Orco")),m.push(R(p))}break;case "TEX_COORD":if(!K(b))return!0;h=H(b,c);if(!h)return Y.error("Texture coordinate output is not supported"),null;switch(h){case "TEX_COORD_UV":(p=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(q=r("param_TEX_COORD_UV_a"),u=r("param_TEX_COORD_UV_v"),k.push(R(q)),k.push(R(u)),m.push(R(u)),q={name:q,value:b.uv_layer});l.push(X(b,"UV"));break;case "TEX_COORD_NO":l.push(X(b,"Normal"));break;
case "TEX_COORD_GE":p=r("param_TEX_COORD_GE_v");k.push(R(p));l.push(X(b,"Generated"));m.push(R(p));break;case "TEX_COORD_OB":l.push(X(b,"Object"));Y.warn('Output "Object" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_CA":l.push(X(b,"Camera"));break;case "TEX_COORD_WI":l.push(X(b,"Window"));Y.warn('Output "Window" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_RE":l.push(X(b,"Reflection")),Y.warn('Output "Reflection" of node "Texture Coordinate" doesn\'t supported fully.')}break;
case "GROUP":p=b.node_tree_name;switch(p){case "B4W_LINEAR_TO_SRGB":if(!M(b,[1],[1])){q=G(b,e,f);break}h="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!M(b,[1],[1])){q=G(b,e,f);break}h="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!M(b,[1],[1])){q=G(b,e,f);break}h="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!M(b,[1,1],[1])){q=G(b,e,f);break}h="B4W_REFLECT";break;case "B4W_REFRACTION":if(!M(b,[1,0],[1])){q=G(b,e,f);break}h="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!M(b,
[1,1,0,0,0],[1])){q=G(b,e,f);break}h="B4W_PARALLAX";u=r("temp_texture");m.push(R(u));break;case "B4W_CLAMP":if(!M(b,[1],[1])){q=G(b,e,f);break}h="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!M(b,[0,0,0,0,0],[0])){q=G(b,e,f);break}h="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!M(b,[],[0])){q=G(b,e,f);break}h="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!M(b,[0,0,0],[0])){q=G(b,e,f);break}h="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":h="B4W_GLOW_OUTPUT";break;default:q=G(b,e,f)}n=ha(b);l=aa(b);"B4W_TRANSLUCENCY"==
p&&(p=Q("TranslucencyParams","TranslucencyParams",[0,0,0,0]),p.Gb=l[0].Gb,l.push(p));break;case "LAMP":q=b.lamp;if(!q)return Y.error("There is no lamp in node: "+b.name),null;l.push(X(b,"Color"));l.push(X(b,"Light Vector"));l.push(X(b,"Distance"));l.push(X(b,"Visibility Factor"));q.uuid in Z?t.push(["LAMP_INDEX",String(Z[q.uuid])]):(Z[q.uuid]=Ba,t.push(["LAMP_INDEX",String(Ba++)]));q=Z;break;case "LIGHTING_AMBIENT":n=[Q("E","E",[0,0,0],!0),Q("A","A",[0,0,0],!0),Q("D","D",[0,0,0],!0)];l=[Q("color",
"color",[0,0,0],!0),Q("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":l=[Q("E","E",[0,0,0],!0),Q("A","A",[0,0,0],!0),Q("D","D",[0,0,0],!0),Q("S","S",[0,0,0],!0),Q("normal","normal",[0,0,0],!0),Q("dif_params","dif_params",[0,0],!0),Q("sp_params","sp_params",[0,0],!0),Q("shadow_factor","shadow_factor",0,!0),Q("translucency_color","translucency_color",0,!0),Q("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":n=[Q("color","color",[0,0,0],!0),Q("specular",
"specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":n=[Q("shadow_factor","shadow_factor",0,!0)];l=[Q("ldir","ldir",[0,0,0],!0),Q("lfac","lfac",[0,0],!0),Q("lcolorint","lcolorint",[0,0,0],!0),Q("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":n=[Q("ldir","ldir",[0,0,0],!0),Q("lfac","lfac",[0,0],!0),Q("normal","normal",[0,0,0],!0),Q("norm_fac","norm_fac",0,!0)];l=[Q("lfactor","lfactor",0,!0)];break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":n=
[Q("ldir","ldir",[0,0,0],!0),Q("lfac","lfac",[0,0],!0),Q("normal","normal",[0,0,0],!0),Q("norm_fac","norm_fac",0,!0),Q("dif_params","dif_params",[0,0],!0)];l=[Q("lfactor","lfactor",0,!0)];break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":n=[Q("ldir","ldir",[0,0,0],!0),Q("lfac","lfac",[0,0],!0),Q("normal","normal",[0,0,0],!0),Q("norm_fac","norm_fac",0,!0),Q("sp_params","sp_params",[0,0],!0)];l=[Q("sfactor","sfactor",0,!0)];break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":n=[Q("ldir","ldir",[0,0,
0],!0),Q("lfac","lfac",[0,0],!0),Q("normal","normal",[0,0,0],!0),Q("sp_params","sp_params",[0,0],!0)];l=[Q("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":n=[Q("color","color",[0,0,0,0],!0),Q("specular","specular",[0,0,0],!0),Q("lfactor","lfactor",0,!0),Q("sfactor","sfactor",0,!0),Q("ldir","ldir",[0,0,0],!0),Q("normal","normal",[0,0,0],!0),Q("translucency_params","translucency_params",[0,0,0,0],!0),Q("D","D",[0,0,0],!0),Q("S","S",[0,0,0],!0),Q("lcolorint","lcolorint",[0,0,0],!0),Q("translucency_color",
"translucency_color",0,!0)];l=[Q("color","color",[0,0,0,0],!0),Q("specular","specular",[0,0,0],!0)];break;case "NORMAL":n=ha(b);l=aa(b);p=X(b,"Normal");m.push(R(r("param_NORMAL_Normal"),p.Da,3));break;case "MAPPING":p=b.vector_type;h="MAPPING";n.push(ba(b,"Vector"));l.push(X(b,"Vector"));var u=b.rotation,L=b.scale,x=b.translation,v=oa.create(),S=N.OA(u);"TEXTURE"==p&&(L[0]=L[0]||1,L[1]=L[1]||1,L[2]=L[2]||1);var O=new Float32Array([L[0],0,0,0,L[1],0,0,0,L[2]]);oa.multiply(S,O,v);v=N.ZC(v,la.create());
switch(p){case "POINT":v[12]=x[0];v[13]=x[1];v[14]=x[2];break;case "TEXTURE":v[12]=x[0];v[13]=x[1];v[14]=x[2];v=la.invert(v,v);break;case "NORMAL":la.invert(v,v),la.transpose(v,v)}switch(p){case "NORMAL":t.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":t.push(["MAPPING_TRS_MATRIX",U.r(v,16)]);break;case "POINT":0!==qa.length(u)?t.push(["MAPPING_TRS_MATRIX",U.r(v,16)]):(0!==qa.length(L)&&t.push(["MAPPING_SCALE",U.r(L,3)]),0!==qa.length(x)&&t.push(["MAPPING_TRANSLATION",U.r(x,3)]));break;case "VECTOR":0!==
qa.length(u)?t.push(["MAPPING_TRS_MATRIX",U.r(v,16)]):0!==qa.length(L)&&t.push(["MAPPING_SCALE",U.r(L,3)])}b.use_min&&t.push(["MAPPING_MIN_CLIP",U.r(b.min,3)]);b.use_max&&t.push(["MAPPING_MAX_CLIP",U.r(b.max,3)]);break;case "MATERIAL":case "MATERIAL_EXT":q=[];p=[];u=[];L=[Q("E","E",[0,0,0],!0),Q("A","A",[0,0,0],!0),Q("D","D",[0,0,0],!0),Q("S","S",[0,0,0],!0),Q("normal","normal",[0,0,0],!0),Q("dif_params","dif_params",[0,0],!0),Q("sp_params","sp_params",[0,0],!0),Q("shadow_factor","shadow_factor",
0,!0)];x=[Q("color","color",[0,0,0],!0),Q("specular","specular",[0,0,0],!0),Q("normal","normal",[0,0,0],!0)];v=[X(b,"Color"),X(b,"Alpha"),X(b,"Normal")];S=[];O=ba(b,"Color");O.Da.splice(3);u.push(O);n.push(O);O=ba(b,"Spec");O.Da.splice(3);u.push(O);n.push(O);u.push(Q("DiffuseIntensity","DiffuseIntensity",b.diffuse_intensity));n.push(O);var w=ba(b,"Normal");w.Da.splice(3);u.push(w);n.push(w);"MATERIAL_EXT"==h?((O=ba(b,"Emit"))||(O=Q("Emit","Emit",0)),u.push(O),n.push(O),(O=ba(b,"Translucency"))?(O.Da=
0,O.name="Translucency",O.identifier="Translucency"):O=Q("Translucency","Translucency",0),n.push(O),(O=ba(b,"Translucency"))?(O.Da=[0,0,0,0],O.name="TranslucencyParams",O.identifier="TranslucencyParams"):O=Q("TranslucencyParams","TranslucencyParams",[0,0,0,0]),n.push(O),l=ba(b,"Reflectivity"),O=ba(b,"Ray Mirror"),l?(O=l,l="Reflectivity"):O?l="Ray Mirror":(O=l,l="Reflectivity"),O||(O=Q(l,l,0)),n.push(O),x.push(O),(O=ba(b,"SpecTra"))||(O=Q("SpecTra","SpecTra",0)),n.push(O),x.push(O),(O=ba(b,"Alpha"))||
(O=Q("Alpha","Alpha",b.alpha)),n.push(O),x.push(O),v.push(X(b,"Diffuse")),v.push(X(b,"Spec")),q.push(["MATERIAL_EXT",1]),p.push(["MATERIAL_EXT",1])):(u.push(Q("emit_intensity","emit_intensity",0)),x.push(Q("reflect_factor","reflect_factor",0)),x.push(Q("specular_alpha","specular_alpha",0)),x.push(Q("alpha_in","alpha_in",0)),v.push(Q("diffuse_out","diffuse_out",0)),v.push(Q("spec_out","spec_out",0)),q.push(["MATERIAL_EXT",0]),p.push(["MATERIAL_EXT",0]));S.push(R(r("param_MATERIAL_alpha"),b.alpha));
S.push(R(r("param_MATERIAL_spec_alpha"),b.specular_alpha));l=v;w.Gb&&q.push(["USE_MATERIAL_NORMAL",1]);b.use_diffuse&&(q.push(["USE_MATERIAL_DIFFUSE",1]),p.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&p.push(["USE_MATERIAL_SPECULAR",1]);var O=[],y=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":w=b.specular_hardness;break;case "WARDISO":w=b.specular_slope;break;case "TOON":w=b.specular_toon_size;y=b.specular_toon_smooth;break;case "BLINN":w=b.specular_ior;y=b.specular_hardness;break;
default:Y.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+'")'),w=b.specular_hardness}var E,A;switch(b.diffuse_shader){case "LAMBERT":A=E=0;break;case "OREN_NAYAR":E=b.roughness;A=0;break;case "FRESNEL":E=b.diffuse_fresnel;A=b.diffuse_fresnel_factor;break;case "MINNAERT":E=b.darkness;A=0;break;case "TOON":E=b.diffuse_toon_size;A=b.diffuse_toon_smooth;break;default:Y.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),A=
E=0}O.push(R(r("param_MATERIAL_diffuse"),[E,A],2));O.push(R(r("param_MATERIAL_spec"),[b.specular_intensity,w,y],3));q.push(["SHADELESS_MAT",b.use_shadeless?1:0]);w={name:b.name,value:{Qi:b.specular_shader,Pj:b.diffuse_shader,fd:b.use_shadeless}};q={name:b.name,value:{Qi:b.specular_shader,Pj:b.diffuse_shader,fd:b.use_shadeless},$C:{name:"material_begin",type:"MATERIAL_BEGIN",C:u,la:L,K:O,data:w,qd:q,eg:[]},aD:{name:"material_end",type:"MATERIAL_END",C:x,la:v,K:S,data:w,qd:p,eg:[]}};break;case "MATH":switch(b.operation){case "ADD":h=
"MATH_ADD";break;case "SUBTRACT":h="MATH_SUBTRACT";break;case "MULTIPLY":h="MATH_MULTIPLY";break;case "DIVIDE":h="MATH_DIVIDE";break;case "SINE":h="MATH_SINE";break;case "COSINE":h="MATH_COSINE";break;case "TANGENT":h="MATH_TANGENT";break;case "ARCSINE":h="MATH_ARCSINE";break;case "ARCCOSINE":h="MATH_ARCCOSINE";break;case "ARCTANGENT":h="MATH_ARCTANGENT";break;case "POWER":h="MATH_POWER";break;case "LOGARITHM":h="MATH_LOGARITHM";break;case "MINIMUM":h="MATH_MINIMUM";break;case "MAXIMUM":h="MATH_MAXIMUM";
break;case "ROUND":h="MATH_ROUND";break;case "LESS_THAN":h="MATH_LESS_THAN";break;case "GREATER_THAN":h="MATH_GREATER_THAN";break;case "MODULO":h="MATH_MODULO";break;case "ABSOLUTE":h="MATH_ABSOLUTE";break;default:return Y.error("Unsupported MATH operation: "+b.operation),null}t.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);n=ha(b);l=aa(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":h="MIX_RGB_MIX";break;case "ADD":h="MIX_RGB_ADD";break;case "MULTIPLY":h="MIX_RGB_MULTIPLY";break;case "SUBTRACT":h=
"MIX_RGB_SUBTRACT";break;case "SCREEN":h="MIX_RGB_SCREEN";break;case "DIVIDE":h="MIX_RGB_DIVIDE";break;case "DIFFERENCE":h="MIX_RGB_DIFFERENCE";break;case "DARKEN":h="MIX_RGB_DARKEN";break;case "LIGHTEN":h="MIX_RGB_LIGHTEN";break;case "OVERLAY":h="MIX_RGB_OVERLAY";break;case "DODGE":h="MIX_RGB_DODGE";break;case "BURN":h="MIX_RGB_BURN";break;case "HUE":h="MIX_RGB_HUE";break;case "SATURATION":h="MIX_RGB_SATURATION";break;case "VALUE":h="MIX_RGB_VALUE";break;case "COLOR":h="MIX_RGB_COLOR";break;case "SOFT_LIGHT":h=
"MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":h="MIX_RGB_LINEAR_LIGHT";break;default:return Y.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}t.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);n=ha(b);l=aa(b);break;case "OUTPUT":n=ha(b);l=[];break;case "RGB":p=e+"%join%"+b.name;p={name:"-1",value:p};m.push(p);l.push(X(b,"Color"));break;case "SEPRGB":case "SEPHSV":n=ha(b);l=aa(b);break;case "TEXTURE":h=V(b);if("TEXTURE_EMPTY"==h)l.push(X(b,"Color")),l.push(X(b,"Normal")),l.push(X(b,"Value"));
else if("TEXTURE_ENVIRONMENT"==h)n.push(ba(b,"Vector")),l.push(X(b,"Color")),l.push(X(b,"Value"));else{if("TEXTURE_NORMAL"==h&&"ENVIRONMENT_MAP"==b.texture.type)return Y.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;for(q=0;4>q;++q)q?(O=Q("Vector"+q,"Vector"+q,[0,0,0]),"TEXTURE_COLOR"==h&&(p=Q("Color"+q,"Color"+q,[0,0,0]),u=Q("Value"+q,"Value"+q,0)),"TEXTURE_NORMAL"==h&&(p=Q("Normal"+q,"Normal"+q,[0,0,0]),u=Q("Value"+q,"Value"+q,0))):(O=ba(b,"Vector"),"TEXTURE_COLOR"==h&&(p=X(b,
"Color"),u=X(b,"Value")),"TEXTURE_NORMAL"==h&&(p=X(b,"Normal"),u=X(b,"Value"))),n.push(O),l.push(p),l.push(u)}u=r("param_TEXTURE_texture");m.push(R(u));q={name:u,value:b.texture};break;case "VALTORGB":n=ha(b);l=aa(b);Y.warn("VALTORGB node is not fully supported.");break;case "VALUE":h="VALUE";p=e+"%join%"+b.name;p={name:"-1",value:p};m.push(p);l.push(X(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":h="VECT_MATH_ADD";break;case "SUBTRACT":h="VECT_MATH_SUBTRACT";break;case "AVERAGE":h=
"VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":h="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":h="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":h="VECT_MATH_NORMALIZE";break;default:return Y.error("Unsupported VECT_MATH operation: "+b.operation),null}n=ha(b);l=aa(b);break;default:n=ha(b),l=aa(b)}h={name:g,type:h,eg:k,C:n,la:l,K:m,data:q,qd:t};g=P.dk(a);P.Mh(a,P.dk(a),h);if(!(h="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type)){a:{h=b.outputs;for(n=k=0;n<h.length;n++)if(h[n].is_linked&&k++>c){h=!0;break a}h=
!1}h=!h}return h||null!=C(a,b,++c,d,e,f)?g:null}function M(a,b,c){for(var d=a.inputs,e=a.outputs,f=a.node_tree_name,g=0;g<b.length;g++){var h=d[g],k=b[g];if(!h||h.default_value instanceof Array!=k)return Y.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1}for(g=0;g<c.length;g++)if(b=e[g],d=c[g],!b||b.default_value instanceof Array!=d)return Y.warn('Wrong outputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),
!1;return!0}function G(a,b,c){var d=a.node_group.node_tree,f={},g;for(g in d)if("links"==g||"nodes"==g){f[g]=[];for(var h=0;h<d[g].length;h++){f[g][h]={};for(var k in d[g][h])if("links"==g){f[g][h][k]={};for(var n in d[g][h][k])f[g][h][k][n]=E(d[g][h][k][n])}else f[g][h][k]=E(d[g][h][k])}}else f[g]=E(d[g]);d=a.node_tree_name;if("B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d)g=J("Group input","GROUP_INPUT",[],a.inputs),h=J("Group output","GROUP_OUTPUT",a.outputs,[]),k=null,k="B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==
d&&(Ra.quality==ua.P_LOW||Ra.Po)?{from_node:g,from_socket:g.outputs[1],to_node:h,to_socket:h.inputs[0]}:{from_node:g,from_socket:g.outputs[0],to_node:h,to_socket:h.inputs[0]},f.nodes=[g,h],f.links=[k];d=a.name;g=f.nodes;h=f.links;for(k=0;k<g.length;k++)g[k].name=na(g[k].type,d,g[k].name);for(k=0;k<h.length;k++)h[k].from_node.name=na(h[k].from_node.type,d,h[k].from_node.name),h[k].to_node.name=na(h[k].to_node.type,d,h[k].to_node.name);return{nD:e(f,a.node_group.uuid,!0,b,c),oD:f.links}}function E(a){var b=
typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?N.Aj(a):a}function r(a){sa[a]||(sa[a]=0);var b=a+sa[a],b=b.replace(/ /g,"_").replace(/\//g,"_");sa[a]++;return b}function K(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function z(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";case "Normal":return"GEOMETRY_NO";case "Front/Back":return"GEOMETRY_FB";
case "View":return"GEOMETRY_VW";case "Global":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";default:return null}}}function H(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";
default:return null}}}function V(a){if(!a.texture)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,e=!1,f=0;f<b.length;f++){var g=b[f];if(g.is_linked)switch(g.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":e=!0;break;default:throw"Unknown texture output";}}if(c)return d&&Y.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==
a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function ba(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return fa(e)}return null}function X(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return fa(e)}return null}function fa(a){var b=a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=N.is_vector(a)?a.slice(0):a;return{name:b,identifier:c,Gb:d,Da:a}}function Q(a,b,c,d){return{name:a,identifier:b,Gb:d||!1,Da:c}}function ha(a){for(var b=
[],c=0;c<a.inputs.length;c++){var d=fa(a.inputs[c]);d.Da.length&&d.Da.splice(3);b.push(d)}return b}function aa(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=fa(a.outputs[c]);b.push(d)}return b}function R(a,b,c){b=null===b||void 0===b?null:U.r(b,c);return{name:a,value:b}}function W(a,b,c,d,e,f){var g=[],h=f.from_socket.identifier;f=f.to_socket.identifier;var k=d.la;for(d=0;d<k.length;d++)if(k[d].identifier==h){g.push(d);break}e=e.C;for(d=0;d<e.length;d++)if(e[d].identifier==f){g.push(d);break}2==
g.length&&P.Zb(a,b,c,g);return!0}function na(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function ia(a){var b=[];P.W(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function da(a,b,c){for(var d=0;d<c.length;d++){var e=c[d].data.nD,f=c[d].data.oD;if(!e)return!1;P.W(e,function(b,c){P.Mh(a,P.dk(a),c)});for(e=0;e<f.length;e++)b.push(f[e]);S(c[d],b,a)}return!0}function ja(a,b,c,d,e,f){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+
"*GI*")||e.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(c)}}function ga(a,b,c){for(var d=[],e=0;e<c.length;e++){for(var f=c[e],g=null,h=0;h<b.length;h++)if(f.from_socket.identifier==b[h].to_socket.identifier){g=b[h];break}g?(f.from_node=g.from_node,f.from_socket=g.from_socket):d.push(f)}for(e=0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return d}function L(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function O(a,b,c,
d){for(var e=0;e<d.length;e++){for(var f=d[e],g,h=0;h<c.C.length;h++)if(f.from_socket.identifier==c.C[h].identifier){g=c.C[h].Da;break}for(var h=f,k=b,l=g,m=n(h.to_node,k),r=0;r<m.length;r++)for(var q=P.Ja(k,m[r]),p=0;p<q.C.length;p++){var t=q.C[p];if(t.identifier==h.to_socket.identifier){q=t.Da instanceof Object?0:1;if((l instanceof Object?0:1)==q)t.Da=l;else switch(q){case 0:t=t.Da;t[0]=t[1]=t[2]=l;break;case 1:t.Da=(l[0]+l[1]+l[2])/3}break}}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function S(a,b,c){for(var d=
a.name,e=[],f=[],g=[],h=[],k=0;k<b.length;k++){var n=b[k];ja(n.from_node,d,n,e,g,h);ja(n.to_node,d,n,f,g,h)}f=ga(b,f,g);e=ga(b,h,e);L(b,f);O(b,c,a,f);if(e.length){var l;P.W(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(l=b)});O(b,c,l,e)}}var ua=p("__config"),P=p("__graph"),oa=p("__mat3"),la=p("__mat4"),ea=p("__objects"),Y=p("__print"),U=p("__shaders"),ya=p("__scenes"),N=p("__util"),qa=p("__vec3"),sa={},T={},Z={},Ba=0;new Float32Array(4);var Ra=ua.q;a.Fz=e;a.oo=function(a,b,d){var e=
ya.get_active();a=f(a,"MAIN",e.uuid);if(a in T)return T[a];var e=P.create(),g={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},h=C(e,g,0,null,b,null),g={name:"LIGHTING_END",type:"LIGHTING_END"},g=C(e,g,0,null,b,null);c(e,d,h,g,[[h,[8,10]],[h,[9,6]]],null,b);t(e);return T[a]=e};a.Gl=function(a){var b=[],c={};sa={};var d=P.Sq(a);P.W(d,function(a,d){var e;e=[];for(var f=[],g=[],h=[],k=[],n=[],l=0;l<d.C.length;l++){var m=d.C[l];if(m.Gb)e.push(null),f.push(null);else{e.push(r("in_"+d.type+"_"+m.identifier));
var q=U.r(m.Da,0);Ra.qv&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==m.identifier||"Color2"==m.identifier||"Fac"==m.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==m.identifier||"Value_001"==m.identifier)||0<=d.type.indexOf("VECT_MATH_")&&"Vector_001"==m.identifier||0<=d.type.indexOf("LIGHTING_APPLY")||0<=d.type.indexOf("MATERIAL_END")||0<=d.type.indexOf("MATERIAL_BEGIN"))&&(m=q,m=m.replace(/(,)/g,"$1 "),m=m.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1ZERO_VALUE_NODES$3"),m=m.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,
"$1UNITY_VALUE_NODES$3"),q=m=m.replace(/\s+/g,""));f.push(q)}}for(l=0;l<d.la.length;l++)m=d.la[l],m.Gb?g.push(null):g.push(r("out_"+d.type+"_"+m.identifier));for(l=0;l<d.K.length;l++)m=d.K[l],h.push(m.name),k.push(m.value);for(l=0;l<d.eg.length;l++)n.push(d.eg[l].name);e={id:d.type,C:e,np:f,la:g,K:h,Dm:k,eg:n,qd:JSON.parse(JSON.stringify(d.qd))};b.push(e);c[a]=e});P.ne(d,function(a,b,e){var f=P.Ja(d,a);P.Ja(d,b);var g=f.la[e[0]];a=c[a].la;b=c[b].C;f=a[e[0]]||r("out_"+f.type+"_"+g.identifier);a[e[0]]=
f;b[e[1]]=f});return b};a.ss=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.cleanup=function(){for(var a in T)delete T[a];for(var b in Z)delete Z[b];Ba=0}};b4w.module.__animation=function(a,p){function e(a,b){var c=a.D[b];c&&c.No&&c.Wj&&(c.Wj=!1,c.No(a,b))}function b(a,b,c){c=a.D[c];c.type=30;var d=b.I,e=b.Z-d+1;c.start=d;c.length=e;c.Nc=d;c.tg=b.name;for(e=d=0;e<a.Wb.length;e++){var f=a.Wb[e];if(f==b)break;else d+=f.Z-f.I+1}c.pw=d}function c(a,b,c){for(var d=a.V,e=0;e<d.length;e++)for(var f=d[e].S,g=0;g<f.length;g++){var h=f[g].va;if(h&&h.name==b){var k=a.D[c];k.type=50;k.tg=h.name;k.start=h.I;k.length=h.Z-k.start;h.cyclic||(k.length+=h.xp)}}}function m(a){return a.replace(/_B4W_BAKED$/,
"")}function f(a,b){if(a.animation_data){var c=a.animation_data.action;c&&c.j.type==Y&&b.push(c)}for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];e.node_group&&(e=e.node_group.node_tree)&&f(e,b)}}function l(a){return ba.is_mesh(a)&&a.f.Wb?!0:!1}function h(a,b,c){var e=a.D;if(-1==c)for(c=0;8>c;c++){var f=e[c];f&&(f.Nc=b,d(a,0,c,!0))}else if(f=e[c])f.Nc=b,d(a,0,c,!0)}function t(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function d(a,b,c,d){B(a,b,c,d);e(a,c);a.f.rg&&(F(a,
b),v(a,b))}function g(a,b,c){var d=b.frame_range;if(d[0]>d[1])return Q.warn('Incompatible action "'+b.name+'" has been applied to object "'+a.name+'"'),!1;var e=b.j,f=a.D[c];f.tg=b.name;f.An=d;f.Lr=e.Ku;f.Kr=e.as;f.yg.set(e.yg);f.start=d[0];f.length=d[1]-d[0];f.Nc=d[0];switch(e.type){case oa:if(ba.is_armature(a)){f.type=10;var g=k(a,b);if(!g){for(var g=a.f.ld,d=[],h=[],l=b.j.Sp,m=0;m<l;m++){for(var r in g){var p=g[r],t=p.cn,L=b.j.Tn[r];L?ia.copy(L.subarray(8*m,8*m+8),t):ia.identity(t);p.dn=!1}p=u(g);
d.push(p.i);h.push(p.ma)}g={i:d,ma:h};a.Kh.push(b,g)}f.i=g.i;f.ma=g.ma;f=g;r=a.f;g=r.Wm;h=a.D[c];d=h.wq;a:{l=r.wv;for(m=0;m<l.length;m+=2)if(b==l[m]){l=l[m+1];break a}l=null}if(l)h.wq=l;else{for(h=0;h<g.length;h++){for(var l=g[h].Qh,m=[],p=[],t=f.i,L=f.ma,v=0;v<t.length;v++){var O=q(t[v],L[v],l);m.push(O.i);p.push(O.ma)}d.push({i:m,ma:p})}r.wv.push(b,d)}r.rg&&(b=r.fn,c>b[1]?(f=b[1],b[1]=c,b[0]=f):c>b[0]&&c<b[1]&&(b[0]=c),n(a))}break;case la:ba.is_speaker(a)&&(f.volume=e.K.volume||null,f.pitch=e.K.pitch||
null,f.type=40);break;case U:ba.is_lamp(a)&&(f.color=e.K.color||null,f.Fe=e.K.energy||null,f.type=70);break;case Y:if("MESH"==a.type){f.type=60;r=k(a,b);if(!r){r=[];d=[];h=[];l=[];m=b.j;p=a.f.um;t=a.f.vm;for(g in m.K)L=b.name+"%join%"+g,I(g,L,m,d,r,p),I(g,L,m,l,h,t);r={pG:r,values:d,bE:h,cE:l};a.Kh.push(b,r)}f.su=r.pG;f.uu=r.values;f.ru=r.bE;f.tu=r.cE}break;case ea:if(r=e.K.tsr){f.type=20;g=k(a,b);if(!g){g=b.j.Sp;d=[];h=[];for(l=0;l<g;l++)d.push(r.subarray(8*l,8*l+4)),h.push(r.subarray(8*l+4,8*l+
8));g={i:d,ma:h};a.Kh.push(b,g)}f.i=g.i;f.ma=g.ma;X.Ai(a)&&X.YF(a,f.i[0],f.ma[0])}else return Q.warn('Incompatible action "'+b.name+'" has been applied to object "'+a.name+'"'),!1}ba.is_armature(a)&&e.type!=oa&&x(a,c);return!0}function k(a,b){for(var c=a.Kh,d=0;d<c.length;d+=2)if(b==c[d])return c[d+1];return null}function n(a){var b=a.f.fn;if(-1!=b[0]&&-1!=b[1]){var c=a.D;a=c[b[1]].Nc;var d=Math.floor(a),e=a-d,b=c[b[0]];a=b.Nc;d=Math.floor(a);b.Nc=d+e}}function x(a,b){var c=a.f.fn,d=c[1];c[0]=-1;
c[1]=-1;if(-1!=b)for(var e=a.D;0<=d;d--){var f=e[d];if(f&&10==f.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function I(a,b,c,d,e,f){for(var g=0;g<f.length;g+=2)b==f[g]&&(e.push(f[g+1]),d.push(new Float32Array(c.K[a])))}function A(a){a=a.j;for(var b in a.K)if(-1!=b.indexOf("nodes"))return!0;return!1}function B(a,b,c,d){if((c=a.D[c])&&null!=c.type&&(c.play||d)){var e=a.f,f=c.Nc,g=c.start,h=c.length,f=f+c.speed*b*W.Nb(),k=c.type,n=c.speed;if(0<=n&&f>=g+h||0>n&&f<g)switch(d||(c.Wj=!0),c.behavior){case 10:f=
0<=n?(f-g)%h+g:g+h-1E-6;break;case 20:f=0<=n?g:g+h-1E-6;c.play=!1;break;case 30:f=0<=n?g+h-1E-6:g,c.play=!1}c.Nc=f;switch(k){case 10:if(!e.rg){d=y(c);b=d[0];f=d[1];d=d[2];e.Bc=c.ma[b];e.Xc=c.ma[f];e.Gc=c.i[b];e.ed=c.i[f];e.sd=d;d=e.Wm;c=c.wq;for(g=0;g<d.length;g++)h=d[g],k=c[g],h.Bc=k.ma[b],h.Xc=k.ma[f],h.Gc=k.i[b],h.ed=k.i[f],h.sd=e.sd;na.o(a)}break;case 20:d=y(c);var e=N,f=d[0],g=d[1],h=d[2],k=c.i,n=k[f][1],l=k[f][2],m=k[g][1],r=k[g][2];e[0]=(1-h)*k[f][0]+h*k[g][0];e[1]=(1-h)*n+h*m;e[2]=(1-h)*l+
h*r;f=sa;l=d[0];g=d[1];h=d[2];k=c.ma;n=T;n[0]=k[l][0];n[1]=k[l][1];n[2]=k[l][2];n[3]=k[l][3];l=Z;l[0]=k[g][0];l[1]=k[g][1];l[2]=k[g][2];l[3]=k[g][3];ha.slerp(n,l,h,f);g=d[2];h=c.i;d=(1-g)*h[d[0]][3]+g*h[d[1]][3];c.Tq&&(g=qa,na.get_translation(a,g),da.smooth_v(e,g,b,c.Tq,e));c.eq&&(g=T,na.get_rotation(a,g),da.Cv(f,g,b,c.eq,f));g=c.yg;g[0]&&na.set_translation_rel(a,e);g[1]&&na.set_rotation_rel(a,f);g[2]&&na.set_scale_rel(a,d);na.o(a);fa.sync_transform(a);break;case 30:d=c.Nc-c.start;0>d&&(d=0);d>=c.length&&
(d=c.length);a=Math.floor(d);b=a+1;d-=a;10!=c.behavior&&b==c.length&&(b=--a,d=1);c=c.pw;ya[0]=a+c;ya[1]=b+c;ya[2]=d;d=ya;e.er=d[0];e.ow=d[2];break;case 40:d=y(c);b=d[0];e=d[1];d=d[2];c.volume&&R.set_volume(a,(1-d)*c.volume[b]+d*c.volume[e]);c.pitch&&R.playrate(a,(1-d)*c.pitch[b]+d*c.pitch[e]);break;case 50:X.BE(a,c.tg,f/W.Nb());break;case 60:d=y(c);b=d[0];e=d[1];d=d[2];k=c.uu;n=c.su;f=c.tu;g=c.ru;for(c=0;c<n.length;c++)l=k[c],h=n[c],a.f.Oe[h]=(1-d)*l[b]+d*l[e];for(c=0;c<g.length;c++)k=f[c],h=g[c],
k=ja.lerp(k.subarray(3*b,3*b+3),k.subarray(3*e,3*e+3),d,N),a.f.Tc[h]=k[0],a.f.Tc[h+1]=k[1],a.f.Tc[h+2]=k[2];break;case 70:d=y(c);b=d[0];e=d[1];d=d[2];g=c.yg;(f=c.Fe)&&g[0]&&L.uq(a.Fa,(1-d)*f[b]+d*f[e]);(c=c.color)&&g[1]&&(N[0]=(1-d)*c[3*b]+d*c[3*e],N[1]=(1-d)*c[3*b+1]+d*c[3*e+1],N[2]=(1-d)*c[3*b+2]+d*c[3*e+2],L.mv(a.Fa,N));b=a.V;for(c=0;c<b.length;c++)O.OF(a,b[c].na);break;default:da.U("Unknown animation type:"+k)}}}function y(a){var b=a.An[0],c=a.An[1]-b,b=a.Nc-b;0>b&&(b=0);b>=c&&(b=c);b/=a.Lr;c=
Math.floor(b);a=a.Kr[c]?b-c:0;b=Math.ceil(c+a);ya[0]=c;ya[1]=b;ya[2]=a;return ya}function v(a,b){var c=a.f,d=c.jf,e=c.fn,f=e[0],e=e[1];if(-1!=e){if(-1!=f){var g=a.D[f];if(g.play||0==b){var h=y(g),k=h[0],n=h[1];c.sd=h[2];var h=g.ma[k],l=g.ma[n],k=g.i[k],n=g.i[n]}else d=1}else d=1;e=a.D[e];if(e.play||0==b){var f=y(e),m=f[0],r=f[1];c.sd=f[2]}else if(-1!=f&&g.play)d=0;else return;f=e.ma[m];g=e.ma[r];m=e.i[m];r=e.i[r];if(1==d)c.Bc.set(f),c.Xc.set(g),c.Gc.set(m),c.ed.set(r);else if(0==d)c.Bc.set(h),c.Xc.set(l),
c.Gc.set(k),c.ed.set(n);else{for(e=0;e<h.length;e+=4){for(var q=sa,p=T,t=0;4>t;t++)q[t]=h[e+t],p[t]=f[e+t];ha.slerp(q,p,d,q);for(t=0;4>t;t++)c.Bc[e+t]=q[t];for(t=0;4>t;t++)q[t]=l[e+t],p[t]=g[e+t];ha.slerp(q,p,d,q);for(t=0;4>t;t++)c.Xc[e+t]=q[t]}da.cs(k,m,d,c.Gc);da.cs(n,r,d,c.ed)}na.o(a);ga.WF(a)}}function F(a,b){var c=a.f,d=c.jf,e=c.Fn;if(0!=e){var d=c.En-d,f=e*b;da.sign(d)==da.sign(e)&&Math.abs(f)<Math.abs(d)?c.jf+=f:(c.jf=c.En,c.Fn=0)}}function u(a){var b=[],c=[],d=new Float32Array(4),e=new Float32Array(4),
f;for(f in a){var g=a[f],h=d,k=e,n=g.Dl,l=n[n.length-1],m=l.Xq;l.dn||ia.identity(m);for(l=n.length-1;0<=l;l--){var r=n[l],q=r.Xq;if(r.dn)m=q;else{var t=r.bg,p=r.cn;ia.invert(t,Ba);ia.multiply(p,Ba,Ba);ia.multiply(t,Ba,Ba);ia.multiply(m,Ba,q);m=q;r.dn=!0}}n=r.Xq;h[0]=n[0];h[1]=n[1];h[2]=n[2];h[3]=n[3];k[0]=n[4];k[1]=n[5];k[2]=n[6];k[3]=n[7];ha.normalize(k,k);g=g.lf;for(h=0;4>h;h++)k=4*g+h,b[k]=d[h],c[k]=e[h]}return{i:b,ma:c}}function q(a,b,c){var d=[],e=[];new Float32Array(4);new Float32Array(4);for(var f in c)for(var g=
c[f],h=g.lf,g=g.zo,k=0;4>k;k++){var n=4*g+k,l=4*h+k;d[n]=a[l];e[n]=b[l]}d=new Float32Array(d);e=new Float32Array(e);return{i:d,ma:e}}function D(a){var b=a.j,c;if(b.Tn)c=oa;else if(b.K)if("volume"in b.K||"pitch"in b.K)c=la;else if(A(a))c=Y;else{a:{if(a.j.K){a=a.fcurves;for(c in a)if("color"==c&&!a[c][3]){c=!0;break a}if("energy"==c){c=!0;break a}}c=!1}c=c?U:ea}else c=P;b.type=c}function A(a){if(a=a.j.K)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;return!1}function w(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==
c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function J(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=1)}function C(a,b,c,d,e,f,g){var h=a+(b-a)/2,k=M(h,d,e,f,g)-c;return.02>Math.abs(k)?h:0<k?C(a,h,c,d,e,f,g):C(h,b,c,d,e,f,g)}function M(a,b,c,d,e){var f=1-a;return b*f*f*f+3*c*f*f*a+3*d*f*a*a+e*a*a*a}function G(a,b){var c={type:null,tg:null,An:null,Lr:0,Kr:null,yg:new Int8Array(3),ma:null,i:null,wq:[],play:!1,behavior:20,Nc:0,start:0,length:0,Tq:0,eq:0,Wj:!1,
pw:null,speed:1,volume:null,pitch:null,color:null,Fe:null,uu:[],su:[],tu:[],ru:[]};if(!a.D.length)for(var d=0;8>d;d++)a.D.push(null);a.D[b]=c;-1==Ra.indexOf(a)&&Ra.push(a)}function E(a,b){na.o(a);fa.sync_transform(a);d(a,0,b,!0)}function r(a,d,e){e=e||0;if(ba.is_mesh(a)){var f=K(a,d);if(f)return G(a,e),b(a,f,e),E(a,e),!0;if((f=z(a,d))&&"EMITTER"==f.Vp)return G(a,e),c(a,f.name,e),E(a,e),!0}if(f=da.keysearch("name",d,va)||da.keysearch("name",d+"_B4W_BAKED",va)){G(a,e);if(g(a,f,e))return E(a,e),!0;a.D[e]=
null}Q.error('Unsupported object: "'+a.name+'" or animation name: "'+d+'"');return!1}function K(a,b){for(var c=0;c<a.Wb.length;c++){var d=a.Wb[c];if(d.name===b)return d}return null}function z(a,b){for(var c=a.V,d=0;d<c.length;d++)for(var e=c[d].S,f=0;f<e.length;f++){var g=e[f].va;if(g&&g.name===b)return g}return null}function H(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}var V=p("__config"),ba=p("__obj_util"),X=p("__particles"),fa=p("__physics"),
Q=p("__print"),ha=p("__quat"),aa=p("__reformer"),R=p("__sfx"),W=p("__time"),na=p("__transform"),ia=p("__tsr"),da=p("__util"),ja=p("__vec3"),ga=p("__armature"),L=p("__lights"),O=p("__scenes"),S=V.sg,ua=V.q;a.ex=1E-6;a.OBJ_ANIM_TYPE_NONE=0;a.OBJ_ANIM_TYPE_ARMATURE=10;a.OBJ_ANIM_TYPE_OBJECT=20;a.OBJ_ANIM_TYPE_VERTEX=30;a.OBJ_ANIM_TYPE_SOUND=40;a.OBJ_ANIM_TYPE_PARTICLES=50;a.OBJ_ANIM_TYPE_MATERIAL=60;a.bH=70;a.SLOT_0=0;a.SLOT_1=1;a.SLOT_2=2;a.SLOT_3=3;a.SLOT_4=4;a.SLOT_5=5;a.SLOT_6=6;a.SLOT_7=7;a.SLOT_ALL=
-1;a.AB_CYCLIC=10;a.AB_FINISH_RESET=20;a.AB_FINISH_STOP=30;var P=a.GG=0,oa=a.Jw=1,la=a.HG=2,ea=a.Lw=3,Y=a.sr=4,U=a.Kw=5,ya=Array(3),N=new Float32Array(3),qa=new Float32Array(3),sa=new Float32Array(4),T=new Float32Array(4),Z=new Float32Array(4),Ba=new Float32Array(8);new Float32Array(16);var Ra=[],va=[];a.xt=function(){return da.trunc((ua.mu-50)/4)};a.frame_to_sec=function(a){return a/W.Nb()};a.update=function(a){for(var b=0;b<Ra.length;b++){for(var c=Ra[b],d=0;8>d;d++)B(c,a,d);c.f.rg&&(F(c,a),v(c,
a))}for(b=0;b<Ra.length;b++)for(c=Ra[b],d=0;8>d&&c.D.length;d++)e(c,d)};a.nt=function(){return va};a.get_anim_names=function(a){var b=[];if(l(a))for(var c=0;c<a.Wb.length;c++)b.push(a.Wb[c].name);for(var d=[],c=0;c<va.length;c++){var e=va[c],f=e.j;f.type==ea?d.push(e):f.type==oa&&"ARMATURE"==a.type?d.push(e):f.type==la&&"SPEAKER"==a.type&&d.push(e)}if("MESH"==a.type)for(c=0;c<a.actions.length;c++)e=a.actions[c],e.j.type==Y&&d.push(e);for(c=0;c<d.length;c++)b.push(m(d[c].name));if(X.Ai(a)&&X.Tp(a))for(a=
a.V,c=0;c<a.length;c++)for(d=a[c].S,e=0;e<d.length;e++)(f=d[e].va)&&b.push(f.name);return b};a.dF=m;a.get_anim_type=function(a,b){var c=a.D[b];return c?c.type:0};a.apply_def=function(a){for(var d=0,e=a.V,f=0;f<e.length;f++)for(var h=e[f].S,k=0;k<h.length;k++){var n=h[k].va;n&&"EMITTER"==n.Vp&&(G(a,d),c(a,n.name,d),E(a,d),a.D[d].behavior=a.ml,n.cyclic&&(a.D[d].behavior=10),d++)}e=a.actions.slice();for(f=0;f<e.length;f++)h=e[f],G(a,d),g(a,h,d)?(E(a,d),a.D[d].behavior=a.ml,d++):a.D[d]=null;l(a)&&(G(a,
d),b(a,a.Wb[0],d),E(a,d),a.D[d].behavior=a.ml)};a.jy=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:da.U("Wrong animation behavior")}};a.AB=function(a){var b=[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c].node_tree;d&&f(d,b)}return b};a.play=function(a,b,c){t(a.D,c,function(a){a.play=!0;a.No=b?b:null;a.Wj=!1});a.f.rg&&n(a)};a.stop=function(a,b){t(a.D,b,function(a){a.play=!1;a.No=null;a.Wj=!1})};a.is_play=function(a,b){var c=
a.D;if(-1==b)for(var d=0;8>d;d++){if(c[d]&&c[d].play)return!0}else if(c=c[b])return c.play;return!1};a.set_frame=h;a.set_first_frame=function(a,b){b=b||0;t(a.D,b,function(c){h(a,c.start,b)})};a.get_current_frame_float=function(a,b){var c=a.D[b];return c&&c.Nc?c.Nc:0};a.is_cyclic=function(a,b){var c=a.D[b];return c&&10==c.behavior};a.set_behavior=function(a,b,c){t(a.D,c,function(a){a.behavior=b})};a.get_behavior=function(a,b){var c=a.D[b];return c&&c.behavior};a.apply_smoothing=function(a,b,c,d){t(a.D,
d,function(a){a.Tq=b||0;a.eq=c||0})};a.remove_slot_animation=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.D[c]=null;else a.D[b]=null;a.f.rg&&x(a,b)};a.update_object_animation=d;a.Cu=function(a){if("ARMATURE"==a.type||a.ql)return!0;for(var b=0;b<a.actions.length;b++){var c=a.actions[b].j.type;if(c==ea||c==oa||c==la&&"SPEAKER"==a.type||c==U&&"LAMP"==a.type||c==Y&&"MESH"==a.type)return!0}return X.Ai(a)&&X.Tp(a)||"MESH"==a.type&&a.Wb.length?!0:!1};a.gs=function(a,b){if("ARMATURE"==b.type||H(a))return!0;
for(var c=0;c<b.actions.length;c++){var d=b.actions[c].j.type;if(d==ea||d==oa||d==la&&"SPEAKER"==b.type||d==Y&&"MESH"==b.type)return!0}return X.$y(a)&&X.Zy(a)||"MESH"==b.type&&a.data.b4w_vertex_anim.length?!0:!1};a.is_animated=function(a){return Boolean(a.D.length)};a.dz=u;a.WA=q;a.ly=function(a){function b(a,c){for(var d=0;d<c;d++){var e=a.subarray(8*d+4,8*d+8);ha.normalize(e,e)}}function c(a,b){if(-1<a.indexOf("location"))var d=0,e=b;else-1<a.indexOf("rotation_quaternion")?(d=4,e=0==b?3:b-1):-1<
a.indexOf("scale")?(d=3,e=0):(d=0,e=b);return d+e}function d(a,b,c,g,h){if(-1<c.search(e)){a=b;c=c.split('"')[1];var k=f}else 8==h?(c="tsr",k=f):k=1<h?new Float32Array(h):0;if(!a[c]){h=a;b=c;if("object"==typeof k&&k.length)for(var n=k.length,l=new Float32Array(g*n),m=0;m<g;m++)for(var r=0;r<n;r++)l[m*n+r]=k[r];else if("number"==typeof k)for(l=new Float32Array(g),m=0;m<g;m++)l[m]=k;else da.U("Wrong storage default value");h[b]=l}return a[c]}var e=new RegExp(/pose.bones\[\".+\"\]/g),f=ia.create(),g=
a.j={type:P,Sp:0,Ku:0,K:null,Tn:null,as:null,yg:new Int8Array(3)};g.Ku=1/S.Ng;var h=a.fcurves,k={},n={},l=0,m;for(m in h){var r=h[m],q;for(q in r){var t=r[q],p=t.Kc;aa.lz(t,a);t=t.num_channels;l||(l=p.length);for(var t=d(k,n,m,l,t),u=t.length/l,L=c(m,q|0),x=0;x<l;x++)t[x*u+L]=p[x]}}if(da.ek(k)){for(var v in k)"tsr"==v&&b(k[v],l);g.K=k}if(da.ek(n)){for(var O in n)b(n[O],l);g.Tn=n}g.Sp=l;g.as=a.cy;"tsr"in k&&w(h,g.yg);("color"in k||"energy"in k)&&J(h,g.yg);D(a);va.push(a)};a.yB=function(a,b){return(b-
a)*S.Ng+1};a.Hy=function(a,b,c,d,e,f){var g,h,k=new Float32Array(2),n=new Float32Array(2),l=new Float32Array(2),m=new Float32Array(2),r=b[1],q=b[2],t=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var p=0,u=0,L=null;e<=f;e++)if(e<r)for(var x=0;x<S.Ng;x++)c[p++]=q;else if(e>t)for(x=0;x<S.Ng;x++)c[p++]=a;else{var v=b[u],O=3;0===v&&(O+=2);0===L&&(O+=2);var H=2===v?0:1;if(b[u+1]==b[u+O+1])L=v,u+=O;else{x=0;e==b[u+1]&&(H&&(d[p]=1),c[p]=b[u+2],p++,x++);if(e==t)for(;x<S.Ng;x++)c[p++]=a;else for(k[0]=
b[u+1],k[1]=b[u+2],0!==v?(n[0]=0,n[1]=0):0===L?(n[0]=b[u+5],n[1]=b[u+6]):(n[0]=b[u+3],n[1]=b[u+4]),0!==v?(l[0]=0,l[1]=0):(l[0]=b[u+O+3],l[1]=b[u+O+4]),m[0]=b[u+O+1],m[1]=b[u+O+2];x<S.Ng;x++){var z=e+x/S.Ng;switch(v){case 0:g=k;h=n;var w=l,y=m,E=[],A=[],F=void 0,B=void 0,D=void 0,F=void 0;E[0]=g[0]-h[0];E[1]=g[1]-h[1];A[0]=y[0]-w[0];A[1]=y[1]-w[1];D=y[0]-g[0];F=Math.abs(E[0]);B=Math.abs(A[0]);0!=F+B&&F+B>D&&(F=D/(F+B),h[0]=g[0]-F*E[0],h[1]=g[1]-F*E[1],w[0]=y[0]-F*A[0],w[1]=y[1]-F*A[1]);H&&(d[p]=1);
c[p]=M(C(0,1,z,k[0],n[0],l[0],m[0]),k[1],n[1],l[1],m[1]);p++;break;case 1:h=k[0];w=k[1];g=y=(m[1]-w)/(m[0]-h);h=w-y*h;H&&(d[p]=1);c[p]=g*z+h;p++;break;case 2:H&&(d[p]=1);c[p]=b[u+2];p++;break;default:da.U("Unknown keyframe interpolation mode: "+v)}}e+1==b[u+O+1]&&(L=v,u+=O)}}};a.apply=r;a.Dy=function(a,b,c){c=c||0;var d=da.keysearch("uuid",b,va);if(d){G(a,c);if(g(a,d,c)){E(a,c);return}a.D[c]=null}Q.error('Unsupported object: "'+a.name+'" or animation uuid: "'+b+'"')};a.qG=function(a,b){var c=da.keysearch("name",
b,va)||da.keysearch("name",b+"_B4W_BAKED",va);if(c){if(c.j.type==P)return!1}else if(!(z(a,b)||ba.is_mesh(a)&&K(a,b)))return!1;return!0};a.get_slot_num_by_anim=function(a,b){for(var c=a.D,d=0;d<c.length;d++){var e=c[d];if(e&&m(e.tg)==m(b))return d}return-1};a.wB=function(a,b){var c=a.D[b];return c&&c.tg?m(c.tg):null};a.remove=function(a){a.D.length=0;a=Ra.indexOf(a);-1!=a&&Ra.splice(a,1)};a.SD=function(a){for(var b=va.length-1;0<=b;b--)va[b].dy==a&&va.splice(b,1)};a.apply_to_first_empty_slot=function(a,
b){if(!a.D.length)return r(a,b,0)?0:-1;for(var c=0;c<a.D.length;c++)if(!a.D[c])return r(a,b,c)?c:-1};a.set_skel_mix_factor=function(a,b,c){a.f.Fn=(b-a.f.jf)/c;a.f.En=b};a.set_speed=function(a,b,c){t(a.D,c,function(a){a.speed=b})};a.get_speed=function(a,b){return a.D[b].speed};a.get_anim_start_frame=function(a,b){return a.D[b].start};a.get_anim_length=function(a,b){return a.D[b].length};a.cleanup=function(){Ra.length=0;va.length=0};a.YA=function(a){var b=(a[0]||a[1]||a[2]).Kc.length,c=sa,d=N,e=Boolean(a[0]);
e||(a[0]={Kc:new Float32Array(b),num_channels:8});var f=Boolean(a[1]);f||(a[1]={Kc:new Float32Array(b),num_channels:8});var g=Boolean(a[2]);g||(a[2]={Kc:new Float32Array(b),num_channels:8});a[3]={Kc:new Float32Array(b),num_channels:8};for(var h=0;h<b;h++)d[0]=e?a[0].Kc[h]:0,d[1]=f?a[1].Kc[h]:0,d[2]=g?a[2].Kc[h]:0,da.euler_to_quat(d,c),a[0].Kc[h]=c[3],a[1].Kc[h]=c[0],a[2].Kc[h]=c[1],a[3].Kc[h]=c[2]};a.pt=H};b4w.module.__time=function(a,p){var e=p("__config");p("__print");p("__util");var b=0,c=0,m=[],f=0,l=0,h=[],t=-1;a.nv=function(a){b=a;c=performance.now();for(a=0;a<m.length;a++){var e=m[a];b>e.Jo&&(m.splice(a,1),a--,e.callback())}for(a=0;a<h.length;a++){var e=h[a],f=1-(e.Jo-b)/e.duration,f=Math.min(f,1);e.callback(e.from+f*(e.to-e.from));1==f&&(h.splice(a,1),a--)}};a.get_timeline=function(){return b};a.set_timeout=function(a,e){var h;f++;h=f;m.push({id:h,callback:a,Jo:b+(performance.now()-c+e)/1E3});
return h};a.clear_timeout=function(a){for(var b=0;b<m.length;b++)if(m[b].id==a){m.splice(b,1);break}};a.clear_animation=function(a){for(var b=h.length;b--;)if(h[b].id==a){h.splice(b,1);break}};a.animate=function(a,c,e,f){e/=1E3;var m;l++;m=l;h.push({id:m,callback:f,from:a,to:c,Jo:b+e,duration:e});f(a);return m};a.reset=function(){c=b=0;m.length=0;l=f=h.length=0};a.Nb=function(){return-1!==e.sg.bm?e.sg.bm:t};a.qE=function(a){t=a}};b4w.module.__transform=function(a,p){function e(a,b){g.ud(a)?y.set_trans(b,g.td(a)):q.copy(b,a.f.i)}function b(a,b){var c=a.f;if(g.ud(a)){y.set_quat(b,c.Ba);var d=g.cm(a),d=y.invert(d,C);y.multiply(d,c.Ba,g.td(a))}else I.copy(b,c.quat)}function c(a,b){g.ud(a)?y.set_quat(b,g.td(a)):I.copy(b,a.f.quat)}function m(a,b){g.ud(a)?y.copy(b,g.td(a)):f(a,b)}function f(a,b){var c=a.f;c.i[0]=b[0];c.i[1]=b[1];c.i[2]=b[2];c.scale=b[3];c.quat[0]=b[4];c.quat[1]=b[5];c.quat[2]=b[6];c.quat[3]=b[7]}function l(a,b){if(g.ud(a))y.copy(g.td(a),
b);else{var c=a.f;y.set_sep(c.i,c.scale,c.quat,b)}return b}function h(a){var b=a.f,c=a.V,e=a.type;"CAMERA"==e&&d.Zq(a);g.LF(a,G);"CAMERA"==e&&d.IF(a);var f=b.i,l=b.scale,m=b.quat;y.set_sep(f,l,m,b.Ba);var q=b.aa;n.fromQuat(m,q);"CAMERA"!=e&&u.iE(q,l,q);q[12]=f[0];q[13]=f[1];q[14]=f[2];n.invert(q,b.Qt);b.Qb&&b.sb&&(t.Un(b.Qb,q,b.sb),t.Wn(b.nd,q,b.Rb),t.Vn(b.kf,b.Ba,b.ug));switch(e){case "SPEAKER":B.UE(a,G);break;case "MESH":if(q=a.ql)y.invert(q.f.Ba,C),y.multiply(C,b.Ba,C),D.set(C[0],C[1],C[2],C[3],
b.Hn),I.set(C[4],C[5],C[6],C[7],b.Gn);break;case "CAMERA":d.JF(a);A.ka()&&(l=A.get_active(),A.di(l)==a&&B.MC(l,f,m,G));break;case "LAMP":k.PF(a)}for(l=0;l<c.length;l++){var p=c[l];if(p.mm){var q=p.na,w=q.j,M=p.S;switch(e){case "LAMP":A.hn(a,q);break;case "CAMERA":A.lE(q);w.ec&&w.ec.enable_csm&&A.qq(q);break;case "MESH":b.Qb&&b.sb&&(b.ad&&A.qq(q),w=p.qf,null!=b.od&&w&&A.bw(w,f));a.D.length&&x.Tp(a)&&x.MF(a,M);break;case "EMPTY":v.cw(a)}p=p.Lf;M=a.Fk;M.length&&p&&(w=p.k,A.ew(p,f,m),F.fw(M,w.mc),d.DE(w,
A.di(q)),u.Yl(w.Od,w.ak))}}c=a.Dd;for(l=0;l<c.length;l++)h(c[l]);a=a.lo;for(l=0;l<a.length;l++)c=a[l],q=c[0],g.EF(q,c[1]);b.Qo=!0}var t=p("__boundings"),d=p("__camera"),g=p("__constraints"),k=p("__lights");p("__mat3");var n=p("__mat4"),x=p("__particles"),I=p("__quat"),A=p("__scenes"),B=p("__sfx"),y=p("__tsr"),v=p("__objects"),F=p("__obj_util"),u=p("__util"),q=p("__vec3"),D=p("__vec4"),w=new Float32Array(3),J=new Float32Array(4);new Float32Array(9);var C=y.create(),M=y.create(),G=0;a.SPACE_WORLD=0;
a.SPACE_LOCAL=1;a.SPACE_PARENT=2;a.update=function(a){G=a};a.set_translation=function(a,b){var c=a.f;if(g.ud(a)){y.set_trans(b,c.Ba);var d=g.cm(a),d=y.invert(d,C);y.multiply(d,c.Ba,g.td(a))}else q.copy(b,c.i)};a.set_translation_rel=e;a.get_translation=function(a,b){q.copy(a.f.i,b);return b};a.get_translation_rel=function(a,b){g.ud(a)?q.copy(y.get_trans_view(g.td(a)),b):q.copy(a.f.i,b);return b};a.set_rotation=b;a.set_rotation_rel=c;a.get_rotation=function(a,b){I.copy(a.f.quat,b);return b};a.get_rotation_rel=
function(a,b){g.ud(a)?I.copy(y.get_quat_view(g.td(a)),b):I.copy(a.f.quat,b);return b};a.set_rotation_euler=function(a,c){var d=u.euler_to_quat(c,J);b(a,d)};a.set_rotation_euler_rel=function(a,b){var d=u.euler_to_quat(b,J);c(a,d)};a.set_scale=function(a,b){var c=a.f;if(g.ud(a)){var c=g.td(a),d=y.get_scale(g.cm(a));y.set_scale(b/d,c)}else c.scale=b};a.set_scale_rel=function(a,b){g.ud(a)?y.set_scale(b,g.td(a)):a.f.scale=b};a.get_scale=function(a){return a.f.scale};a.get_scale_rel=function(a){return g.ud(a)?
y.get_scale(g.td(a)):a.f.scale};a.set_tsr=function(a,b){var c=a.f;if(g.ud(a)){y.set_trans(trans,c.Ba);var d=g.cm(a),d=y.invert(d,C);y.multiply(d,c.Ba,g.td(a))}else f(a,b)};a.set_tsr_rel=m;a.get_tsr=function(a,b){var c=a.f;y.set_sep(c.i,c.scale,c.quat,b);return b};a.get_tsr_rel=l;a.get_object_size=function(a){var b=a.f,c=b.Oh;a=b.scale*(c.max_x-c.min_x);var d=b.scale*(c.max_y-c.min_y),b=b.scale*(c.max_z-c.min_z);return.5*Math.sqrt(a*a+d*d+b*b)};a.get_object_center=function(a,b,c){c||(c=new Float32Array(3));
b?(a=a.f,q.copy(a.Rb.F,c)):(a=a.f,b=a.Oh,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,q.transformMat4(c,a.aa,c));return c};a.move_local=function(a,b,c,d){var f=l(a,C);w[0]=b;w[1]=c;w[2]=d;y.transform_vec3(w,f,w);e(a,w)};a.mq=function(a,b){var c=l(a,C),d=y.set_quat(b,y.identity(M));y.multiply(c,d,d);m(a,d)};a.o=h;a.distance=function(a,b){return q.dist(a.f.i,b.f.i)};a.qD=function(a,b){return q.dist(a.f.i,b)};a.get_object_bounding_box=function(a){return{max_x:a.f.sb.max_x,
min_x:a.f.sb.min_x,max_y:a.f.sb.max_y,min_y:a.f.sb.min_y,max_z:a.f.sb.max_z,min_z:a.f.sb.min_z}}};b4w.module.__tsr=function(a,p){function e(a,b,c,e){e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=b;e[4]=c[0];e[5]=c[1];e[6]=c[2];e[7]=c[3];return e}function b(a,b,c){var e=b[0],f=b[1],h=b[2],l=b[3],m=b[4],p=b[5],t=b[6];b=b[7];var F=a[0]*l,u=a[1]*l,q=a[2]*l;a=b*F+p*q-t*u;var l=b*u+t*F-m*q,D=b*q+m*u-p*F,F=-m*F-p*u-t*q;c[0]=a*b+F*-m+l*-t-D*-p;c[1]=l*b+F*-p+D*-m-a*-t;c[2]=D*b+F*-t+a*-p-l*-m;c[0]+=e;c[1]+=f;c[2]+=h;return c}var c=p("__mat4"),m=p("__quat"),f=p("__util"),l=p("__vec3"),h=new Float32Array(3),t=new Float32Array(4);
new Float32Array(16);a.create=function(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a};a.from_values=function(a,b,c,e,f,h,l,m){var p=new Float32Array(8);p[0]=a;p[1]=b;p[2]=c;p[3]=e;p[4]=f;p[5]=h;p[6]=l;p[7]=m;return p};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b};a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.create_sep=function(a,b,c,f){f||(f=new Float32Array(8));e(a,b,c,f);return f};
a.set_sep=e;a.set_trans=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set_scale=function(a,b){b[3]=a;return b};a.set_transcale=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set_quat=function(a,b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.get_trans_view=function(a){return a.subarray(0,3)};a.get_scale=function(a){return a[3]};a.get_quat_view=function(a){return a.subarray(4)};a.invert=function(a,b){var c=1/a[3];if(!c)return null;var e=a[0],f=a[1],h=a[2];t[0]=a[4];
t[1]=a[5];t[2]=a[6];t[3]=a[7];m.invert(t,t);var l=t[0],p=t[1],y=t[2],v=t[3],e=e*c,f=f*c,F=h*c,h=v*e+p*F-y*f,u=v*f+y*e-l*F,q=v*F+l*f-p*e,e=-l*e-p*f-y*F;b[0]=-(h*v+e*-l+u*-y-q*-p);b[1]=-(u*v+e*-p+q*-l-h*-y);b[2]=-(q*v+e*-y+h*-p-u*-l);b[3]=c;b[4]=l;b[5]=p;b[6]=y;b[7]=v;return b};a.to_mat4=function(a,b){var e=a[3];c.fromRotationTranslation(a.subarray(4),a.subarray(0,3),b);for(var f=0;12>f;f++)b[f]*=e;return b};a.from_mat4=function(a,b){var c=f.pi(a,h),n=f.Gp(a),l=f.matrix_to_quat(a,t);e(c,n,l,b);return b};
a.multiply=function(a,c,e){b(c,a,e);e[3]=a[3]*c[3];var f=a[4],h=a[5],l=a[6];a=a[7];var m=c[4],p=c[5],t=c[6];c=c[7];e[4]=f*c+a*m+h*t-l*p;e[5]=h*c+a*p+l*m-f*t;e[6]=l*c+a*t+f*p-h*m;e[7]=a*c-f*m-h*p-l*t;return e};a.transform_vec3=b;a.transform_vec3_inv=function(a,b,c){var e=b[3],f=a[0]-b[0],h=a[1]-b[1],l=a[2]-b[2];a=b[4];var m=b[5],p=b[6];b=b[7];var t=a*a+m*m+p*p+b*b,t=t?1/t:0;a=-a*t;m=-m*t;p=-p*t;b*=t;var t=b*f+m*l-p*h,F=b*h+p*f-a*l,u=b*l+a*h-m*f,f=-a*f-m*h-p*l;c[0]=t*b+f*-a+F*-p-u*-m;c[1]=F*b+f*-m+
u*-a-t*-p;c[2]=u*b+f*-p+t*-m-F*-a;c[0]/=e;c[1]/=e;c[2]/=e;return c};a.transform_vectors=function(a,b,c,e){e||(e=0);var f=a.length,h=b[0],l=b[1],m=b[2],p=b[3],t=b[4],F=b[5],u=b[6];b=b[7];for(var q=0;q<f;q+=3){var D=a[q]*p,w=a[q+1]*p,J=a[q+2]*p,C=b*D+F*J-u*w,M=b*w+u*D-t*J,G=b*J+t*w-F*D,D=-t*D-F*w-u*J;c[e+q]=C*b+D*-t+M*-u-G*-F;c[e+q+1]=M*b+D*-F+G*-t-C*-u;c[e+q+2]=G*b+D*-u+C*-F-M*-t;c[e+q]+=h;c[e+q+1]+=l;c[e+q+2]+=m}return c};a.transform_dir_vectors=function(a,b,c,e){e||(e=0);var f=a.length,h=b[3],l=
b[4],m=b[5],p=b[6];b=b[7];for(var t=0;t<f;t+=3){var F=a[t]*h,u=a[t+1]*h,q=a[t+2]*h,D=b*F+m*q-p*u,w=b*u+p*F-l*q,J=b*q+l*u-m*F,F=-l*F-m*u-p*q;c[e+t]=D*b+F*-l+w*-p-J*-m;c[e+t+1]=w*b+F*-m+J*-l-D*-p;c[e+t+2]=J*b+F*-p+D*-m-w*-l}return c};a.transform_dir_vec3=function(a,b,c){var e=b[3],f=b[4],h=b[5],l=b[6];b=b[7];var m=a[0]*e,p=a[1]*e,t=a[2]*e;a=b*m+h*t-l*p;var e=b*p+l*m-f*t,F=b*t+f*p-h*m,m=-f*m-h*p-l*t;c[0]=a*b+m*-f+e*-l-F*-h;c[1]=e*b+m*-h+F*-f-a*-l;c[2]=F*b+m*-l+a*-h-e*-f;return c};a.transform_tangents=
function(a,b,c,e){e||(e=0);var f=a.length,h=b[3],l=b[4],m=b[5],p=b[6];b=b[7];for(var t=0;t<f;t+=4){var F=a[t]*h,u=a[t+1]*h,q=a[t+2]*h,D=b*F+m*q-p*u,w=b*u+p*F-l*q,J=b*q+l*u-m*F,F=-l*F-m*u-p*q;c[e+t]=D*b+F*-l+w*-p-J*-m;c[e+t+1]=w*b+F*-m+J*-l-D*-p;c[e+t+2]=J*b+F*-p+D*-m-w*-l;c[e+t+3]=a[t+3]}return c};a.translate=function(a,b,c){var e=a[3],f=a[4],h=a[5],l=a[6],m=a[7],p=b[0]*e,t=b[1]*e,F=b[2]*e;b=m*p+h*F-l*t;var e=m*t+l*p-f*F,u=m*F+f*t-h*p,p=-f*p-h*t-l*F;c[0]=a[0]+b*m+p*-f+e*-l-u*-h;c[1]=a[1]+e*m+p*-h+
u*-f-b*-l;c[2]=a[2]+u*m+p*-l+b*-h-e*-f;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.interpolate=function(a,b,c,e){e||(e=new Float32Array(8));l.lerp(a.subarray(0,3),b.subarray(0,3),c,e.subarray(0,3));var f=a[3];e[3]=f+c*(b[3]-f);m.slerp(a.subarray(4),b.subarray(4),c,e.subarray(4));return e};a.TH=function(a,b,c,e){e||(e=new Float32Array(8));var f=a.subarray(0,3),h=b.subarray(0,3),l=e.subarray(0,3);l[0]=h[0]*(c+1)-f[0]*c;l[1]=h[1]*(c+1)-f[1]*c;l[2]=h[2]*(c+1)-f[2]*c;e[3]=b[3]*(c+1)-
a[3]*c;a=a.subarray(4);b=b.subarray(4);f=e.subarray(4);f[0]=b[0]*(c+1)-a[0]*c;f[1]=b[1]*(c+1)-a[1]*c;f[2]=b[2]*(c+1)-a[2]*c;f[3]=b[3]*(c+1)-a[3]*c;m.normalize(f,f);return e};a.jC=function(a,b,c,e,f){f[0]=a[0]+b*c[0];f[1]=a[1]+b*c[1];f[2]=a[2]+b*c[2];f[3]=a[3];c=e[0];var h=e[1];e=e[2];var l=a[4],m=a[5],p=a[6],t=a[7];f[4]=.5*(c*t+h*p-e*m);f[5]=.5*(h*t+e*l-c*p);f[6]=.5*(e*t+c*m-h*l);f[7]=.5*(-c*l-h*m-e*p);f[4]=a[4]+f[4]*b;f[5]=a[5]+f[5]*b;f[6]=a[6]+f[6]*b;f[7]=a[7]+f[7]*b;a=f[4];b=f[5];c=f[6];h=f[7];
a=a*a+b*b+c*c+h*h;0<a&&(a=1/Math.sqrt(a),f[4]*=a,f[5]*=a,f[6]*=a,f[7]*=a)}};b4w.module.__util=function(a,p){function e(a){return 0<a?1:0>a?-1:0}function b(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=Math.sqrt(b*b+c*c+d*d),f=1/f;a[0]=b*f;a[1]=c*f;a[2]=d*f;a[3]=e*f}function c(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]}function m(a,b){var c=b;switch(typeof a){case "number":return f(a,c);case "string":return l(a,c);case "boolean":return f(a|0,c);case "function":case "undefined":return f(0,c);case "object":if(a){var d=a instanceof Array;if(a.buffer instanceof ArrayBuffer&&"undefined"!==
a.byteLength)for(d=0;d<a.length;d++)c=f(a[d],c);else if(d)for(d=0;d<a.length;d++)c=m(a[d],c);else for(var e in a)c=m(a[e],c)}else c=f(0,c)}return c}function f(a,b){var c=b;H[0]=a;c=(c<<5)-c+V[0];c&=c;c=(c<<5)-c+V[1];return c&c}function l(a,b){for(var c=b,d=0;d<a.length;d++)c=(c<<5)-c+a.charCodeAt(d),c&=c;return c}function h(a){return(34*a+1)*a%289}function t(a){return a-Math.floor(a)}function d(a){return g((34*a+5)*a)}function g(a){return a-289*Math.floor(a/289)}function k(a){return a-7*Math.floor(a/
7)}function n(a,b,c){a-=b;c-=b;return b+(a-Math.floor(a/c)*c)}function x(a){return n(a,0,2*Math.PI)}function I(a,b){if(a&&b){var c=a instanceof Array,d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength,e=b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength;if(c!=b instanceof Array||d!=e)return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!A(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{for(var f in a)if(!A(a[f],
b[f]))return!1;for(f in b)if(!(f in a))return!1}return!0}return!(a||b)}function A(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return I(a,b);default:return!0}}function B(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var e=a[d];""!=e&&"."!=e&&(".."!=e||!b&&!c.length||c.length&&".."==c[c.length-1]?c.push(e):c.length&&c.pop())}a=
c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}var y=p("__mat3"),v=p("__mat4"),F=p("__print"),u=p("__quat"),q=p("__vec3"),D=p("__vec4"),w=0,J={},C=new Float32Array(3),M=new Float32Array(3),G=new Float32Array(4),E=new Float32Array(4),r=new Float32Array(9),K=new Float32Array(16),z=new Float32Array(16),H=new Float64Array(1),V=new Uint32Array(H.buffer),ba=new Float32Array([0,0,0]),X=new Float32Array([0,0,0,1]),fa=new Float32Array([0,0,0,1,0,0,0,1]),Q=new Float32Array([1,1,1]),ha=new Float32Array([1,
0,0]),aa=new Float32Array([0,1,0]),R=new Float32Array([0,0,1]),W=new Float32Array([-1,0,0]),na=new Float32Array([0,-1,0]),ia=new Float32Array([0,0,-1]),da=Math.floor(44488.07041494893),ja=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,
0,0,0,1])];a.Cr=ba;a.Br=X;a.cH=fa;a.Dr=Q;a.AXIS_X=ha;a.AXIS_Y=aa;a.AXIS_Z=R;a.AXIS_MX=W;a.AXIS_MY=na;a.AXIS_MZ=ia;a.Ow=ja;a.keyfind=function(a,b,c){for(var d=[],e=c.length,f=0;f<e;f++){var g=c[f];g[a]==b&&d.push(g)}return d};a.$A=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.uF=function(a,b){var c=a.length,d=new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.rz=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,
!0)};a.Iy=function(a,b){var c=[],d={},e=b.length,f,g;for(f=0;f<e;f++)d[b[f]]=!0;e=a.length;for(f=0;f<e;f++)g=a[f],g in d&&c.push(g);return c};a.sign=e;a.JI=function(a,b,c){for(var d=c.length,e=0;e<d;e++)if(c[e][a]==b)return!0;return!1};a.keysearch=function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];if(e[a]===b)return e}return null};a.II=function(a,b,c,d,e){for(var f=0;f<e.length;f++){var g=e[f];if(g[a]==b&&g[c]==d)return g}return null};a.LB=function(a,b){for(var c=0;c<a.length;c++)if(a[c].uuid==
b)return c;return-1};a.Cy=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.BH=function(a){for(var b=0;b<a.length-1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;return!0};a.qF=function(a,b,c,d){d||(d=new Float32Array(16));v.identity(d);d[12]=a;d[13]=b;d[14]=c};var ga=1;a.PD=function(){ga=(69069*ga+5)%Math.pow(2,32);return Math.round(ga/65536)%32768/32767};a.$E=function(a){ga=a};a.xd=function(a){var b=a[0]%da*48271-3399*Math.floor(a[0]/da);a[0]=0<b?b:b+2147483647;
return(a[0]-1)/2147483646};a.km=function(a,b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));var c=Math.cos(a[1]/2),d=Math.cos(a[2]/2),e=Math.cos(a[0]/2),f=Math.sin(a[1]/2),g=Math.sin(a[2]/2),h=Math.sin(a[0]/2);b[0]=f*g*e+c*d*h;b[1]=f*d*e+c*g*h;b[2]=c*g*e-f*d*h;b[3]=c*d*e-f*g*h;return b};a.OA=function(a){var b=y.create(),c=Math.cos(a[0]),d=Math.cos(a[1]),e=Math.cos(a[2]),f=Math.sin(a[0]),g=Math.sin(a[1]);a=Math.sin(a[2]);var h=c*e,k=c*a,l=f*e,n=
f*a;b[0]=d*e;b[1]=d*a;b[2]=-g;b[3]=g*l-k;b[4]=g*n+h;b[5]=d*f;b[6]=g*h+n;b[7]=g*k-l;b[8]=d*c;return b};a.quat_to_euler=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=e*e,h=c*d+e*f;.499999<h?(b[0]=0,b[1]=2*Math.atan2(c,f),b[2]=Math.PI/2):-.499999>h?(b[0]=0,b[1]=-2*Math.atan2(c,f),b[2]=-Math.PI/2):(b[0]=Math.atan2(2*c*f-2*d*e,1-2*c*c-2*g),b[1]=Math.atan2(2*d*f-2*c*e,1-2*d*d-2*g),b[2]=Math.asin(2*c*d+2*e*f));return b};a.quat_to_dir=function(a,b,c){c||(c=new Float32Array(3));q.transformQuat(b,a,c);return c};
a.OH=function(a,b,c){c||(c=new Float32Array(4));a=q.normalize(a,C);var d=q.dot(b,a);a=q.cross(b,a,M);d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2);return c};a.rF=function(a,b,c,d){d||(d=new Float32Array(4));q.transformQuat(c,b,d);d[3]=-q.dot(a,d)};a.EA=function(a){var b=a.f.quat;switch(a.type){case "CAMERA":C[0]=0;C[1]=-1;C[2]=0;q.transformQuat(C,b,C);M[0]=0;M[1]=0;M[2]=-1;break;case "MESH":C[0]=0;C[1]=0;C[2]=1;q.transformQuat(C,b,C);M[0]=
0;M[1]=0;M[2]=1;break;case "EMPTY":C[0]=0,C[1]=1,C[2]=0,q.transformQuat(C,b,C),M[0]=0,M[1]=1,M[2]=0}C[1]=0;q.normalize(C,C);a=q.dot(C,M);return Math.acos(a)*(0<-C[0]*M[2]?-1:1)};a.cs=function(a,b,c,d){if(0!=c){d=d||[];for(var e=0;e<a.length;e++)d[e]=(1-c)*a[e]+c*b[e]}};a.pJ=function(){w++;return w.toString(16)};a.cj=function(a){J[a]||(J[a]=0);var b=a+J[a];J[a]++;return b};a.Ed=function(){return{a_position:new Float32Array(0),a_tangent:new Float32Array(0),a_normal:new Float32Array(0)}};a.Eb=function(a){var b=
{a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};return{name:a,P:0,ra:null,A:[],M:b,ba:[]}};a.zg=function(a){return JSON.parse(JSON.stringify(a))};a.qa=function(b){if(!(b instanceof Object))return b;var c;c=b.constructor;switch(c){case Float32Array:case Uint32Array:case Uint16Array:c=new c(b);break;case Array:c=new c(b.length);for(var d=0;d<b.length;d++)c[d]=a.qa(b[d]);break;default:for(d in c=new c,b)c[d]=a.qa(b[d])}return c};a.Aj=function(a){var b=a instanceof
Array?[]:{},c;for(c in a)if(a[c]instanceof Object){var d=a[c].constructor;switch(d){case Float32Array:case Uint32Array:case Uint16Array:b[c]=new d(a[c]);break;case Array:b[c]=a[c].slice(0);break;default:b[c]=a[c]}}else b[c]=a[c];return b};a.matrix_to_quat=function(a,b){b||(b=new Float32Array(4));y.fromMat4(a,r);var c=r[0],d=r[3],e=r[6],f=r[1],g=r[4],h=r[7],k=r[2],l=r[5],n=r[8],c=Math.sqrt(c*c+d*d+e*e)||1,f=Math.sqrt(f*f+g*g+h*h)||1,k=Math.sqrt(k*k+l*l+n*n)||1;r[0]/=c;r[3]/=c;r[6]/=c;r[1]/=f;r[4]/=
f;r[7]/=f;r[2]/=k;r[5]/=k;r[8]/=k;u.fromMat3(r,b);return b};a.pi=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.Gp=function(a){G[0]=.577350269189626;G[1]=.577350269189626;G[2]=.577350269189626;G[3]=0;D.transformMat4(G,a,G);return D.length(G)};a.Yl=function(a,c){var d=c.left,e=c.right,f=c.top,g=c.bottom,h=c.ob,k=c.mb;d[0]=a[3]+a[0];d[1]=a[7]+a[4];d[2]=a[11]+a[8];d[3]=a[15]+a[12];e[0]=a[3]-a[0];e[1]=a[7]-a[4];e[2]=a[11]-a[8];e[3]=a[15]-a[12];f[0]=a[3]-a[1];f[1]=
a[7]-a[5];f[2]=a[11]-a[9];f[3]=a[15]-a[13];g[0]=a[3]+a[1];g[1]=a[7]+a[5];g[2]=a[11]+a[9];g[3]=a[15]+a[13];h[0]=a[3]+a[2];h[1]=a[7]+a[6];h[2]=a[11]+a[10];h[3]=a[15]+a[14];k[0]=a[3]-a[2];k[1]=a[7]-a[6];k[2]=a[11]-a[10];k[3]=a[15]-a[14];b(d);b(e);b(f);b(g);b(h);b(k)};a.VE=function(a,b,d){return d<-c(a,b.left)||d<-c(a,b.right)||d<-c(a,b.top)||d<-c(a,b.bottom)||d<-c(a,b.ob)||d<-c(a,b.mb)?!0:!1};a.MA=function(a,b,d,e,f){g=q.dot(d,b.mb);h=q.dot(e,b.mb);k=q.dot(f,b.mb);g=Math.sqrt(g*g+h*h+k*k);if(g<-c(a,
b.ob)||g<-c(a,b.mb))return!0;var g=q.dot(d,b.left),h=q.dot(e,b.left),k=q.dot(f,b.left);if(Math.sqrt(g*g+h*h+k*k)<-c(a,b.left))return!0;g=q.dot(d,b.right);h=q.dot(e,b.right);k=q.dot(f,b.right);if(Math.sqrt(g*g+h*h+k*k)<-c(a,b.right))return!0;g=q.dot(d,b.top);h=q.dot(e,b.top);k=q.dot(f,b.top);if(Math.sqrt(g*g+h*h+k*k)<-c(a,b.top))return!0;g=q.dot(d,b.bottom);h=q.dot(e,b.bottom);k=q.dot(f,b.bottom);return Math.sqrt(g*g+h*h+k*k)<-c(a,b.bottom)?!0:!1};a.Mf=function(a,b,c,d){d||(d=0);for(var e=a.length,
f=0;f<e;f+=3){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*k+b[12];c[d+f+1]=b[1]*g+b[5]*h+b[9]*k+b[13];c[d+f+2]=b[2]*g+b[6]*h+b[10]*k+b[14]}};a.tG=function(a,b,c){for(var d=0,d=0,e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*k;c[d+f+1]=b[1]*g+b[5]*h+b[9]*k;c[d+f+2]=b[2]*g+b[6]*h+b[10]*k}};a.lF=function(a,b,c){for(var d=0,d=0,e=a.length,f=0;f<e;f+=4){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*k;c[d+f+1]=b[1]*g+b[5]*h+b[9]*k;c[d+f+2]=b[2]*g+b[6]*
h+b[10]*k;c[d+f+3]=a[f+3]}};a.rG=function(a,b,c){c||(c=new Float32Array(3));G[0]=a[0];G[1]=a[1];G[2]=a[2];G[3]=0;D.transformMat4(G,b,G);c[0]=G[0];c[1]=G[1];c[2]=G[2]};a.XH=function(a,b){var c=a.length;if(!c)throw"flatten(): Wrong or empty array";var d=a[0].length;if(!d)throw"flatten(): Wrong or empty subarray";b||(b=new Float32Array(c*d));for(var e=0;e<c;e++)for(var f=0;f<d;f++)b[e*d+f]=a[e][f];return b};a.sG=function(a){for(var b=[],c=0;c<a.length;c+=3){var d=new Float32Array([a[c],a[c+1],a[c+2]]);
b[c/3]=d}return b};a.wl=function(b,c,d,e){if(e<d)return d;var f=d+Math.floor((e-d)/2);return b[f]>c?a.wl(b,c,d,f-1):b[f]<c?a.wl(b,c,f+1,e):f};a.of=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0};a.CH=function(a,b,c){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-b[d])>c)return!1;return!0};a.iE=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15]};a.Uq=function(a,b,c,d){d||(d=new Float32Array(16));b=v.fromRotationTranslation(b,
c,K);v.multiply(b,a,d)};a.transform_vec3=function(a,b,c,d,e){e||(e=new Float32Array(3));c=v.fromRotationTranslation(c,d,K);1!==b&&(d=v.identity(z),b=q.set(b,b,b,C),v.scale(d,b,d),v.multiply(c,d,c));q.transformMat4(a,c,e);return e};a.Vq=function(a,b,c,d){d||(d=new Float32Array(4));b=v.fromRotationTranslation(b,c,K);D.transformMat4(a,b,d)};a.BI=function(a,b,c,d,e){e||(e=new Float32Array(3));b=v.fromRotationTranslation(c,d,K);v.invert(b,b);q.transformMat4(a,b,e);return e};a.nJ=function(a,b,c){c||(c=
new Float32Array(16));v.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.TI=function(b,c,d){a.pi(b,c);c[3]=a.Gp(b);a.matrix_to_quat(b,d)};a.jH=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return JSON.stringify(b)};a.dE=function(a,b,c,d){d||(d=new Float32Array(3));q.subtract(b,a,C);q.transformQuat(C,c,C);q.subtract(b,C,d)};a.lB=function(){C[0]=0;C[1]=0;C[2]=0;var a=new Float32Array(16),b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),
f=new Float32Array(16);v.lookAt(C,[-1,0,0],[0,-1,0],a);v.scale(a,[-1,1,1],a);v.scale(a,[-1,1,-1],b);v.lookAt(C,[0,-1,0],[0,0,-1],c);v.scale(c,[1,1,-1],c);v.scale(c,[1,-1,-1],d);v.lookAt(C,[0,0,-1],[0,-1,0],e);v.scale(e,[-1,1,1],e);v.scale(e,[-1,1,-1],f);return[a,b,c,d,e,f]};a.pB=function(){C[0]=0;C[1]=0;C[2]=0;var a=new Float32Array(16),b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16);v.lookAt(C,[1,0,0],[0,-1,0],a);v.scale(a,[-1,1,
-1],b);v.lookAt(C,[0,1,0],[0,0,1],c);v.scale(c,[1,-1,-1],d);v.lookAt(C,[0,0,1],[0,-1,0],e);v.scale(e,[-1,1,-1],f);return[a,b,c,d,e,f]};a.ks=function(a,b){return m(a,b)};a.hash_code=m;a.uI=l;a.SI=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f,g,h,k,l,n,m,q,r,p,t,u;if(!c||a===c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;f=a[0];g=a[1];h=a[2];k=a[3];l=a[4];n=a[5];m=a[6];q=a[7];r=a[8];p=a[9];t=a[10];u=a[11];
c[0]=f;c[1]=g;c[2]=h;c[3]=k;c[4]=l;c[5]=n;c[6]=m;c[7]=q;c[8]=r;c[9]=p;c[10]=t;c[11]=u;c[12]=f*d+l*e+r*b+a[12];c[13]=g*d+n*e+p*b+a[13];c[14]=h*d+m*e+t*b+a[14];c[15]=k*d+q*e+u*b+a[15];return c};a.ZC=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.quat_to_angle_axis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),b[0]=a[0]*
c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.Mm=function(a){return a*Math.PI/180};a.AA=function(a){return 180*a/Math.PI};a.zq=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],c=Math.floor(a[0]+b),d=Math.floor(a[1]+b),e=.211324865405187*c+.211324865405187*d,b=a[0]-c+e;a=a[1]-d+e;var f=b>a?1:0,g=1-f,e=b+.211324865405187-f,k=a+.211324865405187-g,l=b+-.577350269189626,n=a+-.577350269189626,c=c%289,
d=d%289,m=h(h(d)+c),g=h(h(d+g)+c+f),q=h(h(d+1)+c+1),c=Math.max(.5-(b*b+a*a),0),d=Math.max(.5-(e*e+k*k),0),f=Math.max(.5-(l*l+n*n),0),r=2*t(.024390243902439*m)-1,p=2*t(.024390243902439*g)-1,u=2*t(.024390243902439*q)-1,m=Math.abs(r)-.5,g=Math.abs(p)-.5,q=Math.abs(u)-.5,r=r-Math.floor(r+.5),p=p-Math.floor(p+.5),u=u-Math.floor(u+.5),c=c*c*c*c*(1.79284291400159-.85373472095314*(r*r+m*m)),d=d*d*d*d*(1.79284291400159-.85373472095314*(p*p+g*g)),f=f*f*f*f*(1.79284291400159-.85373472095314*(u*u+q*q));return 130*
(c*(r*b+m*a)+d*(p*e+g*k)+f*(u*l+q*n))};a.ps=function(a){var b=1/7,c=b/2,e=g(Math.floor(a[0])),f=g(Math.floor(a[1])),h=t(a[0]);a=t(a[1]);var l=h-.5,n=h-1.5,h=a-.5;a-=1.5;var m=d(e),q=d(e+1),r=m,e=q,m=d(m+f),q=d(q+f),r=d(r+f+1),e=d(e+f+1),f=l+.7*(k(m)*b+c),p=n+.7*(k(q)*b+c),l=l+.7*(k(r)*b+c),n=n+.7*(k(e)*b+c),m=h+.7*(k(Math.floor(m*b))*b+c),h=h+.7*(k(Math.floor(q*b))*b+c),r=a+.7*(k(Math.floor(r*b))*b+c),b=a+.7*(k(Math.floor(e*b))*b+c);return Math.min(f*f+m*m,p*p+h*h,l*l+r*r,n*n+b*b)};a.quat_project=
function(a,b,c,d,e){e||(e=new Float32Array(4));a=q.transformQuat(b,a,C);b=c[0];var f=c[1];c=c[2];r[0]=f*f+c*c;r[1]=-f*b;r[2]=-c*b;r[3]=-b*f;r[4]=b*b+c*c;r[5]=-c*f;r[6]=-b*c;r[7]=-f*c;r[8]=b*b+f*f;q.transformMat3(a,r,a);q.normalize(a,a);u.rotationTo(d,a,e);return e};a.cam_quat_to_mesh_quat=function(a,b){b||(b=new Float32Array(4));var c=G,d=E,c=u.setAxisAngle([0,1,0],Math.PI,u.create()),d=u.setAxisAngle([1,0,0],Math.PI/2,u.create());u.multiply(c,d,c);u.multiply(a,c,b);return b};a.cleanup=function(){w=
0;J={}};a.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};a.smooth=function(a,b,c,d){c=Math.exp(-c/d);return(1-c)*a+c*b};a.smooth_v=function(a,b,c,d,e){e||(e=new Float32Array(a.length));c=Math.exp(-c/d);for(d=0;d<e.length;d++)e[d]=(1-c)*a[d]+c*b[d];return e};a.Cv=function(a,b,c,d,e){e||(e=new Float32Array(a.length));u.slerp(a,b,Math.exp(-c/d),e)};a.CI=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.is_vector=function(a,b){if(a instanceof Array||a.buffer&&
a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.correct_cam_quat_up=function(a,b){var c=y.fromQuat(a,r);M[0]=0;M[1]=1;M[2]=0;C[0]=c[3];C[1]=c[4];C[2]=c[5];var d=q.cross(M,C,C);q.normalize(d,d);var e=c[7];!b&&0<e&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);M[0]=c[0];M[1]=c[1];M[2]=c[2];q.normalize(M,M);u.rotationTo(M,d,E);u.multiply(E,a,a)};a.ot=function(a,b,c,d){c=c*b-.5;var e=d*b-.5;d=c-Math.floor(c);var f=e-Math.floor(e);c=Math.floor(c);var e=Math.floor(e),g=b-1,h=a[e*b+c],k=a[e*b+
Math.min(c+1,g)],l=a[Math.min(e+1,g)*b+c];a=a[Math.min(e+1,g)*b+Math.min(c+1,g)];return(h*(1-d)+k*d)*(1-f)+(l*(1-d)+a*d)*f};a.qh=function(a){for(var b=0,c=0;3>c;c++)0<(a&1<<c)&&b++;return b};a.dv=function(a){for(var b=[0,0,0],c=0;3>c;c++)0<(a&1<<c)&&(b[2-c]=1);return b};a.Gk=function(a,b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.To=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};
a.ek=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.random_from_array=function(a){if(!a.length)return null;var b=Math.floor(Math.random()*a.length);return a[b]};a.xz_direction=function(a,b,c){c||(c=new Float32Array(3));c[0]=a[0]-b[0];c[1]=0;c[2]=a[2]-b[2];q.normalize(c,c)};a.sF=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1],h=b[2];b=b[3];var k=g*a-h*e,l=h*d-f*a,n=f*e-g*d,m=g*n-h*l,h=h*k-f*n,f=f*l-g*k;c[0]=d+2*k*b+2*m;c[1]=e+2*l*b+2*h;c[2]=a+2*n*b+2*f};a.assert=function(a){if(!a)throw Error("Assertion failed");
};a.U=function(a){a&&F.error.apply(F,arguments);throw"panic: see above for possible error messages";};a.angle_wrap_periodic=n;a.angle_wrap_0_2pi=x;a.Yo=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.Nv=function(a,b){for(var c in a){var d=!0,e=a[c],f=b[c];switch(typeof e){case "number":case "string":case "boolean":d=e==f;break;case "object":d=I(e,f)}if(!d)return!1}return!0};a.dq=function(a,b){var c=a[0],d=a[2],e=a[3];b[0]=a[1];b[1]=d;b[2]=e;b[3]=c};a.jt=function(a){a+=1;132651<a&&F.error("Color ID pool depleted");
var b=Math.floor(a/2601);a%=2601;var c=Math.floor(a/51);return new Float32Array([b/51,c/51,a%51/51])};a.line_plane_intersect=function(a,b,c,d,e){G.set(a);G[3]=b;E.set(d);E[3]=0;a=D.dot(G,E);if(0==a)return null;E.set(c);E[3]=1;a=-D.dot(G,E)/a;e[0]=c[0]+a*d[0];e[1]=c[1]+a*d[1];e[2]=c[2]+a*d[2];return e};a.OB=function(a,b,c,d){var e=b[0]-a[0],f=c[0]-a[0],g=b[1]-a[1],h=c[1]-a[1];b=b[2]-a[2];a=c[2]-a[2];d[0]=g*a-b*h;d[1]=f*b-e*a;d[2]=e*h-g*f;return d};a.EH=function(a,b){for(var c=0;c<a.length;c++)b[c]=
a[c];return b};a.fE=function(a,b,c){var d=q.dot(a,b);-.9999999>d?(q.cross(ha,a,C),1E-6>q.length(C)&&q.cross(aa,a,C),q.normalize(C,C),u.setAxisAngle(C,Math.PI,c)):(q.cross(a,b,C),c.set(C),c[3]=1+d,u.normalize(c,c));return c};a.mf=function(a,b,c){if(b==c)return c-a;a=x(a);b=x(b);c=x(c);var d=Math.abs(b-c);if(.001>d||.001>Math.abs(d-2*Math.PI))return 0;b=2*Math.PI-b;c=x(c+b);a=x(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.smooth_step=function(a,b,c){isFinite(b)&&isFinite(c)&&(a=clamp(a,b,c));
return a*a*(3-2*a)};a.lerp=function(a,b,c){return b+a*(c-b)};a.Jy=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(b[d]==a[c])return!0;return!1};a.JH=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=0;return b};a.sw=function(a,b){for(var c=Math.max(a.length,b.length),d=0;d<c;d++){var f=e((d>=a.length?0:a[d])-(d>=b.length?0:b[d]));if(f)return f}return 0};a.dg=function(a){return a.join(".")};a.Lv=function(a){return a.split(".").map(function(a){return a|0})};a.Hv=function(a,b){b[0]=
Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2)};a.Ap=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.rk=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=B(b[1]),b.join("://")):B(a)};a.zj=function(a){return 0!=parseInt(a.toString(2).substr(1),2)}};b4w.module.__sfx=function(a,p){function e(){var a=window.AudioContext||window.webkitAudioContext;if(a){a=new a;if(a.createGain)return a;B.warn("deprecated WebAudio implementation");return null}B.warn("WebAudio is not supported");return null}function b(a,b,d){var e=a.w;if("NONE"!=e.behavior){var g=e.loop,k=e.pitch;if(e.src&&(g||0<=d)){e.Jn=Math.floor(5E4*Math.random());var n=G.currentTime+b;e.bd=n;e.state=20;c(a);"POSITIONAL"==e.behavior||"BACKGROUND_SOUND"==e.behavior?(b=G.createBufferSource(),b.buffer=
e.src,b.playbackRate.value=k,b.onended=function(){e.state=50},g?(e.Hb&&e.Hb.disconnect(),b.loop=!0,b.start(n),e.duration=0):(g=b.buffer?b.buffer.duration:0,d>g?(g=n+d+e.Pc,b.loop=!0,b.start(n),b.stop(g),e.duration=d):(b.loop=!1,b.start(n),e.duration=g)),b.connect(e.Ac),e.Hb=b,f(e),l(e)):"BACKGROUND_MUSIC"==e.behavior&&(y.clear_timeout(e.Nn),y.clear_timeout(e.On),d=function(){var b=a.w,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.Hb=b.Hb||G.createMediaElementSource(c),b.Hb.connect(b.Ac),20==b.state&&(c.currentTime&&
(c.currentTime=0),c.play()))},0==b?d():e.Nn=y.set_timeout(d,1E3*b),e.duration=g?0:I(a));h(e,n)}}}function c(a){var b=a.w;if(!b.Ac){var c=a.f.i;a=a.f.quat;if(q.xm){var d=G.createBiquadFilter();d.type="peaking"}else d=null;var e=G.createGain();switch(b.behavior){case "POSITIONAL":var f=G.createPanner();"string"!=typeof f.panningModel?(f.panningModel=f.EQUALPOWER,f.distanceModel=f.INVERSE_DISTANCE):(f.panningModel="equalpower",f.distanceModel="inverse");f.setPosition(c[0],c[1],c[2]);F.copy(c,b.vp);c=
D;v.quat_to_dir(a,v.AXIS_MY,c);f.setOrientation(c[0],c[1],c[2]);F.copy(c,b.direction);f.refDistance=b.dist_ref;f.maxDistance=b.dist_max;f.rolloffFactor=b.attenuation;f.coneInnerAngle=b.Bs;f.coneOuterAngle=b.Cs;f.coneOuterGain=b.Ds;var g=G.createGain();g.gain.value=x(b);d?(f.connect(d),d.connect(g)):f.connect(g);g.connect(e);b.Ac=f;if(b.Eh){var h=G.createGain();e.connect(h);h.connect(G?E.ga.Ac:null)}else h=null,e.connect(G?E.ga.Ac:null);break;case "BACKGROUND_SOUND":f=null;g=G.createGain();g.gain.value=
x(b);d?(b.Ac=d,d.connect(g)):b.Ac=g;g.connect(e);b.Eh?(h=G.createGain(),e.connect(h),h.connect(G?E.ga.Ac:null)):(h=null,e.connect(G?E.ga.Ac:null));break;case "BACKGROUND_MUSIC":h=f=null,g=G.createGain(),g.gain.value=x(b),d?(b.Ac=d,d.connect(g)):b.Ac=g,g.connect(e),e.connect(G?E.ga.Ac:null)}b.xk=f;b.$d=d;b.bi=g;b.Ig=e;b.Vu=h}}function m(a){var c=a.w,d=c.duration,c=c.delay+c.Rs*Math.random();b(a,c,d)}function f(a){a.Eh&&a.Vu.gain.cancelScheduledValues(a.bd);a.Gi&&a.Hb.playbackRate.cancelScheduledValues(a.bd);
a.Zk=a.bd}function l(a){if(a.Eh||a.Gi){var b=a.Vu,c=a.Hb,d=c.buffer?c.buffer.duration:0;if(d){var e=a.bd;K[0]=a.Jn;for(var f=0;5>f;){var g=a.pitch+a.Gi*v.xd(K);if(e>=a.Zk){if(a.Eh){var h=1-v.clamp(a.Eh,0,1)*Math.random();b.gain.setValueAtTime(h,e)}a.Gi&&c.playbackRate.setValueAtTime(g,e);f++}e+=d/g}a.Zk=e-.001}}}function h(a,b){if(a.Jg||a.Pc){var c=a.Ig;c.gain.cancelScheduledValues(b);a.Jg?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.Jg)):c.gain.setValueAtTime(1,b);a.Pc&&!a.loop&&
(c.gain.setValueAtTime(1,b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.Pc))}}function t(a){if("SPEAKER"!=a.type)throw"Wrong object type";var b=a.w;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.Ig,d=G.currentTime;b.Pc&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.Pc));"BACKGROUND_MUSIC"==b.behavior?b.src&&(y.clear_timeout(b.Nn),y.clear_timeout(b.On),b.On=y.set_timeout(function(){var b=a.w.src;b&&(b.currentTime&&(b.currentTime=0),
b.pause())},1E3*b.Pc)):(c=b.Hb,b.duration<c.buffer.duration?b.Pc&&20==b.state?c.stop(d+b.Pc):20==b.state&&(c.stop(0),c.disconnect()):c.disconnect(),b.bd=0,b.Xp=0,b.Xn=0);b.state=30}}function d(a){a=a.w;if(20==a.state){var b=G.currentTime;a.Xp=b;if("BACKGROUND_MUSIC"==a.behavior){var c=a.src;c&&c.pause()}else{if(b>a.bd){K[0]=a.Jn;for(var d=a.Hb.buffer.duration,e=a.bd;e<b;)c=a.pitch+a.Gi*v.xd(K),e+=d/c;c*=d/c-(e-b)}else c=0;a.Xn=c;a.Hb.stop(0);a.Hb.disconnect();f(a)}a.state=40}}function g(a){var b=
a.w;if(40==b.state){var c=G.currentTime;b.bd+=c-b.Xp;"BACKGROUND_MUSIC"==b.behavior?b.src.play():(k(a),b.Zk=c,a=b.Hb,a.onended=function(){b.state=50},a.start(b.bd,b.Xn),l(b));h(b,b.bd);b.state=20}}function k(a){a=a.w;var b=G.createBufferSource();b.loop=a.Hb.loop;b.buffer=a.Hb.buffer;b.playbackRate.value=a.Hb.playbackRate.value;a.xk?b.connect(a.xk):b.connect(a.bi);a.Hb=b}function n(a){a=a.w;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function x(a){return a.muted?0:a.volume}function I(a){a=
a.w;return(a=a.src)?a.duration:0}var A=p("__config"),B=p("__print"),y=p("__time"),v=p("__util"),F=p("__vec3"),u=A.q,q=A.w;a.rr=10;a.sn=20;a.qr=30;var D=new Float32Array(3),w=new Float32Array(3),J=new Float32Array(3),C=[],M=[],G=null,E=null,r=[],K=[1],z=null;a.eA=function(){return{zh:-1,He:"",behavior:"NONE",Fg:!1,muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1E4,Bs:360,Cs:360,Ds:1,cyclic:!1,loop:!1,delay:0,Rs:0,Eh:0,Gi:0,Jg:0,Pc:0,bd:0,Xp:0,Xn:0,duration:0,Zk:0,Jn:1,src:null,state:10,
vp:new Float32Array(3),direction:new Float32Array(3),Cq:new Float32Array(3),Nn:-1,On:-1,Hg:0}};a.init=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(C.push("ogg"),C.push("ogv")),""!=a.canPlayType("audio/mpeg")&&C.push("mp3"),""!=a.canPlayType("audio/mp4")&&(C.push("mp4"),C.push("m4v")),""!=a.canPlayType("audio/webm")&&C.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&M.push("ogv"),""!=b.canPlayType("video/mp4")&&
M.push("m4v"),""!=b.canPlayType("video/webm")&&M.push("webm"));(G=q.lr?e():null)&&B.log("%cINIT WEBAUDIO: "+G.sampleRate+"Hz","color: #00a")};a.Wr=function(a){var b={Vg:new Float32Array(3),hu:new Float32Array(3),oi:new Float32Array(3)};a.ga=b;if(G){var c=G.createGain(),d=G.createGain();b.bi=c;b.Ig=d;c.connect(d);d.connect(G.destination);if(a.b4w_enable_dynamic_compressor){var d=G.createDynamicsCompressor(),e=a.b4w_dynamic_compressor_settings;d.threshold.value=e.threshold;d.knee.value=e.knee;d.ratio.value=
e.ratio;d.attack.value=e.attack;d.release.value=e.release;d.connect(c);b.Ij=d;b.Ac=d}else b.Ij=null,b.Ac=c;c=G.listener;b.Fg=u.Co;b.Fg||(c.dopplerFactor=a.audio_doppler_factor,c.speedOfSound=a.audio_doppler_speed);b.muted=!1;b.volume=1;b.Hg=0}};a.oE=function(a){E=a};a.detect_audio_container=function(a){a||(a="ogg");return-1<C.indexOf(a)?a:"ogg"==a&&-1<C.indexOf("mp4")?"mp4":"mp3"==a&&-1<C.indexOf("ogg")?"ogg":"mp4"==a&&-1<C.indexOf("ogg")?"ogg":"ogv"==a&&-1<C.indexOf("m4v")?"m4v":"webm"==a&&-1<C.indexOf("m4v")?
"m4v":"m4v"==a&&-1<C.indexOf("webm")?"webm":""};a.detect_video_container=function(a){a||(a="webm");return-1<M.indexOf(a)?a:"ogv"==a&&-1<M.indexOf("m4v")?"m4v":"webm"==a&&-1<M.indexOf("m4v")?"m4v":"m4v"==a&&-1<M.indexOf("webm")?"webm":""};a.wh=function(a,b){var c=a.data,d=b.w;d.zh=a.data.sound.uuid;d.He=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=G?c.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var e;G?(window.MediaElementAudioSourceNode?e=
!0:(B.warn("MediaElementAudioSourceNode not found"),e=!1),e=e?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):e="NONE";d.behavior=e;break;default:throw"Wrong speaker behavior";}c.sound||(d.behavior="NONE");d.Fg=c.b4w_disable_doppler||u.Co;d.muted=c.muted;d.volume=c.volume;d.pitch=c.pitch;d.attenuation=c.attenuation;d.dist_ref=c.distance_reference;d.dist_max=c.distance_max||1E4;d.Bs=c.cone_angle_inner;d.Cs=c.cone_angle_outer;d.Ds=c.cone_volume_outer;d.cyclic=c.b4w_cyclic_play;d.loop=c.b4w_loop;d.delay=c.b4w_delay;
d.Rs=c.b4w_delay_random;d.Eh=c.b4w_volume_random;d.Gi=c.b4w_pitch_random;d.Jg=c.b4w_fade_in;d.Pc=c.b4w_fade_out;r.push(b)};a.Ev=function(b){if("SPEAKER"!=b.type)throw"Wrong object type";switch(b.w.behavior){case "POSITIONAL":return a.sn;case "BACKGROUND_SOUND":return a.sn;case "BACKGROUND_MUSIC":return a.qr;case "NONE":return a.rr;default:throw"Wrong speaker behavior";}};a.XF=function(a,b){var c=a.w;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;
case "NONE":break;default:throw"Wrong speaker behavior";}};a.FD=function(){var a=G.createBufferSource();a.buffer=G.createBuffer(1,22050,22050);a.connect(G.destination);a.start(0)};a.xA=function(a,b,c){G?G.decodeAudioData(a,b,c):c()};a.SE=function(a){t(a);a.w=null;r.splice(r.indexOf(a),1)};a.cleanup=function(){for(var a=0;a<r.length;a++){var b=r[a].w;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():b.Hb&&b.Hb.disconnect()}E&&E.ga&&(a=E.ga,a.Vg[0]=0,a.Vg[1]=0,a.Vg[2]=0,a.oi[0]=0,a.oi[1]=0,a.oi[2]=
0);E=null;r.splice(0);z=null};a.update=function(a){if(G&&0!=r.length){for(var b=0;b<r.length;b++){var c=r[b],d=c.w,e=G.currentTime;!d.loop&&20==d.state&&d.duration&&d.bd+d.duration<e&&(d.state=50);d.cyclic&&50==d.state&&m(c);20==d.state&&3>d.Zk-e&&l(d)}z&&z.Xe.length&&(-1==z.kb||a>z.Mr+z.Us[z.kb])&&(b=z,-1<b.kb&&t(b.Xe[b.kb]),-1==b.kb&&b.random?c=Math.round(Math.random()*(b.Xe.length-1)):b.random?(c=1+Math.round(Math.random()*(b.Xe.length-2)),c=(b.kb+c)%b.Xe.length):c=(b.kb+1)%b.Xe.length,m(b.Xe[c]),
b.kb=c,b.Mr=a)}};a.play=b;a.play_def=m;a.stop=t;a.is_playing=function(a){return 20==a.w.state};a.RE=d;a.TE=g;a.playrate=function(a,b){var c=a.w;c.pitch=b;!n(a)||"POSITIONAL"!=c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.Hb.playbackRate.value=b,f(c),l(c))};a.get_playrate=function(a){return a.w.pitch};a.cyclic=function(a,b){a.w.cyclic=Boolean(b)};a.is_cyclic=function(a){return a.w.cyclic};a.MC=function(a,b,c,d){if(G&&a.ga){var e=D;e[0]=0;e[1]=-1;e[2]=0;F.transformQuat(e,c,e);w[0]=0;w[1]=0;w[2]=-1;
F.transformQuat(w,c,w);c=G.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(e[0],e[1],e[2],w[0],w[1],w[2]);F.copy(e,a.ga.hu);!a.ga.Fg&&d&&(J[0]=(b[0]-a.ga.Vg[0])/d,J[1]=(b[1]-a.ga.Vg[1])/d,J[2]=(b[2]-a.ga.Vg[2])/d,v.smooth_v(J,a.ga.oi,d,.3,J),c.setVelocity(J[0],J[1],J[2]),F.copy(J,a.ga.oi));F.copy(b,a.ga.Vg)}};a.listener_reset_speed=function(a,b){if(G&&E.ga&&!E.ga.Fg){var c=D;b?F.copy(b,c):F.copy(E.ga.hu,c);F.scale(c,a,c);G.listener.setVelocity(c[0],c[1],c[2]);F.copy(c,E.ga.oi)}};a.UE=function(a,
b){var c=a.w;if(n(a)&&"POSITIONAL"==c.behavior){var d=a.f.i,e=c.xk;e.setPosition(d[0],d[1],d[2]);var f=D;v.quat_to_dir(a.f.quat,v.AXIS_MY,f);e.setOrientation(f[0],f[1],f[2]);f=c.vp;!c.Fg&&b&&(w[0]=(d[0]-f[0])/b,w[1]=(d[1]-f[1])/b,w[2]=(d[2]-f[2])/b,v.smooth_v(w,c.Cq,b,.3,w),e.setVelocity(w[0],w[1],w[2]),F.copy(w,c.Cq));F.copy(d,f)}};a.speaker_reset_speed=function(a,b,c){var d=a.w;if(n(a)&&"POSITIONAL"==d.behavior&&!d.Fg){var e=D;c?F.copy(c,e):F.copy(d.direction,e);F.scale(e,b,e);d.xk.setVelocity(e[0],
e[1],e[2]);F.copy(e,d.Cq);F.copy(a.f.i,d.vp)}};a.ap=function(a){return a.w.behavior};a.check_active_speakers=function(){for(var a=0;a<r.length;a++)if(n(r[a]))return!0;return!1};a.yE=function(a){var b=E.ga;b&&(b.volume=a,G&&(b.bi.gain.value=x(b)))};a.NB=function(){var a=E.ga;return a?a.volume:0};a.set_volume=function(a,b){var c=a.w;c.volume=b;n(a)&&(c.bi.gain.value=x(c))};a.get_volume=function(a){return a.w.volume};a.mute=function(a,b){a.w.muted=Boolean(b);n(a)&&(a.w.bi.gain.value=x(a.w))};a.is_muted=
function(a){return a.w.muted};a.lD=function(a){var b=E.ga;b&&(b.muted=Boolean(a),G&&(b.bi.gain.value=x(b)))};a.sC=function(){var a=E.ga;return a?a.muted:!1};a.get_speaker_objects=function(){return r};a.pause=function(){for(var a=0;a<r.length;a++)d(r[a])};a.resume=function(){for(var a=0;a<r.length;a++)g(r[a])};a.set_compressor_params=function(a,b){if(a.ga&&a.ga.Ij){var c=a.ga.Ij;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=b.attack;c.release.value=b.release}};
a.get_compressor_params=function(a){if(!a.ga||!a.ga.Ij)return null;a=a.ga.Ij;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.duck=function(a,b,c){if(n(a)){a=a.w;var d=a.Ig,e=G.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(b,e+c);a.Hg=c}};a.unduck=function(a){if(n(a)){a=a.w;var b=a.Ig,c=G.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Hg);a.Hg=0}};a.IA=
function(a,b){if(G){var c=E.ga,d=c.Ig,e=G.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(a,e+b);c.Hg=b}};a.wF=function(){if(G){var a=E.ga,b=a.Ig,c=G.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Hg);a.Hg=0}};a.apply_playlist=function(a,b,c){z={kb:-1,Mr:0,random:c,Xe:[],Us:[]};for(c=0;c<a.length;c++){var d=a[c],e=I(d);0==e?B.warn("Ignoring speaker with zero duration: "+d.name):(t(d),d.w.cyclic=!1,z.Xe.push(d),z.Us.push(e+b))}};
a.get_duration=I;a.clear_playlist=function(){if(z)for(var a=z.Xe,b=0;b<a.length;b++)t(a[b]);z=null};a.get_positional_params=function(a){return(a=a.w)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.set_positional_params=function(a,b){var c=a.w;if(c&&"POSITIONAL"==c.behavior){c.dist_ref=b.dist_ref;c.dist_max=b.dist_max;c.attenuation=b.attenuation;var d=c.xk;d&&(d.refDistance=c.dist_ref,d.maxDistance=c.dist_max,d.rolloffFactor=c.attenuation)}};a.set_filter_params=
function(a,b){var c=a.w;c&&c.$d&&(c.$d.frequency.value=b.freq,c.$d.Q.value=b.Q,c.$d.gain.value=b.gain)};a.get_filter_params=function(a){return(a=a.w)&&a.$d?{freq:a.$d.frequency.value,Q:a.$d.Q.value,gain:a.$d.gain.value}:null};a.get_filter_freq_response=function(a,b,c,d){a=a.w;if(!a||!a.$d)return null;a.$d.getFrequencyResponse(b,c,d)}};b4w.module.__vec3=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array,e=Math.random;a.create=function(){var a=new p(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var c=new p(3);c[0]=a[0];c[1]=a[1];c[2]=a[2];return c};a.fromValues=function(a,c,e){var f=new p(3);f[0]=a;f[1]=c;f[2]=e;return f};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];return c};a.set=function(a,c,e,f){f[0]=a;f[1]=c;f[2]=e;return f};a.add=function(a,c,e){e[0]=a[0]+c[0];e[1]=a[1]+c[1];e[2]=a[2]+c[2];
return e};a.subtract=function(a,c,e){e[0]=a[0]-c[0];e[1]=a[1]-c[1];e[2]=a[2]-c[2];return e};a.sub=a.subtract;a.multiply=function(a,c,e){e[0]=a[0]*c[0];e[1]=a[1]*c[1];e[2]=a[2]*c[2];return e};a.mul=a.multiply;a.divide=function(a,c,e){e[0]=a[0]/c[0];e[1]=a[1]/c[1];e[2]=a[2]/c[2];return e};a.div=a.divide;a.min=function(a,c,e){e[0]=Math.min(a[0],c[0]);e[1]=Math.min(a[1],c[1]);e[2]=Math.min(a[2],c[2]);return e};a.max=function(a,c,e){e[0]=Math.max(a[0],c[0]);e[1]=Math.max(a[1],c[1]);e[2]=Math.max(a[2],
c[2]);return e};a.scale=function(a,c,e){e[0]=a[0]*c;e[1]=a[1]*c;e[2]=a[2]*c;return e};a.scaleAndAdd=function(a,c,e,f){f[0]=a[0]+c[0]*e;f[1]=a[1]+c[1]*e;f[2]=a[2]+c[2]*e;return f};a.distance=function(a,c){var e=c[0]-a[0],f=c[1]-a[1],l=c[2]-a[2];return Math.sqrt(e*e+f*f+l*l)};a.dist=a.distance;a.squaredDistance=function(a,c){var e=c[0]-a[0],f=c[1]-a[1],l=c[2]-a[2];return e*e+f*f+l*l};a.sqrDist=a.squaredDistance;a.length=function(a){var c=a[0],e=a[1];a=a[2];return Math.sqrt(c*c+e*e+a*a)};a.len=a.length;
a.squaredLength=function(a){var c=a[0],e=a[1];a=a[2];return c*c+e*e+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,c){c[0]=-a[0];c[1]=-a[1];c[2]=-a[2];return c};a.inverse=function(a,c){c[0]=1/a[0];c[1]=1/a[1];c[2]=1/a[2];return c};a.normalize=function(a,c){var e=a[0],f=a[1],l=a[2],e=e*e+f*f+l*l;0<e&&(e=1/Math.sqrt(e),c[0]=a[0]*e,c[1]=a[1]*e,c[2]=a[2]*e);return c};a.dot=function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]};a.cross=function(a,c,e){var f=a[0],l=a[1];a=a[2];var h=c[0],p=c[1];c=c[2];
e[0]=l*c-a*p;e[1]=a*h-f*c;e[2]=f*p-l*h;return e};a.lerp=function(a,c,e,f){var l=a[0],h=a[1];a=a[2];f[0]=l+e*(c[0]-l);f[1]=h+e*(c[1]-h);f[2]=a+e*(c[2]-a);return f};a.random=function(a,c){a=a||1;var m=2*e()*Math.PI,f=2*e()-1,l=Math.sqrt(1-f*f)*a;c[0]=Math.cos(m)*l;c[1]=Math.sin(m)*l;c[2]=f*a;return c};a.transformMat4=function(a,c,e){var f=a[0],l=a[1];a=a[2];var h=c[3]*f+c[7]*l+c[11]*a+c[15],h=h||1;e[0]=(c[0]*f+c[4]*l+c[8]*a+c[12])/h;e[1]=(c[1]*f+c[5]*l+c[9]*a+c[13])/h;e[2]=(c[2]*f+c[6]*l+c[10]*a+c[14])/
h;return e};a.transformMat3=function(a,c,e){var f=a[0],l=a[1];a=a[2];e[0]=f*c[0]+l*c[3]+a*c[6];e[1]=f*c[1]+l*c[4]+a*c[7];e[2]=f*c[2]+l*c[5]+a*c[8];return e};a.transformQuat=function(a,c,e){var f=a[0],l=a[1],h=a[2];a=c[0];var p=c[1],d=c[2];c=c[3];var g=c*f+p*h-d*l,k=c*l+d*f-a*h,n=c*h+a*l-p*f,f=-a*f-p*l-d*h;e[0]=g*c+f*-a+k*-d-n*-p;e[1]=k*c+f*-p+n*-a-g*-d;e[2]=n*c+f*-d+g*-p-k*-a;return e};a.rotateX=function(a,c,e,f){var l=[],h=[];l[0]=a[0]-c[0];l[1]=a[1]-c[1];l[2]=a[2]-c[2];h[0]=l[0];h[1]=l[1]*Math.cos(e)-
l[2]*Math.sin(e);h[2]=l[1]*Math.sin(e)+l[2]*Math.cos(e);f[0]=h[0]+c[0];f[1]=h[1]+c[1];f[2]=h[2]+c[2];return f};a.rotateY=function(a,c,e,f){var l=[],h=[];l[0]=a[0]-c[0];l[1]=a[1]-c[1];l[2]=a[2]-c[2];h[0]=l[2]*Math.sin(e)+l[0]*Math.cos(e);h[1]=l[1];h[2]=l[2]*Math.cos(e)-l[0]*Math.sin(e);f[0]=h[0]+c[0];f[1]=h[1]+c[1];f[2]=h[2]+c[2];return f};a.rotateZ=function(a,c,e,f){var l=[],h=[];l[0]=a[0]-c[0];l[1]=a[1]-c[1];l[2]=a[2]-c[2];h[0]=l[0]*Math.cos(e)-l[1]*Math.sin(e);h[1]=l[0]*Math.sin(e)+l[1]*Math.cos(e);
h[2]=l[2];f[0]=h[0]+c[0];f[1]=h[1]+c[1];f[2]=h[2]+c[2];return f};a.forEach=function(){var b=a.create();return function(a,e,f,l,h,p){e||(e=3);f||(f=0);for(l=l?Math.min(l*e+f,a.length):a.length;f<l;f+=e)b[0]=a[f],b[1]=a[f+1],b[2]=a[f+2],h(b,p,b),a[f]=b[0],a[f+1]=b[1],a[f+2]=b[2];return a}}();a.hH=function(b,c){var e=a.fromValues(b[0],b[1],b[2]),f=a.fromValues(c[0],c[1],c[2]);a.normalize(e,e);a.normalize(f,f);e=a.dot(e,f);return 1<e?0:Math.acos(e)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+
a[2]+")"};"undefined"!==typeof a&&(a.vec3=a)};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array,e=Math.random;a.create=function(){var a=new p(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var c=new p(4);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c};a.fromValues=function(a,c,e,f){var l=new p(4);l[0]=a;l[1]=c;l[2]=e;l[3]=f;return l};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c};a.set=function(a,c,e,f,l){l[0]=a;l[1]=c;l[2]=e;l[3]=f;return l};a.add=function(a,c,e){e[0]=
a[0]+c[0];e[1]=a[1]+c[1];e[2]=a[2]+c[2];e[3]=a[3]+c[3];return e};a.subtract=function(a,c,e){e[0]=a[0]-c[0];e[1]=a[1]-c[1];e[2]=a[2]-c[2];e[3]=a[3]-c[3];return e};a.sub=a.subtract;a.multiply=function(a,c,e){e[0]=a[0]*c[0];e[1]=a[1]*c[1];e[2]=a[2]*c[2];e[3]=a[3]*c[3];return e};a.mul=a.multiply;a.divide=function(a,c,e){e[0]=a[0]/c[0];e[1]=a[1]/c[1];e[2]=a[2]/c[2];e[3]=a[3]/c[3];return e};a.div=a.divide;a.min=function(a,c,e){e[0]=Math.min(a[0],c[0]);e[1]=Math.min(a[1],c[1]);e[2]=Math.min(a[2],c[2]);e[3]=
Math.min(a[3],c[3]);return e};a.max=function(a,c,e){e[0]=Math.max(a[0],c[0]);e[1]=Math.max(a[1],c[1]);e[2]=Math.max(a[2],c[2]);e[3]=Math.max(a[3],c[3]);return e};a.scale=function(a,c,e){e[0]=a[0]*c;e[1]=a[1]*c;e[2]=a[2]*c;e[3]=a[3]*c;return e};a.scaleAndAdd=function(a,c,e,f){f[0]=a[0]+c[0]*e;f[1]=a[1]+c[1]*e;f[2]=a[2]+c[2]*e;f[3]=a[3]+c[3]*e;return f};a.distance=function(a,c){var e=c[0]-a[0],f=c[1]-a[1],l=c[2]-a[2],h=c[3]-a[3];return Math.sqrt(e*e+f*f+l*l+h*h)};a.dist=a.distance;a.squaredDistance=
function(a,c){var e=c[0]-a[0],f=c[1]-a[1],l=c[2]-a[2],h=c[3]-a[3];return e*e+f*f+l*l+h*h};a.sqrDist=a.squaredDistance;a.length=function(a){var c=a[0],e=a[1],f=a[2];a=a[3];return Math.sqrt(c*c+e*e+f*f+a*a)};a.len=a.length;a.squaredLength=function(a){var c=a[0],e=a[1],f=a[2];a=a[3];return c*c+e*e+f*f+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,c){c[0]=-a[0];c[1]=-a[1];c[2]=-a[2];c[3]=-a[3];return c};a.inverse=function(a,c){c[0]=1/a[0];c[1]=1/a[1];c[2]=1/a[2];c[3]=1/a[3];return c};a.normalize=
function(a,c){var e=a[0],f=a[1],l=a[2],h=a[3],e=e*e+f*f+l*l+h*h;0<e&&(e=1/Math.sqrt(e),c[0]=a[0]*e,c[1]=a[1]*e,c[2]=a[2]*e,c[3]=a[3]*e);return c};a.dot=function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]+a[3]*c[3]};a.lerp=function(a,c,e,f){var l=a[0],h=a[1],p=a[2];a=a[3];f[0]=l+e*(c[0]-l);f[1]=h+e*(c[1]-h);f[2]=p+e*(c[2]-p);f[3]=a+e*(c[3]-a);return f};a.random=function(b,c){b=b||1;c[0]=e();c[1]=e();c[2]=e();c[3]=e();a.normalize(c,c);a.scale(c,b,c);return c};a.transformMat4=function(a,c,e){var f=a[0],
l=a[1],h=a[2];a=a[3];e[0]=c[0]*f+c[4]*l+c[8]*h+c[12]*a;e[1]=c[1]*f+c[5]*l+c[9]*h+c[13]*a;e[2]=c[2]*f+c[6]*l+c[10]*h+c[14]*a;e[3]=c[3]*f+c[7]*l+c[11]*h+c[15]*a;return e};a.transformQuat=function(a,c,e){var f=a[0],l=a[1],h=a[2],p=c[0],d=c[1],g=c[2];c=c[3];var k=c*f+d*h-g*l,n=c*l+g*f-p*h,x=c*h+p*l-d*f,f=-p*f-d*l-g*h;e[0]=k*c+f*-p+n*-g-x*-d;e[1]=n*c+f*-d+x*-p-k*-g;e[2]=x*c+f*-g+k*-d-n*-p;e[3]=a[3];return e};a.forEach=function(){var b=a.create();return function(a,e,f,l,h,p){e||(e=4);f||(f=0);for(l=l?Math.min(l*
e+f,a.length):a.length;f<l;f+=e)b[0]=a[f],b[1]=a[f+1],b[2]=a[f+2],b[3]=a[f+3],h(b,p,b),a[f]=b[0],a[f+1]=b[1],a[f+2]=b[2],a[f+3]=b[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.vec4=a)};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,p){var e=p("__vec3"),b=p("__vec4"),c=p("__mat3"),m="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new m(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=e.create(),c=e.fromValues(1,0,0),h=e.fromValues(0,1,0);return function(m,d,g){var k=e.dot(m,d);if(-.9999999>k)return e.cross(c,m,b),1E-6>e.length(b)&&e.cross(h,m,b),e.normalize(b,b),a.setAxisAngle(b,Math.PI,g),g;if(.9999999<k)return g[0]=0,g[1]=0,g[2]=0,g[3]=1,g;e.cross(m,
d,b);g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=1+k;return a.normalize(g,g)}}();a.setAxes=function(){var b=c.create();return function(c,e,m,d){b[0]=e[0];b[3]=e[1];b[6]=e[2];b[1]=m[0];b[4]=m[1];b[7]=m[2];b[2]=-c[0];b[5]=-c[1];b[8]=-c[2];return a.normalize(a.fromMat3(b,d),d)}}();a.clone=b.clone;a.fromValues=b.fromValues;a.copy=b.copy;a.set=b.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,c){b*=.5;var e=Math.sin(b);c[0]=e*a[0];c[1]=e*a[1];c[2]=e*a[2];c[3]=Math.cos(b);
return c};a.add=b.add;a.multiply=function(a,b,c){var e=a[0],d=a[1],g=a[2];a=a[3];var k=b[0],n=b[1],m=b[2];b=b[3];c[0]=e*b+a*k+d*m-g*n;c[1]=d*b+a*n+g*k-e*m;c[2]=g*b+a*m+e*n-d*k;c[3]=a*b-e*k-d*n-g*m;return c};a.mul=a.multiply;a.scale=b.scale;a.rotateX=function(a,b,c){b*=.5;var e=a[0],d=a[1],g=a[2];a=a[3];var k=Math.sin(b);b=Math.cos(b);c[0]=e*b+a*k;c[1]=d*b+g*k;c[2]=g*b-d*k;c[3]=a*b-e*k;return c};a.rotateY=function(a,b,c){b*=.5;var e=a[0],d=a[1],g=a[2];a=a[3];var k=Math.sin(b);b=Math.cos(b);c[0]=e*
b-g*k;c[1]=d*b+a*k;c[2]=g*b+e*k;c[3]=a*b-d*k;return c};a.rotateZ=function(a,b,c){b*=.5;var e=a[0],d=a[1],g=a[2];a=a[3];var k=Math.sin(b);b=Math.cos(b);c[0]=e*b+d*k;c[1]=d*b-e*k;c[2]=g*b+a*k;c[3]=a*b-g*k;return c};a.calculateW=function(a,b){var c=a[0],e=a[1],d=a[2];b[0]=c;b[1]=e;b[2]=d;b[3]=Math.sqrt(Math.abs(1-c*c-e*e-d*d));return b};a.dot=b.dot;a.lerp=b.lerp;a.slerp=function(a,b,c,e){var d=a[0],g=a[1],k=a[2];a=a[3];var n=b[0],m=b[1],p=b[2];b=b[3];var A,B,y;B=d*n+g*m+k*p+a*b;0>B&&(B=-B,n=-n,m=-m,
p=-p,b=-b);1E-6<1-B?(A=Math.acos(B),y=Math.sin(A),B=Math.sin((1-c)*A)/y,c=Math.sin(c*A)/y):B=1-c;e[0]=B*d+c*n;e[1]=B*g+c*m;e[2]=B*k+c*p;e[3]=B*a+c*b;return e};a.invert=function(a,b){var c=a[0],e=a[1],d=a[2],g=a[3],k=c*c+e*e+d*d+g*g,k=k?1/k:0;b[0]=-c*k;b[1]=-e*k;b[2]=-d*k;b[3]=g*k;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};a.length=b.length;a.len=a.length;a.squaredLength=b.squaredLength;a.sqrLen=a.squaredLength;a.normalize=b.normalize;a.fromMat3=function(a,
b){var c=a[0]+a[4]+a[8];if(0<c)c=Math.sqrt(c+1),b[3]=.5*c,c=.5/c,b[0]=(a[5]-a[7])*c,b[1]=(a[6]-a[2])*c,b[2]=(a[1]-a[3])*c;else{var e=0;a[4]>a[0]&&(e=1);a[8]>a[3*e+e]&&(e=2);var d=(e+1)%3,g=(e+2)%3,c=Math.sqrt(a[3*e+e]-a[3*d+d]-a[3*g+g]+1);b[e]=.5*c;c=.5/c;b[3]=(a[3*d+g]-a[3*g+d])*c;b[d]=(a[3*d+e]+a[3*e+d])*c;b[g]=(a[3*g+e]+a[3*e+g])*c}return b};a.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.quat=a)};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new p(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};a.clone=function(a){var b=new p(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=
a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,b){if(b===a){var c=a[1],m=a[2],f=a[5];b[1]=a[3];b[2]=a[6];b[3]=c;b[5]=a[7];b[6]=m;b[7]=f}else b[0]=a[0],b[1]=a[3],b[2]=a[6],b[3]=a[1],b[4]=a[4],b[5]=a[7],b[6]=a[2],b[7]=a[5],b[8]=a[8];return b};a.invert=function(a,b){var c=a[0],m=a[1],f=a[2],l=a[3],h=a[4],p=a[5],d=a[6],g=a[7],k=a[8],n=k*h-p*g,x=-k*l+p*d,I=
g*l-h*d,A=c*n+m*x+f*I;if(!A)return null;A=1/A;b[0]=n*A;b[1]=(-k*m+f*g)*A;b[2]=(p*m-f*h)*A;b[3]=x*A;b[4]=(k*c-f*d)*A;b[5]=(-p*c+f*l)*A;b[6]=I*A;b[7]=(-g*c+m*d)*A;b[8]=(h*c-m*l)*A;return b};a.adjoint=function(a,b){var c=a[0],m=a[1],f=a[2],l=a[3],h=a[4],p=a[5],d=a[6],g=a[7],k=a[8];b[0]=h*k-p*g;b[1]=f*g-m*k;b[2]=m*p-f*h;b[3]=p*d-l*k;b[4]=c*k-f*d;b[5]=f*l-c*p;b[6]=l*g-h*d;b[7]=m*d-c*g;b[8]=c*h-m*l;return b};a.determinant=function(a){var b=a[3],c=a[4],m=a[5],f=a[6],l=a[7],h=a[8];return a[0]*(h*c-m*l)+a[1]*
(-h*b+m*f)+a[2]*(l*b-c*f)};a.multiply=function(a,b,c){var m=a[0],f=a[1],l=a[2],h=a[3],p=a[4],d=a[5],g=a[6],k=a[7];a=a[8];var n=b[0],x=b[1],I=b[2],A=b[3],B=b[4],y=b[5],v=b[6],F=b[7];b=b[8];c[0]=n*m+x*h+I*g;c[1]=n*f+x*p+I*k;c[2]=n*l+x*d+I*a;c[3]=A*m+B*h+y*g;c[4]=A*f+B*p+y*k;c[5]=A*l+B*d+y*a;c[6]=v*m+F*h+b*g;c[7]=v*f+F*p+b*k;c[8]=v*l+F*d+b*a;return c};a.mul=a.multiply;a.translate=function(a,b,c){var m=a[0],f=a[1],l=a[2],h=a[3],p=a[4],d=a[5],g=a[6],k=a[7];a=a[8];var n=b[0];b=b[1];c[0]=m;c[1]=f;c[2]=l;
c[3]=h;c[4]=p;c[5]=d;c[6]=n*m+b*h+g;c[7]=n*f+b*p+k;c[8]=n*l+b*d+a;return c};a.rotate=function(a,b,c){var m=a[0],f=a[1],l=a[2],h=a[3],p=a[4],d=a[5],g=a[6],k=a[7];a=a[8];var n=Math.sin(b);b=Math.cos(b);c[0]=b*m+n*h;c[1]=b*f+n*p;c[2]=b*l+n*d;c[3]=b*h-n*m;c[4]=b*p-n*f;c[5]=b*d-n*l;c[6]=g;c[7]=k;c[8]=a;return c};a.scale=function(a,b,c){var m=b[0];b=b[1];c[0]=m*a[0];c[1]=m*a[1];c[2]=m*a[2];c[3]=b*a[3];c[4]=b*a[4];c[5]=b*a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.fB=function(a,b){b[0]=1;b[1]=0;b[2]=
0;b[3]=0;b[4]=1;b[5]=0;b[6]=a[0];b[7]=a[1];b[8]=1;return b};a.dB=function(a,b){var c=Math.sin(a),m=Math.cos(a);b[0]=m;b[1]=c;b[2]=0;b[3]=-c;b[4]=m;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};a.eB=function(a,b){b[0]=a[0];b[1]=0;b[2]=0;b[3]=0;b[4]=a[1];b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};a.fromMat2d=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=0;b[3]=a[2];b[4]=a[3];b[5]=0;b[6]=a[4];b[7]=a[5];b[8]=1;return b};a.fromQuat=function(a,b){var c=a[0],m=a[1],f=a[2],l=a[3],h=c+c,p=m+m,d=f+f,c=c*h,g=m*h,m=m*p,k=f*h,n=
f*p,f=f*d,h=l*h,p=l*p,l=l*d;b[0]=1-m-f;b[3]=g-l;b[6]=k+p;b[1]=g+l;b[4]=1-c-f;b[7]=n-h;b[2]=k-p;b[5]=n+h;b[8]=1-c-m;return b};a.normalFromMat4=function(a,b){var c=a[0],m=a[1],f=a[2],l=a[3],h=a[4],p=a[5],d=a[6],g=a[7],k=a[8],n=a[9],x=a[10],I=a[11],A=a[12],B=a[13],y=a[14],v=a[15],F=c*p-m*h,u=c*d-f*h,q=c*g-l*h,D=m*d-f*p,w=m*g-l*p,J=f*g-l*d,C=k*B-n*A,M=k*y-x*A,k=k*v-I*A,G=n*y-x*B,n=n*v-I*B,x=x*v-I*y,I=F*x-u*n+q*G+D*k-w*M+J*C;if(!I)return null;I=1/I;b[0]=(p*x-d*n+g*G)*I;b[1]=(d*k-h*x-g*M)*I;b[2]=(h*n-p*
k+g*C)*I;b[3]=(f*n-m*x-l*G)*I;b[4]=(c*x-f*k+l*M)*I;b[5]=(m*k-c*n-l*C)*I;b[6]=(B*J-y*w+v*D)*I;b[7]=(y*q-A*J-v*u)*I;b[8]=(A*w-B*q+v*F)*I;return b};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.cB=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof a&&(a.mat3=a)};
b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new p(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var b=new p(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.copy=function(a,b){b[0]=a[0];
b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,b){if(b===a){var c=a[1],m=a[2],f=a[3],l=a[6],h=a[7],p=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=m;b[9]=l;b[11]=a[14];b[12]=f;b[13]=
h;b[14]=p}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};a.invert=function(a,b){var c=a[0],m=a[1],f=a[2],l=a[3],h=a[4],p=a[5],d=a[6],g=a[7],k=a[8],n=a[9],x=a[10],I=a[11],A=a[12],B=a[13],y=a[14],v=a[15],F=c*p-m*h,u=c*d-f*h,q=c*g-l*h,D=m*d-f*p,w=m*g-l*p,J=f*g-l*d,C=k*B-n*A,M=k*y-x*A,G=k*v-I*A,E=n*y-x*B,r=n*v-I*B,K=x*v-I*y,z=F*K-u*r+q*E+D*G-w*M+J*C;if(!z)return null;
z=1/z;b[0]=(p*K-d*r+g*E)*z;b[1]=(f*r-m*K-l*E)*z;b[2]=(B*J-y*w+v*D)*z;b[3]=(x*w-n*J-I*D)*z;b[4]=(d*G-h*K-g*M)*z;b[5]=(c*K-f*G+l*M)*z;b[6]=(y*q-A*J-v*u)*z;b[7]=(k*J-x*q+I*u)*z;b[8]=(h*r-p*G+g*C)*z;b[9]=(m*G-c*r-l*C)*z;b[10]=(A*w-B*q+v*F)*z;b[11]=(n*q-k*w-I*F)*z;b[12]=(p*M-h*E-d*C)*z;b[13]=(c*E-m*M+f*C)*z;b[14]=(B*u-A*D-y*F)*z;b[15]=(k*D-n*u+x*F)*z;return b};a.adjoint=function(a,b){var c=a[0],m=a[1],f=a[2],l=a[3],h=a[4],p=a[5],d=a[6],g=a[7],k=a[8],n=a[9],x=a[10],I=a[11],A=a[12],B=a[13],y=a[14],v=a[15];
b[0]=p*(x*v-I*y)-n*(d*v-g*y)+B*(d*I-g*x);b[1]=-(m*(x*v-I*y)-n*(f*v-l*y)+B*(f*I-l*x));b[2]=m*(d*v-g*y)-p*(f*v-l*y)+B*(f*g-l*d);b[3]=-(m*(d*I-g*x)-p*(f*I-l*x)+n*(f*g-l*d));b[4]=-(h*(x*v-I*y)-k*(d*v-g*y)+A*(d*I-g*x));b[5]=c*(x*v-I*y)-k*(f*v-l*y)+A*(f*I-l*x);b[6]=-(c*(d*v-g*y)-h*(f*v-l*y)+A*(f*g-l*d));b[7]=c*(d*I-g*x)-h*(f*I-l*x)+k*(f*g-l*d);b[8]=h*(n*v-I*B)-k*(p*v-g*B)+A*(p*I-g*n);b[9]=-(c*(n*v-I*B)-k*(m*v-l*B)+A*(m*I-l*n));b[10]=c*(p*v-g*B)-h*(m*v-l*B)+A*(m*g-l*p);b[11]=-(c*(p*I-g*n)-h*(m*I-l*n)+k*
(m*g-l*p));b[12]=-(h*(n*y-x*B)-k*(p*y-d*B)+A*(p*x-d*n));b[13]=c*(n*y-x*B)-k*(m*y-f*B)+A*(m*x-f*n);b[14]=-(c*(p*y-d*B)-h*(m*y-f*B)+A*(m*d-f*p));b[15]=c*(p*x-d*n)-h*(m*x-f*n)+k*(m*d-f*p);return b};a.determinant=function(a){var b=a[0],c=a[1],m=a[2],f=a[3],l=a[4],h=a[5],p=a[6],d=a[7],g=a[8],k=a[9],n=a[10],x=a[11],I=a[12],A=a[13],B=a[14];a=a[15];return(b*h-c*l)*(n*a-x*B)-(b*p-m*l)*(k*a-x*A)+(b*d-f*l)*(k*B-n*A)+(c*p-m*h)*(g*a-x*I)-(c*d-f*h)*(g*B-n*I)+(m*d-f*p)*(g*A-k*I)};a.multiply=function(a,b,c){var m=
a[0],f=a[1],l=a[2],h=a[3],p=a[4],d=a[5],g=a[6],k=a[7],n=a[8],x=a[9],I=a[10],A=a[11],B=a[12],y=a[13],v=a[14];a=a[15];var F=b[0],u=b[1],q=b[2],D=b[3];c[0]=F*m+u*p+q*n+D*B;c[1]=F*f+u*d+q*x+D*y;c[2]=F*l+u*g+q*I+D*v;c[3]=F*h+u*k+q*A+D*a;F=b[4];u=b[5];q=b[6];D=b[7];c[4]=F*m+u*p+q*n+D*B;c[5]=F*f+u*d+q*x+D*y;c[6]=F*l+u*g+q*I+D*v;c[7]=F*h+u*k+q*A+D*a;F=b[8];u=b[9];q=b[10];D=b[11];c[8]=F*m+u*p+q*n+D*B;c[9]=F*f+u*d+q*x+D*y;c[10]=F*l+u*g+q*I+D*v;c[11]=F*h+u*k+q*A+D*a;F=b[12];u=b[13];q=b[14];D=b[15];c[12]=F*m+
u*p+q*n+D*B;c[13]=F*f+u*d+q*x+D*y;c[14]=F*l+u*g+q*I+D*v;c[15]=F*h+u*k+q*A+D*a;return c};a.mul=a.multiply;a.translate=function(a,b,c){var m=b[0],f=b[1];b=b[2];var l,h,p,d,g,k,n,x,I,A,B,y;a===c?(c[12]=a[0]*m+a[4]*f+a[8]*b+a[12],c[13]=a[1]*m+a[5]*f+a[9]*b+a[13],c[14]=a[2]*m+a[6]*f+a[10]*b+a[14],c[15]=a[3]*m+a[7]*f+a[11]*b+a[15]):(l=a[0],h=a[1],p=a[2],d=a[3],g=a[4],k=a[5],n=a[6],x=a[7],I=a[8],A=a[9],B=a[10],y=a[11],c[0]=l,c[1]=h,c[2]=p,c[3]=d,c[4]=g,c[5]=k,c[6]=n,c[7]=x,c[8]=I,c[9]=A,c[10]=B,c[11]=y,
c[12]=l*m+g*f+I*b+a[12],c[13]=h*m+k*f+A*b+a[13],c[14]=p*m+n*f+B*b+a[14],c[15]=d*m+x*f+y*b+a[15]);return c};a.scale=function(a,b,c){var m=b[0],f=b[1];b=b[2];c[0]=a[0]*m;c[1]=a[1]*m;c[2]=a[2]*m;c[3]=a[3]*m;c[4]=a[4]*f;c[5]=a[5]*f;c[6]=a[6]*f;c[7]=a[7]*f;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.rotate=function(a,b,c,m){var f=c[0],l=c[1];c=c[2];var h=Math.sqrt(f*f+l*l+c*c),p,d,g,k,n,x,I,A,B,y,v,F,u,q,D,w,J,C,M,G;if(1E-7>Math.abs(h))return null;
h=1/h;f*=h;l*=h;c*=h;p=Math.sin(b);d=Math.cos(b);g=1-d;b=a[0];h=a[1];k=a[2];n=a[3];x=a[4];I=a[5];A=a[6];B=a[7];y=a[8];v=a[9];F=a[10];u=a[11];q=f*f*g+d;D=l*f*g+c*p;w=c*f*g-l*p;J=f*l*g-c*p;C=l*l*g+d;M=c*l*g+f*p;G=f*c*g+l*p;f=l*c*g-f*p;l=c*c*g+d;m[0]=b*q+x*D+y*w;m[1]=h*q+I*D+v*w;m[2]=k*q+A*D+F*w;m[3]=n*q+B*D+u*w;m[4]=b*J+x*C+y*M;m[5]=h*J+I*C+v*M;m[6]=k*J+A*C+F*M;m[7]=n*J+B*C+u*M;m[8]=b*G+x*f+y*l;m[9]=h*G+I*f+v*l;m[10]=k*G+A*f+F*l;m[11]=n*G+B*f+u*l;a!==m&&(m[12]=a[12],m[13]=a[13],m[14]=a[14],m[15]=a[15]);
return m};a.rotateX=function(a,b,c){var m=Math.sin(b);b=Math.cos(b);var f=a[4],l=a[5],h=a[6],p=a[7],d=a[8],g=a[9],k=a[10],n=a[11];a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[4]=f*b+d*m;c[5]=l*b+g*m;c[6]=h*b+k*m;c[7]=p*b+n*m;c[8]=d*b-f*m;c[9]=g*b-l*m;c[10]=k*b-h*m;c[11]=n*b-p*m;return c};a.rotateY=function(a,b,c){var m=Math.sin(b);b=Math.cos(b);var f=a[0],l=a[1],h=a[2],p=a[3],d=a[8],g=a[9],k=a[10],n=a[11];a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],
c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[0]=f*b-d*m;c[1]=l*b-g*m;c[2]=h*b-k*m;c[3]=p*b-n*m;c[8]=f*m+d*b;c[9]=l*m+g*b;c[10]=h*m+k*b;c[11]=p*m+n*b;return c};a.rotateZ=function(a,b,c){var m=Math.sin(b);b=Math.cos(b);var f=a[0],l=a[1],h=a[2],p=a[3],d=a[4],g=a[5],k=a[6],n=a[7];a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[0]=f*b+d*m;c[1]=l*b+g*m;c[2]=h*b+k*m;c[3]=p*b+n*m;c[4]=d*b-f*m;c[5]=g*b-l*m;c[6]=k*b-h*m;c[7]=n*b-p*m;return c};
a.fB=function(a,b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=a[0];b[13]=a[1];b[14]=a[2];b[15]=1;return b};a.eB=function(a,b){b[0]=a[0];b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=a[1];b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=a[2];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.dB=function(a,b,c){var m=b[0],f=b[1];b=b[2];var l=Math.sqrt(m*m+f*f+b*b),h;if(1E-7>Math.abs(l))return null;l=1/l;m*=l;f*=l;b*=l;l=Math.sin(a);a=Math.cos(a);h=1-a;c[0]=m*m*h+a;c[1]=f*m*h+b*
l;c[2]=b*m*h-f*l;c[3]=0;c[4]=m*f*h-b*l;c[5]=f*f*h+a;c[6]=b*f*h+m*l;c[7]=0;c[8]=m*b*h+f*l;c[9]=f*b*h-m*l;c[10]=b*b*h+a;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.ZH=function(a,b){var c=Math.sin(a),m=Math.cos(a);b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=m;b[6]=c;b[7]=0;b[8]=0;b[9]=-c;b[10]=m;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.$H=function(a,b){var c=Math.sin(a),m=Math.cos(a);b[0]=m;b[1]=0;b[2]=-c;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=c;b[9]=0;b[10]=m;b[11]=0;b[12]=0;b[13]=0;
b[14]=0;b[15]=1;return b};a.aI=function(a,b){var c=Math.sin(a),m=Math.cos(a);b[0]=m;b[1]=c;b[2]=0;b[3]=0;b[4]=-c;b[5]=m;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.fromRotationTranslation=function(a,b,c){var m=a[0],f=a[1],l=a[2],h=a[3],p=m+m,d=f+f,g=l+l;a=m*p;var k=m*d,m=m*g,n=f*d,f=f*g,l=l*g,p=h*p,d=h*d,h=h*g;c[0]=1-(n+l);c[1]=k+h;c[2]=m-d;c[3]=0;c[4]=k-h;c[5]=1-(a+l);c[6]=f+p;c[7]=0;c[8]=m+d;c[9]=f-p;c[10]=1-(a+n);c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];
c[15]=1;return c};a.fromQuat=function(a,b){var c=a[0],m=a[1],f=a[2],l=a[3],h=c+c,p=m+m,d=f+f,c=c*h,g=m*h,m=m*p,k=f*h,n=f*p,f=f*d,h=l*h,p=l*p,l=l*d;b[0]=1-m-f;b[1]=g+l;b[2]=k-p;b[3]=0;b[4]=g-l;b[5]=1-c-f;b[6]=n+h;b[7]=0;b[8]=k+p;b[9]=n-h;b[10]=1-c-m;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.frustum=function(a,b,c,m,f,l,h){var p=1/(b-a),d=1/(m-c),g=1/(f-l);h[0]=2*f*p;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*f*d;h[6]=0;h[7]=0;h[8]=(b+a)*p;h[9]=(m+c)*d;h[10]=(l+f)*g;h[11]=-1;h[12]=0;h[13]=0;h[14]=
l*f*2*g;h[15]=0;return h};a.perspective=function(a,b,c,m,f){a=1/Math.tan(a/2);var l=1/(c-m);f[0]=a/b;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=a;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=(m+c)*l;f[11]=-1;f[12]=0;f[13]=0;f[14]=2*m*c*l;f[15]=0;return f};a.ZI=function(a,b,c,m){var f=Math.tan(a.qJ*Math.PI/180),l=Math.tan(a.PH*Math.PI/180),h=Math.tan(a.KI*Math.PI/180);a=Math.tan(a.bJ*Math.PI/180);var p=2/(h+a),d=2/(f+l);m[0]=p;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=d;m[6]=0;m[7]=0;m[8]=-((h-a)*p*.5);m[9]=(f-l)*d*.5;m[10]=c/
(b-c);m[11]=-1;m[12]=0;m[13]=0;m[14]=c*b/(b-c);m[15]=0;return m};a.ortho=function(a,b,c,m,f,l,h){var p=1/(a-b),d=1/(c-m),g=1/(f-l);h[0]=-2*p;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=-2*d;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=2*g;h[11]=0;h[12]=(a+b)*p;h[13]=(m+c)*d;h[14]=(l+f)*g;h[15]=1;return h};a.lookAt=function(e,b,c,m){var f,l,h,p,d,g,k,n,x=e[0],I=e[1];e=e[2];h=c[0];p=c[1];l=c[2];k=b[0];c=b[1];f=b[2];if(1E-7>Math.abs(x-k)&&1E-7>Math.abs(I-c)&&1E-7>Math.abs(e-f))return a.identity(m);b=x-k;c=I-c;k=e-f;n=1/Math.sqrt(b*
b+c*c+k*k);b*=n;c*=n;k*=n;f=p*k-l*c;l=l*b-h*k;h=h*c-p*b;(n=Math.sqrt(f*f+l*l+h*h))?(n=1/n,f*=n,l*=n,h*=n):h=l=f=0;p=c*h-k*l;d=k*f-b*h;g=b*l-c*f;(n=Math.sqrt(p*p+d*d+g*g))?(n=1/n,p*=n,d*=n,g*=n):g=d=p=0;m[0]=f;m[1]=p;m[2]=b;m[3]=0;m[4]=l;m[5]=d;m[6]=c;m[7]=0;m[8]=h;m[9]=g;m[10]=k;m[11]=0;m[12]=-(f*x+l*I+h*e);m[13]=-(p*x+d*I+g*e);m[14]=-(b*x+c*I+k*e);m[15]=1;return m};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+
a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.cB=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!==typeof a&&(a.mat4=a)};b4w.module.mat4=b4w.module.__mat4;b4w.module.__md5=function(a){function p(a,f){var p=a[0],d=a[1],g=a[2],k=a[3],p=b(p,d,g,k,f[0],7,-680876936),k=b(k,p,d,g,f[1],12,-389564586),g=b(g,k,p,d,f[2],17,606105819),d=b(d,g,k,p,f[3],22,-1044525330),p=b(p,d,g,k,f[4],7,-176418897),k=b(k,p,d,g,f[5],12,1200080426),g=b(g,k,p,d,f[6],17,-1473231341),d=b(d,g,k,p,f[7],22,-45705983),p=b(p,d,g,k,f[8],7,1770035416),k=b(k,p,d,g,f[9],12,-1958414417),g=b(g,k,p,d,f[10],17,-42063),d=b(d,g,k,p,f[11],22,-1990404162),p=b(p,d,g,k,f[12],7,1804603682),k=b(k,p,d,g,
f[13],12,-40341101),g=b(g,k,p,d,f[14],17,-1502002290),d=b(d,g,k,p,f[15],22,1236535329),p=c(p,d,g,k,f[1],5,-165796510),k=c(k,p,d,g,f[6],9,-1069501632),g=c(g,k,p,d,f[11],14,643717713),d=c(d,g,k,p,f[0],20,-373897302),p=c(p,d,g,k,f[5],5,-701558691),k=c(k,p,d,g,f[10],9,38016083),g=c(g,k,p,d,f[15],14,-660478335),d=c(d,g,k,p,f[4],20,-405537848),p=c(p,d,g,k,f[9],5,568446438),k=c(k,p,d,g,f[14],9,-1019803690),g=c(g,k,p,d,f[3],14,-187363961),d=c(d,g,k,p,f[8],20,1163531501),p=c(p,d,g,k,f[13],5,-1444681467),k=
c(k,p,d,g,f[2],9,-51403784),g=c(g,k,p,d,f[7],14,1735328473),d=c(d,g,k,p,f[12],20,-1926607734),p=e(d^g^k,p,d,f[5],4,-378558),k=e(p^d^g,k,p,f[8],11,-2022574463),g=e(k^p^d,g,k,f[11],16,1839030562),d=e(g^k^p,d,g,f[14],23,-35309556),p=e(d^g^k,p,d,f[1],4,-1530992060),k=e(p^d^g,k,p,f[4],11,1272893353),g=e(k^p^d,g,k,f[7],16,-155497632),d=e(g^k^p,d,g,f[10],23,-1094730640),p=e(d^g^k,p,d,f[13],4,681279174),k=e(p^d^g,k,p,f[0],11,-358537222),g=e(k^p^d,g,k,f[3],16,-722521979),d=e(g^k^p,d,g,f[6],23,76029189),p=
e(d^g^k,p,d,f[9],4,-640364487),k=e(p^d^g,k,p,f[12],11,-421815835),g=e(k^p^d,g,k,f[15],16,530742520),d=e(g^k^p,d,g,f[2],23,-995338651),p=m(p,d,g,k,f[0],6,-198630844),k=m(k,p,d,g,f[7],10,1126891415),g=m(g,k,p,d,f[14],15,-1416354905),d=m(d,g,k,p,f[5],21,-57434055),p=m(p,d,g,k,f[12],6,1700485571),k=m(k,p,d,g,f[3],10,-1894986606),g=m(g,k,p,d,f[10],15,-1051523),d=m(d,g,k,p,f[1],21,-2054922799),p=m(p,d,g,k,f[8],6,1873313359),k=m(k,p,d,g,f[15],10,-30611744),g=m(g,k,p,d,f[6],15,-1560198380),d=m(d,g,k,p,f[13],
21,1309151649),p=m(p,d,g,k,f[4],6,-145523070),k=m(k,p,d,g,f[11],10,-1120210379),g=m(g,k,p,d,f[2],15,718787259),d=m(d,g,k,p,f[9],21,-343485551);a[0]=p+a[0]&4294967295;a[1]=d+a[1]&4294967295;a[2]=g+a[2]&4294967295;a[3]=k+a[3]&4294967295}function e(a,b,c,d,e,f){b=(b+a&4294967295)+(d+f&4294967295)&4294967295;return(b<<e|b>>>32-e)+c&4294967295}function b(a,b,c,d,f,k,n){return e(b&c|~b&d,a,b,f,k,n)}function c(a,b,c,d,f,k,n){return e(b&d|c&~d,a,b,f,k,n)}function m(a,b,c,d,f,k,n){return e(c^(b|~d),a,b,f,
k,n)}var f="0123456789abcdef".split("");a.Ot=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var d;for(d=64;d<=b.length;d+=64){for(var e=b.substring(d-64,d),k=[],n=void 0,n=0;64>n;n+=4)k[n>>2]=e.charCodeAt(n)+(e.charCodeAt(n+1)<<8)+(e.charCodeAt(n+2)<<16)+(e.charCodeAt(n+3)<<24);p(a,k)}b=b.substring(d-64);e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(d=0;d<b.length;d++)e[d>>2]|=b.charCodeAt(d)<<(d%4<<3);e[d>>2]|=128<<(d%4<<3);if(55<d)for(p(a,e),d=0;16>d;d++)e[d]=0;e[14]=8*
c;p(a,e);for(b=0;b<a.length;b++){c=a[b];d="";for(e=0;4>e;e++)d+=f[c>>8*e+4&15]+f[c>>8*e&15];a[b]=d}return a.join("")}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"void main ( ) { gl_FragColor = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={type:"group",a:[{type:"var",name:"ANCHOR_NUM",b:["0"]},{type:"textline",b:"attribute float a_index ; uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; void main ( ) { vec4 a ; a = u_view_matrix * vec4 ( u_position [ int ( a_index ) ] , 1.0 ) ; gl_Position = u_proj_matrix * a ; gl_PointSize = 4.0 ; }".split(" ")}]};
a["color_id.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",
name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",
b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"pack.glslf"},{type:"include",file:"procedural.glslf"},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]},{type:"include",file:"color_util.glslf"},
{type:"include",file:"math.glslv"}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",
c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_diffuse_color",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_sampler",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["USE_OUTLINE",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_color_id",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform",
"samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",
";"]}]}}]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_VALUE"],group:{type:"group",a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["USE_OUTLINE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_outline_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 bz ; varying vec4 bA ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bB",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bC",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bD",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","bE",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_perspective_cast_far_bound ; varying vec4 bF ; varying vec4 bG ; varying vec4 bH ; varying vec4 bI ; uniform float u_perspective_cast_far_bound ; uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform sampler2D u_shadow_map0 ; uniform sampler2D u_shadow_map1 ; uniform sampler2D u_shadow_map2 ; uniform sampler2D u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","bJ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"},{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["USE_REFRACTION"],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",b:"void main ( ) { float qK , qL ; vec3 qM , qN , qO , qP ;".split(" ")},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:"qM = u_camera_eye_frag - bz ; qM = normalize ( qM ) ; qJ ( qM , qN , qO , qP , qK , qL ) ; qL = qL ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"qL = ( texture2D ( u_sampler , bJ ) ) . a ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"qL = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( qL < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_OUTLINE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["color_id.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},
{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",
a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",
";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO",
"CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",
a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 bz ; varying vec4 bA ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bB",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bC",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:["varying","vec3","bD",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","bE",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","bJ",";"]}]}}]}]}}]},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},
{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec4 ts ; float tt , tu , tv ; mat4 tw ; vec3 tx , ty , tz , tA , tB , tC ; tx = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",
d:5},{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["ty","=","a_normal",";"]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"tz = vec3 ( a_tangent ) ; tA = a_tangent [ 3 ] * cross ( ty , tz ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"tz = vec3 ( 0.0 ) ; tA = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"ty = vec3 ( 0.0 ) ; tz = vec3 ( 0.0 ) ; tA = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"tx = mix ( tx , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"ty = mix ( ty , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"tB = vec3 ( a_tangent ) ; tC = a_tangent_next [ 3 ] * cross ( a_normal_next , tB ) ; tz = mix ( tz , tB , u_va_frame_factor ) ; tA = mix ( tA , tC , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"sy ( tx , tz , tA , ty ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["tA","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"tA = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"tz = ( u_model_matrix * vec4 ( tA , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"tw = rr ( u_camera_eye , tz , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"tw = rl ( u_camera_eye , tz , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"tC = ( u_model_matrix * vec4 ( tA , 1.0 ) ) . xyz ; tw = tw * rd ( u_wind , u_time , u_jitter_amp , u_jitter_freq , tC ) ;".split(" ")}]}}]},
{type:"textline",b:"aR tD = ry ( tx - tA , tA , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tw ) ; tD . b = tz ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"aR tD = ry ( tx , tA , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"tm ( tD . a , tD . b , ty ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["ty","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"ty = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:"tm ( tD . a , tD . b , ty ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logic_negative_expr",d:1}],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"bJ = rB ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bz = tD . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",
d:5}],group:{type:"group",a:[{type:"textline",b:"bB = tD . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"tt = ( dot ( cross ( tD . e , tD . c ) , tD . d ) < 0.0 ) ? - 1.0 : 1.0 ; bC = vec4 ( tD . c , tt ) ;".split(" ")}]}}]},{type:"textline",b:"bA = u_view_matrix * vec4 ( tD . a , 1.0 ) ; ts = u_proj_matrix * bA ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"ts . xy += u_subpixel_jitter * ts . w ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"tt = ts . x ; tu = ts . y ; tv = ts . w ; bD . x = ( tt + tv ) / 2.0 ; bD . y = ( tu + tv ) / 2.0 ; bD . z = tv ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bE = - bA . z / u_view_max_depth ;".split(" ")}]}}]},
{type:"textline",b:["tr","(",")",";"]}]}}]},{type:"textline",b:"gl_Position = u_proj_matrix * u_view_matrix * vec4 ( tD . a , 1.0 ) ; }".split(" ")}]};a["depth.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"MAPPING_TRS_MATRIX",b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(",
"0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",
b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1},"NODES","ALPHA",{type:"logical_and_expr",d:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",
d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"include",file:"procedural.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"pack.glslf"},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]},{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"textline",b:["uniform","vec3","u_camera_eye_frag",
";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_VECTOR_VIEW","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_VALUE"],group:{type:"group",
a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_colormap0",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_diffuse_color",
";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",
a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]},{type:"condition",a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:["varying","vec3","bz",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bB",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bC",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",
b:["varying","vec2","bJ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bA",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bF",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],
group:{type:"group",a:[{type:"textline",b:["varying","vec4","bG",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bH",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bI",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["varying","vec3","bD",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","bE",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1},"NODES","ALPHA",{type:"logical_and_expr",d:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",
{type:"equal_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]}]}}]},
{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",b:"void main ( ) { float ts , tt ; vec3 tu , tv , tw , tx ;".split(" ")},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:"tu = u_camera_eye_frag - bz ; tu = normalize ( tu ) ; qJ ( tu , tv , tw , tx , ts , tt ) ; tt = tt ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",
a:[{type:"textline",b:"tt = ( texture2D ( u_colormap0 , bJ ) ) . a ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"tt = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( tt < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","NO_SHADOWS",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}},
{type:"elif",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( dl ( bA . z ) , 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor . a += 0.00001 * bC . r ;".split(" ")}]}}]}]}}]},{type:"textline",b:["}"]}]};a["depth.glslv"]=
{type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",
a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA","CALC_TBN_SPACE",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4",
"a_tangent",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",
b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],
group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",
b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logic_negative_expr",d:1},"TEXTURE_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",
a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_shadow_cast_billboard_view_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",
d:2},{type:"logic_negative_expr",d:1},"TEXTURE_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],
group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION",
"float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bz",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bB",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bC",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","bJ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4",
"bA",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bF",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bG",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bH",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",
a:[{type:"textline",b:["varying","vec4","bI",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bD",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["varying","float","bE",";"]}]}}]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec2 uh ; vec4 ui , uj ; float uk ; mat4 ul , um ; vec3 un , uo , up , uq , ur , us ; un = a_position ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["uo","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uo = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA","CALC_TBN_SPACE",
{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"up = vec3 ( a_tangent ) ; uq = a_tangent [ 3 ] * cross ( uo , up ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"up = vec3 ( 0.0 ) ; uq = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"un = mix ( un , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",
d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"uo = mix ( uo , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"ur = vec3 ( a_tangent ) ; us = a_tangent_next [ 3 ] * cross ( a_normal_next , ur ) ; up = mix ( up , ur , u_va_frame_factor ) ; uq = mix ( uq , us , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"sy ( un , up , uq , uo ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["uq","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uq = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",
b:"aR ut = tX ( un , vec3 ( 0.0 ) , vec3 ( 0.0 ) , uo , uq , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"up = ( u_model_matrix * vec4 ( uq , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["HAIR_BILLBOARD",{type:"logic_negative_expr",d:1},"SHADOW_USAGE","SHADOW_CASTING",
{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["ul","=","u_shadow_cast_billboard_view_matrix",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["ul","=","u_view_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"um = rr ( u_camera_eye , up , ul , u_model_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"um = rl ( u_camera_eye , up , ul ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"us = ( u_model_matrix * vec4 ( uq , 1.0 ) ) . xyz ; um = um * rd ( u_wind , u_time , u_jitter_amp , u_jitter_freq , us ) ;".split(" ")}]}}]},{type:"textline",b:"aR ut = ry ( un - uq , uq , vec3 ( 0.0 ) , vec3 ( 0.0 ) , uo , um ) ; ut . b = up ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"aR ut = ry ( un , uq , vec3 ( 0.0 ) , vec3 ( 0.0 ) , uo , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uo","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uo = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",
b:"tm ( ut . a , ut . b , uo ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES","ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bz = ut . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:"bB = ut . e ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"uk = ( dot ( cross ( ut . e , ut . c ) , ut . d ) < 0.0 ) ? - 1.0 : 1.0 ; bC = vec4 ( ut . c , uk ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"ui = u_view_matrix * vec4 ( ut . a , 1.0 ) ; uj = u_proj_matrix * ui ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"uj . xy += u_subpixel_jitter * uj . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES",
"ALPHA",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bD = by ( uj ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bE = - bA . z / u_view_max_depth ;".split(" ")}]}}]},{type:"textline",
b:["tr","(",")",";"]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"bJ = rB ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"ug ( ut . a , ut . e ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",
d:2},"NODES","ALPHA",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["bA","=","ui",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_CASTING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uh = ( u_proj_matrix * u_view_matrix [ 3 ] ) . xy ; uk = SHADOW_TEX_RES / 2.0 ; uh = floor ( uh * uk + 0.5 ) / uk - uh ; uj . xy += uh ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","uj",";","}"]}]};a["grass_map.glslf"]=
{type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","uh",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["varying","float","uh",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",
b:["varying","vec3","uh",";"]}]}}]}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["gl_FragColor","=","uh",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( uh , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],
group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , uh ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["}"]}]};a["grass_map.glslv"]={type:"group",a:[{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"textline",b:["attribute",
"float","a_grass_size",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_grass_color",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},
{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","uh",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["varying","float","uh",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","uh",";"]}]}}]}]}}]},{type:"textline",b:"void main ( ) { vec4 ui ; mat4 uj ; vec3 uk ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",
a:[{type:"textline",b:"uk = ( u_model_matrix * vec4 ( vec3 ( 0.0 ) , 1.0 ) ) . xyz ; uj = rl ( u_camera_eye , uk , u_view_matrix ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uj = uj * rd ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",b:"aR ul = ry ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , uj ) ; ul . b = uk ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"aR ul = ry ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]},{type:"textline",b:"ui = u_proj_matrix * u_view_matrix * vec4 ( ul . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:"uh = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["uh","=","a_grass_size",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["uh","=","a_grass_color",";"]}]}}]}]}}]},{type:"textline",b:["gl_Position","=","ui",";","}"]}]};a["halo.glslf"]={type:"group",a:[{type:"var",name:"NUM_LINES",b:["0"]},{type:"var",name:"NUM_RINGS",b:["0"]},{type:"var",name:"NUM_STARS",b:["0"]},{type:"var",name:"WAVES_HEIGHT",
b:["0.0"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",
d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ; varying vec4 ui ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 bJ ; varying float uj ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS","NUM_LINES",{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"const int uk = NUM_RINGS ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"const int uk = NUM_LINES ;".split(" ")}]}}]},{type:"textline",b:"float um ( float ul ) { return ul - floor ( ul * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"void uv ( inout float un , in float uo [ uk ] , in float up ) { float uq , ur , us , ut ; for ( int uu = 0 ; uu < NUM_RINGS ; uu ++ ) { uq = 40.0 * uo [ uu ] ; ur = 300.0 * ( um ( uq ) - 0.005 ) ; us = uq ; ut = abs ( us * ( u_halo_size * ur - up ) ) ; un += 1.0 - min ( ut , 1.0 ) ; } }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"void uE ( inout float uw , in float ux [ uk ] , in float uy ) { float uz , uA , uB , uC ; for ( int uD = 0 ; uD < NUM_LINES ; uD ++ ) { uz = ux [ uD ] ; uA = uz ; uB = 1000.0 * ( um ( uz ) - 0.005 ) ; uC = 20.0 * abs ( uA * bJ . x + uB * bJ . y ) ; uw += 1.0 - min ( uC , 1.0 ) ; } uw *= uy ; }".split(" ")}]}}]},{type:"textline",b:"void uL ( inout float uF , in vec2 uG ) { float uH , uI , uJ , uK ; uI = atan ( uG . y , uG . x ) ; uI *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; uJ = cos ( uI ) ; uK = sin ( uI ) ; uI = ( uJ * uG . x + uK * uG . y ) * ( uJ * uG . y - uK * uG . x ) ; uH = abs ( uI ) ; if ( uH < 1.0 ) { uH = ( 0.01 * u_halo_size ) / ( uH ) ; uF *= sqrt ( min ( uH , 1.0 ) ) ; } } void main ( ) { vec3 uM ; float uN , uO , uP , uQ ; uN = ( bJ . x * bJ . x + bJ . y * bJ . y ) ; uO = sqrt ( uN ) ; uN = max ( 1.0 - uN , 0.0 ) ; uN = pow ( uN , u_halo_hardness ) ; uP = u_diffuse_color . a ;".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_RINGS","NUM_LINES",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float uR [ uk ] ; for ( int uS = 0 ; uS < uk ; uS ++ ) { uR [ uS ] = fract ( uj / ( float ( uS ) + 0.01 ) ) - 1.0 ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"uQ = 0.0 ; uv ( uQ , uR , uO ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"uO = 0.0 ; uE ( uO , uR , uN ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NUM_STARS"],group:{type:"group",a:[{type:"textline",b:"uL ( uN , bJ ) ;".split(" ")}]}}]},{type:"textline",b:"uN *= uP ; uM = u_diffuse_color . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"uQ *= uN ; uM += u_halo_rings_color * uQ ; uN += uQ ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"uO *= uP ; uM += u_halo_lines_color * uO ; uN += uO ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"uN *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uO = u_halo_stars_blend * ( ui . y - u_halo_stars_height ) ; uN *= clamp ( uO , 0.0 , 1.0 ) ; uN *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"aH ( uM ) ; aK ( uM , uN ) ; gl_FragColor = vec4 ( uM , uN ) ; }".split(" ")}]};a["halo.glslv"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:"attribute vec3 a_position ; attribute vec2 a_halo_bb_vertex ; uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ; uniform PRECISION float u_halo_size ; varying vec2 bJ ; varying float uj ;".split(" ")},{type:"condition",a:[{type:"if",
c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","ui",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 uk , ul ; mat4 um , un ; vec3 uo ; uo = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; bJ = a_halo_bb_vertex * 2.0 ; uj = fract ( uo . x + uo . y + uo . z ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"um = qQ ( uo , u_view_matrix ) ; un = u_view_matrix ; un [ 3 ] [ 0 ] = 0.0 ; un [ 3 ] [ 1 ] = 0.0 ; un [ 3 ] [ 2 ] = 0.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"um = qQ ( uo , u_view_matrix ) ;".split(" ")}]}}]},{type:"textline",b:"uk = vec4 ( a_halo_bb_vertex * 2.0 * u_halo_size , 0.0 , 1.0 ) ; uk = um * uk ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",
a:[{type:"textline",b:"ul = u_proj_matrix * un * uk ; ul . z = 0.99999 * ul . w ;".split(" ")},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["ui","=","uk",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"ul = u_proj_matrix * u_view_matrix * uk ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","ul",";","}"]}]};a["line.glslf"]={type:"group",a:[{type:"include",
file:"precision_statement.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; void main ( ) { gl_FragColor = u_diffuse_color ; }".split(" ")}]};a["line.glslv"]={type:"group",a:[{type:"var",name:"NUM_POINTS",b:["0"]},{type:"textline",b:"attribute float a_point ; uniform vec3 u_line_points [ NUM_POINTS ] ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; void main ( ) { vec3 uk ; uk = u_line_points [ int ( a_point ) ] ; gl_Position = u_proj_matrix * u_view_matrix * vec4 ( uk , 1.0 ) ; }".split(" ")}]};
a["main.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"PARALLAX_STEPS",b:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",
name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"include",file:"procedural.glslf"},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"},{type:"textline",b:["uniform","float","u_time",";"]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",
";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]},{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"USE_NODE_B4W_VECTOR_VIEW",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["USE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3",
"u_sun_direction",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform",
"samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",
b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",
a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D",
"u_scene_depth",";"]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_VALUE"],group:{type:"group",a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{type:"textline",b:["varying","vec3","bz",";"]},{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",
{type:"logical_and_expr",d:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bB",";"]}]}}]},{type:"textline",b:["varying","vec4","bA",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bC",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["varying","vec4","bF",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bG",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bH",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bI",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",
{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bD",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","bE",";"]}]}}]},{type:"include",file:"mirror.glslf"},{type:"include",file:"environment.glslf"},{type:"condition",
a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",file:"nodes.glslf"},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",
b:"void main ( ) { vec2 uZ ; vec3 u_ , va , vb , vc , vd ; float ve , vf , vg , vh ; ve = length ( bA ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"vf = bz . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},"CAUSTICS","WATER_EFFECTS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["u_","=","u_sun_intensity",
";"]}]}}]},{type:"textline",b:"va = normalize ( u_camera_eye_frag - bz ) ; qJ ( va , vb , vc , vd , vg , vh ) ; vb = vb ; vh = vh ; vd = vd ; vg = vg ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WETTABLE"],group:{type:"group",a:[{type:"textline",b:"vb = max ( vb - sqrt ( 0.01 * - min ( vf , 0.0 ) ) , 0.5 * vb ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"textline",b:"aC ( vb , vf , u_time , vg , vd , u_sun_direction , u_ , u_sun_quaternion , bz , ve ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["ALPHA_CLIP"],group:{type:"group",a:[{type:"textline",b:"if ( vh < 0.5 ) discard ; vh = 1.0 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NODES_GLOW",
{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["vh","=","1.0",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uY ( vb , length ( bA ) , va , vf ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uY ( vb , length ( bA ) , va , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uZ = texture2DProj ( u_shadow_mask , bD ) . rg ; vf = uZ . g ; vb = vec3 ( vf ) ;".split(" ")}]}}]},{type:"textline",b:["aH","(","vb",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2},"NODES_GLOW",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"aK ( vb , vh ) ;".split(" ")}]}}]},
{type:"textline",b:"gl_FragColor = vec4 ( vb , vh ) ; }".split(" ")}]};a["main.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3",
"a_position",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],
group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",
a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",
b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_color",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",
d:1},"BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},
{type:"textline",b:["varying","vec3","bz",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bB",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO",
"PARALLAX",{type:"logical_and_expr",d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bA",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bC",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["varying",
"vec3","uZ",";"]},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","bJ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","u_",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bF",";"]},{type:"condition",
a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bG",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bH",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bI",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",
d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bD",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","NODES",{type:"logic_negative_expr",d:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","bE",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},
{type:"include",file:"wind_bending.glslv"},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec4 va , vb ; float vc ; mat4 vd ; vec3 ve , vf , vg , vh , vi , vj , vk ; ve = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"NODES",{type:"logic_negative_expr",
d:1},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["vf","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vf = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE","NODES",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vg = vec3 ( a_tangent ) ; vh = a_tangent [ 3 ] * cross ( vf , vg ) ;".split(" ")}]}},
{type:"elif",c:["NODES",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vi = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; vj = normalize ( ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ) ; vi = vi - u_camera_eye ; vh = cross ( vi , vj ) ; vg = cross ( vj , vh ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vg = vec3 ( 0.0 ) ; vh = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"ve = mix ( ve , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:"vf = mix ( vf , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"vj = vec3 ( a_tangent ) ; vi = a_tangent_next [ 3 ] * cross ( a_normal_next , vj ) ; vg = mix ( vg , vj , u_va_frame_factor ) ; vh = mix ( vh , vi , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"sy ( ve , vg , vh , vf ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",
a:[{type:"textline",b:["vi","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vi = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"aR vl = tX ( ve , vg , vh , vf , vi , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],
group:{type:"group",a:[{type:"textline",b:"vj = ( u_model_matrix * vec4 ( vi , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vd = rr ( u_camera_eye , vj , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vd = rl ( u_camera_eye , vj , u_view_matrix ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vk = ( u_model_matrix * vec4 ( vi , 1.0 ) ) . xyz ; vd = vd * rd ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vk ) ;".split(" ")}]}}]},{type:"textline",b:"aR vl = ry ( ve - vi , vi , vg , vh , vf , vd ) ; vl . b = vj ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"aR vl = ry ( ve , vi , vg , vh , vf , u_model_matrix ) ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vc = ( dot ( cross ( vl . e , vl . c ) , vl . d ) < 0.0 ) ? - 1.0 : 1.0 ; bC = vec4 ( vl . c , vc ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"tm ( vl . a , vl . b , vf ) ;".split(" ")}]}}]},{type:"textline",b:"bz = vl . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",
d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:"bB = vl . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"uZ = u_camera_eye - vl . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",
b:"bJ = rB ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"u_ = vl . f ;".split(" ")}]}},{type:"elif",c:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["u_","=","a_color",";"]}]}}]}]}}]},{type:"textline",b:"va = u_view_matrix * vec4 ( vl . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",
d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["bA","=","va",";"]}]}}]},{type:"textline",b:"vb = u_proj_matrix * va ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"vb . xy += u_subpixel_jitter * vb . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",
d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"bD = by ( vb ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"ug ( vl . a , vl . e ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","NODES",{type:"logic_negative_expr",d:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2},{type:"logical_and_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"bE = - va . z / u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:["tr","(",")",";"]}]}}]},{type:"textline",b:["gl_Position","=","vb",";","}"]}]};a["main_stack.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",
b:["0"]},{type:"var",name:"PARALLAX_STEPS",b:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",
name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"procedural.glslf"},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"color_util.glslf"},
{type:"include",file:"math.glslv"},{type:"textline",b:["uniform","float","u_time",";"]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",
b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",
a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4",
"u_fog_params",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_direction",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],group:{type:"group",
a:[{type:"textline",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC","ALPHA_AS_SPEC",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",
a:[{type:"textline",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",
b:["uniform","float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",
";"]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_reflect_factor",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_normal_factor",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{type:"textline",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","PARALLAX",
{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_parallax_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_refr_bump",";"]}]}}]},{type:"textline",b:"varying vec3 bz ; varying vec3 bB ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",
d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bA",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bC",";"]}]}}]},{type:"textline",b:["varying","vec3","uZ",";"]},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","bJ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR",
"DYNAMIC_GRASS",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","u_",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bF",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bG",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",
b:["varying","vec4","bH",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bI",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bD",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",
a:[{type:"textline",b:["varying","float","bE",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"shadow.glslf"}]}}]},{type:"include",file:"mirror.glslf"},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",
a:[{type:"include",file:"lighting_nodes.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",b:"void main ( ) { vec4 xg , xh , xi , xj ; mat3 xk ; vec2 xl , xm , xn , xo ; vec3 xp , xq , xr , xs , xt , xu , xv , xw , xx ; float xy , xz , xA , xB , xC ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",
d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"xy = length ( bA ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"xz = bz . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},"CAUSTICS","WATER_EFFECTS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",
a:[{type:"textline",b:["xp","=","u_sun_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["xl","=","bJ",";"]}]}}]},{type:"textline",b:"xq = normalize ( bB ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",a:[{type:"textline",b:"if ( gl_FrontFacing ) xq = xq ; else xq = - xq ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"xr = cross ( xq , bC . xyz ) * bC . w ; xk = mat3 ( bC . xyz , xr , xq ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"xm = normalize ( u_view_matrix_frag * vec4 ( bB , 0.0 ) ) . st ; xm = xm * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( xy < PARALLAX_LOD_DIST ) { xA = clamp ( 0.5 * ( PARALLAX_LOD_DIST - xy ) , 0.0 , 1.0 ) ; xA = u_parallax_scale * xA ; xr = normalize ( uZ * xk ) ; xB = 1.0 / PARALLAX_STEPS ; xn = xr . xy * xA / ( PARALLAX_STEPS * xr . z ) ; xA = 1.0 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["xo","=","xm",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["xo","=","xl",";"]}]}}]},{type:"textline",b:"xC = texture2D ( u_normalmap0 , xo ) . a ; for ( float xD = 1.0 ; xD <= PARALLAX_STEPS ; xD ++ ) { if ( xC < xA ) { xA -= xB ; xo -= xn ; xC = texture2D ( u_normalmap0 , xo ) . a ; } } xn = xo + xn ; xB = texture2D ( u_normalmap0 , xn ) . a - ( xA + xB ) ; xA = xC - xA ; xB = xA / ( xA - xB ) ; xo = xB * xn + ( 1.0 - xB ) * xo ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"xl += xo - xm ;".split(" ")}]}}]},{type:"textline",b:["xm","=","xo",";"]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"xm += xo - xl ;".split(" ")}]}}]},{type:"textline",b:["xl","=","xo",";"]}]}}]},
{type:"textline",b:["}"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xg = texture2D ( u_normalmap0 , xm ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xg = texture2D ( u_normalmap0 , xl ) ;".split(" ")}]}}]},{type:"textline",b:"xr = xg . rgb - 0.5 ; xr = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , xr , u_normal_factor ) ; xr = xk * xr ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["xr","=","xq",";"]}]}}]},{type:"textline",b:"xr = normalize ( xr ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"xm = normalize ( u_view_matrix_frag * vec4 ( xr , 0.0 ) ) . st ; xm = xm * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:"xq = normalize ( uZ ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"xs = u_ ; aE ( xs ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xg = vec4 ( xs , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["xg","=","u_diffuse_color",";"]}]}}]},{type:"textline",b:["xB","=","1.0",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"xh = texture2D ( u_colormap0 , xm ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xh = texture2D ( u_colormap0 , xl ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",b:"aE ( xh . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",
a:[{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xi = texture2D ( u_colormap1 , xm ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xi = texture2D ( u_colormap1 , xl ) ;".split(" ")}]}}]},{type:"textline",b:"aE ( xi . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"xj = texture2D ( u_stencil0 , xm ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xj = texture2D ( u_stencil0 , xl ) ;".split(" ")}]}}]},{type:"textline",b:"xh = mix ( xh , xi , xj . r ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xg . rgb = mix ( xg . rgb , xh . rgb , u_diffuse_color_factor ) ; xA = u_alpha_factor * xh . a ; xA += ( 1.0 - step ( 0.0 , xA ) ) ; xg . a = mix ( xA , 1.0 , u_diffuse_color . a ) ; xB = xh . a ;".split(" ")}]}},
{type:"elif",c:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xg . rgb *= mix ( vec3 ( 1.0 ) , xh . rgb , u_diffuse_color_factor ) ; xg . a = xh . a ; xB = xh . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"xs = u_diffuse_intensity * xg . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHADELESS"],group:{type:"group",a:[{type:"textline",b:["xt","=","xs",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xu = u_environment_energy * dO ( xr ) ; xu = u_ambient * xu ; xA = dr ( xs ) ; xv = u_emit * xg . rgb ; xw = u_specular_color ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["ALPHA_AS_SPEC"],group:{type:"group",a:[{type:"textline",b:"xx = vec3 ( xB ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xx = texture2D ( u_specmap0 , xm ) . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xx = texture2D ( u_specmap0 , xl ) . rgb ;".split(" ")}]}}]},
{type:"textline",b:"aE ( xx . rgb ) ; xw = mix ( xw , xx , u_specular_color_factor ) ;".split(" ")}]}}]},{type:"textline",b:"xB = u_specular_params [ 0 ] ; xl = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; xw = xB * xw ; xf ( xv , xu , xs , xw , bz , xr , xq , xl , u_diffuse_params , xA , 0.0 , vec4 ( 0.0 ) , xt , xx ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2},
{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"dL ( xt , xq , xr , u_reflect_factor ) ;".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"dL ( xt , xq , xr , 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["xt","+=","xx",";"]}]}}]},{type:"textline",b:"xB = xg . a ;".split(" ")},{type:"condition",
a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WETTABLE"],group:{type:"group",a:[{type:"textline",b:"xt = max ( xt - sqrt ( 0.01 * - min ( xz , 0.0 ) ) , 0.5 * xt ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"textline",b:"aC ( xt , xz , u_time , xA , xr , u_sun_direction , xp , u_sun_quaternion , bz , xy ) ;".split(" ")}]}}]}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["ALPHA_CLIP"],group:{type:"group",a:[{type:"textline",b:"if ( xB < 0.5 ) discard ; xB = 1.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"xA = max ( max ( xx . r , xx . g ) , xx . b ) * u_specular_alpha ; xB = xg . a * ( 1.0 - xA ) + xA ;".split(" ")}]}}]}]}}]}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:["xB","=","1.0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"xt = mix ( eb ( bD , xr . xz * u_refr_bump ) , xt , xB ) ; xB = 1.0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uY ( xt , xy , xq , xz ) ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:"uY ( xt , xy , xq , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["aH","(","xt",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"aK ( xt , xB ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( xt , xB ) ; }".split(" ")}]};a["main_stack.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",
name:"MAX_BONES",b:["0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",
"WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4",
"a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",
a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_color",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],
group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",
a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform",
"vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],
group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"textline",b:["varying","vec3","bz",";"]},{type:"condition",
a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:7}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bB",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES","DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",d:2},"WATER_EFFECTS",
"CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bA",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bC",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","uZ",";"]},{type:"condition",a:[{type:"if",
c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","bJ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","DYNAMIC_GRASS",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","u_",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bF",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",
a:[{type:"textline",b:["varying","vec4","bG",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bH",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bI",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",
{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bD",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","NODES",{type:"logic_negative_expr",d:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","float","bE",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},
{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec4 xg , xh ; float xi ; mat4 xj ; vec3 xk , xl , xm , xn , xo , xp , xq ; xk = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},"NODES",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:6}],
group:{type:"group",a:[{type:"textline",b:["xl","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xl = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE","NODES",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xm = vec3 ( a_tangent ) ; xn = a_tangent [ 3 ] * cross ( xl , xm ) ;".split(" ")}]}},
{type:"elif",c:["NODES",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xo = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; xp = normalize ( ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ) ; xo = xo - u_camera_eye ; xn = cross ( xo , xp ) ; xm = cross ( xp , xn ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xm = vec3 ( 0.0 ) ; xn = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"xk = mix ( xk , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:"xl = mix ( xl , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"xp = vec3 ( a_tangent ) ; xo = a_tangent_next [ 3 ] * cross ( a_normal_next , xp ) ; xm = mix ( xm , xp , u_va_frame_factor ) ; xn = mix ( xn , xo , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"sy ( xk , xm , xn , xl ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",
a:[{type:"textline",b:["xo","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xo = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"aR xr = tX ( xk , xm , xn , xl , xo , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],
group:{type:"group",a:[{type:"textline",b:"xp = ( u_model_matrix * vec4 ( xo , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xj = rr ( u_camera_eye , xp , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xj = rl ( u_camera_eye , xp , u_view_matrix ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xq = ( u_model_matrix * vec4 ( xo , 1.0 ) ) . xyz ; xj = xj * rd ( u_wind , u_time , u_jitter_amp , u_jitter_freq , xq ) ;".split(" ")}]}}]},{type:"textline",b:"aR xr = ry ( xk - xo , xo , xm , xn , xl , xj ) ; xr . b = xp ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"aR xr = ry ( xk , xo , xm , xn , xl , u_model_matrix ) ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xi = ( dot ( cross ( xr . e , xr . c ) , xr . d ) < 0.0 ) ? - 1.0 : 1.0 ; bC = vec4 ( xr . c , xi ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"tm ( xr . a , xr . b , xl ) ;".split(" ")}]}}]},{type:"textline",b:"bz = xr . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",
d:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{type:"logical_and_expr",d:3},{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:"bB = xr . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"uZ = u_camera_eye - xr . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",
b:"bJ = rB ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"u_ = xr . f ;".split(" ")}]}},{type:"elif",c:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["u_","=","a_color",";"]}]}}]}]}}]},{type:"textline",b:"xg = u_view_matrix * vec4 ( xr . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NODES","DISABLE_FOG",{type:"logic_negative_expr",d:1},"TEXTURE_NORM_CO","PARALLAX",{type:"logical_and_expr",
d:2},"WATER_EFFECTS","CAUSTICS",{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["bA","=","xg",";"]}]}}]},{type:"textline",b:"xh = u_proj_matrix * xg ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"xh . xy += u_subpixel_jitter * xh . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",
d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"bD = by ( xh ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"ug ( xr . a , xr . e ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","NODES",{type:"logic_negative_expr",d:1},"USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:2},{type:"logical_and_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"bE = - xg . z / u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:["tr","(",")",";"]}]}}]},{type:"textline",b:["gl_Position","=","xh",";","}"]}]};a["particles_color.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"include",file:"pack.glslf"}]}}]},
{type:"var",name:"SOFT_STRENGTH",b:["1.0"]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform float u_p_alpha_start ; uniform float u_p_alpha_end ; uniform vec2 u_texel_size ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:"varying float xg ; varying vec3 u_ ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],
group:{type:"group",a:[{type:"textline",b:"varying vec4 bA ; varying vec3 bD ; varying float xh ;".split(" ")}]}}]},{type:"textline",b:"void main ( ) { vec4 xi ; vec3 xj ; float xk , xl , xm ; vec2 xn , xo ; xn = gl_PointCoord - 0.5 ; xk = 2.0 * length ( xn ) ; xk = smoothstep ( u_p_alpha_start , u_p_alpha_end , xk ) ; xk = u_diffuse_color . a * xg * ( 1.0 - xk ) ; xj = u_ * u_diffuse_color . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",
b:"xo = bD . xy / bD . z ; xn = vec2 ( xn . x , - xn . y ) * xh * u_texel_size ; xn = vec2 ( xo + xn ) ; xi = texture2D ( u_scene_depth , xn ) ; xl = k ( xi ) ; xm = - bA . z / u_view_max_depth ; xm = xl - xm ; xm = u_view_max_depth / SOFT_STRENGTH * xm ; xk = xk * min ( xm , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["aH","(","xj",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"aK ( xj , xk ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( xj , xk ) ; }".split(" ")}]};a["particles_color.glslv"]={type:"group",a:[{type:"var",name:"COLOR_RAMP_LENGTH",b:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",b:["0"]},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_p_delay ; attribute float a_p_lifetime ; attribute vec4 a_p_vels ;".split(" ")},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec2 u_p_size_ramp [ SIZE_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_height ; uniform float u_p_size ;".split(" ")},
{type:"condition",a:[{type:"if",c:["WORLD_SPACE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"varying float xg ; varying vec3 u_ ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"varying vec4 bA ; varying vec3 bD ; varying float xh ;".split(" ")}]}}]},{type:"include",file:"particles.glslv"},{type:"textline",b:"void main ( ) { float xV , xW , xX , xY ; vec4 xZ , x_ ; xi ya ; ya = xU ( ) ; xZ = u_view_matrix * vec4 ( ya . b , 1.0 ) ; x_ = u_proj_matrix * xZ ; gl_Position = x_ ; xg = ya . c ; u_ = ya . d ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:["bA","=","xZ",";"]}]}}]},{type:"textline",b:"xV = u_height * u_proj_matrix [ 1 ] [ 1 ] * u_p_size / gl_Position . z ; xV = ya . a * xV ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"xW = x_ . x ; xX = x_ . y ; xY = x_ . w ; bD . x = ( xW + xY ) / 2.0 ; bD . y = ( xX + xY ) / 2.0 ; bD . z = xY ; xh = xV ;".split(" ")}]}}]},{type:"textline",
b:["gl_PointSize","=","xV",";","}"]}]};a["particles_texture.glslf"]={type:"group",a:[{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"include",file:"std_enums.glsl"},
{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"include",file:"pack.glslf"}]}}]},{type:"var",name:"PARTICLES_SHADELESS",b:["0"]},{type:"var",name:"SOFT_STRENGTH",b:["1.0"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},
{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],
group:{type:"group",a:[{type:"textline",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; varying float xg ; varying vec3 u_ ; varying vec2 bJ ; varying vec3 bz ;".split(" ")},{type:"condition",
a:[{type:"if",c:["PARTICLES_SHADELESS",{type:"logic_negative_expr",d:1},"DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","uZ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"SOFT_PARTICLES",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bA",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",
a:[{type:"textline",b:["varying","vec3","bD",";"]}]}}]},{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"fog.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["PARTICLES_SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"lighting_nodes.glslf"}]}}]},{type:"textline",b:"void main ( ) { vec2 xV ; float xW , xX , xY ; vec3 xZ , x_ , ya , yb , yc , yd , ye , yf ; vec4 yg , yh ; yg = u_diffuse_color ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"yh = texture2D ( u_sampler , bJ ) ; aE ( yh . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"yg . rgb = mix ( yg . rgb , yh . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"yg . rgb *= mix ( vec3 ( 1.0 ) , yh . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},{type:"textline",b:"yg . a = yh . a ;".split(" ")}]}}]},{type:"textline",b:"yg . rgb *= u_ ; xZ = u_diffuse_intensity * yg . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["PARTICLES_SHADELESS",{type:"logic_negative_expr",d:1},"DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"x_ = normalize ( uZ ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["PARTICLES_SHADELESS",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"ya = u_emit * yg . rgb ; yb = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logic_negative_expr",d:1},"SKY_COLOR",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"yc = u_environment_energy * dO ( vec3 ( 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"yc = u_environment_energy * dO ( yb ) ;".split(" ")}]}}]},{type:"textline",b:"yc = u_ambient * yc ; xW = u_specular_params [ 0 ] ; xV = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; yd = xW * u_specular_color ; xf ( ya , yc , xZ , yd , bz , yb , x_ , xV , u_diffuse_params , 1.0 , 0.0 , vec4 ( 0.0 ) , ye , yf ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["ye","=","xZ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"textline",b:"uY ( ye , length ( bA ) , x_ , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"xW = yg . a * xg ;".split(" ")},{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"xX = - bA . z / u_view_max_depth ; yg = texture2DProj ( u_scene_depth , bD ) ; xY = k ( yg ) ; xX = xY - xX ; xX = u_view_max_depth / SOFT_STRENGTH * xX ; xW = xW * min ( xX , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["aH","(","ye",")",";"]},{type:"condition",
a:[{type:"if",c:["ALPHA","ALPHA_CLIP",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"aK ( ye , xW ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( ye , xW ) ; }".split(" ")}]};a["particles_texture.glslv"]={type:"group",a:[{type:"var",name:"BILLBOARD_ALIGN",b:["0"]},{type:"var",name:"COLOR_RAMP_LENGTH",b:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",b:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},
{type:"define",name:"BILLBOARD_ALIGN_VIEW",b:["1"]},{type:"define",name:"BILLBOARD_ALIGN_XY",b:["2"]},{type:"define",name:"BILLBOARD_ALIGN_YZ",b:["3"]},{type:"define",name:"BILLBOARD_ALIGN_ZX",b:["4"]},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_p_delay ; attribute float a_p_lifetime ; attribute vec4 a_p_vels ; attribute vec2 a_p_bb_vertex ;".split(" ")},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec2 u_p_size_ramp [ SIZE_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ; uniform vec3 u_camera_eye ; uniform vec3 u_wind ; uniform float u_p_size ;".split(" ")},
{type:"condition",a:[{type:"if",c:["WORLD_SPACE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"varying float xg ; varying vec3 u_ ; varying vec2 bJ ; varying vec3 uZ ; varying vec3 bz ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"SOFT_PARTICLES",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","bA",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bD",";"]}]}}]},{type:"include",file:"particles.glslv"},{type:"textline",b:"float xX ( vec2 xV , vec2 xW ) { return ( atan ( xW . y , xW . x ) - atan ( xV . y , xV . x ) ) ; } void main ( ) { vec4 xY , xZ , x_ ; mat4 ya ; float yb , yc , yd ; xi ye ; ye = xU ( ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { yb = ye . e ; ya = qQ ( ye . b , u_view_matrix ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { yb = ye . e ; ya = bk ( ) ; ya [ 3 ] = vec4 ( ye . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { yb = ye . e ; ya = bo ( radians ( 90.0 ) ) ; ya [ 3 ] = vec4 ( ye . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { yb = xX ( vec2 ( EPSILON , 1.0 ) , vec2 ( a_normal . x , a_normal . z ) ) + ye . e ; ya = bm ( radians ( - 90.0 ) ) ; ya [ 3 ] = vec4 ( ye . b , 1.0 ) ; } xY = vec4 ( a_p_bb_vertex * 2.0 * ye . a * u_p_size , 0.0 , 1.0 ) ; xY = ya * bq ( yb ) * xY ; xZ = u_view_matrix * xY ; x_ = u_proj_matrix * xZ ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SOFT_PARTICLES"],group:{type:"group",a:[{type:"textline",b:"yb = x_ . x ; yc = x_ . y ; yd = x_ . w ; bD . x = ( yb + yd ) / 2.0 ; bD . y = ( yc + yd ) / 2.0 ; bD . z = yd ;".split(" ")}]}}]},{type:"textline",b:"gl_Position = x_ ; xg = ye . c ; u_ = ye . d ; bJ = a_p_bb_vertex + 0.5 ; bz = xY . xyz ; uZ = u_camera_eye - xY . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"SOFT_PARTICLES",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["bA","=","xZ",";"]}]}}]},{type:"textline",b:["}"]}]};a["procedural_skydome.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; varying vec3 xV ; const float xW = 0.99 ; const float xX = 1.8 ; const int xY = 8 ; float yd ( vec3 xZ , vec3 x_ ) { float ya , yb , yc ; ya = dot ( x_ , x_ ) ; yb = 2.0 * dot ( x_ , xZ ) ; yc = dot ( xZ , xZ ) - 1.0 ; ya = yb * yb - 4.0 * ya * yc ; ya = sqrt ( ya ) ; ya = ( - yb - ya ) / 2.0 ; ya = yc / ya ; return ya ; } float yk ( float ye , float yf ) { float yg , yh , yi , yj ; yg = 3.0 * ( 1.0 - yf * yf ) ; yh = 2.0 * ( 2.0 + yf * yf ) ; yi = 1.0 + ye * ye ; yj = pow ( 1.0 + yf * yf - 2.0 * yf * ye , 1.5 ) ; yj = max ( yj , 0.00001 ) ; return ( yg / yh ) * ( yi / yj ) ; } float yq ( vec3 yl , vec3 ym , float yn ) { vec3 yo ; float yp ; yp = dot ( ym , - yl ) ; if ( yp < 0.0 ) { return 1.0 ; } yo = yl + yp * ym ; if ( length ( yo ) < yn ) { return 0.0 ; } else if ( length ( yo ) >= yn ) { yo = normalize ( yo ) * yn - yl ; yp = acos ( dot ( normalize ( yo ) , ym ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( yp * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 yu ( float yr , vec3 ys , float yt ) { return ys - ys * pow ( u_sky_color , vec3 ( yt / yr ) ) ; } void main ( ) { float yv , yw , yx , yy , yz , yA , yB , yC , yD ; vec3 yE , yF , yG , yH , yI , yJ , yK ; yE = normalize ( xV ) ; yF = u_sun_direction ; yv = dot ( yE , yF ) ; yw = yk ( yv , - 0.01 ) * u_rayleigh_brightness * yF . y ; yx = yk ( yv - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - yF . y ) ; yv = smoothstep ( 0.0 , 100.0 , yk ( yv , 0.9995 ) ) * u_spot_brightness ; yG = vec3 ( 0.0 , xW , 0.0 ) ; yy = yd ( yG , yE ) ; yz = yy / float ( xY ) ; yA = yq ( yG , yE , xW - 0.3 ) ; yH = vec3 ( 0.0 , 0.0 , 0.0 ) ; yI = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int yL = 0 ; yL < xY ; yL ++ ) { yB = yz * float ( yL ) ; yJ = yG + yE * yB ; yC = yq ( yJ , yF , xW - 0.2 ) ; yD = yd ( yJ , yF ) ; yK = yu ( yD , vec3 ( xX ) , u_scatter_strength ) * yC ; yH += yu ( sqrt ( yB ) , u_sky_color * yK , u_rayleigh_strength ) ; yI += yu ( yB , yK , u_mie_strength ) ; } yH = yH * yA * pow ( yy , u_rayleigh_collection_power ) / float ( xY ) ; yI = ( yI * yA * pow ( yy , u_mie_collection_power ) ) / float ( xY ) ; yH = vec3 ( yv * yI + yx * yI + yw * yH ) ; aH ( yH ) ; gl_FragColor = vec4 ( yH , 1.0 ) ; }".split(" ")}]};
a["procedural_skydome.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec3 a_position ; uniform mat4 u_cube_view_matrix ; varying vec3 xV ; void main ( ) { vec4 xW , xX ; xW = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; xX = u_cube_view_matrix * xW ; xV = xX . xyz ; gl_Position = xW ; }".split(" ")}]};a["special_lens_flares.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",b:"uniform sampler2D u_sampler ; varying vec2 bJ ; void main ( ) { vec4 xW ; xW = texture2D ( u_sampler , bJ ) ; aH ( xW . rgb ) ; aK ( xW . rgb , xW . a ) ; gl_FragColor = xW ; }".split(" ")}]};
a["special_lens_flares.glslv"]={type:"group",a:[{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"define",name:"LIGHT_INDEX",b:["0"]},{type:"textline",b:"attribute float a_lf_dist ; attribute vec2 a_lf_bb_vertex ; attribute vec2 a_texcoord ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; varying vec2 bJ ; void main ( ) { vec2 xW ; float xX ; vec4 xY ; vec3 xZ ; bJ = a_texcoord ; xZ = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; xY = u_proj_matrix * u_view_matrix * vec4 ( xZ , 0.0 ) ; xY . x /= xY . w ; xY . y /= xY . w ; xY += 99999.0 * step ( xY . z , 0.0 ) ; xY += 100.0 * ( step ( 1.0 , abs ( xY . x ) ) + step ( 1.0 , abs ( xY . y ) ) ) ; xY . x = - a_lf_dist * xY . x ; xY . y = - a_lf_dist * xY . y ; xX = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; xW = vec2 ( a_lf_bb_vertex . x / xX , a_lf_bb_vertex . y ) ; if ( a_lf_dist > - 0.999 ) { const float x_ = 1.9 ; xW *= ( 1.0 + x_ * length ( xY . xy ) ) ; } gl_Position = vec4 ( xY . xy + xW , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"define",name:"INV_PI",b:["0.318309886"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",a:[{type:"if",c:["WO_SKYTEX","PROCEDURAL_SKYDOME",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky",";"]}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1},"WO_SKYTEX",
{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"blending.glslf"},{type:"textline",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; vec3 Ab ( vec3 zX , vec3 zY , float zZ , float z_ ) { float Aa ; Aa = zZ * z_ ;".split(" ")},{type:"condition",a:[{type:"if",c:["BLENDTYPE","MIX",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yl ( zY , zX , Aa ) ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","ADD",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yp ( zX , zY , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SUBTRACT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yt ( zX , zY , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","MULTIPLY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yy ( zX , zY , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SCREEN",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"return yD ( zX , zY , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","OVERLAY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yI ( zX , zY , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yM ( zX , zY , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DIVIDE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"return yQ ( zX , zY , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DARKEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yU ( zX , zY , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","LIGHTEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yY ( zX , zY , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","HUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return zd ( zY , zX , Aa ) ;".split(" ")}]}},{type:"elif",
c:["BLENDTYPE","SATURATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return zj ( zY , zX , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","VALUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return zp ( zY , zX , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","COLOR",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return zv ( zY , zX , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SOFT_LIGHT",{type:"equal_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:"return zA ( zY , zX , Aa ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return zE ( zY , zX , Aa ) ;".split(" ")}]}}]},{type:"textline",b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Aj ( float Ac , float Ad , float Ae , float Af ) { float Ag ; vec3 Ah , Ai ; Ah = vec3 ( Ac ) , Ai = vec3 ( Ad ) ; Ag = Ae * Af ;".split(" ")},{type:"condition",a:[{type:"if",c:["BLENDTYPE","MIX",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yl ( Ai , Ah , Ag ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","ADD",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yp ( Ah , Ai , Ag ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SUBTRACT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yt ( Ah , Ai , Ag ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","MULTIPLY",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"return zK ( Ac , Ad , Ag , Af ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SCREEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return zQ ( Ac , Ad , Ag , Af ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","OVERLAY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return zW ( Ac , Ad , Ag , Af ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DIFFERENCE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yM ( Ah , Ai , Ag ) . x ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","DIVIDE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yQ ( Ah , Ai , Ag ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","DARKEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yU ( Ah , Ai , Ag ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","LIGHTEN",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return yY ( Ah , Ai , Ag ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","SOFT_LIGHT",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return zA ( Ai , Ah , Ag ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","LINEAR_LIGHT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return zE ( Ai , Ah , Ag ) . x ;".split(" ")}]}}]},{type:"textline",b:["return","0.0",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},"REFLECTION_PASS",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_camera_eye_frag ; uniform vec3 u_sun_intensity ; uniform float u_environment_energy ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{type:"textline",b:["varying","vec3","xV",";"]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",
d:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","bJ",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 Ak ; float Al , Am , An ; vec3 Ao , Ap , Aq , Ar , As ; Ap = normalize ( xV ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME"],group:{type:"group",a:[{type:"textline",b:"Ao = textureCube ( u_sky , Ap ) . rgb ;".split(" ")}]}},{type:"elif",c:["WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",
d:2},{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"Ao = u_horizon_color ; aH ( Ao ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:[";"]},{type:"condition",a:[{type:"if",c:["WO_SKYPAPER"],group:{type:"group",a:[{type:"textline",b:"Aq = vec3 ( bJ , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Aq = vec3 ( xV . xy , 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:["Al","=","0.0",";"]},{type:"condition",a:[{type:"if",
c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WO_SKYPAPER"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"Al = abs ( bJ . y ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Al = ( bJ . y + 1.0 ) * 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Am = acos ( Ap . y ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",
a:[{type:"textline",b:"Al = abs ( Am * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Al = 1.0 - Am * INV_PI ;".split(" ")}]}}]}]}}]}]}}]},{type:"textline",b:"Ar = u_horizon_color ; As = u_zenith_color ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYTEX"],group:{type:"group",a:[{type:"textline",b:"Am = 1.0 ; Ak = textureCube ( u_sky , Ap ) ; aE ( Ak . rgb ) ; Am = Ak . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT"],group:{type:"group",
a:[{type:"textline",b:"Am = aO ( Ak ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["MTEX_NEGATIVE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"Ak = vec4 ( vec3 ( 1.0 ) - Ak . rgb , Ak . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Am = 1.0 - Am ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",
d:3}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"Ak = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Am = Ak . a ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_HORIZ"],group:{type:"group",a:[{type:"textline",b:"Ar = Ab ( Ak . rgb , Ar , Am , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP","WOMAP_ZENDOWN",{type:"logical_or_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["An","=","0.0",";"]},{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"if ( dot ( Aq , vec3 ( 0.0 , 1.0 , 0.0 ) ) >= 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP"],group:{type:"group",a:[{type:"textline",b:"An = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:[";"]}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["WOMAP_ZENDOWN"],
group:{type:"group",a:[{type:"textline",b:"else An = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP"],group:{type:"group",a:[{type:"textline",b:"An = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"elif",c:["WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",b:"An = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( An != 0.0 ) As = Ab ( Ak . rgb , As , Am , An ) ;".split(" ")}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["WOMAP_BLEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"Am = dot ( Ak . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{type:"textline",b:"Al = Aj ( u_sky_tex_dvar , Al , Am , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"textline",b:"Ao = mix ( Ar , As , Al ) ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:["Ao","=","Ar",";"]}]}}]},{type:"textline",b:["aH","(","Ao",")",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"aH ( Ar ) ; aH ( As ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"textline",b:"Ao = mix ( Ar , As , Al ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["Ao","=","Ar",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","DISABLE_FOG",
{type:"logic_negative_expr",d:1},"REFLECTION_PASS",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"aE ( Ao ) ; Al = u_camera_eye_frag . y - WATER_LEVEL ; Al = min ( - Al * 0.03 , 0.8 ) ; Am = clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ; Ar = vec3 ( 0.0 ) ; Ak = u_underwater_fog_color_density ; Ak . rgb = mix ( Ak . rgb , Ar , min ( - Ap . y + Al , 1.0 ) ) * Am ; Al = clamp ( sign ( Ap . y - 0.05 * Al ) , 0.0 , 1.0 ) ; Ao = mix ( Ak . rgb , Ao , Al ) ; aH ( Ao ) ;".split(" ")}]}}]},
{type:"textline",b:"gl_FragColor = vec4 ( Ao , 1.0 ) ; }".split(" ")}]};a["special_skydome.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec3 a_position ; uniform mat4 u_sky_vp_inverse ; varying vec3 xV ;".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","bJ",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 zX , zY ; zX = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; zY = u_sky_vp_inverse * zX ; xV = zY . xyz ;".split(" ")},
{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME",{type:"logic_negative_expr",d:1},"WO_SKYTEX","WO_SKYBLEND",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"bJ = a_position . xy ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","zX",";","}"]}]};a["special_water.glslf"]={type:"group",a:[{type:"var",name:"ABSORB",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"SSS_STRENGTH",b:["6.0"]},{type:"var",name:"SSS_WIDTH",
b:["0.0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},
{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"color_util.glslf"},{type:"include",file:"math.glslv"},{type:"define",name:"REFL_BUMP",b:["0.001"]},{type:"define",name:"REFR_BUMP",b:["0.0005"]},{type:"textline",b:["uniform","float","u_time",";"]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",
c:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],
group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_params",
";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},
{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_foam",";"]}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",1,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_normalmap1_scale",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",2,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec2",
"u_normalmap2_scale",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",3,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","float","u_reflect_factor",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["SHORE_SMOOTHING","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_refr_bump",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:"const float zX = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",b:"varying vec3 uZ ; varying vec3 bz ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},"GENERATED_MESH",
{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","bJ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"varying vec3 bC ; varying vec3 zY ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bB",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","zZ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","z_",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",{type:"logical_or_expr",
d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bD",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","float","bE",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","Aa",";"]}]}}]},{type:"include",
file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"fog.glslf"}]}}]},{type:"textline",b:"vec3 Am ( in vec2 Ab , in vec3 Ac , in vec3 Ad , in vec3 Ae , out float Af ) { float Ag , Ah , Ai ; vec2 Aj ; vec3 Ak , Al ; Af = 0.0 ; Ak = reflect ( - Ad , Ac ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Aj = Ab . xy + Ac . xz * REFL_BUMP / bE ; Af = u_reflect_factor ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1},"WATER_EFFECTS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Al = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"Al = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"textline",b:"} else { Al = texture2D ( u_plane_reflection , Aj ) . rgb ; aE ( Al ) ; }".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Af = u_mirror_factor ; Al = Ae * textureCube ( u_mirrormap , Ak ) . rgb ; aE ( Al ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Af = u_reflect_factor ; Al = Ae * vec3 ( 0.3 , 0.5 , 1.0 ) ; aE ( Al ) ;".split(" ")}]}}]},
{type:"textline",b:"Ak = normalize ( Ak + Ad ) ; Ag = 1.0 - dot ( Ad , Ak ) ; Ah = u_fresnel_params [ 3 ] ; Ai = u_fresnel_params [ 2 ] ; Ai = Ah + ( 1.0 - Ah ) * pow ( Ag , Ai ) ; Af = min ( Af * Ai , 1.0 ) ; return Al ; }".split(" ")},{type:"include",file:"lighting_nodes.glslf"},{type:"textline",b:"void main ( ) { vec4 An ; vec2 Ao , Ap , Aq ; float Ar , As , At , Au , Av , Aw ; vec3 Ax , Ay , Az , AA , AB , AC , AD , AE , AF ; mat3 AG ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",
0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"AG = mat3 ( bC , zY , bB ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"Ax = normalize ( bB ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Ax = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC","FOAM",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ar = bz . y - WATER_LEVEL ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"Ao = vec2 ( zZ . x , - zZ . z ) + 0.5 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Ao = vec2 ( bz . x , - bz . z ) + 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:["Ao","=","bJ",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ay = vec3 ( 0.0 ) ; Az = texture2D ( u_normalmap0 , Ao * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Ay += Az ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"AA = vec3 ( 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NORM_FOAM0"],
group:{type:"group",a:[{type:"textline",b:["AA","+=","Az",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",1,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Az = texture2D ( u_normalmap0 , Ao * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Ay += Az ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM1"],group:{type:"group",a:[{type:"textline",
b:["AA","+=","Az",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",2,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Az = texture2D ( u_normalmap0 , Ao * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Ay += Az ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM2"],group:{type:"group",a:[{type:"textline",b:["AA","+=","Az",";"]}]}}]}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",3,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Az = texture2D ( u_normalmap0 , Ao * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Ay += Az ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM3"],group:{type:"group",a:[{type:"textline",b:["AA","+=","Az",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"AA = AG * AA ; if ( ! aU ( AA , vec3 ( 0.0 ) ) ) AA = normalize ( AA ) ; AA = mix ( Ax , AA , 0.2 ) ; AA = normalize ( AA ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"Ax = mix ( Ax , normalize ( AG * Ay ) , 0.3 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"Ax = mix ( Ax , normalize ( AG * Ay ) , 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:"Ax = normalize ( Ax ) ;".split(" ")}]}}]},{type:"textline",b:"Ay = normalize ( uZ ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ap = bD . xy / bD . z ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","DISABLE_FOG",{type:"logic_negative_expr",
d:1},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"As = bE * u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:"At = u_diffuse_color . a ; An = texture2DProj ( u_scene_depth , bD ) ; Au = k ( An ) ; Av = max ( Au - bE , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"Aq = Ap + Ax . xz * u_refr_bump / bE ; Au = dU ( Au , Aq , Ap ) ; Au = max ( Au - bE , 0.0 ) ; Au = u_view_max_depth / ABSORB * Au ; if ( u_cam_water_depth < 0.0 ) Aw = 0.0 ; else Aw = min ( At * Au , 1.0 ) ; Au = u_view_max_depth / ABSORB * Av ; At = min ( 15.0 * At * u_view_max_depth * Av , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"Au = u_view_max_depth / ABSORB * Av ; if ( u_cam_water_depth > 0.0 ) At = min ( At * Au , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"At *= min ( 5.0 * As , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"At = u_diffuse_color . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"Aw = 1.0 - At ; Aq = Ap + Ax . xz * u_refr_bump / bE ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"Az = texture2D ( u_refractmap , Aq ) . rgb ; aE ( Az ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"Au = pow ( min ( z_ . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; AB = mix ( u_shallow_water_col , u_diffuse_color . rgb , Au ) ; Au = pow ( min ( z_ . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; AB = mix ( u_shore_water_col , AB , Au ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"AB = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:"Av = max ( 1.0 - u_view_max_depth * Av , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Av = 1.0 - At ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",
b:"Ar = max ( Ar / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"AC = normalize ( vec3 ( z_ . r , 0.0 , z_ . g ) ) ; AC = normalize ( mix ( vec3 ( 0.0 , 1.0 , 0.0 ) , AC , 0.8 ) ) ; Au = 1.25 * max ( dot ( AA , AC ) - 0.2 , 0.0 ) ; Au += max ( dot ( AA , vec3 ( 0.0 , - 1.0 , 0.0 ) ) , 0.0 ) ; Av += Au * ( 1.0 - z_ . b ) ; Ar *= ( 1.0 - 0.95 * pow ( z_ . b , 0.1 ) ) ;".split(" ")}]}}]},{type:"textline",b:"Av += Ar ; Av = min ( u_foam_factor * Av , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"An = texture2D ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + Ao * u_foam_scale ) ;".split(" ")}]}}]},{type:"textline",b:"Ar = u_specular_params [ 0 ] ; Ao = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; AA = Ar * u_specular_color ; AC = u_environment_energy * dO ( Ax ) ; AC = u_ambient * AC ; AC = AC + u_sun_intensity ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"AD = Am ( Ap , Ax , Ay , AC , Ar ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"AD = Am ( vec2 ( 0.0 ) , Ax , Ay , AC , Ar ) ;".split(" ")}]}}]},{type:"textline",b:"AB = u_diffuse_intensity * AB ; xf ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , AB , AA , bz , Ax , Ay , Ao , u_diffuse_params , 1.0 , 0.0 , vec4 ( 0.0 ) , AE , AF ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"Au = max ( dot ( u_sun_direction , - bB ) + SSS_WIDTH , 0.0 ) * max ( dot ( - Ay , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; Au = clamp ( SSS_STRENGTH * Au , 0.0 , 1.0 ) ; AE = mix ( AE , u_shallow_water_col , Au ) ; AE = mix ( AE , u_shore_water_col , Au ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"AE = mix ( Az , AE , Aw ) ;".split(" ")}]}}]},{type:"textline",b:"AE = mix ( AE , AD , Ar ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"Ar = mix ( An . g , An . r , max ( 4.0 * ( Av - 0.75 ) , 0.0 ) ) ; Ar = mix ( An . b , Ar , max ( 2.0 * Av - 1.0 , 0.0 ) ) ; Ar = mix ( 0.0 , Ar , Av ) ; AE = mix ( AE , AC , Ar ) ;".split(" ")}]}}]},{type:"textline",
b:["AE","+=","AF",";"]},{type:"condition",a:[{type:"if",c:["DISABLE_FOG",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"if ( u_cam_water_depth < 0.0 ) { uR ( AE , As , u_cam_water_depth ) ; } else { uY ( AE , As , Ay , 1.0 ) ; }".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uY ( AE , As , Ay , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["aH","(","AE",")",";"]},
{type:"condition",a:[{type:"if",c:["REFRACTIVE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"At = max ( At , AF . r ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:["At","+=","Ar",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"textline",b:"aK ( AE , At ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"extension",b:["GL_OES_standard_derivatives",
":","enable"]},{type:"textline",b:"AF = fwidth ( Aa ) ; AF = smoothstep ( vec3 ( 0.0 ) , AF * zX , Aa ) ; Ar = min ( min ( AF . x , AF . y ) , AF . z ) ; Ar = clamp ( Ar , 0.0 , 1.0 ) ; AE = mix ( u_wireframe_edge_color , AE , Ar ) ; At = mix ( 1.0 , At , Ar ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( AE , At ) ; }".split(" ")}]};a["special_water.glslv"]={type:"group",a:[{type:"var",name:"DIR_MIN_SHR_FAC",b:["0.0"]},{type:"var",name:"DIR_FREQ",b:["0.0"]},{type:"var",name:"DIR_NOISE_SCALE",
b:["0.0"]},{type:"var",name:"DIR_NOISE_FREQ",b:["0.0"]},{type:"var",name:"DIR_MIN_NOISE_FAC",b:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_0",b:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_0",b:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_1",b:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_1",b:["0.0"]},{type:"var",name:"DST_MIN_FAC",b:["0.0"]},{type:"var",name:"MAX_SHORE_DIST",b:["0.0"]},{type:"var",name:"PRECISION",b:["mediump"]},{type:"var",name:"SHORE_MAP_CENTER_X",b:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_X",
b:["0.0"]},{type:"var",name:"SHORE_MAP_CENTER_Y",b:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_Y",b:["0.0"]},{type:"var",name:"WAVES_HOR_FAC",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"WAVES_LENGTH",b:["0.0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"include",file:"procedural.glslf"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",
a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"DYNAMIC",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_normal ; attribute vec3 a_tangent ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH",{type:"logic_negative_expr",d:1},"NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_polyindex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],
group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{type:"textline",b:"varying vec3 uZ ; varying vec3 bz ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},"GENERATED_MESH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","bJ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:"varying vec3 bC ; varying vec3 zY ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC","NUM_NORMALMAPS",0,{type:"g_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bB",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2},"GENERATED_MESH","DYNAMIC",{type:"logical_and_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying",
"vec3","zZ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","z_",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","bD",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE","DISABLE_FOG",
{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:["varying","float","bE",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","Aa",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"vec3 Af ( in vec2 zX ) { float Ab ; vec4 Ac ; vec2 Ad ; Ad = 0.5 + vec2 ( ( zX . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , - ( zX . y + SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; Ac = texture2D ( u_shore_dist_map , Ad ) ; const vec2 Ae = vec2 ( 1.0 / 255.0 , 1.0 ) ; Ab = dot ( Ac . ba , Ae ) ; Ad = normalize ( Ac . rg * 2.0 - 1.0 ) ; return vec3 ( Ad , Ab ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"define",name:"SMALL_WAVES_FAC",b:["0.3"]},{type:"textline",b:"void Ar ( inout vec3 Ag , in float Ah , in vec3 Ai ) { vec2 Aj , Ak , Al ; float Am , An , Ao , Ap , Aq ; Am = ag ( DST_NOISE_SCALE_0 * ( Ag . xz + DST_NOISE_FREQ_0 * Ah ) ) * ag ( DST_NOISE_SCALE_1 * ( Ag . zx - DST_NOISE_FREQ_1 * Ah ) ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",
a:[{type:"textline",b:"An = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; Ao = Ai . b ; Ap = sqrt ( Ao ) ; An = max ( Ao , DIR_MIN_SHR_FAC ) * sin ( Ap / An + DIR_FREQ * Ah ) ; Aq = max ( ag ( DIR_NOISE_SCALE * ( Ag . xz + DIR_NOISE_FREQ * Ah ) ) , DIR_MIN_NOISE_FAC ) ; An *= Aq ; Ap = WAVES_HEIGHT * mix ( An , Am , max ( Ap , DST_MIN_FAC ) ) ; Aj = Ai . rg ; An = WAVES_HOR_FAC * An * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - Ao ) , 0.0 ) ; Aj = An * Aj ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"Ap = WAVES_HEIGHT * Am ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"Ak = 2.0 * ( Ag . xz - 0.1 * Ah ) ; Al = 1.3 * ( Ag . zx + 0.03 * Ah ) ; Am = L ( 0.5 * Ak ) . x + L ( 0.5 * Al ) . x - 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"Ag . xz += Aj ; Am *= Ao ;".split(" ")}]}}]},{type:"textline",b:"Ap += SMALL_WAVES_FAC * Am ;".split(" ")}]}}]},{type:"textline",
b:"Ag . y += Ap ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { vec4 As , At ; vec2 Au ; float Av , Aw , Ax ; vec3 Ay , Az , AA , AB ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:"if ( a_polyindex == 0.0 ) Aa = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) Aa = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) Aa = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["Ay","=","a_position",";"]},
{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"Av = abs ( Ay . y ) ; Au = u_camera_eye . xz - mod ( u_camera_eye . xz , Av ) ; Ay . y = WATER_LEVEL ; Ay . xz += Au ;".split(" ")}]}},{type:"elif",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["bJ","=","a_texcoord",";"]}]}}]},{type:"textline",b:"aR AC = ry ( Ay , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"z_ = Af ( AC . a . xz ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"Aw = length ( u_wind ) ; Ax = u_time ; Ax *= Aw ;".split(" ")},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"Av = Av ; Ay = AC . a + vec3 ( Av , 0.0 , 0.0 ) ; Az = AC . a + vec3 ( 0.0 , 0.0 , Av ) ; if ( a_position . y < 0.0 ) { AC . a . y = WATER_LEVEL - 1.0 ; Ay . y = AC . a . y ; Az . y = AC . a . y ; }".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",0,{type:"g_expr",d:2},"FOAM",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zZ = AC . a ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Ay = AC . a + vec3 ( 0.05 , 0.0 , 0.0 ) ; Az = AC . a + vec3 ( 0.0 , 0.0 , 0.05 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"AA = Af ( Ay . xz ) ; AB = Af ( Az . xz ) ; Ar ( Ay , Ax , AA ) ; Ar ( Az , Ax , AB ) ; Ar ( AC . a , Ax , z_ ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"Ar ( Ay , Ax , vec3 ( 0.0 ) ) ; Ar ( Az , Ax , vec3 ( 0.0 ) ) ; Ar ( AC . a , Ax , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",b:"Ay = normalize ( Ay - AC . a ) ; Az = normalize ( Az - AC . a ) ; bB = normalize ( cross ( Az , Ay ) ) ; Ax = dot ( bB , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; Ax = clamp ( 0.8 - Ax , 0.0 , 1.0 ) ; bB = mix ( bB , vec3 ( 0.0 , 1.0 , 0.0 ) , Ax ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",
0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"Az = a_tangent ; bB = a_normal ;".split(" ")}]}}]},{type:"textline",b:"bC = Az ; zY = cross ( bB , bC ) ;".split(" ")}]}}]},{type:"textline",b:"bz = AC . a ; uZ = u_camera_eye - AC . a ; As = u_view_matrix * vec4 ( AC . a , 1.0 ) ; At = u_proj_matrix * As ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE",
"REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"Ax = At . x ; Av = At . y ; Aw = At . w ; bD . x = ( Ax + Aw ) / 2.0 ; bD . y = ( Av + Aw ) / 2.0 ; bD . z = Aw ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFRACTIVE","DISABLE_FOG",{type:"logic_negative_expr",d:1},{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"bE = - As . z / u_view_max_depth ;".split(" ")}]}}]},
{type:"textline",b:["gl_Position","=","At",";","}"]}]};a["wireframe.glslf"]={type:"group",a:[{type:"define",name:"WM_NONE",b:["0"]},{type:"define",name:"WM_OPAQUE_WIREFRAME",b:["1"]},{type:"define",name:"WM_TRANSPARENT_WIREFRAME",b:["2"]},{type:"define",name:"WM_FRONT_BACK_VIEW",b:["3"]},{type:"define",name:"WM_DEBUG_SPHERES",b:["4"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"textline",b:"uniform int u_wireframe_mode ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",b:"varying vec3 Aa ; const float zX = 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE_DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"const vec3 Ab = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const vec3 Ab = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"const vec3 Ac = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 Ad = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 Ae = vec3 ( 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"void main ( ) { float Af , Ag ; vec3 Ah , Ai ; Ah = vec3 ( 0.0 ) ; Af = 0.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"Ai = sign ( Aa - vec3 ( 0.02 * zX ) ) ; if ( Ai . x < 0.0 || Ai . y < 0.0 || Ai . z < 0.0 ) { Ah = Ab ; Af = 1.0 ; } else discard ;".split(" ")}]}},
{type:"elif",c:["WIREFRAME_QUALITY",0,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ai = sign ( Aa - vec3 ( 0.02 * zX ) ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { if ( Ai . x < 0.0 || Ai . y < 0.0 || Ai . z < 0.0 ) Ah = u_wireframe_edge_color ; else Ah = Ae ; Af = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { if ( Ai . x < 0.0 || Ai . y < 0.0 || Ai . z < 0.0 ) Af = 1.0 ; else Af = 0.0 ; Ah = u_wireframe_edge_color ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( Ai . x < 0.0 || Ai . y < 0.0 || Ai . z < 0.0 ) Ah = u_wireframe_edge_color ; else if ( gl_FrontFacing ) Ah = Ac ; else Ah = Ad ; Af = 1.0 ; }".split(" ")}]}},
{type:"elif",c:["WIREFRAME_QUALITY",1,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"extension",b:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",b:"Ai = fwidth ( Aa ) ; Ai = smoothstep ( vec3 ( 0.0 ) , Ai * zX , Aa ) ; Ag = min ( min ( Ai . x , Ai . y ) , Ai . z ) ; Ag = clamp ( Ag , 0.0 , 1.0 ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { Ah = vec3 ( mix ( u_wireframe_edge_color , Ae , Ag ) ) ; Af = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { Ah = u_wireframe_edge_color ; Af = mix ( 1.0 , 0.0 , Ag ) ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( gl_FrontFacing ) Ah = mix ( u_wireframe_edge_color , Ac , Ag ) ; else Ah = mix ( u_wireframe_edge_color , Ad , Ag ) ; Af = 1.0 ; }".split(" ")}]}}]},
{type:"textline",b:["aH","(","Ah",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"textline",b:"aK ( Ah , Af ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( Ah , Af ) ; }".split(" ")}]};a["wireframe.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_polyindex ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],
group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{type:"textline",b:["varying","vec3","Aa",";"]},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"include",file:"dynamic_grass.glslv"}]}}]},{type:"textline",b:"void main ( ) { vec4 zX ; mat4 Ab ; vec3 Ac , Ad , Ae , Af , Ag ; if ( a_polyindex == 0.0 ) Aa = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) Aa = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) Aa = vec3 ( 0.0 , 0.0 , 1.0 ) ; Ac = a_position ; Ad = a_normal ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"aR Ah = ry ( Ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"Ac = mix ( Ac , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"Ae = vec3 ( 0.0 ) ; Af = vec3 ( 0.0 ) ; sy ( Ac , Ae , Af , Ad ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:["Af","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Af = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"aR Ah = tX ( Ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Af , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"Ae = ( u_model_matrix * vec4 ( Af , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ab = rr ( u_camera_eye , Ae , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"Ab = rl ( u_camera_eye , Ae , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","BILLBOARD_JITTERED",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ag = ( u_model_matrix * vec4 ( Af , 1.0 ) ) . xyz ; Ab = Ab * rd ( u_wind , u_time , u_jitter_amp , u_jitter_freq , Ag ) ;".split(" ")}]}}]},{type:"textline",b:"aR Ah = ry ( Ac - Af , Af , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Ab ) ; Ah . b = Ae ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"aR Ah = ry ( Ac , Af , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"tm ( Ah . a , Ah . b , Ad ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"zX = u_view_matrix * vec4 ( Ah . a , 1.0 ) ; gl_Position = u_proj_matrix * zX ; }".split(" ")}]};a["postprocessing/anaglyph.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",
b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; varying vec2 bJ ; void main ( ) { vec4 zX , Ab ; zX = texture2D ( u_sampler_left , bJ ) ; Ab = texture2D ( u_sampler_right , bJ ) ; gl_FragColor = vec4 ( zX [ 0 ] , Ab [ 1 ] , Ab [ 2 ] , zX [ 3 ] + Ab [ 3 ] ) ; }".split(" ")}]};a["postprocessing/antialiasing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; varying vec2 bJ ;".split(" ")},
{type:"define",name:"AA_METHOD_FXAA_LIGHT",b:["1"]},{type:"define",name:"AA_METHOD_FXAA_QUALITY",b:["2"]},{type:"define",name:"AA_QUALITY_LOW",b:["0"]},{type:"define",name:"AA_QUALITY_MEDIUM",b:["1"]},{type:"define",name:"AA_QUALITY_HIGH",b:["2"]},{type:"condition",a:[{type:"if",c:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{type:"define",name:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},
{type:"define",name:"FXAA_SPAN_MAX",b:["8.0"]},{type:"textline",b:"vec4 Ad ( float zX , float Ab ) { vec2 Ac ; Ac = bJ + vec2 ( zX , Ab ) * u_texel_size ; return texture2D ( u_color , Ac ) ; } vec4 Aq ( ) { vec2 Ae ; float Af , Ag , Ah , Ai , Aj , Ak ; vec4 Al , Am , An , Ao , Ap ; Al = Ad ( - 1.0 , - 1.0 ) ; Am = Ad ( 1.0 , - 1.0 ) ; An = Ad ( - 1.0 , 1.0 ) ; Ao = Ad ( 1.0 , 1.0 ) ; Ap = Ad ( 0.0 , 0.0 ) ; Af = aO ( Ap ) ; Ag = aO ( Al ) ; Ah = aO ( Am ) ; Ai = aO ( An ) ; Aj = aO ( Ao ) ; Ak = min ( Af , min ( min ( Ag , Ah ) , min ( Ai , Aj ) ) ) ; Af = max ( Af , max ( max ( Ag , Ah ) , max ( Ai , Aj ) ) ) ; Ae . x = - ( ( Ag + Ah ) - ( Ai + Aj ) ) ; Ae . y = ( ( Ag + Ai ) - ( Ah + Aj ) ) ; Aj = max ( ( Ag + Ah + Ai + Aj ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; Aj = 1.0 / ( min ( abs ( Ae . x ) , abs ( Ae . y ) ) + Aj ) ; Ae = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , Ae * Aj ) ) * u_texel_size ; Ao = 0.5 * ( texture2D ( u_color , bJ + Ae * ( 1.0 / 3.0 - 0.5 ) ) + texture2D ( u_color , bJ + Ae * ( 2.0 / 3.0 - 0.5 ) ) ) ; An = Ao * 0.5 + 0.25 * ( texture2D ( u_color , bJ + Ae * - 0.5 ) + texture2D ( u_color , bJ + Ae * 0.5 ) ) ; Aj = aO ( An ) ; if ( ( Aj < Ak ) || ( Aj > Af ) ) return Ao ; else return An ; }".split(" ")}]}},
{type:"elif",c:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_GREEN_AS_LUMA",b:["1"]},{type:"define",name:"FXAA_BLEND4WEB",b:["1"]},{type:"include",file:"fxaa.glslf"},{type:"condition",a:[{type:"if",c:["AA_QUALITY","AA_QUALITY_HIGH",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PRESET",b:["39"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",
b:["0.063"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{type:"elif",c:["AA_QUALITY","AA_QUALITY_MEDIUM",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PRESET",b:["20"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{type:"elif",c:["AA_QUALITY","AA_QUALITY_LOW",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"define",name:"FXAA_QUALITY_PRESET",b:["12"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0833"]}]}}]}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = Aq ( ) ;".split(" ")}]}},{type:"elif",c:["AA_METHOD",
"AA_METHOD_FXAA_QUALITY",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = Bg ( bJ , u_color , u_texel_size , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 bJ ; void main ( ) { vec4 zX ; vec2 Ab , Ac ; Ab = vec2 ( 0.0 , 0.0 ) ; Ac = u_texel_size ; zX = texture2D ( u_color , bJ ) ; gl_FragColor = zX * 0.0875447373698 ; Ab += Ac ; gl_FragColor += texture2D ( u_color , bJ + Ab ) * 0.0858112354248 ; gl_FragColor += texture2D ( u_color , bJ - Ab ) * 0.0858112354248 ; Ab += Ac ; gl_FragColor += texture2D ( u_color , bJ + Ab ) * 0.0808139781061 ; gl_FragColor += texture2D ( u_color , bJ - Ab ) * 0.0808139781061 ; Ab += Ac ; gl_FragColor += texture2D ( u_color , bJ + Ab ) * 0.0731235112908 ; gl_FragColor += texture2D ( u_color , bJ - Ab ) * 0.0731235112908 ; Ab += Ac ; gl_FragColor += texture2D ( u_color , bJ + Ab ) * 0.0635705267419 ; gl_FragColor += texture2D ( u_color , bJ - Ab ) * 0.0635705267419 ; Ab += Ac ; gl_FragColor += texture2D ( u_color , bJ + Ab ) * 0.0530985673112 ; gl_FragColor += texture2D ( u_color , bJ - Ab ) * 0.0530985673112 ; Ab += Ac ; gl_FragColor += texture2D ( u_color , bJ + Ab ) * 0.0426125984122 ; gl_FragColor += texture2D ( u_color , bJ - Ab ) * 0.0426125984122 ; Ab += Ac ; gl_FragColor += texture2D ( u_color , bJ + Ab ) * 0.0328565115809 ; gl_FragColor += texture2D ( u_color , bJ - Ab ) * 0.0328565115809 ; Ab += Ac ; gl_FragColor += texture2D ( u_color , bJ + Ab ) * 0.0243407024472 ; gl_FragColor += texture2D ( u_color , bJ - Ab ) * 0.0243407024472 ; gl_FragColor = max ( 0.7 * zX , gl_FragColor ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; varying vec2 bJ ; void main ( ) { vec4 zX , Ab ; zX = texture2D ( u_main , bJ ) ; Ab = texture2D ( u_bloom , bJ ) ; zX = zX ; zX += Ab ; gl_FragColor = vec4 ( zX . rgb , 1.0 ) ; }".split(" ")}]};a["postprocessing/compositing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},
{type:"define",name:"PI_4",b:["0.785398163"]},{type:"textline",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; varying vec2 bJ ; void main ( ) { float zX ; vec3 Ab ; vec4 Ac ; Ac = texture2D ( u_color , bJ ) ; Ab = Ac . rgb ; if ( u_brightness < 0.0 ) Ab = Ab * ( 1.0 + u_brightness ) ; else Ab = Ab + ( ( 1.0 - Ab ) * u_brightness ) ; Ab = ( Ab - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * PI_4 ) ) + 0.5 ; Ab *= u_exposure ; zX = aO ( vec4 ( Ab , 0.0 ) ) ; Ab = mix ( vec3 ( zX ) , Ab , u_saturation ) ; gl_FragColor = vec4 ( Ab , Ac . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; varying vec2 bJ ; void main ( ) { gl_FragColor = g ( clamp ( Bn ( u_depth , bJ , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};a["postprocessing/dof.glslf"]=
{type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front ; uniform float u_dof_rear ; uniform vec2 u_camera_range ; varying vec2 bJ ; void main ( ) { float zX , Ab ; vec4 Ac , Ad ; Ac = texture2D ( u_sharp , bJ ) ; if ( u_dof_dist > 0.0 ) { zX = Bn ( u_depth , bJ , u_camera_range ) ; zX *= u_view_max_depth ; if ( zX < u_dof_dist ) Ab = ( u_dof_dist - zX ) / u_dof_front ; else Ab = ( zX - u_dof_dist ) / u_dof_rear ; Ab = clamp ( Ab , 0.0 , 1.0 ) ; Ad = texture2D ( u_blurred , bJ ) ; gl_FragColor = mix ( Ac , Ad , Ab ) ; } else gl_FragColor = Ac ; }".split(" ")}]};
a["postprocessing/glow.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; varying vec2 bJ ; void main ( ) { float zX ; vec4 Ab , Ac , Ad ; Ab = texture2D ( u_src_color , bJ ) ; Ac = texture2D ( u_glow_mask_small , bJ ) ; Ad = texture2D ( u_glow_mask_large , bJ ) ; gl_FragColor = Ab ; if ( Ad . a != 0.0 ) { zX = u_glow_mask_large_coeff * Ad . a ; zX = clamp ( zX , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , Ad . rgb / Ad . a , zX ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , zX ) ; } if ( Ac . a != 0.0 ) { zX = u_glow_mask_small_coeff * Ac . a ; zX = clamp ( zX , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , Ac . rgb / Ac . a , zX ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , zX ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"var",name:"STEPS_PER_PASS",b:["0.0"]},{type:"textline",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},{type:"condition",
a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_camera_range",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"varying float Bo ; varying vec2 Bp ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 bJ ; varying vec4 Bq ; void main ( ) { vec4 Br ; float Bs , Bt , Bu , Bv , Bw ; vec2 Bx , By , Bz ; Bx = ( Bq . xy - bJ ) ; Bs = length ( Bx ) ; Bx = u_radial_blur_step * Bx / Bs ; Bt = Bs / u_radial_blur_step ; Bx *= min ( Bt , STEPS_PER_PASS ) / STEPS_PER_PASS ; Bt = max ( Bt , STEPS_PER_PASS ) ; By = bJ ; Bu = 0.0 ; for ( float BA = 0.0 ; BA < STEPS_PER_PASS ; BA += 1.0 ) { if ( BA <= Bt ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"textline",b:"Bv = Bn ( u_input , By , u_camera_range ) ; Bu += max ( ( 1.0 - pow ( Bs , 0.3 ) ) * step ( 0.9 , Bv ) , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Br = texture2D ( u_input , By ) ; Bu += k ( Br ) ;".split(" ")}]}}]},{type:"textline",b:"} By += Bx ; }".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"Bz = bJ + Bp ; Bw = L ( vec2 ( 2.5 * ( Bz . x ) , 2.5 * ( Bz . y ) + 1.0 * u_time ) ) . x + 0.75 * L ( vec2 ( 5.0 * ( Bz . x ) - 0.66 * u_time , 5.0 * ( Bz . y ) + 0.66 * u_time ) ) . x + 0.5 * ag ( vec2 ( 7.5 * ( Bz . x ) + 0.33 * u_time , 7.5 * ( Bz . y ) - 0.33 * u_time ) ) ; Bw *= clamp ( 1.2 - sqrt ( 0.2 * Bs ) , 0.0 , 1.0 ) * Bo ; Bu = max ( Bw , Bu ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = g ( Bu / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]=
{type:"group",a:[{type:"include",file:"math.glslv"},{type:"textline",b:"attribute vec2 a_bb_vertex ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ; varying float Bo ; varying vec2 Bp ;".split(" ")}]}}]}]}}]},{type:"textline",
b:"varying vec2 bJ ; varying vec4 Bq ; void main ( ) { float zX , Ab ; vec3 Ac ; bJ = a_bb_vertex + 0.5 ; Ac = normalize ( u_sun_direction ) ; Bq = u_proj_matrix * u_view_matrix * vec4 ( Ac , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA","WATER_EFFECTS",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( u_cam_water_depth < 0.0 ) { Bo = 1.0 ; Ac = vec3 ( 0.0 , 1.0 , 0.0 ) ; Ac = aX ( u_camera_quat , Ac ) ; Ac = normalize ( Ac ) ; zX = dot ( Ac , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; Ab = atan ( Ac . x , Ac . z ) ; Bp = vec2 ( - Ab , acos ( zX ) ) ; } else { Bo = 0.0 ; }".split(" ")}]}}]},
{type:"textline",b:"Bq . xy = 0.5 * ( Bq . xy / Bq . w + 1.0 ) ; Bq += 99999.0 * step ( Bq . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; varying vec2 bJ ; void main ( ) { float zX ; vec3 Ab ; vec4 Ac ; Ac = texture2D ( u_main , bJ ) ; Ab = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; aE ( Ac . rgb ) ; zX = k ( texture2D ( u_god_rays , bJ ) ) ; Ab = Ac . rgb + u_god_rays_intensity * vec3 ( zX ) * Ab ; aH ( Ab ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SAFARI_CANVAS_ALPHA_HACK"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( Ab , max ( 0.01 , Ac . a ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( Ab , Ac . a ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/luminance.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_input ; varying vec2 bJ ; void main ( ) { float zX ; vec4 Ab ; Ab = texture2D ( u_input , bJ ) ; zX = dot ( Ab . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; gl_FragColor = vec4 ( vec3 ( zX ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_input ; void main ( ) { float zX , Ab ; Ab = 0.0 ; for ( float Ac = 0.025 ; Ac < 1.0 ; Ac += 0.05 ) for ( float Ad = 0.025 ; Ad < 1.0 ; Ad += 0.05 ) { zX = max ( texture2D ( u_input , vec2 ( Ac , Ad ) ) . r , 0.01 ) ; Ab += log ( zX ) ; } Ab = exp ( Ab / 400.0 ) ; gl_FragColor = vec4 ( vec3 ( Ab ) , 1.0 ) ; }".split(" ")}]};a["postprocessing/luminance_trunced.glslf"]=
{type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; varying vec2 bJ ; varying float Br ; void main ( ) { vec4 Bs ; float Bt , Bu ; Bt = texture2D ( u_average_lum , vec2 ( 0.5 ) ) . r ; Bu = texture2D ( u_luminance , bJ ) . r ; Bs = texture2D ( u_main , bJ ) ; Bt = Bu / Bt ; Bu = u_bloom_edge_lum ; gl_FragColor = Bs * max ( Bt - Bu , 0.0 ) * Br ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec2 a_position ; uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; varying vec2 bJ ; varying float Br ; const vec3 zX = vec3 ( 0.0 , 1.0 , 0.0 ) ; void Ai ( in vec4 Ab , in vec3 Ac , out vec3 Ad ) { float Ae , Af , Ag , Ah ; Ae = Ab . w * Ac . x + Ab . y * Ac . z - Ab . z * Ac . y ; Af = Ab . w * Ac . y + Ab . z * Ac . x - Ab . x * Ac . z ; Ag = Ab . w * Ac . z + Ab . x * Ac . y - Ab . y * Ac . x ; Ah = - Ab . x * Ac . x - Ab . y * Ac . y - Ab . z * Ac . z ; Ad . x = Ae * Ab . w - Ah * Ab . x - Af * Ab . z + Ag * Ab . y ; Ad . y = Af * Ab . w - Ah * Ab . y - Ag * Ab . x + Ae * Ab . z ; Ad . z = Ag * Ab . w - Ah * Ab . z - Ae * Ab . y + Af * Ab . x ; } void main ( ) { vec3 Aj ; bJ = 2.0 * a_position ; Ai ( u_camera_quat , zX , Aj ) ; Br = dot ( - Aj , u_sun_direction ) * u_bloom_key ; Br *= max ( sign ( u_sun_direction . y ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; varying vec2 bJ ; float zX = 0.0042 ; void main ( ) { vec4 Ab , Ac , Ad , Ae ; Ab = texture2D ( u_mb_tex_curr , bJ ) ; Ac = texture2D ( u_mb_tex_accum , bJ ) ; if ( length ( Ab - Ac ) > u_motion_blur_decay_threshold ) { Ad = ( 1.0 - u_motion_blur_exp ) * Ab + u_motion_blur_exp * Ac ; Ad = Ad - Ac ; Ae = Ab - Ac ; Ad = min ( max ( abs ( Ad ) , vec4 ( zX ) ) , abs ( Ae ) ) * sign ( Ad ) ; gl_FragColor = Ac + Ad ; } else { gl_FragColor = Ab ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"textline",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; varying vec2 bJ ; void main ( ) { vec3 zX ; float Ab ; vec4 Ac , Ad , Ae ; Ac = texture2D ( u_outline_src , bJ ) ; gl_FragColor = Ac ; if ( u_draw_outline != 0.0 ) { Ad = texture2D ( u_outline_mask , bJ ) ; Ae = texture2D ( u_outline_mask_blurred , bJ ) ; Ab = Ae . a - Ad . a ; if ( Ab != 0.0 ) { Ab = smoothstep ( 0.0 , 1.0 , Ae . a ) ; if ( Ad . a == 0.0 ) { zX = u_outline_color ; aH ( zX ) ; Ad = vec4 ( clamp ( zX , 0.0 , 1.0 ) , 1.0 ) ; gl_FragColor = mix ( Ac , Ad , Ab ) ; } } } }".split(" ")}]};
a["postprocessing/postprocessing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"POST_EFFECT_NONE",b:["1"]},{type:"define",name:"POST_EFFECT_GRAYSCALE",b:["2"]},{type:"define",name:"POST_EFFECT_X_BLUR",b:["3"]},{type:"define",name:"POST_EFFECT_Y_BLUR",b:["4"]},{type:"define",name:"POST_EFFECT_X_EXTEND",b:["5"]},{type:"define",name:"POST_EFFECT_Y_EXTEND",b:["6"]},{type:"define",name:"FLIP_CUBEMAP_COORDS",b:["7"]},{type:"textline",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},
{type:"condition",a:[{type:"if",c:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{type:"textline",b:"varying vec2 bJ ; void main ( ) { float zX , Ab , Ac , Ad ; vec2 Ae , Af ; vec4 Ag ;".split(" ")},{type:"condition",a:[{type:"if",c:["POST_EFFECT","POST_EFFECT_NONE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = texture2D ( u_color , bJ ) ;".split(" ")}]}},
{type:"elif",c:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ag = texture2D ( u_color , bJ ) ; gl_FragColor . rgb = vec3 ( ( Ag . r + Ag . g + Ag . b ) / 3.0 ) ; gl_FragColor . a = 1.0 ;".split(" ")}]}},{type:"elif",c:["POST_EFFECT","POST_EFFECT_X_BLUR",{type:"equal_expr",d:2},"POST_EFFECT","POST_EFFECT_Y_BLUR",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ae = vec2 ( 0.0 , 0.0 ) ; Af = u_texel_size ; Ag = texture2D ( u_color , bJ ) ; gl_FragColor = Ag * 0.2270270270 ; Ae += Af ; Ag = texture2D ( u_color , bJ + Ae ) ; gl_FragColor += Ag * 0.1945945946 ; Ag = texture2D ( u_color , bJ - Ae ) ; gl_FragColor += Ag * 0.1945945946 ; Ae += Af ; Ag = texture2D ( u_color , bJ + Ae ) ; gl_FragColor += Ag * 0.1216216216 ; Ag = texture2D ( u_color , bJ - Ae ) ; gl_FragColor += Ag * 0.1216216216 ; Ae += Af ; Ag = texture2D ( u_color , bJ + Ae ) ; gl_FragColor += Ag * 0.0540540541 ; Ag = texture2D ( u_color , bJ - Ae ) ; gl_FragColor += Ag * 0.0540540541 ; Ae += Af ; Ag = texture2D ( u_color , bJ + Ae ) ; gl_FragColor += Ag * 0.0162162162 ; Ag = texture2D ( u_color , bJ - Ae ) ; gl_FragColor += Ag * 0.0162162162 ;".split(" ")}]}},
{type:"elif",c:["POST_EFFECT","POST_EFFECT_X_GLOW_BLUR",{type:"equal_expr",d:2},"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ae = vec2 ( 0.0 , 0.0 ) ; Af = u_texel_size ; Ag = texture2D ( u_color , bJ ) ; gl_FragColor = Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.152507 ; Ae += Af ; Ag = texture2D ( u_color , bJ + Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.141763 ; Ag = texture2D ( u_color , bJ - Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.141763 ; Ae += Af ; Ag = texture2D ( u_color , bJ + Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.113861 ; Ag = texture2D ( u_color , bJ - Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.113861 ; Ae += Af ; Ag = texture2D ( u_color , bJ + Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.079019 ; Ag = texture2D ( u_color , bJ - Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.079019 ; Ae += Af ; Ag = texture2D ( u_color , bJ + Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.047383 ; Ag = texture2D ( u_color , bJ - Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.047383 ; Ae += Af ; Ag = texture2D ( u_color , bJ + Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.024549 ; Ag = texture2D ( u_color , bJ - Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.024549 ; Ae += Af ; Ag = texture2D ( u_color , bJ + Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.01099 ; Ag = texture2D ( u_color , bJ - Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.01099 ; Ae += Af ; Ag = texture2D ( u_color , bJ + Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.00425 ; Ag = texture2D ( u_color , bJ - Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.00425 ; Ae += Af ; Ag = texture2D ( u_color , bJ + Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.00142 ; Ag = texture2D ( u_color , bJ - Ae ) ; gl_FragColor += Ag * ( 1.0 - step ( 0.0 , - Ag . a ) ) * 0.00142 ; gl_FragColor = clamp ( gl_FragColor , 0.0 , 1.0 ) ;".split(" ")}]}},
{type:"elif",c:["POST_EFFECT","POST_EFFECT_X_EXTEND",{type:"equal_expr",d:2},"POST_EFFECT","POST_EFFECT_Y_EXTEND",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Af = u_texel_size ; Ag = texture2D ( u_color , bJ ) ; gl_FragColor = Ag ; if ( Ag . a == 0.0 ) { Ag = texture2D ( u_color , bJ + Af ) ; if ( Ag . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , Ag . a ) ; else { Ag = texture2D ( u_color , bJ - Af ) ; if ( Ag . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , Ag . a ) ; } }".split(" ")}]}},
{type:"elif",c:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"zX = u_delta [ 0 ] ; Ab = u_delta [ 1 ] ; Ac = 1.0 / 3.0 ; Ad = 0.5 ; Af = vec2 ( Ac , Ad ) ; if ( u_tex_number == 0 ) { Ae = bJ * Af + vec2 ( 2.0 * Ac , 0.0 ) ; Ae [ 0 ] = min ( Ae [ 0 ] , 1.0 - zX ) ; Ae [ 1 ] = min ( Ae [ 1 ] , 0.5 - Ab ) ; gl_FragColor = texture2D ( u_color , vec2 ( 5.0 * Ac - Ae [ 0 ] , Ae [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { Ae = bJ * Af ; Ae [ 0 ] = max ( Ae [ 0 ] , zX ) ; Ae [ 1 ] = min ( Ae [ 1 ] , 0.5 - Ab ) ; gl_FragColor = texture2D ( u_color , vec2 ( Ac - Ae [ 0 ] , Ae [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { Ae = bJ * Af + vec2 ( Ac , Ad ) ; Ae [ 0 ] = max ( Ae [ 0 ] , Ac + zX ) ; Ae [ 0 ] = min ( Ae [ 0 ] , 2.0 * Ac - zX ) ; Ae [ 1 ] = min ( Ae [ 1 ] , 1.0 - Ab ) ; gl_FragColor = texture2D ( u_color , vec2 ( Ae [ 0 ] , 3.0 * Ad - Ae [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { Ae = bJ * Af + vec2 ( 0.0 , Ad ) ; Ae [ 0 ] = min ( Ae [ 0 ] , Ac - zX ) ; Ae [ 1 ] = min ( Ae [ 1 ] , 1.0 - Ab ) ; gl_FragColor = texture2D ( u_color , vec2 ( Ae [ 0 ] , 3.0 * Ad - Ae [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { Ae = bJ * Af + vec2 ( Ac , 0.0 ) ; Ae [ 0 ] = max ( Ae [ 0 ] , Ac + zX ) ; Ae [ 0 ] = min ( Ae [ 0 ] , 2.0 * Ac - zX ) ; Ae [ 1 ] = min ( Ae [ 1 ] , 0.5 - Ab ) ; gl_FragColor = texture2D ( u_color , vec2 ( 1.0 - Ae [ 0 ] , Ae [ 1 ] ) ) ; } else { Af = bJ * Af + vec2 ( 2.0 * Ac , Ad ) ; Af [ 0 ] = min ( Af [ 0 ] , 1.0 - zX ) ; Af [ 1 ] = max ( Af [ 1 ] , 0.5 + Ab ) ; gl_FragColor = texture2D ( u_color , vec2 ( 5.0 * Ac - Af [ 0 ] , Af [ 1 ] ) ) ; }".split(" ")}]}}]},
{type:"textline",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec2 a_position ; varying vec2 bJ ; void main ( ) { bJ = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"color_util.glslf"},{type:"include",file:"pack.glslf"},{type:"define",name:"SMAA_RESOLVE",b:["1"]},{type:"define",
name:"SMAA_EDGE_DETECTION",b:["2"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{type:"define",name:"AA_METHOD_SMAA_LOW",b:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",b:["4"]},{type:"textline",b:["uniform","sampler2D","u_color",";"]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_blend",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",d:2},"SMAA_PREDICATION",{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},{type:"textline",b:"uniform vec2 u_texel_size ; varying vec2 bJ ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","Bs",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"varying vec4 Bt ; varying vec4 Bu ; varying vec4 Bv ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","Bw",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.15"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_HIGH",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.05"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",
b:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["16"]},{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_DEPTH_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS_DIAG",
group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_CORNER_ROUNDING",group:{type:"group",a:[{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",group:{type:"group",a:[{type:"define",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION",group:{type:"group",a:[{type:"define",
name:"SMAA_PREDICATION",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_SCALE",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_STRENGTH",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},
{type:"condition",a:[{type:"ifndef",name:"SMAA_REPROJECTION",group:{type:"group",a:[{type:"define",name:"SMAA_REPROJECTION",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_REPROJECTION_WEIGHT_SCALE",group:{type:"group",a:[{type:"define",name:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},
{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{type:"define",name:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{type:"define",name:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{type:"define",name:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{type:"define",name:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{type:"define",name:"SMAA_CORNER_ROUNDING_NORM",b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 BC ( vec2 Bx , sampler2D By ) { float Bz , BA , BB ; Bz = texture2D ( By , Bx ) . r ; BA = texture2D ( By , Bt . xy ) . r ; BB = texture2D ( By , Bt . zw ) . r ; return vec3 ( Bz , BA , BB ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 BH ( vec2 BD , sampler2D BE ) { vec2 BF ; vec3 BG ; BG = BC ( BD , BE ) ; BF = abs ( BG . xx - BG . yz ) ; BF = step ( SMAA_PREDICATION_THRESHOLD , BF ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * BF ) ; }".split(" ")}]}}]},
{type:"textline",b:"void BL ( bvec2 BI , inout vec2 BJ , vec2 BK ) { if ( BI . x ) BJ . x = BK . x ; if ( BI . y ) BJ . y = BK . y ; } void BL ( bvec4 BM , inout vec4 BN , vec4 BO ) { BL ( BM . xy , BN . xy , BO . xy ) ; BL ( BM . zw , BN . zw , BO . zw ) ; } vec2 BQ ( vec2 BP ) { return sign ( BP ) * floor ( abs ( BP ) + .5 ) ; } vec4 BQ ( vec4 BR ) { return sign ( BR ) * floor ( abs ( BR ) + .5 ) ; }".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",
d:2}],group:{type:"group",a:[{type:"textline",b:"vec2 Cd ( vec2 BS , sampler2D BT".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","BU"]}]}}]},{type:"textline",b:") { vec4 BV ; float BW , BX , BY , BZ , B_ ; vec3 Ca ; vec2 Cb , Cc ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",b:"Cb = BH ( BS , BU ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"Cb = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{type:"textline",b:"Ca = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; BW = dot ( texture2D ( BT , BS ) . rgb , Ca ) ; BX = dot ( texture2D ( BT , Bt . xy ) . rgb , Ca ) ; BY = dot ( texture2D ( BT , Bt . zw ) . rgb , Ca ) ; BV . xy = abs ( BW - vec2 ( BX , BY ) ) ; Cb = step ( Cb , BV . xy ) ; if ( dot ( Cb , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; BZ = dot ( texture2D ( BT , Bu . xy ) . rgb , Ca ) ; B_ = dot ( texture2D ( BT , Bu . zw ) . rgb , Ca ) ; BV . zw = abs ( BW - vec2 ( BZ , B_ ) ) ; Cc = max ( BV . xy , BV . zw ) ; B_ = dot ( texture2D ( BT , Bv . xy ) . rgb , Ca ) ; BZ = dot ( texture2D ( BT , Bv . zw ) . rgb , Ca ) ; BV . zw = abs ( vec2 ( BX , BY ) - vec2 ( B_ , BZ ) ) ; Cc = max ( Cc . xy , BV . zw ) ; BZ = max ( Cc . x , Cc . y ) ; Cb . xy *= step ( BZ , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * BV . xy ) ; return Cb ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"vec2 Cf ( vec2 Ce ) { Ce . r = Ce . r * abs ( 5.0 * Ce . r - 5.0 * 0.75 ) ; return BQ ( Ce ) ; } vec4 Cf ( vec4 Cg ) { Cg . rb = Cg . rb * abs ( 5.0 * Cg . rb - 5.0 * 0.75 ) ; return BQ ( Cg ) ; } vec2 Co ( sampler2D Ch , vec2 Ci , vec2 Cj , out vec2 Ck ) { vec3 Cl ; vec4 Cm ; Cm = vec4 ( Ci , - 1.0 , 1.0 ) ; Cl = vec3 ( u_texel_size , 1.0 ) ; for ( int Cn = 0 ; Cn < SMAA_MAX_SEARCH_STEPS_DIAG ; Cn ++ ) { if ( Cm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && Cm . w > 0.9 ) { Cm . xyz += Cl * vec3 ( Cj , 1.0 ) ; Ck = texture2D ( Ch , Cm . xy , 0.0 ) . rg ; Cm . w = dot ( Ck , vec2 ( 0.5 , 0.5 ) ) ; } } return Cm . zw ; } vec2 Cw ( sampler2D Cp , vec2 Cq , vec2 Cr , out vec2 Cs ) { vec3 Ct ; vec4 Cu ; Cu = vec4 ( Cq , - 1.0 , 1.0 ) ; Cu . x += 0.25 * u_texel_size . x ; Ct = vec3 ( u_texel_size , 1.0 ) ; for ( int Cv = 0 ; Cv < SMAA_MAX_SEARCH_STEPS_DIAG ; Cv ++ ) { if ( Cu . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && Cu . w > 0.9 ) { Cu . xyz = Ct * vec3 ( Cr , 1.0 ) + Cu . xyz ; Cs = texture2D ( Cp , Cu . xy , 0.0 ) . rg ; Cs = Cf ( Cs ) ; Cu . w = dot ( Cs , vec2 ( 0.5 , 0.5 ) ) ; } } return Cu . zw ; } vec2 CC ( sampler2D Cx , vec2 Cy , vec2 Cz , float CA ) { vec2 CB ; CB = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * Cz + Cy ; CB = SMAA_AREATEX_PIXEL_SIZE * CB + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; CB . x += 0.5 ; CB . y += SMAA_AREATEX_SUBTEX_SIZE * CA ; return texture2D ( Cx , CB , 0.0 ) . rg ; } vec2 CO ( sampler2D CD , sampler2D CE , vec2 CF , vec2 CG , vec4 CH ) { vec4 CI , CJ , CK ; vec2 CL , CM , CN ; CL = vec2 ( 0.0 , 0.0 ) ; if ( CG . r > 0.0 ) { CI . xz = Co ( CD , CF , vec2 ( - 1.0 , 1.0 ) , CM ) ; CI . x += float ( CM . y > 0.9 ) ; } else CI . xz = vec2 ( 0.0 , 0.0 ) ; CI . yw = Co ( CD , CF , vec2 ( 1.0 , - 1.0 ) , CM ) ; if ( CI . x + CI . y > 2.0 ) { CJ = vec4 ( - CI . x + 0.25 , CI . x , CI . y , - CI . y - 0.25 ) * u_texel_size . xyxy + CF . xyxy ; CK . xy = texture2D ( CD , CJ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; CK . zw = texture2D ( CD , CJ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; CK . yxwz = Cf ( CK . xyzw ) ; CN = vec2 ( 2.0 , 2.0 ) * CK . xz + CK . yw ; BL ( bvec2 ( step ( 0.9 , CI . zw ) ) , CN , vec2 ( 0.0 , 0.0 ) ) ; CL += CC ( CE , CI . xy , CN , CH . z ) ; } CI . xz = Cw ( CD , CF , vec2 ( - 1 , - 1 ) , CM ) ; if ( texture2D ( CD , CF + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { CI . yw = Cw ( CD , CF , vec2 ( 1 , 1 ) , CM ) ; CI . y += float ( CM . y > 0.9 ) ; } else CI . yw = vec2 ( 0.0 , 0.0 ) ; if ( CI . x + CI . y > 2.0 ) { CK = vec4 ( - CI . x , - CI . x , CI . y , CI . y ) * u_texel_size . xyxy + CF . xyxy ; CJ . x = texture2D ( CD , CK . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; CJ . y = texture2D ( CD , CK . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; CJ . zw = texture2D ( CD , CK . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; CM = vec2 ( 2.0 , 2.0 ) * CJ . xz + CJ . yw ; BL ( bvec2 ( step ( 0.9 , CI . zw ) ) , CM , vec2 ( 0 , 0 ) ) ; CL += CC ( CE , CI . xy , CM , CH . w ) . gr ; } return CL ; }".split(" ")}]}}]},
{type:"textline",b:"float CU ( sampler2D CP , vec2 CQ , float CR ) { vec2 CS , CT ; CS = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; CT = SMAA_SEARCHTEX_SIZE * vec2 ( CR , 1.0 ) ; CS += vec2 ( - 1.0 , 1.0 ) ; CT += vec2 ( 0.5 , - 0.5 ) ; CS *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; CT *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return texture2D ( CP , CS * CQ + CT , 0.0 ) . r ; } float Db ( sampler2D CV , sampler2D CW , vec2 CX , float CY ) { float CZ ; vec2 C_ ; C_ = vec2 ( 0.0 , 1.0 ) ; for ( int Da = 0 ; Da < SMAA_MAX_SEARCH_STEPS ; Da ++ ) { if ( CX . x > CY && C_ . g > 0.8281 && C_ . r == 0.0 ) { C_ = texture2D ( CV , CX , 0.0 ) . rg ; CX = - vec2 ( 2.0 , 0.0 ) * u_texel_size + CX ; } } CZ = - ( 255.0 / 127.0 ) * CU ( CW , C_ , 0.0 ) + 3.25 ; return u_texel_size . x * CZ + CX . x ; } float Dj ( sampler2D Dc , sampler2D Dd , vec2 De , float Df ) { float Dg ; vec2 Dh ; Dh = vec2 ( 0.0 , 1.0 ) ; for ( int Di = 0 ; Di < SMAA_MAX_SEARCH_STEPS ; Di ++ ) { if ( De . x < Df && Dh . g > 0.8281 && Dh . r == 0.0 ) { Dh = texture2D ( Dc , De , 0.0 ) . rg ; De = vec2 ( 2.0 , 0.0 ) * u_texel_size + De ; } } Dg = - ( 255.0 / 127.0 ) * CU ( Dd , Dh , 0.5 ) + 3.25 ; return - u_texel_size . x * Dg + De . x ; } float Dr ( sampler2D Dk , sampler2D Dl , vec2 Dm , float Dn ) { float Do ; vec2 Dp ; Dp = vec2 ( 1.0 , 0.0 ) ; for ( int Dq = 0 ; Dq < SMAA_MAX_SEARCH_STEPS ; Dq ++ ) { if ( Dm . y > Dn && Dp . r > 0.8281 && Dp . g == 0.0 ) { Dp = texture2D ( Dk , Dm , 0.0 ) . rg ; Dm = - vec2 ( 0.0 , 2.0 ) * u_texel_size + Dm ; } } Do = - ( 255.0 / 127.0 ) * CU ( Dl , Dp . gr , 0.0 ) + 3.25 ; return u_texel_size . y * Do + Dm . y ; } float Dz ( sampler2D Ds , sampler2D Dt , vec2 Du , float Dv ) { float Dw ; vec2 Dx ; Dx = vec2 ( 1.0 , 0.0 ) ; for ( int Dy = 0 ; Dy < SMAA_MAX_SEARCH_STEPS ; Dy ++ ) { if ( Du . y < Dv && Dx . r > 0.8281 && Dx . g == 0.0 ) { Dx = texture2D ( Ds , Du , 0.0 ) . rg ; Du = vec2 ( 0.0 , 2.0 ) * u_texel_size + Du ; } } Dw = - ( 255.0 / 127.0 ) * CU ( Dt , Dx . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * Dw + Du . y ; } vec2 DG ( sampler2D DA , vec2 DB , float DC , float DD , float DE ) { vec2 DF ; DF = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * BQ ( 4.0 * vec2 ( DC , DD ) ) + DB ; DF = SMAA_AREATEX_PIXEL_SIZE * DF + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; DF . y = SMAA_AREATEX_SUBTEX_SIZE * DE + DF . y ; return texture2D ( DA , DF , 0.0 ) . rg ; } void DN ( sampler2D DH , inout vec2 DI , vec4 DJ , vec2 DK ) { vec2 DL , DM ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"DL = step ( DK . xy , DK . yx ) ; DM = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * DL ; DM /= DL . x + DL . y ; DL = vec2 ( 1.0 , 1.0 ) ; DL . x -= DM . x * texture2D ( DH , DJ . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; DL . x -= DM . y * texture2D ( DH , DJ . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; DL . y -= DM . x * texture2D ( DH , DJ . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; DL . y -= DM . y * texture2D ( DH , DJ . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; DI *= clamp ( DL , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"} void DU ( sampler2D DO , inout vec2 DP , vec4 DQ , vec2 DR ) { vec2 DS , DT ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_CORNER_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"DS = step ( DR . xy , DR . yx ) ; DT = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * DS ; DT /= DS . x + DS . y ; DS = vec2 ( 1.0 , 1.0 ) ; DS . x -= DT . x * texture2D ( DO , DQ . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; DS . x -= DT . y * texture2D ( DO , DQ . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; DS . y -= DT . x * texture2D ( DO , DQ . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; DS . y -= DT . y * texture2D ( DO , DQ . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; DP *= clamp ( DS , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 Eh ( vec2 DV , vec2 DW , sampler2D DX , sampler2D DY , sampler2D DZ , vec4 D_ ) { float Ea , Eb ; vec3 Ec ; vec2 Ed , Ee , Ef ; vec4 Eg ; Eg = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; Ed = texture2D ( DX , DV ) . rg ; if ( Ed . g > 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",
d:1}],group:{type:"group",a:[{type:"textline",b:"Eg . rg = CO ( DX , DY , DV , Ed , D_ ) ; if ( Eg . r == - Eg . g ) {".split(" ")}]}}]},{type:"textline",b:"; Ec . x = Db ( DX , DZ , Bt . xy , Bv . x ) ; Ec . y = Bu . y ; Ee . x = Ec . x ; Ea = texture2D ( DX , Ec . xy , 0.0 ) . r ; Ec . z = Dj ( DX , DZ , Bt . zw , Bv . y ) ; Ee . y = Ec . z ; Ee = abs ( BQ ( Ee / u_texel_size . xx - DW . xx ) ) ; Ef = sqrt ( Ee ) ; Eb = texture2D ( DX , Ec . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; Eg . rg = DG ( DY , Ef , Ea , Eb , D_ . y ) ; Ec . y = DV . y ; DN ( DX , Eg . rg , Ec . xyzy , Ee ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_DISABLE_DIAG_DETECTION",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"} else Ed . r = 0.0 ;".split(" ")}]}}]},{type:"textline",b:"} if ( Ed . r > 0.0 ) { ; Ec . y = Dr ( DX , DZ , Bu . xy , Bv . z ) ; Ec . x = Bt . x ; Ed . x = Ec . y ; Eb = texture2D ( DX , Ec . xy , 0.0 ) . g ; Ec . z = Dz ( DX , DZ , Bu . zw , Bv . w ) ; Ed . y = Ec . z ; Ed = abs ( BQ ( Ed / u_texel_size . yy - DW . yy ) ) ; Ee = sqrt ( Ed ) ; Ea = texture2D ( DX , Ec . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; Eg . ba = DG ( DY , Ee , Eb , Ea , D_ . x ) ; Ec . x = DV . x ; DU ( DX , Eg . ba , Ec . xyxz , Ed ) ; } return Eg ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 Et ( vec2 Ei , sampler2D Ej , sampler2D Ek".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","El"]}]}}]},{type:"textline",b:") { bool Em ; vec2 En , Eo , Ep ; vec4 Eq , Er , Es ; Eq . x = texture2D ( Ek , Bs . xy ) . a ; Eq . y = texture2D ( Ek , Bs . zw ) . g ; Eq . wz = texture2D ( Ek , Ei ) . xz ; if ( dot ( Eq , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { Er = texture2D ( Ej , Ei , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"Es = texture2D ( El , bJ ) ; En = 2.0 * s ( Es ) - 1.0 ; Er . a = sqrt ( 2.0 * length ( En ) ) ;".split(" ")}]}}]},{type:"textline",b:"return Er ; } else { Em = max ( Eq . x , Eq . z ) > max ( Eq . y , Eq . w ) ; Er = vec4 ( 0.0 , Eq . y , 0.0 , Eq . w ) ; En = Eq . yw ; BL ( bvec4 ( Em , Em , Em , Em ) , Er , vec4 ( Eq . x , 0.0 , Eq . z , 0.0 ) ) ; BL ( bvec2 ( Em , Em ) , En , Eq . xz ) ; En /= dot ( En , vec2 ( 1.0 , 1.0 ) ) ; Er = Er * vec4 ( u_texel_size , - u_texel_size ) + Ei . xyxy ; Eq = En . x * texture2D ( Ej , Er . xy , 0.0 ) ; Eq += En . y * texture2D ( Ej , Er . zw , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"Es = texture2D ( El , Er . xy ) ; Eo = 2.0 * s ( Es ) - 1.0 ; Ep = En . x * Eo ; Es = texture2D ( El , Er . zw ) ; Eo = 2.0 * s ( Es ) - 1.0 ; Ep += En . y * Eo ; Eq . a = sqrt ( 2.0 * length ( Ep ) ) ;".split(" ")}]}}]},{type:"textline",b:["return","Eq",";","}","}"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 ED ( vec2 Eu , sampler2D Ev , sampler2D Ew".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","Ex"]}]}}]},{type:"textline",b:") { float Ey ; vec2 Ez ; vec4 EA , EB , EC ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"EA = texture2D ( Ex , bJ ) ; Ez = 2.0 * s ( EA ) - 1.0 ; EA = texture2D ( Ev , Eu ) ; EB = texture2D ( Ew , Eu - Ez ) ; Ey = abs ( EA . a * EA . a - EB . a * EB . a ) / 2.0 ; Ey = 0.5 * clamp ( 1.0 - sqrt ( Ey ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; EC = mix ( EA , EB , Ey ) ; EC . a = 1.0 ; return EC ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"EA = texture2D ( Ev , Eu ) ; EB = texture2D ( Ew , Eu ) ; return mix ( EA , EB , 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:"void main ( ) { vec4 EE ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"EE = vec4 ( Cd ( bJ , u_color".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",
a:[{type:"textline",b:[",","u_predication_tex"]}]}}]},{type:"textline",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"EE = Eh ( bJ , Bw , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"EE = Et ( bJ , u_color , u_blend".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","u_velocity_tex"]}]}}]},{type:"textline",b:[")",";"]}]}},{type:"elif",c:["SMAA_PASS","SMAA_RESOLVE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"EE = vec4 ( ED ( bJ , u_color , u_color_prev".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","u_velocity_tex"]}]}}]},{type:"textline",b:[")",")",";"]}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:"EE = texture2D ( u_color , bJ ) ;".split(" ")}]}}]},{type:"textline",b:["gl_FragColor","=","EE",";","}"]}]};a["postprocessing/smaa.glslv"]={type:"group",a:[{type:"define",name:"SMAA_EDGE_DETECTION",b:["1"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["2"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_LOW",b:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",
b:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",b:["4"]},{type:"textline",b:"attribute vec2 a_position ; uniform vec2 u_texel_size ; varying vec2 bJ ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec4","Bs",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"varying vec4 Bt ; varying vec4 Bu ; varying vec4 Bv ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec2","Bw",";"]}]}}]},{type:"condition",a:[{type:"if",c:["AA_METHOD","AA_METHOD_SMAA_LOW",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{type:"elif",c:["AA_METHOD",
"AA_METHOD_SMAA_HIGH",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{type:"elif",c:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",
{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void Ab ( vec2 zX ) { Bt = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + zX . xyxy ; Bu = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + zX . xyxy ; Bv = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + zX . xyxy ; }".split(" ")}]}},{type:"elif",c:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void Ae ( vec2 Ac , out vec2 Ad ) { Ad = Ac / u_texel_size ; Bt = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + Ac . xyxy ; Bu = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + Ac . xyxy ; Bv = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( Bt . xz , Bu . yw ) ; }".split(" ")}]}},
{type:"elif",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void Ag ( vec2 Af ) { Bs = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + Af . xyxy ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { bJ = 2.0 * a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","SMAA_EDGE_DETECTION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["Ab","(","bJ",")",";"]}]}},{type:"elif",c:["SMAA_PASS",
"SMAA_BLENDING_WEIGHT_CALCULATION",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"Ae ( bJ , Bw ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["Ag","(","bJ",")",";"]}]}}]},{type:"textline",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",
b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"define",name:"SSAO_QUALITY_8",b:["1"]},{type:"define",name:"SSAO_QUALITY_16",b:["2"]},{type:"define",name:"SSAO_QUALITY_24",b:["3"]},{type:"define",name:"SSAO_QUALITY_32",b:["4"]},{type:"textline",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; varying vec2 bJ ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; float Ab ( in vec2 zX ) { return Bn ( u_depth , zX , u_camera_range ) ; } void main ( ) { vec3 Ac , Ad , Ae ; float Af , Ag , Ah , Ai , Aj , Ak , Al ; Af = texture2D ( u_color , bJ ) . r ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SSAO_WHITE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( Af , 1.0 , 0.0 , 1.0 ) ; return ;".split(" ")}]}}]},{type:"textline",b:"Ac = normalize ( 2.0 * texture2D ( u_ssao_special_tex , bJ * 0.25 / u_texel_size ) . rgb - 1.0 ) ; Ag = Ab ( bJ ) ; Ah = Ag * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_QUALITY","SSAO_QUALITY_8",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",
b:"const float Am = 8.0 ; const int An = 1 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","SSAO_QUALITY_16",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"const float Am = 16.0 ; const int An = 2 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","SSAO_QUALITY_24",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"const float Am = 24.0 ; const int An = 3 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","SSAO_QUALITY_32",{type:"equal_expr",d:2}],group:{type:"group",
a:[{type:"textline",b:"const float Am = 32.0 ; const int An = 4 ;".split(" ")}]}}]},{type:"textline",b:"Ai = u_ssao_radius_increase * 0.001 ; const float Ao = 1.0 + 2.4 / Am ; Aj = 0.0 ; for ( int Ap = 0 ; Ap < An ; Ap ++ ) for ( int Aq = - 1 ; Aq <= 1 ; Aq += 2 ) for ( int Bx = - 1 ; Bx <= 1 ; Bx += 2 ) for ( int By = - 1 ; By <= 1 ; By += 2 ) { Ad = reflect ( normalize ( vec3 ( Aq , Bx , By ) ) , Ac ) * ( Ai *= Ao ) ; Ae = vec3 ( bJ , Ah ) ; Ae += vec3 ( Ad . xy , Ad . z * Ah * 2.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"Ae . z -= 1.4 * ( Ae . z - Ah ) * step ( Ah , Ae . z ) ;".split(" ")}]}}]},{type:"textline",b:"Ak = Ab ( Ae . xy ) * ( u_camera_range . y - u_camera_range . x ) ; Al = clamp ( ( Ah - Ak ) / Ak , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"Aj += mix ( 1.0 , Al , step ( Ak , Ae . z ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"Aj += mix ( step ( Ae . z , Ak ) , 0.5 , Al ) ;".split(" ")}]}}]},{type:"textline",b:"} Aj = Aj / Am ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"Aj = clamp ( Aj * Aj + 0.6 * Aj , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Aj = clamp ( Aj * Aj + Aj , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"Ag = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * Ag ) ; Aj = mix ( 1.0 , Aj , Ag ) ; gl_FragColor = vec4 ( Af , Aj , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/ssao_blur.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"include",file:"depth_fetch.glslf"}]}}]},{type:"textline",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; varying vec2 bJ ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",
a:[{type:"textline",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float Ab ( in vec2 zX ) { return Bn ( u_depth , zX , u_camera_range ) ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { vec2 Ac , Ad ; float Ae , Af , Ag , Ah , Ai , Aj , Ak ; Ae = 0.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"Af = Ab ( bJ ) ; Ag = 0.0 ; Ah = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},
{type:"textline",b:"Ac = vec2 ( - 2.0 ) ; for ( int Al = 0 ; Al < 4 ; ++ Al ) { for ( int Am = 0 ; Am < 4 ; ++ Am ) { Ad = ( Ac + vec2 ( float ( Al ) , float ( Am ) ) ) * u_texel_size ; Ai = texture2D ( u_ssao_mask , bJ + Ad ) . g ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"Aj = Ab ( bJ + Ad ) ; Ak = 1.0 - clamp ( abs ( Aj - Af ) * Ah , 0.0 , 1.0 ) ; Ae += Ai * Ak ; Ag += Ak ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:["Ae","+=","Ai",";"]}]}}]},{type:"textline",b:["}","}"]},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , bJ ) . r , Ae / Ag , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , bJ ) . r , Ae / 16.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/velocity.glslf"]={type:"group",a:[{type:"include",
file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; varying vec2 bJ ; void main ( ) { vec2 zX ; vec4 Ab , Ac ; float Ad ; Ad = texture2D ( u_depth , bJ ) . x ; Ab = vec4 ( bJ * 2.0 - 1.0 , 2.0 * Ad - 1.0 , 1.0 ) ; Ac = u_view_proj_inverse * Ab ; Ac = Ac / Ac . w ; Ac = u_view_proj_prev * Ac ; Ac /= Ac . w ; zX = ( Ab . xy - Ac . xy ) / 4.0 + 0.5 ; zX = clamp ( zX , 0.0 , 1.0 ) ; gl_FragColor = g ( zX ) ; }".split(" ")}]};
a["include/precision_statement.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","float",";"]}]};a["include/std_enums.glsl"]={type:"group",a:[{type:"define",name:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{type:"define",name:"TEXTURE_COORDS_NORMAL",b:["2"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MULTIPLY",b:["2"]},{type:"define",name:"SHADOW_SRC_NONE",b:["1"]},{type:"define",name:"SHADOW_SRC_DEPTH",
b:["2"]},{type:"define",name:"SHADOW_SRC_MASK",b:["3"]},{type:"define",name:"SHADOW_DST_NONE",b:["1"]},{type:"define",name:"SHADOW_DST_DEPTH",b:["2"]},{type:"define",name:"SHADOW_DST_MASK",b:["3"]},{type:"define",name:"NO_SHADOWS",b:["1"]},{type:"define",name:"SHADOW_CASTING",b:["2"]},{type:"define",name:"SHADOW_MASK_GENERATION",b:["3"]},{type:"define",name:"SHADOW_MAPPING_OPAQUE",b:["4"]},{type:"define",name:"SHADOW_MAPPING_BLEND",b:["5"]},{type:"define",name:"SPECULAR_PHONG",b:["1"]},{type:"define",
name:"SPECULAR_COOKTORR",b:["2"]},{type:"define",name:"SPECULAR_WARDISO",b:["3"]},{type:"define",name:"SPECULAR_BLINN",b:["4"]},{type:"define",name:"SPECULAR_TOON",b:["5"]},{type:"define",name:"DIFFUSE_LAMBERT",b:["1"]},{type:"define",name:"DIFFUSE_OREN_NAYAR",b:["2"]},{type:"define",name:"DIFFUSE_FRESNEL",b:["3"]},{type:"define",name:"DIFFUSE_MINNAERT",b:["4"]},{type:"define",name:"DIFFUSE_TOON",b:["5"]},{type:"define",name:"MAPPING_TYPE_TEXTURE",b:["0.0"]},{type:"define",name:"MAPPING_TYPE_POINT",
b:["1.0"]},{type:"define",name:"MAPPING_TYPE_VECTOR",b:["2.0"]},{type:"define",name:"MAPPING_TYPE_NORMAL",b:["3.0"]},{type:"define",name:"MIX",b:["0"]},{type:"define",name:"ADD",b:["1"]},{type:"define",name:"SUBTRACT",b:["2"]},{type:"define",name:"MULTIPLY",b:["3"]},{type:"define",name:"SCREEN",b:["4"]},{type:"define",name:"OVERLAY",b:["5"]},{type:"define",name:"DIFFERENCE",b:["6"]},{type:"define",name:"DIVIDE",b:["7"]},{type:"define",name:"DARKEN",b:["8"]},{type:"define",name:"LIGHTEN",b:["9"]},
{type:"define",name:"HUE",b:["10"]},{type:"define",name:"SATURATION",b:["11"]},{type:"define",name:"VALUE",b:["12"]},{type:"define",name:"COLOR",b:["13"]},{type:"define",name:"SOFT_LIGHT",b:["14"]},{type:"define",name:"LINEAR_LIGHT",b:["15"]},{type:"define",name:"REFL_NONE",b:["0"]},{type:"define",name:"REFL_MIRRORMAP",b:["1"]},{type:"define",name:"REFL_PLANE",b:["2"]},{type:"define",name:"REFL_CUBE",b:["3"]},{type:"define",name:"INVERSE_QUADRATIC",b:["0"]},{type:"define",name:"LINEAR",b:["1"]},{type:"define",
name:"QUADRATIC",b:["2"]},{type:"define",name:"HEMI",b:["1"]},{type:"define",name:"SPOT",b:["2"]},{type:"define",name:"POINT",b:["3"]},{type:"define",name:"SUN",b:["4"]}]};a["include/pack.glslf"]={type:"group",a:[{type:"textline",b:"float a = 255.0 ; float b = 0.0 ; float c = 1.0 ; vec4 g ( const in float d ) { vec4 e , f ; e = vec4 ( a * a * a , a * a , a , c ) ; f = vec4 ( b , c / a , c / a , c / a ) ; e = fract ( d * e ) ; e -= e . xxyz * f ; return e ; } float k ( const in vec4 h ) { vec4 i ; float j ; i = vec4 ( c / ( a * a * a ) , c / ( a * a ) , c / a , c ) ; j = dot ( h , i ) ; return j ; } vec4 g ( const in vec2 l ) { vec4 m ; vec2 n , o ; n = vec2 ( a , c ) ; o = vec2 ( b , c / a ) ; m = fract ( l . xxyy * n . xyxy ) ; m -= m . xxzz * o . xyxy ; if ( l . r == c ) m . rg = vec2 ( b , c ) ; if ( l . g == c ) m . ba = vec2 ( b , c ) ; return m ; } vec2 s ( const in vec4 p ) { vec2 q , r ; r = vec2 ( c / a , c ) ; q . r = dot ( p . rg , r ) ; q . g = dot ( p . ba , r ) ; return q ; }".split(" ")}]};
a["include/procedural.glslf"]={type:"group",a:[{type:"textline",b:"float t = 0.0 ; float u = 1.0 ; vec4 w ( vec4 v ) { return v - floor ( v * ( u / 289.0 ) ) * 289.0 ; } vec3 w ( vec3 x ) { return x - floor ( x * ( u / 289.0 ) ) * 289.0 ; } vec2 w ( vec2 y ) { return y - floor ( y * ( u / 289.0 ) ) * 289.0 ; } vec4 A ( vec4 z ) { return z - floor ( z * ( u / 7.0 ) ) * 7.0 ; } vec4 C ( vec4 B ) { return w ( ( 34.0 * B + 5.0 ) * B ) ; }".split(" ")},{type:"define",name:"K",b:["0.142857142857"]},{type:"define",
name:"K2",b:["0.0714285714285"]},{type:"define",name:"JITTER",b:["0.7"]},{type:"textline",b:"vec2 L ( vec2 D ) { vec4 E , F , G , H ; vec2 I , J ; I = w ( floor ( D ) ) ; J = fract ( D ) ; E = J . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; F = J . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; G = C ( I . x + vec4 ( t , u , t , u ) ) ; G = C ( G + I . y + vec4 ( t , t , u , u ) ) ; H = A ( G ) * K + K2 ; G = A ( floor ( G * K ) ) * K + K2 ; H = E + JITTER * H ; G = F + JITTER * G ; G = H * H + G * G ;".split(" ")},
{type:"condition",a:[{type:"if",c:[1],group:{type:"group",a:[{type:"textline",b:"G . xy = min ( G . xy , G . zw ) ; G . x = min ( G . x , G . y ) ; return G . xx ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"G . xy = ( G . x < G . y ) ? G . xy : G . yx ; G . xz = ( G . x < G . z ) ? G . xz : G . zx ; G . xw = ( G . x < G . w ) ? G . xw : G . wx ; G . y = min ( G . y , G . z ) ; G . y = min ( G . y , G . w ) ; return sqrt ( G . xy ) ;".split(" ")}]}}]},{type:"textline",
b:"} vec3 U ( vec2 M , float N ) { vec4 O , P , Q , R ; vec2 S , T ; S = w ( floor ( M ) ) ; T = fract ( M ) ; O = T . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; P = T . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; Q = C ( S . x + vec4 ( t , u , t , u ) ) ; Q = C ( Q + S . y + vec4 ( t , t , u , u ) ) ; R = A ( Q ) * K + K2 ; Q = A ( floor ( Q * K ) ) * K + K2 ; R = O + JITTER * R ; Q = P + JITTER * Q ; P = R * R + Q * Q ; R += N ; Q += N ; O = R * R + Q * Q ; R += N ; Q += N ; Q = R * R + Q * Q ; P . xy = min ( P . xy , P . zw ) ; P . x = min ( P . x , P . y ) ; O . xy = min ( O . xy , O . zw ) ; O . x = min ( O . x , O . y ) ; Q . xy = min ( Q . xy , Q . zw ) ; Q . x = min ( Q . x , Q . y ) ; return vec3 ( P . x , O . x , Q . x ) ; } vec3 W ( vec3 V ) { return w ( ( ( V * 34.0 ) + u ) * V ) ; } float ag ( vec2 X ) { vec3 Y , Z , _ , aa ; vec4 ab ; vec2 ac , ad , ae ; const vec4 af = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; ac = floor ( X + dot ( X , af . yy ) ) ; ad = X - ac + dot ( ac , af . xx ) ; ae = ( ad . x > ad . y ) ? vec2 ( u , t ) : vec2 ( t , u ) ; ab = ad . xyxy + af . xxzz ; ab . xy -= ae ; ac = w ( ac ) ; Y = W ( W ( ac . y + vec3 ( t , ae . y , u ) ) + ac . x + vec3 ( t , ae . x , u ) ) ; Z = max ( 0.5 - vec3 ( dot ( ad , ad ) , dot ( ab . xy , ab . xy ) , dot ( ab . zw , ab . zw ) ) , t ) ; Z = Z * Z ; Z = Z * Z ; Y = 2.0 * fract ( Y * af . www ) - u ; _ = abs ( Y ) - 0.5 ; aa = floor ( Y + 0.5 ) ; aa = Y - aa ; Z *= 1.79284291400159 - 0.85373472095314 * ( aa * aa + _ * _ ) ; Y . x = aa . x * ad . x + _ . x * ad . y ; Y . yz = aa . yz * ab . xz + _ . yz * ab . yw ; return 130.0 * dot ( Z , Y ) ; } vec2 ak ( vec2 ah ) { float ai , aj ; ai = dot ( ah , vec2 ( 12.9898 , 78.233 ) ) ; aj = dot ( ah , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; ai = fract ( sin ( ai ) * 43758.5453 ) * 2.0 - u ; aj = fract ( sin ( aj ) * 43758.5453 ) * 2.0 - u ; return vec2 ( ai , aj ) ; }".split(" ")}]};
a["include/caustics.glslf"]={type:"group",a:[{type:"var",name:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{type:"var",name:"CAUST_SCALE",b:["0.0"]},{type:"var",name:"CAUST_BRIGHT",b:["0.0"]},{type:"define",name:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{type:"textline",b:"void aC ( inout vec3 al , float am , float an , float ao , vec3 ap , vec3 aq , vec3 ar , vec4 as , vec3 at , float au ) { float av , aw , ax ; vec2 ay , az ; vec3 aA ; vec4 aB ; if ( au > CAUSTICS_VIEW_DISTANCE ) return ; aB = as ; aA = at + ap ; aA . xz = 10.0 * sin ( 0.1 * aA . xz ) ; aA = aA + 2.0 * cross ( - aB . xyz , cross ( - aB . xyz , aA ) + aB . w * aA ) ; ay = aA . xz ; aA = aq ; av = max ( dot ( ap , aA ) , 0.0 ) ; aw = 0.025 ; az = CAUST_SPEED * an ; ay . s += 0.25 * sin ( dot ( at + an , vec3 ( 1.0 ) ) ) ; ay . t += 0.35 * ( - sin ( dot ( at - an , vec3 ( - 0.7 ) ) ) ) ; ay . st += 0.15 * cos ( 4.0 * am - az . x ) + 1.5 * sin ( am - 0.3 * az . y ) ; ax = CAUST_SCALE * ( 1.0 + max ( 0.1 * am , 0.0 ) ) ; aA = U ( ( ay / ax ) , aw ) ; aA *= CAUST_BRIGHT ; aA *= aA ; aw = min ( 0.25 * am , - am ) + 1.0 ; aw = max ( aw , 0.0 ) ; av = ao * av ; ax = max ( sign ( am ) , 0.0 ) ; av = av + max ( 0.5 * sign ( - ap . y ) * ax , 0.0 ) ; av = min ( av , 1.0 ) ; al += ar * aA * aw * av ; }".split(" ")}]};
a["include/color_util.glslf"]={type:"group",a:[{type:"define",name:"GAMMA",b:["1"]},{type:"define",name:"PREMULTIPLY_ALPHA",b:["1"]},{type:"textline",b:"void aE ( inout vec3 aD ) {".split(" ")},{type:"condition",a:[{type:"if",c:["GAMMA"],group:{type:"group",a:[{type:"textline",b:"aD = max ( vec3 ( 0.0 ) , aD ) ; aD = pow ( aD , vec3 ( 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} void aE ( inout float aF ) {".split(" ")},{type:"condition",a:[{type:"if",c:["GAMMA"],group:{type:"group",a:[{type:"textline",
b:"aF = pow ( max ( 0.0 , aF ) , 2.2 ) ;".split(" ")}]}}]},{type:"textline",b:"} void aH ( inout vec3 aG ) {".split(" ")},{type:"condition",a:[{type:"if",c:["GAMMA"],group:{type:"group",a:[{type:"textline",b:"aG = max ( vec3 ( 0.0 ) , aG ) ; aG = pow ( aG , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} void aK ( inout vec3 aI , in float aJ ) {".split(" ")},{type:"condition",a:[{type:"if",c:["PREMULTIPLY_ALPHA"],group:{type:"group",a:[{type:"textline",b:"aI = aI * aJ ;".split(" ")}]}}]},
{type:"textline",b:"} float aO ( vec4 aL ) { float aM ; vec3 aN ; aN = vec3 ( 0.299 , 0.587 , 0.114 ) ; aM = dot ( aL . rgb , aN ) ; return aM ; }".split(" ")}]};a["include/math.glslv"]={type:"group",a:[{type:"var",name:"EPSILON",b:["0.0001"]},{type:"textline",b:"float aP = 0.0 ; float aQ = 1.0 ; struct aR { vec3 a ; vec3 b ; vec3 c ; vec3 d ; vec3 e ; vec3 f ; } ; bool aU ( vec3 aS , vec3 aT ) { return any ( lessThan ( abs ( aS - aT ) , vec3 ( EPSILON ) ) ) ; } vec3 aX ( in vec4 aV , in vec3 aW ) { return aW + 2.0 * cross ( aV . xyz , cross ( aV . xyz , aW ) + aV . w * aW ) ; } vec4 aZ ( in vec4 aY ) { return vec4 ( - aY . xyz , aY . w ) / dot ( aY , aY ) ; } vec3 bd ( vec4 a_ , vec4 ba , vec4 bb ) { vec3 bc ; bc = bb . xyz * a_ . w ; bc = aX ( ba , bc ) ; bc += a_ . xyz * bb . w ; return bc ; } vec3 bj ( vec4 be , vec4 bf , vec4 bg ) { vec4 bh ; vec3 bi ; bi = bg . xyz - be . xyz * bg . w ; bh = aZ ( bf ) ; bi = aX ( bh , bi ) ; bi /= be . w ; return bi ; } mat4 bk ( ) { return mat4 ( aQ , aP , aP , aP , aP , aQ , aP , aP , aP , aP , aQ , aP , aP , aP , aP , aQ ) ; } mat4 bm ( float bl ) { return mat4 ( aQ , aP , aP , aP , aP , cos ( bl ) , sin ( bl ) , aP , aP , - sin ( bl ) , cos ( bl ) , aP , aP , aP , aP , aQ ) ; } mat4 bo ( float bn ) { return mat4 ( cos ( bn ) , aP , - sin ( bn ) , aP , aP , aQ , aP , aP , sin ( bn ) , aP , cos ( bn ) , aP , aP , aP , aP , aQ ) ; } mat4 bq ( float bp ) { return mat4 ( cos ( bp ) , sin ( bp ) , aP , aP , - sin ( bp ) , cos ( bp ) , aP , aP , aP , aP , aQ , aP , aP , aP , aP , aQ ) ; } aR bs ( in aR br ) { return aR ( br . a , br . b , normalize ( br . c ) , normalize ( br . d ) , normalize ( br . e ) , br . f ) ; }".split(" ")},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{type:"logical_or_expr",d:4}],group:{type:"group",a:[{type:"textline",b:"vec3 by ( vec4 bt ) { vec3 bu ; float bv , bw , bx ; bv = bt . x ; bw = bt . y ; bx = bt . w ; bu . x = ( bv + bx ) / 2.0 ; bu . y = ( bw + bx ) / 2.0 ; bu . z = bx ; return bu ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={type:"group",
a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"CSM_BLEND_BETWEEN_CASCADES",b:["1.0"]},{type:"var",name:"CSM_FADE_LAST_CASCADE",b:["1.0"]},{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["vec4","bK",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",
d:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"const float bL = 0.1 ; const float bM = 0.1 ; const float bN = - 0.01 ; const float bO = 0.05 ; vec4 bP = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 bQ = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 bR = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 bS = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 bT = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 bU = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 bV = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 bW = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ; bool bZ ( vec2 bX , float bY ) { return all ( lessThanEqual ( bX , vec2 ( 1.0 + bY ) ) ) && all ( greaterThanEqual ( bX , vec2 ( 0.0 - bY ) ) ) ; } float ch ( float b_ , float ca , mat2 cb , vec3 cc , float cd , PRECISION sampler2D ce ) { vec2 cf , cg ; cg . x = b_ ; cg . y = ca ; cg = cb * cg ; cf = cc . xy + cg * cd / SHADOW_TEX_RES ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"if ( ! bZ ( cf , bN ) ) return 1.0 ; else".split(" ")}]}}]},{type:"textline",b:"return step ( cc . z , texture2D ( ce , cf ) . r ) ; } float cq ( vec3 ci , PRECISION sampler2D cj , float ck ) { mat2 cl ; float cm , cn , co ;".split(" ")},{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:"if ( ci . z > u_perspective_cast_far_bound ) return 1.0 ; else {".split(" ")}]}}]},
{type:"textline",b:"ci . z = clamp ( ci . z , 0.0 , 1.0 ) ; cm = 0.0 ; cn = ak ( ci . xy ) . x * M_PI ; co = cos ( cn ) ; cn = sin ( cn ) ; cl = mat2 ( co , cn , - cn , co ) ; for ( int cp = 0 ; cp < 4 ; cp ++ ) { cm += ch ( bP [ cp ] , bT [ cp ] , cl , ci , ck , cj ) ; cm += ch ( bQ [ cp ] , bU [ cp ] , cl , ci , ck , cj ) ; cm += ch ( bR [ cp ] , bV [ cp ] , cl , ci , ck , cj ) ; cm += ch ( bS [ cp ] , bW [ cp ] , cl , ci , ck , cj ) ; } cm /= 16.0 ; return clamp ( cm , 0.0 , 1.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["}"]}]}}]},{type:"textline",b:"return 1.0 ; } float cF ( vec3 cr , PRECISION sampler2D cs , vec3 ct , PRECISION sampler2D cu , float cv , float cw , float cx ) { mat2 cy ; float cz , cA , cB , cC ; cr . z = clamp ( cr . z , 0.0 , 1.0 ) ; ct . z = clamp ( ct . z , 0.0 , 1.0 ) ; cz = 0.0 ; cA = 0.0 ; cB = ak ( cr . xy ) . x * M_PI ; cC = cos ( cB ) ; cB = sin ( cB ) ; cy = mat2 ( cC , cB , - cB , cC ) ; for ( int cD = 0 ; cD < 4 ; cD ++ ) { cz += ch ( bP [ cD ] , bT [ cD ] , cy , cr , cv , cs ) ; cz += ch ( bQ [ cD ] , bU [ cD ] , cy , cr , cv , cs ) ; cz += ch ( bR [ cD ] , bV [ cD ] , cy , cr , cv , cs ) ; cz += ch ( bS [ cD ] , bW [ cD ] , cy , cr , cv , cs ) ; } for ( int cE = 0 ; cE < 4 ; cE ++ ) { cA += ch ( bP [ cE ] , bT [ cE ] , cy , ct , cw , cu ) ; cA += ch ( bQ [ cE ] , bU [ cE ] , cy , ct , cw , cu ) ; cA += ch ( bR [ cE ] , bV [ cE ] , cy , ct , cw , cu ) ; cA += ch ( bS [ cE ] , bW [ cE ] , cy , ct , cw , cu ) ; } cz = mix ( cz , cA , cx ) ; cz /= 16.0 ; return clamp ( cz , 0.0 , 1.0 ) ; } float cJ ( vec2 cG ) { float cH , cI ; cH = min ( cG . x , cG . y ) ; cI = min ( 1.0 - cG . x , 1.0 - cG . y ) ; return min ( cH , cI ) ; } float cM ( float cK , float cL ) { if ( cL >= 0.0 && cL <= bM ) cK = ( cK - 1.0 ) / bM * cL + 1.0 ; return cK ; } float cX ( vec3 cN , vec3 cO , PRECISION sampler2D cP , PRECISION sampler2D cQ , float cR , float cS , float cT , float cU ) { float cV , cW ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_BLEND_BETWEEN_CASCADES"],group:{type:"group",a:[{type:"textline",b:"cW = cJ ( cN . xy ) ; if ( - cU > cT && cW >= 0.0 && cW <= bL && bZ ( cO . xy , 0.0 ) ) { cW = 1.0 - cW / bL ; cV = cF ( cN , cP , cO , cQ , cR , cS , cW ) ; } else".split(" ")}]}}]},{type:"textline",b:"cV = cq ( cN , cP , cR ) ; return cV ; } float de ( vec3 cY , PRECISION sampler2D cZ , float c_ , float da , float db ) { float dc , dd ; dc = cq ( cY , cZ , c_ ) ;".split(" ")},{type:"condition",
a:[{type:"if",c:["CSM_FADE_LAST_CASCADE"],group:{type:"group",a:[{type:"textline",b:"if ( - db > da ) { dd = cJ ( cY . xy ) ; dc = cM ( dc , dd ) ; }".split(" ")}]}}]},{type:"textline",b:"return dc ; } float dl ( float df ) { vec3 dg , dh , di , dj ; float dk ; dk = 1.0 ; dg = bF . xyz / bF . w ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"dh = bG . xyz / bG . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",
a:[{type:"textline",b:"di = bH . xyz / bH . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"dj = bI . xyz / bI . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"if ( bZ ( dg . xy , 0.0 ) ) { dk = cX ( dg , dh , u_shadow_map0 , u_shadow_map1 , u_pcf_blur_radii [ 0 ] , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 0 ] , df ) ; }".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"if ( bZ ( dg . xy , bO ) ) { dk = de ( dg , u_shadow_map0 , u_pcf_blur_radii [ 0 ] , u_csm_center_dists [ 0 ] , df ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"else { if ( bZ ( dh . xy , 0.0 ) ) {".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"dk = cX ( dh , di , u_shadow_map1 , u_shadow_map2 , u_pcf_blur_radii [ 1 ] , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 1 ] , df ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"dk = de ( dh , u_shadow_map1 , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 1 ] , df ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"else { if ( bZ ( di . xy , 0.0 ) ) {".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"dk = cX ( di , dj , u_shadow_map2 , u_shadow_map3 , u_pcf_blur_radii [ 2 ] , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 2 ] , df ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"dk = de ( di , u_shadow_map2 , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 2 ] , df ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"else { if ( bZ ( dj . xy , 0.0 ) ) dk = de ( dj , u_shadow_map3 , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 3 ] , df ) ; }".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",
b:["return","dk",";","}"]}]}}]},{type:"textline",b:"float dr ( inout vec3 dm ) { float dn ; vec3 dp ; vec2 dq ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"dq = texture2DProj ( u_shadow_mask , bD ) . rg ; dp = vec3 ( dq . r ) ; dn = dq . g ; bK = vec4 ( dp , dn ) ; dm *= bK . a ; return bK . r ;".split(" ")}]}},{type:"elif",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},
"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return dl ( bA . z ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["return","1.0",";"]}]}}]},{type:"textline",b:["}"]}]};a["include/mirror.glslf"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2},"REFLECTION_TYPE","REFL_MIRRORMAP",
{type:"equal_expr",d:2},{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"define",name:"REFL_BUMP",b:["0.1"]},{type:"textline",b:"float dy ( in vec3 ds , vec3 dt , float du , float dv ) { float dw ; vec3 dx ; dx = normalize ( dt + ds ) ; dw = 1.0 - dot ( ds , dx ) ; dw = dv + ( 1.0 - dv ) * pow ( dw , du ) ; return dw ; } void dL ( inout vec3 dz , vec3 dA , vec3 dB , float dC ) { vec2 dD , dE ; float dF , dG , dH ; vec3 dI , dJ , dK ; dI = reflect ( - dA , dB ) ; dF = u_fresnel_params [ 2 ] ; dG = u_fresnel_params [ 3 ] ; dH = 1.0 ; if ( dF != 0.0 ) dH = dy ( dA , dI , dF , dG ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","REFL_CUBE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"dJ = textureCube ( u_cube_reflection , dI ) . xyz ;".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","REFL_PLANE",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"dK = u_refl_plane . xyz * dot ( dB , u_refl_plane . xyz ) ; dK = dB - dK ; dD = ( u_view_matrix_frag * vec4 ( dK , 0.0 ) ) . xy ; dE = bD . xy / bD . z ; dE += dD * REFL_BUMP ; dJ = texture2D ( u_plane_reflection , dE ) . rgb ;".split(" ")}]}},
{type:"elif",c:["REFLECTION_TYPE","REFL_MIRRORMAP",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"dJ = textureCube ( u_mirrormap , dI ) . xyz ; dC = u_mirror_factor ;".split(" ")}]}}]},{type:"textline",b:"aE ( dJ . rgb ) ; dz = mix ( dz , dJ , dC * dH ) ; }".split(" ")}]}}]}]};a["include/environment.glslf"]={type:"group",a:[{type:"textline",b:"vec3 dO ( vec3 dM ) { float dN ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT"],group:{type:"group",a:[{type:"condition",
a:[{type:"if",c:["SKY_TEXTURE"],group:{type:"group",a:[{type:"textline",b:"return textureCube ( u_sky_texture , dM ) . rgb ;".split(" ")}]}},{type:"elif",c:["SKY_COLOR"],group:{type:"group",a:[{type:"textline",b:"dN = 0.5 * dM . y + 0.5 ; return mix ( u_horizon_color , u_zenith_color , dN ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["}"]}]};a["include/refraction.glslf"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"textline",b:"float dU ( in float dP , inout vec2 dQ , in vec2 dR ) { float dS ; vec4 dT ; dT = texture2D ( u_scene_depth , dQ ) ; dS = k ( dT ) ; if ( dS < bE ) { dQ = dR ; return dP ; } else { return dS ; } return dP ; }".split(" ")}]}}]},{type:"textline",b:"vec3 eb ( in vec3 dV , in vec2 dW ) { vec3 dX ; float dY ; vec4 dZ ; vec2 d_ , ea ; d_ = dV . xy / dV . z ; ea = d_ + dW ;".split(" ")},
{type:"condition",a:[{type:"if",c:["USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"textline",b:"dZ = texture2DProj ( u_scene_depth , dV ) ; dY = k ( dZ ) ; dU ( dY , ea , d_ ) ;".split(" ")}]}}]},{type:"textline",b:"dX = texture2D ( u_refractmap , ea ) . rgb ; aE ( dX ) ; return dX ; }".split(" ")}]}}]}]};a["include/nodes.glslf"]={type:"group",a:[{type:"var",name:"MAPPING_TRS_MATRIX",b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",
b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",
b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["varying","vec3","ec",";"]}]}}]},{type:"textline",b:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float ed = 0.5 ; vec3 ee = vec3 ( ZERO_VALUE_NODES ) ; vec3 ef = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:"vec3 ej ( in vec3 eg , in float eh ) { vec3 ei ; ei = ee ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:"ei = eb ( bD , eg . xz * eh ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"ei = texture2D ( u_refractmap , bD . xy / bD . z ) . rgb ; aE ( ei ) ;".split(" ")}]}}]},{type:"textline",b:["return","ei",";",
"}"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:"vec3 eo ( vec3 ek ) { float el , em ; vec4 en ; en = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; en = mix ( vec4 ( ek . bg , en . wz ) , vec4 ( ek . gb , en . xy ) , step ( ek . b , ek . g ) ) ; en = mix ( vec4 ( en . xyw , ek . r ) , vec4 ( ek . r , en . yzx ) , step ( en . x , ek . r ) ) ; el = en . x - min ( en . w , en . y ) ; em = 1.0e-10 ; return vec3 ( abs ( en . z + ( en . w - en . y ) / ( 6.0 * el + em ) ) , el / ( en . x + em ) , en . x ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{type:"logical_or_expr",d:6}],group:{type:"group",a:[{type:"textline",b:"vec3 es ( vec3 ep ) { vec3 eq ; vec4 er ; er = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; eq = abs ( fract ( vec3 ( ep . r , ep . r , ep . r ) + er . xyz ) * 6.0 - er . www ) ; return ep . b * mix ( er . xxx , clamp ( eq - er . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , ep . g ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"vec3 eu ( vec2 et ) { return vec3 ( et * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{type:"logical_or_expr",d:3}],group:{type:"group",a:[{type:"textline",b:"vec2 ew ( vec3 ev ) { return vec2 ( ev . xy * ed + vec2 ( ed , ed ) ) ; }".split(" ")}]}}]},
{type:"node",name:"CAMERA",h:[{type:"node_out",name:"fj",qualifier:["vec3"],e:!0},{type:"node_out",name:"fk",qualifier:["float"],e:!0},{type:"node_out",name:"fl",qualifier:["float"],e:!0}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_fj"],g:[{type:"textline",b:"fj = normalize ( fa . xyz ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_fk"],g:[{type:"textline",b:"fk = abs ( fa . z ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_fl"],
g:[{type:"textline",b:"fl = length ( fa . xyz ) ;".split(" ")}]}]}]},{type:"node",name:"COMBRGB",h:[{type:"node_in",name:"fm",qualifier:["float"],e:!1},{type:"node_in",name:"fn",qualifier:["float"],e:!1},{type:"node_in",name:"fo",qualifier:["float"],e:!1},{type:"node_out",name:"fp",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"fp = vec3 ( fm , fn , fo ) ;".split(" ")}]},{type:"node",name:"COMBHSV",h:[{type:"node_in",name:"fq",qualifier:["float"],e:!1},{type:"node_in",name:"fr",qualifier:["float"],
e:!1},{type:"node_in",name:"fs",qualifier:["float"],e:!1},{type:"node_out",name:"ft",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"ft = es ( vec3 ( fq , fr , fs ) ) ;".split(" ")}]},{type:"node",name:"EMPTY_UV",h:[{type:"node_out",name:"fu",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"fu = vec3 ( - UNITY_VALUE_NODES , - UNITY_VALUE_NODES , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"EMPTY_VC",h:[{type:"node_out",name:"fv",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["fv","=",
"ee",";"]}]},{type:"node",name:"GEOMETRY_UV",h:[{type:"node_out",name:"fw",qualifier:["vec3"],e:!1},{type:"node_param",name:"ex",qualifier:["varying","vec2"]}],g:[{type:"textline",b:"fw = eu ( ex ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_OR",h:[{type:"node_out",name:"fx",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"fx = 2.0 * ec - ef ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_out",name:"fy",qualifier:["vec3"],e:!1},{type:"node_param",name:"ey",qualifier:["varying","vec3"]}],
g:[{type:"textline",b:"fy = ey ; aE ( fy ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_out",name:"fz",qualifier:["float"],e:!1},{type:"node_param",name:"ez",qualifier:["varying","float"]}],g:[{type:"textline",b:"fz = ez ; aE ( fz ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC2",h:[{type:"node_out",name:"fA",qualifier:["float"],e:!1},{type:"node_out",name:"fB",qualifier:["float"],e:!1},{type:"node_param",name:"eA",qualifier:["varying","vec2"]}],g:[{type:"textline",b:"fA = eA [ 0 ] ; fB = eA [ 1 ] ; aE ( fA ) ; aE ( fB ) ;".split(" ")}]},
{type:"node",name:"GEOMETRY_VC3",h:[{type:"node_out",name:"fC",qualifier:["float"],e:!1},{type:"node_out",name:"fD",qualifier:["float"],e:!1},{type:"node_out",name:"fE",qualifier:["float"],e:!1},{type:"node_param",name:"eB",qualifier:["varying","vec3"]}],g:[{type:"textline",b:"fC = eB [ 0 ] ; fD = eB [ 1 ] ; fE = eB [ 2 ] ; aE ( fC ) ; aE ( fD ) ; aE ( fE ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_NO",h:[{type:"node_out",name:"fF",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["fF","=","fd",
";"]}]},{type:"node",name:"GEOMETRY_FB",h:[{type:"node_out",name:"fG",qualifier:["float"],e:!1}],g:[{type:"textline",b:"fG = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"GEOMETRY_VW",h:[{type:"node_out",name:"fH",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["fH","=","eK",";"]}]},{type:"node",name:"GEOMETRY_LO",h:[{type:"node_out",name:"fI",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"fI [ 0 ] = fa [ 0 ] ; fI [ 1 ] = fa [ 1 ] ; fI [ 2 ] = fa [ 2 ] ;".split(" ")}]},
{type:"node",name:"GEOMETRY_GL",h:[{type:"node_out",name:"fJ",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"fJ = vec3 ( fe . r , - fe . b , fe . g ) ;".split(" ")}]},{type:"node",name:"NEW_GEOMETRY",h:[{type:"node_out",name:"fK",qualifier:["vec3"],e:!1},{type:"node_out",name:"fL",qualifier:["vec3"],e:!1},{type:"node_out",name:"fM",qualifier:["vec3"],e:!1},{type:"node_out",name:"fN",qualifier:["vec3"],e:!1},{type:"node_out",name:"fO",qualifier:["vec3"],e:!1},{type:"node_out",name:"fP",qualifier:["vec3"],
e:!1},{type:"node_out",name:"fQ",qualifier:["float"],e:!1},{type:"node_out",name:"fR",qualifier:["float"],e:!1}],g:[{type:"textline",b:"fK = ee ; fL = ee ; fM = ee ; fN = ee ; fO = ee ; fP = ee ; fQ = ZERO_VALUE_NODES ; fR = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"HUE_SAT",h:[{type:"node_in",name:"fS",qualifier:["float"],e:!1},{type:"node_in",name:"fT",qualifier:["float"],e:!1},{type:"node_in",name:"fU",qualifier:["float"],e:!1},{type:"node_in",name:"fV",qualifier:["float"],e:!1},{type:"node_in",
name:"fW",qualifier:["vec3"],e:!1},{type:"node_out",name:"fX",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"fg = eo ( fW ) ; fg [ 0 ] += ( fS - ed ) ; if ( fg [ 0 ] > UNITY_VALUE_NODES ) fg [ 0 ] -= UNITY_VALUE_NODES ; else if ( fg [ 0 ] < ZERO_VALUE_NODES ) fg [ 0 ] += UNITY_VALUE_NODES ; fg *= vec3 ( UNITY_VALUE_NODES , fT , fU ) ; fg = mix ( ef , mix ( ee , fg , step ( ee , fg ) ) , step ( fg , ef ) ) ; fX = mix ( fW , es ( fg ) , fV ) ;".split(" ")}]},{type:"node",name:"INVERT",h:[{type:"node_in",
name:"fY",qualifier:["float"],e:!1},{type:"node_in",name:"fZ",qualifier:["vec3"],e:!1},{type:"node_out",name:"f_",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"f_ = mix ( fZ , ef - fZ , fY ) ;".split(" ")}]},{type:"node",name:"LAMP",h:[{type:"node_out",name:"ga",qualifier:["vec3"],e:!0},{type:"node_out",name:"gb",qualifier:["vec3"],e:!1},{type:"node_out",name:"gc",qualifier:["float"],e:!1},{type:"node_out",name:"gd",qualifier:["float"],e:!0}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ga"],
g:[{type:"textline",b:"ga = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{type:"textline",b:"fb = u_lamp_light_factors [ LAMP_INDEX ] ; fg = u_lamp_light_directions [ LAMP_INDEX ] ; fh = u_lamp_light_positions [ LAMP_INDEX ] ; eU = fb . z ; if ( eU != - UNITY_VALUE_NODES ) {".split(" ")},{type:"textline",b:"gb = fh - bz ; gc = length ( gb ) ; gb = normalize ( gb ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gd"],g:[{type:"textline",b:"gd = eU / ( eU + gc * gc ) ; eU = fb . x ; eV = fb . y ; if ( eU > - UNITY_VALUE_NODES ) { eW = dot ( gb , fg ) ; eW *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( eW - eU ) / eV ) ; gd *= eW ; }".split(" ")}]}]},
{type:"textline",b:["}","else","{"]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gb"],g:[{type:"textline",b:["gb","=","fg",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gc"],g:[{type:"textline",b:"gc = length ( fh - bz ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gd"],g:[{type:"textline",b:["gd","=","UNITY_VALUE_NODES",";"]}]}]},{type:"textline",b:["}"]}]},{type:"node",name:"NORMAL",h:[{type:"node_in",name:"ge",qualifier:["vec3"],e:!1},{type:"node_out",
name:"gf",qualifier:["vec3"],e:!0},{type:"node_out",name:"gg",qualifier:["float"],e:!0},{type:"node_param",name:"eC",qualifier:["vec3"]}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gf"],g:[{type:"textline",b:["gf","=","eC",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_gg"],g:[{type:"textline",b:"gg = - dot ( ge , eC ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_VECTOR_VIEW",h:[{type:"node_in",name:"gh",qualifier:["vec3"],e:!1},{type:"node_out",name:"gi",qualifier:["vec3"],
e:!1}],g:[{type:"textline",b:"gi = - ( u_view_matrix_frag * vec4 ( gh , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{type:"node",name:"BSDF_ANISOTROPIC",h:[{type:"node_in",name:"gj",qualifier:["vec3"],e:!1},{type:"node_in",name:"gk",qualifier:["float"],e:!1},{type:"node_in",name:"gl",qualifier:["float"],e:!1},{type:"node_in",name:"gm",qualifier:["float"],e:!1},{type:"node_in",name:"gn",qualifier:["vec3"],e:!1},{type:"node_in",name:"go",qualifier:["vec3"],e:!1},{type:"node_out",name:"gp",qualifier:["vec3"],
e:!1}],g:[{type:"textline",b:["gp","=","gj",";"]},{type:"textline",b:"gk ; gl ; gm ; gn ; go ;".split(" ")}]},{type:"node",name:"BSDF_DIFFUSE",h:[{type:"node_in",name:"gq",qualifier:["vec3"],e:!1},{type:"node_in",name:"gr",qualifier:["float"],e:!1},{type:"node_in",name:"gs",qualifier:["vec3"],e:!1},{type:"node_out",name:"gt",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["gt","=","gq",";"]},{type:"textline",b:["gr",";","gs",";"]}]},{type:"node",name:"BSDF_GLASS",h:[{type:"node_in",name:"gu",qualifier:["vec3"],
e:!1},{type:"node_in",name:"gv",qualifier:["float"],e:!1},{type:"node_in",name:"gw",qualifier:["float"],e:!1},{type:"node_in",name:"gx",qualifier:["vec3"],e:!1},{type:"node_out",name:"gy",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["gy","=","gu",";"]},{type:"textline",b:"gv ; gw ; gx ;".split(" ")}]},{type:"node",name:"BSDF_GLOSSY",h:[{type:"node_in",name:"gz",qualifier:["vec3"],e:!1},{type:"node_in",name:"gA",qualifier:["float"],e:!1},{type:"node_in",name:"gB",qualifier:["vec3"],e:!1},{type:"node_out",
name:"gC",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["gC","=","gz",";"]},{type:"textline",b:["gA",";","gB",";"]}]},{type:"node",name:"BSDF_HAIR",h:[{type:"node_in",name:"gD",qualifier:["vec3"],e:!1},{type:"node_in",name:"gE",qualifier:["float"],e:!1},{type:"node_in",name:"gF",qualifier:["float"],e:!1},{type:"node_in",name:"gG",qualifier:["float"],e:!1},{type:"node_out",name:"gH",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["gH","=","gD",";"]},{type:"textline",b:"gE ; gF ; gG ;".split(" ")}]},
{type:"node",name:"BSDF_TRANSPARENT",h:[{type:"node_in",name:"gI",qualifier:["vec3"],e:!1},{type:"node_out",name:"gJ",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["gJ","=","gI",";"]}]},{type:"node",name:"BSDF_TRANSLUCENT",h:[{type:"node_in",name:"gK",qualifier:["vec3"],e:!1},{type:"node_in",name:"gL",qualifier:["vec3"],e:!1},{type:"node_out",name:"gM",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["gM","=","gK",";"]},{type:"textline",b:["gL",";"]}]},{type:"node",name:"BSDF_REFRACTION",h:[{type:"node_in",
name:"gN",qualifier:["vec3"],e:!1},{type:"node_in",name:"gO",qualifier:["float"],e:!1},{type:"node_in",name:"gP",qualifier:["float"],e:!1},{type:"node_in",name:"gQ",qualifier:["vec3"],e:!1},{type:"node_out",name:"gR",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"gR [ 0 ] = gR [ 1 ] = gR [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"gN ; gO ; gP ; gQ ;".split(" ")}]},{type:"node",name:"BSDF_TOON",h:[{type:"node_in",name:"gS",qualifier:["vec3"],e:!1},{type:"node_in",name:"gT",qualifier:["float"],
e:!1},{type:"node_in",name:"gU",qualifier:["float"],e:!1},{type:"node_in",name:"gV",qualifier:["vec3"],e:!1},{type:"node_out",name:"gW",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["gW","=","gS",";"]},{type:"textline",b:"gT ; gU ; gV ;".split(" ")}]},{type:"node",name:"BSDF_VELVET",h:[{type:"node_in",name:"gX",qualifier:["vec3"],e:!1},{type:"node_in",name:"gY",qualifier:["float"],e:!1},{type:"node_in",name:"gZ",qualifier:["vec3"],e:!1},{type:"node_out",name:"g_",qualifier:["vec3"],e:!1}],g:[{type:"textline",
b:["g_","=","gX",";"]},{type:"textline",b:["gY",";","gZ",";"]}]},{type:"node",name:"SUBSURFACE_SCATTERING",h:[{type:"node_in",name:"ha",qualifier:["vec3"],e:!1},{type:"node_in",name:"hb",qualifier:["float"],e:!1},{type:"node_in",name:"hc",qualifier:["vec3"],e:!1},{type:"node_in",name:"hd",qualifier:["float"],e:!1},{type:"node_in",name:"he",qualifier:["float"],e:!1},{type:"node_in",name:"hf",qualifier:["vec3"],e:!1},{type:"node_out",name:"hg",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hg [ 0 ] = hg [ 1 ] = hg [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:"ha ; hc ; hd ; he ; hf ; hb ;".split(" ")}]},{type:"node",name:"EMISSION",h:[{type:"node_in",name:"hh",qualifier:["vec3"],e:!1},{type:"node_in",name:"hi",qualifier:["float"],e:!1},{type:"node_out",name:"hj",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["hj","=","hh",";"]},{type:"textline",b:["hi",";"]}]},{type:"node",name:"AMBIENT_OCCLUSION",h:[{type:"node_in",name:"hk",qualifier:["vec3"],e:!1},{type:"node_out",name:"hl",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hl [ 0 ] = hl [ 1 ] = hl [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["hk",";"]}]},{type:"node",name:"HOLDOUT",h:[{type:"node_out",name:"hm",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hm [ 0 ] = hm [ 1 ] = hm [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"VOLUME_ABSORPTION",h:[{type:"node_in",name:"hn",qualifier:["vec3"],e:!1},{type:"node_in",name:"ho",qualifier:["float"],e:!1},{type:"node_out",name:"hp",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hp [ 0 ] = hp [ 1 ] = hp [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",
b:["hn",";","ho",";"]}]},{type:"node",name:"VOLUME_SCATTER",h:[{type:"node_in",name:"hq",qualifier:["vec3"],e:!1},{type:"node_in",name:"hr",qualifier:["float"],e:!1},{type:"node_in",name:"hs",qualifier:["float"],e:!1},{type:"node_out",name:"ht",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"ht [ 0 ] = ht [ 1 ] = ht [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"hq ; hr ; hs ;".split(" ")}]},{type:"node",name:"BUMP",h:[{type:"node_in",name:"hu",qualifier:["float"],e:!1},{type:"node_in",
name:"hv",qualifier:["float"],e:!1},{type:"node_in",name:"hw",qualifier:["float"],e:!1},{type:"node_in",name:"hx",qualifier:["vec3"],e:!1},{type:"node_out",name:"hy",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["hy","=","hx",";"]},{type:"textline",b:"hu ; hv ; hw ;".split(" ")}]},{type:"node",name:"NORMAL_MAP",h:[{type:"node_in",name:"hz",qualifier:["float"],e:!1},{type:"node_in",name:"hA",qualifier:["vec3"],e:!1},{type:"node_out",name:"hB",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["hB",
"=","hA",";"]},{type:"textline",b:["hz",";"]}]},{type:"node",name:"VECT_TRANSFORM",h:[{type:"node_in",name:"hC",qualifier:["vec3"],e:!1},{type:"node_out",name:"hD",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hD [ 0 ] = hD [ 1 ] = hD [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["hC",";"]}]},{type:"node",name:"BLACKBODY",h:[{type:"node_in",name:"hE",qualifier:["float"],e:!1},{type:"node_out",name:"hF",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hF [ 0 ] = hF [ 1 ] = hF [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["hE",";"]}]},{type:"node",name:"WAVELENGTH",h:[{type:"node_in",name:"hG",qualifier:["float"],e:!1},{type:"node_out",name:"hH",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hH [ 0 ] = hH [ 1 ] = hH [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["hG",";"]}]},{type:"node",name:"SEPXYZ",h:[{type:"node_in",name:"hI",qualifier:["vec3"],e:!1},{type:"node_out",name:"hJ",qualifier:["float"],e:!1},{type:"node_out",name:"hK",qualifier:["float"],e:!1},{type:"node_out",name:"hL",
qualifier:["float"],e:!1}],g:[{type:"textline",b:"hJ = hI [ 0 ] ; hK = hI [ 1 ] ; hL = hI [ 2 ] ;".split(" ")}]},{type:"node",name:"COMBXYZ",h:[{type:"node_in",name:"hM",qualifier:["float"],e:!1},{type:"node_in",name:"hN",qualifier:["float"],e:!1},{type:"node_in",name:"hO",qualifier:["float"],e:!1},{type:"node_out",name:"hP",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"hP [ 0 ] = hM ; hP [ 1 ] = hN ; hP [ 2 ] = hO ;".split(" ")}]},{type:"node",name:"BRIGHTCONTRAST",h:[{type:"node_in",name:"hQ",
qualifier:["vec3"],e:!1},{type:"node_in",name:"hR",qualifier:["float"],e:!1},{type:"node_in",name:"hS",qualifier:["float"],e:!1},{type:"node_out",name:"hT",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = hR - hS * ed ; hT = max ( ( UNITY_VALUE_NODES + hS ) * hQ + eW , ee ) ;".split(" ")}]},{type:"node",name:"LIGHT_FALLOFF",h:[{type:"node_in",name:"hU",qualifier:["float"],e:!1},{type:"node_in",name:"hV",qualifier:["float"],e:!1},{type:"node_out",name:"hW",qualifier:["float"],e:!1},{type:"node_out",
name:"hX",qualifier:["float"],e:!1},{type:"node_out",name:"hY",qualifier:["float"],e:!1}],g:[{type:"textline",b:"hW = hX = hY = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["hU",";","hV",";"]}]},{type:"node",name:"TEX_IMAGE",h:[{type:"node_in",name:"hZ",qualifier:["vec3"],e:!1},{type:"node_out",name:"h_",qualifier:["vec3"],e:!1},{type:"node_out",name:"ia",qualifier:["float"],e:!1}],g:[{type:"textline",b:"h_ [ 0 ] = h_ [ 1 ] = h_ [ 2 ] = ZERO_VALUE_NODES ; ia = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:["hZ",";"]}]},{type:"node",name:"TEX_ENVIRONMENT",h:[{type:"node_in",name:"ib",qualifier:["vec3"],e:!1},{type:"node_out",name:"ic",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"ic [ 0 ] = ic [ 1 ] = ic [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["ib",";"]}]},{type:"node",name:"TEX_SKY",h:[{type:"node_in",name:"id",qualifier:["vec3"],e:!1},{type:"node_out",name:"ie",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"ie [ 0 ] = ie [ 1 ] = ie [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["id",";"]}]},{type:"node",name:"TEX_NOISE",h:[{type:"node_in",name:"ig",qualifier:["vec3"],e:!1},{type:"node_in",name:"ih",qualifier:["float"],e:!1},{type:"node_in",name:"ii",qualifier:["float"],e:!1},{type:"node_in",name:"ij",qualifier:["float"],e:!1},{type:"node_out",name:"ik",qualifier:["vec3"],e:!1},{type:"node_out",name:"il",qualifier:["float"],e:!1}],g:[{type:"textline",b:"ik [ 0 ] = ik [ 1 ] = ik [ 2 ] = ZERO_VALUE_NODES ; il = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",
b:"ig ; ih ; ii ; ij ;".split(" ")}]},{type:"node",name:"TEX_WAVE",h:[{type:"node_in",name:"im",qualifier:["vec3"],e:!1},{type:"node_in",name:"io",qualifier:["float"],e:!1},{type:"node_in",name:"ip",qualifier:["float"],e:!1},{type:"node_in",name:"iq",qualifier:["float"],e:!1},{type:"node_in",name:"ir",qualifier:["float"],e:!1},{type:"node_out",name:"is",qualifier:["vec3"],e:!1},{type:"node_out",name:"it",qualifier:["float"],e:!1}],g:[{type:"textline",b:"is [ 0 ] = is [ 1 ] = is [ 2 ] = ZERO_VALUE_NODES ; it = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:"im ; io ; ip ; iq ; ir ;".split(" ")}]},{type:"node",name:"TEX_VORONOI",h:[{type:"node_in",name:"iu",qualifier:["vec3"],e:!1},{type:"node_in",name:"iv",qualifier:["float"],e:!1},{type:"node_out",name:"iw",qualifier:["vec3"],e:!1},{type:"node_out",name:"ix",qualifier:["float"],e:!1}],g:[{type:"textline",b:"iw [ 0 ] = iw [ 1 ] = iw [ 2 ] = ZERO_VALUE_NODES ; ix = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["iu",";","iv",";"]}]},{type:"node",name:"TEX_MUSGRAVE",h:[{type:"node_in",
name:"iy",qualifier:["vec3"],e:!1},{type:"node_in",name:"iz",qualifier:["float"],e:!1},{type:"node_in",name:"iA",qualifier:["float"],e:!1},{type:"node_in",name:"iB",qualifier:["float"],e:!1},{type:"node_in",name:"iC",qualifier:["float"],e:!1},{type:"node_in",name:"iD",qualifier:["float"],e:!1},{type:"node_in",name:"iE",qualifier:["float"],e:!1},{type:"node_out",name:"iF",qualifier:["vec3"],e:!1},{type:"node_out",name:"iG",qualifier:["float"],e:!1}],g:[{type:"textline",b:"iF [ 0 ] = iF [ 1 ] = iF [ 2 ] = ZERO_VALUE_NODES ; iG = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:"iy ; iz ; iA ; iB ; iC ; iD ; iE ;".split(" ")}]},{type:"node",name:"TEX_GRADIENT",h:[{type:"node_in",name:"iH",qualifier:["vec3"],e:!1},{type:"node_out",name:"iI",qualifier:["vec3"],e:!1},{type:"node_out",name:"iJ",qualifier:["float"],e:!1}],g:[{type:"textline",b:"iI [ 0 ] = iI [ 1 ] = iI [ 2 ] = ZERO_VALUE_NODES ; iJ = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["iH",";"]}]},{type:"node",name:"TEX_MAGIC",h:[{type:"node_in",name:"iK",qualifier:["vec3"],e:!1},{type:"node_in",
name:"iL",qualifier:["float"],e:!1},{type:"node_in",name:"iM",qualifier:["float"],e:!1},{type:"node_out",name:"iN",qualifier:["vec3"],e:!1},{type:"node_out",name:"iO",qualifier:["float"],e:!1}],g:[{type:"textline",b:"iN [ 0 ] = iN [ 1 ] = iN [ 2 ] = ZERO_VALUE_NODES ; iO = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"iK ; iL ; iM ;".split(" ")}]},{type:"node",name:"TEX_CHECKER",h:[{type:"node_in",name:"iP",qualifier:["vec3"],e:!1},{type:"node_in",name:"iQ",qualifier:["vec3"],e:!1},{type:"node_in",
name:"iR",qualifier:["vec3"],e:!1},{type:"node_in",name:"iS",qualifier:["float"],e:!1},{type:"node_out",name:"iT",qualifier:["vec3"],e:!1},{type:"node_out",name:"iU",qualifier:["float"],e:!1}],g:[{type:"textline",b:"iT [ 0 ] = iT [ 1 ] = iT [ 2 ] = ZERO_VALUE_NODES ; iU = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"iP ; iQ ; iR ; iS ;".split(" ")}]},{type:"node",name:"TEX_BRICK",h:[{type:"node_in",name:"iV",qualifier:["vec3"],e:!1},{type:"node_in",name:"iW",qualifier:["vec3"],e:!1},{type:"node_in",
name:"iX",qualifier:["vec3"],e:!1},{type:"node_in",name:"iY",qualifier:["vec3"],e:!1},{type:"node_in",name:"iZ",qualifier:["float"],e:!1},{type:"node_in",name:"i_",qualifier:["float"],e:!1},{type:"node_in",name:"ja",qualifier:["float"],e:!1},{type:"node_in",name:"jb",qualifier:["float"],e:!1},{type:"node_in",name:"jc",qualifier:["float"],e:!1},{type:"node_out",name:"jd",qualifier:["vec3"],e:!1},{type:"node_out",name:"je",qualifier:["float"],e:!1}],g:[{type:"textline",b:"jd [ 0 ] = jd [ 1 ] = jd [ 2 ] = ZERO_VALUE_NODES ; je = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:"iV ; iW ; iX ; iY ; iZ ; i_ ; ja ; jb ; jc ;".split(" ")}]},{type:"node",name:"ADD_SHADER",h:[{type:"node_in",name:"jf",qualifier:["vec3"],e:!1},{type:"node_in",name:"jg",qualifier:["vec3"],e:!1},{type:"node_out",name:"jh",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"jh = clamp ( jf + jg , ee , ef ) ;".split(" ")}]},{type:"node",name:"MIX_SHADER",h:[{type:"node_in",name:"ji",qualifier:["float"],e:!1},{type:"node_in",name:"jj",qualifier:["vec3"],e:!1},{type:"node_in",name:"jk",
qualifier:["vec3"],e:!1},{type:"node_out",name:"jl",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( ji , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; jl = eW * jj + ( UNITY_VALUE_NODES - eW ) * jk ;".split(" ")}]},{type:"node",name:"UV_MERGED",h:[{type:"node_out",name:"jm",qualifier:["vec3"],e:!1},{type:"node_out",name:"jn",qualifier:["vec3"],e:!1},{type:"node_param",name:"eD",qualifier:["varying","vec2"]}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_jm"],g:[{type:"textline",
b:"jm = eu ( eD ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_jn"],g:[{type:"textline",b:"jn = vec3 ( eD , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"TEX_COORD_UV",h:[{type:"node_out",name:"jo",qualifier:["vec3"],e:!1},{type:"node_param",name:"eE",qualifier:["varying","vec2"]}],g:[{type:"textline",b:"jo = vec3 ( eE , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_NO",h:[{type:"node_out",name:"jp",qualifier:["vec3"],e:!1}],g:[{type:"textline",
b:["jp","=","ff",";"]}]},{type:"node",name:"TEX_COORD_GE",h:[{type:"node_out",name:"jq",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["jq","=","ec",";"]}]},{type:"node",name:"TEX_COORD_OB",h:[{type:"node_out",name:"jr",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"jr [ 0 ] = jr [ 1 ] = jr [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_CA",h:[{type:"node_out",name:"js",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"js [ 0 ] = fa [ 0 ] ; js [ 1 ] = fa [ 1 ] ; js [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"TEX_COORD_WI",h:[{type:"node_out",name:"jt",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"jt [ 0 ] = jt [ 1 ] = jt [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_RE",h:[{type:"node_out",name:"ju",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"ju [ 0 ] = ju [ 1 ] = ju [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"UVMAP",h:[{type:"node_out",name:"jv",qualifier:["vec3"],e:!1},{type:"node_param",name:"eF",qualifier:["varying","vec2"]}],
g:[{type:"textline",b:"jv = vec3 ( eF , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",h:[{type:"node_out",name:"jw",qualifier:["float"],e:!1},{type:"node_out",name:"jx",qualifier:["float"],e:!1},{type:"node_out",name:"jy",qualifier:["float"],e:!1},{type:"node_out",name:"jz",qualifier:["vec3"],e:!1},{type:"node_out",name:"jA",qualifier:["float"],e:!1},{type:"node_out",name:"jB",qualifier:["vec3"],e:!1},{type:"node_out",name:"jC",qualifier:["vec3"],e:!1}],g:[{type:"textline",
b:"jw = ZERO_VALUE_NODES ; jx = ZERO_VALUE_NODES ; jy = ZERO_VALUE_NODES ; jz = vec3 ( ZERO_VALUE_NODES ) ; jA = ZERO_VALUE_NODES ; jB = jz ; jC = jz ;".split(" ")}]},{type:"node",name:"HAIR_INFO",h:[{type:"node_out",name:"jD",qualifier:["float"],e:!1},{type:"node_out",name:"jE",qualifier:["float"],e:!1},{type:"node_out",name:"jF",qualifier:["float"],e:!1},{type:"node_out",name:"jG",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"jD = ZERO_VALUE_NODES ; jE = ZERO_VALUE_NODES ; jF = ZERO_VALUE_NODES ; jG = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"OBJECT_INFO",h:[{type:"node_out",name:"jH",qualifier:["vec3"],e:!1},{type:"node_out",name:"jI",qualifier:["float"],e:!1},{type:"node_out",name:"jJ",qualifier:["float"],e:!1},{type:"node_out",name:"jK",qualifier:["float"],e:!1}],g:[{type:"textline",b:"jI = ZERO_VALUE_NODES ; jJ = ZERO_VALUE_NODES ; jK = ZERO_VALUE_NODES ; jH = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"WIREFRAME",h:[{type:"node_in",name:"jL",qualifier:["float"],e:!1},{type:"node_out",name:"jM",
qualifier:["float"],e:!1}],g:[{type:"textline",b:["jM","=","jL",";"]}]},{type:"node",name:"TANGENT",h:[{type:"node_out",name:"jN",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"jN = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LAYER_WEIGHT",h:[{type:"node_in",name:"jO",qualifier:["float"],e:!1},{type:"node_in",name:"jP",qualifier:["vec3"],e:!1},{type:"node_out",name:"jQ",qualifier:["float"],e:!1},{type:"node_out",name:"jR",qualifier:["float"],e:!1}],g:[{type:"textline",b:"jQ = jR = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["jP",";","jO",";"]}]},{type:"node",name:"LIGHT_PATH",h:[{type:"node_out",name:"jS",qualifier:["float"],e:!1},{type:"node_out",name:"jT",qualifier:["float"],e:!1},{type:"node_out",name:"jU",qualifier:["float"],e:!1},{type:"node_out",name:"jV",qualifier:["float"],e:!1},{type:"node_out",name:"jW",qualifier:["float"],e:!1},{type:"node_out",name:"jX",qualifier:["float"],e:!1},{type:"node_out",name:"jY",qualifier:["float"],e:!1},{type:"node_out",name:"jZ",qualifier:["float"],e:!1},{type:"node_out",
name:"j_",qualifier:["float"],e:!1},{type:"node_out",name:"ka",qualifier:["float"],e:!1}],g:[{type:"textline",b:"jS = jT = jU = ZERO_VALUE_NODES ; jV = jW = jX = ZERO_VALUE_NODES ; jY = jY = j_ = ka = ZERO_VALUE_NODES ; jZ = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"ATTRIBUTE",h:[{type:"node_out",name:"kb",qualifier:["vec3"],e:!1},{type:"node_out",name:"kc",qualifier:["vec3"],e:!1},{type:"node_out",name:"kd",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kb = kc = vec3 ( ZERO_VALUE_NODES ) ; kd = ZERO_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"SCRIPT",h:[],g:[]},{type:"node",name:"CURVE_VEC",h:[{type:"node_in",name:"ke",qualifier:["float"],e:!1},{type:"node_in",name:"kf",qualifier:["vec3"],e:!1},{type:"node_out",name:"kg",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:["kg","=","kf",";"]},{type:"textline",b:["ke",";"]}]},{type:"node",name:"CURVE_RGB",h:[{type:"node_in",name:"kh",qualifier:["float"],e:!1},{type:"node_in",name:"ki",qualifier:["vec3"],e:!1},{type:"node_out",name:"kj",qualifier:["vec3"],e:!1}],g:[{type:"textline",
b:["kj","=","ki",";"]},{type:"textline",b:["kh",";"]}]},{type:"node",name:"VALTORGB",h:[{type:"node_in",name:"kk",qualifier:["float"],e:!1},{type:"node_out",name:"kl",qualifier:["vec3"],e:!1},{type:"node_out",name:"km",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kl [ 0 ] = kl [ 1 ] = kl [ 2 ] = clamp ( kk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; km = kl [ 0 ] ;".split(" ")}]},{type:"node",name:"MAPPING",h:[{type:"node_in",name:"kn",qualifier:["vec3"],e:!1},{type:"node_out",name:"ko",qualifier:["vec3"],
e:!1}],g:[{type:"textline",b:["ko","=","kn",";"]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_TRS_MATRIX",g:[{type:"textline",b:"ko = ( MAPPING_TRS_MATRIX * vec4 ( ko , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_SCALE",g:[{type:"textline",b:"ko = ko * MAPPING_SCALE ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_TRANSLATION",g:[{type:"textline",b:"ko = ko + MAPPING_TRANSLATION ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_MIN_CLIP",g:[{type:"textline",b:"ko = max ( ko , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_MAX_CLIP",g:[{type:"textline",b:"ko = min ( ko , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["MAPPING_IS_NORMAL"],g:[{type:"textline",b:"ko = normalize ( ko ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ADD",h:[{type:"node_in",name:"kp",qualifier:["float"],
e:!1},{type:"node_in",name:"kq",qualifier:["float"],e:!1},{type:"node_out",name:"kr",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kr = kp + kq ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"kr = clamp ( kr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SUBTRACT",h:[{type:"node_in",name:"ks",qualifier:["float"],e:!1},{type:"node_in",name:"kt",qualifier:["float"],e:!1},{type:"node_out",name:"ku",qualifier:["float"],
e:!1}],g:[{type:"textline",b:"ku = ks - kt ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"ku = clamp ( ku , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MULTIPLY",h:[{type:"node_in",name:"kv",qualifier:["float"],e:!1},{type:"node_in",name:"kw",qualifier:["float"],e:!1},{type:"node_out",name:"kx",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kx = kv * kw ;".split(" ")},{type:"node_condition",a:[{type:"node_if",
c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"kx = clamp ( kx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_DIVIDE",h:[{type:"node_in",name:"ky",qualifier:["float"],e:!1},{type:"node_in",name:"kz",qualifier:["float"],e:!1},{type:"node_out",name:"kA",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kA = ( kz != ZERO_VALUE_NODES ) ? ky / kz : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"kA = clamp ( kA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_SINE",h:[{type:"node_in",name:"kB",qualifier:["float"],e:!1},{type:"node_in",name:"kC",qualifier:["float"],e:!1},{type:"node_out",name:"kD",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kD = sin ( kB ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"kD = clamp ( kD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["kC",";"]}]},{type:"node",name:"MATH_COSINE",h:[{type:"node_in",name:"kE",
qualifier:["float"],e:!1},{type:"node_in",name:"kF",qualifier:["float"],e:!1},{type:"node_out",name:"kG",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kG = cos ( kE ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"kG = clamp ( kG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["kF",";"]}]},{type:"node",name:"MATH_TANGENT",h:[{type:"node_in",name:"kH",qualifier:["float"],e:!1},{type:"node_in",name:"kI",qualifier:["float"],
e:!1},{type:"node_out",name:"kJ",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kJ = tan ( kH ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"kJ = clamp ( kJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["kI",";"]}]},{type:"node",name:"MATH_ARCSINE",h:[{type:"node_in",name:"kK",qualifier:["float"],e:!1},{type:"node_in",name:"kL",qualifier:["float"],e:!1},{type:"node_out",name:"kM",qualifier:["float"],e:!1}],
g:[{type:"textline",b:"kM = ( kK <= UNITY_VALUE_NODES && kK >= - UNITY_VALUE_NODES ) ? asin ( kK ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"kM = clamp ( kM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["kL",";"]}]},{type:"node",name:"MATH_ARCCOSINE",h:[{type:"node_in",name:"kN",qualifier:["float"],e:!1},{type:"node_in",name:"kO",qualifier:["float"],e:!1},{type:"node_out",name:"kP",qualifier:["float"],
e:!1}],g:[{type:"textline",b:"kP = ( kN <= UNITY_VALUE_NODES && kN >= - UNITY_VALUE_NODES ) ? acos ( kN ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"kP = clamp ( kP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["kO",";"]}]},{type:"node",name:"MATH_ARCTANGENT",h:[{type:"node_in",name:"kQ",qualifier:["float"],e:!1},{type:"node_in",name:"kR",qualifier:["float"],e:!1},{type:"node_out",name:"kS",
qualifier:["float"],e:!1}],g:[{type:"textline",b:"kS = atan ( kQ ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"kS = clamp ( kS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["kR",";"]}]},{type:"node",name:"MATH_POWER",h:[{type:"node_in",name:"kT",qualifier:["float"],e:!1},{type:"node_in",name:"kU",qualifier:["float"],e:!1},{type:"node_out",name:"kV",qualifier:["float"],e:!1}],g:[{type:"textline",b:"if ( kT < ZERO_VALUE_NODES && kU != floor ( kU ) ) kV = ZERO_VALUE_NODES ; else if ( kU == ZERO_VALUE_NODES )".split(" ")},
{type:"textline",b:"kV = UNITY_VALUE_NODES ; else if ( kT < ZERO_VALUE_NODES ) kV = mix ( 1.0 , - 1.0 , sign ( mod ( - kU , 2.0 ) ) ) * pow ( - kT , kU ) ; else if ( kT == ZERO_VALUE_NODES ) kV = ZERO_VALUE_NODES ; else kV = pow ( kT , kU ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"kV = clamp ( kV , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_LOGARITHM",h:[{type:"node_in",name:"kW",qualifier:["float"],
e:!1},{type:"node_in",name:"kX",qualifier:["float"],e:!1},{type:"node_out",name:"kY",qualifier:["float"],e:!1}],g:[{type:"textline",b:"kY = ( kW > ZERO_VALUE_NODES && kX > ZERO_VALUE_NODES ) ? log2 ( kW ) / log2 ( kX ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"kY = clamp ( kY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MINIMUM",h:[{type:"node_in",name:"kZ",qualifier:["float"],e:!1},
{type:"node_in",name:"k_",qualifier:["float"],e:!1},{type:"node_out",name:"la",qualifier:["float"],e:!1}],g:[{type:"textline",b:"la = min ( kZ , k_ ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"la = clamp ( la , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MAXIMUM",h:[{type:"node_in",name:"lb",qualifier:["float"],e:!1},{type:"node_in",name:"lc",qualifier:["float"],e:!1},{type:"node_out",name:"ld",qualifier:["float"],
e:!1}],g:[{type:"textline",b:"ld = max ( lb , lc ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"ld = clamp ( ld , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ROUND",h:[{type:"node_in",name:"le",qualifier:["float"],e:!1},{type:"node_in",name:"lf",qualifier:["float"],e:!1},{type:"node_out",name:"lg",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lg = floor ( le + ed ) ;".split(" ")},{type:"node_condition",
a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lg = clamp ( lg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["lf",";"]}]},{type:"node",name:"MATH_LESS_THAN",h:[{type:"node_in",name:"lh",qualifier:["float"],e:!1},{type:"node_in",name:"li",qualifier:["float"],e:!1},{type:"node_out",name:"lj",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lj = ( lh < li ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",
c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lj = clamp ( lj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_GREATER_THAN",h:[{type:"node_in",name:"lk",qualifier:["float"],e:!1},{type:"node_in",name:"ll",qualifier:["float"],e:!1},{type:"node_out",name:"lm",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lm = ( lk > ll ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lm = clamp ( lm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_MODULO",h:[{type:"node_in",name:"ln",qualifier:["float"],e:!1},{type:"node_in",name:"lo",qualifier:["float"],e:!1},{type:"node_out",name:"lp",qualifier:["float"],e:!1}],g:[{type:"textline",b:"lp = abs ( lo ) > 0.000001 ? mod ( ln , lo ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"lp = clamp ( lp , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ABSOLUTE",h:[{type:"node_in",
name:"lq",qualifier:["float"],e:!1},{type:"node_in",name:"lr",qualifier:["float"],e:!1},{type:"node_out",name:"ls",qualifier:["float"],e:!1}],g:[{type:"textline",b:"ls = abs ( lq ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],g:[{type:"textline",b:"ls = clamp ( ls , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["lr",";"]}]},{type:"node",name:"MIX_RGB_MIX",h:[{type:"node_in",name:"lt",qualifier:["float"],e:!1},{type:"node_in",name:"lu",
qualifier:["vec3"],e:!1},{type:"node_in",name:"lv",qualifier:["vec3"],e:!1},{type:"node_out",name:"lw",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( lt , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lw = mix ( lu , lv , eW ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"lw = clamp ( lw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_ADD",h:[{type:"node_in",name:"lx",qualifier:["float"],e:!1},
{type:"node_in",name:"ly",qualifier:["vec3"],e:!1},{type:"node_in",name:"lz",qualifier:["vec3"],e:!1},{type:"node_out",name:"lA",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( lx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lA = mix ( ly , ly + lz , eW ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"lA = clamp ( lA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_MULTIPLY",h:[{type:"node_in",
name:"lB",qualifier:["float"],e:!1},{type:"node_in",name:"lC",qualifier:["vec3"],e:!1},{type:"node_in",name:"lD",qualifier:["vec3"],e:!1},{type:"node_out",name:"lE",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( lB , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lE = mix ( lC , lC * lD , eW ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"lE = clamp ( lE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SUBTRACT",
h:[{type:"node_in",name:"lF",qualifier:["float"],e:!1},{type:"node_in",name:"lG",qualifier:["vec3"],e:!1},{type:"node_in",name:"lH",qualifier:["vec3"],e:!1},{type:"node_out",name:"lI",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( lF , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lI = mix ( lG , lG - lH , eW ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"lI = clamp ( lI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SCREEN",h:[{type:"node_in",name:"lJ",qualifier:["float"],e:!1},{type:"node_in",name:"lK",qualifier:["vec3"],e:!1},{type:"node_in",name:"lL",qualifier:["vec3"],e:!1},{type:"node_out",name:"lM",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( lJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eV = UNITY_VALUE_NODES - eW ; lM = ef - ( vec3 ( eV ) + eW * ( ef - lL ) ) * ( ef - lK ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",
b:"lM = clamp ( lM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIVIDE",h:[{type:"node_in",name:"lN",qualifier:["float"],e:!1},{type:"node_in",name:"lO",qualifier:["vec3"],e:!1},{type:"node_in",name:"lP",qualifier:["vec3"],e:!1},{type:"node_out",name:"lQ",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( lN , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eV = UNITY_VALUE_NODES - eW ; lP += step ( lP , ee ) ; lQ = eV * lO + eW * lO / lP ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"lQ = clamp ( lQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIFFERENCE",h:[{type:"node_in",name:"lR",qualifier:["float"],e:!1},{type:"node_in",name:"lS",qualifier:["vec3"],e:!1},{type:"node_in",name:"lT",qualifier:["vec3"],e:!1},{type:"node_out",name:"lU",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( lR , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lU = mix ( lS , abs ( lS - lT ) , eW ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"lU = clamp ( lU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DARKEN",h:[{type:"node_in",name:"lV",qualifier:["float"],e:!1},{type:"node_in",name:"lW",qualifier:["vec3"],e:!1},{type:"node_in",name:"lX",qualifier:["vec3"],e:!1},{type:"node_out",name:"lY",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( lV , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lY = min ( lW . rgb , lX . rgb * eW ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"lY = clamp ( lY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LIGHTEN",h:[{type:"node_in",name:"lZ",qualifier:["float"],e:!1},{type:"node_in",name:"l_",qualifier:["vec3"],e:!1},{type:"node_in",name:"ma",qualifier:["vec3"],e:!1},{type:"node_out",name:"mb",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( lZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mb = max ( l_ . rgb , ma . rgb * eW ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mb = clamp ( mb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_OVERLAY",h:[{type:"node_in",name:"mc",qualifier:["float"],e:!1},{type:"node_in",name:"md",qualifier:["vec3"],e:!1},{type:"node_in",name:"me",qualifier:["vec3"],e:!1},{type:"node_out",name:"mf",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( mc , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fh = vec3 ( UNITY_VALUE_NODES - eW ) ; mf = mix ( md * ( fh + 2.0 * eW * me ) , ef - ( fh + 2.0 * eW * ( ef - me ) ) * ( ef - md ) , step ( ed , md ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mf = clamp ( mf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DODGE",h:[{type:"node_in",name:"mg",qualifier:["float"],e:!1},{type:"node_in",name:"mh",qualifier:["vec3"],e:!1},{type:"node_in",name:"mi",qualifier:["vec3"],e:!1},{type:"node_out",name:"mj",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( mg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fh = ef - eW * mi ; fg = clamp ( mh / fh , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mj = mix ( mix ( fg , ef , step ( fh , ee ) ) , mh , step ( mh , ee ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mj = clamp ( mj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_BURN",h:[{type:"node_in",name:"mk",qualifier:["float"],e:!1},{type:"node_in",name:"ml",qualifier:["vec3"],e:!1},{type:"node_in",name:"mm",qualifier:["vec3"],e:!1},{type:"node_out",name:"mn",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( mk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; fh = vec3 ( UNITY_VALUE_NODES - eW ) ; fh = fh + eW * mm ; fg = clamp ( ef - ( ef - ml ) / fh , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mn = mix ( fg , ee , step ( fh , ee ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mn = clamp ( mn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_HUE",h:[{type:"node_in",name:"mo",qualifier:["float"],e:!1},{type:"node_in",name:"mp",qualifier:["vec3"],e:!1},{type:"node_in",name:"mq",qualifier:["vec3"],e:!1},{type:"node_out",name:"mr",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( mo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mr = mp ; fg = eo ( mq ) ; if ( fg . y != ZERO_VALUE_NODES ) { fh = eo ( mr ) ; fh . x = fg . x ; fi = es ( fh ) ; mr = mix ( mr , fi , eW ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mr = clamp ( mr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SATURATION",h:[{type:"node_in",name:"ms",qualifier:["float"],e:!1},{type:"node_in",name:"mt",qualifier:["vec3"],e:!1},{type:"node_in",name:"mu",qualifier:["vec3"],e:!1},{type:"node_out",name:"mv",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( ms , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eV = UNITY_VALUE_NODES - eW ; mv = mt ; fi = eo ( mv ) ; if ( fi . y != ZERO_VALUE_NODES ) { fh = eo ( mu ) ; fi . y = eV * fi . y + eW * fh . y ; mv = es ( fi ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mv = clamp ( mv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_VALUE",h:[{type:"node_in",name:"mw",qualifier:["float"],e:!1},{type:"node_in",name:"mx",qualifier:["vec3"],e:!1},{type:"node_in",name:"my",qualifier:["vec3"],e:!1},{type:"node_out",name:"mz",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( mw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eV = UNITY_VALUE_NODES - eW ; fi = eo ( mx ) ; fh = eo ( my ) ; fi . z = eV * fi . z + eW * fh . z ; mz = es ( fi ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mz = clamp ( mz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_COLOR",h:[{type:"node_in",name:"mA",qualifier:["float"],e:!1},{type:"node_in",name:"mB",qualifier:["vec3"],e:!1},{type:"node_in",name:"mC",qualifier:["vec3"],e:!1},{type:"node_out",name:"mD",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( mA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mD = mB ; fh = eo ( mC ) ; if ( fh . y != ZERO_VALUE_NODES ) { fi = eo ( mD ) ; fi . x = fh . x ; fi . y = fh . y ; fg = es ( fi ) ; mD = mix ( mD , fg , eW ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mD = clamp ( mD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SOFT_LIGHT",h:[{type:"node_in",name:"mE",qualifier:["float"],e:!1},{type:"node_in",name:"mF",qualifier:["vec3"],e:!1},{type:"node_in",name:"mG",qualifier:["vec3"],e:!1},{type:"node_out",name:"mH",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( mE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eV = UNITY_VALUE_NODES - eW ; fg = mG + mF - mG * mF ; mH = mF * ( vec3 ( eV ) + vec3 ( eW ) * ( ( ef - mF ) * mG + fg ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mH = clamp ( mH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LINEAR_LIGHT",h:[{type:"node_in",name:"mI",qualifier:["float"],e:!1},{type:"node_in",name:"mJ",qualifier:["vec3"],e:!1},{type:"node_in",name:"mK",qualifier:["vec3"],e:!1},{type:"node_out",name:"mL",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"eW = clamp ( mI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mL = mJ + eW * ( 2.0 * mK - ef ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],g:[{type:"textline",b:"mL = clamp ( mL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"OUTPUT",h:[{type:"node_in",name:"mM",qualifier:["vec3"],e:!1},{type:"node_in",name:"mN",qualifier:["float"],e:!1}],g:[{type:"textline",b:"eL = mM ; eP = mN ;".split(" ")}]},{type:"node",name:"MATERIAL_BEGIN",h:[{type:"node_in",name:"mO",qualifier:["vec3"],e:!1},{type:"node_in",name:"mP",qualifier:["vec3"],e:!1},{type:"node_in",
name:"mQ",qualifier:["float"],e:!1},{type:"node_in",name:"mR",qualifier:["vec3"],e:!0},{type:"node_in",name:"mS",qualifier:["float"],e:!0},{type:"node_out",name:"mT",qualifier:["vec3"],e:!1},{type:"node_out",name:"mU",qualifier:["vec3"],e:!1},{type:"node_out",name:"mV",qualifier:["vec3"],e:!1},{type:"node_out",name:"mW",qualifier:["vec3"],e:!1},{type:"node_out",name:"mX",qualifier:["vec3"],e:!1},{type:"node_out",name:"mY",qualifier:["vec2"],e:!1},{type:"node_out",name:"mZ",qualifier:["vec2"],e:!1},
{type:"node_out",name:"m_",qualifier:["float"],e:!1},{type:"node_param",name:"eG",qualifier:["const","vec2"]},{type:"node_param",name:"eH",qualifier:["const","vec3"]}],g:[{type:"textline",b:"mV = clamp ( mO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",b:"mW = eH [ 0 ] * clamp ( mP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_NORMAL"],g:[{type:"textline",b:"mX = normalize ( mR ) ;".split(" ")}]},{type:"node_else",
g:[{type:"textline",b:["mX","=","ff",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["SHADELESS_MAT",{type:"logic_negative_expr",d:1},"NODES_GLOW",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],g:[{type:"node_condition",a:[{type:"node_if",c:["MATERIAL_EXT"],g:[{type:"textline",b:"mT = mS * mV ;".split(" ")}]},{type:"node_else",g:[{type:"textline",b:"mT = eS * mV ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_DIFFUSE"],g:[{type:"textline",b:["mV",
"*=","mQ",";"]}]}]},{type:"textline",b:"mU = eT * u_environment_energy * dO ( mX ) ; m_ = dr ( mV ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["NUM_LIGHTS",0,{type:"g_expr",d:2}],g:[{type:"textline",b:"mY = vec2 ( eG [ 0 ] , eG [ 1 ] ) ;".split(" ")},{type:"textline",b:"mZ = vec2 ( eH [ 1 ] , eH [ 2 ] ) ;".split(" ")}]}]},{type:"textline",b:["eO","=","m_",";"]}]},{type:"node_else",g:[{type:"textline",b:"mT = ee ; mU = ef ;".split(" ")}]}]}]},{type:"node",name:"MATERIAL_END",h:[{type:"node_in",
name:"na",qualifier:["vec4"],e:!1},{type:"node_in",name:"nb",qualifier:["vec3"],e:!1},{type:"node_in",name:"nc",qualifier:["vec3"],e:!1},{type:"node_in",name:"nd",qualifier:["float"],e:!0},{type:"node_in",name:"ne",qualifier:["float"],e:!0},{type:"node_in",name:"nf",qualifier:["float"],e:!0},{type:"node_out",name:"ng",qualifier:["vec3"],e:!0},{type:"node_out",name:"nh",qualifier:["float"],e:!0},{type:"node_out",name:"ni",qualifier:["vec3"],e:!0},{type:"node_out",name:"nj",qualifier:["vec3"],e:!0},
{type:"node_out",name:"nk",qualifier:["vec3"],e:!0},{type:"node_param",name:"eI",qualifier:["float"]},{type:"node_param",name:"eJ",qualifier:["float"]}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ng"],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_DIFFUSE"],g:[{type:"textline",b:"ng = na . rgb ;".split(" ")}]},{type:"node_else",g:[{type:"textline",b:["ng","=","ee",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{type:"non_equal_expr",
d:2},{type:"logical_and_expr",d:2}],g:[{type:"textline",b:"dL ( ng , eK , nc , nd ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:["ng","+=","nb",";"]}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ni"],g:[{type:"textline",b:["ni","=","nc",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["MATERIAL_EXT"],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_nj"],g:[{type:"textline",b:"nj = na . rgb ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_nk"],g:[{type:"textline",b:["nk","=","nb",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_nh"],g:[{type:"textline",b:"nh = clamp ( nf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:"eW = max ( max ( nb . r , nb . g ) , nb . b ) * ne ; nh = clamp ( nf * ( UNITY_VALUE_NODES - eW ) + eW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]}]},
{type:"node_else",g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_nh"],g:[{type:"textline",b:"nh = clamp ( eI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:"eW = max ( max ( nb . r , nb . g ) , nb . b ) * eJ ; nh = eI * ( UNITY_VALUE_NODES - eW ) + eW ;".split(" ")}]}]}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],g:[{type:"textline",b:["eM","=","nb",";"]}]},
{type:"node_else",g:[{type:"textline",b:["eM","=","ee",";"]}]}]},{type:"textline",b:["eN","=","nc",";"]}]},{type:"node",name:"LIGHTING_AMBIENT",h:[{type:"node_in",name:"nl",qualifier:["vec3"],e:!1},{type:"node_in",name:"nm",qualifier:["vec3"],e:!1},{type:"node_in",name:"nn",qualifier:["vec3"],e:!1},{type:"node_out",name:"no",qualifier:["vec4"],e:!1},{type:"node_out",name:"np",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"no = vec4 ( nl + nn * nm , ZERO_VALUE_NODES ) ; np = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"nq",qualifier:["float"],e:!1},{type:"node_out",name:"nr",qualifier:["vec3"],e:!1},{type:"node_out",name:"ns",qualifier:["vec2"],e:!1},{type:"node_out",name:"nt",qualifier:["vec3"],e:!1},{type:"node_out",name:"nu",qualifier:["float"],e:!1}],g:[{type:"node_condition",a:[{type:"node_if",c:["NODES_GLOW",{type:"logic_negative_expr",d:1},"NUM_LIGHTS",0,{type:"g_expr",d:2},{type:"logical_and_expr",d:2}],g:[{type:"textline",b:"ns = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["LAMP_TYPE","HEMI",{type:"equal_expr",d:2}],g:[{type:"textline",b:["nu","=","ed",";"]}]},{type:"node_else",g:[{type:"textline",b:["nu","=","ZERO_VALUE_NODES",";"]}]}]},{type:"textline",b:"nt = u_light_color_intensities [ LAMP_IND ] ; if ( LAMP_SHADOW_MAP_IND != - 1 ) nt *= nq ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["LAMP_TYPE","SPOT",{type:"equal_expr",d:2},"LAMP_TYPE","POINT",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],g:[{type:"textline",
b:"fg = u_light_positions [ LAMP_IND ] ; nr = fg - fe ;".split(" ")},{type:"textline",b:"eW = length ( nr ) ; nt *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + eW * eW ) ; nr = normalize ( nr ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["LAMP_TYPE","SPOT",{type:"equal_expr",d:2}],g:[{type:"textline",b:"fg = u_light_directions [ LAMP_IND ] ; eW = dot ( nr , fg ) ; eW *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( eW - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; nt *= eW ;".split(" ")}]}]}]},
{type:"node_else",g:[{type:"textline",b:"nr = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]}]}]},{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"nv",qualifier:["vec3"],e:!1},{type:"node_in",name:"nw",qualifier:["vec2"],e:!1},{type:"node_in",name:"nx",qualifier:["vec3"],e:!1},{type:"node_in",name:"ny",qualifier:["float"],e:!1},{type:"node_in",name:"nz",qualifier:["vec2"],e:!1},{type:"node_out",name:"nA",qualifier:["float"],e:!1}],g:[{type:"textline",b:"nA = ZERO_VALUE_NODES ; if ( nw . r != ZERO_VALUE_NODES ) { eW = ( UNITY_VALUE_NODES - ny ) * dot ( nx , nv ) + ny ; if ( nz [ 0 ] == ZERO_VALUE_NODES ) { nA = UNITY_VALUE_NODES ; } else { eW = UNITY_VALUE_NODES + abs ( eW ) ; eW = nz [ 1 ] + ( UNITY_VALUE_NODES - nz [ 1 ] ) * pow ( eW , nz [ 0 ] ) ; nA = clamp ( eW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } nA = max ( nA , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"nB",qualifier:["vec3"],e:!1},{type:"node_in",name:"nC",qualifier:["vec2"],e:!1},{type:"node_in",name:"nD",qualifier:["vec3"],e:!1},{type:"node_in",name:"nE",qualifier:["float"],e:!1},{type:"node_out",name:"nF",qualifier:["float"],e:!1}],g:[{type:"textline",b:"nF = ZERO_VALUE_NODES ; if ( nC . r != ZERO_VALUE_NODES ) { eW = ( UNITY_VALUE_NODES - nE ) * dot ( nD , nB ) + nE ; nF = max ( eW , ZERO_VALUE_NODES ) ; }".split(" ")}]},{type:"node",
name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"nG",qualifier:["vec3"],e:!1},{type:"node_in",name:"nH",qualifier:["vec2"],e:!1},{type:"node_in",name:"nI",qualifier:["vec3"],e:!1},{type:"node_in",name:"nJ",qualifier:["float"],e:!1},{type:"node_in",name:"nK",qualifier:["vec2"],e:!1},{type:"node_out",name:"nL",qualifier:["float"],e:!1}],g:[{type:"textline",b:"nL = ZERO_VALUE_NODES ; if ( nH . r != ZERO_VALUE_NODES ) { eW = ( UNITY_VALUE_NODES - nJ ) * dot ( nI , nG ) + nJ ; if ( nK [ 0 ] > ZERO_VALUE_NODES ) { eV = max ( dot ( nI , eK ) , ZERO_VALUE_NODES ) ; eU = nK [ 0 ] * nK [ 0 ] ; eX = UNITY_VALUE_NODES - ed * ( eU / ( eU + 0.33 ) ) ; fg = nG - eW * nI ; fi = eK - eV * nI ;".split(" ")},
{type:"textline",b:"if ( length ( fg ) == ZERO_VALUE_NODES || length ( fi ) == ZERO_VALUE_NODES || abs ( eW ) > UNITY_VALUE_NODES || abs ( eV ) > UNITY_VALUE_NODES )".split(" ")},{type:"textline",b:"nL = eW * eX ; else { eY = acos ( eW ) ; eV = acos ( eV ) ; fg = normalize ( fg ) ; fi = normalize ( fi ) ; eZ = max ( eY , eV ) ; e_ = min ( eY , eV ) ; e_ *= 0.95 ; eV = max ( dot ( fg , fi ) , ZERO_VALUE_NODES ) ; eU = 0.45 * ( eU / ( eU + 0.09 ) ) ; nL = eW * ( eX + ( eU * eV * sin ( eZ ) * tan ( e_ ) ) ) ; } } else nL = eW ; nL = max ( nL , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"nM",qualifier:["vec3"],e:!1},{type:"node_in",name:"nN",qualifier:["vec2"],e:!1},{type:"node_in",name:"nO",qualifier:["vec3"],e:!1},{type:"node_in",name:"nP",qualifier:["float"],e:!1},{type:"node_in",name:"nQ",qualifier:["vec2"],e:!1},{type:"node_out",name:"nR",qualifier:["float"],e:!1}],g:[{type:"textline",b:"nR = ZERO_VALUE_NODES ; if ( nN . r != ZERO_VALUE_NODES ) { eW = ( UNITY_VALUE_NODES - nP ) * dot ( nO , nM ) + nP ; e_ = max ( dot ( nO , eK ) , ZERO_VALUE_NODES ) ; if ( nQ [ 0 ] <= UNITY_VALUE_NODES ) nR = eW * pow ( max ( e_ * eW , 0.1 ) , nQ [ 0 ] - UNITY_VALUE_NODES ) ; else nR = eW * pow ( 1.0001 - e_ , nQ [ 0 ] - UNITY_VALUE_NODES ) ; nR = max ( nR , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"nS",qualifier:["vec3"],e:!1},{type:"node_in",name:"nT",qualifier:["vec2"],e:!1},{type:"node_in",name:"nU",qualifier:["vec3"],e:!1},{type:"node_in",name:"nV",qualifier:["float"],e:!1},{type:"node_in",name:"nW",qualifier:["vec2"],e:!1},{type:"node_out",name:"nX",qualifier:["float"],e:!1}],g:[{type:"textline",b:"nX = ZERO_VALUE_NODES ; if ( nT . r != ZERO_VALUE_NODES ) { e_ = ( UNITY_VALUE_NODES - nV ) * dot ( nU , nS ) + nV ; e_ = acos ( e_ ) ; if ( e_ < nW [ 0 ] ) nX = UNITY_VALUE_NODES ; else if ( e_ > ( nW [ 0 ] + nW [ 1 ] ) || nW [ 1 ] == ZERO_VALUE_NODES ) nX = ZERO_VALUE_NODES ; else nX = UNITY_VALUE_NODES - ( ( e_ - nW [ 0 ] ) / nW [ 1 ] ) ; nX = max ( nX , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"nY",qualifier:["vec3"],e:!1},{type:"node_in",name:"nZ",qualifier:["vec2"],e:!1},{type:"node_in",name:"n_",qualifier:["vec3"],e:!1},{type:"node_in",name:"oa",qualifier:["float"],e:!1},{type:"node_in",name:"ob",qualifier:["vec2"],e:!1},{type:"node_out",name:"oc",qualifier:["float"],e:!1}],g:[{type:"textline",b:"oc = ZERO_VALUE_NODES ; if ( nZ . g == UNITY_VALUE_NODES ) { fi = normalize ( nY + eK ) ; oc = ( UNITY_VALUE_NODES - oa ) * max ( dot ( n_ , fi ) , ZERO_VALUE_NODES ) + oa ; oc = pow ( oc , ob [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"od",qualifier:["vec3"],e:!1},{type:"node_in",name:"oe",qualifier:["vec2"],e:!1},{type:"node_in",name:"of",qualifier:["vec3"],e:!1},{type:"node_in",name:"og",qualifier:["vec2"],e:!1},{type:"node_out",name:"oh",qualifier:["float"],e:!1}],g:[{type:"textline",b:"oh = ZERO_VALUE_NODES ; if ( oe . g == UNITY_VALUE_NODES ) { fi = normalize ( od + eK ) ; e_ = max ( dot ( of , fi ) , 0.001 ) ;".split(" ")},{type:"textline",b:"eW = max ( dot ( of , eK ) , 0.01 ) ; eZ = max ( dot ( of , od ) , 0.01 ) ; e_ = tan ( acos ( e_ ) ) ; eV = max ( og [ 0 ] , 0.001 ) ; oh = eZ * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * eV * eV ) ) * ( exp ( - ( e_ * e_ ) / ( eV * eV ) ) / ( sqrt ( eW * eZ ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"oi",qualifier:["vec3"],e:!1},{type:"node_in",name:"oj",qualifier:["vec2"],e:!1},{type:"node_in",name:"ok",qualifier:["vec3"],e:!1},{type:"node_in",name:"ol",qualifier:["vec2"],e:!1},{type:"node_out",name:"om",qualifier:["float"],e:!1}],g:[{type:"textline",b:"om = ZERO_VALUE_NODES ; if ( oj . g == UNITY_VALUE_NODES ) { fi = normalize ( oi + eK ) ; eZ = acos ( dot ( fi , ok ) ) ; if ( eZ < ol [ 0 ] ) om = UNITY_VALUE_NODES ; else if ( eZ >= ol [ 0 ] + ol [ 1 ] || ol [ 1 ] == ZERO_VALUE_NODES ) om = ZERO_VALUE_NODES ; else om = UNITY_VALUE_NODES - ( eZ - ol [ 0 ] ) / ol [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"on",qualifier:["vec3"],e:!1},{type:"node_in",name:"oo",qualifier:["vec2"],e:!1},{type:"node_in",name:"op",qualifier:["vec3"],e:!1},{type:"node_in",name:"oq",qualifier:["float"],e:!1},{type:"node_in",name:"or",qualifier:["vec2"],e:!1},{type:"node_out",name:"os",qualifier:["float"],e:!1}],g:[{type:"textline",b:"os = ZERO_VALUE_NODES ; if ( oo . g == UNITY_VALUE_NODES ) { if ( or [ 0 ] < UNITY_VALUE_NODES || or [ 1 ] == ZERO_VALUE_NODES ) os = ZERO_VALUE_NODES ; else { if ( or [ 1 ] < 100.0 ) or [ 1 ] = sqrt ( UNITY_VALUE_NODES / or [ 1 ] ) ; else or [ 1 ] = 10.0 / or [ 1 ] ; fi = normalize ( eK + on ) ; eZ = ( UNITY_VALUE_NODES - oq ) * max ( dot ( op , fi ) , ZERO_VALUE_NODES ) + oq ; if ( eZ < ZERO_VALUE_NODES ) os = ZERO_VALUE_NODES ; else { eW = max ( dot ( op , eK ) , 0.01 ) ; eV = dot ( op , on ) ; if ( eV <= 0.01 ) os = ZERO_VALUE_NODES ; else { e_ = max ( dot ( eK , fi ) , 0.01 ) ; eU = UNITY_VALUE_NODES ; eW = ( 2.0 * eZ * eW ) / e_ ; eV = ( 2.0 * eZ * eV ) / e_ ; eV = min ( min ( eU , eW ) , eV ) ; eW = sqrt ( pow ( or [ 0 ] , 2.0 ) + pow ( e_ , 2.0 ) - UNITY_VALUE_NODES ) ; e_ = pow ( eW - e_ , 2.0 ) / pow ( eW + e_ , 2.0 ) * ( UNITY_VALUE_NODES + pow ( e_ * ( eW + e_ ) - UNITY_VALUE_NODES , 2.0 ) / pow ( e_ * ( eW - e_ ) + UNITY_VALUE_NODES , 2.0 ) ) ; eZ = acos ( eZ ) ; os = max ( e_ * eV * exp ( - pow ( eZ , 2.0 ) / ( 2.0 * pow ( or [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"ot",qualifier:["vec4"],e:!1},{type:"node_in",name:"ou",qualifier:["vec3"],e:!1},{type:"node_in",name:"ov",qualifier:["float"],e:!1},{type:"node_in",name:"ow",qualifier:["float"],e:!1},{type:"node_in",name:"ox",qualifier:["vec3"],e:!1},{type:"node_in",name:"oy",qualifier:["vec3"],e:!1},{type:"node_in",name:"oz",qualifier:["vec4"],e:!1},{type:"node_in",name:"oA",qualifier:["vec3"],e:!1},{type:"node_in",name:"oB",qualifier:["vec3"],e:!1},{type:"node_in",
name:"oC",qualifier:["vec3"],e:!1},{type:"node_in",name:"oD",qualifier:["float"],e:!1},{type:"node_out",name:"oE",qualifier:["vec4"],e:!1},{type:"node_out",name:"oF",qualifier:["vec3"],e:!1}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_NODE_B4W_TRANSLUCENCY"],g:[{type:"textline",b:"if ( dot ( ox , oy ) * dot ( eK , oy ) < ZERO_VALUE_NODES ) { eZ = oz . x ; eV = oz . y ; e_ = oz . z ; eW = oz . w ;".split(" ")},{type:"textline",b:"eU = clamp ( abs ( dot ( ox , oy ) ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eX = clamp ( dot ( eK , - ox ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eV = pow ( eX , eV ) ;".split(" ")},
{type:"textline",b:"oE = ot + oD * vec4 ( oC * eU * pow ( oA , vec3 ( eZ ) ) , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",b:"oE += e_ * mix ( vec4 ( oA , UNITY_VALUE_NODES ) , vec4 ( UNITY_VALUE_NODES ) , eW ) * oD * vec4 ( oC * eU * vec3 ( eV ) , UNITY_VALUE_NODES ) ; oF = ou ; } else {".split(" ")},{type:"textline",b:"oF = ou + oC * oB * ow ; oE = ot + vec4 ( oC * oA * ov , ow ) ; }".split(" ")}]},{type:"node_else",g:[{type:"textline",b:"oF = ou + oC * oB * ow ; oE = ot + vec4 ( oC * oA * ov , ow ) ;".split(" ")}]}]}]},
{type:"node",name:"RGB",h:[{type:"node_out",name:"oG",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"oG = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{type:"node",name:"RGBTOBW",h:[{type:"node_in",name:"oH",qualifier:["vec3"],e:!1},{type:"node_out",name:"oI",qualifier:["float"],e:!1}],g:[{type:"textline",b:"oI = dot ( oH , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{type:"node",name:"SEPRGB",h:[{type:"node_in",name:"oJ",qualifier:["vec3"],e:!1},{type:"node_out",name:"oK",qualifier:["float"],e:!0},
{type:"node_out",name:"oL",qualifier:["float"],e:!0},{type:"node_out",name:"oM",qualifier:["float"],e:!0}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oK"],g:[{type:"textline",b:"oK = oJ . r ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oL"],g:[{type:"textline",b:"oL = oJ . g ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oM"],g:[{type:"textline",b:"oM = oJ . b ;".split(" ")}]}]}]},{type:"node",name:"SEPHSV",h:[{type:"node_in",name:"oN",
qualifier:["vec3"],e:!1},{type:"node_out",name:"oO",qualifier:["float"],e:!0},{type:"node_out",name:"oP",qualifier:["float"],e:!0},{type:"node_out",name:"oQ",qualifier:["float"],e:!0}],g:[{type:"textline",b:"fi = eo ( oN ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oO"],g:[{type:"textline",b:"oO = fi . r ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oP"],g:[{type:"textline",b:"oP = fi . g ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",
c:["USE_OUT_oQ"],g:[{type:"textline",b:"oQ = fi . b ;".split(" ")}]}]}]},{type:"node",name:"SQUEEZE",h:[{type:"node_in",name:"oR",qualifier:["float"],e:!1},{type:"node_in",name:"oS",qualifier:["float"],e:!1},{type:"node_in",name:"oT",qualifier:["float"],e:!1},{type:"node_out",name:"oU",qualifier:["float"],e:!1}],g:[{type:"textline",b:"oU = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( oR - oT ) * oS ) ) ;".split(" ")}]},{type:"node",name:"GAMMA",h:[{type:"node_in",name:"oV",qualifier:["vec3"],
e:!1},{type:"node_in",name:"oW",qualifier:["float"],e:!1},{type:"node_out",name:"oX",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"oX = oV ; if ( oX . x > ZERO_VALUE_NODES ) oX . x = pow ( oV . x , oW ) ; if ( oX . y > ZERO_VALUE_NODES ) oX . y = pow ( oV . y , oW ) ; if ( oX . z > ZERO_VALUE_NODES ) oX . z = pow ( oV . z , oW ) ;".split(" ")}]},{type:"node",name:"B4W_SRGB_TO_LINEAR",h:[{type:"node_in",name:"oY",qualifier:["vec3"],e:!1},{type:"node_out",name:"oZ",qualifier:["vec3"],e:!1}],g:[{type:"textline",
b:"oZ = max ( ee , oY ) ; oZ = pow ( oZ , vec3 ( 2.2 ) ) ;".split(" ")}]},{type:"node",name:"B4W_LINEAR_TO_SRGB",h:[{type:"node_in",name:"o_",qualifier:["vec3"],e:!1},{type:"node_out",name:"pa",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"pa = max ( ee , o_ ) ; pa = pow ( pa , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{type:"node",name:"TEXTURE_EMPTY",h:[{type:"node_out",name:"pb",qualifier:["vec3"],e:!1},{type:"node_out",name:"pc",qualifier:["vec3"],e:!1},{type:"node_out",name:"pd",
qualifier:["float"],e:!1}],g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pd"],g:[{type:"textline",b:"pb [ 2 ] = pb [ 1 ] = pb [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pd"],g:[{type:"textline",b:"pc [ 2 ] = pc [ 1 ] = pc [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pd"],g:[{type:"textline",b:["pd","=","ZERO_VALUE_NODES",";"]}]}]}]},{type:"node",name:"TEXTURE_ENVIRONMENT",h:[{type:"node_in",
name:"pe",qualifier:["vec3"],e:!1},{type:"node_out",name:"pf",qualifier:["vec3"],e:!0},{type:"node_out",name:"pg",qualifier:["float"],e:!0},{type:"node_param",name:"node_TEXTURE_ENVIRONMENT_var_texture",qualifier:["uniform","samplerCube"]}],g:[{type:"textline",b:"fb = textureCube ( node_TEXTURE_ENVIRONMENT_var_texture , pe ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pf"],g:[{type:"textline",b:"pf = fb . xyz ; aE ( pf ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",
c:["USE_OUT_pg"],g:[{type:"textline",b:"pg = fb . w ;".split(" ")}]}]}]},{type:"node",name:"TEXTURE_COLOR",h:[{type:"node_in",name:"ph",qualifier:["vec3"],e:!0},{type:"node_in",name:"pi",qualifier:["vec3"],e:!0},{type:"node_in",name:"pj",qualifier:["vec3"],e:!0},{type:"node_in",name:"pk",qualifier:["vec3"],e:!0},{type:"node_out",name:"pl",qualifier:["vec3"],e:!0},{type:"node_out",name:"pm",qualifier:["float"],e:!0},{type:"node_out",name:"pn",qualifier:["vec3"],e:!0},{type:"node_out",name:"po",qualifier:["float"],
e:!0},{type:"node_out",name:"pp",qualifier:["vec3"],e:!0},{type:"node_out",name:"pq",qualifier:["float"],e:!0},{type:"node_out",name:"pr",qualifier:["vec3"],e:!0},{type:"node_out",name:"ps",qualifier:["float"],e:!0},{type:"node_param",name:"node_TEXTURE_COLOR_var_texture",qualifier:["uniform","sampler2D"]}],g:[{type:"textline",b:"fb = texture2D ( node_TEXTURE_COLOR_var_texture , ew ( ph ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pl"],g:[{type:"textline",b:"pl = fb . xyz ; aE ( pl ) ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pm"],g:[{type:"textline",b:"pm = fb . w ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv2"],g:[{type:"textline",b:"fb = texture2D ( node_TEXTURE_COLOR_var_texture , ew ( pi ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pn"],g:[{type:"textline",b:"pn = fb . xyz ; aE ( pn ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_po"],g:[{type:"textline",b:"po = fb . w ;".split(" ")}]}]}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_uv3"],g:[{type:"textline",b:"fb = texture2D ( node_TEXTURE_COLOR_var_texture , ew ( pj ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pp"],g:[{type:"textline",b:"pp = fb . xyz ; aE ( pp ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pq"],g:[{type:"textline",b:"pq = fb . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv4"],g:[{type:"textline",b:"fb = texture2D ( node_TEXTURE_COLOR_var_texture , ew ( pk ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pr"],g:[{type:"textline",b:"pr = fb . xyz ; aE ( pr ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ps"],g:[{type:"textline",b:"ps = fb . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"TEXTURE_NORMAL",h:[{type:"node_in",name:"pt",qualifier:["vec3"],e:!0},{type:"node_in",name:"pu",qualifier:["vec3"],e:!0},{type:"node_in",name:"pv",qualifier:["vec3"],e:!0},{type:"node_in",name:"pw",qualifier:["vec3"],e:!0},{type:"node_out",
name:"px",qualifier:["vec3"],e:!0},{type:"node_out",name:"py",qualifier:["float"],e:!0},{type:"node_out",name:"pz",qualifier:["vec3"],e:!0},{type:"node_out",name:"pA",qualifier:["float"],e:!0},{type:"node_out",name:"pB",qualifier:["vec3"],e:!0},{type:"node_out",name:"pC",qualifier:["float"],e:!0},{type:"node_out",name:"pD",qualifier:["vec3"],e:!0},{type:"node_out",name:"pE",qualifier:["float"],e:!0},{type:"node_param",name:"node_TEXTURE_NORMAL_var_texture",qualifier:["uniform","sampler2D"]}],g:[{type:"textline",
b:"fb = texture2D ( node_TEXTURE_NORMAL_var_texture , ew ( pt ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_px"],g:[{type:"textline",b:"px = normalize ( fc * ( fb . xyz - ed ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_py"],g:[{type:"textline",b:"py = fb . w ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv2"],g:[{type:"textline",b:"fb = texture2D ( node_TEXTURE_NORMAL_var_texture , ew ( pu ) ) ;".split(" ")},{type:"node_condition",
a:[{type:"node_if",c:["USE_OUT_pz"],g:[{type:"textline",b:"pz = normalize ( fc * ( fb . xyz - ed ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pA"],g:[{type:"textline",b:"pA = fb . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv3"],g:[{type:"textline",b:"fb = texture2D ( node_TEXTURE_NORMAL_var_texture , ew ( pv ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pB"],g:[{type:"textline",b:"pB = normalize ( fc * ( fb . xyz - ed ) ) ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pC"],g:[{type:"textline",b:"pC = fb . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv4"],g:[{type:"textline",b:"fb = texture2D ( node_TEXTURE_NORMAL_var_texture , ew ( pw ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pD"],g:[{type:"textline",b:"pD = normalize ( fc * ( fb . xyz - ed ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pE"],g:[{type:"textline",b:"pE = fb . w ;".split(" ")}]}]}]}]}]},
{type:"node",name:"VALUE",h:[{type:"node_out",name:"pF",qualifier:["float"],e:!1}],g:[{type:"textline",b:"pF = u_node_values [ VALUE_IND ] ;".split(" ")}]},{type:"node",name:"VECT_MATH_ADD",h:[{type:"node_in",name:"pG",qualifier:["vec3"],e:!1},{type:"node_in",name:"pH",qualifier:["vec3"],e:!1},{type:"node_out",name:"pI",qualifier:["vec3"],e:!1},{type:"node_out",name:"pJ",qualifier:["float"],e:!0}],g:[{type:"textline",b:"pI = pG + pH ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pJ"],
g:[{type:"textline",b:"pJ = ( abs ( pI [ 0 ] ) + abs ( pI [ 1 ] ) + abs ( pI [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_SUBTRACT",h:[{type:"node_in",name:"pK",qualifier:["vec3"],e:!1},{type:"node_in",name:"pL",qualifier:["vec3"],e:!1},{type:"node_out",name:"pM",qualifier:["vec3"],e:!1},{type:"node_out",name:"pN",qualifier:["float"],e:!0}],g:[{type:"textline",b:"pM = pK - pL ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pN"],g:[{type:"textline",b:"pN = ( abs ( pM [ 0 ] ) + abs ( pM [ 1 ] ) + abs ( pM [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_AVERAGE",h:[{type:"node_in",name:"pO",qualifier:["vec3"],e:!1},{type:"node_in",name:"pP",qualifier:["vec3"],e:!1},{type:"node_out",name:"pQ",qualifier:["vec3"],e:!1},{type:"node_out",name:"pR",qualifier:["float"],e:!0}],g:[{type:"textline",b:"pQ = pO + pP ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pR"],g:[{type:"textline",b:"pR = length ( pQ ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pQ"],g:[{type:"textline",b:"pQ = normalize ( pQ ) ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_DOT_PRODUCT",h:[{type:"node_in",name:"pS",qualifier:["vec3"],e:!1},{type:"node_in",name:"pT",qualifier:["vec3"],e:!1},{type:"node_out",name:"pU",qualifier:["vec3"],e:!1},{type:"node_out",name:"pV",qualifier:["float"],e:!0}],g:[{type:"textline",b:["pU","=","ee",";"]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pV"],g:[{type:"textline",b:"pV = dot ( pS , pT ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_CROSS_PRODUCT",h:[{type:"node_in",name:"pW",qualifier:["vec3"],
e:!1},{type:"node_in",name:"pX",qualifier:["vec3"],e:!1},{type:"node_out",name:"pY",qualifier:["vec3"],e:!1},{type:"node_out",name:"pZ",qualifier:["float"],e:!0}],g:[{type:"textline",b:"pY = cross ( pW , pX ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_pZ"],g:[{type:"textline",b:"pZ = length ( pY ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_NORMALIZE",h:[{type:"node_in",name:"p_",qualifier:["vec3"],e:!1},{type:"node_in",name:"qa",qualifier:["vec3"],e:!1},{type:"node_out",
name:"qb",qualifier:["vec3"],e:!1},{type:"node_out",name:"qc",qualifier:["float"],e:!0}],g:[{type:"textline",b:"qb = normalize ( p_ ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_qc"],g:[{type:"textline",b:"qc = length ( p_ ) ;".split(" ")}]}]},{type:"textline",b:["qa",";"]}]},{type:"node",name:"B4W_REFLECT",h:[{type:"node_in",name:"qd",qualifier:["vec3"],e:!1},{type:"node_in",name:"qe",qualifier:["vec3"],e:!1},{type:"node_out",name:"qf",qualifier:["vec3"],e:!1}],g:[{type:"textline",
b:"qf = reflect ( - qd , qe ) ;".split(" ")}]},{type:"node",name:"B4W_PARALLAX",h:[{type:"node_in",name:"qg",qualifier:["vec3"],e:!1},{type:"node_in",name:"qh",qualifier:["float"],e:!1},{type:"node_in",name:"qi",qualifier:["const","float"],e:!1},{type:"node_in",name:"qj",qualifier:["const","float"],e:!1},{type:"node_out",name:"qk",qualifier:["vec3"],e:!1},{type:"node_param",name:"node_B4W_PARALLAX_var_texture",qualifier:["uniform","sampler2D"]}],g:[{type:"textline",b:"eV = length ( fa ) ; if ( eV < qj ) { eQ = ew ( qg ) ; eV = clamp ( ed * ( qj - eV ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; eV = qh * eV ;".split(" ")},
{type:"textline",b:"fi = normalize ( eK * fc ) ;".split(" ")},{type:"textline",b:"eU = UNITY_VALUE_NODES / qi ;".split(" ")},{type:"textline",b:"eR = fi . xy * eV / ( qi * fi . z ) ; eV = UNITY_VALUE_NODES ; eW = texture2D ( node_B4W_PARALLAX_var_texture , eQ ) . a ;".split(" ")},{type:"textline",b:"for ( float ql = 1.0 ; ql <= qi ; ql ++ ) { if ( eW < eV ) { eV -= eU ; eQ -= eR ; eW = texture2D ( node_B4W_PARALLAX_var_texture , eQ ) . a ; } }".split(" ")},{type:"textline",b:"eR = eQ + eR ; eU = texture2D ( node_B4W_PARALLAX_var_texture , eR ) . a - ( eV + eU ) ; eV = eW - eV ; eU = eV / ( eV - eU ) ;".split(" ")},
{type:"textline",b:"eQ = eU * eR + ( UNITY_VALUE_NODES - eU ) * eQ ; qk = eu ( eQ ) ; } else qk = qg ;".split(" ")}]},{type:"node",name:"B4W_CLAMP",h:[{type:"node_in",name:"qm",qualifier:["vec3"],e:!1},{type:"node_out",name:"qn",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"qn = clamp ( qm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"B4W_REFRACTION",h:[{type:"node_in",name:"qo",qualifier:["vec3"],e:!1},{type:"node_in",name:"qp",qualifier:["float"],e:!1},{type:"node_out",
name:"qq",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"qq = ej ( qo , qp ) ;".split(" ")}]},{type:"node",name:"B4W_TRANSLUCENCY",h:[{type:"node_in",name:"qr",qualifier:["float"],e:!1},{type:"node_in",name:"qs",qualifier:["float"],e:!1},{type:"node_in",name:"qt",qualifier:["float"],e:!1},{type:"node_in",name:"qu",qualifier:["float"],e:!1},{type:"node_in",name:"qv",qualifier:["float"],e:!1},{type:"node_out",name:"qw",qualifier:["float"],e:!0},{type:"node_out",name:"qx",qualifier:["vec4"],e:!0}],
g:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_qw"],g:[{type:"textline",b:["qw","=","qr",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_qx"],g:[{type:"textline",b:"qx = vec4 ( qs , qt , qu , qv ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_TIME",h:[{type:"node_out",name:"qy",qualifier:["float"],e:!1}],g:[{type:"textline",b:["qy","=","u_time",";"]}]},{type:"node",name:"B4W_SMOOTHSTEP",h:[{type:"node_in",name:"qz",qualifier:["float"],e:!1},{type:"node_in",name:"qA",qualifier:["float"],
e:!1},{type:"node_in",name:"qB",qualifier:["float"],e:!1},{type:"node_out",name:"qC",qualifier:["float"],e:!1}],g:[{type:"textline",b:"qC = smoothstep ( qA , qB , qz ) ;".split(" ")}]},{type:"node",name:"B4W_GLOW_OUTPUT",h:[{type:"node_in",name:"qD",qualifier:["vec3"],e:!1},{type:"node_in",name:"qE",qualifier:["float"],e:!1}],g:[{type:"textline",b:"eL = qD ; eP = qE ;".split(" ")}]},{type:"node",name:"B4W_VECTOSCAL",h:[{type:"node_in",name:"qF",qualifier:["vec3"],e:!1},{type:"node_out",name:"qG",
qualifier:["float"],e:!1}],g:[{type:"textline",b:"qG = ( qF . r + qF . g + qF . b ) / 3.0 ;".split(" ")}]},{type:"node",name:"B4W_SCALTOVEC",h:[{type:"node_in",name:"qH",qualifier:["float"],e:!1},{type:"node_out",name:"qI",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"qI [ 0 ] = qH ; qI [ 1 ] = qH ; qI [ 2 ] = qH ;".split(" ")}]},{type:"nodes_global"},{type:"textline",b:"void qJ ( in vec3 eK , out vec3 eL , out vec3 eM , out vec3 eN , out float eO , out float eP ) { vec2 eQ , eR ; float eS , eT , eU , eV , eW , eX , eY , eZ , e_ ; vec4 fa , fb ; mat3 fc ; vec3 fd , fe , ff , fg , fh , fi ; eL = ee ; eM = ee ; eN = ee ; eO = ZERO_VALUE_NODES ; eP = ZERO_VALUE_NODES ;".split(" ")},
{type:"condition",a:[{type:"if",c:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{type:"logical_or_expr",d:5}],group:{type:"group",a:[{type:"textline",b:"fd = normalize ( bB ) ; fe = fd ;".split(" ")},{type:"condition",a:[{type:"if",c:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( gl_FrontFacing ) fe = fe ; else fe = - fe ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",a:[{type:"textline",b:["ff","=","fe",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["ff","=","fd",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_NO"],group:{type:"group",a:[{type:"textline",b:["fd","=","fe",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"fg = cross ( fe , bC . xyz ) * bC . w ; fc = mat3 ( bC . xyz , fg , fe ) ; fc = fc ;".split(" ")}]}}]},
{type:"textline",b:"fe = bz ; fa = bA ; eS = u_emit ; eT = u_ambient ;".split(" ")},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/to_world.glslv"]={type:"group",a:[{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"define",name:"MAX_BILLBOARD_ANGLE",b:["(","M_PI","/","4.0",")"]},{type:"textline",b:"const vec3 qK = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",d:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",
{type:"equal_expr",d:2},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"mat4 qQ ( vec3 qL , mat4 qM ) { vec3 qN , qO , qP ; qN = vec3 ( qM [ 0 ] [ 0 ] , qM [ 1 ] [ 0 ] , qM [ 2 ] [ 0 ] ) ; qO = vec3 ( qM [ 0 ] [ 1 ] , qM [ 1 ] [ 1 ] , qM [ 2 ] [ 1 ] ) ; qP = vec3 ( qM [ 0 ] [ 2 ] , qM [ 1 ] [ 2 ] , qM [ 2 ] [ 2 ] ) ; qO = cross ( qP , qN ) ; qN = normalize ( qN ) ; qO = normalize ( qO ) ; qP = normalize ( qP ) ; return mat4 ( vec4 ( qN , 0.0 ) , vec4 ( qO , 0.0 ) , vec4 ( qP , 0.0 ) , vec4 ( qL , 1.0 ) ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 qW ( vec3 qR , vec3 qS ) { vec3 qT , qU , qV ; qT = qR - qS ; qT . y = 0.0 ; qU = cross ( qK , qT ) ; qV = cross ( qT , qU ) ; qU = normalize ( qU ) ; qV = normalize ( qV ) ; qT = normalize ( qT ) ; return mat4 ( vec4 ( qU , 0.0 ) , vec4 ( qV , 0.0 ) , vec4 ( qT , 0.0 ) , vec4 ( qS , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"mat4 rd ( in vec3 qX , float qY , float qZ , float q_ , vec3 ra ) { float rb , rc ; rb = fract ( length ( ra ) / 0.17 ) ; rc = q_ + rb / 10.0 ; rb = rb ; if ( q_ != 0.0 ) rb /= q_ ; qX *= 1.0 + 0.5 * sin ( qY ) ; rb = length ( qX ) * qZ * sin ( 2.0 * 3.14 * qY * rc + rb ) ; return bq ( rb ) ; }".split(" ")}]}}]},
{type:"textline",b:"mat4 rl ( in vec3 re , in vec3 rf , in mat4 rg ) { vec3 rh ; float ri , rj ; mat4 rk ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_SPHERICAL","BILLBOARD",{type:"logic_negative_expr",d:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{type:"equal_expr",d:2},{type:"logical_and_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"rk = qQ ( rf , rg ) ;".split(" ")}]}},{type:"elif",c:["BILLBOARD_RANDOM"],group:{type:"group",a:[{type:"textline",
b:"ri = fract ( ( rf . x * 1.43 + rf . y * 0.123 + rf . z * 6.1 ) ) ; ri = 2.0 * M_PI * ri ; rh = normalize ( vec3 ( rg [ 0 ] [ 2 ] , 0.0 , rg [ 2 ] [ 2 ] ) ) ; rj = acos ( rh [ 2 ] ) ; if ( rh [ 0 ] < 0.0 ) rj = 2.0 * M_PI - rj ; rj = rj - ri ; if ( rj < 0.0 ) rj = 2.0 * M_PI + rj ; ri = ri ; if ( rj <= MAX_BILLBOARD_ANGLE ) ri += rj ; else if ( rj <= M_PI - MAX_BILLBOARD_ANGLE ) ri += MAX_BILLBOARD_ANGLE * ( 2.0 * rj - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( rj <= M_PI + MAX_BILLBOARD_ANGLE ) ri += rj - M_PI ; else if ( rj <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) ri += MAX_BILLBOARD_ANGLE * ( 2.0 * rj - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else ri += rj - 2.0 * M_PI ; rk = bo ( ri ) ; rk [ 3 ] = vec4 ( rf , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"rk = qW ( re , rf ) ;".split(" ")}]}}]},{type:"textline",b:["return","rk",";","}"]},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{type:"logic_negative_expr",d:1},{type:"logical_and_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"mat4 rr ( in vec3 rm , in vec3 rn , in mat4 ro , mat4 rp ) { mat4 rq ; rq = rl ( rm , rn , ro ) ; rp [ 3 ] = vec4 ( 0.0 , 0.0 , 0.0 , 1.0 ) ; rq = rq * rp ; return rq ; }".split(" ")}]}}]},
{type:"textline",b:"aR ry ( in vec3 rs , in vec3 rt , in vec3 ru , in vec3 rv , in vec3 rw , in mat4 rx ) { rs = ( rx * vec4 ( rs , 1.0 ) ) . xyz ; rt = ( rx * vec4 ( rt , 1.0 ) ) . xyz ; ru = ( rx * vec4 ( ru , 0.0 ) ) . xyz ; rv = ( rx * vec4 ( rv , 0.0 ) ) . xyz ; rw = ( rx * vec4 ( rw , 0.0 ) ) . xyz ; return bs ( aR ( rs , rt , ru , rv , rw , vec3 ( 0.0 ) ) ) ; }".split(" ")}]};a["include/scale_texcoord.glslv"]={type:"group",a:[{type:"textline",b:"vec2 rB ( vec2 rz , vec3 rA ) { return ( rz + 0.5 ) * rA . xy - 0.5 ; }".split(" ")}]};
a["include/skin.glslv"]={type:"group",a:[{type:"define",name:"SKIN_SLERP",b:["0"]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"vec4 rI ( in vec4 rC , in vec4 rD , in float rE ) { float rF , rG , rH ; rF = rC [ 0 ] * rD [ 0 ] + rC [ 1 ] * rD [ 1 ] + rC [ 2 ] * rD [ 2 ] + rC [ 3 ] * rD [ 3 ] ; if ( rF < 0.0 ) { rD *= - 1.0 ; rF = - rF ; } if ( abs ( rF ) >= 1.0 ) return rC ; rG = acos ( rF ) ; rF = sqrt ( 1.0 - rF * rF ) ; if ( abs ( rF ) < 0.001 ) return vec4 ( rC * 0.5 + rD * 0.5 ) ; rH = sin ( ( 1.0 - rE ) * rG ) / rF ; rF = sin ( rE * rG ) / rF ; return rC * rH + rD * rF ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"vec3 rU ( in vec3 rJ , in vec4 rK , in vec4 rL , in vec4 rM , in vec4 rN , in float rO ) { vec4 rP , rQ ; vec3 rR , rS , rT ; rR = bd ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( rJ , 1.0 ) ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"rP = rI ( rK , rL , rO ) ; rQ = mix ( rM , rN , rO ) ; rS = aX ( rP , rR ) ; rS = rS * rQ . w + rQ . xyz ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"rT = aX ( rK , rR ) ; rR = aX ( rL , rR ) ; rT = rT * rM . w + rM . xyz ; rR = rR * rN . w + rN . xyz ; rS = mix ( rT , rR , rO ) ;".split(" ")}]}}]},{type:"textline",b:"return bj ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( rS , 1.0 ) ) ; } vec3 sc ( in vec3 rV , in vec4 rW , in vec4 rX , in float rY ) { vec4 rZ ; vec3 r_ , sa , sb ; r_ = bd ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( rV , 0.0 ) ) ;".split(" ")},{type:"condition",a:[{type:"if",
c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"rZ = rI ( rW , rX , rY ) ; sa = aX ( rZ , r_ ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"sb = aX ( rW , r_ ) ; r_ = aX ( rX , r_ ) ; sa = mix ( sb , r_ , rY ) ;".split(" ")}]}}]},{type:"textline",b:"return bj ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sa , 0.0 ) ) ; }".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 rU ( in vec3 sd , in vec4 se , in vec4 sf ) { vec3 sg ; sg = bd ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sd , 1.0 ) ) ; sg = aX ( se , sg ) ; sg = sg * sf . w + sf . xyz ; return bj ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sg , 1.0 ) ) ; } vec3 sc ( in vec3 sh , in vec4 si ) { vec3 sj ; sj = bd ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sh , 0.0 ) ) ; sj = aX ( si , sj ) ; return bj ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( sj , 0.0 ) ) ; }".split(" ")}]}}]},
{type:"textline",b:"void sy ( inout vec3 sk , inout vec3 sl , inout vec3 sm , inout vec3 sn ) { int so , sp ; vec4 sq ; vec3 sr , ss , st , su ; float sv , sw ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:["sv","=","u_frame_factor",";"]}]}}]},{type:"textline",b:"if ( a_influence . y > 0.0 ) { sr = vec3 ( 0.0 , 0.0 , 0.0 ) ; ss = vec3 ( 0.0 , 0.0 , 0.0 ) ; st = vec3 ( 0.0 , 0.0 , 0.0 ) ; su = vec3 ( 0.0 , 0.0 , 0.0 ) ; sq = a_influence ; for ( int sx = 0 ; sx < 4 ; sx ++ ) { so = int ( sq [ sx ] ) ; sw = fract ( sq [ sx ] ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"sr += sw * rU ( sk , u_quatsb [ so ] , u_quatsa [ so ] , u_transb [ so ] , u_transa [ so ] , sv ) ; ss += sw * sc ( sl , u_quatsb [ so ] , u_quatsa [ so ] , sv ) ; st += sw * sc ( sm , u_quatsb [ so ] , u_quatsa [ so ] , sv ) ; su += sw * sc ( sn , u_quatsb [ so ] , u_quatsa [ so ] , sv ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"sr += sw * rU ( sk , u_quatsb [ so ] , u_transb [ so ] ) ; su += sw * sc ( sn , u_quatsb [ so ] ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DISABLE_TANGENT_SKINNING",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"ss += sw * sc ( sl , u_quatsb [ so ] ) ; st += sw * sc ( sm , u_quatsb [ so ] ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"} sk = sr ; sn = su ;".split(" ")},{type:"condition",a:[{type:"if",c:["DISABLE_TANGENT_SKINNING",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"sl = ss ; sm = st ;".split(" ")}]}}]},{type:"textline",b:"} if ( ! ( a_influence . y > 0.0 ) ) { sp = int ( a_influence [ 0 ] - 1.0 ) ; if ( sp > - 1 ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"sk = rU ( sk , u_quatsb [ sp ] , u_quatsa [ sp ] , u_transb [ sp ] , u_transa [ sp ] , sv ) ; sl = sc ( sl , u_quatsb [ sp ] , u_quatsa [ sp ] , sv ) ; sm = sc ( sm , u_quatsb [ sp ] , u_quatsa [ sp ] , sv ) ; sn = sc ( sn , u_quatsb [ sp ] , u_quatsa [ sp ] , sv ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"sk = rU ( sk , u_quatsb [ sp ] , u_transb [ sp ] ) ; sn = sc ( sn , u_quatsb [ sp ] ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DISABLE_TANGENT_SKINNING",{type:"logic_negative_expr",d:1}],group:{type:"group",a:[{type:"textline",b:"sl = sc ( sl , u_quatsb [ sp ] ) ; sm = sc ( sm , u_quatsb [ sp ] ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["}","}","}"]}]}}]}]};a["include/wind_bending.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"void sJ ( inout vec3 sz , in vec3 sA , in float sB , in float sC , in float sD , in vec3 sE , in float sF ) { vec3 sG ; float sH , sI ; sH = length ( sA ) ; sI = sC * ( 1.0 + 0.1 * fract ( sH ) ) ; sH = sB * sF * ( 1.0 + sin ( 2.0 * 3.14 * sD * sI + sH ) ) ; sI = ( sz . y - sA . y ) * abs ( sH ) ; sI += 1.0 ; sI *= sI ; sI = sI * sI - sI ; sG = sz ; sG . xz += sE . xz * sI * sign ( sH ) ; sG = sG - sA ; if ( all ( equal ( sG , vec3 ( 0.0 ) ) ) ) sz = sA ; else { sH = length ( sz - sA ) ; sz = sA + normalize ( sG ) * sH ; } }".split(" ")},
{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"vec4 sL ( vec4 sK ) { return sK * sK * ( 3.0 - 2.0 * sK ) ; } vec4 sN ( vec4 sM ) { return abs ( fract ( sM + 0.5 ) * 2.0 - 1.0 ) ; } vec4 sP ( vec4 sO ) { return sL ( sN ( sO ) ) ; } void tf ( inout vec3 sQ , in float sR , in vec3 sS , in vec3 sT , in vec3 sU , in float sV , in float sW , in float sX , in vec3 sY ) { vec3 sZ ; vec4 s_ ; vec2 ta , tb ; float tc , td , te ; tc = dot ( sU , vec3 ( 1.0 ) ) ; td = tc + sY . g ; te = dot ( sQ , vec3 ( sY . g ) ) ; ta = ( sR + vec2 ( te , td ) ) ; s_ = ( ( fract ( ( ta . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( sT ) * sV ; s_ = sP ( s_ ) ; tb = s_ . xz + s_ . yw ; tb . y = 0.5 - tb . y ; sZ = tb . xyx * sY . rbr * vec3 ( sW * sS . x , sX , sW * sS . z ) ; sQ += sZ ; }".split(" ")}]}}]},
{type:"textline",b:"void tm ( inout vec3 tg , inout vec3 th , in vec3 ti ) { vec3 tj , tk , tl ; tj = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:"tk = th ; tl = a_emitter_center ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"tk = tg ; tl = th ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"tf ( tk , u_time , ti , tj , tl , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail ) ;".split(" ")}]}}]},{type:"textline",b:"sJ ( tk , tl , au_wind_bending_amp , au_wind_bending_freq , u_time , tj , a_bending_col_main ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"sJ ( tk , tl , au_wind_bending_amp , au_wind_bending_freq , u_time , tj , 1.0 ) ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:"tg += tk - th ; th = tk ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"tg = tk ; th = tl ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/nodes.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_orco_tex_coord ; varying vec3 ec ;".split(" ")}]}}]},
{type:"node",name:"TEX_COORD_UV",h:[{type:"node_param",name:"node_TEX_COORD_UV_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"eE",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["eE","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{type:"node",name:"UV_MERGED",h:[{type:"node_param",name:"node_UV_MERGED_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"eD",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["eD","=","node_UV_MERGED_var_a_uv",";"]}]},{type:"node",
name:"UVMAP",h:[{type:"node_param",name:"node_UVMAP_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"eF",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["eF","=","node_UVMAP_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_UV",h:[{type:"node_param",name:"node_GEOMETRY_UV_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"ex",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["ex","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_VC",h:[{type:"node_param",
name:"node_GEOMETRY_VC_var_a_vertex_color",qualifier:["attribute","vec3"]},{type:"node_param",name:"tn",qualifier:["varying","vec3"]}],g:[{type:"textline",b:["tn","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC1",h:[{type:"node_param",name:"node_GEOMETRY_VC1_var_a_vertex_color",qualifier:["attribute","float"]},{type:"node_param",name:"to",qualifier:["varying","float"]}],g:[{type:"textline",b:["to","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC2",
h:[{type:"node_param",name:"node_GEOMETRY_VC2_var_a_vertex_color",qualifier:["attribute","vec2"]},{type:"node_param",name:"tp",qualifier:["varying","vec2"]}],g:[{type:"textline",b:["tp","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC3",h:[{type:"node_param",name:"node_GEOMETRY_VC3_var_a_vertex_color",qualifier:["attribute","vec3"]},{type:"node_param",name:"tq",qualifier:["varying","vec3"]}],g:[{type:"textline",b:["tq","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},
{type:"nodes_global"},{type:"textline",b:["void","tr","(",")","{"]},{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["ec","=","a_orco_tex_coord",";"]}]}}]},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/dynamic_grass.glslv"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"vec2 tw ( vec3 ts , float tt , vec2 tu ) { vec2 tv ; tv = vec2 ( ( ts . x - tu . x ) / tt , - ( ts . z - tu . y ) / tt ) ; return fract ( tv ) ; } vec2 tA ( vec2 tx , float ty , vec2 tz ) { return vec2 ( tx . x * ty , - tx . y * ty ) + tz ; } aR tB ( ) { return aR ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; } aR tX ( vec3 tC , vec3 tD , vec3 tE , vec3 tF , vec3 tG , PRECISION sampler2D tH , sampler2D tI , vec3 tJ , float tK , vec3 tL , vec4 tM , mat4 tN ) { mat4 tO ; vec4 tP ; vec2 tQ , tR , tS ; float tT , tU ; vec3 tV ; tV = aX ( tM , vec3 ( 0.0 , - 1.0 , 0.0 ) ) ; tT = - tV . x ; tU = - tV . z ; tQ = vec2 ( tL . x + tK * ( - 1.0 - tT ) / 2.0 , tL . z + tK * ( 1.0 - tU ) / 2.0 ) ; tR = tw ( tG , tK , tQ ) ; tU = tK / 2.0 ; tS = abs ( tA ( tR - vec2 ( 0.5 ) , tK , vec2 ( 0.0 ) ) ) ; tU = tU * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( tS ) > tU ) return tB ( ) ; tU = tK / tJ . z ; tS = ( tR - vec2 ( 0.5 ) ) * tU + vec2 ( 0.5 ) ; tV = tV * ( tK / tJ . z - 1.0 ) / 2.0 ; tS . x += tV . x ; tS . y -= tV . z ; tP = texture2D ( tI , tS ) ; tU = tP . r ; if ( tU < u_scale_threshold ) return tB ( ) ; tT = tJ . y - tJ . x ; tT = tJ . y - texture2D ( tH , tS ) . r * tT ; tS = tC . xz - tG . xz ; tG . xz = tA ( tR , tK , tQ ) ; tG . y = tT ; tC . xz = tG . xz + tS ; tC . y *= tU ; tC . y += tT ; tV = tP . gba ;".split(" ")},
{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"tC -= tG ; tO = rl ( tL , tG , tN ) ; aR tW = ry ( tC , tG , tD , tE , tF , tO ) ; tW . b = tG ; tW . f = tV ; return bs ( tW ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return bs ( aR ( tC , tG , tD , tE , tF , tV ) ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/shadow.glslv"]={type:"group",a:[{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"condition",
a:[{type:"if",c:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{type:"equal_expr",d:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 uc ( mat4 tY , vec4 tZ ) { vec4 t_ ; float ua ; vec2 ub ; ub = ( tY * u_v_light_matrix [ 3 ] ) . xy ; ua = SHADOW_TEX_RES / 2.0 ; ub = floor ( ub * ua + 0.5 ) / ua - ub ; t_ = tY * tZ ; t_ . xy += ub ; t_ = u_b_light_matrix * t_ ; return t_ ; } void ug ( vec3 ud , vec3 ue ) { vec4 uf ; uf = u_v_light_matrix * vec4 ( ud + u_normal_offset * ue , 1.0 ) ; bF = uc ( u_p_light_matrix0 , uf ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"bG = uc ( u_p_light_matrix1 , uf ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"bH = uc ( u_p_light_matrix2 , uf ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"bI = uc ( u_p_light_matrix3 , uf ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/fog.glslf"]=
{type:"group",a:[{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"textline",b:"void uq ( inout vec3 uk , in float ul , in float um , in vec4 un ) { float uo , up ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_FOG"],group:{type:"group",a:[{type:"textline",b:"uo = clamp ( ( ul - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOG_TYPE","QUADRATIC",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:["uo","*=","uo",";"]}]}},
{type:"elif",c:["FOG_TYPE","LINEAR",{type:"equal_expr",d:2}],group:{type:"group",a:[]}},{type:"elif",c:["FOG_TYPE","INVERSE_QUADRATIC",{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"uo = sqrt ( uo ) ;".split(" ")}]}}]},{type:"textline",b:"if ( u_fog_params . w > 0.0 ) { if ( um > u_fog_params . w ) uo = 0.0 ; else if ( um > 0.0 ) { up = ( u_fog_params . w - um ) / u_fog_params . w ; uo *= up * up ; } } uo = 1.0 - ( 1.0 - uo ) * ( 1.0 - u_fog_params . x ) ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:["uo","=","0.0",";"]}]}}]},{type:"textline",b:"uk = mix ( uk , un . rgb , uo ) ; }".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"vec3 uw ( in mat4 ur , in vec3 us ) { vec3 ut , uu , uv ; ut = mix ( ur [ 0 ] . rgb , ur [ 1 ] . rgb , max ( sign ( us . x ) , 0.0 ) ) ; uu = mix ( ur [ 2 ] . rgb , ur [ 3 ] . rgb , max ( sign ( us . z ) , 0.0 ) ) ; uv = vec3 ( ur [ 0 ] . a , ur [ 1 ] . a , ur [ 2 ] . a ) ; uu = mix ( ut , uu , abs ( us . z ) ) ; uu = mix ( uu , uv , abs ( us . y ) ) ; aE ( uu ) ; return uu ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"void uy ( inout float ux ) { ux -= 0.5 ; ux = 4.0 * ( ux * ux * ux ) + 0.5 ; } void uL ( inout vec3 uz , in float uA , in vec3 uB , in float uC , in vec4 uD , in vec4 uE , in float uF ) { vec3 uG , uH ; float uI , uJ , uK ; uI = uE . w * uA ; uI = exp ( - uI * uI ) ; uI = clamp ( uI , 0.0 , 1.0 ) ; uJ = max ( uB . y , 0.0 ) ; uA = max ( uA - max ( uC / uJ , 0.0 ) , 0.0 ) ; uK = uD . w * uA ; uK = 1.0 - uK ; uK = max ( uK , 0.0 ) ; uy ( uK ) ; uK += max ( uF - 0.5 , 0.0 ) ; if ( uK < uI ) { uG = vec3 ( 0.0 , 0.02 , 0.05 ) ; uH = uD . rgb ; uC = clamp ( - uC * 0.03 , 0.0 , 0.8 ) ; uG = mix ( uH , uG , min ( uJ , 1.0 ) ) ; uG = mix ( uG , vec3 ( 0.0 ) , uC ) ; uz = mix ( uG , uz , uK ) ; } if ( uK >= uI ) { uz = mix ( uE . rgb , uz , uI ) ; } } void uR ( inout vec3 uM , in float uN , in float uO ) { vec3 uP ; float uQ ; uQ = u_underwater_fog_color_density . w * uN ; uQ = 1.0 - uQ ; uQ = clamp ( uQ , 0.0 , 1.0 ) ; uy ( uQ ) ; uO = clamp ( - uO * 0.03 , 0.0 , 0.8 ) ; uP = mix ( u_underwater_fog_color_density . rgb , vec3 ( 0.0 ) , uO ) ; uM = mix ( uP , uM , uQ ) ; }".split(" ")}]}}]},
{type:"textline",b:"void uY ( inout vec3 uS , float uT , vec3 uU , float uV ) { vec4 uW ; vec3 uX ;".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"uX = uw ( u_cube_fog , uU ) ; uW = vec4 ( uX , u_fog_color_density . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uW","=","u_fog_color_density",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uL ( uS , uT , uU , u_cam_water_depth , u_underwater_fog_color_density , uW , uV ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"uq ( uS , uT , bz . y , uW ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["include/lighting_nodes.glslf"]={type:"group",a:[{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"define",
name:"M_PI",b:["3.14159265359"]},{type:"textline",b:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float va = 0.5 ; vec3 vb = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{type:"node",name:"LIGHTING_BEGIN",h:[{type:"node_out",name:"vz",qualifier:["vec3"],e:!1},{type:"node_out",name:"vA",qualifier:["vec3"],e:!1},{type:"node_out",name:"vB",qualifier:["vec3"],e:!1},{type:"node_out",name:"vC",qualifier:["vec3"],e:!0},{type:"node_out",name:"vD",qualifier:["vec3"],e:!0},{type:"node_out",name:"vE",
qualifier:["vec2"],e:!0},{type:"node_out",name:"vF",qualifier:["vec2"],e:!0},{type:"node_out",name:"vG",qualifier:["float"],e:!0},{type:"node_out",name:"vH",qualifier:["float"],e:!0},{type:"node_out",name:"vI",qualifier:["vec4"],e:!0}],g:[{type:"textline",b:"vz = vc ; vA = vd ; vB = ve ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vC"],g:[{type:"textline",b:["vC","=","vf",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vD"],g:[{type:"textline",b:["vD","=","vh",
";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vF"],g:[{type:"textline",b:["vF","=","vj",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vE"],g:[{type:"textline",b:["vE","=","vk",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vG"],g:[{type:"textline",b:["vG","=","vl",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vH"],g:[{type:"textline",b:["vH","=","vm",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vI"],g:[{type:"textline",
b:["vI","=","vn",";"]}]}]}]},{type:"node",name:"LIGHTING_AMBIENT",h:[{type:"node_in",name:"vJ",qualifier:["vec3"],e:!1},{type:"node_in",name:"vK",qualifier:["vec3"],e:!1},{type:"node_in",name:"vL",qualifier:["vec3"],e:!1},{type:"node_out",name:"vM",qualifier:["vec4"],e:!1},{type:"node_out",name:"vN",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"vM = vec4 ( vJ + vL * vK , ZERO_VALUE_NODES ) ; vN = vb ;".split(" ")}]},{type:"node",name:"LIGHTING_LAMP",h:[{type:"node_in",name:"vO",qualifier:["float"],
e:!1},{type:"node_out",name:"vP",qualifier:["vec3"],e:!1},{type:"node_out",name:"vQ",qualifier:["vec2"],e:!1},{type:"node_out",name:"vR",qualifier:["vec3"],e:!1},{type:"node_out",name:"vS",qualifier:["float"],e:!1}],g:[{type:"node_condition",a:[{type:"node_if",c:["NODES_GLOW",{type:"logic_negative_expr",d:1},"NUM_LIGHTS",0,{type:"g_expr",d:2},{type:"logical_and_expr",d:2}],g:[{type:"textline",b:"vQ = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{type:"node_condition",
a:[{type:"node_if",c:["LAMP_TYPE","HEMI",{type:"equal_expr",d:2}],g:[{type:"textline",b:["vS","=","va",";"]}]},{type:"node_else",g:[{type:"textline",b:["vS","=","ZERO_VALUE_NODES",";"]}]}]},{type:"textline",b:"vR = u_light_color_intensities [ LAMP_IND ] ; if ( LAMP_SHADOW_MAP_IND != - 1 ) vR *= vO ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["LAMP_TYPE","SPOT",{type:"equal_expr",d:2},"LAMP_TYPE","POINT",{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],g:[{type:"textline",b:"vx = u_light_positions [ LAMP_IND ] ; vP = vx - vg ;".split(" ")},
{type:"textline",b:"vq = length ( vP ) ; vR *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + vq * vq ) ; vP = normalize ( vP ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["LAMP_TYPE","SPOT",{type:"equal_expr",d:2}],g:[{type:"textline",b:"vx = u_light_directions [ LAMP_IND ] ; vq = dot ( vP , vx ) ; vq *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( vq - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; vR *= vq ;".split(" ")}]}]}]},{type:"node_else",g:[{type:"textline",b:"vP = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]}]}]},
{type:"node",name:"DIFFUSE_FRESNEL",h:[{type:"node_in",name:"vT",qualifier:["vec3"],e:!1},{type:"node_in",name:"vU",qualifier:["vec2"],e:!1},{type:"node_in",name:"vV",qualifier:["vec3"],e:!1},{type:"node_in",name:"vW",qualifier:["float"],e:!1},{type:"node_in",name:"vX",qualifier:["vec2"],e:!1},{type:"node_out",name:"vY",qualifier:["float"],e:!1}],g:[{type:"textline",b:"vY = ZERO_VALUE_NODES ; if ( vU . r != ZERO_VALUE_NODES ) { vq = ( UNITY_VALUE_NODES - vW ) * dot ( vV , vT ) + vW ; if ( vX [ 0 ] == ZERO_VALUE_NODES ) { vY = UNITY_VALUE_NODES ; } else { vq = UNITY_VALUE_NODES + abs ( vq ) ; vq = vX [ 1 ] + ( UNITY_VALUE_NODES - vX [ 1 ] ) * pow ( vq , vX [ 0 ] ) ; vY = clamp ( vq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } vY = max ( vY , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_LAMBERT",h:[{type:"node_in",name:"vZ",qualifier:["vec3"],e:!1},{type:"node_in",name:"v_",qualifier:["vec2"],e:!1},{type:"node_in",name:"wa",qualifier:["vec3"],e:!1},{type:"node_in",name:"wb",qualifier:["float"],e:!1},{type:"node_out",name:"wc",qualifier:["float"],e:!1}],g:[{type:"textline",b:"wc = ZERO_VALUE_NODES ; if ( v_ . r != ZERO_VALUE_NODES ) { vq = ( UNITY_VALUE_NODES - wb ) * dot ( wa , vZ ) + wb ; wc = max ( vq , ZERO_VALUE_NODES ) ; }".split(" ")}]},{type:"node",
name:"DIFFUSE_OREN_NAYAR",h:[{type:"node_in",name:"wd",qualifier:["vec3"],e:!1},{type:"node_in",name:"we",qualifier:["vec2"],e:!1},{type:"node_in",name:"wf",qualifier:["vec3"],e:!1},{type:"node_in",name:"wg",qualifier:["float"],e:!1},{type:"node_in",name:"wh",qualifier:["vec2"],e:!1},{type:"node_out",name:"wi",qualifier:["float"],e:!1}],g:[{type:"textline",b:"wi = ZERO_VALUE_NODES ; if ( we . r != ZERO_VALUE_NODES ) { vq = ( UNITY_VALUE_NODES - wg ) * dot ( wf , wd ) + wg ; if ( wh [ 0 ] > ZERO_VALUE_NODES ) { vr = max ( dot ( wf , vi ) , ZERO_VALUE_NODES ) ; vs = wh [ 0 ] * wh [ 0 ] ; vt = UNITY_VALUE_NODES - va * ( vs / ( vs + 0.33 ) ) ; vx = wd - vq * wf ; vy = vi - vr * wf ;".split(" ")},
{type:"textline",b:"if ( length ( vx ) == ZERO_VALUE_NODES || length ( vy ) == ZERO_VALUE_NODES || abs ( vq ) > UNITY_VALUE_NODES || abs ( vr ) > UNITY_VALUE_NODES )".split(" ")},{type:"textline",b:"wi = vq * vt ; else { vu = acos ( vq ) ; vr = acos ( vr ) ; vx = normalize ( vx ) ; vy = normalize ( vy ) ; vv = max ( vu , vr ) ; vw = min ( vu , vr ) ; vw *= 0.95 ; vr = max ( dot ( vx , vy ) , ZERO_VALUE_NODES ) ; vs = 0.45 * ( vs / ( vs + 0.09 ) ) ; wi = vq * ( vt + ( vs * vr * sin ( vv ) * tan ( vw ) ) ) ; } } else wi = vq ; wi = max ( wi , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_MINNAERT",h:[{type:"node_in",name:"wj",qualifier:["vec3"],e:!1},{type:"node_in",name:"wk",qualifier:["vec2"],e:!1},{type:"node_in",name:"wl",qualifier:["vec3"],e:!1},{type:"node_in",name:"wm",qualifier:["float"],e:!1},{type:"node_in",name:"wn",qualifier:["vec2"],e:!1},{type:"node_out",name:"wo",qualifier:["float"],e:!1}],g:[{type:"textline",b:"wo = ZERO_VALUE_NODES ; if ( wk . r != ZERO_VALUE_NODES ) { vq = ( UNITY_VALUE_NODES - wm ) * dot ( wl , wj ) + wm ; vw = max ( dot ( wl , vi ) , ZERO_VALUE_NODES ) ; if ( wn [ 0 ] <= UNITY_VALUE_NODES ) wo = vq * pow ( max ( vw * vq , 0.1 ) , wn [ 0 ] - UNITY_VALUE_NODES ) ; else wo = vq * pow ( 1.0001 - vw , wn [ 0 ] - UNITY_VALUE_NODES ) ; wo = max ( wo , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"DIFFUSE_TOON",h:[{type:"node_in",name:"wp",qualifier:["vec3"],e:!1},{type:"node_in",name:"wq",qualifier:["vec2"],e:!1},{type:"node_in",name:"wr",qualifier:["vec3"],e:!1},{type:"node_in",name:"ws",qualifier:["float"],e:!1},{type:"node_in",name:"wt",qualifier:["vec2"],e:!1},{type:"node_out",name:"wu",qualifier:["float"],e:!1}],g:[{type:"textline",b:"wu = ZERO_VALUE_NODES ; if ( wq . r != ZERO_VALUE_NODES ) { vw = ( UNITY_VALUE_NODES - ws ) * dot ( wr , wp ) + ws ; vw = acos ( vw ) ; if ( vw < wt [ 0 ] ) wu = UNITY_VALUE_NODES ; else if ( vw > ( wt [ 0 ] + wt [ 1 ] ) || wt [ 1 ] == ZERO_VALUE_NODES ) wu = ZERO_VALUE_NODES ; else wu = UNITY_VALUE_NODES - ( ( vw - wt [ 0 ] ) / wt [ 1 ] ) ; wu = max ( wu , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_PHONG",h:[{type:"node_in",name:"wv",qualifier:["vec3"],e:!1},{type:"node_in",name:"ww",qualifier:["vec2"],e:!1},{type:"node_in",name:"wx",qualifier:["vec3"],e:!1},{type:"node_in",name:"wy",qualifier:["float"],e:!1},{type:"node_in",name:"wz",qualifier:["vec2"],e:!1},{type:"node_out",name:"wA",qualifier:["float"],e:!1}],g:[{type:"textline",b:"wA = ZERO_VALUE_NODES ; if ( ww . g != ZERO_VALUE_NODES ) { vy = normalize ( wv + vi ) ; wA = ( UNITY_VALUE_NODES - wy ) * max ( dot ( wx , vy ) , ZERO_VALUE_NODES ) + wy ; wA = pow ( wA , wz [ 0 ] ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_WARDISO",h:[{type:"node_in",name:"wB",qualifier:["vec3"],e:!1},{type:"node_in",name:"wC",qualifier:["vec2"],e:!1},{type:"node_in",name:"wD",qualifier:["vec3"],e:!1},{type:"node_in",name:"wE",qualifier:["vec2"],e:!1},{type:"node_out",name:"wF",qualifier:["float"],e:!1}],g:[{type:"textline",b:"wF = ZERO_VALUE_NODES ; if ( wC . g != ZERO_VALUE_NODES ) { vy = normalize ( wB + vi ) ; vw = max ( dot ( wD , vy ) , 0.001 ) ;".split(" ")},{type:"textline",b:"vq = max ( dot ( wD , vi ) , 0.01 ) ; vv = max ( dot ( wD , wB ) , 0.01 ) ; vw = tan ( acos ( vw ) ) ; vr = max ( wE [ 0 ] , 0.001 ) ; wF = vv * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * vr * vr ) ) * ( exp ( - ( vw * vw ) / ( vr * vr ) ) / ( sqrt ( vq * vv ) ) ) ; }".split(" ")}]},
{type:"node",name:"SPECULAR_TOON",h:[{type:"node_in",name:"wG",qualifier:["vec3"],e:!1},{type:"node_in",name:"wH",qualifier:["vec2"],e:!1},{type:"node_in",name:"wI",qualifier:["vec3"],e:!1},{type:"node_in",name:"wJ",qualifier:["vec2"],e:!1},{type:"node_out",name:"wK",qualifier:["float"],e:!1}],g:[{type:"textline",b:"wK = ZERO_VALUE_NODES ; if ( wH . g != ZERO_VALUE_NODES ) { vy = normalize ( wG + vi ) ; vv = acos ( dot ( vy , wI ) ) ; if ( vv < wJ [ 0 ] ) wK = UNITY_VALUE_NODES ; else if ( vv >= wJ [ 0 ] + wJ [ 1 ] || wJ [ 1 ] == ZERO_VALUE_NODES ) wK = ZERO_VALUE_NODES ; else wK = UNITY_VALUE_NODES - ( vv - wJ [ 0 ] ) / wJ [ 1 ] ; }".split(" ")}]},
{type:"node",name:"SPECULAR_BLINN",h:[{type:"node_in",name:"wL",qualifier:["vec3"],e:!1},{type:"node_in",name:"wM",qualifier:["vec2"],e:!1},{type:"node_in",name:"wN",qualifier:["vec3"],e:!1},{type:"node_in",name:"wO",qualifier:["float"],e:!1},{type:"node_in",name:"wP",qualifier:["vec2"],e:!1},{type:"node_out",name:"wQ",qualifier:["float"],e:!1}],g:[{type:"textline",b:"wQ = ZERO_VALUE_NODES ; if ( wM . g != ZERO_VALUE_NODES ) { if ( wP [ 0 ] < 1.0 || wP [ 1 ] == ZERO_VALUE_NODES ) wQ = ZERO_VALUE_NODES ; else { if ( wP [ 1 ] < 100.0 ) wP [ 1 ] = sqrt ( 1.0 / wP [ 1 ] ) ; else wP [ 1 ] = 10.0 / wP [ 1 ] ; vy = normalize ( vi + wL ) ; vv = ( UNITY_VALUE_NODES - wO ) * max ( dot ( wN , vy ) , ZERO_VALUE_NODES ) + wO ; if ( vv < ZERO_VALUE_NODES ) wQ = ZERO_VALUE_NODES ; else { vq = max ( dot ( wN , vi ) , 0.01 ) ; vr = dot ( wN , wL ) ; if ( vr <= 0.01 ) wQ = ZERO_VALUE_NODES ; else { vw = max ( dot ( vi , vy ) , 0.01 ) ; vs = UNITY_VALUE_NODES ; vq = ( 2.0 * vv * vq ) / vw ; vr = ( 2.0 * vv * vr ) / vw ; vr = min ( min ( vs , vq ) , vr ) ; vq = sqrt ( pow ( wP [ 0 ] , 2.0 ) + pow ( vw , 2.0 ) - UNITY_VALUE_NODES ) ; vw = pow ( vq - vw , 2.0 ) / pow ( vq + vw , 2.0 ) * ( UNITY_VALUE_NODES + pow ( vw * ( vq + vw ) - UNITY_VALUE_NODES , 2.0 ) / pow ( vw * ( vq - vw ) + UNITY_VALUE_NODES , 2.0 ) ) ; vv = acos ( vv ) ; wQ = max ( vw * vr * exp ( - pow ( vv , 2.0 ) / ( 2.0 * pow ( wP [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{type:"node",name:"LIGHTING_APPLY",h:[{type:"node_in",name:"wR",qualifier:["vec4"],e:!1},{type:"node_in",name:"wS",qualifier:["vec3"],e:!1},{type:"node_in",name:"wT",qualifier:["float"],e:!1},{type:"node_in",name:"wU",qualifier:["float"],e:!1},{type:"node_in",name:"wV",qualifier:["vec3"],e:!1},{type:"node_in",name:"wW",qualifier:["vec3"],e:!1},{type:"node_in",name:"wX",qualifier:["vec4"],e:!1},{type:"node_in",name:"wY",qualifier:["vec3"],e:!1},{type:"node_in",name:"wZ",qualifier:["vec3"],e:!1},{type:"node_in",
name:"w_",qualifier:["vec3"],e:!1},{type:"node_in",name:"xa",qualifier:["float"],e:!1},{type:"node_out",name:"xb",qualifier:["vec4"],e:!1},{type:"node_out",name:"xc",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"xc = wS + w_ * wZ * wU ; xb = wR + vec4 ( w_ * wY * wT , wU ) ;".split(" ")}]},{type:"node",name:"LIGHTING_END",h:[{type:"node_in",name:"xd",qualifier:["vec4"],e:!1},{type:"node_in",name:"xe",qualifier:["vec3"],e:!1}],g:[{type:"textline",b:"vo = xd . rgb ; vp = xe ;".split(" ")}]},{type:"nodes_global"},
{type:"textline",b:"void xf ( vec3 vc , vec3 vd , vec3 ve , vec3 vf , vec3 vg , vec3 vh , vec3 vi , vec2 vj , vec2 vk , float vl , float vm , vec4 vn , out vec3 vo , out vec3 vp ) { float vq , vr , vs , vt , vu , vv , vw ; vec3 vx , vy ;".split(" ")},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/particles.glslv"]={type:"group",a:[{type:"var",name:"EPSILON",b:["0.0001"]},{type:"textline",b:"struct xi { float a ; vec3 b ; float c ; vec3 d ; float e ; } ;".split(" ")},{type:"condition",
a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void xo ( inout float xj , float xk , vec2 xl , vec2 xm ) { float xn ; xn = xm . x - xl . x ; xn = ( xk - xl . x ) / xn ; xj = mix ( xj , xm . y , clamp ( xn , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"void xu ( inout vec3 xp , float xq , vec4 xr , vec4 xs ) { float xt ; xt = xs . x - xr . x ; xt = ( xq - xr . x ) / xt ; xp = mix ( xp , xs . yzw , clamp ( xt , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"float xA ( float xv , float xw , vec2 xx [ SIZE_RAMP_LENGTH ] ) { float xy , xz ; xy = xv / xw ; xz = xx [ 0 ] . y ;".split(" ")},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",1,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xo ( xz , xy , xx [ 0 ] , xx [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",2,{type:"g_expr",d:2}],
group:{type:"group",a:[{type:"textline",b:"xo ( xz , xy , xx [ 1 ] , xx [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",3,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xo ( xz , xy , xx [ 2 ] , xx [ 3 ] ) ;".split(" ")}]}}]},{type:"textline",b:["return","xz",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec3 xG ( float xB , float xC , vec4 xD [ COLOR_RAMP_LENGTH ] ) { vec3 xE ; float xF ; xF = xB / xC ; xE = xD [ 0 ] . yzw ;".split(" ")},
{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",1,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xu ( xE , xF , xD [ 0 ] , xD [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",2,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xu ( xE , xF , xD [ 1 ] , xD [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",3,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xu ( xE , xF , xD [ 2 ] , xD [ 3 ] ) ;".split(" ")}]}}]},
{type:"textline",b:["return","xE",";","}"]}]}}]},{type:"textline",b:"float xO ( float xH , float xI , float xJ , float xK ) { float xL , xM , xN ; xL = max ( 0.01 , min ( xI , xJ ) ) ; xM = max ( 0.01 , min ( xI , xK ) ) ; xN = xI - xM ; xM = clamp ( xH / xL , 0.0 , 1.0 ) - step ( xN , xH ) * ( xH - xN ) / xM ; return xM ; } xi xU ( ) { vec3 xP , xQ ; float xR , xS ; xi xT ; if ( u_p_cyclic == 1 ) { xR = mod ( u_p_time , u_p_length ) - a_p_delay ; if ( xR < 0.0 ) xR += u_p_length ; } if ( u_p_cyclic != 1 ) { xR = u_p_time - a_p_delay ; } if ( xR < 0.0 || xR >= a_p_lifetime ) { xT . a = 0.0001 ; xT . b = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( xR < 0.0 || xR >= a_p_lifetime ) ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["WORLD_SPACE"],group:{type:"group",a:[{type:"textline",b:"xP = a_position ; xQ = a_normal ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xP = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; xQ = ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ;".split(" ")}]}}]},{type:"textline",b:"xP += u_p_nfactor * xR * xQ ; xP += a_p_vels . xyz * xR ; xP . y -= u_p_gravity * xR * xR / 2.0 ; xS = max ( u_p_mass , EPSILON ) ; xP += ( u_p_wind_fac * u_wind / xS ) * xR * xR / 2.0 ; xT . b = xP ; xT . e = a_p_vels . w * xR ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xT . a = xA ( xR , u_p_max_lifetime , u_p_size_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"xT . a = 1.0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",0,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"xT . d = xG ( xR , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"textline",b:"xT . d = vec3 ( 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"xT . c = xO ( xR , a_p_lifetime , u_p_fade_in , u_p_fade_out ) ; } return xT ; }".split(" ")}]};a["include/blending.glslf"]={type:"group",a:[{type:"textline",b:"float xW = 0.0 ; float xX = 1.0 ; vec3 xY = vec3 ( xW ) ; vec3 xZ = vec3 ( xX ) ; vec3 yd ( vec3 x_ ) { float ya , yb ; vec4 yc ; yc = vec4 ( xW , - xX / 3.0 , 2.0 / 3.0 , - xX ) ; yc = mix ( vec4 ( x_ . bg , yc . wz ) , vec4 ( x_ . gb , yc . xy ) , step ( x_ . b , x_ . g ) ) ; yc = mix ( vec4 ( yc . xyw , x_ . r ) , vec4 ( x_ . r , yc . yzx ) , step ( yc . x , x_ . r ) ) ; ya = yc . x - min ( yc . w , yc . y ) ; yb = 1.0e-10 ; return vec3 ( abs ( yc . z + ( yc . w - yc . y ) / ( 6.0 * ya + yb ) ) , ya / ( yc . x + yb ) , yc . x ) ; } vec3 yh ( vec3 ye ) { vec3 yf ; vec4 yg ; yg = vec4 ( xX , 2.0 / 3.0 , xX / 3.0 , 3.0 ) ; yf = abs ( fract ( vec3 ( ye . r , ye . r , ye . r ) + yg . xyz ) * 6.0 - yg . www ) ; return ye . b * mix ( yg . xxx , clamp ( yf - yg . xxx , xW , xX ) , ye . g ) ; } vec3 yl ( vec3 yi , vec3 yj , float yk ) { return mix ( yi , yj , yk ) ; } vec3 yp ( vec3 ym , vec3 yn , float yo ) { return yo * ym + yn ; } vec3 yt ( vec3 yq , vec3 yr , float ys ) { return yr - ys * yq ; } vec3 yy ( vec3 yu , vec3 yv , float yw ) { float yx ; yx = xX - yw ; return ( vec3 ( yx ) + yw * yu ) * yv ; } vec3 yD ( vec3 yz , vec3 yA , float yB ) { vec3 yC ; yC = vec3 ( xX - yB ) ; return xZ - ( yC + yB * ( xZ - yz ) ) * ( xZ - yA ) ; } vec3 yI ( vec3 yE , vec3 yF , float yG ) { vec3 yH ; yH = vec3 ( xX - yG ) ; return mix ( yF * ( yH + 2.0 * yG * yE ) , xZ - ( yH + 2.0 * yG * ( xZ - yE ) ) * ( xZ - yF ) , step ( 0.5 , yF ) ) ; } vec3 yM ( vec3 yJ , vec3 yK , float yL ) { return mix ( yK , abs ( yJ - yK ) , yL ) ; } vec3 yQ ( vec3 yN , vec3 yO , float yP ) { return mix ( yO , yO / ( yN + step ( yN , xY ) ) , yP ) ; } vec3 yU ( vec3 yR , vec3 yS , float yT ) { return mix ( yS , min ( yR , yS ) , yT ) ; } vec3 yY ( vec3 yV , vec3 yW , float yX ) { return max ( yX * yV , yW ) ; } vec3 zd ( vec3 yZ , vec3 y_ , float za ) { vec3 zb , zc ; zb = yd ( y_ ) ; if ( zb . y != xW ) { zc = yd ( yZ ) ; zc = yh ( vec3 ( zb . x , zc . yz ) ) ; return mix ( yZ , zc , za ) ; } return yZ ; } vec3 zj ( vec3 ze , vec3 zf , float zg ) { vec3 zh , zi ; zh = yd ( ze ) ; if ( zh . y != xW ) { zi = yd ( zf ) ; return yh ( vec3 ( zh . x , mix ( zh . y , zi . y , zg ) , zh . z ) ) ; } return ze ; } vec3 zp ( vec3 zk , vec3 zl , float zm ) { vec3 zn , zo ; zn = yd ( zk ) ; zo = yd ( zl ) ; return yh ( vec3 ( zn . xy , mix ( zn . z , zo . z , zm ) ) ) ; } vec3 zv ( vec3 zq , vec3 zr , float zs ) { vec3 zt , zu ; zt = yd ( zr ) ; if ( zt . y != xW ) { zu = yd ( zq ) ; zu = yh ( vec3 ( zt . xy , zu . z ) ) ; return mix ( zq , zu , zs ) ; } return zq ; } vec3 zA ( vec3 zw , vec3 zx , float zy ) { vec3 zz ; zz = xZ - ( xZ - zx ) * ( xZ - zw ) ; return mix ( zw , ( ( xZ - zw ) * zx * zw ) + zw * zz , zy ) ; } vec3 zE ( vec3 zB , vec3 zC , float zD ) { return zB + zD * ( 2.0 * zC - xX ) ; } float zK ( float zF , float zG , float zH , float zI ) { float zJ ; zJ = xX - zI ; return ( zJ + zH * zF ) * zG ; } float zQ ( float zL , float zM , float zN , float zO ) { float zP ; zP = xX - zO ; return xX - ( zP + zN * ( xX - zL ) ) * ( xX - zM ) ; } float zW ( float zR , float zS , float zT , float zU ) { float zV ; zV = xX - zU ; return mix ( zS * ( zV + 2.0 * zT * zR ) , xX - ( zV + 2.0 * zT * ( xX - zR ) ) * ( xX - zS ) , step ( 0.5 , zS ) ) ; }".split(" ")}]};
a["include/fxaa.glslf"]={type:"group",a:[{type:"condition",a:[{type:"ifndef",name:"FXAA_PS3",group:{type:"group",a:[{type:"define",name:"FXAA_PS3",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_360",group:{type:"group",a:[{type:"define",name:"FXAA_360",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_360_OPT",group:{type:"group",a:[{type:"define",name:"FXAA_360_OPT",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_PC",group:{type:"group",a:[{type:"define",name:"FXAA_PC",
b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_PC_CONSOLE",group:{type:"group",a:[{type:"define",name:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_GLSL_120",group:{type:"group",a:[{type:"define",name:"FXAA_GLSL_120",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_GLSL_130",group:{type:"group",a:[{type:"define",name:"FXAA_GLSL_130",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_HLSL_3",group:{type:"group",a:[{type:"define",
name:"FXAA_HLSL_3",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_HLSL_4",group:{type:"group",a:[{type:"define",name:"FXAA_HLSL_4",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_HLSL_5",group:{type:"group",a:[{type:"define",name:"FXAA_HLSL_5",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_GREEN_AS_LUMA",group:{type:"group",a:[{type:"define",name:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_EARLY_EXIT",group:{type:"group",
a:[{type:"define",name:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_DISCARD",group:{type:"group",a:[{type:"define",name:"FXAA_DISCARD",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_FAST_PIXEL_OFFSET",group:{type:"group",a:[{type:"condition",a:[{type:"ifdef",name:"GL_EXT_gpu_shader4",group:{type:"group",a:[{type:"define",name:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{type:"condition",a:[{type:"ifdef",name:"GL_NV_gpu_shader5",group:{type:"group",a:[{type:"define",
name:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{type:"condition",a:[{type:"ifdef",name:"GL_ARB_gpu_shader5",group:{type:"group",a:[{type:"define",name:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_FAST_PIXEL_OFFSET",group:{type:"group",a:[{type:"define",name:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_GATHER4_ALPHA",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["FXAA_HLSL_5",1,{type:"equal_expr",d:2}],
group:{type:"group",a:[{type:"define",name:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{type:"condition",a:[{type:"ifdef",name:"GL_ARB_gpu_shader5",group:{type:"group",a:[{type:"define",name:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{type:"condition",a:[{type:"ifdef",name:"GL_NV_gpu_shader5",group:{type:"group",a:[{type:"define",name:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_GATHER4_ALPHA",group:{type:"group",a:[{type:"define",name:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{type:"condition",
a:[{type:"ifndef",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:[1],group:{type:"group",a:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{type:"condition",a:[{type:"if",c:[0],group:{type:"group",a:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{type:"condition",a:[{type:"if",c:[0],group:{type:"group",a:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["2.0"]}]}}]}]}}]},{type:"condition",a:[{type:"ifndef",
name:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:[1],group:{type:"group",a:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{type:"else",group:{type:"group",a:[{type:"define",name:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{type:"condition",a:[{type:"ifndef",name:"FXAA_QUALITY_PRESET",group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",
10,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["3"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P1",b:["3.0"]},{type:"define",name:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",11,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["4"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.5"]},
{type:"define",name:"FXAA_QUALITY_P2",b:["3.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",12,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["5"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["4.0"]},{type:"define",name:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},
{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",13,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["6"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",b:["4.0"]},{type:"define",name:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",
14,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["7"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",b:["4.0"]},{type:"define",name:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",
15,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["8"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",b:["4.0"]},{type:"define",name:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{type:"condition",
a:[{type:"if",c:["FXAA_QUALITY_PRESET",20,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["3"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P1",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",21,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["4"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",
name:"FXAA_QUALITY_P1",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",22,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["5"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["2.0"]},{type:"define",
name:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",23,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["6"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{type:"condition",
a:[{type:"if",c:["FXAA_QUALITY_PRESET",24,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["7"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",b:["3.0"]},{type:"define",name:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{type:"condition",
a:[{type:"if",c:["FXAA_QUALITY_PRESET",25,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["8"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",b:["4.0"]},{type:"define",name:"FXAA_QUALITY_P7",
b:["8.0"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",26,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["9"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",
b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",b:["4.0"]},{type:"define",name:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",27,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["10"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",
b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P8",b:["4.0"]},{type:"define",name:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",28,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["11"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",
b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P8",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P9",b:["4.0"]},{type:"define",name:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",
29,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["12"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P2",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P3",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P4",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P5",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P6",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",b:["2.0"]},{type:"define",
name:"FXAA_QUALITY_P8",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P9",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P10",b:["4.0"]},{type:"define",name:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PRESET",39,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"define",name:"FXAA_QUALITY_PS",b:["12"]},{type:"define",name:"FXAA_QUALITY_P0",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P1",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P2",b:["1.0"]},{type:"define",
name:"FXAA_QUALITY_P3",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P4",b:["1.0"]},{type:"define",name:"FXAA_QUALITY_P5",b:["1.5"]},{type:"define",name:"FXAA_QUALITY_P6",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P7",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P8",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P9",b:["2.0"]},{type:"define",name:"FXAA_QUALITY_P10",b:["4.0"]},{type:"define",name:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{type:"var",name:"FXAA_QUALITY_P12",b:["0.0"]},{type:"textline",b:"float As ( float Ar ) { return clamp ( Ar , 0.0 , 1.0 ) ; }".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_BLEND4WEB",1,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"vec4 Av ( sampler2D At , vec2 Au ) { return texture2D ( At , Au ) ; } vec4 AA ( sampler2D Aw , vec2 Ax , vec2 Ay , vec2 Az ) { return texture2D ( Aw , Ax + ( Ay * Az ) ) ; }".split(" ")}]}}]},{type:"textline",b:"vec4 Bg ( vec2 AB , sampler2D AC , vec2 AD , float AE , float AF , float AG ) { bool AH , AI , AJ , AK , AL ; float AM , AN , AO , AP , AQ , AR , AS , AT , AU , AV , AW , AX , AY , AZ , A_ ; vec4 Ba ; vec2 Bb , Bc , Bd , Be , Bf ; Bb . x = AB . x ; Bb . y = AB . y ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_GATHER4_ALPHA",1,{type:"equal_expr",d:2}],group:{type:"group",a:[]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Ba = Av ( AC , Bb ) ; AM = aO ( Ba ) ; AN = aO ( AA ( AC , Bb , vec2 ( 0 , 1 ) , AD . xy ) ) ; AO = aO ( AA ( AC , Bb , vec2 ( 1 , 0 ) , AD . xy ) ) ; AP = aO ( AA ( AC , Bb , vec2 ( 0 , - 1 ) , AD . xy ) ) ; AQ = aO ( AA ( AC , Bb , vec2 ( - 1 , 0 ) , AD . xy ) ) ;".split(" ")}]}}]},{type:"textline",b:"AR = max ( AN , AM ) ; AS = min ( AN , AM ) ; AR = max ( AO , AR ) ; AS = min ( AO , AS ) ; AT = max ( AP , AQ ) ; AU = min ( AP , AQ ) ; AR = max ( AT , AR ) ; AS = min ( AU , AS ) ; AU = AR * AF ; AS = AR - AS ; AU = max ( AG , AU ) ; AH = AS < AU ; if ( AH ) return Ba ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_GATHER4_ALPHA",0,{type:"equal_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"AU = aO ( AA ( AC , Bb , vec2 ( - 1 , - 1 ) , AD . xy ) ) ; AR = aO ( AA ( AC , Bb , vec2 ( 1 , 1 ) , AD . xy ) ) ; AT = aO ( AA ( AC , Bb , vec2 ( 1 , - 1 ) , AD . xy ) ) ; AV = aO ( AA ( AC , Bb , vec2 ( - 1 , 1 ) , AD . xy ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[]}}]},{type:"textline",b:"AW = AP + AN ; AX = AQ + AO ; AS = 1.0 / AS ; AY = AW + AX ; AW = ( - 2.0 * AM ) + AW ; AX = ( - 2.0 * AM ) + AX ; AZ = AT + AR ; AT = AU + AT ; A_ = ( - 2.0 * AO ) + AZ ; AT = ( - 2.0 * AP ) + AT ; AU = AU + AV ; AR = AV + AR ; A_ = ( abs ( AW ) * 2.0 ) + abs ( A_ ) ; AT = ( abs ( AX ) * 2.0 ) + abs ( AT ) ; AX = ( - 2.0 * AQ ) + AU ; AR = ( - 2.0 * AN ) + AR ; A_ = abs ( AX ) + A_ ; AT = abs ( AR ) + AT ; AZ = AU + AZ ; AU = AD . x ; AH = A_ >= AT ; AZ = AY * 2.0 + AZ ; if ( ! AH ) AP = AQ ; if ( ! AH ) AN = AO ; if ( AH ) AU = AD . y ; AZ = ( AZ * ( 1.0 / 12.0 ) ) - AM ; AO = AP - AM ; AQ = AN - AM ; AP = AP + AM ; AN = AN + AM ; AI = abs ( AO ) >= abs ( AQ ) ; AQ = max ( abs ( AO ) , abs ( AQ ) ) ; if ( AI ) AU = - AU ; AS = As ( abs ( AZ ) * AS ) ; Bc . x = Bb . x ; Bc . y = Bb . y ; Bd . x = ( ! AH ) ? 0.0 : AD . x ; Bd . y = ( AH ) ? 0.0 : AD . y ; if ( ! AH ) Bc . x += AU * 0.5 ; if ( AH ) Bc . y += AU * 0.5 ; Be . x = Bc . x - Bd . x * FXAA_QUALITY_P0 ; Be . y = Bc . y - Bd . y * FXAA_QUALITY_P0 ; Bf . x = Bc . x + Bd . x * FXAA_QUALITY_P0 ; Bf . y = Bc . y + Bd . y * FXAA_QUALITY_P0 ; AZ = ( ( - 2.0 ) * AS ) + 3.0 ; AO = aO ( Av ( AC , Be ) ) ; AS = AS * AS ; AY = aO ( Av ( AC , Bf ) ) ; if ( ! AI ) AP = AN ; AQ = AQ * 1.0 / 4.0 ; AN = AM - AP * 0.5 ; AS = AZ * AS ; AI = AN < 0.0 ; AO -= AP * 0.5 ; AY -= AP * 0.5 ; AJ = abs ( AO ) >= AQ ; AK = abs ( AY ) >= AQ ; if ( ! AJ ) Be . x -= Bd . x * FXAA_QUALITY_P1 ; if ( ! AJ ) Be . y -= Bd . y * FXAA_QUALITY_P1 ; AL = ( ! AJ ) || ( ! AK ) ; if ( ! AK ) Bf . x += Bd . x * FXAA_QUALITY_P1 ; if ( ! AK ) Bf . y += Bd . y * FXAA_QUALITY_P1 ; if ( AL ) { if ( ! AJ ) AO = aO ( Av ( AC , Be . xy ) ) ; if ( ! AK ) AY = aO ( Av ( AC , Bf . xy ) ) ; if ( ! AJ ) AO = AO - AP * 0.5 ; if ( ! AK ) AY = AY - AP * 0.5 ; AJ = abs ( AO ) >= AQ ; AK = abs ( AY ) >= AQ ; if ( ! AJ ) Be . x -= Bd . x * FXAA_QUALITY_P2 ; if ( ! AJ ) Be . y -= Bd . y * FXAA_QUALITY_P2 ; AL = ( ! AJ ) || ( ! AK ) ; if ( ! AK ) Bf . x += Bd . x * FXAA_QUALITY_P2 ; if ( ! AK ) Bf . y += Bd . y * FXAA_QUALITY_P2 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PS",3,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( AL ) { if ( ! AJ ) AO = aO ( Av ( AC , Be . xy ) ) ; if ( ! AK ) AY = aO ( Av ( AC , Bf . xy ) ) ; if ( ! AJ ) AO = AO - AP * 0.5 ; if ( ! AK ) AY = AY - AP * 0.5 ; AJ = abs ( AO ) >= AQ ; AK = abs ( AY ) >= AQ ; if ( ! AJ ) Be . x -= Bd . x * FXAA_QUALITY_P3 ; if ( ! AJ ) Be . y -= Bd . y * FXAA_QUALITY_P3 ; AL = ( ! AJ ) || ( ! AK ) ; if ( ! AK ) Bf . x += Bd . x * FXAA_QUALITY_P3 ; if ( ! AK ) Bf . y += Bd . y * FXAA_QUALITY_P3 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PS",4,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( AL ) { if ( ! AJ ) AO = aO ( Av ( AC , Be . xy ) ) ; if ( ! AK ) AY = aO ( Av ( AC , Bf . xy ) ) ; if ( ! AJ ) AO = AO - AP * 0.5 ; if ( ! AK ) AY = AY - AP * 0.5 ; AJ = abs ( AO ) >= AQ ; AK = abs ( AY ) >= AQ ; if ( ! AJ ) Be . x -= Bd . x * FXAA_QUALITY_P4 ; if ( ! AJ ) Be . y -= Bd . y * FXAA_QUALITY_P4 ; AL = ( ! AJ ) || ( ! AK ) ; if ( ! AK ) Bf . x += Bd . x * FXAA_QUALITY_P4 ; if ( ! AK ) Bf . y += Bd . y * FXAA_QUALITY_P4 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PS",5,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( AL ) { if ( ! AJ ) AO = aO ( Av ( AC , Be . xy ) ) ; if ( ! AK ) AY = aO ( Av ( AC , Bf . xy ) ) ; if ( ! AJ ) AO = AO - AP * 0.5 ; if ( ! AK ) AY = AY - AP * 0.5 ; AJ = abs ( AO ) >= AQ ; AK = abs ( AY ) >= AQ ; if ( ! AJ ) Be . x -= Bd . x * FXAA_QUALITY_P5 ; if ( ! AJ ) Be . y -= Bd . y * FXAA_QUALITY_P5 ; AL = ( ! AJ ) || ( ! AK ) ; if ( ! AK ) Bf . x += Bd . x * FXAA_QUALITY_P5 ; if ( ! AK ) Bf . y += Bd . y * FXAA_QUALITY_P5 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PS",6,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( AL ) { if ( ! AJ ) AO = aO ( Av ( AC , Be . xy ) ) ; if ( ! AK ) AY = aO ( Av ( AC , Bf . xy ) ) ; if ( ! AJ ) AO = AO - AP * 0.5 ; if ( ! AK ) AY = AY - AP * 0.5 ; AJ = abs ( AO ) >= AQ ; AK = abs ( AY ) >= AQ ; if ( ! AJ ) Be . x -= Bd . x * FXAA_QUALITY_P6 ; if ( ! AJ ) Be . y -= Bd . y * FXAA_QUALITY_P6 ; AL = ( ! AJ ) || ( ! AK ) ; if ( ! AK ) Bf . x += Bd . x * FXAA_QUALITY_P6 ; if ( ! AK ) Bf . y += Bd . y * FXAA_QUALITY_P6 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PS",7,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( AL ) { if ( ! AJ ) AO = aO ( Av ( AC , Be . xy ) ) ; if ( ! AK ) AY = aO ( Av ( AC , Bf . xy ) ) ; if ( ! AJ ) AO = AO - AP * 0.5 ; if ( ! AK ) AY = AY - AP * 0.5 ; AJ = abs ( AO ) >= AQ ; AK = abs ( AY ) >= AQ ; if ( ! AJ ) Be . x -= Bd . x * FXAA_QUALITY_P7 ; if ( ! AJ ) Be . y -= Bd . y * FXAA_QUALITY_P7 ; AL = ( ! AJ ) || ( ! AK ) ; if ( ! AK ) Bf . x += Bd . x * FXAA_QUALITY_P7 ; if ( ! AK ) Bf . y += Bd . y * FXAA_QUALITY_P7 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PS",8,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( AL ) { if ( ! AJ ) AO = aO ( Av ( AC , Be . xy ) ) ; if ( ! AK ) AY = aO ( Av ( AC , Bf . xy ) ) ; if ( ! AJ ) AO = AO - AP * 0.5 ; if ( ! AK ) AY = AY - AP * 0.5 ; AJ = abs ( AO ) >= AQ ; AK = abs ( AY ) >= AQ ; if ( ! AJ ) Be . x -= Bd . x * FXAA_QUALITY_P8 ; if ( ! AJ ) Be . y -= Bd . y * FXAA_QUALITY_P8 ; AL = ( ! AJ ) || ( ! AK ) ; if ( ! AK ) Bf . x += Bd . x * FXAA_QUALITY_P8 ; if ( ! AK ) Bf . y += Bd . y * FXAA_QUALITY_P8 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PS",9,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( AL ) { if ( ! AJ ) AO = aO ( Av ( AC , Be . xy ) ) ; if ( ! AK ) AY = aO ( Av ( AC , Bf . xy ) ) ; if ( ! AJ ) AO = AO - AP * 0.5 ; if ( ! AK ) AY = AY - AP * 0.5 ; AJ = abs ( AO ) >= AQ ; AK = abs ( AY ) >= AQ ; if ( ! AJ ) Be . x -= Bd . x * FXAA_QUALITY_P9 ; if ( ! AJ ) Be . y -= Bd . y * FXAA_QUALITY_P9 ; AL = ( ! AJ ) || ( ! AK ) ; if ( ! AK ) Bf . x += Bd . x * FXAA_QUALITY_P9 ; if ( ! AK ) Bf . y += Bd . y * FXAA_QUALITY_P9 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PS",10,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( AL ) { if ( ! AJ ) AO = aO ( Av ( AC , Be . xy ) ) ; if ( ! AK ) AY = aO ( Av ( AC , Bf . xy ) ) ; if ( ! AJ ) AO = AO - AP * 0.5 ; if ( ! AK ) AY = AY - AP * 0.5 ; AJ = abs ( AO ) >= AQ ; AK = abs ( AY ) >= AQ ; if ( ! AJ ) Be . x -= Bd . x * FXAA_QUALITY_P10 ; if ( ! AJ ) Be . y -= Bd . y * FXAA_QUALITY_P10 ; AL = ( ! AJ ) || ( ! AK ) ; if ( ! AK ) Bf . x += Bd . x * FXAA_QUALITY_P10 ; if ( ! AK ) Bf . y += Bd . y * FXAA_QUALITY_P10 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PS",11,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( AL ) { if ( ! AJ ) AO = aO ( Av ( AC , Be . xy ) ) ; if ( ! AK ) AY = aO ( Av ( AC , Bf . xy ) ) ; if ( ! AJ ) AO = AO - AP * 0.5 ; if ( ! AK ) AY = AY - AP * 0.5 ; AJ = abs ( AO ) >= AQ ; AK = abs ( AY ) >= AQ ; if ( ! AJ ) Be . x -= Bd . x * FXAA_QUALITY_P11 ; if ( ! AJ ) Be . y -= Bd . y * FXAA_QUALITY_P11 ; AL = ( ! AJ ) || ( ! AK ) ; if ( ! AK ) Bf . x += Bd . x * FXAA_QUALITY_P11 ; if ( ! AK ) Bf . y += Bd . y * FXAA_QUALITY_P11 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_QUALITY_PS",12,{type:"g_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"if ( AL ) { if ( ! AJ ) AO = aO ( Av ( AC , Be . xy ) ) ; if ( ! AK ) AY = aO ( Av ( AC , Bf . xy ) ) ; if ( ! AJ ) AO = AO - AP * 0.5 ; if ( ! AK ) AY = AY - AP * 0.5 ; AJ = abs ( AO ) >= AQ ; AK = abs ( AY ) >= AQ ; if ( ! AJ ) Be . x -= Bd . x * FXAA_QUALITY_P12 ; if ( ! AJ ) Be . y -= Bd . y * FXAA_QUALITY_P12 ; AL = ( ! AJ ) || ( ! AK ) ; if ( ! AK ) Bf . x += Bd . x * FXAA_QUALITY_P12 ; if ( ! AK ) Bf . y += Bd . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:"} AQ = Bb . x - Be . x ; AP = Bf . x - Bb . x ; if ( ! AH ) AQ = Bb . y - Be . y ; if ( ! AH ) AP = Bf . y - Bb . y ; AK = ( AO < 0.0 ) != AI ; AO = ( AP + AQ ) ; AI = ( AY < 0.0 ) != AI ; AO = 1.0 / AO ; AJ = AQ < AP ; AP = min ( AQ , AP ) ; AI = AJ ? AK : AI ; AS = AS * AS ; AO = ( AP * ( - AO ) ) + 0.5 ; AS = AS * AE ; AO = AI ? AO : 0.0 ; AS = max ( AO , AS ) ; if ( ! AH ) Bb . x += AS * AU ; if ( AH ) Bb . y += AS * AU ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FXAA_DISCARD",1,{type:"equal_expr",d:2},"FXAA_BLEND4WEB",1,{type:"equal_expr",d:2},{type:"logical_or_expr",d:2}],group:{type:"group",a:[{type:"textline",b:"return Av ( AC , Bb ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec4 ( Av ( AC , Bb ) . xyz , AM ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["include/depth_fetch.glslf"]={type:"group",a:[{type:"textline",b:"float Bn ( in sampler2D Bh , in vec2 Bi , in vec2 Bj ) { float Bk , Bl , Bm ; Bk = texture2D ( Bh , Bi ) . r ; Bl = Bj . x ; Bm = Bj . y ; Bl = 2.0 * Bl / ( Bl + Bm - ( 2.0 * Bk - 1.0 ) * ( Bm - Bl ) ) ; return Bl ; }".split(" ")}]}};b4w.module.animation=function(a,p){var e=p("__animation"),b=p("__print"),c=p("__armature"),m=p("__obj_util");a.SLOT_0=e.SLOT_0;a.SLOT_1=e.SLOT_1;a.SLOT_2=e.SLOT_2;a.SLOT_3=e.SLOT_3;a.SLOT_4=e.SLOT_4;a.SLOT_5=e.SLOT_5;a.SLOT_6=e.SLOT_6;a.SLOT_7=e.SLOT_7;a.SLOT_ALL=e.SLOT_ALL;a.OBJ_ANIM_TYPE_NONE=e.OBJ_ANIM_TYPE_NONE;a.OBJ_ANIM_TYPE_ARMATURE=e.OBJ_ANIM_TYPE_ARMATURE;a.OBJ_ANIM_TYPE_OBJECT=e.OBJ_ANIM_TYPE_OBJECT;a.OBJ_ANIM_TYPE_VERTEX=e.OBJ_ANIM_TYPE_VERTEX;a.OBJ_ANIM_TYPE_SOUND=e.OBJ_ANIM_TYPE_SOUND;
a.OBJ_ANIM_TYPE_PARTICLES=e.OBJ_ANIM_TYPE_PARTICLES;a.OBJ_ANIM_TYPE_MATERIAL=e.OBJ_ANIM_TYPE_MATERIAL;a.AB_CYCLIC=e.AB_CYCLIC;a.AB_FINISH_RESET=e.AB_FINISH_RESET;a.AB_FINISH_STOP=e.AB_FINISH_STOP;var f=new Float32Array(8);a.is_animated=function(a){return e.is_animated(a)};a.get_actions=function(){b.error("get_actions() deprecated, use get_anim_names() instead");for(var a=[],c=e.nt(),f=0;f<c.length;f++)a.push(e.dF(c[f].name));return a};a.get_current_action=function(c,e){b.error("get_current_action() deprecated, use get_current_anim_name() instead");
return a.get_current_anim_name(c,e)};a.get_anim_names=function(a){return e.Cu(a)?e.get_anim_names(a):[]};a.get_current_anim_name=function(a,b){if(!e.is_animated(a))return null;b=b||e.SLOT_0;return e.wB(a,b)};a.apply=function(a,c,f){if(f>e.SLOT_7)b.error("Can't apply animation to slot "+f+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{f=f||e.SLOT_0;if(e.is_animated(a)){var d=e.get_slot_num_by_anim(a,c);if(-1!=d&&d!=f){b.error('Animation "'+c+'" is already applied to object "'+
a.name+'" (slot "'+d+'").');return}}e.qG(a,c)?e.apply(a,c,f):b.error('No fcurves in action "'+c+'"')}};a.remove=function(a){e.remove(a)};a.remove_slot_animation=function(a,b){e.is_animated(a)&&(b=b||e.SLOT_0,e.remove_slot_animation(a,b))};a.apply_def=function(a){e.apply_def(a)};a.play=function(a,c,f){e.is_animated(a)?(f=f||e.SLOT_0,e.play(a,c,f),e.update_object_animation(a,0,f,!0)):b.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){e.is_animated(a)&&(b=b||e.SLOT_0,e.stop(a,
b))};a.is_play=function(a,b){if(!e.is_animated(a))return!1;b=b||e.SLOT_0;return e.is_play(a,b)};a.set_current_frame_float=function(c,e,f){b.error("set_current_frame_float() deprecated, use set_frame() instead");a.set_frame(c,e,f)};a.get_current_frame_float=function(c,e){b.error("get_current_frame_float() deprecated, use get_frame() instead");return a.get_frame(c,e)};a.set_frame=function(a,b,c){e.is_animated(a)&&(c=c||e.SLOT_0,e.set_frame(a,b,c))};a.set_first_frame=function(a,b){e.is_animated(a)&&
e.set_first_frame(a,b)};a.set_last_frame=function(a,b){if(e.is_animated(a)){b=b||e.SLOT_0;var c=e.get_anim_start_frame(a,b),d=e.get_anim_length(a,b);e.set_frame(a,c+d-e.ex,b)}};a.get_frame=function(a,b){if(!e.is_animated(a))return 0;b=b||e.SLOT_0;return e.get_current_frame_float(a,b)};a.set_speed=function(a,b,c){e.is_animated(a)&&(c=c||e.SLOT_0,e.set_speed(a,b||1,c))};a.get_speed=function(a,b){if(!e.is_animated(a))return 0;b=b||e.SLOT_0;return a.D[b]?e.get_speed(a,b):0};a.get_frame_range=function(a,
c){b.error("get_frame_range() deprecated, use get_anim_start_frame() and get_anim_length() instead");if(e.is_animated(a)){c=c||e.SLOT_0;var f=a.D[c];if(f)return[f.start,f.start+f.length]}return null};a.get_anim_start_frame=function(a,b){return e.is_animated(a)&&(b=b||e.SLOT_0,a.D[b])?e.get_anim_start_frame(a,b):-1};a.get_anim_length=function(a,b){return e.is_animated(a)&&(b=b||e.SLOT_0,a.D[b])?e.get_anim_length(a,b):-1};a.cyclic=function(c,f,m){b.error("cyclic() deprecated, use set_behavior() instead");
a.set_behavior(c,f?e.AB_CYCLIC:e.AB_FINISH_RESET,m)};a.is_cyclic=function(a,c){b.error("is_cyclic() deprecated, use get_behavior() instead");if(!e.is_animated(a))return!1;c=c||e.SLOT_0;return e.is_cyclic(a,c)};a.set_behavior=function(a,b,c){e.is_animated(a)&&(c=c||e.SLOT_0,e.set_behavior(a,b,c))};a.get_behavior=function(a,b){if(!e.is_animated(a))return null;b=b||e.SLOT_0;return e.get_behavior(a,b)};a.apply_smoothing=function(a,b,c,d){d=d||e.SLOT_0;e.is_animated(a)&&e.apply_smoothing(a,b,c,d)};a.update_object_animation=
function(a,c,f,d){b.error("update_object_animation() deprecated, use set_frame() instead");e.is_animated(a)&&(f=f||e.SLOT_0,e.update_object_animation(a,c||0,f,d||!1))};a.frame_to_sec=function(a){return e.frame_to_sec(a)};a.get_bone_translation=function(a,e,p){b.error("get_bone_translation() deprecated, use armature.get_bone_tsr() instead");if(!m.is_armature(a))return null;if(!c.yj(a,e))return b.error('There is no bone: "',e,'" in "',a.name,'".'),null;p||(p=new Float32Array(3));c.get_bone_tsr(a,e,
!1,!1,f);p[0]=f[0];p[1]=f[1];p[2]=f[2];return p};a.get_first_armature_object=function(){b.error("get_first_armature_object() deprecated");return null};a.get_slot_num_by_anim=function(a,b){return e.is_animated(a)&&b?e.get_slot_num_by_anim(a,b):null};a.get_anim_type=function(a,b){return e.is_animated(a)?e.get_anim_type(a,b):null};a.apply_to_first_empty_slot=function(a,b){return e.apply_to_first_empty_slot(a,b)};a.get_skel_mix_factor=function(a){return a.f.jf};a.set_skel_mix_factor=function(a,c,f){m.is_armature(a)?
(c=Math.min(Math.max(c,0),1),a.f.jf!=c&&e.set_skel_mix_factor(a,c,f||0)):b.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.anchors=function(a,p){var e=p("__anchors");p("__print");a.attach_move_cb=e.attach_move_cb;a.detach_move_cb=e.detach_move_cb;a.is_anchor=e.is_anchor;a.get_element_id=e.get_element_id};b4w.module.armature=function(a,p){var e=p("__armature"),b=p("__obj_util"),c=p("__transform"),m=p("__print");a.get_bone_tsr=function(a,c,h){if(!b.is_armature(a))return null;if(!e.yj(a,c))return m.error('There is no bone: "',c,'" in "',a.name,'".'),null;h||(h=new Float32Array(8));e.get_bone_tsr(a,c,!1,!1,h);return h};a.get_bone_tsr_rel=function(a,c,h){if(!b.is_armature(a))return null;if(!e.yj(a,c))return m.error('There is no bone: "',c,'" in "',a.name,'".'),null;h||(h=new Float32Array(8));e.get_bone_tsr(a,
c,!1,!0,h);return h};a.set_bone_tsr=function(a,l,h){b.is_armature(a)&&(e.yj(a,l)?(e.set_bone_tsr(a,l,h,!1),c.o(a)):m.error('There is no bone: "',l,'" in "',a.name,'".'))};a.set_bone_tsr_rel=function(a,l,h){b.is_armature(a)&&(e.yj(a,l)?(e.set_bone_tsr(a,l,h,!0),c.o(a)):m.error('There is no bone: "',l,'" in "',a.name,'".'))}};b4w.module.assets=function(a,p){var e=p("__assets");a.AT_ARRAYBUFFER=e.AT_ARRAYBUFFER;a.AT_JSON=e.AT_JSON;a.AT_TEXT=e.AT_TEXT;a.AT_AUDIOBUFFER=e.AT_AUDIOBUFFER;a.AT_IMAGE_ELEMENT=e.AT_IMAGE_ELEMENT;a.AT_AUDIO_ELEMENT=e.AT_AUDIO_ELEMENT;a.enqueue=function(a,c,m,f){if(a.length)if(a.id)e.enqueue(a,c,m,f);else{for(var l=[],h=0;h<a.length;h++){var p=a[h];l.push({id:p[0],type:p[1],url:p[2],Yc:p.Yc?p.Yc:"GET",lh:null,Nf:null,Za:p[3]})}e.enqueue(l,c,m,f)}}};b4w.module.camera=function(a,p){function e(a,c){b.is_target_camera(a)?(n.copy(c,a.f.ac),g.o(a),t.sync_transform(a)):d.error("set_pivot(): Wrong object or camera move style")}var b=p("__camera");p("__config");var c=p("__constraints"),m=p("__container"),f=p("__mat3"),l=p("__mat4"),h=p("__obj_util"),t=p("__physics"),d=p("__print"),g=p("__transform"),k=p("__util"),n=p("__vec3"),x=p("__vec4"),I=new Float32Array(2),A=new Float32Array(3),B=new Float32Array(3),y=new Float32Array(4),v=new Float32Array(9);
a.MS_STATIC=b.MS_STATIC;a.MS_ANIMATION=b.MS_STATIC;a.MS_TARGET_CONTROLS=b.MS_TARGET_CONTROLS;a.MS_EYE_CONTROLS=b.MS_EYE_CONTROLS;a.MS_HOVER_CONTROLS=b.MS_HOVER_CONTROLS;a.is_camera=function(a){d.error("camera.is_camera() deprecated, use objects.is_camera() instead");return h.is_camera(a)};a.is_target_camera=b.is_target_camera;a.is_eye_camera=b.is_eye_camera;a.is_hover_camera=b.is_hover_camera;a.set_move_style=function(a,c){return h.is_camera(a)?c!=b.MS_STATIC&&c!=b.MS_EYE_CONTROLS&&c!=b.MS_HOVER_CONTROLS&&
c!=b.MS_TARGET_CONTROLS?(d.error("set_move_style(): Wrong camera move style"),!1):b.set_move_style(a,c):(d.error("set_move_style(): Wrong object"),!1)};a.get_move_style=function(a){return h.is_camera(a)?b.get_move_style(a):(d.error("get_move_style(): Wrong object"),null)};a.set_velocity_params=function(a,c){if(b.is_target_camera(a)||b.is_eye_camera(a)||b.is_hover_camera(a)){var e=a.f;e.gr=k.clamp(c[0],0,Infinity);e.fr=k.clamp(c[1],0,Infinity);e.hr=k.clamp(c[2],0,1)}else d.error("set_velocity_params(): Wrong object or camera move style")};
a.get_velocity_params=function(a,c){if(!b.is_target_camera(a)&&!b.is_eye_camera(a)&&!b.is_hover_camera(a))return d.error("get_velocity_params(): Wrong object or camera move style"),null;c||(c=new Float32Array(3));var e=a.f;c[0]=e.gr;c[1]=e.fr;c[2]=e.hr;return c};a.set_look_at=function(a,c,d,e){e=e||k.AXIS_Y;b.set_look_at(a,c,d,e)};a.get_eye=function(a,c){return h.is_camera(a)?b.get_eye(a,c):(d.error("get_eye(): Wrong object"),null)};a.set_pivot=e;a.set_trans_pivot=function(a,c,e){b.is_target_camera(a)?
b.set_trans_pivot(a,c,e):d.error("set_trans_pivot(): Wrong object or camera move style")};a.get_pivot=function(a,c){if(!b.is_target_camera(a))return d.error("get_pivot(): Wrong object or camera move style"),null;c||(c=new Float32Array(3));n.copy(a.f.ac,c);return c};a.rotate_pivot=function(b,c,e){d.error("rotate_pivot() deprecated, use rotate_camera() or rotate_target_camera() instead");a.rotate_target_camera(b,c,e)};a.move_pivot=function(a,c,e){if(b.is_target_camera(a)){var h=a.f;if(h.kw){var k=f.fromMat4(h.aa,
v),l=n.subtract(h.i,h.ac,B);A[0]=c;A[1]=0;A[2]=e;n.scale(A,n.len(l),A);n.transformMat3(A,k,A);n.add(h.ac,A,h.ac);n.add(h.i,A,h.i);g.o(a);t.sync_transform(a)}}else d.error("move_pivot(): wrong object")};a.rotate_hover_cam=function(b,c){d.error("rotate_hover_cam() deprecated, use rotate_camera() or rotate_hover_camera() instead");a.rotate_hover_camera(b,c,0)};a.get_hover_cam_angle=function(a){d.error("get_hover_cam_angle() deprecated, use get_camera_angles() instead");return b.is_hover_camera(a)?-b.get_camera_angles(a,
I)[1]:(d.error("get_hover_cam_angle(): wrong object or camera move style"),null)};a.set_hover_cam_angle=function(a,c){d.error("set_hover_cam_angle() deprecated, use rotate_camera() or rotate_hover_camera() instead");if(b.is_hover_camera(a))if(a.f.rb){var e=b.get_camera_angles(a,I);(e=-c-e[1])&&b.rotate_hover_camera(a,0,e);g.o(a);t.sync_transform(a)}else d.error("set_hover_cam_angle(): distance/hover_angle limits are not defined or disabled");else d.error("set_hover_cam_angle(): wrong object or camera move style")};
a.get_hover_angle_limits=function(a,c){if(!b.is_hover_camera(a))return d.error("get_hover_angle_limits(): wrong object"),null;a.f.Ob?(c||(c=new Float32Array(2)),c[0]=a.f.Ob.fb,c[1]=a.f.Ob.qb):d.error("get_hover_angle_limits(): camera hasn't angle limits");return c};a.get_cam_dist_limits=function(a,c){if(!b.is_hover_camera(a)&&!b.is_target_camera(a))return d.error("get_cam_dist_limits(): wrong object"),null;a.f.rb?(c||(c=new Float32Array(2)),c[0]=a.f.Gg,c[1]=a.f.Be):d.error("get_cam_dist_limits(): camera hasn't distance limits");
return c};a.translate_hover_cam_v=function(b,c){d.error("translate_hover_cam_v() deprecated, use hover_cam_set_translation() instead");a.hover_cam_set_translation(b,c)};a.hover_cam_set_translation=function(a,c){if(b.is_hover_camera(a)){var e=a.f;if(e.rb){var f=n.subtract(c,e.i,A);n.add(f,e.kc,e.kc)}g.set_translation(a,c);g.o(a);t.sync_transform(a)}else d.error("hover_cam_set_translation(): wrong object")};a.set_hover_pivot=function(a,c){b.is_hover_camera(a)?b.set_hover_pivot(a,c):d.error("set_hover_pivot(): Wrong object or camera move style")};
a.get_hover_cam_pivot=function(a,c){if(!b.is_hover_camera(a))return d.error("get_hover_cam_pivot(): wrong object"),null;c||(c=new Float32Array(3));n.copy(a.f.kc,c);return c};a.has_distance_limits=function(a){return b.is_target_camera(a)||b.is_hover_camera(a)?a.f.rb:(d.error("has_distance_limits(): wrong object"),null)};a.apply_vertical_limits=function(a,c,e,f){switch(b.get_move_style(a)){case b.MS_TARGET_CONTROLS:case b.MS_EYE_CONTROLS:f|=g.SPACE_WORLD;break;case b.MS_HOVER_CONTROLS:if(c>e){d.error("apply_vertical_limits(): wrong vertical limits");
return}break;default:d.error("apply_vertical_limits(): wrong object");return}a.f.qc={fb:c,qb:e};b.MD(a,f==g.SPACE_LOCAL);g.o(a);t.sync_transform(a)};a.clear_vertical_limits=function(a){a.f.qc=null};a.get_vertical_limits=function(a,c){if(!b.is_target_camera(a)&&!b.is_eye_camera(a)&&!b.is_hover_camera(a))return d.error("get_vertical_limits(): wrong object"),null;var e=a.f;c=c||new Float32Array(2);return e.qc?(c[0]=e.qc.fb,c[1]=e.qc.qb,c):null};a.has_vertical_limits=function(a){return b.is_target_camera(a)||
b.is_eye_camera(a)||b.is_hover_camera(a)?Boolean(a.f.qc):(d.error("has_vertical_limits(): wrong object"),null)};a.apply_horizontal_limits=function(a,c,e,f){switch(b.get_move_style(a)){case b.MS_TARGET_CONTROLS:case b.MS_EYE_CONTROLS:f|=g.SPACE_WORLD;break;case b.MS_HOVER_CONTROLS:if(c>e){d.error("apply_horizontal_limits(): wrong horizontal limits");return}break;default:d.error("apply_horizontal_limits(): wrong object");return}a.f.jc={left:c,right:e};b.ID(a,f==g.SPACE_LOCAL);g.o(a);t.sync_transform(a)};
a.clear_horizontal_limits=function(a){a.f.jc=null};a.get_horizontal_limits=function(a,c){if(!b.is_target_camera(a)&&!b.is_eye_camera(a)&&!b.is_hover_camera(a))return d.error("get_horizontal_limits(): wrong object"),null;var e=a.f;c=c||new Float32Array(2);return e.jc?(c[0]=e.jc.left,c[1]=e.jc.right,c):null};a.has_horizontal_limits=function(a){return b.is_target_camera(a)||b.is_eye_camera(a)||b.is_hover_camera(a)?Boolean(a.f.jc):(d.error("has_horizontal_limits(): wrong object"),null)};a.apply_hover_angle_limits=
function(a,c,e){b.is_hover_camera(a)?c<e?d.error("apply_hover_angle_limits(): wrong hover angle limits"):b.apply_hover_angle_limits(a,c,e):d.error("apply_hover_angle_limits(): wrong object")};a.clear_hover_angle_limits=function(a){b.is_hover_camera(a)?a.f.Ob=null:d.error("clear_hover_angle_limits(): wrong object")};a.apply_distance_limits=function(a,c,e){b.is_target_camera(a)||b.is_hover_camera(a)?c>e?d.error("apply_distance_limits(): wrong distance limits"):b.apply_distance_limits(a,c,e):d.error("apply_distance_limits(): wrong object")};
a.clear_distance_limits=function(a){b.is_target_camera(a)||b.is_hover_camera(a)?a.f.rb=!1:d.error("clear_distance_limits(): wrong object")};a.set_eye_params=function(b,c,e){d.error("set_eye_params() deprecated, use rotate_camera() or rotate_eye_camera() instead");a.rotate_eye_camera(b,c,Math.PI/2-e)};a.is_look_up=function(a){k.quat_to_dir(a.f.quat,k.AXIS_MY,A);return 0<=A[1]?!0:!1};a.rotate_camera=function(c,e,f,h,k){switch(a.get_move_style(c)){case b.MS_STATIC:break;case b.MS_TARGET_CONTROLS:b.rotate_target_camera(c,
e,f,h,k);break;case b.MS_EYE_CONTROLS:b.rotate_eye_camera(c,e,f,h,k);break;case b.MS_HOVER_CONTROLS:b.rotate_hover_camera(c,e,f,h,k);break;default:d.error("rotate_camera(): Wrong object")}g.o(c);t.sync_transform(c)};a.rotate_target_camera=function(a,c,e,f,h){b.is_target_camera(a)?(b.rotate_target_camera(a,c,e,f,h),g.o(a),t.sync_transform(a)):d.error("rotate_target_camera(): wrong object")};a.rotate_eye_camera=function(a,c,e,f,h){b.is_eye_camera(a)?(b.rotate_eye_camera(a,c,e,f,h),g.o(a),t.sync_transform(a)):
d.error("rotate_eye_camera(): wrong object")};a.rotate_hover_camera=function(a,c,e,f,h){b.is_hover_camera(a)?(b.rotate_hover_camera(a,c,e,f,h),g.o(a),t.sync_transform(a)):d.error("rotate_hover_camera(): wrong object")};a.rotate=function(b,c,e){d.error("rotate() deprecated, use rotate_camera() or rotate_eye_camera() instead");a.rotate_eye_camera(b,c,-e)};a.get_camera_angles=function(a,c){c||(c=new Float32Array(2));b.get_camera_angles(a,c);return c};a.get_camera_angles_char=function(a,c){c||(c=new Float32Array(2));
b.get_camera_angles_char(a,c);return c};a.get_angles=function(a,c){d.error("get_angles() deprecated, use get_camera_angles() instead");c||(c=new Float32Array(2));b.get_angles(a,c);return c};a.set_stereo_distance=function(a,c){for(var d=a.f.R,e=0;e<d.length;e++){var f=d[e];f.type!=b.Kb&&f.type!=b.Pb||b.AE(f,c,f.ke)}};a.get_stereo_distance=function(a){a=a.f.R;for(var c=0;c<a.length;c++){var d=a[c];if(d.type==b.Kb||d.type==b.Pb)return d.Ok}return 0};a.translate_view=function(a,c,d,e){a=a.f.R;for(var f=
0;f<a.length;f++){var g=a[f];g.mc||b.Sf(g,g.Na);var h=A;h[0]=-c;h[1]=-d;h[2]=0;l.translate(g.Ga,h,g.Ga);l.rotateZ(g.Ga,e,g.Ga);l.multiply(g.Ga,g.za,g.Od);b.ls(g);b.Zn(g)}};a.get_fov=function(a){return k.Mm(a.f.R[0].Rc)};a.set_fov=function(a,c){for(var d=a.f.R,e=0;e<d.length;e++){var f=d[e];f.Rc=k.AA(c);f.mc||b.Sf(f,f.Na);l.multiply(f.Ga,f.za,f.Od);b.ls(f);b.Zn(f)}};a.correct_up=function(a,b){b||(b=k.AXIS_Y);c.correct_up(a,b)};a.zoom_object=function(a,c){if(b.is_target_camera(a)){g.get_object_center(c,
!1,A);e(a,A);g.o(a);var f=g.get_object_size(c),h=b.vB(a)/2,f=f/Math.sin(h),h=g.qD(a,A);g.move_local(a,0,f-h,0);g.o(a);t.sync_transform(a)}else d.error("zoom_object(): wrong object")};a.set_ortho_scale=function(c,e){if(h.is_camera(c)&&a.is_ortho_camera(c)){var f=c.f;if(b.is_target_camera(c)){var g=n.dist(f.i,f.ac);f.ki=e/2*f.ji/g}else b.is_hover_camera(c)&&a.has_distance_limits(c)?(g=n.distance(f.i,f.kc),f.ki=e/2*f.ji/g):c.f.R[0].top=e/2;b.TF(c)}else d.error("set_ortho_scale(): wrong object")};a.get_ortho_scale=
function(b){return h.is_camera(b)&&a.is_ortho_camera(b)?2*b.f.R[0].top:(d.error("get_ortho_scale(): wrong object"),null)};a.is_ortho_camera=function(a){return h.is_camera(a)?a.f.R[0].type==b.kd:(d.error("is_ortho_camera(): wrong object"),null)};a.calc_ray=function(a,c,e,f){f||(f=new Float32Array(3));var g=a.f.R[0];switch(g.type){case b.Xb:case b.qe:case b.Kb:case b.Pb:var h=Math.tan(g.Rc*Math.PI/360),k=h*g.Na;c=m.bo(c,e,I,g);y[0]=(2*c[0]/g.width-1)*k;y[1]=-1;y[2]=(2*c[1]/g.height-1)*h;y[3]=0;x.transformMat4(y,
a.f.aa,y);f[0]=y[0];f[1]=y[1];f[2]=y[2];n.normalize(f,f);return f;default:return d.error("Non-compatible camera"),f}};a.project_point=function(a,c,d){d||(d=new Float32Array(2));return b.project_point(a,c,d)}};b4w.module.config=function(a,p){var e=p("__config");a.P_LOW=e.P_LOW;a.P_HIGH=e.P_HIGH;a.P_ULTRA=e.P_ULTRA;a.P_CUSTOM=e.P_CUSTOM;a.set=e.set;a.get=e.get;a.reset=e.reset;a.get_std_assets_path=e.get_std_assets_path};b4w.module.controls=function(a,p){var e=p("__controls"),b=p("__print");a.CT_CONTINUOUS=e.CT_CONTINUOUS;a.CT_TRIGGER=e.CT_TRIGGER;a.CT_SHOT=e.CT_SHOT;a.CT_LEVEL=e.CT_LEVEL;a.CT_CHANGE=e.CT_CHANGE;a.KEY_BACKSPACE=8;a.KEY_TAB=9;a.KEY_ENTER=13;a.KEY_SHIFT=16;a.KEY_CTRL=17;a.KEY_ALT=18;a.KEY_PAUSE=19;a.KEY_CAPSLOCK=20;a.KEY_ESC=27;a.KEY_SPACE=32;a.KEY_LEFT=37;a.KEY_UP=38;a.KEY_RIGHT=39;a.KEY_DOWN=40;a.KEY_1=49;a.KEY_2=50;a.KEY_3=51;a.KEY_4=52;a.KEY_5=53;a.KEY_6=54;a.KEY_7=55;a.KEY_8=56;a.KEY_9=57;a.KEY_A=
65;a.KEY_B=66;a.KEY_C=67;a.KEY_D=68;a.KEY_E=69;a.KEY_F=70;a.KEY_G=71;a.KEY_H=72;a.KEY_I=73;a.KEY_J=74;a.KEY_K=75;a.KEY_L=76;a.KEY_M=77;a.KEY_N=78;a.KEY_O=79;a.KEY_P=80;a.KEY_Q=81;a.KEY_R=82;a.KEY_S=83;a.KEY_T=84;a.KEY_U=85;a.KEY_V=86;a.KEY_W=87;a.KEY_X=88;a.KEY_Y=89;a.KEY_Z=90;a.KEY_NUM0=96;a.KEY_NUM1=97;a.KEY_NUM2=98;a.KEY_NUM3=99;a.KEY_NUM4=100;a.KEY_NUM5=101;a.KEY_NUM6=102;a.KEY_NUM7=103;a.KEY_NUM8=104;a.KEY_NUM9=105;a.KEY_DEC_POINT=110;a.KEY_SEMI_COLON=186;a.KEY_EQUAL_SIGN=187;a.KEY_COMMA=188;
a.KEY_DASH=189;a.KEY_PERIOD=190;a.KEY_FORWARD_SLASH=191;a.KEY_GRAVE_ACCENT=192;a.KEY_LEFT_SQ_BRACKET=219;a.KEY_BACK_SLASH=220;a.KEY_RIGHT_SQ_BRACKET=221;a.KEY_SINGLE_QUOTE=222;a.PL_SINGLE_TOUCH_MOVE=e.PL_SINGLE_TOUCH_MOVE;a.PL_MULTITOUCH_MOVE_ZOOM=e.PL_MULTITOUCH_MOVE_ZOOM;a.PL_MULTITOUCH_MOVE_PAN=e.PL_MULTITOUCH_MOVE_PAN;a.create_custom_sensor=e.create_custom_sensor;a.create_keyboard_sensor=e.create_keyboard_sensor;a.create_collision_sensor=function(a,b,f){return e.create_collision_sensor(a,b||"ANY",
f||!1)};a.create_collision_impulse_sensor=e.create_collision_impulse_sensor;a.create_ray_sensor=function(a,b,f,l,h,p,d){return e.create_ray_sensor(a,b,f,l||"ANY",h||!1,p||!1,d||!1)};a.create_mouse_click_sensor=e.create_mouse_click_sensor;a.create_mouse_wheel_sensor=e.create_mouse_wheel_sensor;a.create_mouse_move_sensor=e.create_mouse_move_sensor;a.create_touch_move_sensor=e.create_touch_move_sensor;a.create_touch_zoom_sensor=e.create_touch_zoom_sensor;a.create_motion_sensor=e.create_motion_sensor;
a.create_vertical_velocity_sensor=e.create_vertical_velocity_sensor;a.create_gyro_angles_sensor=e.create_gyro_angles_sensor;a.create_gyro_delta_sensor=e.create_gyro_delta_sensor;a.create_timer_sensor=function(a,b){return e.create_timer_sensor(a,b||!1)};a.reset_timer_sensor=e.reset_timer_sensor;a.create_elapsed_sensor=e.create_elapsed_sensor;a.create_timeline_sensor=e.create_timeline_sensor;a.create_selection_sensor=function(a,b){return e.create_selection_sensor(a,b||!1)};a.set_custom_sensor=function(a,
b){e.mE(a,b)};a.get_custom_sensor=function(a){return a.value};a.get_sensor_value=e.get_sensor_value;a.get_sensor_payload=e.get_sensor_payload;a.create_sensor_manifold=function(a,b,f,l,h,p,d){h=h||e.Ps;e.create_sensor_manifold(a,b,f,l,h,p,void 0===d?null:d)};a.create_kb_sensor_manifold=function(a,b,f,l,h,p){l=e.create_keyboard_sensor(l);e.create_sensor_manifold(a,b,f,[l],e.Ps,h,void 0===p?null:p)};a.check_sensor_manifolds=function(a){return e.check_sensor_manifold(a,null)};a.check_sensor_manifold=
e.check_sensor_manifold;a.remove_sensor_manifolds=function(a){b.error("remove_sensor_manifolds() deprecated, use remove_sensor_manifold() instead");e.remove_sensor_manifold(a,null)};a.remove_sensor_manifold=e.remove_sensor_manifold;a.reset=e.reset;a.register_keyboard_events=e.register_keyboard_events;a.register_mouse_events=function(a,b,f){e.register_mouse_events(a,b,!!f)};a.register_wheel_events=e.register_wheel_events;a.register_touch_events=e.register_touch_events;a.register_device_orientation=
e.register_device_orientation;a.unregister_keyboard_events=e.unregister_keyboard_events;a.unregister_mouse_events=e.unregister_mouse_events;a.unregister_wheel_events=e.unregister_wheel_events;a.unregister_touch_events=e.unregister_touch_events;a.unregister_device_orientation=e.unregister_device_orientation};b4w.module.constraints=function(a,p){var e=p("__camera"),b=p("__constraints"),c=p("__obj_util"),m=p("__physics"),f=p("__print"),l=p("__transform");a.append_stiff=function(a,c,d,e,f){f=f||1;c instanceof Array&&2==c.length?b.wy(a,c[0],c[1],d,e,f):b.Rr(a,c,d,e,f);l.o(a);m.sync_transform(a)};a.append_semi_stiff=function(a,c,d,e){b.vy(a,c,d,e);l.o(a);m.sync_transform(a)};a.append_semi_stiff_cam=function(a,c,d,g,k,n,p,I){e.is_eye_camera(a)?(b.uy(a,c,d,g,k,n,p,I),l.o(a),m.sync_transform(a)):f.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};
a.append_semi_soft_cam=function(a,c,d,g){if(e.is_eye_camera(a)){if(!g||0>g)g=.25;b.ty(a,c,d,g);l.o(a);m.sync_transform(a)}else f.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_stiff_trans=function(a,c,d){b.yy(a,c,d);l.o(a);m.sync_transform(a)};a.append_copy_trans=function(a,c,d){b.oy(a,c,d);l.o(a);m.sync_transform(a)};a.append_stiff_trans_rot=function(a,c,d,e){b.zy(a,c,d,e);l.o(a);m.sync_transform(a)};a.append_track=function(a,c){3==c.length?
b.By(a,c):b.Ay(a,c);l.o(a);m.sync_transform(a)};a.append_follow=function(a,c,d,e){3==c.length?b.qy(a,c,d,e):b.py(a,c,d,e);l.o(a);m.sync_transform(a)};a.append_stiff_viewport=function(a,c,d){b.append_stiff_viewport(a,c,d);l.o(a);m.sync_transform(a)};a.remove=function(a){a.Sa&&b.remove(a)};a.get_parent=function(a){f.error("constraints.get_parent() deprecated, use objects.get_parent() instead");return c.get_parent(a)}};b4w.module.container=function(a,p){var e=p("__container"),b=p("__print");a.get_canvas=e.get_canvas;a.get_canvas_hud=e.get_canvas_hud;a.get_container=e.get_container;a.insert_to_container=function(a,m){2!=arguments.length?b.error("insert_to_container(): two arguments required"):a&&m&&e.insert_to_container(a,m)};a.set_canvas_offsets=e.set_canvas_offsets;a.update_canvas_offsets=e.update_canvas_offsets;a.client_to_canvas_coords=e.client_to_canvas_coords;a.force_offsets_updating=e.force_offsets_updating;
a.resize=function(a,m,f){a&&m||b.warn("Wrong canvas container dimensions: "+a+"x"+m+". Zero dimensions aren't allowed. Resized to: "+e.vn+"x"+e.un+".");e.resize(a,m,f)}};b4w.module.data=function(a,p){var e=p("__data");p("__print");p("__util");a.load=e.load;a.unload=function(a){e.unload(a|0)};a.set_debug_resources_root=e.set_debug_resources_root;a.is_primary_loaded=e.is_primary_loaded;a.load_and_add_new=e.load;a.cleanup=a.unload};b4w.module.debug=function(a,p){function e(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ /))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];break;default:a+=b[e]}b.ALU_OPS=a;b.TEX_OPS=c;return b}function b(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);
if(200==c.status)return c.responseText;throw"Error POST XHR: "+c.status;}function c(a){a.sort(function(a,b){return b.Ro.ALU_OPS-a.Ro.ALU_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.Ro,e=c.yG,f=m(c.oA),f=f?"\t\t("+f.join(", ")+")":"\t\t(NA)";n.groupCollapsed("FRAG --\x3e","ALU",d.ALU_OPS,"TEX",d.TEX_OPS,"\t\tVERT --\x3e","ALU",e.ALU_OPS,"TEX",e.TEX_OPS,f);n.groupCollapsed("directives");for(var f=c.ib.tf,g=0;g<f.length;g++){var h=f[g];n.log(h[0],h[1])}n.groupEnd();n.groupCollapsed("vert src");
n.log(c.xG);n.groupEnd();n.groupCollapsed("vert stats");for(var k in e)"ALU_OPS"!=k&&"TEX_OPS"!=k&&n.log(k,e[k]);n.groupEnd();n.groupCollapsed("frag src");n.log(c.gB);n.groupEnd();n.groupCollapsed("frag stats");for(k in d)"ALU_OPS"!=k&&"TEX_OPS"!=k&&n.log(k,d[k]);n.groupEnd();n.groupEnd()}}function m(a){for(var b=x.ci(),c=0;c<b.length;c++)for(var e=b[c],f=d.Aa(e,"MESH",d.DATA_ID_ALL),h=0;h<f.length;h++){var k=g.Oa(f[h],e);if(k&&k.S.length)for(var k=k.S,n=0;n<k.length;n++){var l=k[n];if(l.Ub==a&&l.Sc.length)return l.Sc}}return null}
p("__batch");p("__config");var f=p("__controls"),l=p("__debug"),h=p("__extensions"),t=p("__loader"),d=p("__objects"),g=p("__obj_util"),k=p("__physics"),n=p("__print"),x=p("__scenes"),I=p("__scenegraph"),A=p("__sfx"),B=p("__shaders"),y=p("__textures"),v=p("__util"),F=p("vec3");a.WM_NONE=l.WM_NONE;a.WM_OPAQUE_WIREFRAME=l.WM_OPAQUE_WIREFRAME;a.WM_TRANSPARENT_WIREFRAME=l.WM_TRANSPARENT_WIREFRAME;a.WM_FRONT_BACK_VIEW=l.WM_FRONT_BACK_VIEW;a.WM_DEBUG_SPHERES=l.WM_DEBUG_SPHERES;a.physics_stats=function(){k.wA()};
a.physics_id=function(a){n.log("O",k.ZA(a));for(var b=k.uB().jb.p,c=0;c<b.length;c++){var d=b[c];d.m.t==a&&n.log("B",d)}};a.visible_objects=function(){for(var a=x.get_active(),b=d.Aa(a,"MESH",d.DATA_ID_ALL),a=[x.ea(a,"MAIN_OPAQUE"),x.ea(a,"MAIN_BLEND")],c=0;c<a.length;c++){var e=a[c],f=e.p;if(f.length){n.group(e.type,"DYNAMIC");for(var g=0;g<b.length;g++){var h=b[g],k=h.f;if("DYNAMIC"==k.type)for(var l=0;l<f.length;l++){var m=f[l];if(m.tb&&m.Jd==k){n.Dp(h.name,h);break}}}n.groupEnd();n.groupCollapsed(e.type,
"STATIC");for(g=0;g<b.length;g++)if(h=b[g],k=h.f,"DYNAMIC"!=k.type)for(l=0;l<f.length;l++)if(m=f[l],m.tb&&m.Jd==k){n.Dp(h.name,h);break}n.groupEnd()}}};a.object_info=function(a){for(var b=x.get_active(),c=d.Aa(b,"MESH",d.DATA_ID_ALL),e=0;e<c.length;e++){var f=c[e];if(f.name==a){n.log("Object",f);for(var g=x.Wo(b),h=0;h<g.length;h++){for(var k=g[h],l=k.p,m=[],p=0;p<l.length;p++)l[p].Jd==f.f&&m.push(l[p]);n.log("Subscene "+k.type,m)}}}};a.objects_stat=function(){var a=x.get_active();console.log("Armatures: "+
d.Aa(a,"ARMATURE",d.DATA_ID_ALL).length);console.log("Cameras: "+d.Aa(a,"CAMERA",d.DATA_ID_ALL).length);console.log("Curves: "+d.Aa(a,"CURVE",d.DATA_ID_ALL).length);console.log("Empties: "+d.Aa(a,"EMPTY",d.DATA_ID_ALL).length);console.log("Lamps: "+d.Aa(a,"LAMP",d.DATA_ID_ALL).length);console.log("Meshes: "+d.Aa(a,"MESH",d.DATA_ID_ALL).length);console.log("Speakers: "+d.Aa(a,"SPEAKER",d.DATA_ID_ALL).length)};a.num_vertices=function(){for(var a=0,b=x.get_active(),b=[x.ea(b,"MAIN_OPAQUE"),x.ea(b,"MAIN_BLEND")],
c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.p,e=0;e<d.length;e++){var f=d[e].B;f&&(a+=f.num_vertices)}}return a};a.num_triangles=function(){for(var a=0,b=x.get_active(),b=[x.ea(b,"MAIN_OPAQUE"),x.ea(b,"MAIN_BLEND")],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.p,e=0;e<d.length;e++){var f=d[e].B;f&&(a+=f.num_triangles)}}return a};a.num_draw_calls=function(){for(var a=x.get_active(),b=[x.ea(a,"MAIN_OPAQUE"),x.ea(a,"MAIN_BLEND")],b=b[0].p.length+b[1].p.length,a=x.Pv(a,["MAIN_PLANE_REFLECT","MAIN_CUBE_REFLECT"]),
c=0;c<a.length;c++)var d=a[c],b="MAIN_PLANE_REFLECT"==d.type?b+d.p.length:b+6*d.p.length;return b};a.num_shaders=function(){return v.ek(B.rt())};a.geometry_stats=function(){for(var a=x.get_active(),b=x.Wo(a),a={},c=0;c<b.length;c++){var d=b[c];if("SINK"!=d.type&&"WIREFRAME"!=d.type)for(var e=d.p,f=0;f<e.length;f++){var g=e[f].B,h=e[f].Jd;g&&("COLOR_PICKING"!=d.type&&"OUTLINE_MASK"!=d.type||h.Cm||h.Bm)&&(a[g.id]=g)}}var e=d=c=b=0,k;for(k in a)g=a[k],g=g.N,g.Ql&&(d++,e+=g.Ql/1048576),b++,c+=g.Os/1048576;
return{vbo_number:b,vbo_memory:c,ibo_number:d,ibo_memory:e}};a.num_textures=function(){for(var a=[],b=0,c=x.get_active(),c=[x.ea(c,"MAIN_OPAQUE"),x.ea(c,"MAIN_BLEND")],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.p,f=0;f<e.length;f++){var g=e[f].B;if(g)for(var g=g.T,h=0;h<g.length;h++){var k=g[h];if("IMAGE"===k.source||"ENVIRONMENT_MAP"===k.source){var n=k.Qa;-1===a.indexOf(n)&&(a.push(n),k=k.width*k.height*4/1048576/k.ko,k*=1.3333,b+=k)}}}}return{number:a.length,memory:b}};a.num_render_targets=
function(){for(var a=[],b=0,c=x.get_active(),c=x.Wo(c),d=0;d<c.length;d++){var e=c[d];if("SINK"!=e.type){var f=e.k,g=[f.zb,f.pd];g.push.apply(g,e.le);for(e=0;e<g.length;e++){var h=g[e];y.ok(h)&&-1==a.indexOf(h)&&(a.push(h),b+=f.width*f.height*y.UB(h))}}}return{number:a.length,memory:b/1024/1024}};a.make_camera_frustum_shot=function(){var a=x.get_active();(a=x.ea(a,"MAIN_OPAQUE"))&&x.ku(a.k,a,[1,1,0])};a.make_light_frustum_shot=function(){var a=x.get_active(),b=x.ea(a,"MAIN_OPAQUE"),a=x.Pv(a,["SHADOW_CAST"]);
if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=[1,0,1]}x.ku(d.k,b,e)}};a.scenegraph_to_dot=function(){for(var a=x.ci(),b=0;b<a.length;b++)n.log("\n"+I.tA(x.wt(a[b])))};a.scenes_to_dot=function(){};a.loading_graph_to_dot=function(){n.log("\n"+t.$B())};a.controls_info=f.debug;a.object_distance=function(a,b){return F.dist(a.f.i,b.f.i)};a.msg=l.msg;a.fbmsg=l.fbmsg;a.print_telemetry=l.print_telemetry;a.plot_telemetry=
l.plot_telemetry;a.fbres=function(a,b){function c(){l.fbmsg("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.assert_constants=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),g=new Float32Array([0,-1,0]),h=new Float32Array([0,0,-1]);if(!v.of(a,v.Cr))throw"Wrong VEC3_IDENT";if(!v.of(b,v.Br))throw"Wrong QUAT4_IDENT";if(!v.of(c,v.AXIS_X))throw"Wrong AXIS_X";if(!v.of(d,v.AXIS_Y))throw"Wrong AXIS_Y";
if(!v.of(e,v.AXIS_Z))throw"Wrong AXIS_Z";if(!v.of(f,v.AXIS_MX))throw"Wrong AXIS_MX";if(!v.of(g,v.AXIS_MY))throw"Wrong AXIS_MY";if(!v.of(h,v.AXIS_MZ))throw"Wrong AXIS_MZ";};a.mute_music=function(){for(var a=A.get_speaker_objects(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==A.ap(c)&&A.mute(c,!0)}};a.check_finite=function(a){l.check_finite(a)};a.set_debug_params=function(a){var b=x.get_active();if(b=x.ea(b,"WIREFRAME")){if("number"==typeof a.wireframe_mode)switch(a.wireframe_mode){case l.WM_NONE:case l.WM_OPAQUE_WIREFRAME:case l.WM_TRANSPARENT_WIREFRAME:case l.WM_FRONT_BACK_VIEW:case l.WM_DEBUG_SPHERES:x.FE(b,
a.wireframe_mode);break;default:n.error("set_debug_params(): Wrong wireframe mode")}"object"==typeof a.wireframe_edge_color&&x.EE(b,a.wireframe_edge_color)}else throw"Wireframe subscene not found.";};a.get_error_quantity=function(){return n.HB()};a.get_warning_quantity=function(){return n.YB()};a.clear_errors_warnings=function(){return n.clear_errors_warnings()};a.analyze_shaders=function(a){var d=B.rt(),f=0,g;for(g in d)a&&-1===g.indexOf(a)||f++;var f="of "+f+" analyzing...",k={};for(g in d)if(!a||
-1!==g.indexOf(a)){var l=d[g],m;var p=l.kr;m=l.it;var t=h.st();if(t){p=t.getTranslatedShaderSource(p);m=t.getTranslatedShaderSource(m);p=p.replace("#version","#version 400 //");m=m.replace("#version","#version 400 //");var t=b("/nvidia_vert",p),r=e(t),v=b("/nvidia_frag",m),x=e(v);m={xG:p,rJ:t,yG:r,gB:m,YH:v,Ro:x}}else n.error("WEBGL_debug_shaders not found (run Chrome with --enable-privileged-webgl-extensions)"),m=void 0;t=l.ib;p=t.hj+" + "+t.$h;m.oA=l;m.ib=t;l=k[p]=k[p]||[];l.push(m);n.log(f)}for(p in k)n.group("%c"+
p,"color: #800"),l=k[p],c(l),n.groupEnd()};a.fake_load=l.fake_load};b4w.module.geometry=function(a,p){var e=p("__batch"),b=p("__geometry"),c=p("__print"),m=p("__renderer");a.extract_vertex_array=function(a,l,h){if(!b.gi(a))return c.error("Wrong object:",a.name),null;if(a=e.ya(a,l,"MAIN")){if((l=a.N)&&l.Tb&&l.Tb[h])return b.SA(l,h);c.error("Attribute not found:"+h);return null}c.error("Wrong material:",l);return null};a.extract_index_array=function(a,l){if(!b.gi(a))return c.error("Wrong object:",a.name),null;var h=e.ya(a,l,"MAIN");if(h){if((h=h.N)&&h.Tb)return h.zf;
c.error("Buffer data not found");return null}c.error("Wrong material:",l);return null};a.update_vertex_array=function(a,l,h,m){var d=["MAIN","DEPTH","COLOR_ID"];if(b.gi(a))for(var g=0;g<d.length;g++){var k=e.ya(a,l,d[g]);k&&(k=k.N)&&k.Tb&&k.Tb[h]&&b.gn(k,h,0,m)}else c.error("Wrong object:",a.name)};a.override_geometry=function(a,l,h,p,d){var g=["MAIN","DEPTH","COLOR_ID"];if(b.gi(a))if(h instanceof Uint16Array||h instanceof Uint32Array)if(p instanceof Float32Array)for(var k=0;k<g.length;k++){var n=
e.ya(a,l,g[k]);if(n){var x=n.N;if(x){b.HF(x,n.De,h);var I=0,A;for(A in x.Tb)var B=x.Tb[A],I=I+p.length/3*B.ee;x.gd=new Float32Array(I);var I=x.gd,y=0;for(A in x.Tb)switch(B=x.Tb[A],A){case "a_position":I.set(p,y);B.offset=y;B.length=p.length;y+=B.length;break;case "a_normal":var v;d&&(v=b.js(h,p,p));var F=b.hs(h,p,v);I.set(F,y);B.offset=y;B.length=p.length;y+=B.length;break;case "a_tangent":B.offset=y;B.length=p.length/3*B.ee;for(var F=new Float32Array(B.length),u=0;u<F.length;u+=4)F[u]=1,F[u+3]=
1;I.set(F,y);y+=B.length;break;default:B.offset=y,B.length=p.length/3*B.ee,F=new Float32Array(B.length),I.set(F,y),y+=B.length}b.dw(x);m.Tr(n);(n=e.Qc(a,n))&&n.N&&(n.N=x)}}}else c.error("Wrong positions_array type");else c.error("Wrong ibo_array type");else c.error("Wrong object:",a.name)};a.set_shape_key_value=function(a,e,h){b.check_shape_keys(a)?b.hp(a,e)?b.Sr(a,e,parseFloat(h)):c.error("Wrong key name:",e):c.error("Wrong object:",a.name)};a.check_shape_keys=function(a){return b.check_shape_keys(a)};
a.get_shape_keys_names=function(a){return b.check_shape_keys(a)?b.get_shape_keys_names(a):(c.error("Wrong object:",a.name),null)};a.get_shape_key_value=function(a,e){return b.check_shape_keys(a)?b.hp(a,e)?b.get_shape_key_value(a,e):(c.error("Wrong key name:",e),null):(c.error("Wrong object:",a.name),null)}};b4w.module.hud=function(a,p){var e=p("__hud");p("__print");a.draw_mixer_strip=e.draw_mixer_strip;a.plot_array=e.plot_array};b4w.module.lights=function(a,p){function e(a){for(var b=h.get_active(),e=m.Aa(b,"LAMP",m.DATA_ID_ALL),f=0;f<e.length;f++){var n=e[f];if("SUN"==n.Fa.type){var p=n;break}}p?"number"==typeof a.hor_position&&"number"==typeof a.vert_position&&(e=(90-a.vert_position)/180*Math.PI,f=p.f,t.set_rotation_euler(p,[e,(180-a.hor_position)/180*Math.PI,0]),a=new Float32Array(3),d.quat_to_dir(f.quat,d.AXIS_Y,a),f=g.length(f.i),g.copy(a,k),g.scale(k,f,k),t.set_translation(p,k),t.o(p),a=p.Fa,a.Vs&&(f=b.world.light_settings.environment_energy,
n=Math.cos(Math.abs(e)),e=Math.max(Math.min(3*n,1),0)*a.Qs,f*=Math.max(n,.1),c.uq(a,e),h.set_environment_colors(b,f,null,null)),h.hn(p,b)):l.error("There is no sun on the scene")}function b(a){if(f.is_lamp(a))return a.Fa.type;l.error("get_light_type(): Wrong object");return!1}var c=p("__lights"),m=p("__objects"),f=p("__obj_util"),l=p("__print"),h=p("__scenes"),t=p("__transform"),d=p("__util"),g=p("__vec3"),k=new Float32Array(3),n,x=60;a.get_lamps=function(a){var b=h.get_active(),b=m.Aa(b,"LAMP",m.DATA_ID_ALL);
if(!a)return b;for(var c=[],d=0;d<b.length;d++){var e=b[d];e.Fa.type===a&&c.push(e)}return c};a.get_sun_params=function(){for(var a=h.get_active(),a=m.Aa(a,"LAMP",m.DATA_ID_ALL),b=null,c=0;c<a.length;c++){var d=a[c];if("SUN"==d.Fa.type){b=d;break}}return b?(b=b.Fa.direction,a=180*Math.atan2(b[2],b[0])/Math.PI+90,180<a&&(a-=360),b=180*Math.atan2(b[1],Math.sqrt(b[0]*b[0]+b[2]*b[2]))/Math.PI,c={},c.hor_position=a,c.vert_position=b,c):null};a.set_sun_params=e;a.set_day_time=function(a){for(var b=h.get_active(),
b=m.Aa(b,"LAMP",m.DATA_ID_ALL),c=0;c<b.length;c++){var d=b[c];if("SUN"==d.Fa.type){var f=d;break}}f?(f=-Math.cos(a/12*Math.PI)*x,b={},b.hor_position=12>a?15*a:15*(a-24),b.vert_position=f,e(b)):l.error("There is no sun on the scene")};a.set_date=function(a){(n=a.getDate())?1582==n&&10==a.QI&&4<a.sA&&15>a.sA&&l.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):l.error("There is no year 0 in the Julian system!")};a.set_max_sun_angle=function(a){x=Math.min(Math.max(a,
0),90)};a.get_light_params=function(a){if(f.is_lamp(a))var c=a.Fa;else return l.error("get_light_params(): Wrong object"),!1;if(a=b(a))switch(a){case "SPOT":var d={light_type:a,light_color:c.color,light_energy:c.Fe,light_spot_blend:c.Mk,light_spot_size:c.Ye,light_distance:c.distance};break;case "POINT":d={light_type:a,light_color:c.color,light_energy:c.Fe,light_distance:c.distance};break;default:d={light_type:a,light_color:c.color,light_energy:c.Fe}}return d?d:!1};a.get_light_type=b;a.set_light_params=
function(a,b){if(f.is_lamp(a)){var d=a.Fa,e=h.get_active();"number"==typeof b.light_energy&&c.uq(d,b.light_energy);"object"==typeof b.light_color&&c.mv(d,b.light_color);"number"==typeof b.light_spot_blend&&c.vE(d,b.light_spot_blend);"number"==typeof b.light_spot_size&&c.wE(d,b.light_spot_size);"number"==typeof b.light_distance&&c.uE(d,b.light_distance);h.hn(a,e);m.xF(e)}else l.error("set_light_params(): Wrong object")}};b4w.module.material=function(a,p){function e(a,b){for(var c=a.V[0].S,d=0;d<c.length;d++){var e=c[d];if(-1<e.Sc.indexOf(b))return"MAIN"==e.type}return!1}function b(a,b){var c=m.ya(a,b,"MAIN");return Boolean(c&&c.Fc[0])}function c(a,b){var c=m.ya(a,b,"MAIN");return Boolean(c&&c.Fc[1])}var m=p("__batch"),f=p("__config"),l=p("__obj_util"),h=p("__print"),t=p("__shaders"),d=f.q;a.inherit_material=function(a,b,c,d){l.jk(c)&&l.jk(a)?m.inherit_material(a,b,c,d):h.error("Wrong or batched object(s)")};a.get_materials_names=
function(a){var b=[];a=a.V;for(var c=0;c<a.length;c++)for(var d=a[c].S,e=0;e<d.length;e++)for(var f=0;f<d[e].Sc.length;f++)-1==b.indexOf(d[e].Sc[f])&&b.push(d[e].Sc[f]);return b};a.set_diffuse_color=function(a,b,c){var d=m.ya(a,b,"MAIN");d?(d.vc.set(c),(a=m.Qc(a,b,"MAIN"))&&a.vc.set(c)):h.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_color=function(a,b){var c=m.ya(a,b,"MAIN");if(c){var d=new Float32Array(4);d.set(c.vc);return d}h.error('Couldn\'t get property "diffuse_color"!')};
a.set_diffuse_intensity=function(a,b,c){var d=m.ya(a,b,"MAIN");if(d){if(d.sf=c,a=m.Qc(a,b,"MAIN"))a.sf=c}else h.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_intensity=function(a,b){var c=m.ya(a,b,"MAIN");if(c)return c.sf;h.error('Couldn\'t get property "diffuse_intensity"!')};a.set_specular_color=function(a,b,c){var d=m.ya(a,b,"MAIN");d?(d.he.set(c),(a=m.Qc(a,b,"MAIN"))&&a.he.set(c)):h.error('Couldn\'t set property "specular_color"!')};a.get_specular_color=function(a,b){var c=m.ya(a,
b,"MAIN");if(c){var d=Array(3);d[0]=c.he[0];d[1]=c.he[1];d[2]=c.he[2];return d}h.error('Couldn\'t get property "specular_color"!')};a.set_specular_color_factor=function(a,b,c){var d=m.ya(a,b,"MAIN");if(d){if(d.th=c,a=m.Qc(a,b,"MAIN"))a.th=c}else h.error('Couldn\'t set property "specular_color_factor"!')};a.get_specular_color_factor=function(a,b){var c=m.ya(a,b,"MAIN");if(c)return c.th;h.error('Couldn\'t get property "specular_color_factor"!')};a.set_specular_intensity=function(a,c,d){b(a,c)||h.error('Property "specular_intensity" is missing!');
m.ya(a,c,"MAIN").Fc[0]=d;(a=m.Qc(a,c,"MAIN"))&&(a.Fc[0]=d)};a.get_specular_intensity=function(a,c){b(a,c)||h.error('Property "specular_intensity" is missing!');return m.ya(a,c,"MAIN").Fc[0]};a.check_specular_intensity=b;a.set_specular_hardness=function(a,b,d){c(a,b)||h.error('Property "specular_hardness" is missing!');m.ya(a,b,"MAIN").Fc[1]=d;(a=m.Qc(a,b,"MAIN"))&&(a.Fc[1]=d)};a.get_specular_hardness=function(a,b){c(a,b)||h.error('Property "specular_hardness" is missing!');return m.ya(a,b,"MAIN").Fc[1]};
a.check_specular_hardness=c;a.set_emit_factor=function(a,b,c){var d=m.ya(a,b,"MAIN");if(d){if(d.Ee=c,a=m.Qc(a,b,"MAIN"))a.Ee=c}else h.error('Couldn\'t set property "emit_factor"!')};a.get_emit_factor=function(a,b){var c=m.ya(a,b,"MAIN");if(c)return c.Ee;h.error('Couldn\'t get property "emit_factor"!')};a.set_ambient_factor=function(a,b,c){var d=m.ya(a,b,"MAIN");if(d){if(d.se=c,a=m.Qc(a,b,"MAIN"))a.se=c}else h.error('Couldn\'t set property "ambient_factor"!')};a.get_ambient_factor=function(a,b){var c=
m.ya(a,b,"MAIN");if(c)return c.se;h.error('Couldn\'t get property "ambient_factor"!')};a.set_diffuse_color_factor=function(a,b,c){var d=m.ya(a,b,"MAIN");if(d){if(d.rf=c,a=m.Qc(a,b,"MAIN"))a.rf=c}else h.error('Couldn\'t set property "diffuse_color_factor"!')};a.get_diffuse_color_factor=function(a,b){var c=m.ya(a,b,"MAIN");if(c)return c.rf;h.error('Couldn\'t get property "diffuse_color_factor"!')};a.set_alpha_factor=function(a,b,c){var d=m.ya(a,b,"MAIN");if(d){if(d.hf=c,a=m.Qc(a,b,"MAIN"))a.hf=c}else h.error('Couldn\'t set property "alpha_factor"!')};
a.get_alpha_factor=function(a,b){var c=m.ya(a,b,"MAIN");if(c)return c.hf;h.error('Couldn\'t get property "alpha_factor"!')};a.get_material_extended_params=function(a,b){if(!a||!b)return h.error("missing arguments in get_material_params"),null;if(!e(a,b))return null;var c=m.ya(a,b,"MAIN");if(!c)return null;var d={};"MAIN"==c.type&&(d.reflect_factor=c.reflect_factor,d.fresnel=c.Hd[2],d.fresnel_factor=5*(1-c.Hd[3]),d.parallax_scale=c.parallax_scale,d.parallax_steps=m.Mb(c,"PARALLAX_STEPS")[1]);return d};
a.get_water_material_params=function(a,b){if(!a||!b)return h.error("missing arguments in get_water_material_params"),null;if(!e(a,b))return null;var c=m.ya(a,b,"MAIN");if(!c||!c.gg)return null;if(!c)return h.error("material not found"),null;var f={};if("MAIN"==c.type){if(d.Mi){var l=f.shallow_water_col=Array(3);l[0]=c.shallow_water_col[0];l[1]=c.shallow_water_col[1];l[2]=c.shallow_water_col[2];l=f.shore_water_col=Array(3);l[0]=c.shore_water_col[0];l[1]=c.shore_water_col[1];l[2]=c.shore_water_col[2];
f.shallow_water_col_fac=c.shallow_water_col_fac;f.shore_water_col_fac=c.shore_water_col_fac}f.foam_factor=c.foam_factor;f.norm_uv_velocity=c.kj;f.absorb_factor=m.Mb(c,"ABSORB")[1];f.sss_strength=m.Mb(c,"SSS_STRENGTH")[1];f.sss_width=m.Mb(c,"SSS_WIDTH")[1];f.dst_noise_scale0=m.Mb(c,"DST_NOISE_SCALE_0")[1];f.dst_noise_scale1=m.Mb(c,"DST_NOISE_SCALE_1")[1];f.dst_noise_freq0=m.Mb(c,"DST_NOISE_FREQ_0")[1];f.dst_noise_freq1=m.Mb(c,"DST_NOISE_FREQ_1")[1];f.dir_min_shore_fac=m.Mb(c,"DIR_MIN_SHR_FAC")[1];
f.dir_freq=m.Mb(c,"DIR_FREQ")[1];f.dir_noise_scale=m.Mb(c,"DIR_NOISE_SCALE")[1];f.dir_noise_freq=m.Mb(c,"DIR_NOISE_FREQ")[1];f.dir_min_noise_fac=m.Mb(c,"DIR_MIN_NOISE_FAC")[1];f.dst_min_fac=m.Mb(c,"DST_MIN_FAC")[1];f.waves_hor_fac=m.Mb(c,"WAVES_HOR_FAC")[1]}return f};a.set_material_extended_params=function(a,b,c){if(a&&b&&c)if(e(a,b)){var d=m.ya(a,b,"MAIN");if(d){var f=[d];(d=m.Qc(a,b,"MAIN"))&&f.push(d);for(a=0;a<f.length;a++)d=f[a],"number"==typeof c.material_reflectivity&&(d.reflect_factor=c.material_reflectivity),
"number"==typeof c.material_fresnel&&(d.Hd[2]=c.material_fresnel),"number"==typeof c.material_fresnel_factor&&(d.Hd[3]=1-c.material_fresnel_factor/5),"number"==typeof c.material_parallax_scale&&(d.parallax_scale=c.material_parallax_scale),"number"==typeof c.material_parallax_steps&&(b=t.r(parseFloat(c.material_parallax_steps)),m.oa(d,"PARALLAX_STEPS",b),m.Bb(d,!0))}else h.error("material not found")}else h.error("setting material params is not possible");else h.error("missing arguments in set_material_params")};
a.set_water_material_params=function(a,b,c){if(a&&b&&c)if(e(a,b)){var f=m.ya(a,b,"MAIN");if(f){var l=[f];(f=m.Qc(a,b,"MAIN"))&&l.push(f);for(a=0;a<l.length;a++)f=l[a],d.Mi&&("object"==typeof c.shallow_water_col&&f.shallow_water_col.set(c.shallow_water_col),"number"==typeof c.shallow_water_col_fac&&(f.shallow_water_col_fac=c.shallow_water_col_fac),"object"==typeof c.shore_water_col&&f.shore_water_col.set(c.shore_water_col),"number"==typeof c.shore_water_col_fac&&(f.shore_water_col_fac=c.shore_water_col_fac)),
d.shore_smoothing&&f.qn&&("boolean"==typeof c.shore_smoothing&&(c.shore_smoothing?m.oa(f,"SHORE_SMOOTHING",1):m.oa(f,"SHORE_SMOOTHING",0)),"number"==typeof c.absorb_factor&&(b=t.r(parseFloat(c.absorb_factor)),m.oa(f,"ABSORB",b))),"number"==typeof c.foam_factor&&d.Zh&&(f.foam_factor=c.foam_factor),"number"==typeof c.norm_uv_velocity&&(f.kj=c.norm_uv_velocity),d.water_dynamic&&f.water_dynamic&&("boolean"==typeof c.water_dynamic&&(c.water_dynamic?m.oa(f,"DYNAMIC",1):m.oa(f,"DYNAMIC",0)),"number"==typeof c.waves_height&&
(b=t.r(parseFloat(c.waves_height)),m.oa(f,"WAVES_HEIGHT",b)),"number"==typeof c.waves_length&&(b=t.r(parseFloat(c.waves_length)),m.oa(f,"WAVES_LENGTH",b)),"number"==typeof c.sss_strength&&(b=t.r(parseFloat(c.sss_strength)),m.oa(f,"SSS_STRENGTH",b)),"number"==typeof c.sss_width&&(b=t.r(parseFloat(c.sss_width)),m.oa(f,"SSS_WIDTH",b)),"number"==typeof c.dst_noise_scale0&&(b=t.r(parseFloat(c.dst_noise_scale0)),m.oa(f,"DST_NOISE_SCALE_0",b)),"number"==typeof c.dst_noise_scale1&&(b=t.r(parseFloat(c.dst_noise_scale1)),
m.oa(f,"DST_NOISE_SCALE_1",b)),"number"==typeof c.dst_noise_freq0&&(b=t.r(parseFloat(c.dst_noise_freq0)),m.oa(f,"DST_NOISE_FREQ_0",b)),"number"==typeof c.dst_noise_freq1&&(b=t.r(parseFloat(c.dst_noise_freq1)),m.oa(f,"DST_NOISE_FREQ_1",b)),"number"==typeof c.dir_min_shore_fac&&(b=t.r(parseFloat(c.dir_min_shore_fac)),m.oa(f,"DIR_MIN_SHR_FAC",b)),"number"==typeof c.dir_freq&&(b=t.r(parseFloat(c.dir_freq)),m.oa(f,"DIR_FREQ",b)),"number"==typeof c.dir_noise_scale&&(b=t.r(parseFloat(c.dir_noise_scale)),
m.oa(f,"DIR_NOISE_SCALE",b)),"number"==typeof c.dir_noise_freq&&(b=t.r(parseFloat(c.dir_noise_freq)),m.oa(f,"DIR_NOISE_FREQ",b)),"number"==typeof c.dir_min_noise_fac&&(b=t.r(parseFloat(c.dir_min_noise_fac)),m.oa(f,"DIR_MIN_NOISE_FAC",b)),"number"==typeof c.dst_min_fac&&(b=t.r(parseFloat(c.dst_min_fac)),m.oa(f,"DST_MIN_FAC",b)),"number"==typeof c.waves_hor_fac&&(b=t.r(parseFloat(c.waves_hor_fac)),m.oa(f,"WAVES_HOR_FAC",b))),m.Bb(f,!0)}else h.error("material not found")}else h.error("setting water material params is not possible");
else h.error("missing arguments in set_water_material_params")}};b4w.module.particles=function(a,p){var e=p("__particles"),b=p("__print");a.set_size=function(a,m,f){e.Ai(a)?e.set_size(a,m,f):b.error('"',a.name,'" has no particle systems')};a.set_normal_factor=function(a,m,f){e.Ai(a)?e.set_normal_factor(a,m,f):b.error('"',a.name,'" has no particle systems')};a.set_factor=function(a,m,f){e.Ai(a)?(f=Math.min(f,1),f=Math.max(f,0),e.set_factor(a,m,f)):b.error('"',a.name,'" has no particle systems')}};b4w.module.physics=function(a,p){p("__config");var e=p("__ipc"),b=p("__physics"),c=p("__print"),m=p("__util");a.CM_WALK=0;a.CM_RUN=1;a.CM_CLIMB=2;a.CM_FLY=3;a.enable_simulation=function(a){b.H(a)?b.enable_simulation(a):c.error("No physics for object "+a.name)};a.disable_simulation=function(a){b.H(a)?b.disable_simulation(a):c.error("No physics for object "+a.name)};a.has_physics=function(a){return b.H(a)};a.has_simulated_physics=function(a){return b.has_simulated_physics(a)};a.has_dynamic_physics=
function(a){return b.has_dynamic_physics(a)};a.set_gravity=function(a,e){b.H(a)?b.set_gravity(a,e):c.error("No physics for object "+a.name)};a.set_damping=function(a,e,h){b.H(a)?b.v("set_damping",a.m.t,e,h):c.error("No physics for object "+a.name)};a.reset_damping=function(a){if(b.H(a)){var e=a.Kd;b.v("set_damping",a.m.t,e.wo,e.nq)}else c.error("No physics for object "+a.name)};a.set_transform=function(a,e,h){b.H(a)?b.set_transform.apply(this,arguments):c.error("No physics for object "+a.name)};a.sync_transform=
function(a){b.H(a)?b.sync_transform(a):c.error("No physics for object "+a.name)};a.apply_velocity=function(a){b.H(a)?b.apply_velocity.apply(this,arguments):c.error("No physics for object "+a.name)};a.apply_velocity_world=function(a){b.H(a)?b.apply_velocity_world.apply(this,arguments):c.error("No physics for object "+a.name)};a.apply_force=function(a,e,h,m){b.H(a)?b.apply_force.apply(this,arguments):c.error("No physics for object "+a.name)};a.apply_torque=function(a,e,h,m){b.H(a)?b.apply_torque.apply(this,
arguments):c.error("No physics for object "+a.name)};a.vehicle_throttle=function(a,e){b.H(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||c.error("Wrong object"),b.vehicle_throttle(a,m.clamp(e,-1,1))):c.error("No physics for object "+a.name)};a.vehicle_throttle_inc=function(a,e,h){if(b.H(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||c.error("Wrong object");e=m.clamp(e,0,1);var p=a.l.Wh;-1==h||1==h?p=Math.max(-1,Math.min(p+h*e,1)):0==h&&0<=p?(p-=e,p=Math.max(0,p)):0==h&&0>p?(p+=e,p=Math.min(0,
p)):c.error("Wrong steering direction");b.vehicle_throttle(a,m.clamp(p,-1,1))}else c.error("No physics for object "+a.name)};a.vehicle_steer=function(a,e){b.H(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||c.error("Wrong object"),b.vehicle_steer(a,m.clamp(e,-1,1))):c.error("No physics for object "+a.name)};a.vehicle_steer_inc=function(a,e,h){if(b.H(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||c.error("Wrong object");e=m.clamp(e,0,1);var p=a.l.Ui;-1==h||1==h?p=Math.max(-1,Math.min(p+h*e,
1)):0==h&&0<=p?(p-=e,p=Math.max(0,p)):0==h&&0>p?(p+=e,p=Math.min(0,p)):c.error("Wrong steering direction");b.vehicle_steer(a,m.clamp(p,-1,1))}else c.error("No physics for object "+a.name)};a.vehicle_brake=function(a,e){b.H(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||c.error("Wrong object"),b.vehicle_brake(a,m.clamp(e,0,1))):c.error("No physics for object "+a.name)};a.vehicle_brake_inc=function(a,e){if(b.H(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||c.error("Wrong object");e=m.clamp(e,
-1,1);var h=a.l.uj;b.vehicle_brake(a,m.clamp(h+h*e,0,1))}else c.error("No physics for object "+a.name)};a.is_vehicle_chassis=function(a){return b.is_vehicle_chassis(a)};a.is_vehicle_hull=function(a){return b.is_vehicle_hull(a)};a.get_vehicle_name=function(a){if(!b.H(a))return c.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.Hc.name;c.error("Wrong object");return null};a.get_vehicle_throttle=function(a){if(!b.H(a))return c.error("No physics for object "+
a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.l.Wh;c.error("Wrong object");return null};a.get_vehicle_steering=function(a){if(!b.H(a))return c.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.l.Ui;c.error("Wrong object")};a.get_vehicle_brake=function(a){if(!b.H(a))return c.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.l.uj;c.error("Wrong object")};a.get_vehicle_speed=
function(a){if(!b.H(a))return c.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return b.get_vehicle_speed(a);c.error("Wrong object")};a.is_character=function(a){return b.is_character(a)};a.set_character_move_dir=function(a,e,h){b.H(a)?b.set_character_move_dir(a,e,h):c.error("No physics for object "+a.name)};a.set_character_move_type=function(a,e){b.H(a)?b.set_character_move_type(a,e):c.error("No physics for object "+a.name)};a.set_character_walk_velocity=
function(a,e){b.H(a)?b.set_character_walk_velocity(a,e):c.error("No physics for object "+a.name)};a.set_character_run_velocity=function(a,e){b.H(a)?b.set_character_run_velocity(a,e):c.error("No physics for object "+a.name)};a.set_character_fly_velocity=function(a,e){b.H(a)?b.set_character_fly_velocity(a,e):c.error("No physics for object "+a.name)};a.character_jump=function(a){b.H(a)?b.character_jump(a):c.error("No physics for object "+a.name)};a.character_rotation_inc=function(a,e,h){b.H(a)?b.character_rotation_inc(a,
e,h):c.error("No physics for object "+a.name)};a.set_character_rotation_quat=function(a,e){b.H(a)?b.set_character_rotation_quat(a,e):c.error("No physics for object "+a.name)};a.set_character_rotation=function(a,e,h){b.H(a)?b.set_character_rotation(a,e,h):c.error("No physics for object "+a.name)};a.set_character_rotation_v=function(a,e){b.H(a)?b.set_character_rotation_v(a,e):c.error("No physics for object "+a.name)};a.set_character_rotation_h=function(a,e){b.H(a)?b.set_character_rotation_h(a,e):c.error("No physics for object "+
a.name)};a.append_collision_test=function(a,e,h,m){b.H(a)?b.append_collision_test(a,e,h,m||!1):c.error("No physics for object "+a.name)};a.remove_collision_test=function(a,e,h){b.H(a)?b.remove_collision_test(a,e||"ANY",h):c.error("No physics for object "+a.name)};a.apply_collision_impulse_test=function(a,e){b.H(a)?b.apply_collision_impulse_test(a,e):c.error("No physics for object "+a.name)};a.clear_collision_impulse_test=function(a){b.H(a)?b.clear_collision_impulse_test(a):c.error("No physics for object "+
a.name)};a.append_ray_test=function(a,e,h,m,d,g){if(b.H(a))return b.append_ray_test(a,e,h,m,d,g||!1,!1,!1,!1);c.error("No physics for object "+a.name)};a.append_ray_test_ext=function(a,e,h,m,d,g,k,n,p){if(b.H(a))return b.append_ray_test(a,e,h,m,d,g||!1,k||!1,n||!1,p||!1);c.error("No physics for object "+a.name)};a.remove_ray_test=function(a){b.Vt(a)?b.remove_ray_test(a):c.error("Wrong ray test ID")};a.change_ray_test_from_to=function(a,e,h){b.Vt(a)?b.change_ray_test_from_to(a,e,h):c.error("Wrong ray test ID")};
a.apply_constraint=function(a,e,h,m,d,g,k,n,p,I){b.H(e)&&b.H(d)?b.apply_constraint(a,e,h,m,d,g,k,n,p,I):c.error("Wrong objects")};a.clear_constraint=function(a){b.H(a)&&b.cC(a)?b.clear_constraint(a):c.error("Wrong object")};a.pull_to_constraint_pivot=function(a,e,h,m,d,g){b.H(a)&&b.H(m)?b.pull_to_constraint_pivot(a,e,h,m,d,g):c.error("Wrong objects")};a.get_worker_listeners=e.get_worker_listeners};b4w.module.rgb=function(a,p){p("__print");var e=p("__util"),b=new Float32Array(3);a.create=function(){return new Float32Array(3)};a.from_values=function(a,b,e){var l=new Float32Array(3);l[0]=a;l[1]=b;l[2]=e;return l};a.set=function(a,b,e,l){l[0]=a;l[1]=b;l[2]=e;return l};a.css_to_rgb=function(a,b,f,l){l=l||new Float32Array(3);l[0]=a/255;l[1]=b/255;l[2]=f/255;e.Hv(l,l);return l};a.rgb_to_css=function(a){a=e.Ap(a,b);return[Math.round(255*a[0]),Math.round(255*a[1]),Math.round(255*a[2])]};a.rgb_to_css_hex=
function(a){function m(a){a=Math.round(255*a).toString(16);return 1==a.length?"0"+a:a}a=e.Ap(a,b);return"#"+m(a[0])+m(a[1])+m(a[2])}};
b4w.module.rgba=function(a,p){p("__print");var e=p("__util"),b=new Float32Array(3);a.create=function(){var a=new Float32Array(4);a[3]=1;return a};a.from_values=function(a,b,e,l){var h=new Float32Array(4);h[0]=a;h[1]=b;h[2]=e;h[3]=l;return h};a.set=function(a,b,e,l,h){h[0]=a;h[1]=b;h[2]=e;h[3]=l;return h};a.css_to_rgba=function(a,b,f,l,h){h=h||new Float32Array(4);h[0]=a/255;h[1]=b/255;h[2]=f/255;h[3]=l;e.Hv(h,h);return h};a.rgba_to_css=function(a){var m=e.Ap(a,b);return[Math.round(255*m[0]),Math.round(255*
m[1]),Math.round(255*m[2]),a[3]]}};b4w.module.scenes=function(a,p){var e=p("__batch"),b=p("__camera"),c=p("__data"),m=p("__graph"),f=p("__objects"),l=p("__obj_util"),h=p("__physics"),t=p("__print"),d=p("__scenes"),g=p("__util");a.DATA_ID_ALL=f.DATA_ID_ALL;a.set_active=function(a){var b=d.ci();d.set_active(g.keysearch("name",a,b))};a.get_active=function(){return d.ka()?d.get_active().name:""};a.get_scenes=function(){for(var a=d.ci(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.get_active_camera=function(){if(d.ka())return d.di(d.get_active());
t.error("No active scene");return!1};a.get_object_by_name=function(a,b){var c=f.ic(f.xn,a,b|0);if(c)return c;t.error("get object "+a+": not found")};a.get_object_by_dupli_name=function(a,b,c){if(a=f.ic(f.wn,a,b,c|0))return a;t.error("get object "+b+": not found")};a.get_object_by_dupli_name_list=function(a,b){var c=f.ic(f.jd,a,b|0);if(c)return c;t.error("get object "+a+": not found")};a.get_object_data_id=function(a){return d.get_object_data_id(a)};a.pick_object=f.pick_object;a.outlining_is_enabled=
function(a){return a&&a.f&&a.f.Ab};a.set_outline_intensity=function(a,b){a&&a.f&&a.f.Ab?a.f.If=b:t.error("set_outline_intensity(): wrong object")};a.get_outline_intensity=function(a){if(a&&a.f&&a.f.Ab)return a.f.If;t.error("get_outline_intensity(): wrong object")};a.apply_outline_anim=function(a,b,c,d){a&&a.f&&a.f.Ab?f.apply_outline_anim(a,b,c,d):t.error("apply_outline_anim(): wrong object")};a.apply_outline_anim_def=function(a){if(a&&a.f&&a.f.Ab){var b=a.f.Ci;f.apply_outline_anim(a,b.Di,b.Ei,b.Fi)}else t.error("apply_outline_anim_def(): wrong object")};
a.clear_outline_anim=function(a){a&&a.f&&a.f.Ab?f.clear_outline_anim(a):t.error("clear_outline_anim(): wrong object")};a.set_outline_color=d.set_outline_color;a.get_outline_color=function(a){var b=d.get_active();if(b=d.ea(b,"OUTLINE"))return a=a||new Float32Array(3),a.set(b.Se),a};a.set_glow_intensity=function(b,c){t.error("set_glow_intensity() deprecated, use set_outline_intensity() instead");a.set_outline_intensity(b,c)};a.get_glow_intensity=function(b){t.error("get_glow_intensity() deprecated, use get_outline_intensity() instead");
a.get_outline_intensity(b)};a.apply_glow_anim=function(b,c,d,e){t.error("apply_glow_anim() deprecated, use apply_outline_anim() instead");a.apply_outline_anim(b,c,d,e)};a.apply_glow_anim_def=function(b){t.error("apply_glow_anim_def() deprecated, use apply_outline_anim_def() instead");a.apply_outline_anim_def(b)};a.clear_glow_anim=function(b){t.error("clear_glow_anim() deprecated, use clear_outline_anim() instead");a.clear_outline_anim(b)};a.set_glow_color=function(b){t.error("set_glow_color() deprecated, use set_outline_color() instead");
a.set_outline_color(b)};a.get_glow_color=function(b){t.error("get_glow_color() deprecated, use get_outline_color() instead");a.get_outline_color(b)};a.get_shadow_params=function(){if(!d.ka())return t.error("No active scene"),!1;var a=d.get_active(),b=d.ea(a,"SHADOW_CAST");if(!b)return null;var c=a.j.ec,e=d.ea(a,"MAIN_OPAQUE"),f=d.ea(a,"DEPTH"),g={};g.csm_resolution=c.csm_resolution;g.self_shadow_polygon_offset=b.self_shadow_polygon_offset;f&&(g.self_shadow_normal_offset=f.self_shadow_normal_offset);
g.enable_csm=c.enable_csm;g.csm_num=c.csm_num;g.csm_first_cascade_border=c.csm_first_cascade_border;g.first_cascade_blur_radius=c.first_cascade_blur_radius;g.csm_last_cascade_border=c.csm_last_cascade_border;g.last_cascade_blur_radius=c.last_cascade_blur_radius;g.fade_last_cascade=c.fade_last_cascade;g.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(g.csm_borders=d.EB(a,e.k),g.blur_radii=new Float32Array(c.csm_num),g.blur_radii.set(e.k.Gm.subarray(0,c.csm_num))):(g.csm_borders=null,
g.blur_radii=null);return g};a.set_shadow_params=function(a){if(d.ka()){var c=d.get_active();"number"==typeof a.self_shadow_polygon_offset&&m.W(c.j.nb,function(b,c){"SHADOW_CAST"===c.type&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var f=d.ea(c,"DEPTH");f&&("number"==typeof a.self_shadow_normal_offset&&(f.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(f.pcf_blur_radius=a.pcf_blur_radius));var g=d.ea(c,"MAIN_BLEND");g&&("number"==typeof a.self_shadow_normal_offset&&
(g.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(g.pcf_blur_radius=a.pcf_blur_radius),g.ua=!0);g=c.j.ec;"number"==typeof a.csm_first_cascade_border&&(g.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(g.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(g.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(g.last_cascade_blur_radius=
a.last_cascade_blur_radius);if(f){for(var h=f.p,l=0;l<h.length;l++){var p=h[l];p.Jd.Ec&&(p=p.B,e.Ur(p,g),e.Bb(p))}f.ua=!0}f=c.ng.f.R;for(l=0;l<f.length;l++)b.Yq(f[l],g);d.qq(c)}else t.error("No active scene")};a.get_environment_colors=function(){if(!d.ka())return t.error("No active scene"),!1;var a=d.get_active();return d.get_environment_colors(a)};a.set_environment_colors=function(a,b,c){if(d.ka()){var e=d.get_active();d.set_environment_colors(e,parseFloat(a),b,c)}else t.error("No active scene")};
a.get_fog_color_density=function(a){if(!d.ka())return t.error("No active scene"),!1;var b=d.get_active();return d.get_fog_color_density(b,a)};a.set_fog_color_density=function(a){if(d.ka()){var b=d.get_active();d.set_fog_color_density(b,a)}else t.error("No active scene")};a.get_ssao_params=function(){if(!d.ka())return t.error("No active scene"),!1;var a=d.get_active();return d.get_ssao_params(a)};a.set_ssao_params=function(a){if(d.ka()){var b=d.get_active();d.set_ssao_params(b,a)}else t.error("No active scene")};
a.get_color_correction_params=function(){if(!d.ka())return t.error("No active scene"),null;var a=d.get_active(),a=d.ea(a,"COMPOSITING");if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.set_color_correction_params=function(a){if(d.ka()){var b=d.get_active();if(b=d.ea(b,"COMPOSITING"))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&
(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.ua=!0}else t.error("No active scene")};a.get_sky_params=function(){if(!d.ka())return t.error("No active scene"),!1;var a=d.get_active();return d.get_sky_params(a)};a.set_sky_params=function(a){if(d.ka()){var b=d.get_active();d.set_sky_params(b,a)}else t.error("No active scene")};a.get_dof_params=function(){if(!d.ka())return t.error("No active scene"),!1;var a=d.get_active();return d.ea(a,"DOF")?d.get_dof_params(a):
null};a.set_dof_params=function(a){if(d.ka()){var b=d.get_active();d.set_dof_params(b,a)}else t.error("No active scene")};a.get_god_rays_params=function(){if(!d.ka())return t.error("No active scene"),!1;var a=d.get_active();return d.ea(a,"GOD_RAYS")?d.get_god_rays_params(a):null};a.set_god_rays_params=function(a){if(d.ka()){var b=d.get_active();d.set_god_rays_params(b,a)}else t.error("No active scene")};a.get_bloom_params=function(){if(!d.ka())return t.error("No active scene"),!1;var a=d.get_active();
return d.ea(a,"BLOOM")?d.get_bloom_params(a):null};a.set_bloom_params=function(a){if(d.ka()){var b=d.get_active();d.set_bloom_params(b,a)}else t.error("No active scene")};a.get_glow_material_params=function(){if(!d.ka())return t.error("No active scene"),!1;var a=d.get_active();return d.ea(a,"GLOW_COMBINE")?d.get_glow_material_params(a):null};a.set_glow_material_params=function(a){if(d.ka()){var b=d.get_active();d.set_glow_material_params(b,a)}else t.error("No active scene")};a.get_wind_params=function(){if(!d.ka())return t.error("No active scene"),
!1;var a=d.get_active();return d.get_wind_params(a)};a.set_wind_params=function(a){if(d.ka()){var b=d.get_active();f.set_wind_params(b,a)}else t.error("No active scene")};a.get_water_surface_level=d.get_water_surface_level;a.set_water_params=function(a){if(d.ka()){var b=d.get_active();d.set_water_params(b,a)}else t.error("No active scene")};a.get_water_mat_params=function(a){if(d.ka()){var b=d.get_active();d.get_water_mat_params(b,a)}else t.error("No active scene")};a.update_scene_materials_params=
function(){if(d.ka()){var a=d.get_active();d.$q(a)}else t.error("No active scene")};a.hide_object=function(a){l.jk(a)||l.is_empty(a)?d.hide_object(a):t.error("show/hide is only supported for dynamic meshes/empties")};a.show_object=function(a){l.jk(a)||l.is_empty(a)?d.show_object(a):t.error("show/hide is only supported for dynamic meshes/empties")};a.is_hidden=function(a){if(l.jk(a)||l.is_empty(a))return d.is_hidden(a);t.error("show/hide is only supported for dynamic meshes/empties");return!1};a.is_visible=
function(a){return a.f.is_visible};a.check_object=function(a){return d.ka()?f.sD(a,d.get_active()):(t.error("No active scene"),!1)};a.check_object_by_name=function(a,b){return f.ic(f.xn,a,b|0)?!0:!1};a.check_object_by_dupli_name=function(a,b,c){return f.ic(f.wn,a,b,c|0)?!0:!1};a.check_object_by_dupli_name_list=function(a,b){return f.ic(f.jd,a,b|0)?!0:!1};a.get_all_objects=function(a,b){var c=d.get_active();a||(a="ALL");b||0===b||(b=f.DATA_ID_ALL);return f.Aa(c,a,b)};a.get_object_name=function(a){return a?
a.gh:(t.error("Wrong object name"),"")};a.get_object_name_hierarchy=function(a){if(!a)return t.error("Wrong object name"),null;for(var b=[];a;)b.push(a.gh),a=l.get_dg_parent(a);return b.reverse()};a.get_object_type=function(a){return a&&a.type?a.type:(t.error("Wrong object"),"UNDEFINED")};a.get_object_dg_parent=function(a){t.error("scenes.get_object_dg_parent() deprecated, use objects.get_dg_parent() instead");return l.get_dg_parent(a)};a.get_object_children=function(a){return a.Dd.slice(0)};a.get_first_character=
function(){for(var a=f.Aa(d.get_active(),"MESH",f.DATA_ID_ALL),b=0;b<a.length;b++){var c=a[b];if(h.is_character(c))return c}return null};a.get_shore_dist=function(a,b){b||0===b||(b=1);return d.get_shore_dist(a,b)};a.get_cam_water_depth=function(){return d.get_cam_water_depth()};a.get_type_mesh_object=function(a){return l.is_mesh(a)?a.f.type:null};a.get_meta_tags=function(){if(!d.ka())return t.error("No active scene"),!1;var a=d.get_active();return d.get_meta_tags(a)};a.append_object=function(a,b){if(a.f.pp){if(b)var c=
d.ci(),c=g.keysearch("name",b,c);else c=d.get_active();d.append_object(c,a,!0)}else t.error('object "'+a.name+'" has been created not by coping.')};a.remove_object=function(a){if(a.f.pp){var b=d.get_active();c.KD(b,a,!1);f.remove_object(a)}else t.error("Can't remove object \""+a.name+'". It was not copied.')};a.marker_frame=function(a){var b=d.get_active();if(b.timeline_markers&&a in b.timeline_markers)return d.marker_frame(b,a);t.error('"'+a+'" marker not found.');return 0};a.get_mb_params=function(){var a=
d.get_active();return(a=d.ea(a,"MOTION_BLUR"))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.set_mb_params=function(a){var b=d.get_active();(b=d.ea(b,"MOTION_BLUR"))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):t.error("The motion blur subscene doesn't exist.")};a.can_select_objects=function(){var a=d.get_active();return Boolean(d.ea(a,"COLOR_PICKING"))}};b4w.module.sfx=function(a,p){var e=p("__obj_util"),b=p("__scenes"),c=p("__sfx"),m=p("__print");a.play=function(a,b,e){c.play(a,b||0,e||0)};a.play_def=function(a){c.play_def(a)};a.is_play=function(a){return c.is_playing(a)};a.is_playing=function(a){return c.is_playing(a)};a.speaker_play=function(a,b,e,p){m.error("speaker_play() deprecated, use play() or play_def() instead");c.cyclic(a,b);p&&c.playrate(a,p);c.play(a,0,e)};a.speaker_stop=function(a){m.error("speaker_stop() deprecated, use stop() instead");
c.stop(a)};a.stop=function(a){c.stop(a)};a.pause=function(a){c.RE(a)};a.resume=function(a){c.TE(a)};a.speaker_playback_rate=function(a,b){m.error("speaker_playback_rate() deprecated, use playrate() instead");c.playrate(a,b)};a.playrate=function(a,b){c.playrate(a,b)};a.get_playrate=function(a){return c.get_playrate(a)};a.cyclic=function(a,b){c.cyclic(a,b)};a.is_cyclic=function(a){return c.is_cyclic(a)};a.listener_reset_speed=function(a,b){c.listener_reset_speed(a,b)};a.speaker_reset_speed=function(a,
b,e){c.speaker_reset_speed(a,b,e)};a.get_volume=function(a){return a&&"object"===typeof a?c.get_volume(a):c.NB()};a.set_volume=function(a,b){a&&"object"===typeof a?c.set_volume(a,b):c.yE(b)};a.mute=function(a,b){a&&"object"===typeof a?c.mute(a,b):c.lD(b)};a.is_muted=function(a){return a&&"object"===typeof a?c.is_muted(a):c.sC()};a.get_speaker_objects=function(){return c.get_speaker_objects().slice(0)};a.get_speakers=function(){m.error("get_speakers() deprecated, use get_speaker_objects() instead");
return a.get_speaker_objects()};a.check_active_speakers=c.check_active_speakers;a.set_compressor_params=function(a){c.set_compressor_params(b.get_active(),a)};a.get_compressor_params=function(){return c.get_compressor_params(b.get_active())};a.duck=function(a,b,e){a&&"object"===typeof a?c.duck(a,b,e):c.IA(b,e)};a.unduck=function(a){a&&"object"===typeof a?c.unduck(a):c.wF()};a.apply_playlist=c.apply_playlist;a.clear_playlist=c.clear_playlist;a.detect_audio_container=c.detect_audio_container;a.detect_video_container=
c.detect_video_container;a.set_positional_params=c.set_positional_params;a.get_positional_params=c.get_positional_params;a.set_filter_params=c.set_filter_params;a.get_filter_params=c.get_filter_params;a.get_filter_freq_response=c.get_filter_freq_response;a.get_duration=function(a){if(a&&e.is_speaker(a))return c.get_duration(a);m.error('Object "'+(a?a.name:void 0)+'" is not a valid speaker')}};b4w.module.textures=function(a,p){var e=p("__print"),b=p("__scenes"),c=p("__textures");a.get_canvas_texture_context=function(a,b){b||(b=0);var l=c.BB(a,b);if(l)return l;e.error('Canvas texture with ID "'+a+'" not found!')};a.update_canvas_texture_context=function(a,b){b||(b=0);c.KF(a,b)||e.error('Canvas texture with ID "'+a+'" not found!')};a.play_video=function(a,f){f||(f=0);b.get_active().b4w_use_nla&&c.jr(a,f)?e.error("NLA texture can't be controlled directly through API."):c.play_video(a,f)||
e.error('Texture with name "'+a+'" not found!')};a.pause_video=function(a,f){f||(f=0);b.get_active().b4w_use_nla&&c.jr(a,f)?e.error("NLA texture can't be controlled directly through API."):c.pause_video(a,f)||e.error('Texture with name "'+a+'" not found!')};a.reset_video=function(a,f){f||(f=0);b.get_active().b4w_use_nla&&c.jr(a,f)?e.error("NLA texture can't be controlled directly through API."):c.reset_video(a,f)||e.error('Texture with name "'+a+'" not found!')}};b4w.module.time=function(a,p){var e=p("__time");a.set_timeout=e.set_timeout;a.clear_timeout=e.clear_timeout;a.get_timeline=e.get_timeline;a.animate=e.animate;a.clear_animation=e.clear_animation};b4w.module.transform=function(a,p){var e=p("__obj_util"),b=p("__physics"),c=p("__print"),m=p("__quat"),f=p("__transform"),l=p("__util"),h=new Float32Array(3),t=new Float32Array(4);a.SPACE_LOCAL=f.SPACE_LOCAL;a.SPACE_WORLD=f.SPACE_WORLD;a.set_translation=function(a,g,k,l){e.sa(a)?(h[0]=g,h[1]=k,h[2]=l,f.set_translation(a,h),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel=function(a,g,k,l){e.sa(a)?(h[0]=g,h[1]=k,h[2]=l,f.set_translation_rel(a,
h),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_v=function(a,g){e.sa(a)?(f.set_translation(a,g),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel_v=function(a,g){e.sa(a)?(f.set_translation_rel(a,g),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_obj_rel=function(a,g,k,n,m){e.sa(a)?(h[0]=g,h[1]=k,h[2]=n,l.transform_vec3(h,1,m.f.quat,m.f.i,
h),f.set_translation(a,h),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_translation=function(a,b){b||(b=new Float32Array(3));f.get_translation(a,b);return b};a.get_translation_rel=function(a,b){b||(b=new Float32Array(3));f.get_translation_rel(a,b);return b};a.set_rotation=function(a,g,h,l,m){e.sa(a)?(t[0]=g,t[1]=h,t[2]=l,t[3]=m,f.set_rotation(a,t),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_rel=function(a,
g,h,l,m){e.sa(a)?(t[0]=g,t[1]=h,t[2]=l,t[3]=m,f.set_rotation_rel(a,t),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_quat=function(){c.error("set_rotation_quat() deprecated, use set_rotation() instead");return a.set_rotation};a.set_rotation_v=function(a,g){e.sa(a)?(f.set_rotation(a,g),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_rel_v=function(a,g){e.sa(a)?(f.set_rotation_rel(a,g),f.o(a),b.sync_transform(a)):
c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_quat_v=function(){c.error("set_rotation_quat_v() deprecated, use set_rotation_v() instead");return a.set_rotation_v};a.get_rotation=function(a,b){b||(b=new Float32Array(4));f.get_rotation(a,b);return b};a.get_rotation_rel=function(a,b){b||(b=new Float32Array(4));f.get_rotation_rel(a,b);return b};a.get_rotation_quat=function(){c.error("get_rotation_quat() deprecated, use get_rotation() instead");return a.get_rotation};a.set_rotation_euler=
function(a,g,k,l){e.sa(a)?(h[0]=g,h[1]=k,h[2]=l,f.set_rotation_euler(a,h),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_rel=function(a,g,k,l){e.sa(a)?(h[0]=g,h[1]=k,h[2]=l,f.set_rotation_euler_rel(a,h),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_v=function(a,g){e.sa(a)?(f.set_rotation_euler(a,g),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_rel_v=
function(a,g){e.sa(a)?(f.set_rotation_euler_rel(a,g),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale=function(a,b){e.sa(a)?(f.set_scale(a,b),f.o(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale_rel=function(a,b){e.sa(a)?(f.set_scale_rel(a,b),f.o(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_scale=function(a){return f.get_scale(a)};a.get_scale_rel=function(a){return f.get_scale_rel(a)};a.empty_reset_transform=function(a){if("EMPTY"!=
a.type)c.error("Wrong object: "+a.name);else{for(var g=0;g<a.Dd.length;g++)if(!e.sa(a.Dd[g])){c.error('Wrong object: "'+a.Dd[g].name+'" is not dynamic.');return}f.set_translation(a,[0,0,0]);f.set_rotation(a,[0,0,0,1]);f.set_scale(a,1);f.o(a);b.sync_transform(a)}};a.get_object_size=function(a){return e.is_mesh(a)?f.get_object_size(a):(c.error("Wrong object: "+a.name),0)};a.get_object_center=function(a,b,h){return e.is_mesh(a)?f.get_object_center(a,b,h):(c.error("Wrong object: "+a.name),null)};a.move_local=
function(a,g,h,l){e.sa(a)?(f.move_local(a,g,h,l),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_x_local=function(a,g){if(e.sa(a)){var h=m.setAxisAngle(l.AXIS_X,g,t);f.mq(a,h);f.o(a);b.sync_transform(a)}else c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_y_local=function(a,g){if(e.sa(a)){var h=m.setAxisAngle(l.AXIS_Y,g,t);f.mq(a,h);f.o(a);b.sync_transform(a)}else c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_z_local=function(a,
g){if(e.sa(a)){var h=m.setAxisAngle(l.AXIS_Z,g,t);f.mq(a,h);f.o(a);b.sync_transform(a)}else c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_object_bounding_box=function(a){return f.get_object_bounding_box(a)};a.set_tsr=function(a,g){e.sa(a)?(f.set_tsr(a,g),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_tsr_rel=function(a,g){e.sa(a)?(f.set_tsr_rel(a,g),f.o(a),b.sync_transform(a)):c.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_tsr=
function(a,b){b||(b=new Float32Array(8));f.get_tsr(a,b);return b};a.get_tsr_rel=function(a,b){b||(b=new Float32Array(8));f.get_tsr_rel(a,b);return b};a.distance=function(a,b){return f.distance(a,b)}};b4w.module.tsr=function(a,p){p("__print");var e=p("__tsr");a.create=e.create;a.from_values=e.from_values;a.copy=e.copy;a.identity=e.identity;a.create_sep=e.create_sep;a.set_sep=e.set_sep;a.set_trans=e.set_trans;a.set_scale=e.set_scale;a.set_transcale=e.set_transcale;a.set_quat=e.set_quat;a.get_trans_view=e.get_trans_view;a.get_scale=e.get_scale;a.get_quat_view=e.get_quat_view;a.invert=e.invert;a.to_mat4=function(a,c){c||(c=new Float32Array(16));e.to_mat4(a,c);return c};a.from_mat4=e.from_mat4;a.multiply=
e.multiply;a.transform_vec3=e.transform_vec3;a.transform_vec3_inv=e.transform_vec3_inv;a.transform_vectors=e.transform_vectors;a.transform_dir_vectors=e.transform_dir_vectors;a.transform_dir_vec3=e.transform_dir_vec3;a.transform_tangents=e.transform_tangents;a.translate=e.translate;a.interpolate=e.interpolate};b4w.module.util=function(a,p){var e=p("__obj_util"),b=p("__print"),c=p("__util"),m=p("__vec3");a.AXIS_X=new Float32Array([1,0,0]);a.AXIS_Y=new Float32Array([0,1,0]);a.AXIS_Z=new Float32Array([0,0,1]);a.AXIS_MX=new Float32Array([-1,0,0]);a.AXIS_MY=new Float32Array([0,-1,0]);a.AXIS_MZ=new Float32Array([0,0,-1]);a.f32=function(a){return new Float32Array(a||0)};a.assert=c.assert;a.keyfind=c.keyfind;a.keysearch=c.keysearch;a.matrix_to_quat=function(a){return c.matrix_to_quat(a)};a.euler_to_quat=function(a,
b){b||(b=new Float32Array(4));return c.euler_to_quat(a,b)};a.quat_to_euler=function(a,b){b||(b=new Float32Array(3));return c.quat_to_euler(a,b)};a.sign=c.sign;a.clamp=c.clamp;a.quat_to_dir=c.quat_to_dir;a.ground_project_quat=function(a,b){return c.quat_project(a,c.AXIS_MY,c.AXIS_Y,c.AXIS_MZ,b)};a.cam_quat_to_mesh_quat=function(a,b){return c.cam_quat_to_mesh_quat(a,b)};a.quat_project=function(a,e,h,p,d){return 0!=m.dot(h,p)?(b.error("Wrong in-plane direction"),null):c.quat_project(a,e,h,p,d)};a.hash_code=
c.hash_code;a.smooth=c.smooth;a.smooth_v=c.smooth_v;a.is_vector=c.is_vector;a.correct_cam_quat_up=c.correct_cam_quat_up;a.quat_to_angle_axis=c.quat_to_angle_axis;a.random_from_array=c.random_from_array;a.xz_direction=c.xz_direction;a.line_plane_intersect=c.line_plane_intersect;a.is_mesh=function(a){b.error("util.is_mesh() deprecated, use objects.is_mesh() instead");return e.is_mesh(a)};a.is_armature=function(a){b.error("util.is_armature() deprecated, use objects.is_armature() instead");return e.is_armature(a)};
a.angle_wrap_0_2pi=c.angle_wrap_0_2pi;a.angle_wrap_periodic=c.angle_wrap_periodic;a.smooth_step=c.smooth_step;a.lerp=c.lerp};"object"==typeof module&&module.Ko&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,p){p("__print");var e=p("__version");a.version=e.version;a.version_str=e.version_str;a.type=e.type;a.date=e.date;a.date_str=e.date_str};"object"==typeof module&&module.Ko&&b4w.module.version(exports);b4w.module.objects=function(a,p){var e=p("__geometry"),b=p("__objects"),c=p("__obj_util"),m=p("__print"),f=p("__scenes");p("__util");a.get_meta_tags=function(a){if(a)return b.get_meta_tags(a)};a.copy=function(a,h,p){return c.is_mesh(a)?c.sa(a)?e.gi(a)||e.check_shape_keys(a)||!p?-1==b.Aa(f.get_active(),"MESH",b.DATA_ID_ALL).indexOf(a)?(m.error('object "'+a.name+'" does not belong to the active scene.'),!1):b.copy(a,h||"",p):(m.error('object "'+a.name+'" has not dynamic geometry for deep copying.'),
!1):(m.error('object "'+a.name+'" is not dynamic.'),!1):(m.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.set_nodemat_value=function(a,e,f){c.is_mesh(a)?b.set_nodemat_value(a,e,f):m.error('The type of the object "'+a.name+'" is not "MESH".')};a.set_nodemat_rgb=function(a,e,f,d,g){c.is_mesh(a)?b.set_nodemat_rgb(a,e,f,d,g):m.error('The type of the object "'+a.name+'" is not "MESH".')};a.update_boundings=function(a){c.is_mesh(a)?e.gi(a)||e.check_shape_keys(a)?b.update_boundings(a):m.error('object "'+
a.name+'" has not dynamic geometry.'):m.error('The type of the object "'+a.name+'" is not "MESH".')};a.get_parent=c.get_parent;a.get_dg_parent=c.get_dg_parent;a.is_mesh=c.is_mesh;a.is_armature=c.is_armature;a.is_speaker=c.is_speaker;a.is_camera=c.is_camera;a.is_lamp=c.is_lamp;a.is_empty=c.is_empty};b4w.module.main=function(a,p){function e(){}function b(){}function c(){}function m(){window.performance||(E.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(E.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});ba.nv(0)}function f(a,c,e){a.addEventListener("webglcontextlost",function(a){a.preventDefault();E.error("WebGL context lost");h()},!1);q.$c(e);var f=q.At();f&&E.log("%cRENDERER INFO:","color: #00a",
e.getParameter(f.UNMASKED_VENDOR_WEBGL)+", "+e.getParameter(f.UNMASKED_RENDERER_WEBGL));r.$c(e);D.$c(e);V.$c(e);H.$c(e);u.$c(e);y.$c(e);F.GE(a);y.init(a,c);K.pv(a.width,a.height,1);z.init();b=k();d()}function l(){e=function(){}}function h(){t()||(ia=performance.now()/1E3,z.pause(),G.pause(),V.pause(),n.pause())}function t(){return da<ia}function d(){O(d);var a=performance.now()/1E3;na||(na=a);var c=a-na;if(!(c<1/aa.Id)){for(var e=ba.get_timeline(),f=0;f<ja.length;f++)ja[f](e,c);t()||(da>na&&(c-=da-
Math.max(ia,na)),e+=c,ba.nv(e),u.update(),I.update(),F.update(),g(e,c),b(c));na=a}}function g(a,b){F.is_primary_loaded()&&(w.reset(),X.update(b),C.update(a,b),J.update(a,b),z.update(a,b),b&&x.update(b),F.is_primary_loaded()&&(G.update(a,b),F.is_primary_loaded()&&(e(b,a),F.is_primary_loaded()&&(v.update(a,b),F.is_primary_loaded()&&(n.update(),M.update(a,b),K.update(a,b),n.hw(),ga&&(ga(R.toDataURL()),ga=null))))))}function k(){var a=60,b=0,d=aa.gt,e=aa.aB;return function(f){f<1/aa.Id||(a=fa.smooth(1/
f,a,f,d),f=G.JB(),b=(b+1)%e,0==b&&c(Math.round(a),f))}}var n=p("__anchors"),x=p("__animation"),I=p("__assets"),A=p("__config"),B=p("__compat"),y=p("__container"),v=p("__controls"),F=p("__data"),u=p("__debug"),q=p("__extensions"),D=p("__geometry"),w=p("__hud"),J=p("__nla"),C=p("__logic_nodes"),M=p("__objects"),G=p("__physics"),E=p("__print"),r=p("__renderer"),K=p("__scenes"),z=p("__sfx"),H=p("__shaders"),V=p("__textures"),ba=p("__time"),X=p("__transform");p("__armature");var fa=p("__util"),Q=p("__version"),
ha=A.context,aa=A.q,R=null,W=null,na=0,ia=0,da=0,ja=[],ga=null,L=["webgl","experimental-webgl"],O=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/aa.Id)}}();a.init=function(a,b){A.zE();E.CE(aa.console_verbose);var c=Q.version_str()+" "+Q.type()+" ("+Q.date_str()+")";E.log("%cINIT ENGINE","color: #00a",c);if(!window.WebGLRenderingContext)return null;
m();R=a;b?(w.init(b),W=b):(A.q.show_hud_debug_info=!1,A.w.xm=!1);B.Ey();for(var c=null,d=0;d<L.length;d++){var e=L[d];try{c=a.getContext(e,ha)}catch(g){}if(c)break}c&&B.DA(c);if(!c)return null;f(R,W,c);A.Gy();B.sE(c);H.NC();aa.kp&&(a.style["touch-action"]="none");E.log("%cSET PRECISION:","color: #00a",aa.precision);return c};a.set_check_gl_errors=function(a){u.set_check_gl_errors(a)};a.resize=function(a,b,c){E.error("resize() deprecated, use container.resize() instead");y.resize(a,b,c)};a.set_fps_callback=
function(a){c=a};a.clear_fps_callback=function(){c=function(){}};a.set_render_callback=function(a){e=a};a.clear_render_callback=function(){l()};a.global_timeline=function(){return ba.get_timeline()};a.redraw=function(){E.error("redraw() deprecated");g(ba.get_timeline(),0)};a.pause=h;a.resume=function(){t()&&(da=performance.now()/1E3,z.resume(),G.resume(),V.play(!0),n.resume())};a.is_paused=t;a.reset=function(){F.unload(0);W=R=null;da=ia=na=0;c=function(){};b=function(){};e=function(){};ja.length=
0;ba.reset()};a.canvas_data_url=function(a){ga=a};a.get_canvas_elem=function(){return R};a.detect_mobile=function(){return B.detect_mobile()};a.append_loop_cb=function(a){for(var b=0;b<ja.length;b++)if(ja[b]==a)return;ja.push(a)};a.remove_loop_cb=function(a){for(var b=0;b<ja.length;b++)if(ja[b]==a){ja.splice(b,1);break}}};b4w.module.nla=function(a,p){var e=p("__nla"),b=p("__time"),c=p("__print"),m=p("__util");a.set_frame=function(a){a=m.clamp(a,e.get_frame_start(),e.get_frame_end());e.check_logic_nodes()?c.error("The active scene is using NLA script."):e.set_frame(a,b.get_timeline())};a.get_frame=function(){return e.get_frame(b.get_timeline())};a.stop=function(){e.check_logic_nodes()?c.error("The active scene is using NLA script."):e.cF()};a.play=function(a){e.check_logic_nodes()?c.error("The active scene is using NLA script."):
e.GD(a)};a.is_play=function(){return e.is_play()};a.get_frame_start=function(){return e.get_frame_start()};a.get_frame_end=function(){return e.get_frame_end()};a.check_nla=function(){return e.check_nla()};a.check_nla_scripts=function(){return e.check_logic_nodes()};a.check_logic_nodes=function(){return e.check_logic_nodes()};a.set_range=function(a,b){e.check_logic_nodes()?c.error("The active scene is using NLA script."):(b=parseFloat(b)||e.get_frame_end(),a=parseFloat(a)||e.get_frame_end(),b=m.clamp(b,
e.get_frame_start(),e.get_frame_end()),a=m.clamp(a,e.get_frame_start(),b),e.set_range(a,b))};a.reset_range=function(){e.check_logic_nodes()?c.error("The active scene is using NLA script."):e.reset_range()};a.set_cyclic=function(a){e.check_logic_nodes()?c.error("The active scene is using NLA script."):e.set_cyclic(a)};a.clear_callback=function(){e.check_logic_nodes()?c.error("The active scene is using NLA script."):e.clear_callback()}};b4w.module.app=function(a,p){function e(){var a=J.is_paused();document.addEventListener("visibilitychange",function(){document.hidden?(a=J.is_paused(),J.pause()):a||J.resume()},!1)}function b(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(b=document.createElement("canvas"),
b.style.position="absolute",e.style.left=0,e.style.top=0,b.style.pointerEvents="none"):b=null;f||(M.error('Warning: canvas container "'+a+'" not found, appending to body'),f=document.body);f.appendChild(e);if(!J.init(e,b))return c&&A("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/troubleshooting",d),!1;b&&u.insert_to_container(b,"LAST");return!0}function c(a,b){a?(b&&(document.getElementById(b).style.display="block"),H=document.getElementById(a)):(H=document.createElement("div"),
H.innerHTML=0,H.style.cssText="position:absolute;top: 23px;right: 20px;font-size: 45px;line-height: 50px;font-weight: bold;color: #000;",u.insert_to_container(H,"JUST_AFTER_CANVAS"))}function m(a,b){var c=String(a);b&&(c+="/"+String(b));H.innerHTML=c}function f(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,a);return b}function l(){var a=u.get_container();u.resize(a.clientWidth,a.clientHeight,!0)}function h(a,b,c){if(y.has_distance_limits(a))var d=E.get_translation(a,
aa),e=y.get_hover_cam_pivot(a,R),d=K.subtract(d,e,aa),d=Math.max(K.len(d),1);else d=10;e=E.get_rotation(a,na);b=r.quat_to_dir(e,b,aa);b[1]=0;K.normalize(b,b);K.scale(b,d*c,b);d=E.get_translation(a,R);K.add(d,b,d);y.hover_cam_set_translation(a,d)}function t(a,b){if(y.has_distance_limits(a)){var c=y.get_hover_angle_limits(a,Q);if(0>c[1]-c[0]){var d=y.get_camera_angles(a,ha)[1],c=(c[0]-d)/(c[0]-c[1]),d=y.get_cam_dist_limits(a),c=Math.max(c,2/d[0]);y.rotate_hover_camera(a,0,c*b)}}else c=E.get_translation(a,
aa),d=K.scale(r.AXIS_Y,-b,R),K.add(c,d,c),y.hover_cam_set_translation(a,c)}function d(a,b,c,d){E.move_local(a,5*b,5*c,5*d)}function g(a,b,c){var d=E.get_translation(a,aa),e=y.get_pivot(a,R),d=K.dist(d,e),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));E.move_local(a,0,0>b?.001<d?-d*c:0:c/(1-c)*d,0)}function k(a,b,c,d){for(var e=c*b;0<a;--a)c+=e,d+=e,e=c*b;return d}function n(a,b,c,d,e){e?(e=y.get_pivot(a,aa),a=y.get_eye(a),a=K.dist(e,a)+d,d=0<b?k(b,-c,a,d):k(-b,c/(1-c),a,d)):d-=2*b*c;return d}function x(a,
b,c){function e(a,b,c,d){if(1==c){var f=v?.003*w[0]:.003*w[1];c=q.get_sensor_value(a,b,0);q.get_sensor_payload(a,b,0)===q.PL_SINGLE_TOUCH_MOVE?(ka+="X"==d?-c*f:0,Bb+="Y"==d?-c*f:0):q.get_sensor_payload(a,b,0)===q.PL_MULTITOUCH_MOVE_PAN&&(a=v?.003*w[1]:7.5E-4*w[0],ra+="X"==d?-c*a:0,Wa+="Y"==d?-c*a:0)}}function f(a,b,c,d){if(1==c){c=q.get_sensor_value(a,b,1);y.get_velocity_params(a,w);if(v)e=.003*w[0],g=7.5E-4*w[1];else var e=.003*w[1],g=7.5E-4*w[0];if(1===q.get_sensor_payload(a,b,0))sb+="X"==d?-c*
e:0,ta+="Y"==d?-c*e:0;else if(2===q.get_sensor_payload(a,b,0)||3===q.get_sensor_payload(a,b,0))za+="X"==d?-c*g:0,Ka+="Y"==d?-c*g:0}}function k(a){return a[0]&&(a[1]||a[2])}function l(a,b,c){if(1==c)switch(c=q.get_sensor_value(a,b,0),y.get_velocity_params(a,w),b){case "FORWARD":u?B[0]=1:v?(b=y.get_camera_angles(a,ha)[1],b=Math.abs(b)>=Math.PI/4?r.AXIS_MZ:r.AXIS_MY,h(a,b,.5*w[0]*c)):p?g(a,-w[2],c):d(a,0,-w[0]*c,0);break;case "BACKWARD":u?B[0]=-1:v?(b=y.get_camera_angles(a,ha)[1],b=Math.abs(b)>=Math.PI/
4?r.AXIS_Z:r.AXIS_Y,h(a,b,.5*w[0]*c)):p?g(a,w[2],c):d(a,0,w[0]*c,0);break;case "UP":v?t(a,30*-w[2]*c):u||d(a,0,0,-w[0]*c);break;case "DOWN":v?t(a,30*w[2]*c):u||d(a,0,0,w[0]*c);break;case "LEFT":u?B[1]=1:v?h(a,r.AXIS_MX,.5*w[0]*c):d(a,-w[0]*c,0,0);break;case "RIGHT":u?B[1]=-1:v?h(a,r.AXIS_X,.5*w[0]*c):d(a,w[0]*c,0,0);break;case "ROT_LEFT":p?y.rotate_target_camera(a,2*-w[1]*c,0):y.rotate_eye_camera(a,2*w[1]*c,0);break;case "ROT_RIGHT":p?y.rotate_target_camera(a,2*w[1]*c,0):y.rotate_eye_camera(a,2*-w[1]*
c,0);break;case "ROT_UP":p?y.rotate_target_camera(a,0,2*-w[1]*c):y.rotate_eye_camera(a,0,2*w[1]*c);break;case "ROT_DOWN":p?y.rotate_target_camera(a,0,2*w[1]*c):y.rotate_eye_camera(a,0,2*-w[1]*c)}else switch(b){case "FORWARD":case "BACKWARD":u&&(B[0]=0);break;case "LEFT":case "RIGHT":u&&(B[1]=0)}u&&(C.set_character_move_dir(u,B[0],B[1]),a=y.get_camera_angles_char(a,Q),C.set_character_rotation(u,a[0],a[1]))}V=!0;ba=a;X=b;fa=c;var m=G.get_active_camera(),p=!1,u=null,v=!1;switch(y.get_move_style(m)){case y.MS_TARGET_CONTROLS:p=
!a;break;case y.MS_EYE_CONTROLS:u=G.get_first_character();break;case y.MS_STATIC:return;case y.MS_HOVER_CONTROLS:v=!0}var w=y.get_velocity_params(m,ia);a=q.create_elapsed_sensor();if(C.has_simulated_physics(m)){var x=q.create_collision_sensor(m,null,!0);q.create_sensor_manifold(m,"CAMERA_COLLISION",q.CT_CONTINUOUS,[x],null,function(a,b,c){if(1==c&&(c=q.get_sensor_payload(a,b,0).coll_dist,0>c)){var d=q.get_sensor_payload(a,b,0).coll_norm;b=aa;K.scale(d,-.25*c,b);c=E.get_translation(a,R);K.add(c,b,
c);E.set_translation_v(a,c)}})}if(u){var x=E.get_translation(m),A=E.get_rotation(m),A=r.cam_quat_to_mesh_quat(A);x[1]-=.5;C.set_transform(u,x,A);F.append_stiff_trans(m,u,[0,.5,0]);var B=new Float32Array(2),D=!0;C.set_character_move_type(u,C.CM_FLY);q.create_kb_sensor_manifold(m,"TOGGLE_CHAR_MOVE_TYPE",q.CT_SHOT,q.KEY_C,function(){D=!D;C.set_character_move_type(u,D?C.CM_FLY:C.CM_WALK)})}if(b)b=x=A=H=M=I=q.create_custom_sensor(0);else{b=q.create_keyboard_sensor(q.KEY_W);var x=q.create_keyboard_sensor(q.KEY_S),
A=q.create_keyboard_sensor(q.KEY_A),H=q.create_keyboard_sensor(q.KEY_D),M=q.create_keyboard_sensor(q.KEY_R),I=q.create_keyboard_sensor(q.KEY_F)}var J=q.create_keyboard_sensor(q.KEY_UP),na=q.create_keyboard_sensor(q.KEY_DOWN),va=q.create_keyboard_sensor(q.KEY_LEFT),pa=q.create_keyboard_sensor(q.KEY_RIGHT);v||(q.create_sensor_manifold(m,"FORWARD",q.CT_CONTINUOUS,[a,b],null,l),q.create_sensor_manifold(m,"BACKWARD",q.CT_CONTINUOUS,[a,x],null,l));p?(q.create_sensor_manifold(m,"ROT_UP",q.CT_CONTINUOUS,
[a,J,M],k,l),q.create_sensor_manifold(m,"ROT_DOWN",q.CT_CONTINUOUS,[a,na,I],k,l),q.create_sensor_manifold(m,"ROT_LEFT",q.CT_CONTINUOUS,[a,va,A],k,l),q.create_sensor_manifold(m,"ROT_RIGHT",q.CT_CONTINUOUS,[a,pa,H],k,l)):v?(q.create_sensor_manifold(m,"LEFT",q.CT_CONTINUOUS,[a,va,A],k,l),q.create_sensor_manifold(m,"RIGHT",q.CT_CONTINUOUS,[a,pa,H],k,l),q.create_sensor_manifold(m,"FORWARD",q.CT_CONTINUOUS,[a,J,b],k,l),q.create_sensor_manifold(m,"BACKWARD",q.CT_CONTINUOUS,[a,na,x],k,l),q.create_sensor_manifold(m,
"UP",q.CT_CONTINUOUS,[a,I],k,l),q.create_sensor_manifold(m,"DOWN",q.CT_CONTINUOUS,[a,M],k,l)):(q.create_sensor_manifold(m,"UP",q.CT_CONTINUOUS,[a,M],k,l),q.create_sensor_manifold(m,"DOWN",q.CT_CONTINUOUS,[a,I],k,l),q.create_sensor_manifold(m,"LEFT",q.CT_CONTINUOUS,[a,A],k,l),q.create_sensor_manifold(m,"RIGHT",q.CT_CONTINUOUS,[a,H],k,l),q.create_sensor_manifold(m,"ROT_UP",q.CT_CONTINUOUS,[a,J],k,l),q.create_sensor_manifold(m,"ROT_DOWN",q.CT_CONTINUOUS,[a,na],k,l),q.create_sensor_manifold(m,"ROT_LEFT",
q.CT_CONTINUOUS,[a,va],k,l),q.create_sensor_manifold(m,"ROT_RIGHT",q.CT_CONTINUOUS,[a,pa],k,l));if(!c){var ma=0;c=q.create_mouse_wheel_sensor();var wa=0;b=q.create_touch_zoom_sensor();q.create_sensor_manifold(m,"MOUSE_WHEEL",q.CT_LEVEL,[c],null,function(a,b,c){1==c&&(b=q.get_sensor_value(a,b,0),y.get_velocity_params(a,w),p||v?ma=n(a,b,w[2],ma,p):(w[0]*=1+b*w[2],y.set_velocity_params(a,w)))});q.create_sensor_manifold(m,"TOUCH_ZOOM",q.CT_LEVEL,[b],null,function(a,b,c){1==c&&(c=q.get_sensor_value(a,
b,0),y.get_velocity_params(a,w),q.get_sensor_payload(a,b,0)===q.PL_MULTITOUCH_MOVE_ZOOM&&(wa=n(a,c,.03*w[2],wa,p)))});q.create_sensor_manifold(m,"ZOOM_INTERPOL",q.CT_CONTINUOUS,[a],null,function(a,b,c){if(1==c&&(p||v))if(1E-5<Math.abs(ma)||1E-5<Math.abs(wa)){b=q.get_sensor_value(a,b,0);c=r.smooth(ma,0,b,.1*z);ma-=c;var d=r.smooth(wa,0,b,.15*z);wa-=d;if(v)t(a,-(c+d));else{b=y.get_pivot(a,aa);var e=y.get_eye(a,R);.001<K.dist(b,e)+c+d?E.move_local(a,0,c+d,0):(c=K.subtract(e,b,R),d=K.normalize(c,W),K.scale(d,
.001,d),K.add(b,d,c),E.set_translation_v(a,c),wa=ma=0)}}else wa=ma=0})}var sb=0,ta=0,za=0,Ka=0;c=q.create_mouse_move_sensor("X");b=q.create_mouse_move_sensor("Y");x=q.create_mouse_click_sensor();q.create_sensor_manifold(m,"MOUSE_X",q.CT_LEVEL,[x,c],null,f,"X");q.create_sensor_manifold(m,"MOUSE_Y",q.CT_LEVEL,[x,b],null,f,"Y");var ka=0,Bb=0,ra=0,Wa=0;c=q.create_touch_move_sensor("X");b=q.create_touch_move_sensor("Y");q.create_sensor_manifold(m,"TOUCH_X",q.CT_LEVEL,[c],null,e,"X");q.create_sensor_manifold(m,
"TOUCH_Y",q.CT_LEVEL,[b],null,e,"Y");q.create_sensor_manifold(m,"ROT_TRANS_INTERPOL",q.CT_CONTINUOUS,[a],null,function(a,b,c){if(1==c&&(1E-5<Math.abs(sb)||1E-5<Math.abs(ta)||1E-5<Math.abs(ka)||1E-5<Math.abs(Bb)||1E-5<Math.abs(za)||1E-5<Math.abs(Ka)||1E-5<Math.abs(ra)||1E-5<Math.abs(Wa))){var d=q.get_sensor_value(a,b,0),e=r.smooth(sb,0,d,.08*z);b=r.smooth(ta,0,d,.08*z);sb-=e;ta-=b;var f=r.smooth(ka,0,d,.12*z);c=r.smooth(Bb,0,d,.12*z);ka-=f;Bb-=c;var g=r.smooth(za,0,d,.08*z),k=r.smooth(Ka,0,d,.08*z);
za-=g;Ka-=k;var l=r.smooth(ra,0,d,.12*z),d=r.smooth(Wa,0,d,.12*z);ra-=l;Wa-=d;p?(y.rotate_target_camera(a,e+f,b+c),y.move_pivot(a,g+l,k+d)):v?(e+f&&h(a,r.AXIS_X,.2*(e+f)),b+c&&(e=y.get_camera_angles(a,ha)[1],h(a,Math.abs(e)>Math.PI/4?r.AXIS_Z:r.AXIS_Y,.2*(b+c))),y.rotate_hover_camera(a,g+l,0)):(y.rotate_eye_camera(a,.5*(e+f),.5*(b+c)),u&&(a=y.get_camera_angles_char(a,Q),C.set_character_rotation(u,a[0],a[1])))}});q.create_kb_sensor_manifold(m,"DEC_STEREO_DIST",q.CT_SHOT,q.KEY_LEFT_SQ_BRACKET,function(a){var b=
y.get_stereo_distance(a);y.set_stereo_distance(a,.9*b)});q.create_kb_sensor_manifold(m,"INC_STEREO_DIST",q.CT_SHOT,q.KEY_RIGHT_SQ_BRACKET,function(a){var b=y.get_stereo_distance(a);y.set_stereo_distance(a,1.1*b)})}function I(){var a=G.get_active_camera();V=!1;for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL".split(" "),c=0;c<b.length;c++)q.remove_sensor_manifold(a,b[c]);y.get_move_style(a)==
y.MS_EYE_CONTROLS&&G.get_first_character()&&F.remove(a)}function A(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");if(d)for(var h=0;h<d.length;h++){var k=document.getElementById(d[h]);k&&k.parentNode.removeChild(k)}e.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";f.innerHTML=a;g.innerHTML=
b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(g);document.body.appendChild(e)}function B(a,b,c,d,e){function f(){var h=performance.now()-g;e(b+h*(c-b)/d);(h>=d||!a.parentNode)&&J.remove_loop_cb(f)}var g=performance.now();J.append_loop_cb(f)}p("animation");var y=p("camera"),v=p("config"),F=p("constraints"),u=p("container"),q=p("controls"),D=p("data"),w=p("debug"),J=p("main"),C=p("physics"),M=p("print"),G=p("scenes"),
E=p("transform"),r=p("util"),K=p("vec3"),z=1,H=null,V=!1,ba=!1,X=!1,fa=!1,Q=new Float32Array(2),ha=new Float32Array(2),aa=new Float32Array(3),R=new Float32Array(3),W=new Float32Array(3),na=new Float32Array(4),ia=new Float32Array(3);a.init=function(a){function d(){var a=b(k,H,y,n),f=u.get_canvas();if(a){var q=u.get_container();l();J.set_check_gl_errors(z);E&&(c(p,t),J.set_fps_callback(m));x&&e();r&&J.append_loop_cb(function(){q.style.height=q.clientWidth/r+"px"});h&&J.append_loop_cb(function(){var a=
q.clientWidth,b=q.clientHeight;a==f.clientWidth&&b==f.clientHeight||u.resize(a,b,!0)});B&&J.append_loop_cb(function(){u.force_offsets_updating()});g(f,!0)}else g(f,!1)}function f(a){a.keyCode==q.KEY_P&&(J.is_paused()?J.resume():J.pause())}function g(){}a=a||{};var h=!1,k=null,n=null,p=null,r=0,t=null,z=!1,w=!0,x=!0,y=!0,G=!1,E=!1,A=!1,B=!1,C;for(C in a)switch(C){case "canvas_container_id":k=a.canvas_container_id;break;case "callback":g=a.callback;break;case "autoresize":h=a.autoresize;break;case "do_not_use_onload":break;
case "gl_debug":z=a.gl_debug;break;case "show_hud_debug_info":A=a.show_hud_debug_info;break;case "sfx_mix_mode":G=a.sfx_mix_mode;break;case "show_fps":E=a.show_fps;break;case "track_container_position":B=a.track_container_position;break;case "fps_wrapper_id":t=a.fps_wrapper_id;break;case "fps_elem_id":p=a.fps_elem_id;break;case "error_purge_elements":n=a.error_purge_elements;break;case "report_init_failure":y=a.report_init_failure;break;case "pause_invisible":x=a.pause_invisible;break;case "key_pause_enabled":w=
a.key_pause_enabled;break;case "force_container_ratio":r=a.force_container_ratio;break;default:v.set(C,a[C])}w&&document.addEventListener("keydown",f,!1);v.set("show_hud_debug_info",A);v.set("sfx_mix_mode",G);var H=A||G||null;"complete"==document.readyState?window.setTimeout(d,0):window.addEventListener("load",d,!1);window.addEventListener("unload",function(){D.cleanup()},!1)};a.resize_to_container=l;a.set_onclick=function(a,b){var c=f(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.set_onchange=
function(a,b){var c=f(a);c.addEventListener("change",function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.set_onkeypress=function(a,b){var c=f(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.enable_camera_controls=x;a.disable_camera_controls=I;a.set_camera_move_style=function(a){var b=V;b&&I();var c=G.get_active_camera();y.set_move_style(c,a);b&&x(ba,X,fa)};a.enable_object_controls=function(a){function b(a){return a[0]&&(a[1]||a[2])}function c(a,b,e){if(1==e)switch(e=
q.get_sensor_value(a,b,0),b){case "FORWARD":d?C.vehicle_throttle(a,1):E.move_local(a,0,0,1*e);break;case "BACKWARD":d?C.vehicle_throttle(a,-1):E.move_local(a,0,0,-1*e);break;case "LEFT":d?C.vehicle_steer(a,-1):E.move_local(a,1*e,0,0);break;case "RIGHT":d?C.vehicle_steer(a,1):E.move_local(a,-1*e,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&C.vehicle_throttle(a,0);break;case "LEFT":case "RIGHT":d&&C.vehicle_steer(a,0)}}var d=C.is_vehicle_chassis(a)||C.is_vehicle_hull(a),e=q.create_elapsed_sensor(),
f=q.create_keyboard_sensor(q.KEY_W),g=q.create_keyboard_sensor(q.KEY_S),h=q.create_keyboard_sensor(q.KEY_A),k=q.create_keyboard_sensor(q.KEY_D),l=q.create_keyboard_sensor(q.KEY_UP),m=q.create_keyboard_sensor(q.KEY_DOWN),n=q.create_keyboard_sensor(q.KEY_LEFT),p=q.create_keyboard_sensor(q.KEY_RIGHT);q.create_sensor_manifold(a,"FORWARD",q.CT_CONTINUOUS,[e,f,l],b,c);q.create_sensor_manifold(a,"BACKWARD",q.CT_CONTINUOUS,[e,g,m],b,c);q.create_sensor_manifold(a,"LEFT",q.CT_CONTINUOUS,[e,h,n],b,c);q.create_sensor_manifold(a,
"RIGHT",q.CT_CONTINUOUS,[e,k,p],b,c)};a.disable_object_controls=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)q.remove_sensor_manifold(a,b[c])};a.enable_controls=function(a){var b=u.get_container();a=a||!1;q.register_keyboard_events(document,!1);q.register_mouse_events(b,!0,a);q.register_wheel_events(b,!0);q.register_touch_events(b,!0);q.register_device_orientation()};a.disable_controls=function(){var a=u.get_container();q.unregister_keyboard_events(document);q.unregister_mouse_events(a);
q.unregister_wheel_events(a);q.unregister_touch_events(a);q.unregister_device_orientation()};a.enable_debug_controls=function(){q.create_kb_sensor_manifold(null,"CAMERA_SHOT",q.CT_SHOT,q.KEY_K,function(){w.make_camera_frustum_shot()});q.create_kb_sensor_manifold(null,"LIGHT_SHOT",q.CT_SHOT,q.KEY_L,function(){w.make_light_frustum_shot()});q.create_kb_sensor_manifold(null,"TELEMETRY",q.CT_SHOT,q.KEY_T,function(){w.plot_telemetry()})};a.request_fullscreen=function(a,b,c){function d(){document.fullscreenElement===
a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",d,!1);document.addEventListener("webkitfullscreenchange",
d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",d,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen==a.webkitRequestFullScreen?a.requestFullScreen(Element.ALLOW_KEYBOARD_INPUT):a.requestFullScreen()};a.exit_fullscreen=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;if("function"!=
typeof a)throw"B4W App: exit fullscreen method is not supported";a.apply(document)};a.check_fullscreen=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1};a.report_app_error=A;a.get_url_params=function(a){a=!!a;var b=location.href.toString();if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=b[d].split("="),f=e[0];1<e.length?
(e=e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.css_animate=function(a,b,c,d,e,f,g,h){function k(e){a&&(l[b]=f+e+g,c>d&&e<=d||c<d&&e>=d)&&(l[b]=f+d+g,h())}if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=f||"";g=g||"";h=h||function(){};var l=a.style,m=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==l[b])if(void 0!=l["webkit"+m])b="webkit"+m;else if(void 0!=l["ms"+m])b="ms"+m;else if(void 0!=l["moz"+m])b="moz"+m;else return;B(a,c,d,e,k)}};a.attr_animate=function(a,
b,c,d,e,f){function g(e){a&&(0<=e&&a.setAttribute(b,e),c>d&&e<=d||c<d&&e>=d)&&(a.setAttribute(b,d),f())}a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)&&(f=f||function(){},B(a,c,d,e,g))};a.queue_animate=function(b){if(b.length){var c=b.shift(),d=c.elem,e=c.prop,f=c.from,g=c.to,h=c.duration,k=c.opt_prefix,l=c.opt_suffix,m=function(){c.cb&&c.cb();a.queue_animate(b)};"css"==c.type?a.css_animate(d,e,f,g,h,k,l,m):"attr"==c.type&&a.attr_animate(d,e,f,g,h,m)}};a.set_camera_smooth_factor=function(a){z=a};a.get_camera_smooth_factor=
function(){return z}};b4w.module.camera_anim=function(a,p){function e(a,b,c,e){b=d.angle_wrap_0_2pi(a-b);a=d.angle_wrap_0_2pi(c-a);if(1E-6>Math.abs(b)||1E-6>2*Math.PI-Math.abs(b))b=0;if(1E-6>Math.abs(a)||1E-6>2*Math.PI-Math.abs(a))a=0;e[0]=b;e[1]=a;return e}var b=p("camera"),c=p("controls"),m=p("print"),f=p("scenes"),l=p("time"),h=p("transform"),t=p("tsr"),d=p("util"),g=p("vec3"),k=p("quat"),n=new Float32Array(2),x=new Float32Array(2),I=new Float32Array(3),A=new Float32Array(3),B=new Float32Array(3),y=new Float32Array(4),
v=new Float32Array(2),F=new Float32Array(2),u=new Float32Array(8),q=new Float32Array(8),D=new Float32Array(8),w=!1,J=!1,C=!1,M=!1;a.track_to_target=function(a,e,f,l,p,q,t,u){if(!b.is_eye_camera(a))m.error("track_to_target(): wrong object");else if(a&&e){if(d.is_vector(e))var v=e;else v=B,h.get_object_center(e,!1,v);e=f||1;f=l||2;var w=p||1;p=q||1;A[0]=0;A[1]=-1;A[2]=0;var x=h.get_rotation(a);q=d.quat_to_dir(x,A);l=b.get_camera_angles(a,n);var C=h.get_translation(a);g.subtract(v,C,I);g.normalize(I,
I);var D=k.rotationTo(q,I,k.create());k.multiply(D,x,y);d.correct_cam_quat_up(y,!1);g.subtract(v,C,A);var F=g.length(A)*(1-1/f),v=Math.asin(I[1]);f=Math.acos(-I[2]/Math.abs(Math.cos(v)));0<I[0]&&(f=2*Math.PI-f);var M=f-l[0],J=v-l[1];B[0]=0;B[1]=0;B[2]=-1;f=h.get_rotation(a);0>d.quat_to_dir(f,B)[1]?(J=0<q[1]?v-Math.PI+l[1]:v+Math.PI+l[1],M=0<M?-Math.PI+M:Math.PI+M):Math.abs(M)>Math.PI&&(M=0<M?M-2*Math.PI:M+2*Math.PI);var ia=0,v=c.create_elapsed_sensor();q=Math.abs(M/e);e=Math.abs(J/e);var da=q>e?q:
e,ja=da+w,ga=ja+p,L=ga+w,O=M,S=J,ua=F,P=function(){c.remove_sensor_manifold(a,"TRACK_TO_TARGET");t&&t()};c.create_sensor_manifold(a,"TRACK_TO_TARGET",c.CT_CONTINUOUS,[v],null,function(a,d,e){if(e)if(b.is_eye_camera(a))if(e=c.get_sensor_value(a,d,0),ia+=e,ia<da){var f=M/da*e;e*=J/da;d=ia/da;d=6*d*(1-d);f*=d;e*=d;O-=f;S-=e;b.rotate_eye_camera(a,f,e)}else ia<ja?(O&&(b.rotate_eye_camera(a,O,S),O=0,u&&u()),d=(ia-da)/w,e=-F*e/w,ua-=f,h.move_local(a,0,6*e*d*(1-d),0)):ia<ga?ua&&(h.move_local(a,0,ua,0),ua=
0):ia<L?(d=(ia-ga)/w,e=F*e/w,e=6*e*d*(1-d),h.move_local(a,0,e,0)):(h.set_translation_v(a,C),P());else P()})}};a.auto_rotate=function(a,g,h){function k(f,g,h){if(1==h)if(h=b.get_move_style(f),h==b.MS_STATIC)l();else if(h!=b.MS_HOVER_CONTROLS&&b.has_horizontal_limits(f)){h=b.get_horizontal_limits(f,F);if(null===q||h[0]!=q[0]||h[1]!=q[1]){q=q||v;q.set(h);t=Math.min(.2,d.angle_wrap_0_2pi(q[1]-q[0])/2);h=q;var m=b.get_camera_angles(p,n)[0];h=e(m,h[0],h[1],x);u=a*Math.min(1,h[0]/.2,h[1]/.2)}g=c.get_sensor_value(f,
g,0);h=b.get_camera_angles(f,n)[0];h=e(h,q[0],q[1],x);h[1]>t&&h[0]>t?u=d.sign(u)*a:h[1]<t?u-=Math.pow(a,2)/.4*g:h[0]<t&&(u+=Math.pow(a,2)/.4*g);b.rotate_camera(f,g*u,0)}else q=null,g=c.get_sensor_value(f,g,0),b.rotate_camera(f,g*a,0)}function l(){c.remove_sensor_manifold(p,"AUTO_ROTATE");c.remove_sensor_manifold(p,"DISABLE_AUTO_ROTATE");g()}g=g||function(){};var p=f.get_active_camera();if(b.get_move_style(p)==b.MS_STATIC)m.error("auto_rotate(): wrong camera type");else{var q=null,t=0,u=0;if(c.check_sensor_manifold(p,
"AUTO_ROTATE"))l();else{var w=c.create_mouse_move_sensor("X"),y=c.create_mouse_move_sensor("Y"),A=c.create_mouse_click_sensor(),B=c.create_touch_move_sensor(),C=c.create_touch_zoom_sensor(),D=c.create_elapsed_sensor();h=h?c.create_mouse_wheel_sensor():c.create_custom_sensor(0);c.create_sensor_manifold(p,"DISABLE_AUTO_ROTATE",c.CT_LEVEL,[w,y,A,B,C,h],function(a){return a[0]&&a[2]||a[1]&&a[2]||a[3]||a[4]||a[5]},l);c.create_sensor_manifold(p,"AUTO_ROTATE",c.CT_CONTINUOUS,[D],function(a){return a[0]},
k)}}};a.is_auto_rotate=function(){var a=f.get_active_camera();return c.check_sensor_manifold(a,"AUTO_ROTATE")};a.check_auto_rotate=function(){var a=f.get_active_camera();return b.get_move_style(a)==b.MS_STATIC?!1:!0};a.move_camera_to_point=function(a,c,e,f,k){if(b.get_move_style(a)!=b.MS_STATIC)m.error("move_camera_to_point(): wrong camera type");else if(!w)if(a)if(c){e=e||1;f=f||.01;var n=d.is_vector(a)?a:h.get_tsr(a,u),p=d.is_vector(c)?c:h.get_tsr(c,q);c=g.distance(t.get_trans_view(n),t.get_trans_view(p))/
e;e=d.quat_to_dir(t.get_quat_view(n),d.AXIS_MY,I);var v=d.quat_to_dir(t.get_quat_view(p),d.AXIS_MY,A);e=Math.min(Math.abs(g.dot(e,v)),1);f=1E3*Math.max(c,Math.acos(e)/f);w=!0;var x=l.animate(0,1,f,function(b){var c=t.interpolate(n,p,d.smooth_step(b),D);C?(l.clear_animation(x),w=C=!1):(h.set_tsr(a,c),1==b&&(w=!1,k&&k()))})}else m.error("move_camera_to_point(): you must specify the point object");else m.error("move_camera_to_point(): you must specify the camera object")};a.rotate_camera=function(a,
c,d,e,f){if(!J)if(a)if(c||d){J=!0;var g=0,h=0,k=0!=c?c:d,n=l.animate(0,k,e||1E3,function(e){M?(l.clear_animation(n),J=M=!1):(g-=e,h-=e,d&&c?b.rotate_camera(a,g,h):d?b.rotate_camera(a,0,h):c&&b.rotate_camera(a,g,0),h=g=e,e==k&&(J=!1,f&&f()))})}else m.error("rotate_camera(): you must specify the rotation angle");else m.error("rotate_camera(): you must specify the camera object")};a.stop_cam_moving=function(){C=!0};a.stop_cam_rotating=function(){M=!0};a.is_moving=function(){return w};a.is_rotating=function(){return J}};b4w.module.gyroscope=function(a,p){function e(a){var c=b.create_gyro_angles_sensor(),e=!0;b.create_sensor_manifold(a,"CAMERA_ROTATE_GYRO",b.CT_CONTINUOUS,[c],null,function(a,c,k){if(0<k){l=b.get_sensor_payload(a,c,0);e&&(f[0]=l[0],f[1]=l[1],f[2]=l[2],e=!1);k=c=0;0==window.orientation&&(c=l[1]-f[1],k=l[0]-f[0],l[1]>t&&l[1]<h&&(k=0));if(180==window.orientation){c=l[1]-f[1];0>l[1]&&(c=-c);k=f[0]-l[0];if(c>Math.PI/2||c<-Math.PI/2)c=0;l[1]>-h&&l[1]<-t&&(k=0)}if(-90==window.orientation){c=l[0]-f[0];if(c>
Math.PI/2||c<-Math.PI/2)c=0;k=f[1]-l[1];if(l[0]>d||l[0]<g)k=0}if(90==window.orientation){c=f[0]-l[0];if(c>Math.PI/2||c<-Math.PI/2)c=0;k=l[1]-f[1];if(l[0]>d||l[0]<g)k=0}m.rotate_camera(a,k,c);f[0]=l[0];f[1]=l[1];f[2]=l[2]}})}var b=p("controls"),c=p("scenes"),m=p("camera"),f=new Float32Array(3),l=new Float32Array(3),h=110*Math.PI/180,t=70*Math.PI/180,d=70*Math.PI/180,g=70*-Math.PI/180;a.enable_camera_rotation=function(){var a=c.get_active_camera();e(a)}};b4w.module.mixer=function(a,p){function e(){B=A.length=0;y=b();v=new Float32Array(y.length);F=new Float32Array(y.length);var a=x.get_speaker_objects();if(a.length){A.push(c());for(var d=0;d<a.length;d++)A.push(f(a[d]));A.sort(function(a,b){return"MASTER"==a.id?-1:"MASTER"==b.id?1:"COMPRESSOR"==a.id?-1:"COMPRESSOR"==b.id?1:a.id.toUpperCase()<b.id.toUpperCase()?-1:a.id.toUpperCase()>b.id.toUpperCase()?1:0})}}function b(){for(var a=new Float32Array(100),b=0,c=0;100>c;c++)a[c]=20*Math.pow(1E3,b),b+=1/
99;return a}function c(){var a=m("MASTER");a.K.push(["VOLUME",x.get_volume(null),0,1,50,!1]);var b=x.get_compressor_params();b&&(a.K.push(["THRESHOLD",b.threshold,-100,0,100,!1]),a.K.push(["KNEE",b.knee,0,40,40,!1]),a.K.push(["RATIO",b.ratio,1,20,20,!1]),a.K.push(["ATTACK",b.attack,0,1,1E3,!1]),a.K.push(["RELEASE",b.release,0,1,1E3,!1]));a.mute=x.is_muted(null)?1:0;a.zd=-1;return a}function m(a){return{id:a,K:[],pg:0,mute:-1,zd:-1,Ma:null}}function f(a){var b=m(n.get_object_name(a));b.mute=x.is_muted(a)?
1:0;b.zd=0;b.Ma=a;return b}function l(a){if(a.Ma){a.K.length=0;a.K.push(["VOLUME",x.get_volume(a.Ma),0,1,50,!1]);var b=x.get_positional_params(a.Ma);b&&(a.K.push(["DIST_REF",b.dist_ref,0,1E3,1E4,!1]),a.K.push(["ATTENUATION",b.attenuation,0,50,1E3,!1]),a.K.push(["DIST_MAX",b.dist_max,0,1E4,1E4,!1]));if(b=x.get_filter_params(a.Ma))a.K.push(["EQ_FREQ",b.freq,20,2E4,100,!0]),a.K.push(["EQ_Q",b.Q,0,10,100,!1]),a.K.push(["EQ_GAIN",b.gain,-70,30,100,!1]);I.clamp(a.pg,0,a.K.length-1)}}function h(a){for(var b=
0;b<A.length;b++){var c=A[b];if(c!=a&&1==c.zd)return!0}return!1}function t(a){for(var b=0;b<A.length;b++){var c=A[b];c!=a&&0==c.mute&&0==c.zd&&x.mute(c.Ma,!1)}}function d(){if(0==A.length)return[0,-1];var a=8*Math.floor(B/8),b=a+7,a=I.clamp(a,0,A.length-1),b=I.clamp(b,0,A.length-1);return[a,b]}var g=p("controls");p("debug");var k=p("hud"),n=p("scenes"),x=p("sfx"),I=p("util"),A=[],B=0,y=null,v=null,F=null;a.enable_mixer_controls=function(){function a(b,c,d){if(1==d){var e=Boolean(g.get_sensor_value(b,
c,2))?-1:1,f=A[B];if(f)switch(d=f.K[f.pg],d[1]=d[5]?d[1]*Math.pow(d[3]/d[2],e/d[4]):d[1]+(d[3]-d[2])/d[4]*e,d[1]=I.clamp(d[1],d[2],d[3]),d[0]){case "VOLUME":"MASTER"!=f.id?x.set_volume(f.Ma,d[1]):x.set_volume(null,d[1]);break;case "DIST_REF":e=x.get_positional_params(f.Ma);e.dist_ref=d[1];x.set_positional_params(f.Ma,e);break;case "ATTENUATION":e=x.get_positional_params(f.Ma);e.attenuation=d[1];x.set_positional_params(f.Ma,e);break;case "DIST_MAX":e=x.get_positional_params(f.Ma);e.dist_max=d[1];x.set_positional_params(f.Ma,
e);break;case "EQ_FREQ":e=x.get_filter_params(f.Ma);e.freq=d[1];x.set_filter_params(f.Ma,e);break;case "EQ_Q":e=x.get_filter_params(f.Ma);e.Q=d[1];x.set_filter_params(f.Ma,e);break;case "EQ_GAIN":e=x.get_filter_params(f.Ma);e.gain=d[1];x.set_filter_params(f.Ma,e);break;case "THRESHOLD":f=x.get_compressor_params();f.threshold=d[1];x.set_compressor_params(f);break;case "KNEE":f=x.get_compressor_params();f.knee=d[1];x.set_compressor_params(f);break;case "RATIO":f=x.get_compressor_params();f.ratio=d[1];
x.set_compressor_params(f);break;case "ATTACK":f=x.get_compressor_params();f.attack=d[1];x.set_compressor_params(f);break;case "RELEASE":f=x.get_compressor_params();f.release=d[1];x.set_compressor_params(f);break;default:throw"Unknown strip param";}"INC_DEC"==c?g.reset_timer_sensor(b,c,6,.35):g.reset_timer_sensor(b,c,6,.05)}else g.reset_timer_sensor(b,c,6,10)}function b(a,c,e){if(1==e){e=Boolean(g.get_sensor_value(a,c,0))?-1:1;if(A.length){1==e&&B<A.length-1?B++:-1==e&&0<B&&B--;e=d();for(var f=e[0];f<=
e[1];f++)l(A[f])}"SWITCH_STRIP"==c?g.reset_timer_sensor(a,c,5,.15+.3):g.reset_timer_sensor(a,c,5,.15)}else g.reset_timer_sensor(a,c,5,10)}e();var c=g.create_keyboard_sensor(g.KEY_LEFT_SQ_BRACKET),f=g.create_keyboard_sensor(g.KEY_RIGHT_SQ_BRACKET),m=g.create_keyboard_sensor(g.KEY_SEMI_COLON),n=g.create_keyboard_sensor(g.KEY_SINGLE_QUOTE),p=g.create_keyboard_sensor(g.KEY_SHIFT),G=g.create_timer_sensor(.15,!0),E=g.create_timer_sensor(.05,!0),c=[c,f,m,n,p,G,E];g.create_sensor_manifold(null,"SWITCH_STRIP",
g.CT_TRIGGER,c,function(a){return(a[0]||a[1])&&!a[4]},b);g.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",g.CT_SHOT,c,function(a){return(a[0]||a[1])&&!a[4]&&a[5]},b);g.create_sensor_manifold(null,"SWITCH_PARAM",g.CT_SHOT,c,function(a){return(a[0]||a[1])&&a[4]},function(a,b){var c=Boolean(g.get_sensor_value(a,b,0))?-1:1,d=A[B];d&&(1==c&&d.pg<d.K.length-1?d.pg++:-1==c&&0<d.pg&&d.pg--)});g.create_sensor_manifold(null,"INC_DEC",g.CT_TRIGGER,c,function(a){return(a[2]||a[3])&&!a[4]},a);g.create_sensor_manifold(null,
"INC_DEC_HOLD",g.CT_SHOT,c,function(a){return(a[2]||a[3])&&!a[4]&&a[6]},a);g.create_sensor_manifold(null,"MUTE_SOLO",g.CT_SHOT,c,function(a){return(a[2]||a[3])&&a[4]},function(a,b){if(Boolean(g.get_sensor_value(a,b,2))){var c=A[B];c&&0<=c.mute&&("MASTER"!=c.id?0==c.mute?(c.mute=1,x.mute(c.Ma,!0),1==c.zd&&(c.zd=0,h(c)||t(c))):(c.mute=0,h(c)||x.mute(c.Ma,!1)):0==c.mute?(c.mute=1,x.mute(null,!0)):(c.mute=0,x.mute(null,!1)))}else if((c=A[B])&&0<=c.zd)if(0==c.zd){c.zd=1;x.mute(c.Ma,!1);1==c.mute&&(c.mute=
0);for(var d=0;d<A.length;d++){var e=A[d];e!=c&&0==e.mute&&0==e.zd&&x.mute(e.Ma,!0)}}else c.zd=0,h(c)?x.mute(c.Ma,!0):t(c)});c=g.create_elapsed_sensor();g.create_sensor_manifold(null,"MIXER_DRAW",g.CT_CONTINUOUS,[c],null,function(){if(A[B])for(var a=d(),b=a[0];b<=a[1];b++){var c=A[b];k.draw_mixer_strip(c.id,b==B,b%8,c.K,c.pg,c.mute,c.zd);if(c.Ma&&x.get_filter_params(c.Ma)){x.get_filter_freq_response(c.Ma,y,v,F);for(c=0;c<v.length;c++)v[c]=20*Math.log(v[c])/Math.LN10;k.plot_array("EQ",b%8,v,20,2E4,
-10,10)}}});c=g.create_timer_sensor(1,!0);g.create_sensor_manifold(null,"MIXER_UPDATE",g.CT_TRIGGER,[c],null,function(){for(var a=d(),b=a[0];b<=a[1];b++)l(A[b])})}};b4w.module.npc_ai=function(a,p){function e(a,b){var c=b.destination,d=B;n.get_translation(b.empty,d);var e=y;n.get_translation(b.collider,e);var f=0;b.lj?f=b.lj:b.ef&&(f=b.ef,b.type==w&&(f*=.5),b.type==C&&(f*=a));switch(b.type){case w:if(b.random&&b.Pf){c[0]=(12*Math.random()-6)*b.speed+d[0];c[2]=(12*Math.random()-6)*b.speed+d[2];var k=q,d=v,m=b.speed,p=b.rot_speed;n.get_rotation(b.collider,k);I.transformQuat(x.AXIS_Z,k,d);d[1]=0;I.normalize(d,d);k=.5*m/Math.sin(p/2);m=I.dist(c,e);m<2*k&&I.scaleAndAdd(c,
d,2*k-m,c);b.Pf=!1}c[1]=e[1];f&&(c[1]+=f);break;case J:case C:b.random&&b.Pf&&(b.type==C?(b.speed=Math.random()+.1,k=b.cD-b.iD):k=b.max_height-b.min_height,c[0]=10*Math.random()-5+d[0],c[1]=e[1]+(Math.random()*k-.5*k),c[2]=10*Math.random()-5+d[2],b.Pf=!1),f&&(c[1]=e[1]+f)}var c=B,d=y,m=v,e=D,t=b.rig,k=b.collider,f=b.destination,A=b.speed,Q=b.actions,ha=h.get_current_anim_name(t);if(!h.is_play(t)||!Q.gk||-1==Q.gk.indexOf(ha)){n.get_translation(k,c);var p=f[0]-c[0],aa=f[2]-c[2],p=Math.sqrt(p*p+aa*aa);
if(p>2*A*a)b.state=20,x.xz_direction(f,c,m),Q=b.rig,h.is_animated(Q)&&(t=b.speed,A=h.get_frame(Q),Q=h.get_anim_length(Q),t*=Q/24*(1-A/Q),.9>p/t&&I.scaleAndAdd(f,m,t-p,f)),p=q,t=F,n.get_rotation(b.collider,p),I.transformQuat(x.AXIS_Z,p,d),t[0]=d[0],t[1]=0,t[2]=d[2],I.normalize(t,t),A=I.dot(t,m),Q=a/(Math.abs(Math.acos(A))/Math.PI)*b.rot_speed*b.oq,g.rotationTo(t,m,e),g.rotationTo(x.AXIS_Z,t,p),1<=Math.abs(A)?g.copy(p,e):(g.multiply(e,p,e),g.slerp(p,e,Math.min(Q,1),e)),m=a,b.type!=J&&(m=Math.max(m,
1/60),p=u,t=q,g.setAxisAngle(x.AXIS_X,-Math.asin(d[1]),t),g.setAxisAngle(x.AXIS_X,-Math.atan(b.ef/(b.speed*m)),p),g.slerp(t,p,m,p),g.multiply(e,p,e)),n.set_rotation_v(k,e),d=v,k=F,x.quat_to_dir(e,x.AXIS_Z,d),I.scale(d,b.speed*a,k),I.add(k,c,k),k[1]=b.type!=w?(f[1]-c[1])*a*.1+c[1]:f[1],n.set_translation_v(b.collider,k);else if(b.type==w)Q.move?ha&&-1!=Q.move.indexOf(ha)&&h.is_play(t)?b.state=20:(b.state=10,b.Pf=!0):(b.state=10,b.Pf=!0);else if(b.type==C||b.type==J)b.Pf=!0;if(l(b)&&(c=b.rig,!h.is_play(c))){e=
null;switch(b.state){case 10:e=b.actions;e=e.gk?x.random_from_array(e.gk):null;break;case 20:e=h.get_current_anim_name(b.rig),d=f=b.actions,d.Qe&&-1==d.Qe.indexOf(e)&&d.move&&-1!=d.move.indexOf(e)&&.33<Math.random()?(f=b.actions,e=f.Qe[f.move.indexOf(e)]):(d=b.actions,d.move&&(-1!=d.move.indexOf(e)||!d.Qe&&!d.Df||!d.Df&&!e||d.Qe&&-1!=d.Qe.indexOf(e)||d.Df&&-1!=d.Df.indexOf(e))?(f=b.actions,f.Qe?(d=f.Qe.indexOf(e),-1!=d?(e=d+1,e=e<f.move.length?e:0,e=f.move[e]):e=-1!=f.move.indexOf(e)?e:x.random_from_array(f.move)):
e=x.random_from_array(f.move)):(d=b.actions,e=d.Df&&-1==d.Df.indexOf(e)&&d.move&&-1==d.move.indexOf(e)?x.random_from_array(f.Df):null))}e&&(h.apply(c,e),h.set_behavior(c,h.AB_FINISH_RESET),h.set_frame(c,0),h.play(c))}}}function b(a,b,c,d){if(d)if(1==c)switch(d.type){case J:a:{for(c=0;3>c;c++){var e=t.get_sensor_payload(a,b,c).hit_fract;if(e){b=e;break a}}b=void 0}a=100*b;d.ef=a<d.min_height?10:a>d.max_height?-10:0;break;case w:a=t.get_sensor_payload(a,b,0).hit_fract;d.ef=d.Ou==a?0:1-100*a;d.Ou=a;
break;case C:a=t.get_sensor_payload(a,b,0).hit_fract,"CLOSE_GROUND"==b?(d.ef=100*a-1,d.ef=.1>d.ef?.05:0):"CLOSE_WATER"==b&&(d.lj=100*a,d.lj=d.lj<d.iD?-.02:d.lj>d.cD?.02:0)}else d.ef=0}function c(){for(var a=0;a<A.length;a++){var b=A[a];m(b);f(b);b.rig&&h.get_current_anim_name(b.rig)&&h.play(b.rig)}}function m(a){var c=I.create(),d=a.collider;switch(a.type){case J:var e=t.create_ray_sensor(d,c,[0,-100,0],"TERRAIN",!0),f=t.create_ray_sensor(d,c,[0,-100,0],"STONE",!0),c=t.create_ray_sensor(d,c,[0,-100,
0],"WATER",!0),e=[e,f,c];t.create_sensor_manifold(d,"CLOSE_GROUND",t.CT_CONTINUOUS,e,function(a){return a[0]||a[1]||a[2]},b,a);break;case w:e=t.create_ray_sensor(d,[0,1,0],[0,-99,0],"TERRAIN",!0);e=[e];t.create_sensor_manifold(d,"CLOSE_GROUND",t.CT_CONTINUOUS,e,null,b,a);break;case C:e=t.create_ray_sensor(d,[0,1,0],[0,-99,0],"TERRAIN",!0),c=t.create_ray_sensor(d,c,[0,100,0],"WATER",!0),e=[e],t.create_sensor_manifold(d,"CLOSE_WATER",t.CT_CONTINUOUS,[c],null,b,a),t.create_sensor_manifold(d,"CLOSE_GROUND",
t.CT_CONTINUOUS,e,null,b,a)}}function f(a){function b(c,d,e){1==e?(n.get_translation(a.empty,a.destination),a.oq=4):a.oq=1}var c=a.collider;if(a.type==w){var d=t.create_collision_sensor(c,"CONSTRUCTION",!1);t.create_sensor_manifold(c,"CONSTRUCTION_COLL",t.CT_CONTINUOUS,[d],null,b)}}function l(a){var b=a.rig;if(!h.is_play(b))return!0;b=h.get_current_anim_name(b);if(!b)return!0;var c=a.actions;switch(a.state){case 10:if(!c.gk)return!1;if(-1==c.gk.indexOf(b))break;break;case 20:if(!c.move||-1!=c.move.indexOf(b)||
c.Df&&-1!=c.Df.indexOf(b)||c.Qe&&-1!=c.Qe.indexOf(b))return!1;break;default:return!1}return!0}var h=p("animation"),t=p("controls"),d=p("main"),g=p("quat"),k=p("scenes"),n=p("transform"),x=p("util"),I=p("vec3"),A=[];new Float32Array(9);var B=new Float32Array(3),y=new Float32Array(3),v=new Float32Array(3),F=new Float32Array(3),u=new Float32Array(4),q=new Float32Array(4),D=new Float32Array(4),w=a.NT_WALKING=10,J=a.NT_FLYING=20,C=a.NT_SWIMMING=30;a.new_event_track=function(a){a.destination=new Float32Array(3);
a.start=[];a.ended=[];a.$l=[];a.ef=null;a.Ou=null;a.lj=null;a.Pf=!0;a.oq=1;if(!a.random)for(var b=0;b<a.path.length;b++)a.start[b]=-1,a.ended[b]=!1,a.$l[b]=!1;A.push(a)};a.enable_animation=function(){if(A.length){c();var a=t.create_elapsed_sensor();t.create_sensor_manifold(A[0].collider,"ELAPSED",t.CT_CONTINUOUS,[a],function(a){return a[0]},function(a,b,c){if(1==c)for(a=t.get_sensor_value(a,b,0),b=0;b<A.length;b++){c=A[b];var f=a;if(k.is_visible(c.obj))if(c.random)e(f,c);else{for(var g=d.global_timeline(),
h=0;h<c.path.length;h++)if(!c.ended[h]){c.$l[h]||(c.$l[h]=!0,c.destination[0]=c.path[h][0],c.destination[1]=c.path[h][1],c.destination[2]=c.path[h][2],c.start[h]=g+c.delay[h]);if(g<c.start[h])break;e(f,c);c.ended[h]=c.Pf;break}a:{for(f=0;f<c.path.length;f++)if(0==c.ended[f]){f=!1;break a}f=!0}if(f)for(f=0;f<c.path.length;f++)c.$l[f]=!1,c.ended[f]=!1}}})}};a.disable_animation=function(){if(!(0>=A.length))for(var a=0;a<A.length;a++){var b=A[a];t.check_sensor_manifolds(b.collider)&&t.remove_sensor_manifold(b.collider);
h.is_play(b.rig)&&h.stop(b.rig)}}};b4w.module.mouse=function(a,p){function e(){1==C&&(C=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);n.remove_sensor_manifold(A.get_active_camera(),"SMOOTH_PL")}function b(a){2==C&&(C=0);a.removeEventListener("mousedown",m,!1);a.removeEventListener("mouseup",f,!1);a.removeEventListener("mousemove",c,!1);n.remove_sensor_manifold(A.get_active_camera(),"SMOOTH_DRAG")}function c(a){w()&&(q[0]+=2*(a.clientX-F),q[1]+=
2*(a.clientY-u),F=a.clientX,u=a.clientY);a.preventDefault()}function m(a){F=a.clientX;u=a.clientY;a.currentTarget.addEventListener("mousemove",c,!1);a.preventDefault()}function f(a){a.currentTarget.removeEventListener("mousemove",c,!1);a.preventDefault()}function l(a,b){if(.01<Math.abs(q[0])||.01<Math.abs(q[1])){var c=n.get_sensor_value(a,b,0),d=B.smooth(q[0],0,c,.1*v),e=B.smooth(q[1],0,c,.1*v),c=A.get_first_character(),f=A.get_active_camera();g.rotate_eye_camera(f,4E-4*-d,4E-4*-e);q[0]-=d;q[1]-=
e;c&&(d=g.get_camera_angles_char(f,D),x.set_character_rotation(c,d[0],d[1]))}}function h(){y.detect_mobile()||y.get_canvas_elem().addEventListener("mousemove",d)}function t(){y.detect_mobile()||(y.get_canvas_elem().removeEventListener("mousemove",d),J&&A.set_outline_intensity(J,0))}function d(a){a=k.client_to_canvas_coords(a.clientX,a.clientY,D);(a=A.pick_object(a[0],a[1]))?(A.outlining_is_enabled(a)&&A.set_outline_intensity(a,1),A.outlining_is_enabled(J)&&a!=J&&A.set_outline_intensity(J,0)):A.outlining_is_enabled(J)&&
A.set_outline_intensity(J,0);J=a}var g=p("camera"),k=p("container"),n=p("controls"),x=p("physics"),I=p("print"),A=p("scenes"),B=p("util"),y=p("main"),v=1,F=0,u=0,q=new Float32Array(2),D=new Float32Array(2),w=null,J=null,C=0;a.request_pointerlock=function(a,c,d,e,f){function g(){if(document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a){b(a);a.addEventListener("mousemove",e,!1);var f=A.get_active_camera();if(!n.check_sensor_manifold(f,"SMOOTH_PL")){var h=
n.create_elapsed_sensor();n.create_sensor_manifold(f,"SMOOTH_PL",n.CT_CONTINUOUS,[h],null,l)}c()}else a.removeEventListener("mousemove",e,!1),C=0,document.removeEventListener("pointerlockchange",g,!1),document.removeEventListener("webkitpointerlockchange",g,!1),document.removeEventListener("mozpointerlockchange",g,!1),d()}if(1!=C){C=1;c=c||function(){};d=d||function(){};f=f||function(){return!0};e=e||function(a){if(f()){if("number"==typeof a.movementX){var b=a.movementX;a=a.movementY}else"number"==
typeof a.webkitMovementX?(b=a.webkitMovementX,a=a.webkitMovementY):"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;q[0]+=b;q[1]+=a}};document.addEventListener("pointerlockchange",g,!1);document.addEventListener("webkitpointerlockchange",g,!1);document.addEventListener("mozpointerlockchange",g,!1);var h=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof h?h.apply(a):I.error("Pointer lock is not available")}};a.exit_pointerlock=e;
a.check_pointerlock=function(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)?!0:!1};a.request_mouse_drag=function(a,b){if(2!=C){C=2;e();w=b||function(){return!0};a.addEventListener("mousedown",m,!1);a.addEventListener("mouseup",f,!1);var c=A.get_active_camera();if(!n.check_sensor_manifold(c,"SMOOTH_DRAG")){var d=n.create_elapsed_sensor();n.create_sensor_manifold(c,"SMOOTH_DRAG",n.CT_CONTINUOUS,[d],null,l)}}};a.exit_mouse_drag=b;a.enable_mouse_hover_outline=
h;a.enable_mouse_hover_glow=function(){I.error("enable_mouse_hover_glow() deprecated, use enable_mouse_hover_outline() instead");h()};a.disable_mouse_hover_outline=t;a.disable_mouse_hover_glow=function(){I.error("disable_mouse_hover_glow() deprecated, use disable_mouse_hover_outline() instead");t()};a.get_coords_x=function(a){return"clientX"in a?a.clientX:a.touches&&"clientX"in a.touches[0]?a.touches[0].clientX:-1};a.get_coords_y=function(a){return"clientY"in a?a.clientY:a.touches&&"clientY"in a.touches[0]?
a.touches[0].clientY:-1};a.set_plock_smooth_factor=function(a){v=a};a.get_plock_smooth_factor=function(){return v}};b4w.module.preloader=function(a,p){var e=p("app"),b,c,m,f,l,h,t,d,g,k=null;a.create_simple_preloader=function(a){var d=null,e=null,g="#bf9221",p="#000",t;for(t in a)switch(t){case "canvas_container_id":d=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "bg_color":p=a.bg_color;break;case "bar_color":g=a.bar_color;break;case "preloader_fadeout":b=a.preloader_fadeout}a=document.createElement("div");t=document.createElement("div");a.id="simple_preloader_container";
var v=document.createElement("div"),F=document.createElement("div"),e=document.getElementById(e);k=document.getElementById(d);a.style.cssText="z-index: 4;background-color: "+p+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";t.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";v.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+
g+";border-radius: 0px;";F.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+t.appendChild(v);t.appendChild(F);a.appendChild(t);document.body.appendChild(a);c="SIMPLE";m=a;f=v;l=F;h=e};a.create_rotation_preloader=function(a){var b=null,d=null,e="rgba(0,0,0,0)",f="",g="",p="rgba(0,0,0,0)",F;for(F in a)switch(F){case "canvas_container_id":b=a.canvas_container_id;
break;case "background_container_id":d=a.background_container_id;break;case "frame_bg_color":e=a.frame_bg_color;break;case "bg_color":p=a.bg_color;break;case "frame_class":f=a.frame_class;break;case "anim_elem_class":g=a.anim_elem_class}a=document.createElement("div");F=document.createElement("div");var u=document.createElement("div"),q=document.createElement("div"),d=document.getElementById(d);k=document.getElementById(b);a.style.cssText="z-index: 4;background-color: "+p+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";
F.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+e+";";u.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";q.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";u.className=g;F.appendChild(u);F.className=f;F.appendChild(q);
a.appendChild(F);k.appendChild(a);c="ROTATION";m=a;t=u;l=q;h=d};a.create_advanced_preloader=function(a){var b=a.preloader_width,b=b/(b-a.img_width),e=document.getElementById(a.preloader_bar_id),p=document.getElementById(a.fill_band_id),t=document.getElementById(a.preloader_caption_id),y=document.getElementById(a.preloader_container_id),v=document.getElementById(a.background_container_id);k=document.getElementById(a.canvas_container_id);c="ADVANCED";f=e;d=p;g=b;l=t;m=y;h=v};a.update_preloader=function(a){l.innerHTML=
a+"%";"SIMPLE"==c&&(f.style.width=a+"%");"ADVANCED"==c&&(f.style.width=a/g+"%",d.style.width=100-a+"%");"ROTATION"==c&&(t.style.transform="rotate("+a+"deg)");100==a&&(b?(e.css_animate(h,"opacity",1,0,1500,null,null,function(){h.parentNode.removeChild(h)}),e.css_animate(m,"opacity",1,0,1E3,null,null,function(){m.parentNode.removeChild(m)})):(m.parentNode.removeChild(m),h&&h.parentNode.removeChild(h)))}};b4w.module.storage=function(a,p){function e(a){m=a;if(!f){try{f=window.localStorage;try{f.tmp=null,delete f.tmp}catch(b){c.warn("localStorage quota is limited. Disabling localStorage"),f=null}}catch(e){c.warn("Applying chrome localStorage bug workaround"),f=null}f||(c.warn("localStorage is not available, initializing temporary storage"),f={})}}function b(){return f[m]?JSON.parse(f[m]):{}}var c=p("__print"),m="",f=null;a.init=e;a.set=function(a,c){var e=b();e[a]=String(c);f[m]=JSON.stringify(e)};a.cleanup=
function(){delete f[m]};a.get=function(a){var c=b();return c[a]?c[a]:""};a.debug=function(){c.log(b())};e("b4w")};b4w.module.screenshooter=function(a,p){var e=p("main");a.shot=function(){e.canvas_data_url(function(a){var c=window.document.createElement("a");document.body.appendChild(c);c.style.display="none";c.href=a;c.download="screenshot.png";c.click();document.body.removeChild(c)})}};
