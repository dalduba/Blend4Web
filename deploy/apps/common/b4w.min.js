var b4w=function(a){var q={};a.module=q;var b={};a.register=function(a,b){if(q[a])throw Error('Module "'+a+'" already registered');q[a]=b};a.require=function(a,c){if(!q[a])throw Error('Module "'+a+'" not found');c=c||"__B4W_DEF_NS";b[c]||(b[c]=function(a){return function(c){var d=q[c];if(!d)throw Error('Module "'+c+'" not found');d.Rh||(d.Rh={});d.Rh[a]||(d.Rh[a]={},d(d.Rh[a],b[a]));return d.Rh[a]}}(c));return b[c](a)};a.module_check=function(a){return q[a]?!0:!1};return a}({});"object"==typeof module&&module.hm&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function q(){var a=b,d=a.getDate(),d=10>d?"0"+String(d):String(d),g=a.getMonth()+1,g=10>g?"0"+String(g):String(g),f=String(a.getFullYear()),h=a.getHours(),h=10>h?"0"+String(h):String(h),p=a.getMinutes(),p=10>p?"0"+String(p):String(p),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return d+"."+g+"."+f+" "+h+":"+p+":"+a}var b=new Date(2015,5,30,17,11,2),d=[15,6];a.version=function(){return d};a.version_str=function(){for(var a="",b=0;b<d.length;b++)a=1==b?a+(10>d[b]?
"0"+d[b]:d[b]):a+d[b],b!=d.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.date=function(){return b};a.date_str=q;a.timestamp=function(){var a=q(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.hm&&b4w.module.__version(exports);b4w.module.__config=function(a,q){function b(){return b4w.module_check(a.Tb.Aj)}function d(){for(var b=a.Tb,d=null,e=document.getElementsByTagName("script"),p=0;p<e.length;p++){for(var l=e[p].src,m=0;m<b.cr.length;m++)if(0<=l.indexOf(b.cr[m])){d=l;break}if(null!==d)break}d||(c.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),d=document.location.href);b=d.indexOf("?");0<=b&&(d=d.substring(0,b));return d.substring(0,d.lastIndexOf("/")+1)}var c=q("__print"),
e=q("__util");a.P_LOW=1;a.P_HIGH=2;a.P_ULTRA=3;a.P_CUSTOM=4;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.jw=e.qa(a.context);a.o={alpha_sort:!0,alpha_sort_threshold:.1,Ci:[5,4],Zc:1E4,console_verbose:!1,do_not_load_resources:!1,Uk:!1,gq:1.5,yx:10,background_color:[0,0,0,0],$f:.01,render_resolution_factor:1,canvas_resolution_factor:1,Ok:3,allow_cors:!1,pm:!1,rj:!0,show_hud_debug_info:!1,oD:!0,Vi:!0,anaglyph_use:!1,Ek:!0,Pi:.5,fc:!0,ff:!0,Qg:!0,Xg:!0,Ig:!0,jh:!0,Mg:!0,antialiasing:!0,smaa:!1,
wireframe_debug:!1,ut:!1,Tg:!0,Hi:!0,mb:!0,zk:!0,water_dynamic:!0,shore_smoothing:!0,sh:!0,Kb:1024,Bi:512,ht:!0,precision:"highp",quality:a.P_HIGH,il:!0,nz:!1,us:!1,Rp:!1,ot:!1,Sf:!1,Hl:!1,Rq:!1,Il:!1,IE:!1,Sc:!1,allow_hidpi:!1,gyro_use:!1,cq:!1,Om:!1,enable_selectable:!0,enable_outlining:!0,ee:!0,pr:128,Lm:!1,Uq:!1,mr:!1,cn:[0,0]};a.Yw=e.qa(a.o);a.Nd={Ha:-1,hq:!1,Lf:1};a.controls={lz:1/120};a.Od={dir:"ASSETS=../../assets/",gz:15,Yr:!0,hn:!1,Yl:!1};a.tv=e.qa(a.Od);a.Tb={shaders_dir:"",EA:"include/",
Aj:"built_in_data",cr:["b4w.min.js","b4w.full.min.js","src/b4w.js","USER_DEFINED_MODULE"],ks:"./",smaa_search_texture_path:"",smaa_area_texture_path:""};a.Sa={enabled:!0,Zc:60,$i:"",Bl:!1};a.yz=e.qa(a.Sa);a.Ti={Uj:1024,Fe:384};a.dA=e.qa(a.Ti);a.cd={to:!0,jk:!1,Yo:!1,wp:!1,Sp:!1};a.DA=e.qa(a.cd);a.Fb={outlining_overview_mode:!1,Ue:[1,.4,.05],$c:1,pk:.2,qk:3.8,rk:1};a.Zl={enabled:!1,hB:"MAIN_OPAQUE",gB:0,HA:"COLOR"};a.Uw=e.qa(a.Zl);a.ov=function(){var b=a.o,c=a.Sa,d=a.Ti;switch(b.quality){case a.P_ULTRA:b.Vi=
!0;b.shore_smoothing=!0;b.ff=!0;b.Qg=!0;b.Xg=!0;b.Ig=!0;b.Ek=!0;b.Pi=1;b.fc=!0;b.Tg=!0;b.Hi=!0;b.mb=!0;b.zk=!0;b.render_resolution_factor=1.75;d.Uj=2048;b.Ok=3;b.rj=!0;b.Uk=!1;b.precision="highp";b.water_dynamic=!0;b.sh=!0;b.antialiasing=!0;b.smaa=!0;b.Mg=!0;b.jh=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.ee=!0;c.Zc=120;break;case a.P_HIGH:b.Vi=!0;b.shore_smoothing=!0;b.ff=!0;b.Qg=!0;b.Xg=!0;b.Ig=!0;b.Ek=!0;b.Pi=.5;b.fc=!0;b.Tg=!0;b.Hi=!0;b.mb=!0;b.zk=!0;b.render_resolution_factor=1;d.Uj=1024;b.Ok=
3;b.rj=!0;b.Uk=!1;b.precision="highp";b.water_dynamic=!0;b.sh=!0;b.antialiasing=!0;b.smaa=!1;b.Mg=!0;b.jh=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.ee=!0;c.Zc=60;break;case a.P_LOW:b.Vi=!1,b.shore_smoothing=!1,b.ff=!1,b.Qg=!1,b.Xg=!1,b.Ig=!1,b.Ek=!1,b.Pi=.5,b.fc=!1,b.Tg=!1,b.Hi=!1,b.mb=!1,b.zk=!1,b.render_resolution_factor=1,d.Uj=512,b.Ok=2,b.rj=!1,b.Uk=!0,b.precision="mediump",b.water_dynamic=!1,b.sh=!1,b.antialiasing=!1,b.smaa=!1,b.Mg=!1,b.jh=!1,b.allow_hidpi=!1,b.enable_outlining=!1,b.ee=!1,
c.Zc=60}};a.set=function(b,d){switch(b){case "allow_cors":a.o.allow_cors=d;break;case "allow_hidpi":a.o.allow_hidpi=d;break;case "alpha":a.context.alpha=d;break;case "alpha_sort":a.o.alpha_sort=d;break;case "alpha_sort_threshold":a.o.alpha_sort_threshold=d;break;case "anaglyph_use":a.o.anaglyph_use=d;break;case "animation_framerate":a.Nd.Ha=d;break;case "antialiasing":a.o.antialiasing=d;break;case "assets_dds_available":a.Od.Yl=d;break;case "assets_min50_available":a.Od.hn=d;break;case "audio":a.cd.to=
d;break;case "background_color":a.o.background_color=d;break;case "built_in_module_name":a.Tb.Aj=d;break;case "canvas_resolution_factor":a.o.canvas_resolution_factor=d;break;case "console_verbose":a.o.console_verbose=d;break;case "do_not_load_resources":a.o.do_not_load_resources=d;break;case "gyro_use":a.o.gyro_use=d;break;case "physics_enabled":a.Sa.enabled=d;break;case "physics_uranium_path":a.Sa.$i=d;break;case "physics_calc_fps":a.Sa.Bl=d;break;case "precision":a.o.precision=d;break;case "quality":a.o.quality=
d;break;case "render_resolution_factor":a.o.render_resolution_factor=d;break;case "sfx_mix_mode":a.cd.jk=d;break;case "shaders_dir":a.Tb.shaders_dir=d;break;case "show_hud_debug_info":a.o.show_hud_debug_info=d;break;case "smaa":a.o.smaa=d;break;case "smaa_search_texture_path":a.Tb.smaa_search_texture_path=d;break;case "smaa_area_texture_path":a.Tb.smaa_area_texture_path=d;break;case "wireframe_debug":a.o.wireframe_debug=d;break;case "enable_selectable":a.o.enable_selectable=d;break;case "enable_outlining":a.o.enable_outlining=
d;break;case "outlining_overview_mode":a.Fb.outlining_overview_mode=d;break;case "glow_materials":a.o.ee=d;break;default:c.error("Unknown config property: "+b)}};a.get=function(b){switch(b){case "allow_cors":return a.o.allow_cors;case "allow_hidpi":return a.o.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.o.alpha_sort;case "alpha_sort_threshold":return a.o.alpha_sort_threshold;case "anaglyph_use":return a.o.anaglyph_use;case "animation_framerate":return a.Nd.Ha;case "antialiasing":return a.o.antialiasing;
case "assets_dds_available":return a.Od.Yl;case "assets_min50_available":return a.Od.hn;case "audio":return a.cd.to;case "background_color":return a.o.background_color;case "built_in_module_name":return a.Tb.Aj;case "canvas_resolution_factor":return a.o.canvas_resolution_factor;case "console_verbose":return a.o.console_verbose;case "do_not_load_resources":return a.o.do_not_load_resources;case "gyro_use":return a.o.gyro_use;case "physics_enabled":return a.Sa.enabled;case "physics_uranium_path":return a.Sa.$i;
case "physics_calc_fps":return a.Sa.Bl;case "precision":return a.o.precision;case "quality":return a.o.quality;case "render_resolution_factor":return a.o.render_resolution_factor;case "sfx_mix_mode":return a.cd.jk;case "shaders_dir":return a.Tb.shaders_dir;case "show_hud_debug_info":return a.o.show_hud_debug_info;case "smaa":return a.o.smaa;case "smaa_search_texture_path":return a.Tb.smaa_search_texture_path;case "smaa_area_texture_path":return a.Tb.smaa_area_texture_path;case "wireframe_debug":return a.o.wireframe_debug;
case "enable_selectable":return a.o.enable_selectable;case "enable_outlining":return a.o.enable_outlining;case "outlining_overview_mode":return a.Fb.outlining_overview_mode;case "glow_materials":return a.o.ee;default:c.error("Unknown config property: "+b)}};a.reset=function(){a.context=e.qa(a.jw);a.o=e.qa(a.Yw);a.Od=e.qa(a.tv);a.Sa=e.qa(a.yz);a.Ti=e.qa(a.dA);a.cd=e.qa(a.DA);a.Zl=e.qa(a.Uw)};a.Ly=b;a.tA=function(){var c=a.Tb,e=a.Sa;b()||""!=c.shaders_dir||(c.shaders_dir=d()+"../shaders/");if(b())c.smaa_search_texture_path=
"smaa_search_texture.png",c.smaa_area_texture_path="smaa_area_texture.png";else if(""==c.smaa_search_texture_path||""==c.smaa_area_texture_path){var h=d()+c.ks;c.smaa_search_texture_path=c.smaa_search_texture_path||h+"smaa_search_texture.png";c.smaa_area_texture_path=c.smaa_area_texture_path||h+"smaa_area_texture.png"}e.enabled&&""==e.$i&&(h=d()+c.ks,e.$i=h+"uranium.js")};a.get_std_assets_path=function(){return a.Od.dir.replace("ASSETS=","")}};b4w.module.__anchors=function(a,q){function b(a,b){var k=document.createElement("div"),f=k.style;f.position="absolute";f.backgroundColor="black";f.borderRadius="20px 20px 20px 0px";f.boxShadow="0px 0px 10px rgb(180, 180, 200)";f.opacity=1;f.padding="8px 12px";f.lineHeight="15px";f.visibility="hidden";f.fontSize="12px";var g=p.get_container();g.appendChild(k);var r=l.get_meta_tags(a),m=document.createElement("span"),h=m.style;m.innerHTML=r.title||a.name;h.fontWeight="bold";h.fontSize="12px";h.lineHeight=
"15px";h.color="#fff";h.fontFamily="Arial";e(m);k.appendChild(m);var z=r.description;if(z){var r=document.createElement("div"),N=r.style;N.position="absolute";N.bottom="0px";N.left="0px";N.backgroundColor="#000";N.borderRadius="20px 20px 20px 0px";N.boxShadow="0px 0px 10px rgb(180, 180, 200)";N.visibility="hidden";N.padding="8px 12px";N.overflow="hidden";N.lineHeight="15px";N.fontSize="12px";N.zIndex="2";k.appendChild(r);var H=document.createElement("span"),K=H.style;H.innerHTML=z;K.fontSize="12px";
K.fontFamily="Arial";K.fontWeight="bold";K.lineHeight="15px";K.color="#fff";K.visibility="hidden";r.appendChild(H);var n=!1,t=!1;g.addEventListener("click",function(a){if(!(n||t||v))if(a.target!=m&&a.target!=k||"hidden"!=N.visibility||1!=f.opacity)"visible"==N.visibility&&(f.visibility="visible",h.visibility="visible",N.visibility="hidden",K.visibility="hidden");else{f.visibility="hidden";h.visibility="hidden";N.visibility="visible";n=t=!0;a=k.offsetWidth-24;var H=k.offsetHeight-16,e=Math.min(b,d(z)),
l=c(z,e);l==H&&(N.height=l+"px");e!=a?y.animate(a,e,200,function(a){a==e&&("visible"==N.visibility&&(K.visibility="visible"),n=!1);N.width=a+"px"}):n=!1;l!=H?y.animate(H,l,200,function(a){a==l&&("visible"==N.visibility&&(K.visibility="visible"),t=!1);N.height=a+"px"}):t=!1;t||n||(K.visibility="visible")}},!1)}return k}function d(a){var b=document.createElement("div"),c=document.createElement("span"),d=b.style;c.innerHTML=a;c.style.fontSize="12px";c.style.fontFamily="Arial";c.style.fontWeight="bold";
c.style.color="#fff";c.style.visibility="hidden";d.lineHeight="15px";b.appendChild(c);d.position="absolute";d.visibility="hidden";d.fontSize="12px";d.display="inline-block";d.lineHeight="15px";document.body.appendChild(b);a=b.offsetWidth+1;document.body.removeChild(b);return a}function c(a,b){var c=document.createElement("div"),d=document.createElement("span"),e=c.style;d.innerHTML=a;d.style.fontSize="12px";d.style.fontFamily="Arial";d.style.fontWeight="bold";d.style.color="#fff";d.style.visibility=
"hidden";e.lineHeight="15px";c.appendChild(d);e.position="absolute";e.visibility="hidden";e.fontSize="12px";e.display="inline-block";e.width=b+"px";e.lineHeight="15px";document.body.appendChild(c);d=c.offsetHeight;document.body.removeChild(c);return d}function e(a){a.style["-webkit-touch-callout"]="none";a.style["-webkit-user-select"]="none";a.style["-khtml-user-select"]="none";a.style["-moz-user-select"]="none";a.style["-ms-user-select"]="none";a.style["user-select"]="none";a.style.cursor="default"}
function g(){for(var a=0,b=0;b<E.length;b++)E[b].am&&a++;x=new Float32Array(3*a)}var f=q("__batch"),h=q("__camera"),p=q("__container"),l=q("__objects"),m=q("__print"),r=q("__renderer"),n=q("__scenes"),y=q("__time");q("__util");q("__config");var v=!1,E=[],x=new Float32Array(0),u=new Uint8Array(16),B=new Float32Array(2),t=new Float32Array(3);a.append=function(a){var c;a:{for(c=0;c<E.length;c++)if(E[c].obj==a){c=!0;break a}c=!1}if(!c){c=a.b4w_anchor.detect_visibility&&Boolean(n.ca(n.Wg(),"ANCHOR_VISIBILITY"));
c={type:a.b4w_anchor.type,obj:a,x:0,y:0,depth:0,Gg:"out",am:c,element:null,kh:null,Wu:a.b4w_anchor.max_width,Ro:0};switch(c.type){case "ANNOTATION":c.element=b(a,c.Wu);c.Ro=c.element.offsetHeight;break;case "ELEMENT":c.element=document.getElementById(a.b4w_anchor.element_id),c.element||(m.warn("Anchor HTML element was not found, making it generic"),c.type="GENERIC")}E.push(c);g()}};a.remove=function(a){for(var b=0;b<E.length;b++){var c=E[b];if(c.obj==a){"ANNOTATION"==c.type&&(a=c,p.get_container().removeChild(a.element));
E.splice(b,1);g();break}}};a.update=function(){for(var a=0,b=0,c=E.length;b<c;b++){var d=E[b];d.am&&(x.set(d.obj.d.h,3*a),a++);var e,l=d,g=t;e=n.Rj(n.Wg());e=g=h.project_point(e,l.obj.d.h,g);l=e[0];g=e[1];e=e[2];if(l!=d.x||g!=d.y||e!=d.depth){switch(d.type){case "ANNOTATION":var r=d.element;r.style.left=Math.floor(l)+"px";r.style.top=Math.floor(g-d.Ro)+"px";break;case "ELEMENT":r=d.element,r.style.left=Math.floor(l-r.offsetWidth/2)+"px",r.style.top=Math.floor(g-r.offsetHeight/2)+"px"}d.x=l;d.y=g;
d.depth=e;d.kh&&d.kh(l,g,d.Gg,d.obj,r)}}0<a&&(a=n.ca(n.Wg(),"ANCHOR_VISIBILITY").p[0].B,f.vB(a,x))};a.QB=function(){for(var a=p.get_container(),b=0;b<E.length;b++){var c=E[b],d=c.obj,e=c.x,f=c.y,l=c.depth,l=0>e||0>f||0>l||1<l||n.is_hidden(d)||e>=a.clientWidth||f>=a.clientHeight?"out":"visible";if(c.am&&"out"!=l){var l=c,g=n.ca(n.Wg(),"ANCHOR_VISIBILITY").i,z=p.El(l.x,l.y,B,g);r.fs(g.be,z[0],g.height-z[1],2,2,u);l=1020==u[0]+u[4]+u[8]+u[12]?"visible":"out"==l.Gg||0==u[0]+u[4]+u[8]+u[12]?"covered":
l.Gg}if(l!=c.Gg){switch(c.type){case "ANNOTATION":case "ELEMENT":var N=c.element;if(!N)break;"out"==l?(N.style.visibility="hidden",N.children.length&&(N.children[0].style.visibility="hidden"),"ANNOTATION"==c.type&&1<N.children.length&&(g=N.children[1],g.style.visibility="hidden",g.children.length&&(g.children[0].style.visibility="hidden"))):"visible"==l?(N.style.visibility="visible",N.children.length&&(N.children[0].style.visibility="visible"),N.style.opacity=1):(N.style.visibility="visible",N.style.opacity=
.1,N.children.length&&(N.children[0].style.visibility="visible"),"ANNOTATION"==c.type&&1<N.children.length&&(g=N.children[1],g.style.visibility="hidden",g.children.length&&(g.children[0].style.visibility="hidden")))}c.Gg=l;c.kh&&c.kh(e,f,c.Gg,d,N)}}};a.attach_move_cb=function(a,b){for(var c=0;c<E.length;c++)E[c].obj==a&&(E[c].kh=b)};a.detach_move_cb=function(a){for(var b=0;b<E.length;b++)E[b].obj==a&&(E[b].kh=null)};a.cleanup=function(){for(var a=0;a<E.length;a++){var b=E[a];"ANNOTATION"==b.type&&
p.get_container().removeChild(b.element)}E.length=0};a.is_anchor=function(a){return a.b4w_anchor?!0:!1};a.get_element_id=function(a){return a.b4w_anchor&&a.b4w_anchor.element_id?a.b4w_anchor.element_id:!1};a.pause=function(){v=!0};a.resume=function(){v=!1}};b4w.module.__boundings=function(a,q){function b(a,b){for(var c=a[0],d=a[1],e=a[2],f=a[0],l=a[1],g=a[2],m=3;m<a.length;m+=3)var h=a[m],p=a[m+1],k=a[m+2],c=Math.max(c,h),d=Math.max(d,p),e=Math.max(e,k),f=Math.min(f,h),l=Math.min(l,p),g=Math.min(g,k);b.max_x=c;b.max_y=d;b.max_z=e;b.min_x=f;b.min_y=l;b.min_z=g;return b}function d(a,b){b||(b=new Float32Array(24));var c=a.max_x,d=a.max_y,e=a.max_z,f=a.min_x,l=a.min_y,g=a.min_z;b[0]=f;b[1]=l;b[2]=g;b[3]=c;b[4]=l;b[5]=g;b[6]=c;b[7]=d;b[8]=g;b[9]=f;b[10]=
d;b[11]=g;b[12]=f;b[13]=l;b[14]=e;b[15]=c;b[16]=l;b[17]=e;b[18]=c;b[19]=d;b[20]=e;b[21]=f;b[22]=d;b[23]=e;return b}function c(a,b,c){f.add(b,c,a.F);f.scale(a.F,.5,a.F);a.Da=f.distance(a.F,b);return a}var e=q("__util"),g=q("__tsr"),f=q("vec3"),h=new Float32Array(24),p=new Float32Array(3),l=new Float32Array(3),m=new Float32Array(3);a.Ep=function(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z};a.XC=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,
min_y:-1E12,max_z:1E12,min_z:-1E12}};a.Gd=function(a){a||(a={});a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0;return a};a.Wp=function(a,b){var c=a.max_y,d=a.max_z,e=a.min_x,f=a.min_y,l=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,d);a.min_x=Math.min(b.min_x,e);a.min_y=Math.min(b.min_y,f);a.min_z=Math.min(b.min_z,l)};a.Av=b;a.xl=function(c,f,l){l||(l=a.Gd());c=d(c,h);e.We(c,f,c);return b(c,l)};a.rx=d;a.HE=function(b,c,d){d||(d=a.Gd());
var e=c.min_x,f=c.max_x,l=c.min_y,g=c.max_y,m=c.min_z;c=c.max_z;if(e>=b.max_x||f<=b.min_x||l>=b.max_y||g<=b.min_y||m>=b.max_z||c<=b.min_z)return d.min_x=-.1,d.max_x=.1,d.min_y=-.1,d.max_y=.1,d.min_z=-.2,d.max_z=-.1,d;d.min_x=Math.max(b.min_x,e);d.max_x=Math.min(b.max_x,f);d.min_y=Math.max(b.min_y,l);d.max_y=Math.min(b.max_y,g);d.min_z=Math.max(b.min_z,m);d.max_z=Math.min(b.max_z,c);return d};a.LE=function(b,c,d){d||(d=a.Gd());var e=b.max_x-b.min_x,f=b.max_y-b.min_y,l=b.max_z-b.min_z;d.min_x=b.min_x-
.5*(c-1)*e;d.max_x=b.max_x+.5*(c-1)*e;d.min_y=b.min_y-.5*(c-1)*f;d.max_y=b.max_y+.5*(c-1)*f;d.min_z=b.min_z-.5*(c-1)*l;d.max_z=b.max_z+.5*(c-1)*l;return d};a.zl=function(b,c,d){d||(d=a.fj());f.transformMat4(b.F,c,d.F);d.Da=b.Da*e.fn(c);return d};a.yl=function(a,b,c){c||(c={vf:new Float32Array(3),wf:new Float32Array(3),xf:new Float32Array(3),F:new Float32Array([0,0,0])});g.transform_vec3(a.F,b,c.F);f.copy(a.vf,c.vf);f.copy(a.wf,c.wf);f.copy(a.xf,c.xf);g.transform_dir_vec3(c.vf,b,c.vf);g.transform_dir_vec3(c.wf,
b,c.wf);g.transform_dir_vec3(c.xf,b,c.xf);return c};a.Rl=function(a,b){return{Da:a,F:new Float32Array(b)}};a.fj=function(){return{F:new Float32Array([0,0,0]),Da:0}};a.Ql=function(a,b,c,d){return{vf:new Float32Array(a),wf:new Float32Array(b),xf:new Float32Array(c),F:new Float32Array([d[0],d[1],d[2]])}};a.Cv=function(){return{F:new Float32Array([0,0,0]),Da:1E12}};a.nx=function(a,b){var c=f.subtract(b.F,a.F,f.create());0==f.length(c)&&f.set(1,0,0,c);var d=f.normalize(c,f.create()),c=f.scale(d,a.Da,f.create());
f.add(c,a.F,c);var e=f.scale(d,-a.Da,f.create());f.add(e,a.F,e);var l=f.scale(d,b.Da,f.create());f.add(l,b.F,l);var g=f.scale(d,-b.Da,f.create());f.add(g,b.F,g);c=[c,e,l,g];d=f.normalize(d,f.create());e=c[0];l=c[0];for(g=1;g<c.length;g++){var m=f.dot(c[g],d);m<f.dot(e,d)&&(e=c[g]);m>f.dot(l,d)&&(l=c[g])}d=[e,l];c=d[0];d=d[1];a.F=f.scale(f.add(c,d,f.create()),.5,f.create());a.Da=f.length(f.subtract(d,c,f.create()))/2};a.Fp=function(a,b){var c=b.max_y,d=b.min_y,e=Math.max(0,c-d-2*a);return{Da:a,height:e,
F:new Float32Array([0,(c+d)/2,0])}};a.Hp=function(a,b){var c=b.max_y,d=b.min_y,e=Math.max(0,c-d);return{Da:a,height:e,F:new Float32Array([0,(c+d)/2,0])}};a.Gp=function(a,b){var c=b.max_y,d=b.min_y,e=Math.max(0,c-d);return{Da:a,height:e,F:new Float32Array([0,(c+d)/2,0])}};a.aD=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.Kz=function(a){for(var b=0,c=0,d=0,e=0,f=0,l=0,g=0,m=0,h=0;h<a.submeshes.length;h++){var p=
a.submeshes[h];if(p.position.length){b=e=p.position[0];c=f=p.position[1];d=l=p.position[2];break}}for(h=0;h<a.submeshes.length;h++)for(var p=a.submeshes[h],p=p.position,k=0;k<p.length/3;k++)var I=p[3*k],F=p[3*k+1],L=p[3*k+2],b=Math.max(I,b),c=Math.max(F,c),d=Math.max(L,d),e=Math.min(I,e),f=Math.min(F,f),l=Math.min(L,l),g=Math.max(Math.sqrt(I*I+F*F+L*L),g),m=Math.max(Math.sqrt(I*I+L*L),m);a.b4w_bounding_box.max_x=b;a.b4w_bounding_box.min_x=e;a.b4w_bounding_box.max_y=c;a.b4w_bounding_box.min_y=f;a.b4w_bounding_box.max_z=
d;a.b4w_bounding_box.min_z=l;a.b4w_bounding_box_source.max_x=b;a.b4w_bounding_box_source.min_x=e;a.b4w_bounding_box_source.max_y=c;a.b4w_bounding_box_source.min_y=f;a.b4w_bounding_box_source.max_z=d;a.b4w_bounding_box_source.min_z=l;a.b4w_bounding_sphere_radius=g;a.b4w_bounding_cylinder_radius=m};a.hy=function(b){var d=b.subarray(0,3),g=b.subarray(6,9),h=b.subarray(12,15),E=b.subarray(18,21);b=f.subtract(g,d,p);f.normalize(b,b);var x=e.jy(d,g,h,l),x=f.cross(x,b,x);f.normalize(x,x);var u=f.create(),
B=f.create();f.subtract(g,d,m);B[0]=f.dot(m,b);B[1]=f.dot(m,x);g=f.create();f.subtract(h,d,m);g[0]=f.dot(m,b);g[1]=f.dot(m,x);h=f.create();f.subtract(E,d,m);h[0]=f.dot(m,b);h[1]=f.dot(m,x);E=a.fj();h=[u,B,g,h];u=c(E,h[0],h[1]);for(E=2;E<h.length;E++)if(f.distance(u.F,h[E])>u.Da){for(var t=u,u=h,B=h[E],g=E-1,t=c(t,B,u[0]),G=1;G<=g;G++)if(f.distance(t.F,u[G])>t.Da){for(var A=t,t=u,k=B,I=u[G],F=G-1,A=c(A,k,I),L=0;L<=F;L++)if(f.distance(A.F,t[L])>A.Da){var J=k,P=I,z=t[L],N=f.subtract(P,z,m),N=f.squaredLength(N),
H=f.subtract(J,z,m),K=f.squaredLength(H),H=f.subtract(J,P,m),O=f.squaredLength(H),H=N*(K+O-N),X=K*(O+N-K),N=O*(N+K-O),K=H+X+N;f.copy(J,A.F);f.scale(A.F,H/K,A.F);f.scaleAndAdd(A.F,P,X/K,A.F);f.scaleAndAdd(A.F,z,N/K,A.F);A.Da=f.distance(A.F,J)}t=A}u=t}E=u;b=f.scale(b,E.F[0],m);f.scaleAndAdd(b,x,E.F[1],b);f.add(b,d,E.F);return E}};b4w.module.__compat=function(a,q){function b(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function d(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function c(){return!window.ActiveXObject&&"ActiveXObject"in window}var e=q("__config"),g=q("__extensions"),f=q("__print");
q("__util");a.cx=function(a){a.getError()==a.INVALID_ENUM&&f.warn("Possible Tegra invalid enum issue detected, ignoring")};a.nA=function(a){var p=e.Nd,l=e.o,m=e.context,r=e.Ti,n=e.cd;l.pr=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS);l.Kb=a.getParameter(a.MAX_TEXTURE_SIZE);l.Bi=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE);var y=Boolean(g.cy());b("Firefox/28.0")&&(b("Linux")||b("Macintosh"))&&(f.warn("Firefox 28 detected, applying depth hack"),y=!1);b("iPad")||b("iPhone")?(f.warn("iOS detected, applying alpha hack, applying vertex animation mix normals hack, applying ios depth hack and disable smaa. Disable ssao for performance. Disable video textures. Initialize WebAudio context with empty sound."),
m.alpha||(l.background_color[3]=1),l.ot=!0,l.smaa=!1,l.ff=!1,l.precision="highp",l.Rq=!0,l.Uq=!0):b("Mac OS X")&&b("Safari")&&!b("Chrome")&&(f.warn("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures."),n.Yo=!0,n.wp=!0);b("Windows")&&(b("Chrome/40")||b("Firefox/33")||b("Firefox/34")||b("Firefox/35")||b("Firefox/36"))&&(f.warn("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),l.Il=!0);b("Mac OS X")&&(f.warn("OS X detected, disable texture reusing."),
l.mr=!0,l.ee=!1);d()&&(f.warn("Mobile detected, applying various hacks for video textures."),l.Sf=!0,b("iPad")||b("iPhone")||(f.warn("Mobile (not iOS) detected, disable playback rate for video textures."),n.Sp=!0));(b("Firefox/35.0")||b("Firefox/36.0"))&&b("Windows")&&(f.warn("Windows/Firefox 35/36 detected, applying shadows slink hack"),l.cq=!0);if(b("iPhone")||c())f.warn("iPhone or IE11 detected. Enable sequential video fallback for video textures."),l.Sc=!0;10>a.getParameter(a.MAX_VARYING_VECTORS)&&
(f.warn("Not enough varyings, disable shadows on blend objects"),l.Rp=!0);if(m=g.xq())b("Macintosh")&&-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Intel HD Graphics 3000")&&(f.warn("OS X / Intel HD 3000 detected, applying depth hack"),y=!1),b("Windows")&&b("Chrome")&&-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Intel")&&(f.warn("Chrome / Windows / Intel GPU detected, applying cubemap mipmap/rgb hack"),l.Om=!0),-1<a.getParameter(m.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Mali-400")&&
(f.warn("ARM Mali-400 detected, applying depth and frames blending hacks"),y=!1,p.hq=!0),-1<a.getParameter(m.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Mali-T604")&&(f.warn('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),l.precision="highp",l.Vi=!1),-1<a.getParameter(m.UNMASKED_VENDOR_WEBGL).indexOf("ARM")&&-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Mali-T760")&&(f.warn('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),
l.precision="highp",l.ff=!1),-1<a.getParameter(m.UNMASKED_VENDOR_WEBGL).indexOf("Qualcomm")&&-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Adreno")&&(f.warn("Qualcomm Adreno detected, applying shader constants hack."),l.us=!0,-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("305")&&(f.warn('Qualcomm Adreno305 detected, set "highp" precision.'),l.precision="highp"),-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("330")&&(f.warn('Qualcomm Adreno330 detected, set "highp" precision.'),
l.precision="highp")),-1<a.getParameter(m.UNMASKED_VENDOR_WEBGL).indexOf("NVIDIA")&&-1<a.getParameter(m.UNMASKED_RENDERER_WEBGL).indexOf("Tegra 3")&&(f.warn("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),l.pm=!0);0==a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS)&&(f.warn("Vertex textures are not allowed. Disabling vertex textures"),l.il=!1);l.allow_hidpi&&1<window.devicePixelRatio&&(f.log("%cENABLE HIDPI MODE","color: #00a"),l.render_resolution_factor=1,l.smaa=!1);
y||(l.Tg=!1,l.Hi=!1,l.mb=!1,l.water_dynamic=!1,l.shore_smoothing=!1,l.sh=!1,l.smaa=!1);l.ht=Boolean(g.yq());l.gi=y;0===a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision&&(l.precision="mediump");c()&&(f.warn("IE11 detected. Set sky cubemap texture size to 512 (power of two)."),r.Fe=512);c()&&b("Touch")&&(f.warn("IE11 and touchscreen detected. Behaviour of the mouse move sensor will be changed."),l.Lm=!0);128>=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS)&&(f.warn("Not enough fragment uniforms, force low quality for B4W_LEVELS_OF_QUALITY nodes."),
l.pm=!0);b("Chrome")&&(f.log("Chrome detected. Some of deprecated functions related to the Doppler effect won't be called."),l.Hl=!0)};a.detect_mobile=d;a.mv=function(){b("Firefox/35.0")&&b("Windows")&&(f.warn("Windows/Firefox 35 detected, forcing context's alpha"),e.context.alpha=!0)};a.Qm=c};b4w.module.__constraints=function(a,q){function b(a){var b={};b.type=a;return b}function d(a,b){a.Wa&&a.Wa.N&&e(a.Wa.N,a);b.N&&c(b.N,a);a.Wa=b}function c(a,b){if(-1==a.Ic.indexOf(b))a.Ic.push(b);else throw"Descendant object override is forbidden";}function e(a,b){var c=a.Ic.indexOf(b);if(-1!=c)a.Ic.splice(c,1);else throw"No descendant object";}function g(a,b,c){switch(b.type){case 1:var d=a.d.quat,k=b.N.d.T;c=b.N.d.quat;b.gc?(y.copy(b.gc,d),y.multiply(c,d,d)):y.copy(c,d);n.transformMat4(b.offset,
k,a.d.h);a.d.scale=b.Fk*b.N.d.scale;break;case 9:var e=a.d.h,d=a.d.quat,k=b.N.d.T;c=b.N.d.quat;y.multiply(y.invert(b.lg,b.lg),d,d);y.multiply(c,d,d);n.transformMat4(b.offset,k,e);y.copy(c,b.lg);break;case 10:e=a.d.h;d=a.d.quat;k=b.N.d.T;c=b.N.d.quat;y.multiply(y.invert(b.lg,b.lg),d,d);y.multiply(c,d,d);n.transformMat4(b.offset,k,e);y.copy(c,b.lg);e=a.d.quat;d=y.multiply(b.N.d.quat,b.gc,A);d=r.pq(d,E);e=r.pq(e,x);r.rotate_eye_camera(a,m.De(e[0],d[0]+b.$v,d[0]+b.Zv),m.De(e[1],d[1]+b.Yv,d[1]+b.aw));
break;case 12:var e=a.d.h,d=a.d.quat,k=b.N.d.T,g=b.N.d.h,t=b.JA,B=u,F=A;n.transformMat4(b.offset,k,B);m.smooth_v(B,e,c,t,e);k=u;n.sub(g,e,k);n.normalize(k,k);var q=d,e=L,g=e.subarray(0,3),B=e.subarray(3,6),qa=e.subarray(6,9);n.copy(k,B);n.negate(B,B);n.normalize(B,B);Boolean(.999999<Math.abs(n.dot(k,m.AXIS_Y)))?(k=v.fromQuat(y.normalize(q,F),J),n.copy(k.subarray(0,3),g)):n.cross(m.AXIS_Y,B,g);n.normalize(g,g);n.cross(g,B,qa);n.normalize(qa,qa);y.fromMat3(e,F);y.normalize(F,F);m.Ds(F,d,c,.16*t,d);
break;case 2:d=a.d.quat;e=G;c=A;p(b.N,b.Hv,!0,e,c);b.gc?(y.copy(b.gc,d),y.multiply(c,d,d)):y.copy(c,d);a.d.scale=b.Fk*e[3];m.transform_vec3(b.offset,e[3],c,e,a.d.h);break;case 3:e=a.d.h;d=a.d.quat;c=b.N.d.h;f(e,d,c);break;case 4:e=a.d.h;d=a.d.quat;c=b.target;f(e,d,c);break;case 5:e=a.d.h;d=a.d.quat;c=b.N.d.h;f(e,d,c);d=n.dist(e,c);if(d=d>b.dist_max?d-b.dist_max:d<b.hi?d-b.hi:0)n.sub(c,e,u),n.normalize(u,u),n.scale(u,d,u),n.add(e,u,e);break;case 6:e=a.d.h;d=a.d.quat;c=b.target;f(e,d,c);d=n.dist(e,
c);if(d=d>b.dist_max?d-b.dist_max:d<b.hi?d-b.hi:0)n.sub(c,e,u),n.normalize(u,u),n.scale(u,d,u),n.add(e,u,e);break;case 7:k=b.N.d.T;n.transformMat4(b.offset,k,a.d.h);break;case 8:g=b.N.d.h;e=a.d.h;n.add(g,b.offset,e);break;case 13:d=a.d.quat;k=b.N.d.T;c=b.N.d.quat;b.gc?(y.copy(b.gc,d),y.multiply(c,d,d)):y.copy(c,d);n.transformMat4(b.offset,k,a.d.h);break;case 11:e=b.N.d;c=l.create_sep(e.h,e.scale,e.quat,I);l.multiply(c,b.$s,c);e=a.d.h;e[0]=c[0];e[1]=c[1];e[2]=c[2];a.d.scale=c[3];d=a.d.quat;d[0]=c[4];
d[1]=c[5];d[2]=c[6];d[3]=c[7];break;case 14:c=b.N,d=r.fy(c),e=a.d.h,t=r.Sj(d,"TOP"),F=r.Sj(d,"BOTTOM"),k=t-F,b.ir?(g=r.Sj(d,"LEFT"),e[0]=g+k*b.Ym):(g=r.Sj(d,"RIGHT"),e[0]=g-k*b.Ym),e[2]=b.Ys?-(t-k*b.ao):-(F+k*b.ao),r.Ty(d)?e[1]=-b.distance:(e[1]=-1,n.normalize(e,e),n.scale(e,b.distance/Math.abs(e[1]),e)),l.transform_dir_vec3(e,c.d.Ab,e),n.add(c.d.h,e,e),d=a.d.quat,b.gc?(y.copy(b.gc,d),y.multiply(c.d.quat,d,d)):y.copy(c.d.quat,d)}"CAMERA"==a.d.type&&(e=m.AXIS_Y,10==b.type&&(c=b.N.d.quat,e=n.transformQuat(e,
c,P)),r.io(a),h(a,e))}function f(a,b,c){var d=u;m.quat_to_dir(b,m.AXIS_MY,d);n.normalize(d,d);var e=B;n.subtract(c,a,e);n.normalize(e,e);a=m.$z(d,e,G);y.multiply(a,b,b);y.normalize(b,b)}function h(a,b){var c=a.d,d=c.quat,e=m.quat_to_dir(c.quat,m.AXIS_Y,u);n.normalize(e,e);if(.999999<Math.abs(n.dot(b,e)))e=y.identity(A);else{var k=n.cross(b,e,B);n.normalize(k,k);if(c.ua==r.MS_TARGET_CONTROLS)c.Xn&&n.negate(k,k);else{var f=m.quat_to_dir(c.quat,m.AXIS_Z,t);0<n.dot(f,b)&&n.negate(k,k)}c=m.quat_to_dir(c.quat,
m.AXIS_X,t);n.normalize(c,c);var f=m.clamp(n.dot(c,k),-1,1),l=Math.acos(f),e=-.999999>=f?y.setAxisAngle(e,l,A):y.rotationTo(c,k,A);y.normalize(e,e)}y.multiply(e,d,d);r.io(a)}function p(a,b,c,d,e){var f=a.d,g=f.Kf,m=f.Kc[b];b=m.fi;a=a.pose.bones[m.un];var m=a.Ko,h=G,t=f.Fc,P=f.Ec,u=f.xc,r=f.wc,n=t[4*b+1],p=t[4*b+2],x=t[4*b+3],L=P[4*b+1],J=P[4*b+2],B=P[4*b+3];h[0]=(1-g)*t[4*b]+g*P[4*b];h[1]=(1-g)*n+g*L;h[2]=(1-g)*p+g*J;h[3]=(1-g)*x+g*B;t=A;P=k;t[0]=u[4*b];t[1]=u[4*b+1];t[2]=u[4*b+2];t[3]=u[4*b+3];P[0]=
r[4*b];P[1]=r[4*b+1];P[2]=r[4*b+2];P[3]=r[4*b+3];y.slerp(t,P,g,t);g=I;l.set_transcale(h,g);l.set_quat(t,g);c?(c=F,l.translate(m,a.Uu,c),l.multiply(g,c,g)):l.multiply(g,m,g);l.multiply(f.Ab,g,g);d[0]=g[0];d[1]=g[1];d[2]=g[2];d[3]=g[3];e&&(e[0]=g[4],e[1]=g[5],e[2]=g[6],e[3]=g[7])}var l=q("__tsr"),m=q("__util"),r=q("__camera"),n=q("vec3");q("vec4");var y=q("quat"),v=q("mat3");q("mat4");a.xC=1;a.wC=2;a.BC=3;a.CC=4;a.rC=5;a.sC=6;a.yC=7;a.qC=8;a.vC=9;a.uC=10;a.Hd=11;a.tC=12;a.zC=13;a.AC=14;var E=new Float32Array(2),
x=new Float32Array(2),u=new Float32Array(3),B=new Float32Array(3),t=new Float32Array(3),G=new Float32Array(4),A=new Float32Array(4),k=new Float32Array(4),I=new Float32Array(16),F=new Float32Array(16),L=new Float32Array(9),J=new Float32Array(9),I=new Float32Array(8),P=new Float32Array(3);a.To=function(a,c,e,k,f){var l=b(1);l.N=c;l.offset=new Float32Array(e);l.gc=k?new Float32Array(k):null;l.Fk=f;d(a,l);g(a,l,0)};a.So=function(a,c,e,k,f,l){var m=b(2);m.N=c;m.Hv=e;m.offset=new Float32Array(k);m.gc=f?
new Float32Array(f):null;m.Fk=l;d(a,m);g(a,m,0)};a.ev=function(a,c,e,k){var f=b(9),l=a.d.quat,m=c.d.quat;f.N=c;f.offset=new Float32Array(e);f.lg=new Float32Array(m);k&&(y.copy(k,l),y.multiply(m,l,l));d(a,f);g(a,f,0)};a.dv=function(a,c,e,k,f,l,h,t){var P=b(10),u=a.d.quat,r=c.d.quat;P.N=c;P.offset=new Float32Array(e);P.lg=new Float32Array(r);P.Zv=m.angle_wrap_0_2pi(f);P.$v=m.angle_wrap_0_2pi(l);P.aw=m.angle_wrap_periodic(h,-Math.PI,Math.PI);P.Yv=m.angle_wrap_periodic(t,-Math.PI,Math.PI);k?(P.gc=new Float32Array(k),
y.copy(k,u),y.multiply(r,u,u)):P.gc=y.create();d(a,P);g(a,P,0)};a.cv=function(a,c,e,k){var f=b(12);f.N=c;f.offset=new Float32Array(e);f.JA=k;d(a,f);g(a,f,0)};a.gv=function(a,c,e,k){var f=b(13);f.N=c;f.offset=new Float32Array(e);f.Fk=1;f.gc=k?new Float32Array(k):null;d(a,f);g(a,f,0)};a.TC=c;a.AE=e;a.iv=function(a,c){var e=b(3);e.N=c;d(a,e);g(a,e,0)};a.jv=function(a,c){var e=b(4);e.target=new Float32Array(c);d(a,e);g(a,e,0)};a.$u=function(a,c,e,k){var f=b(5);f.N=c;f.hi=e;f.dist_max=k;d(a,f);g(a,f,0)};
a.av=function(a,c,e,k){var f=b(6);f.target=new Float32Array(c);f.hi=e;f.dist_max=k;d(a,f);g(a,f,0)};a.fv=function(a,c,e){var k=b(7);k.N=c;k.offset=new Float32Array(e);d(a,k);g(a,k,0)};a.Zu=function(a,c,e){var k=b(8);k.N=c;k.offset=new Float32Array(e);d(a,k);g(a,k,0)};a.Yu=function(a,c,e){var k=b(11);k.N=c;k.$s=new Float32Array(e);d(a,k);g(a,k,0)};a.append_stiff_viewport=function(a,c,e){var k=b(14);k.N=c;if("left"in e)k.ir=!0,k.Ym=e.left;else if("right"in e)k.ir=!1,k.Ym=e.right;else{m_print.error("append_stiff_viewport: Wrong positioning params");
return}if("top"in e)k.Ys=!0,k.ao=e.top;else if("bottom"in e)k.Ys=!1,k.ao=e.bottom;else{m_print.error("append_stiff_viewport: Wrong positioning params");return}"distance"in e?(k.distance=e.distance,k.gc="rotation"in e?new Float32Array(e.rotation):null,d(a,k),g(a,k,0)):m_print.error("append_stiff_viewport: Wrong positioning params")};a.EB=function(a,b){a.Wa&&g(a,a.Wa,b)};a.Zz=f;a.correct_up=h;a.Rv=function(a){return a.Wa?!0:!1};a.remove=function(a){a.Wa.N&&e(a.Wa.N,a);a.Wa=null};a.de=function(a){return a.Wa?
a.Wa.type:null};a.get_parent=function(a){return a.Wa&&a.Wa.N?a.Wa.N:null};a.ce=function(a){return a.Wa&&11==a.Wa.type?a.Wa.$s:null};a.Yx=p};b4w.module.__container=function(a,q){var b,d,c,e,g;function f(a,c){b=a;d=c}function h(){var a=m.getBoundingClientRect();f(a.left,a.top)}var p=q("__print"),l=q("__util"),m=null,r=null,n=!1;e=c=0;g=1;b=d=0;a.get_canvas=function(){return m};a.get_container=function(){return r};a.init=function(a){a&&a.parentNode?(m=a,r=a.parentNode):l.pa("canvas container is not available")};a.insert_to_container=function(a,b){b=b||"LAST";switch(b){case "FIRST":r.insertBefore(a,r.firstElementChild);break;case "JUST_BEFORE_CANVAS":r.insertBefore(a,
m);break;case "JUST_AFTER_CANVAS":m.nextElementSibling?r.insertBefore(a,m.nextElementSibling):r.appendChild(a,m);break;case "LAST":r.appendChild(a,m);break;default:p.error(b+" invalid stack order")}};a.uy=function(){return c};a.ty=function(){return e};a.set_canvas_offsets=f;a.update_canvas_offsets=h;a.CA=function(a,b,d){c=a;e=b;g=d;h()};a.force_offsets_updating=function(){n=!0};a.client_to_canvas_coords=function(a,c,e){e||(e=new Float32Array(2));var f=e;n&&(h(),n=!1);f[0]=a-b;a=e;n&&(h(),n=!1);a[1]=
c-d;return e};a.El=function(a,b,d,e){d||(d=new Float32Array(2));d[0]=a*g;d[1]=b*g;e&&(a=e.width/c,d[0]*=a,d[1]*=a);return d};a.hC=function(a,b,d,e){d||(d=new Float32Array(2));d[0]=a/g;d[1]=b/g;e&&(a=e.width/c,d[0]/=a,d[1]/=a)}};b4w.module.__controls=function(a,q){function b(a){return{type:a,value:0,aa:null,Xc:!1,key:0,Na:"",ld:!1,Ll:null,Kl:function(){},Jl:null,yp:function(){},oe:null,M:new Float32Array(3),la:new Float32Array(3),Vq:!1,Yj:!1,es:0,ds:function(){},axis:"",Dc:0,Hh:new Float32Array(3),Ak:new Float32Array(4),threshold:0,as:new Float32Array(4),uj:0,tj:0,ms:0,vj:0,Qc:0,repeat:!1,Zo:!1,Xj:0,Wj:0,Vj:0,Gm:0,Fm:0,Em:0}}function d(a,b){a.value=Number(b)}function c(a){a=P.indexOf(a);-1<a?P.splice(a,1):B.error("Wrong object")}
function e(a,b){for(var c=0,d=0;d<b.length;d++)for(var e=b[d].ze,k=0;k<e.length;k++)for(var f=e[k].vd,H=0;H<f.length;H++)f[H]===a&&c++;return c}function g(a,b){switch(a.type){case 80:t.remove_collision_test(a.Ll,a.Na,a.Kl);a.Xc=!0;break;case 90:t.clear_collision_impulse_test(a.Jl);a.Xc=!0;break;case 100:t.remove_ray_test(a.es);a.Xc=!0;break;case 130:a.Xc=!0}var c=b.indexOf(a);-1<c&&b.splice(c,1)}function f(a){for(var b=0;b<z.length;b++){var c=z[b];20==c.type&&a.keyCode==c.key&&d(c,1)}pa&&a.preventDefault();
ra&&ra(a)}function h(a){for(var b=0;b<z.length;b++){var c=z[b];20==c.type&&0==a.keyCode&&16==c.key&&d(c,0);20==c.type&&a.keyCode==c.key&&d(c,0)}pa&&a.preventDefault();ra&&ra(a)}function p(a){var b=!1,c=null;Z=!0;X=a.clientX;aa=a.clientY;K=a.clientX;O=a.clientY;for(var e=0;e<z.length;e++){var k=z[e];50==k.type&&(d(k,1),k.aa=a.which);160==k.type&&(b||(b=u.client_to_canvas_coords(a.clientX,a.clientY,w),c=G.pick_object(b[0],b[1]),b=!0),k.value=c==k.oe?1:0)}T&&a.preventDefault();sa&&sa(a)}function l(a){for(var b=
0;b<z.length;b++){var c=z[b];50==c.type&&d(c,0);160==c.type&&c.Zo&&(c.value=0)}Z=!1;T&&!ja&&a.preventDefault();sa&&sa(a)}function m(a){var b=a.clientX,c=a.clientY;K=b;O=c;if(!J.Lm||Z)for(var e=b-X,k=c-aa,f=Math.sqrt(e*e+k*k),H=0;H<z.length;H++){var l=z[H];if(40===l.type)switch(l.axis){case "X":d(l,e);l.aa=b;break;case "Y":d(l,k);l.aa=c;break;case "XY":d(l,f),l.aa[0]=b,l.aa[1]=c}}T&&!ja&&a.preventDefault();sa&&sa(a)}function r(a){var b=a.wheelDelta||-40*a.detail,b=b*L.lz;H+=b;for(b=0;b<z.length;b++){var c=
z[b];30===c.type&&d(c,H)}R&&a.preventDefault();S&&S(a)}function n(a){var b=a.targetTouches;if(1==b.length){for(var c=b[0],b=c.clientX,c=c.clientY,d=!1,e=null,k=0;k<z.length;k++){var f=z[k];160==f.type&&(d||(d=u.client_to_canvas_coords(b,c,w),e=G.pick_object(d[0],d[1]),d=!0),f.value=e==f.oe)}ka[0]=b;ka[1]=-1;qa[0]=c;qa[1]=-1}else 1<b.length&&(ma=W=E(b),ka[0]=b[0].clientX,ka[1]=b[1].clientX,qa[0]=b[0].clientY,qa[1]=b[1].clientY);Q.set(ka);ha.set(qa);ea&&ea(a)}function y(D){var b=D.targetTouches;if(0!==
b.length){if(1===b.length){Q[0]=b[0].clientX;Q[1]=-1;ha[0]=b[0].clientY;ha[1]=-1;var b=Q[0]-ka[0],c=ha[0]-qa[0],e=Math.sqrt(b*b+c*c);if(-1!=ka[1]&&-1!=qa[1]){var k=Q[0]-ka[1],f=ha[0]-qa[1],H=Math.sqrt(k*k+f*f);H<e&&(b=k,c=f,e=H)}for(H=0;H<z.length;H++){var l=z[H];if(60===l.type)switch(l.aa=a.PL_SINGLE_TOUCH_MOVE,l.axis){case "X":d(l,b);break;case "Y":d(l,c);break;case "XY":d(l,e)}}}else if(1<b.length){Q[0]=b[0].clientX;Q[1]=b[1].clientX;ha[0]=b[0].clientY;ha[1]=b[1].clientY;ma=E(b);e=ma-W;k=w;k[0]=
(Q[0]+Q[1])/2;k[1]=(ha[0]+ha[1])/2;f=ba;f[0]=(ka[0]+ka[1])/2;f[1]=(qa[0]+qa[1])/2;var g,b=k[0],c=k[1],H=f[0],l=f[1];g=Math.sqrt((b-H)*(b-H)+(c-l)*(c-l));for(H=0;H<z.length;H++)if(l=z[H],70===l.type&&Math.abs(g)<Math.abs(e)&&(l.aa=a.PL_MULTITOUCH_MOVE_ZOOM,d(l,e)),60===l.type&&Math.abs(g)>Math.abs(e))switch(l.aa=a.PL_MULTITOUCH_MOVE_PAN,l.axis){case "X":b=k[0]-f[0];d(l,b);break;case "Y":c=k[1]-f[1];d(l,c);break;case "XY":d(l,g)}}V&&D.preventDefault();ea&&ea(D)}}function v(a){for(var b=0;b<z.length;b++){var c=
z[b];if(170==c.type||180==c.type)c.Wj=a.beta,c.Xj=a.gamma,c.Vj=a.alpha,c.value||(c.Gm=a.gamma,c.Fm=a.beta,c.Em=a.alpha,d(c,1))}}function E(a){var b=a[0],c=a[1];a=b.clientX;var b=b.clientY,d=c.clientX,c=c.clientY;return Math.sqrt((a-d)*(a-d)+(b-c)*(b-c))}var x=q("__config"),u=q("__container"),B=q("__print"),t=q("__physics"),G=q("__scenes"),A=q("__time"),k=q("__util"),I=q("vec3"),F=q("quat"),L=x.controls,J=x.o,P=[],z=[],N={},H=0,K=0,O=0,X=0,aa=0,Z=!1,Q=new Float32Array(2),ha=new Float32Array(2),ka=
new Float32Array(2),qa=new Float32Array(2),w=new Float32Array(2),ba=new Float32Array(2),ma=0,W=0,ia=!1,ga=0,pa=!1,T=!1,R=!1,V=!1,ja=!1,ra=null,sa=null,S=null,ea=null;a.CT_CONTINUOUS=10;a.CT_TRIGGER=20;a.CT_SHOT=30;a.CT_LEVEL=40;a.PL_SINGLE_TOUCH_MOVE=0;a.PL_MULTITOUCH_MOVE_ZOOM=1;a.PL_MULTITOUCH_MOVE_PAN=2;a.update=function(D,b){for(var c=0;c<z.length;c++){var e=z[c],f=D,l=b;if(l)switch(e.type){case 110:var g=e.oe,S=g.d.h,g=g.d.quat,m=I.dist(e.Hh,S),h=e.as;F.invert(e.Ak,h);F.multiply(g,h,h);F.normalize(h,
h);h=Math.abs(2*Math.acos(h[3]));m/=l;e.uj=k.smooth(m,e.uj,l,.3);e.aa[0]=m;m=h/l;e.tj=k.smooth(m,e.tj,l,.3);e.aa[1]=m;e.uj>=e.threshold||e.tj>=e.ms?d(e,1):d(e,0);I.copy(S,e.Hh);F.copy(g,e.Ak);e.Dc=f;break;case 120:g=e.oe;S=g.d.h;g=Math.abs(S[1]-e.Hh[1])/l;e.vj=k.smooth(g,e.vj,l,.3);e.aa=g;e.vj>=e.threshold?d(e,1):d(e,0);I.copy(S,e.Hh);e.Dc=f;break;case 130:!e.Xc&&0<=e.Qc&&f-e.Dc>=e.Qc&&(d(e,1),e.repeat?e.Dc=f:e.Qc=-e.Qc);break;case 140:e.Dc||(e.Dc=f);d(e,f-e.Dc);e.Dc=f;break;case 150:d(e,f);break;
case 170:e.aa[0]=Math.PI*(e.Xj-e.Gm)/180;e.aa[1]=Math.PI*(e.Wj-e.Fm)/180;e.aa[2]=Math.PI*(e.Vj-e.Em)/180;e.Gm=e.Xj;e.Fm=e.Wj;e.Em=e.Vj;break;case 180:e.aa[0]=Math.PI*e.Xj/180,e.aa[1]=Math.PI*e.Wj/180,e.aa[2]=Math.PI*e.Vj/180}}for(c=0;c<P.length;c++)for(l=P[c],e=l.ze,f=0;f<e.length;f++)if(S=e[f],S.bt!=ga){S.bt=ga;for(var g=S,m=g.vd,h=g.iA,t=0;t<m.length;t++)h[t]=m[t].value;var g=g.az(h),m=S,h=m.fr,u=t=void 0;switch(m.type){case a.CT_CONTINUOUS:g?u=t=1:1==h?u=t=-1:t=0;break;case a.CT_TRIGGER:g&&-1==
h?u=t=1:g||1!=h?t=0:u=t=-1;break;case a.CT_SHOT:g&&-1==h?u=t=1:g||1!=h?t=0:(t=0,u=-1);break;case a.CT_LEVEL:t=m.er!=g?1:0;break;default:k.pa("Wrong sensor manifold type: "+m.type)}u&&(m.fr=u);if(m=t)if(h=l==N?null:l,ia=!1,S.callback(h,S.id,m,S.Kv),S.er=g,ia){c=-1;break}}for(c=0;c<P.length;c++)for(l=P[c],e=l.ze,f=0;f<e.length;f++)for(S=e[f],l=S.vd,S=0;S<l.length;S++)switch(g=l[S],g.type){case 30:d(g,0);break;case 40:d(g,0);break;case 60:d(g,0);break;case 70:d(g,0);break;case 130:d(g,0)}H=0;X=K;aa=
O;ka.set(Q);qa.set(ha);W=ma;ga++};a.create_custom_sensor=function(a){var c=b(10);d(c,a);return c};a.create_keyboard_sensor=function(a){var c=b(20);c.key=a;return c};a.create_collision_sensor=function(a,c,e){if(!a||!t.has_physics(a))return B.error("Wrong collision object"),null;var k=b(80);k.Ll=a;k.Na=c;k.ld=e;k.aa={coll_obj:null,coll_pos:e?new Float32Array(3):null,coll_norm:e?new Float32Array(3):null,coll_dist:0};k.Kl=function(a,D,b,c,e){d(k,a);a=k.aa;a.coll_obj=D;k.ld&&(a.coll_pos.set(b),a.coll_norm.set(c),
a.coll_dist=e)};k.Xc=!0;return k};a.create_collision_impulse_sensor=function(a){if(!a||!a.m)return B.error("Wrong collision impulse object"),null;var c=b(90);c.Jl=a;c.yp=function(a){d(c,a)};c.Xc=!0;return c};a.create_ray_sensor=function(a,c,e,k,f,l,H){var g=b(100);g.oe=a;g.M=c;g.la=e;g.Na=k;g.Vq=f;g.ld=l;g.Yj=H;g.aa={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3)};g.ds=function(a,D,b,c,e,U){g.Vq?d(g,-1==D?0:1):d(g,D);g.aa.hit_fract=D;g.aa.obj_hit=b;g.aa.hit_time=
c;g.ld&&(g.aa.hit_pos.set(e),g.aa.hit_norm.set(U))};g.Xc=!0;return g};a.create_mouse_click_sensor=function(){return b(50)};a.create_mouse_wheel_sensor=function(){return b(30)};a.create_mouse_move_sensor=function(a){var c=b(40);c.axis=a||"XY";c.aa="XY"==c.axis?new Float32Array(2):0;return c};a.create_touch_move_sensor=function(a){var c=b(60);c.axis=a||"XY";c.aa=0;return c};a.create_touch_zoom_sensor=function(){var a=b(70);a.aa=0;return a};a.create_motion_sensor=function(a,c,d){if(!a)return B.error("Wrong collision object"),
null;var e=b(110);e.oe=a;var k=a.d.h;a=a.d.quat;e.as=new Float32Array(4);e.Hh=new Float32Array(k);e.Ak=new Float32Array(a);e.uj=0;e.tj=0;e.threshold=c||.1;e.ms=d||.1;e.Dc=0;e.aa=new Float32Array([0,0]);return e};a.create_vertical_velocity_sensor=function(a,c){if(!a)return B.error("Wrong collision object"),null;var d=b(120);d.oe=a;var e=a.d.quat;d.Hh=new Float32Array(a.d.h);d.Ak=new Float32Array(e);d.vj=0;d.threshold=c||1;d.Dc=0;d.aa=0;return d};a.create_timer_sensor=function(a,c){var d=b(130);d.Qc=
a;d.repeat=c;d.Xc=!0;return d};a.reset_timer_sensor=function(a,b,c,d){a=a||N;a=a.Tc;if(!a||!a[b])return B.error("reset_timer_sensor(): wrong object"),null;b=a[b].vd[c];if(!b)return B.error("reset_timer_sensor(): sensor not found"),null;b.Dc=A.get_timeline();b.Qc=d};a.create_elapsed_sensor=function(){var a=b(140);a.Dc=0;return a};a.create_gyro_delta_sensor=function(){var a=b(170);a.aa=new Float32Array(3);return a};a.create_gyro_angles_sensor=function(){var a=b(180);a.aa=new Float32Array(3);return a};
a.create_timeline_sensor=function(){return b(150)};a.create_selection_sensor=function(a,c){var d=b(160);d.oe=a;d.Zo=c;return d};a.hA=d;a.get_sensor_value=function(a,b,c){a=a||N;a=a.Tc;if(!a||!a[b])return B.error("get_sensor_value(): wrong object"),null;b=a[b].vd[c];return b?b.value:(B.error("get_sensor_value(): sensor not found"),null)};a.get_sensor_payload=function(a,b,c){a=a||N;a=a.Tc;if(!a||!a[b])return B.error("get_sensor_payload(): wrong object"),null;b=a[b].vd[c];return b?b.aa:(B.error("get_sensor_payload(): sensor not found"),
null)};a.cleanup=function(){P=[];z=[];N={}};a.check_sensor_manifold=function(a,b){a=a||N;if(!a.Tc)return!1;if(b&&a.Tc[b])return!0;if(!b)for(var c in a.Tc)return!0;return!1};a.remove_sensor_manifold=function(a,b){a=a||N;var d=a.Tc;if(d){var f=a.ze;if(b){var l=d[b];if(l){for(var H=l.vd,S=0;S<H.length;S++)1===e(H[S],P)&&g(H[S],z);delete d[b];l=f.indexOf(l);-1<l?f.splice(l,1):k.pa("Incorrect manifolds array");Object.getOwnPropertyNames(d).length||c(a)}}else{for(b in d){l=d[b];H=l.vd;for(S=0;S<H.length;S++)1===
e(H[S],P)&&g(H[S],z);delete d[b];l=f.indexOf(l);-1<l?f.splice(l,1):k.pa("Incorrect manifolds array")}c(a);ia=!0}}};a.create_sensor_manifold=function(a,b,c,d,f,l,H){a=a||N;a.Tc=a.Tc||{};a.ze=a.ze||[];var S=a.Tc,K=a.ze,m=S[b];if(m){d=m.vd;for(var h=0;h<d.length;h++)1===e(d[h],P)&&g(d[h],z);m=K.indexOf(m);-1<m?K.splice(m,1):k.pa("Incorrect manifolds array")}c={id:b,type:c,vd:d.slice(0),az:f,iA:Array(d.length),callback:l,Kv:H,fr:-1,er:0,bt:-1};S[b]=c;K.push(c);-1==P.indexOf(a)&&P.push(a);a=c.vd;for(b=
0;b<a.length;b++){S=a[b];if(S.Xc){switch(S.type){case 80:t.append_collision_test(S.Ll,S.Na,S.Kl,S.ld);break;case 90:t.apply_collision_impulse_test(S.Jl,S.yp);break;case 100:S.es=t.append_ray_test(S.oe,S.M,S.la,S.Na,S.ds,!1,!1,S.ld,S.Yj);break;case 130:S.Dc=A.get_timeline(),0>S.Qc&&(S.Qc=-S.Qc)}S.Xc=!1}-1==z.indexOf(S)&&z.push(S)}ia=!0};a.Op=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.Xw=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-
1]};a.reset=function(){for(var a=0;a<P.length;a++){var b=P[a],c=b.Tc,b=b.ze,d;for(d in c)delete c[d];b.splice(0,b.length)}for(a=0;a<z.length;a++)g(z[a],z),a--;P.splice(0,P.length)};a.debug=function(){B.log(String(P.length)+" objects with manifolds",P);B.log(String(z.length)+" sensors",z);for(var a=[],b=[],c=0;c<z.length;c++){var d=z[c];80==d.type&&a.push(d);100==d.type&&b.push(d)}B.log(String(a.length)+" collision sensors",a);B.log(String(b.length)+" ray sensors",b)};a.register_keyboard_events=function(a,
b){a.addEventListener("keydown",f,!1);a.addEventListener("keyup",h,!1);pa=b};a.register_mouse_events=function(a,b,c){if(c)var d=window;else d=a,d.addEventListener("mouseout",l,!1);a.addEventListener("mousedown",p,!1);d.addEventListener("mousemove",m,!1);d.addEventListener("mouseup",l,!1);T=b;ja=c};a.register_wheel_events=function(a,b){a.addEventListener("mousewheel",r,!1);a.addEventListener("DOMMouseScroll",r,!1);R=b};a.register_touch_events=function(a,b){a.addEventListener("touchstart",n,!1);a.addEventListener("touchmove",
y,!1);document.addEventListener("touchstart",function(){});V=b};a.register_device_orientation=function(){window.DeviceOrientationEvent&&J.gyro_use&&window.addEventListener("deviceorientation",v,!1)};a.unregister_keyboard_events=function(a){a.removeEventListener("keydown",f,!1);a.removeEventListener("keyup",h,!1)};a.unregister_mouse_events=function(a){a.removeEventListener("mousedown",p,!1);a.removeEventListener("mousemove",m,!1);a.removeEventListener("mouseout",l,!1);a.removeEventListener("mouseup",
l,!1)};a.unregister_wheel_events=function(a){a.removeEventListener("mousewheel",r,!1);a.removeEventListener("DOMMouseScroll",r,!1)};a.unregister_touch_events=function(a){a.removeEventListener("touchstart",n,!1);a.removeEventListener("touchmove",y,!1);document.removeEventListener("touchstart",function(){})};a.unregister_device_orientation=function(){window.DeviceOrientationEvent&&J.gyro_use&&window.removeEventListener("deviceorientation",v,!1)};a.RC=function(a){ra=a};a.SC=function(a){sa=a};a.VC=function(a){S=
a};a.UC=function(a){ea=a}};b4w.module.__curve=function(a,q){function b(a,b,c,d,e){var m=d.length;e||(e=new Float32Array(m));for(var r=m+a,n=new Float32Array(r),y=1;y<=r-1;y++)n[y-1]=b>=c[y-1]&&b<c[y+1-1]?1:0;for(var v=2;v<=a;v++)for(y=1;y<=r-v;y++)n[y-1]=(0!=n[y-1]?(b-c[y-1])*n[y-1]/(c[y+v-1-1]-c[y-1]):0)+(0!=n[y+1-1]?(c[y+v-1]-b)*n[y+1-1]/(c[y+v-1]-c[y+1-1]):0);b==c[r-1]&&(n[m-1]=1);a=0;for(y=1;y<=m;y++)a+=n[y-1]*d[y-1];for(y=1;y<=m;y++)e[y-1]=0!=a?n[y-1]*d[y-1]/a:0;return e}function d(a){a=a.fk;return a[a.length-1]}function c(a){a=
a.Kp;return a[a.length-1]}var e=q("__util");a.Jw=function(a){var c={},d=a.data;a=d.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var e=a.order_u;c.Te=e;a=a.points;var l=a.length/5,m=[],r=l+e,l=l+2;m[0]=0;for(var n=2;n<=r;n++)m[n-1]=n>e&&n<l?m[n-2]+1:m[n-2];c.fk=m;if("2D"==d.dimensions)c.Qe=!1;else if("3D"==d.dimensions)c.Qe=!0;else throw"Wrong curve dimensions";e=[];m=[];for(d=0;d<a.length;d+=5)e.push(a[d]),e.push(a[d+1]),e.push(a[d+2]),c.Qe&&e.push(a[d+3]),m.push(a[d+4]);c.Pl=
e;c.uo=m;a=[];for(var d=c.Pl,e=c.Qe?4:3,m=c.uo,r=c.fk,l=c.Te,n=d.length/e,y=n+l,v=0,E=r[y-1]/999,x=0;1E3>x;x++){5E-6>r[y-1]-v&&(v=r[y-1]);for(var u=b(l,v,r,m),B=0;B<e;B++)for(var t=a[e*x+B]=0;t<n;t++)a[e*x+B]+=u[t]*d[e*t+B];v+=E}e=c.Qe?4:3;m=new Float32Array(1E3);m[0]=0;for(d=1;1E3>d;d+=1)r=a[(d-1)*e],l=a[(d-1)*e+1],n=a[(d-1)*e+2],y=a[d*e],v=a[d*e+1],E=a[d*e+2],m[d]=m[d-1]+Math.sqrt((y-r)*(y-r)+(v-l)*(v-l)+(E-n)*(E-n));c.Kp=m;return c};a.WA=function(a,c,e){e||(e=[]);var p=c,l=Math.max(p,0);c=l=Math.min(p,
d(a));var p=a.Pl,l=a.Qe?4:3,m=a.uo,r=a.fk,n=a.Te;a=p.length/l;var y=a+n;5E-6>r[y-1]-c&&(c=r[y-1]);y=new Float32Array(a);b(n,c,r,m,y);for(c=0;c<l;c++)for(m=e[c]=0;m<a;m++)e[c]+=y[m]*p[l*m+c]};a.TA=function(a,b,c){c||(c=[]);var d=a.Pl,e=a.Qe?4:3,m=a.uo,r=a.fk,n=a.Te;a=d.length/e;var y=a+n;5E-6>r[y-1]-b&&(b=r[y-1]);var y=new Float32Array(a),v=b;b=y;var E=m.length;b||(b=new Float32Array(E));var x=new Float32Array(E),u=new Float32Array(E),B=x,t=u;B||(B=new Float32Array(E));t||(t=new Float32Array(E));for(var G=
E+n,A=new Float32Array(G),k=new Float32Array(G),I=1;I<=G-1;I++)A[I-1]=v>=r[I-1]&&v<r[I+1-1]?1:0;v==r[G-1]&&(A[E-1]=1);for(var F=2;F<=n;F++)for(I=1;I<=G-F;I++){var L=0!=A[I-1]?A[I-1]/(r[I+F-1-1]-r[I-1]):0,J=0!=A[I+1-1]?-A[I+1-1]/(r[I+F-1]-r[I+1-1]):0,P=0!=k[I-1]?(v-r[I-1])*k[I-1]/(r[I+F-1-1]-r[I-1]):0,z=0!=k[I+1-1]?(r[I+F-1]-v)*k[I+1-1]/(r[I+F-1]-r[I+1-1]):0;A[I-1]=(0!=A[I-1]?(v-r[I-1])*A[I-1]/(r[I+F-1-1]-r[I-1]):0)+(0!=A[I+1-1]?(r[I+F-1]-v)*A[I+1-1]/(r[I+F-1]-r[I+1-1]):0);k[I-1]=L+J+P+z}for(I=1;I<=
E;I++)B[I-1]=A[I-1],t[I-1]=k[I-1];r=0;for(n=1;n<=E;n++)r+=x[n-1]*m[n-1];v=0;for(n=1;n<=E;n++)v+=u[n-1]*m[n-1];for(n=1;n<=E;n++)b[n-1]=0!=r?u[n-1]*m[n-1]/r+x[n-1]*m[n-1]*v/(r*r):0;for(m=0;m<e;m++)for(r=c[m]=0;r<a;r++)c[m]+=y[r]*d[e*r+m]};a.JE=d;a.VA=c;a.UA=function(a,b){if(0>=b)return 0;var h=d(a);if(b>=c(a))return h;var p=a.Kp,l=e.xj(p,b,0,p.length-1);return h*(l+(b-p[l])/(p[l+1]-p[l]))/1E3}};b4w.module.__dds=function(a,q){function b(a,b,c,d){var e=new Uint16Array(4),l=new Uint16Array(c*d),f=0,g=0,h=0,t=g=f=0,p=0,A=0,k=0,I=c/4;d/=4;for(var F=0;F<d;F++)for(var L=0;L<I;L++)h=b+4*(F*I+L),e[0]=a[h],e[1]=a[h+1],f=e[0]&31,g=e[0]&2016,t=e[0]&63488,p=e[1]&31,A=e[1]&2016,k=e[1]&63488,e[2]=5*f+3*p>>3|5*g+3*A>>3&2016|5*t+3*k>>3&63488,e[3]=5*p+3*f>>3|5*A+3*g>>3&2016|5*k+3*t>>3&63488,f=a[h+2],g=4*F*c+4*L,l[g]=e[f&3],l[g+1]=e[f>>2&3],l[g+2]=e[f>>4&3],l[g+3]=e[f>>6&3],g+=c,l[g]=e[f>>8&3],l[g+1]=e[f>>
10&3],l[g+2]=e[f>>12&3],l[g+3]=e[f>>14],f=a[h+3],g+=c,l[g]=e[f&3],l[g+1]=e[f>>2&3],l[g+2]=e[f>>4&3],l[g+3]=e[f>>6&3],g+=c,l[g]=e[f>>8&3],l[g+1]=e[f>>10&3],l[g+2]=e[f>>12&3],l[g+3]=e[f>>14];return l}function d(a,c,d,e){var v=new Int32Array(d,0,31),E,x,u,B,t,G;if(542327876!=v[0])return f.error("Invalid magic number in DDS header"),0;if(!v[20]&4)return f.error("Unsupported format, must contain a FourCC code"),0;E=v[21];switch(E){case h:x=8;u=c?c.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case p:x=16;u=
c?c.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case l:x=16;u=c?c.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return f.error("Unsupported FourCC code:",g(E)),null}G=1;v[2]&131072&&!1!==e&&(G=Math.max(1,v[7]));B=v[4];t=v[3];v=v[1]+4;if(c)for(E=0;E<G;++E)e=Math.max(4,B)/4*Math.max(4,t)/4*x,c=new Uint8Array(d,v,e),a.compressedTexImage2D(a.TEXTURE_2D,E,u,B,t,0,c),v+=e,B=Math.max(.5*B,1),t=Math.max(.5*t,1);else if(E==h)Math.max(4,B),Math.max(4,t),c=new Uint16Array(d),d=b(c,v/2,B,t),a.texImage2D(a.TEXTURE_2D,
0,a.RGB,B,t,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,d),e&&a.generateMipmap(a.TEXTURE_2D);else return f.error("No manual decoder for",g(E),"and no native support"),0;return G}function c(a,b,c,e,l,f){var g=new XMLHttpRequest;g.open("GET",c,!0);g.responseType="arraybuffer";g.onload=function(){if(200==g.status){a.bindTexture(a.TEXTURE_2D,e);var c=d(a,b,g.response,l);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<c?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}f&&
f(e)};g.send(null);return e}function e(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function g(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var f=q("__print"),h=e("DXT1"),p=e("DXT3"),l=e("DXT5");a.rD=b;a.RB=d;a.Bq=function(a){a=new Int32Array(a,0,31);return{width:a[4],height:a[3]}};a.ay=function(a){var b=1;a=(new Int32Array(a,0,31))[21];switch(a){case h:b=6;break;case p:case l:b=4;break;default:f.error("Unsupported FourCC code:",g(a))}return b};
a.oE=c;a.nE=function(a,b,d,e){var l=a.createTexture();c(a,b,d,l,!0,e);return l}};b4w.module.__debug=function(a,q){function b(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function d(a,b){typeof a!=typeof b&&f.pa("Structure assertion failed: incompatible types");for(var c in a)c in b||f.pa("Structure assertion failed: missing key in the first object: "+c);for(c in b)c in a||f.pa("Structure assertion failed: missing key in the second object: "+c),typeof a[c]!=typeof b[c]&&f.pa("Structure assertion failed: incompatible types for key "+c)}var c=
q("__extensions"),e=q("__print"),g=q("__textures"),f=q("__util"),h=null,p={},l=!1,m={},r=[],n=-1,y=null,v=!1;a.Go={WM_OPAQUE_WIREFRAME:0,WM_TRANSPARENT_WIREFRAME:1,WM_FRONT_BACK_VIEW:2,WM_DEBUG_SPHERES:3};a.bd=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;for(c in b){var d=b[c];d in a&&(p[a[d]]=d)}h=a};a.Tv=function(a){if(l){var b=h.getError();b!=h.NO_ERROR&&(b in p?f.pa("GL Error: "+b+", gl."+p[b]+" ("+
a+")"):f.pa("Unknown GL error: "+b+" ("+a+")"))}};a.Pv=function(){if(l)switch(h.checkFramebufferStatus(h.FRAMEBUFFER)){case h.FRAMEBUFFER_COMPLETE:break;case h.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case h.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case h.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");
break;case h.FRAMEBUFFER_UNSUPPORTED:e.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;default:e.error("FRAMEBUFFER CHECK FAILED")}};a.sp=function(){if(-1!=n)return n;h.bindFramebuffer(h.FRAMEBUFFER,h.createFramebuffer());var a=g.Jj("DEBUG",g.Qh);g.resize(a,1,1);h.framebufferTexture2D(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,a.Ob,a.Va,0);h.checkFramebufferStatus(h.FRAMEBUFFER)!=h.FRAMEBUFFER_COMPLETE?(n=!0,e.warn("depth-only issue was found")):n=!1;h.bindFramebuffer(h.FRAMEBUFFER,null);return n};
a.Uv=function(a,c,d){if(l&&!h.getShaderParameter(a,h.COMPILE_STATUS))throw d=b(d),e.error("shader compilation failed:\n"+d+"\n"+h.getShaderInfoLog(a)+" ("+c+")"),"Engine failed: see above for error messages";};a.Vv=function(a,d,f,g,m,r){if(l&&!h.getProgramParameter(a,h.LINK_STATUS)){var k=c.rq();k&&(m=k.getTranslatedShaderSource(f),r=k.getTranslatedShaderSource(g));m=b(m);r=b(r);e.error("shader linking failed:\n"+m+"\n\n\n"+r+"\n"+h.getProgramInfoLog(a)+" ("+d+")");throw"Engine failed: see above for error messages";
}};a.set_check_gl_errors=function(a){l=a};a.sD=function(a){m[a]=a in m?m[a]+1:1};a.update=function(){for(var a in m)e.log(a,m[a]),m[a]=0};a.fbmsg=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(f.is_vector(c))for(var d=0;d<c.length;d++)a.push(c[d]);else a.push(arguments[b])}r.push(a)};a.msg=function(){for(var a=1,b=0;b<r.length;b++){var c=r[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],f.is_vector(a))for(var d=0;d<a.length;d++)c.push(a[d]);
else c.push(arguments[b]);r.push(c)};var E=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.print_telemetry=function(a){a||(a=1);for(var b=0,c={},d=Math.max(0,performance.now()-1E3*a),l=0;l<r.length;l++){var f=r[l];a=f[0];if(!(a<d)){var k=String(f[1]);c[k]||(c[k]=E[b++%E.length]);a=["%c"+(a/1E3).toFixed(6),c[k],k];for(k=2;k<f.length;k++)a.push(f[k]);e.log.apply(this,a)}}r.splice(0)};a.plot_telemetry=function(a){a||(a=1);for(var b={},c=Math.max(0,performance.now()-
1E3*a),d=0;d<r.length;d++){var l=r[d];a=l[0];if(!(a<c))for(var f=2;f<l.length;f++){var k=String(l[1]);3<l.length&&(k+="_"+String(f-2));b[k]||(b[k]=k+"\n");b[k]+=String(a)+" "+l[f]+"\n"}}a="";for(k in b)a+=b[k]+"\n\n";e.log(a);r.splice(0)};a.bD=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&
b("trident")&&b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.check_finite=function(a){if(f.is_vector(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.QC=function(a,b){typeof a!=b&&f.pa("Type assertion failed: value type is not a {"+b+"}:",a)};a.OC=d;a.PC=function(a){v?d(a,y):v=!0;y=a}};b4w.module.__extensions=function(a,q){function b(a){if(a in e)return e[a];var b=c.getExtension(a)||null;e[a]=b;d.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}var d=q("__print"),c=null,e={};a.bd=function(a){c=a};a.yq=function(){return b("WEBGL_compressed_texture_s3tc")||b("WEBKIT_WEBGL_compressed_texture_s3tc")||b("MOZ_WEBGL_compressed_texture_s3tc")};a.cy=function(){return b("WEBGL_depth_texture")||b("WEBKIT_WEBGL_depth_texture")||b("MOZ_WEBGL_depth_texture")};a.Vx=function(){return b("EXT_texture_filter_anisotropic")||
b("WEBKIT_EXT_texture_filter_anisotropic")||b("MOZ_EXT_texture_filter_anisotropic")};a.rq=function(){return b("WEBGL_debug_shaders")};a.xq=function(){return b("WEBGL_debug_renderer_info")};a.sq=function(){return b("OES_element_index_uint")};a.oy=function(){return b("OES_standard_derivatives")};a.cleanup=function(){e={}}};b4w.module.__graph=function(a){function q(a,c,d){d||(d=null);if(b(a,c))throw"Graph already has node with given ID";a.X.push(c,d)}function b(a,b){for(var c=a.X,d=0;d<c.length;d+=2)if(c[d]==b)return!0;return!1}function d(a,c,d,e){e||(e=null);if(b(a,c)&&b(a,d))a.oa.push(c,d,e);else throw"Wrong node IDs";}function c(a,c){if(!b(a,c))throw"Node not found";for(var d=a.X,e=0;e<d.length;e+=2)d[e]==c&&(d.splice(e,2),e-=2)}function e(a,b,c,d){if(!k(a,b,c))throw"Edge not found";a=a.oa;for(var e=0,l=0;l<a.length;l+=
3)if(a[l]==b&&a[l+1]==c){if(-1==d)a.splice(l,3);else{if(d==e){a.splice(l,3);break}e++}l-=3}}function g(a){a=a.X;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function f(a,b){for(var c=a.X,d=0;d<c.length;d+=2)if(c[d+1]==b)return c[d];return-1}function h(a){var b=[],c={};p(a,c);for(var d=a.X,e=0;e<d.length;e+=2)0==t(a,d[e])&&l(a,d[e],c,b);return{X:b,oa:a.oa.slice(0)}}function p(a,b){for(var c=a.X,d=0;d<c.length;d+=2)b[c[d]]=!1}function l(a,b,c,d){if(!c[b]){c[b]=!0;for(var e=0;e<B(a,
b);e++)l(a,G(a,b,e),c,d);d.unshift(b,u(a,b))}}function m(a,b,c,d){if(!c[b]){c[b]=!0;if(10==d||30==d)for(var e=0;e<B(a,b);e++){var k=G(a,b,e);m(a,k,c,d)}if(20==d||30==d)for(e=0;e<t(a,b);e++)k=A(a,b,e),m(a,k,c,d)}}function r(a){for(var b=[],c=a.X,d=0;d<c.length;d+=2){var e=c[d];B(a,e)||b.push(e)}return b}function n(a){var b=a.X;a=a.oa;for(var c=[],d=[],e=[],k=0;k<b.length;k++)e[b[2*k]]=k,c.push(k,b[2*k+1]);for(k=0;k<a.length;k+=3)d.push(e[a[k]],e[a[k+1]],a[k+2]);return{X:c,oa:d}}function y(a,b,c){if(c.md==
c.Se){for(var d=0,e=0;d<c.Se;d++)-1!=c.Td[d]&&(a[e]=d,b[e]=c.Td[d],e++);return!0}if(c.Se>c.lh||c.gf>c.hf||c.Eh>c.Gh||c.Dh>c.Fh)return!1;for(var e=d=-1,k=!1;!k&&v(c,J,d,e);)if(d=J[0],e=J[1],E(c,d,e)){var l;l=c;k={};k.pi=l.pi;k.qi=l.qi;k.mn=l.mn;k.Oj=l.Oj;k.Se=l.Se;k.lh=l.lh;k.Te=l.Te;k.md=k.mk=l.md;k.Dh=l.Dh;k.Eh=l.Eh;k.gf=l.gf;k.Fh=l.Fh;k.Gh=l.Gh;k.hf=l.hf;k.Uh=-1;k.Td=l.Td;k.Ff=l.Ff;k.Qf=l.Qf;k.Rf=l.Rf;k.gg=l.gg;k.hg=l.hg;k.Ik=l.Ik;l.Ik[0]+=1;var k=l=k,f=d,g=e,m=k.pi,h=k.qi,r=k.Se,n=k.lh,p=k.Td,
u=k.Ff,L=k.Qf,F=k.Rf,I=k.gg,q=k.hg;x(f<r);x(g<n);x(k.md<r);x(k.md<n);r=++k.md;k.Uh=f;L[f]||(L[f]=r,k.Dh++,I[f]&&k.gf++);I[f]||(I[f]=r,k.Eh++,L[f]&&k.gf++);F[g]||(F[g]=r,k.Fh++,q[g]&&k.hf++);q[g]||(q[g]=r,k.Gh++,F[g]&&k.hf++);p[f]=g;u[g]=f;for(p=0;p<t(m,f);p++)u=A(m,f,p),L[u]||(L[u]=r,k.Dh++,I[u]&&k.gf++);for(p=0;p<B(m,f);p++)u=G(m,f,p),I[u]||(I[u]=r,k.Eh++,L[u]&&k.gf++);for(p=0;p<t(h,g);p++)u=A(h,g,p),F[u]||(F[u]=r,k.Fh++,q[u]&&k.hf++);for(p=0;p<B(h,g);p++)u=G(h,g,p),q[u]||(q[u]=r,k.Gh++,F[u]&&k.hf++);
k=y(a,b,l);x(1>=l.md-l.mk);x(-1!=l.Uh);u=l.pi;f=l.qi;g=l.md;m=l.Uh;h=l.Td;L=l.Ff;r=l.Qf;F=l.Rf;n=l.gg;I=l.hg;if(l.mk<g){r[m]==g&&(r[m]=0);for(q=0;q<t(u,m);q++)p=A(u,m,q),r[p]==g&&(r[p]=0);n[m]==g&&(n[m]=0);for(q=0;q<B(u,m);q++)p=G(u,m,q),n[p]==g&&(n[p]=0);u=h[m];F[u]==g&&(F[u]=0);for(q=0;q<t(f,u);q++)p=A(f,u,q),F[p]==g&&(F[p]=0);I[u]==g&&(I[u]=0);for(q=0;q<B(f,u);q++)p=G(f,u,q),I[p]==g&&(I[p]=0);h[m]=-1;L[u]=-1;l.md=l.mk;l.Uh=-1}}return k}function v(a,b,c,d){-1==c&&(c=0);-1==d?d=0:d++;var e=a.gf,
k=a.hf,l=a.Eh,f=a.Gh,g=a.Dh,m=a.Fh,h=a.md,t=a.Se,r=a.lh,p=a.Td,n=a.Ff,u=a.Qf,G=a.Rf,y=a.gg,A=a.hg;if(e>h&&k>h)for(;c<t&&(-1!=p[c]||0==y[c]||0==u[c]);)c++,d=0;else if(l>h&&f>h)for(;c<t&&(-1!=p[c]||0==y[c]);)c++,d=0;else if(g>h&&m>h)for(;c<t&&(-1!=p[c]||0==u[c]);)c++,d=0;else if(0==c&&0!=a.Te){for(u=0;u<t&&-1!=p[c=a.Te[u]];)u++;u==t&&(c=t)}else for(;c<t&&-1!=p[c];)c++,d=0;if(e>h&&k>h)for(;d<r&&(-1!=n[d]||0==A[d]||0==G[d]);)d++;else if(l>h&&f>h)for(;d<r&&(-1!=n[d]||0==A[d]);)d++;else if(g>h&&m>h)for(;d<
r&&(-1!=n[d]||0==G[d]);)d++;else for(;d<r&&-1!=n[d];)d++;return c<t&&d<r?(b[0]=c,b[1]=d,!0):!1}function E(a,b,c){var d=a.pi,e=a.qi,l=a.lh,f=a.Td,g=a.Ff,m=a.Qf,h=a.Rf,r=a.gg,p=a.hg;x(b<a.Se);x(c<l);x(-1==f[b]);x(-1==g[c]);if(!(0,a.mn)(u(d,b),u(e,c)))return!1;for(var n=l=0,y=0,L=0,J=0,E=0,v=0;v<B(d,b);v++){var F=G(d,b,v);if(-1!=f[F]){var q=f[F];if(!k(e,c,q)||!I(a.Oj,d,b,F,e,c,q))return!1}else m[F]&&y++,r[F]&&l++,m[F]||r[F]||J++}for(v=0;v<t(d,b);v++)if(F=A(d,b,v),-1!=f[F]){if(q=f[F],!k(e,q,c)||!I(a.Oj,
d,F,b,e,q,c))return!1}else m[F]&&y++,r[F]&&l++,m[F]||r[F]||J++;for(v=0;v<B(e,c);v++)if(q=G(e,c,v),-1!=g[q]){if(F=g[q],!k(d,b,F))return!1}else h[q]&&L++,p[q]&&n++,h[q]||p[q]||E++;for(v=0;v<t(e,c);v++)if(q=A(e,c,v),-1!=g[q]){if(F=g[q],!k(d,F,b))return!1}else h[q]&&L++,p[q]&&n++,h[q]||p[q]||E++;return y<=L&&l<=n&&J<=E}function x(a){if(!a)throw"Assertion failed";}function u(a,b){for(var c=a.X,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null}function B(a,b){for(var c=a.oa,d=0,e=0;e<c.length;e+=
3)c[e]==b&&d++;return d}function t(a,b){for(var c=a.oa,d=0,e=0;e<c.length;e+=3)c[e+1]==b&&d++;return d}function G(a,b,c){a=a.oa;for(var d=0,e=0;e<a.length;e+=3)if(a[e]==b){if(d==c)return a[e+1];d++}return-1}function A(a,b,c){a=a.oa;for(var d=0,e=0;e<a.length;e+=3)if(a[e+1]==b){if(d==c)return a[e];d++}return-1}function k(a,b,c){a=a.oa;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c)return!0;return!1}function I(a,b,c,d,e,k,l){for(var f=F(b,c,d),g=F(e,k,l),m=0;m<f;m++){for(var h=!1,t=0;t<g;t++)if(a(L(b,
c,d,m),L(e,k,l,t))){h=!0;break}if(!h)return!1}return!0}function F(a,b,c){var d=0;a=a.oa;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&d++;return d}function L(a,b,c,d){a=a.oa;for(var e=0,k=0;k<a.length;k+=3)if(a[k]==b&&a[k+1]==c){if(e==d)return a[k+2];e++}return null}var J=[-1,-1];a.Co=-1;a.EC=10;a.yo=20;a.IC=30;a.create=function(){for(var a=arguments,b=[],c=[],d=0;d<a.length;d++){var e=a[d];switch(e.length){case 2:b.push(e[0],e[1]);break;case 3:c.push(e[0],e[1],e[2]);break;default:throw"Wrong graph constructor params";
}}return{X:b,oa:c}};a.jD=function(a,b){for(var c=[],d=[],e=0;e<a.length;e++)c.push(a[e][0],a[e][1]);for(e=0;e<b.length;e++)d.push(b[e][0],b[e][1],b[e][2]);return{X:c,oa:d}};a.sj=q;a.TD=b;a.Uc=d;a.ph=c;a.Xe=e;a.s=function(a,b){if(-1==f(a,b)){var c=g(a);q(a,c,b);return c}throw"Non-unique attribute";};a.Uz=function(a,b,c,d,e){a=a.oa;for(var k=0;k<a.length;k+=3)a[k]==b&&a[k+1]==c&&a[k+2]==d&&(a[k+2]=e)};a.kq=g;a.cg=f;a.l=function(a,b,c,e){b=f(a,b);c=f(a,c);if(-1!=b&&-1!=c)d(a,b,c,e);else throw"Attributes not found";
};a.O=function(a,b){for(var c=a.X,d=0;d<c.length&&!b(c[d],c[d+1]);d+=2);};a.se=function(a,b){for(var c=a.oa,d=0;d<c.length&&!b(c[d],c[d+1],c[d+2]);d+=3);};a.te=function(a,b,c){for(var d=a.oa,e=0;e<d.length;e+=3)if(d[e+1]==b){var k=d[e];if(c(k,u(a,k),d[e+2]))break}};a.kf=function(a,b,c){for(var d=a.oa,e=0;e<d.length;e+=3)if(d[e]==b){var k=d[e+1];if(c(k,u(a,k),d[e+2]))break}};a.bo=h;a.nB=function(a){a=h(a).X;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.dE=function(){};a.Rs=function(a,
c,d){if(!b(a,c))throw"No such node";var e={};p(a,e);m(a,c,e,d);c=[];for(var k in e)e[k]&&(k=Number(k),c.push(k,u(a,k)));a={X:c,oa:a.oa.slice(0)};e=a.oa;for(k=0;k<e.length;k+=3)c=e[k+1],b(a,e[k])&&b(a,c)||(e.splice(k,3),k-=3);return a};a.ny=function(a){for(var b=[],c=a.X,d=0;d<c.length;d+=2){var e=c[d];t(a,e)||b.push(e)}return b};a.Aq=r;a.match=function(a,b,c,d){var e={};e.pi=n(a);e.qi=n(b);e.mn=c||function(a,b){return a==b};e.Oj=d||function(a,b){return a==b};d=a.X.length/2;var k=b.X.length/2;e.Se=
d;e.lh=k;e.Te=0;e.md=e.mk=0;e.gf=e.Dh=e.Eh=0;e.hf=e.Fh=e.Gh=0;e.Uh=-1;e.Td=Array(d);e.Ff=Array(k);e.Qf=Array(d);e.Rf=Array(k);e.gg=Array(d);e.hg=Array(k);e.Ik=[1];for(c=0;c<d;c++)e.Td[c]=-1,e.Qf[c]=0,e.gg[c]=0;for(c=0;c<k;c++)e.Ff[c]=-1,e.Rf[c]=0,e.hg[c]=0;k=Array(d);d=Array(d);if(y(k,d,e)){for(c=0;c<k.length;c++)k[c]=a.X[2*k[c]],d[c]=b.X[2*d[c]];return[k,d]}return null};a.Ya=u;a.ig=B;a.Pq=t;a.Of=G;a.Tj=A;a.MD=F;a.Nf=L;a.replace=function(a,b,d){for(var e=a.oa,k=g(a),l=0;l<b.length;l++){var f=b[l];
c(a,f);for(var m=0;m<e.length;m+=3)e[m]==f&&(e[m]=k),e[m+1]==f&&(e[m+1]=k),e[m]==e[m+1]&&(e.splice(m,3),m-=3)}q(a,k,d)};a.Lz=function(a,b,c,d,e){if(!k(a,b,c))throw"Edge not found";a=a.oa;for(var l=0;l<a.length;l+=3)a[l]==b&&a[l+1]==c&&(a[l]=d,a[l+1]=e)};a.lx=function(a,b){function c(a,b){if(-1!=g.indexOf(a)){var d=g.slice(g.indexOf(a));if(-1!=k[d[d.length-1]].indexOf(d[0])){m.push([a,d[d.length-1]]);return}}g.push(a);for(d=0;d<b.length;d++)b[d]in k&&c(b[d],k[b[d]])}b||(b=r(a)[0]);for(var d=a.oa,k=
{},l=0,f=0;f<d.length;f+=3)d[f+1]in k?k[d[f+1]].push(d[f]):k[d[f+1]]=[d[f]],l++;var g=[],m=[];c(b,k[b]);for(f=0;f<m.length;f++)for(var h=l=0;h<d.length;h+=3)m[f][1]==d[h+1]&&m[f][0]==d[h]&&e(a,d[h],d[h+1],l),l++};a.lD=function(a,b){var c=a.X,d=a.oa,e;e="digraph debug {\n    node [shape=box];\n";for(var k=0;k<c.length;k+=2){var l=c[k],f=c[k+1],f=b?b(l,f):String(l);e+="    ";e+=String(l)+' [label="'+f.replace(/\"/g,'\\"')+'"];\n'}for(k=0;k<d.length;k+=3)c=d[k],l=d[k+1],e+="    ",e+=String(c)+" -> "+
String(l)+";\n";return e+="}"}};b4w.module.__ipc=function(a){a.It=0;var q=a.At=1,b=a.Ct=2;a.Bt=3;a.Et=4;a.Ft=5;a.Gt=6;a.Jt=7;var d=a.Lt=8,c=a.Bo=9,e=a.Mt=10;a.Nt=11;var g=a.Ot=12;a.Pt=13;a.Kt=14;a.Ht=15;a.Dt=16;a.ou=100;a.Qt=101;a.Rt=102;a.St=103;a.Tt=104;a.Vt=105;a.Ut=106;a.Wt=107;a.Xt=108;a.Yt=109;a.Zt=110;a.$t=111;a.au=112;a.cu=113;a.du=114;a.qu=115;a.eu=116;a.fu=117;a.gu=118;a.iu=119;a.ju=120;a.ku=121;a.mu=122;a.nu=123;a.pu=124;a.bu=125;a.su=126;a.hu=127;a.Eo=128;a.ru=129;a.tu=130;a.uu=131;a.vu=132;a.wu=133;a.xu=134;a.yu=135;
a.zu=136;a.Au=137;a.Bu=138;a.Cu=139;a.Fo=140;var f=a.kj=141;a.Du=142;a.Do=143;a.Eu=144;a.Fu=145;a.GC=146;a.lu=147;var h=null,p={msg_id:g,body_id:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),linvel:new Float32Array(3),angvel:new Float32Array(3),hb:new Float32Array(16)};p.hb[0]=g;var l={msg_id:d,chassis_hull_body_id:0,prop_ind:0,trans:new Float32Array(3),quat:new Float32Array(4),hb:new Float32Array(10)};l.hb[0]=d;var m={msg_id:c,id:0,body_id_hit:0,hit_fract:0,hit_time:0,hb:new Float32Array(5)};
m.hb[0]=c;var r={msg_id:e,id:0,body_id_hit:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),hb:new Float32Array(11)};r.hb[0]=e;var n={msg_id:q,body_id_a:0,body_id_b:0,result:0,hb:new Float32Array(4)};n.hb[0]=q;var y={msg_id:b,body_id_a:0,body_id_b:0,result:0,coll_point:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,hb:new Float32Array(11)};y.hb[0]=b;var v={msg_id:f,body_id:0,trans:new Float32Array(3),quat:new Float32Array(4),hb:new Float32Array(9)};
v.hb[0]=f;a.init=function(a,x){a.addEventListener("message",function(a){a=a.data;var h=a[0]|0;switch(h){case g:var t=p;t.body_id=a[1];t.time=a[2];t.trans[0]=a[3];t.trans[1]=a[4];t.trans[2]=a[5];t.quat[0]=a[6];t.quat[1]=a[7];t.quat[2]=a[8];t.quat[3]=a[9];t.linvel[0]=a[10];t.linvel[1]=a[11];t.linvel[2]=a[12];t.angvel[0]=a[13];t.angvel[1]=a[14];t.angvel[2]=a[15];break;case d:t=l;t.chassis_hull_body_id=a[1];t.prop_ind=a[2];t.trans[0]=a[3];t.trans[1]=a[4];t.trans[2]=a[5];t.quat[0]=a[6];t.quat[1]=a[7];
t.quat[2]=a[8];t.quat[3]=a[9];break;case c:t=m;t.id=a[1]|0;t.body_id_hit=a[2]|0;t.hit_fract=a[3];t.hit_time=a[4];break;case e:t=r;t.id=a[1]|0;t.body_id_hit=a[2]|0;t.hit_fract=a[3];t.hit_time=a[4];t.hit_pos[0]=a[5];t.hit_pos[1]=a[6];t.hit_pos[2]=a[7];t.hit_norm[0]=a[8];t.hit_norm[1]=a[9];t.hit_norm[2]=a[10];break;case q:t=n;t.body_id_a=a[1]|0;t.body_id_b=a[2]|0;t.result=a[3];break;case b:t=y;t.body_id_a=a[1]|0;t.body_id_b=a[2]|0;t.result=a[3];t.coll_point[0]=a[4];t.coll_point[1]=a[5];t.coll_point[2]=
a[6];t.coll_norm[0]=a[7];t.coll_norm[1]=a[8];t.coll_norm[2]=a[9];t.coll_dist=a[10];break;case f:t=v;t.body_id=a[1]|0;t.trans[0]=a[2];t.trans[1]=a[3];t.trans[2]=a[4];t.quat[0]=a[5];t.quat[1]=a[6];t.quat[2]=a[7];t.quat[3]=a[8];break;default:t=a}x(h,t)},!1);h=a};a.cleanup=function(){h=null};a.C=function(){if(h){switch(arguments[0]|0){case g:var a=p,x=a.hb;x[1]=a.body_id;x[2]=a.time;x[3]=a.trans[0];x[4]=a.trans[1];x[5]=a.trans[2];x[6]=a.quat[0];x[7]=a.quat[1];x[8]=a.quat[2];x[9]=a.quat[3];x[10]=a.linvel[0];
x[11]=a.linvel[1];x[12]=a.linvel[2];x[13]=a.angvel[0];x[14]=a.angvel[1];x[15]=a.angvel[2];break;case d:a=l;x=a.hb;x[1]=a.chassis_hull_body_id;x[2]=a.prop_ind;x[3]=a.trans[0];x[4]=a.trans[1];x[5]=a.trans[2];x[6]=a.quat[0];x[7]=a.quat[1];x[8]=a.quat[2];x[9]=a.quat[3];break;case c:a=m;x=a.hb;x[1]=a.id;x[2]=a.body_id_hit;x[3]=a.hit_fract;x[4]=a.hit_time;break;case e:a=r;x=a.hb;x[1]=a.id;x[2]=a.body_id_hit;x[3]=a.hit_fract;x[4]=a.hit_time;x[5]=a.hit_pos[0];x[6]=a.hit_pos[1];x[7]=a.hit_pos[2];x[8]=a.hit_norm[0];
x[9]=a.hit_norm[1];x[10]=a.hit_norm[2];break;case q:a=n;x=a.hb;x[1]=a.body_id_a;x[2]=a.body_id_b;x[3]=a.result;break;case b:a=y;x=a.hb;x[1]=a.body_id_a;x[2]=a.body_id_b;x[3]=a.result;x[4]=a.coll_point[0];x[5]=a.coll_point[1];x[6]=a.coll_point[2];x[7]=a.coll_norm[0];x[8]=a.coll_norm[1];x[9]=a.coll_norm[2];x[10]=a.coll_dist;break;case f:a=v;x=a.hb;x[1]=a.body_id;x[2]=a.trans[0];x[3]=a.trans[1];x[4]=a.trans[2];x[5]=a.quat[0];x[6]=a.quat[1];x[7]=a.quat[2];x[8]=a.quat[3];break;default:for(x=[],a=0;a<arguments.length;a++)x.push(arguments[a])}h.postMessage(x)}};
a.wq=function(a){switch(a){case g:return p;case d:return l;case c:return m;case e:return r;case q:return n;case b:return y;case f:return v;default:return null}}};b4w.module.__hud=function(a,q){function b(a){a.font="bold 15px Courier";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function d(a){c(' SCENE "'+a.name+'"');if(a.d){var b=0,d=0;h.O(a.d.fb,function(a,e){if("SINK"==e.type)c(" (F)",e.type);else{var l=e.type,f=Math.round(e.i.width)+"x"+Math.round(e.i.height),g=e.p.length,m=e.ei,h=e.enqueue&&e.Xa;h?c(" (A)",l,e.eg,f,m,"of",g):c(" (P)",l,e.eg,f,m,"of",g);e.ei=0;h&&(b+=g,d+=m)}});return[b,d]}c("No INFO")}function c(){for(var a=80+20*l[0],b=[5,
18,3,10,4,3,5],c=arguments[0],d=1;d<arguments.length;d++){for(var e="",f=0;f<b[d]-String(arguments[d]).length;f++)e+=" ";c+=e+arguments[d]}l[0]++;p.fillText(c,30,a)}function e(a,b,c){b*=a.Ea;c.x=a.x+b;c.y=a.y;c.Ea=a.Ea-2*b;c.xa=a.xa}function g(a){return a.x+a.Ea/2}function f(a){var b=p,c={x:0,y:0,Ea:0,xa:0},d=b.canvas.width,b=b.canvas.height;c.x=0;c.y=0;c.Ea=d;c.xa=b;e(c,.01,c);d=.02*c.xa;c.x=c.x;c.y+=d;c.Ea=c.Ea;c.xa-=2*d;d=c.Ea/8;c.x+=d*a;c.y=c.y;c.Ea=d;c.xa=c.xa;e(c,.02,c);return c}var h=q("__graph"),
p=null,l=[0,0];a.init=function(a){a=a.getContext("2d");b(a);return p=a};a.Ih=function(){p&&b(p)};a.reset=function(){var a=p;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),l[0]=0,l[1]=0)};a.GA=function(a,b){var e=p;if(e){e.textAlign="left";e.fillStyle="rgba(0,255,0,255)";c(" FPS",(1/b).toFixed(2));l[0]++;for(var f=e=0,g=0;g<a.length;g++){var h=d(a[g]),e=e+h[0],f=f+h[1];l[0]++}c(" ---------------------------------------------");
c("    ","TOTAL ACTIVE","","",f,"of",e)}};a.print=function(){var a=p;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",c.apply(Math,arguments))};a.plot_array=function(a,b,c,d,e,l,h){var u=p;if(u){b=f(b);var B=b.xa/5;b.x=b.x;b.y+=4*B;b.Ea=b.Ea;b.xa=B;u.textAlign="center";u.fillStyle="#00FF00";p.fillText(a,g(b),b.y-10);u.strokeStyle="#00FF00";u.lineWidth=.5;u.beginPath();u.moveTo(b.x,b.y);u.lineTo(b.x+b.Ea,b.y);u.lineTo(b.x+b.Ea,b.y+b.xa);u.lineTo(b.x,b.y+b.xa);u.closePath();u.stroke();if(!l&&
!h)for(l=1E6,h=-1E6,a=0;a<c.length;a++)l=Math.min(l,c[a]),h=Math.max(h,c[a]);u.textAlign="right";p.fillText(String(l),b.x-10,b.y+b.xa);p.fillText(String(h),b.x-10,b.y);u.textAlign="center";p.fillText(String(d),b.x,b.y+b.xa+15);p.fillText(String(e),b.x+b.Ea,b.y+b.xa+15);u.strokeStyle="#FF0000";u.lineWidth=1.5;u.beginPath();d=b.Ea/(c.length-1);h=b.xa/(h-l);for(a=0;a<c.length;a++)e=b.x+d*a,B=b.y+b.xa-(c[a]-l)*h,0==a?u.moveTo(e,B):u.lineTo(e,B);u.stroke()}};a.draw_mixer_strip=function(a,b,c,d,e,l,h){var u=
p;if(u)for(u.textAlign="center",u.fillStyle="#00FF00",u.font="bold 12px Courier",c=f(c),p.fillText(b?"["+a+"]":a,g(c),c.y),0<=l&&p.fillText(l?"[M]":"[ ]",g(c)-15,c.y+30),0<=h&&p.fillText(h?"[S]":"[ ]",g(c)+15,c.y+30),a={x:0,y:0,Ea:0,xa:0},b=0;b<d.length;b++){l=d[b];var B="VOLUME"==l[0];if(B){h=c.y+350;var t=c.Ea,G=a;G.x=c.x;G.y=h;G.Ea=t;G.xa=250}else{h=c.y+10+50*b;var t=c.Ea,G=c.xa,A=a;A.x=c.x;A.y=h;A.Ea=t;A.xa=G}h=u;var t=a,A=b==e,k=l[0],G=l[1],I=l[2],F=l[3],L=(F-I)/l[4],L=1>L?Math.floor(1/L-1E-5).toFixed(0).length:
0;l=l[5]?Math.log(G/I)/Math.log(F/I):(G-I)/(F-I);h.textAlign="center";A?h.fillText("["+k+"]",g(t),t.y):h.fillText(k,g(t),t.y);h.strokeStyle="#00FF00";h.lineWidth=B?3:1;B?(h.textAlign="right",h.fillText(F.toFixed(L),g(t)-10,t.y+15),h.textAlign="right",h.fillText(I.toFixed(L),g(t)-10,t.y+t.xa-15)):(h.textAlign="right",h.fillText(I.toFixed(L),t.x+28,t.y+15),h.textAlign="left",h.fillText(F.toFixed(L),t.x+t.Ea-28,t.y+15));h.beginPath();if(B){var J=t.y+15+(t.xa-30)*(1-l);h.moveTo(g(t),t.y+15);h.lineTo(g(t),
t.y+t.xa-15);h.moveTo(g(t)-5,t.y+15);h.lineTo(g(t)+5,t.y+15);h.moveTo(g(t)-5,t.y+t.xa-15);h.lineTo(g(t)+5,t.y+t.xa-15);h.moveTo(g(t)-5,J);h.lineTo(g(t)+5,J)}else{var P=t.x+30+(t.Ea-60)*l;h.moveTo(t.x+30,t.y+15);h.lineTo(t.x+t.Ea-30,t.y+15);h.moveTo(t.x+30,t.y+15-5);h.lineTo(t.x+30,t.y+15+5);h.moveTo(t.x+t.Ea-30,t.y+15-5);h.lineTo(t.x+t.Ea-30,t.y+15+5);h.moveTo(P,t.y+15-5);h.lineTo(P,t.y+15+5)}h.stroke();"EQ_Q"==k?(l=Math.log(1+1/(2*G*G)+Math.sqrt((2+1/(G*G))*(2+1/(G*G))/4-1))/Math.log(2),B?(h.textAlign=
"left",h.fillText(G.toFixed(L),g(t)+10,J),h.textAlign="left",h.fillText("("+l.toFixed(L+1)+")",g(t)+10,J+10)):(h.textAlign="right",h.fillText(G.toFixed(L),P,t.y+30),h.textAlign="left",h.fillText("("+l.toFixed(L+1)+")",P,t.y+30))):B?(h.textAlign="left",h.fillText(G.toFixed(L),g(t)+10,J)):(h.textAlign="center",h.fillText(G.toFixed(L),P,t.y+30))}}};b4w.module.__renderer=function(a,q){function b(a){for(var b=a.i,d=a.p,k=0;k<d.length;k++){var l=d[k];if(l.Xa){var f=a,g=b,h=l.td,m=l.B,z=m.Xb;u.useProgram(z.Mi);for(var l=m.R,p=m.Xo,H=z.Zs,K=H.length;K--;){var n=H[K];n.um(u,n.Zf,f,h,m,g)}g=m.Cp;u.colorMask(g,g,g,g);u.depthMask(m.W);m.Ja?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE);g=m.L;for(m=0;m<g.length;m++)H=g[m],u.activeTexture(u.TEXTURE0+m),u.bindTexture(H.Ob,H.Va);if("SKY"==f.type){g=f;z=z.Yi;m=g.i.eb.Va;H=g.di;for(K=0;6>K;K++)if(n=e(K),r.Il?
(u.bindTexture(u.TEXTURE_CUBE_MAP,m),u.texImage2D(n,0,u.RGBA,1,1,0,u.RGBA,u.UNSIGNED_BYTE,x)):(u.uniformMatrix4fv(z.u_cube_view_matrix,!1,H[K]),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,n,m,0),c(l,p,h.ko)),g.kk&&3!=K){var n=g,y=K,v=B;r.Il?v.set(x):(u.readPixels(191,191,1,1,u.RGBA,u.UNSIGNED_BYTE,v),255!=v[0]&&255!=v[1]&&255!=v[2]||u.readPixels(191,220,1,1,u.RGBA,u.UNSIGNED_BYTE,v));var E=v[0],q=v[1],v=v[2],E=E/255,q=q/255,v=v/255;2===y?(n.mc[3]=E,n.mc[7]=q,n.mc[11]=v):2>y?(n.mc[4*y]=
E,n.mc[4*y+1]=q,n.mc[4*y+2]=v):(n.mc[4*(y-2)]=E,n.mc[4*(y-2)+1]=q,n.mc[4*(y-2)+2]=v)}f.ei+=6}else c(l,p,h.ko),f.ei++}}}function d(a){if(a){var b=(a.da?u.COLOR_BUFFER_BIT:0)|(a.ia?u.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case "MAIN_GLOW":a=E;break;case "SHADOW_CAST":a=n;break;case "DEPTH":a=y;break;case "COLOR_PICKING":case "COLOR_PICKING_XRAY":case "ANCHOR_VISIBILITY":a=v;break;case "OUTLINE_MASK":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_EDGE_DETECTION":a=E;break;default:a=r.background_color}}else b=
u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT,a=r.background_color;u.colorMask(!0,!0,!0,!0);u.depthMask(!0);u.clearColor(a[0],a[1],a[2],a[3]);u.clear(b)}function c(a,b,c){u.bindBuffer(u.ARRAY_BUFFER,a.mf);for(var d=0;d<b.length;d++){var e=b[d];u.enableVertexAttribArray(e.Zf);u.vertexAttribPointer(e.Zf,e.sd,u.FLOAT,!1,0,e.yv+e.zx*c)}a.fe?(u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,a.fe),u.drawElements(a.mode,a.count,a.Km,0)):u.drawArrays(a.mode,0,a.count);for(d=0;d<b.length;d++)e=b[d],u.disableVertexAttribArray(e.Zf)}
function e(a){switch(a){case 0:return u.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return u.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return u.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return u.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return u.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return u.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function g(a){var b=a.Yi,c=[],d=[],e={},l;for(l in b){var f=!1;switch(l){case "u_proj_matrix":var g=function(a,b,c,d,e,k){a.uniformMatrix4fv(b,!1,k.sa)},f=!0;break;case "u_view_matrix":case "u_view_matrix_frag":g=
function(a,b,c,d,e,k){a.uniformMatrix4fv(b,!1,k.ma)};f=!0;break;case "u_shadow_cast_billboard_view_matrix":g=function(a,b,c,d,e,k){a.uniformMatrix4fv(b,!1,k.vs)};f=!0;break;case "u_view_proj_prev":g=function(a,b,c,d,e,k){a.uniformMatrix4fv(b,!1,k.Iz)};f=!0;break;case "u_view_proj_inverse":g=function(a,b,c,d,e,k){a.uniformMatrix4fv(b,!1,k.Lh)};f=!0;break;case "u_sky_vp_inverse":g=function(a,b,c,d,e,k){a.uniformMatrix4fv(b,!1,k.xd)};f=!0;break;case "u_camera_eye":case "u_camera_eye_frag":g=function(a,
b,c,d,e,k){a.uniform3fv(b,k.Le)};f=!0;break;case "u_camera_eye_last":g=function(a,b,c,d,e,k){a.uniform3fv(b,k.bq)};f=!0;break;case "u_camera_quat":g=function(a,b,c,d,e,k){a.uniform4fv(b,k.quat)};f=!0;break;case "u_view_max_depth":g=function(a,b,c,d,e,k){a.uniform1f(b,k.Pa)};f=!0;break;case "u_camera_range":g=function(a,b,c,d,e,k){a.uniform2f(b,k.Qa,k.Pa)};break;case "u_csm_center_dists":g=function(a,b,c,d,e,k){a.uniform4fv(b,k.Jp)};break;case "u_cam_water_depth":g=function(a,b,c){a.uniform1f(b,c.Dl)};
f=!0;break;case "u_waves_height":g=function(a,b,c){a.uniform1f(b,c.qf)};break;case "u_waves_length":g=function(a,b,c){a.uniform1f(b,c.Bg)};break;case "u_fog_color_density":g=function(a,b,c){a.uniform4fv(b,c.$b)};break;case "u_underwater_fog_color_density":g=function(a,b,c){a.uniform4fv(b,c.gd)};break;case "u_bloom_key":g=function(a,b,c){a.uniform1f(b,c.bloom_key)};break;case "u_bloom_edge_lum":g=function(a,b,c){a.uniform1f(b,c.bloom_edge_lum)};break;case "u_time":g=function(a,b,c){a.uniform1f(b,c.time)};
f=!0;break;case "u_wind":g=function(a,b,c){a.uniform3fv(b,c.dj)};break;case "u_sky_tex_dvar":g=function(a,b,c){a.uniform1f(b,c.zs)};break;case "u_sky_tex_fac":g=function(a,b,c){a.uniform4fv(b,c.As)};break;case "u_sky_tex_color":g=function(a,b,c){a.uniform3fv(b,c.ys)};break;case "u_horizon_color":g=function(a,b,c){a.uniform3fv(b,c.Ne)};break;case "u_zenith_color":g=function(a,b,c){a.uniform3fv(b,c.rf)};break;case "u_environment_energy":g=function(a,b,c){a.uniform1f(b,c.Ke)};break;case "u_sky_color":g=
function(a,b,c){a.uniform3fv(b,c.uh)};break;case "u_rayleigh_brightness":g=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":g=function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":g=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":g=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":g=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":g=function(a,
b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":g=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":g=function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":g=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":g=function(a,b,c){a.uniform3fv(b,c.Xf)};break;case "u_light_directions":g=function(a,b,c){a.uniform3fv(b,c.Vf)};break;case "u_light_color_intensities":g=
function(a,b,c){a.uniform3fv(b,c.Uf)};break;case "u_light_factors":g=function(a,b,c){a.uniform4fv(b,c.Wf)};break;case "u_sun_quaternion":g=function(a,b,c){a.uniform4fv(b,c.Us)};break;case "u_sun_intensity":g=function(a,b,c){a.uniform3fv(b,c.Ts)};break;case "u_sun_direction":g=function(a,b,c){a.uniform3fv(b,c.Nk)};break;case "u_height":g=function(a,b,c,d,e,k){a.uniform1f(b,k.height)};f=!0;break;case "u_model_matrix":g=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.T)};f=!0;break;case "u_transb":g=function(a,
b,c,d){a.uniform4fv(b,d.Fc)};f=!0;break;case "u_transa":g=function(a,b,c,d){a.uniform4fv(b,d.Ec)};f=!0;break;case "u_arm_rel_trans":g=function(a,b,c,d){a.uniform4fv(b,d.ml)};f=!0;break;case "u_arm_rel_quat":g=function(a,b,c,d){a.uniform4fv(b,d.ll)};f=!0;break;case "u_quat":g=function(a,b,c,d){a.uniform4fv(b,d.quat)};f=!0;break;case "u_quatsb":g=function(a,b,c,d){a.uniform4fv(b,d.xc)};f=!0;break;case "u_quatsa":g=function(a,b,c,d){a.uniform4fv(b,d.wc)};f=!0;break;case "u_frame_factor":g=function(a,
b,c,d){a.uniform1f(b,d.Kf)};f=!0;break;case "au_center_pos":g=function(){};f=!0;break;case "au_wind_bending_amp":g=function(a,b,c,d){a.uniform1f(b,d.Fd)};f=!0;break;case "au_wind_bending_freq":g=function(a,b,c,d){a.uniform1f(b,d.ue)};f=!0;break;case "au_detail_bending_freq":g=function(a,b,c,d){a.uniform1f(b,d.Vd)};f=!0;break;case "au_detail_bending_amp":g=function(a,b,c,d){a.uniform1f(b,d.Ud)};f=!0;break;case "au_branch_bending_amp":g=function(a,b,c,d){a.uniform1f(b,d.Qd)};f=!0;break;case "u_node_values":g=
function(a,b,c,d){a.uniform1fv(b,d.ie)};f=!0;break;case "u_node_rgbs":g=function(a,b,c,d){a.uniform3fv(b,d.tc)};f=!0;break;case "u_diffuse_color":g=function(a,b,c,d,e){a.uniform4fv(b,e.Mc)};f=!0;break;case "u_diffuse_intensity":g=function(a,b,c,d,e){a.uniform1f(b,e.He)};f=!0;break;case "u_diffuse_params":g=function(a,b,c,d,e){a.uniform2fv(b,e.qc)};f=!0;break;case "u_emit":g=function(a,b,c,d,e){a.uniform1f(b,e.$d)};f=!0;break;case "u_ambient":g=function(a,b,c,d,e){a.uniform1f(b,e.Md)};f=!0;break;case "u_specular_color":g=
function(a,b,c,d,e){a.uniform3fv(b,e.yd)};f=!0;break;case "u_specular_alpha":g=function(a,b,c,d,e){a.uniform1f(b,e.vh)};f=!0;break;case "u_specular_params":g=function(a,b,c,d,e){a.uniform3fv(b,e.ic)};f=!0;break;case "u_reflect_factor":g=function(a,b,c,d,e){a.uniform1f(b,e.og)};f=!0;break;case "u_mirror_factor":g=function(a,b,c,d,e){a.uniform1f(b,e.jn)};f=!0;break;case "u_grass_map_dim":g=function(a,b,c,d,e){a.uniform3fv(b,e.bc)};f=!0;break;case "u_grass_size":g=function(a,b,c,d,e){a.uniform1f(b,e.Dm)};
f=!0;break;case "u_scale_threshold":g=function(a,b,c,d,e){a.uniform1f(b,e.Cq)};f=!0;break;case "u_cube_fog":g=function(a,b,c,d,e){a.uniformMatrix4fv(b,!1,e.mc)};break;case "u_jitter_amp":g=function(a,b,c,d,e){a.uniform1f(b,e.ar)};f=!0;break;case "u_jitter_freq":g=function(a,b,c,d,e){a.uniform1f(b,e.br)};f=!0;break;case "u_wireframe_mode":g=function(a,b,c,d,e){a.uniform1i(b,e.wireframe_mode)};break;case "u_wireframe_edge_color":g=function(a,b,c,d,e){a.uniform3fv(b,e.wireframe_edge_color)};break;case "u_subpixel_jitter":g=
function(a,b,c){a.uniform2fv(b,c.Uy)};f=!0;break;case "u_subsample_indices":g=function(a,b,c){a.uniform4fv(b,c.Vy)};f=!0;break;case "u_refr_bump":g=function(a,b,c,d,e){a.uniform1f(b,e.gs)};f=!0;break;case "u_lamp_light_positions":g=function(a,b,c,d,e){a.uniform3fv(b,e.Vm)};break;case "u_lamp_light_directions":g=function(a,b,c,d,e){a.uniform3fv(b,e.Tm)};break;case "u_lamp_light_color_intensities":g=function(a,b,c,d,e){a.uniform3fv(b,e.Sm)};break;case "u_lamp_light_factors":g=function(a,b,c,d,e){a.uniform4fv(b,
e.Um)};break;case "u_halo_size":g=function(a,b,c,d,e){a.uniform1f(b,e.Hq)};f=!0;break;case "u_halo_hardness":g=function(a,b,c,d,e){a.uniform1f(b,e.Eq)};f=!0;break;case "u_halo_rings_color":g=function(a,b,c,d,e){a.uniform3fv(b,e.Gq)};f=!0;break;case "u_halo_lines_color":g=function(a,b,c,d,e){a.uniform3fv(b,e.Fq)};f=!0;break;case "u_halo_stars_blend":g=function(a,b,c,d,e){a.uniform1f(b,e.Iq)};f=!0;break;case "u_halo_stars_height":g=function(a,b,c,d,e){a.uniform1f(b,e.Jq)};f=!0;break;case "u_fresnel_params":g=
function(a,b,c,d,e){a.uniform4fv(b,e.Yc)};f=!0;break;case "u_texture_scale":g=function(a,b,c,d,e){a.uniform3fv(b,e.jf)};f=!0;break;case "u_parallax_scale":g=function(a,b,c,d,e){a.uniform1f(b,e.kg)};f=!0;break;case "u_color_id":g=function(a,b,c,d){a.uniform3fv(b,d.Gj)};f=!0;break;case "u_line_points":g=function(a,b,c,d,e){a.uniform3fv(b,e.mE)};f=!0;break;case "u_diffuse_color_factor":g=function(a,b,c,d,e){a.uniform1f(b,e.Ge)};f=!0;break;case "u_alpha_factor":g=function(a,b,c,d,e){a.uniform1f(b,e.Ae)};
f=!0;break;case "u_specular_color_factor":g=function(a,b,c,d,e){a.uniform1f(b,e.Gs)};f=!0;break;case "u_normal_factor":g=function(a,b,c,d,e){a.uniform1f(b,e.wr)};f=!0;break;case "u_normalmap0_scale":g=function(a,b,c,d,e){a.uniform2fv(b,e.dg[0])};f=!0;break;case "u_normalmap1_scale":g=function(a,b,c,d,e){a.uniform2fv(b,e.dg[1])};f=!0;break;case "u_normalmap2_scale":g=function(a,b,c,d,e){a.uniform2fv(b,e.dg[2])};f=!0;break;case "u_normalmap3_scale":g=function(a,b,c,d,e){a.uniform2fv(b,e.dg[3])};f=!0;
break;case "u_foam_factor":g=function(a,b,c,d,e){a.uniform1f(b,e.foam_factor)};f=!0;break;case "u_foam_uv_freq":g=function(a,b,c,d,e){a.uniform2fv(b,e.eq)};f=!0;break;case "u_foam_mag":g=function(a,b,c,d,e){a.uniform2fv(b,e.dq)};f=!0;break;case "u_foam_scale":g=function(a,b,c,d,e){a.uniform2fv(b,e.om)};f=!0;break;case "u_water_norm_uv_velocity":g=function(a,b,c,d,e){a.uniform1f(b,e.Oh)};f=!0;break;case "u_shallow_water_col":g=function(a,b,c,d,e){a.uniform3fv(b,e.shallow_water_col)};f=!0;break;case "u_shore_water_col":g=
function(a,b,c,d,e){a.uniform3fv(b,e.shore_water_col)};f=!0;break;case "u_water_shallow_col_fac":g=function(a,b,c,d,e){a.uniform1f(b,e.shallow_water_col_fac)};f=!0;break;case "u_water_shore_col_fac":g=function(a,b,c,d,e){a.uniform1f(b,e.shore_water_col_fac)};f=!0;break;case "u_p_length":g=function(a,b,c,d,e){a.uniform1f(b,e.Mr)};f=!0;break;case "u_p_cyclic":g=function(a,b,c,d,e){a.uniform1i(b,e.Ir)};f=!0;break;case "u_p_max_lifetime":g=function(a,b,c,d,e){a.uniform1f(b,e.Or)};f=!0;break;case "u_p_fade_in":g=
function(a,b,c,d,e){a.uniform1f(b,e.Jr)};f=!0;break;case "u_p_fade_out":g=function(a,b,c,d,e){a.uniform1f(b,e.Kr)};f=!0;break;case "u_p_size":g=function(a,b,c,d,e){a.uniform1f(b,e.rn)};f=!0;break;case "u_p_alpha_start":g=function(a,b,c,d,e){a.uniform1f(b,e.Fr)};f=!0;break;case "u_p_alpha_end":g=function(a,b,c,d,e){a.uniform1f(b,e.Er)};f=!0;break;case "u_p_nfactor":g=function(a,b,c,d,e){a.uniform1f(b,e.qn)};f=!0;break;case "u_p_gravity":g=function(a,b,c,d,e){a.uniform1f(b,e.Lr)};f=!0;break;case "u_p_mass":g=
function(a,b,c,d,e){a.uniform1f(b,e.Nr)};f=!0;break;case "u_p_size_ramp":g=function(a,b,c,d,e){a.uniform2fv(b,e.Pr)};f=!0;break;case "u_p_color_ramp":g=function(a,b,c,d,e){a.uniform4fv(b,e.Gr)};f=!0;break;case "u_p_wind":g=function(a,b,c,d,e){a.uniform3fv(b,e.sk)};f=!0;break;case "u_texel_size":g=function(a,b,c){a.uniform2fv(b,c.Zn)};f=!0;break;case "u_p_time":g=function(a,b,c,d,e){a.uniform1f(b,e.uc.P.time)};f=!0;break;case "u_position":g=function(a,b,c,d,e){a.uniform3fv(b,e.Li)};f=!0;break;case "u_va_frame_factor":g=
function(a,b,c,d){a.uniform1f(b,d.lt)};f=!0;break;case "u_perspective_cast_far_bound":g=function(a,b,c){a.uniform1f(b,c.xz)};break;case "u_normal_offset":g=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_pcf_blur_radii":g=function(a,b,c,d,e,k){a.uniform4fv(b,k.xk)};break;case "u_v_light_matrix":g=function(a,b,c){a.uniformMatrix4fv(b,!1,c.kt)};f=!0;break;case "u_b_light_matrix":g=function(a,b,c){a.uniformMatrix4fv(b,!1,c.bp)};break;case "u_p_light_matrix0":g=function(a,b,
c){a.uniformMatrix4fv(b,!1,c.jg[0])};f=!0;break;case "u_p_light_matrix1":g=function(a,b,c){a.uniformMatrix4fv(b,!1,c.jg[1])};f=!0;break;case "u_p_light_matrix2":g=function(a,b,c){a.uniformMatrix4fv(b,!1,c.jg[2])};f=!0;break;case "u_p_light_matrix3":g=function(a,b,c){a.uniformMatrix4fv(b,!1,c.jg[3])};f=!0;break;case "u_motion_blur_exp":g=function(a,b,c){a.uniform1f(b,c.rr)};f=!0;break;case "u_motion_blur_decay_threshold":g=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};f=!0;break;case "u_refl_plane":g=
function(a,b,c,d){a.uniform4fv(b,d.ec)};break;case "u_radial_blur_step":g=function(a,b,c){a.uniform1f(b,c.Ck)};break;case "u_god_rays_intensity":g=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":g=function(a,b,c){a.uniform1f(b,c.yh)};break;case "u_ssao_blur_discard_value":g=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};f=!0;break;case "u_ssao_influence":g=function(a,b,c){a.uniform1f(b,c.xh)};break;case "u_ssao_dist_factor":g=function(a,b,c){a.uniform1f(b,
c.wh)};break;case "u_dof_dist":g=function(a,b,c,d,e,k){a.uniform1f(b,k.dof_distance)};f=!0;break;case "u_dof_front":g=function(a,b,c,d,e,k){a.uniform1f(b,k.dof_front)};f=!0;break;case "u_dof_rear":g=function(a,b,c,d,e,k){a.uniform1f(b,k.dof_rear)};f=!0;break;case "u_outline_intensity":g=function(a,b,c,d){a.uniform1f(b,d.$c)};f=!0;break;case "u_outline_color":g=function(a,b,c){a.uniform3fv(b,c.Ue)};break;case "u_draw_outline":g=function(a,b,c){a.uniform1f(b,c.cm)};f=!0;break;case "u_glow_mask_small_coeff":g=
function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};f=!0;break;case "u_glow_mask_large_coeff":g=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};f=!0;break;case "u_brightness":g=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":g=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":g=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":g=function(a,b,c){a.uniform1f(b,c.saturation)};break;default:g=null}g&&(g={name:l,um:g,Zf:b[l]},f?c.push(g):
(d.push(g),e[l]=g))}a.Zs=c;a.Ii=d;a.tn=e}var f=q("__config"),h=q("__debug"),p=q("__textures"),l=q("__util"),m=q("__camera");q("mat4");var r=f.o,n=[1,1,1,1],y=[1,1,1,1],v=[0,0,0,1],E=[0,0,0,0],x=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var u=null,B=new Uint8Array(4);a.bd=function(a){var b=r.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);
a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);u=a};a.ii=function(a){if(a.Xa){var c=a.i;u.bindFramebuffer(u.FRAMEBUFFER,c.be);if(a.ol){var f=c.eb;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,f.Ob,f.Va,0)}u.viewport(0,0,c.width,c.height);"MAIN_CUBE_REFLECT"!=a.type&&d(a);a.Fa?u.enable(u.BLEND):u.disable(u.BLEND);a.Db?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST);if(a.ja){for(var c=a.i,f=a.p,k=0;k<f.length;k++){var l=
f[k],p=l.B,n=p.Xb;u.useProgram(n.Mi);l=l.td;n.Ii.length||g(n);for(var n=n.Ii,y=n.length;y--;){var B=n[y];B.um(u,B.Zf,a,l,p,c)}}a.ja=!1}switch(a.type){case "DEPTH":r.Uq?(u.enable(u.POLYGON_OFFSET_FILL),u.polygonOffset(5,5)):u.disable(u.POLYGON_OFFSET_FILL);u.cullFace(u.BACK);break;case "SHADOW_CAST":u.enable(u.POLYGON_OFFSET_FILL);u.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);u.cullFace(u.BACK);break;case "MAIN_PLANE_REFLECT":u.disable(u.POLYGON_OFFSET_FILL);u.cullFace(u.FRONT);
break;default:u.disable(u.POLYGON_OFFSET_FILL),u.cullFace(u.BACK)}if("MAIN_CUBE_REFLECT"==a.type)for(c=a.i,f=c.eb.Va,k=0;6>k;k++){p=e(k);c.ma=a.di[k];m.Cl(c);u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,p,f,0);d(a);p=a.p;for(l=0;l<p.length;l++)p[l].Xa=p[l].bm[k];b(a)}else b(a);h.Tv("draw subscene: "+a.type);u.bindFramebuffer(u.FRAMEBUFFER,null)}};a.clear=function(a){u.bindFramebuffer(u.FRAMEBUFFER,a.i.be);d(a)};a.Uo=function(a){var b=a.Xo;b.length=0;var c=a.R;a=a.Xb;c&&a||l.pa("Incomplete batch");
c=c.Ub;a=a.attributes;for(var d in a){var e=c[d];b.push({Zf:a[d],yv:4*e.offset,zx:1<e.frames?4*e.length:0,sd:e.sd})}};a.xv=g;a.Vo=function(a){var b=a.Xb,c=a.L;a=a.Gb;u.useProgram(b.Mi);for(var d=0;d<c.length;d++)u.uniform1i(b.Yi[a[d]],d)};a.fs=function(a,b,c,d,e,f){d||(d=1);e||(e=1);f||(f=new Uint8Array(4*d*e));f.length!=4*d*e&&l.pa("read_pixels(): Wrong storage");u.bindFramebuffer(u.FRAMEBUFFER,a);u.readPixels(b,c,d,e,u.RGBA,u.UNSIGNED_BYTE,f);u.bindFramebuffer(u.FRAMEBUFFER,null);return f};a.yB=
function(a){var b=a.Xb;u.useProgram(b.Mi);b.Ii.length||g(b);b=b.tn.u_cube_fog;b.um(u,b.Zf,null,null,a,null)};a.Tz=function(a,b){var c=u.createFramebuffer();u.bindFramebuffer(u.FRAMEBUFFER,c);if(a){var d=a,e=d.Va,d=d.Ob==u.TEXTURE_CUBE_MAP?u.TEXTURE_CUBE_MAP_NEGATIVE_Z:d.Ob;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,d,e,0)}p.Xq(b)?u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,b.nf):p.xi(b)&&(d=b,e=d.Va,d=d.Ob,u.framebufferTexture2D(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,
d,e,0));h.Pv();u.bindFramebuffer(u.FRAMEBUFFER,null);return c};a.Sz=function(a,b,c,d,e){null==a?(u.bindFramebuffer(u.FRAMEBUFFER,a),u.viewport(0,0,d,e),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT)):(p.xi(b)&&u.deleteTexture(b.Va),p.Xq(c)?u.deleteRenderbuffer(c.nf):p.xi(c)&&u.deleteTexture(c.Va),u.deleteFramebuffer(a))};a.XD=function(){};a.cleanup=function(){}};b4w.module.__shaders=function(a,q){function b(a,b,c){var e=a.Ie;"string"==typeof c&&(a=d(a,c))&&(c=a[1]);for(a=0;a<e.length;a++)if(e[a][0]==b){e[a][1]=c;return}e.push([b,c])}function d(a,b){for(var c=a.Ie,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function c(a,b){var c=a+b;if(t[c])return t[c];if(x){var d=x[b];if(!d)return null}else{d=v.py(a+b);if(!d)return null;d=u.Ur.parse(d)}return t[c]=d}function e(a,b,d){function e(b){b=b.a;for(var d=0;d<b.length;d++){var n=b[d];switch(n.type){case "condition":a:for(var n=
n.a,y=0;y<n.length;y++){var v=n[y];switch(v.type){case "if":case "elif":var O=v.c;try{var T=f(O)}catch(R){throw"Failed to process #"+v.type+" expression: "+O.join(" ");}if(T){e(v.group);break a}break;case "else":e(v.group);break a;case "ifdef":v.name in t&&e(v.group);break;case "ifndef":v.name in t||e(v.group)}}break;case "include":n=c(E.shaders_dir,E.EA+n.file);e(n);break;case "var":case "export":case "import":break;case "define":y=n.name;t[y]=n.b;n.Ra&&(u[y]=n.Ra);break;case "error":throw"Shader error: #error "+
n.b.join(" ");case "line":break;case "pragma":H.push("#pragma "+n.name+" "+n.b.join(" "));break;case "undef":n=n.name;delete t[n];delete u[n];break;case "warning":r.warn("Shader warning: #warning "+n.b.join(" "));break;case "extension":H.push("#extension "+g(n.b,t,u,!1));break;case "#":break;case "node":G[n.name]=n;break;case "nodes_global":n=h;for(y=0;y<n.length;y++)if(v=n[y],O=G[v.id])for(var F=0,I=0;I<O.g.length;I++){var ha=O.g[I];"node_param"==ha.type&&(ha=ha.qualifier.join(" ")+" ","vert"==a?
ha+=v.Nh[F]:"frag"==a&&(ha+=v.Ra[F],null!==v.uk[F]&&(ha+=" = "+v.uk[F])),ha+=";",H.push(ha),F++)}break;case "nodes_main":n=h;for(y=0;y<n.length;y++)if(v=n[y],O=G[v.id]){F={};I={};for(ha=0;ha<v.Wd.length;ha++)I[v.Wd[ha][0]]=[v.Wd[ha][1]];w=q=x=0;for(var ha=v,sa=O.g,S=F,ea=I,D=0;D<sa.length;D++){var U=sa[D];switch(U.type){case "node_in":var va=ha.J[x];if(null!==ha.Nm[x]){if(("MATERIAL"==ha.id&&3===x||"MATERIAL_EXT"==ha.id&&3===x||"TEXTURE_COLOR"==ha.id||"TEXTURE_NORMAL"==ha.id)&&U.e){S[U.name]=ha.Nm[x];
x++;continue}var M=U.qualifier.join(" ")+" ",M=M+va,M=M+(" = "+ha.Nm[x]),M=M+";";H.push(M)}S[U.name]=va;x++;break;case "node_out":va=ha.Ca[q];if(!U.e||-1<B.indexOf(va))M=U.qualifier.join(" ")+" ",M+=va,M+=";",H.push(M),S[U.name]=va;-1<B.indexOf(va)&&(ea["USE_OUT_"+U.name]=[1]);q++;break;case "node_param":"vert"==a?va=ha.Nh[w]:"frag"==a&&(va=ha.Ra[w]),S[U.name]=va,w++}}H.push("{");l(v,O.f,F,I);H.push("}")}break;case "lamp":A[n.name]=n;break;case "lamps_main":n=m;for(y=0;y<n.length;y++)if(v=n[y],v.Sy){H.push("{");
O=A[v.type].f;for(F=0;F<O.length;F++){I=O[F];ha=[];for(sa=0;sa<I.b.length;sa++){S=I.b[sa];switch(S){case "LAMP_IND":S=v.index;break;case "LAMP_LIGHT_FACT_IND":S=v.Yy;break;case "LAMP_FAC_CHANNELS":S=v.Xy;break;case "LAMP_SPOT_SIZE":S=p(v.dd);break;case "LAMP_SPOT_BLEND":S=p(v.sg||.01);break;case "LAMP_LIGHT_DIST":S=p(v.distance);break;case "LAMP_SHADOW_MAP_IND":S=v.Fx?1:0}ha.push(S)}H.push(ha.join(" "))}H.push("}")}break;case "textline":H.push(g(n.b,t,u,!1));break;default:throw"Unknown element type: "+
n.type;}}}function f(a,b){var c=g(a,t,u,!0,b);return y.Ur.parse(c)}function l(a,b,c,d){for(var e=0;e<b.length;e++){var k=b[e];switch(k.type){case "node_condition":a:for(var h=a,k=k.a,m=c,p=d,n=0;n<k.length;n++){var r=k[n];switch(r.type){case "node_if":case "node_elif":var y=r.c;try{var S=f(y,p)}catch(G){throw"Failed to process #"+r.type+" expression: "+y.join(" ");}if(S){l(h,r.f,m,p);break a}break;case "node_else":l(h,r.f,m,p);break a;case "node_ifdef":(r.name in t||r.name in p)&&l(h,r.f,m,p);break;
case "node_ifndef":r.name in t||r.name in p||l(h,r.f,m,p)}}break;case "textline":h=[];for(m=0;m<k.b.length;m++)p=k.b[m],p in c?h.push(c[p]):h.push(p);H.push(g(h,t,u,!0,d))}}}var h=d.nn,m=d.Zm;d=d.Ie||[];for(var H=[],t={},n=0;n<d.length;n++)t[d[n][0]]=[d[n][1]];for(n=0;n<h.length;n++)t["USE_NODE_"+h[n].id]=[1];var u={},G={},A={},B=[];for(n in h)for(var v in h[n].J)B.push(h[n].J[v]);e(b);var x=0,q=0,w=0;return H.join("\n")}function g(a,b,c,d,e){var g=[];f(a,b,c,d,g,e);return g.join(" ")}function f(a,
b,c,d,e,g){for(var l=0;l<a.length;l++){var h=a[l];h in b||g&&h in g?(h=g&&g[h]||b[h],0==h.length&&d?e.push(0):f(h,b,c,d,e,g)):e.push(h)}}function h(a,b,c,d){d=a.createShader(d);a.shaderSource(d,c);a.compileShader(d);n.Uv(d,b,c);return d}function p(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return l(a);case 2:return"vec2("+l(a[0])+","+l(a[1])+")";case 3:return"vec3("+l(a[0])+","+l(a[1])+","+l(a[2])+")";case 4:return"vec4("+l(a[0])+","+l(a[1])+","+l(a[2])+","+l(a[3])+")";case 9:return"mat3("+
l(a[0])+","+l(a[1])+","+l(a[2])+","+l(a[3])+","+l(a[4])+","+l(a[5])+","+l(a[6])+","+l(a[7])+","+l(a[8])+")";case 16:return"mat4("+l(a[0])+","+l(a[1])+","+l(a[2])+","+l(a[3])+","+l(a[4])+","+l(a[5])+","+l(a[6])+","+l(a[7])+","+l(a[8])+","+l(a[9])+","+l(a[10])+","+l(a[11])+","+l(a[12])+","+l(a[13])+","+l(a[14])+","+l(a[15])+")";default:throw"Wrong glsl value dimension";}}function l(a){return a%1?String(a):String(a)+".0"}var m=q("__config"),r=q("__print"),n=q("__debug"),y=q("__gpp_eval"),v=q("__assets");
q("__util");var E=m.Tb;if(b4w.module_check("shader_texts"))var x=q("shader_texts"),u=null;else x=null,u=q("__gpp_parser");var B={},t={},G=[],A=null;a.bd=function(a){A=a};a.v=b;a.dy=d;a.eE=function(a,b){for(var c=a.Ie,d=0;d<c.length;d++)if(c[d][0]==b&&1==c[d][1])return!0;return!1};a.kA=function(a){a.Ie=[];for(var c="ALPHA ALPHA_CLIP BEND_CENTER_ONLY BILLBOARD_PRES_GLOB_ORIENTATION CAUSTICS CSM_BLEND_BETWEEEN_CASCADES CSM_FADE_LAST_CASCADE CSM_SECTION0 CSM_SECTION1 CSM_SECTION2 CSM_SECTION3 DEBUG_SPHERE DEBUG_SPHERE_DYNAMIC DEPTH_RGBA DISABLE_FOG DOUBLE_SIDED_LIGHTING DYNAMIC DYNAMIC_GRASS DYNAMIC_GRASS_COLOR DYNAMIC_GRASS_SIZE FOAM FRAMES_BLENDING BILLBOARD_JITTERED BILLBOARD_SPHERICAL HAIR_BILLBOARD SHADOW_TEX_RES MAIN_BEND_COL MAX_BONES NODES_GLOW NUM_NORMALMAPS PARALLAX PARALLAX_STEPS PERSPECTIVE_SHADOW_CAST PROCEDURAL_FOG PROCEDURAL_SKYDOME REFLECTION REFLECTION_PASS REFLECTION_TYPE REFRACTIVE USE_REFRACTION USE_REFRACTION_CORRECTION SHORE_SMOOTHING SKINNED SKY_COLOR SKY_TEXTURE SSAO_HEMISPHERE SSAO_BLUR_DEPTH SSAO_ONLY SSAO_WHITE STATIC_BATCH TEXTURE_COLOR TEXTURE_NORM TEXTURE_SPEC TEXTURE_STENCIL_ALPHA_MASK VERTEX_ANIM VERTEX_ANIM_MIX_NORMALS_FACTOR VERTEX_COLOR WATER_EFFECTS WIND_BEND DETAIL_BEND SHORE_PARAMS ALPHA_AS_SPEC DEPTH_RGBA MTEX_NEGATIVE MTEX_RGBTOINT NUM_LIGHTS NUM_LFACTORS NUM_LAMP_LIGHTS MAX_STEPS BILLBOARD_ALIGN SHADOW_USAGE POST_EFFECT SSAO_QUALITY TEXTURE_BLEND_TYPE TEXTURE_COORDS AA_METHOD AU_QUALIFIER BILLBOARD BILLBOARD_RANDOM PRECISION EPSILON USE_ENVIRONMENT_LIGHT WO_SKYBLEND WO_SKYPAPER WO_SKYREAL WO_SKYTEX WOMAP_BLEND WOMAP_HORIZ WOMAP_ZENUP WOMAP_ZENDOWN WIREFRAME_QUALITY SIZE_RAMP_LENGTH COLOR_RAMP_LENGTH PARTICLES_SHADELESS".split(" "),
d=0;d<c.length;d++){var e=c[d],f;switch(e){case "ALPHA":case "ALPHA_CLIP":case "BILLBOARD_PRES_GLOB_ORIENTATION":case "CAUSTICS":case "CSM_SECTION0":case "CSM_SECTION1":case "CSM_SECTION2":case "CSM_SECTION3":case "DEBUG_SPHERE":case "DEBUG_SPHERE_DYNAMIC":case "DEPTH_RGBA":case "DISABLE_FOG":case "DOUBLE_SIDED_LIGHTING":case "DYNAMIC":case "DYNAMIC_GRASS":case "DYNAMIC_GRASS_COLOR":case "DYNAMIC_GRASS_SIZE":case "FOAM":case "FRAMES_BLENDING":case "BILLBOARD_JITTERED":case "MAIN_BEND_COL":case "MAX_BONES":case "MTEX_NEGATIVE":case "MTEX_RGBTOINT":case "NODES_GLOW":case "NUM_LIGHTS":case "NUM_LFACTORS":case "NUM_NORMALMAPS":case "PARALLAX":case "PARALLAX_STEPS":case "PERSPECTIVE_SHADOW_CAST":case "PROCEDURAL_FOG":case "PROCEDURAL_SKYDOME":case "REFLECTION":case "REFLECTION_PASS":case "REFLECTION_TYPE":case "REFRACTIVE":case "USE_REFRACTION":case "USE_REFRACTION_CORRECTION":case "SHORE_SMOOTHING":case "SKINNED":case "SKY_COLOR":case "SKY_TEXTURE":case "SSAO_HEMISPHERE":case "SSAO_BLUR_DEPTH":case "SSAO_ONLY":case "SSAO_WHITE":case "STATIC_BATCH":case "TEXTURE_COLOR":case "TEXTURE_NORM":case "TEXTURE_SPEC":case "TEXTURE_STENCIL_ALPHA_MASK":case "VERTEX_ANIM":case "VERTEX_COLOR":case "WATER_EFFECTS":case "WIND_BEND":case "DETAIL_BEND":case "SHORE_PARAMS":case "BILLBOARD":case "BILLBOARD_RANDOM":case "HAIR_BILLBOARD":case "USE_ENVIRONMENT_LIGHT":case "WO_SKYBLEND":case "WO_SKYPAPER":case "WO_SKYREAL":case "WO_SKYTEX":case "WOMAP_BLEND":case "WOMAP_HORIZ":case "WOMAP_ZENUP":case "WOMAP_ZENDOWN":case "WIREFRAME_QUALITY":case "SIZE_RAMP_LENGTH":case "COLOR_RAMP_LENGTH":case "PARTICLES_SHADELESS":case "SMAA_JITTER":f=
0;break;case "ALPHA_AS_SPEC":case "BEND_CENTER_ONLY":case "CSM_BLEND_BETWEEEN_CASCADES":case "CSM_FADE_LAST_CASCADE":case "DEPTH_RGBA":case "BILLBOARD_SPHERICAL":case "NUM_LAMP_LIGHTS":case "MAX_STEPS":f=1;break;case "SHADOW_TEX_RES":f=p(2048);break;case "AA_METHOD":f="AA_METHOD_FXAA_QUALITY";break;case "AU_QUALIFIER":f="NOT_ASSIGNED";break;case "BILLBOARD_ALIGN":f="BILLBOARD_ALIGN_VIEW";break;case "POST_EFFECT":f="POST_EFFECT_NONE";break;case "SHADOW_USAGE":f="NO_SHADOWS";break;case "SSAO_QUALITY":f=
"SSAO_QUALITY_32";break;case "TEXTURE_BLEND_TYPE":f="TEXTURE_BLEND_TYPE_MIX";break;case "TEXTURE_COORDS":f="TEXTURE_COORDS_UV_ORCO";break;case "PRECISION":f=m.o.precision;break;case "EPSILON":f="highp"==m.o.precision?1E-6:1E-4;break;case "VERTEX_ANIM_MIX_NORMALS_FACTOR":f="u_va_frame_factor";break;default:r.error("Unknown directive ("+a.bj+", "+a.mi+"): "+e)}b(a,e,f)}};a.QD=function(a){return a.bj};a.tq=function(a){return a.mi};a.YD=function(a,c){for(var e=c.Ie,f=0;f<e.length;f++){var g=e[f][0],l=
e[f][1];d(a,g)&&b(a,g,l)}};a.$x=function(a){var b=JSON.stringify(a),d=B[b];if(d)return d;var f=a.mi,d=c(E.shaders_dir,a.bj),f=c(E.shaders_dir,f);if(!d||!f)return null;var g=e("vert",d,a),l=e("frag",f,a),d=A,m=h(d,b,g,d.VERTEX_SHADER),p=h(d,b,l,d.FRAGMENT_SHADER),f=d.createProgram();d.attachShader(f,m);d.attachShader(f,p);d.linkProgram(f);d.validateProgram(f);d.getProgramParameter(f,d.VALIDATE_STATUS)==d.DC&&r.error("shader program is not valid",b);n.Vv(f,b,m,p,g,l);a={po:m,iq:p,Mi:f,attributes:{},
Yi:{},Ii:[],tn:{},Zs:[],pb:a};l=d.getProgramParameter(f,d.ACTIVE_ATTRIBUTES);for(g=0;g<l;g++)m=d.getActiveAttrib(f,g).name,a.attributes[m]=d.getAttribLocation(f,m);l=d.getProgramParameter(f,d.ACTIVE_UNIFORMS);for(g=0;g<l;g++)m=d.getActiveUniform(f,g).name.split("[0]").join(""),a.Yi[m]=d.getUniformLocation(f,m);return B[b]=d=a};a.Tw=function(){return G};a.qq=function(){return B};a.cleanup=function(){for(var a in B){var b=B[a];A.deleteProgram(b.Mi);A.deleteShader(b.po);A.deleteShader(b.iq);delete B[a]}for(var c in t)delete t[c];
for(var d in G)delete G[d]};a.mD=function(a){var b=a.Ie;r.log("Shader: "+a.bj+" "+a.mi+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)r.log("  "+b[a][0],b[a][1])};a.t=p;a.vp=function(a,b){return b in a.Yi?!0:!1};a.sy=function(a){return(A.getShaderSource(a).match(/(?:^|\s)varying(?=\s)/g)||[]).length}};b4w.module.__geometry=function(a,q){function b(a){return 65536<a.K?I.sq()?!1:!0:!1}function d(a){return 0<a.ea.length?!0:!1}function c(a,b,c){if(!d(a))return a;c||G.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.K*(b||1)+", will use drawArrays","color: #aa0");b=a.ea;c=a.K;var f=a.H,g=a.A,l;for(l in f){var k=f[l],h=y(k,c);f[l]=e(b,k,h)}for(f=0;f<g.length;f++){var m=g[f];for(l in m)k=m[l],h=y(k,c),m[l]=e(b,k,h)}for(f=0;f<a.V.length;f++){l=a.V[f].Qb;for(var p in l)k=l[p],h=
y(k,c),l[p]=e(b,k,h)}a.K=b.length;a.ea=new Uint16Array(0);return a}function e(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),e=0;e<a.length;e++)for(var f=a[e],g=0;g<c;g++)d[c*e+g]=b[c*f+g];return d}function g(a,b){var c=a.ed,d=a.Ub[b];if(d)return c.subarray(d.offset,d.offset+d.length);throw"extract_array() failed; invalid name: "+b;}function f(b,c){var d,e;switch(c){case a.Ph:case a.jj:d=z.TRIANGLES;e=z.STATIC_DRAW;break;case a.Ao:d=z.POINTS;e=z.STATIC_DRAW;
break;case a.ij:d=z.TRIANGLES;e=z.DYNAMIC_DRAW;break;case a.zo:d=z.POINTS;e=z.DYNAMIC_DRAW;break;case a.xt:d=z.LINES;e=z.STATIC_DRAW;break;default:throw"Wrong draw_mode";}b.mode=d;b.aj=e}function h(a){a.Oe?(a.fe||(a.fe=z.createBuffer()),z.bindBuffer(z.ELEMENT_ARRAY_BUFFER,a.fe),z.bufferData(z.ELEMENT_ARRAY_BUFFER,a.Oe,a.aj),a.Lj=a.Oe.byteLength):a.Lj=0;a.mf||(a.mf=z.createBuffer());z.bindBuffer(z.ARRAY_BUFFER,a.mf);z.bufferData(z.ARRAY_BUFFER,a.ed,a.aj);a.Np=a.ed.byteLength}function p(a){for(var b=
k.lb("JOIN_"+a.length+"_SUBMESHES"),c=0,d=0;d<a.length;d++)c+=a[d].ea.length;b.ea=new Uint32Array(c);var e=c=0,f=0;if(0<a[0].V.length)for(var g=0;g<a[0].V.length;g++){for(d=0;d<a.length;d++)c+=a[d].V[g].Qb.a_position.length,e+=a[d].V[g].Qb.a_normal.length,f+=a[d].V[g].Qb.a_tangent.length;d={a_position:new Float32Array(c),a_normal:new Float32Array(e),a_tangent:new Float32Array(f)};b.V.push({ak:a[0].V[g].ak,Qb:d})}for(d=c=0;d<a.length;d++)c+=a[d].K;b.K=c;var e=a[0],l;for(l in e.H){for(d=c=0;d<a.length;d++)c+=
a[d].H[l].length;b.H[l]=new Float32Array(c)}for(l in e.A[0]){for(d=c=0;d<a.length;d++)c+=a[d].A[0][l].length;for(d=0;d<e.A.length;d++)b.A[d]=b.A[d]||{},b.A[d][l]=new Float32Array(c)}for(l=e=c=0;l<a.length;l++){for(var f=a[l],h=f.ea,g=f.K,m=f.H,d=0;d<h.length;d++)b.ea[c+d]=h[d]+e;var c=c+h.length,p;for(p in m){var h=m[p],n=e*y(h,g);b.H[p].set(h,n)}for(d=0;d<f.A.length;d++){var m=f.A[d],t=b.A[d];for(p in m)h=m[p],n=e*y(h,g),t[p].set(h,n)}e+=g}if(0<b.V.length)for(l=0;l<b.V.length;l++)for(p=b.V[l].Qb,
d=f=e=c=0;d<a.length;d++)g=a[d].V[l].Qb,p.a_position.set(g.a_position,c),p.a_normal.set(g.a_normal,e),p.a_tangent.set(g.a_tangent,f),c+=g.a_position.length,e+=g.a_normal.length,f+=g.a_tangent.length;return b}function l(a,b,d,e,f,g){var l=k.lb("SUBMESH_"+a.name+"_"+b),h=a.submeshes[b],p=h.base_length,t=a.materials[b];l.K=p;var y=!1;if(r(d,"a_texcoord")){var A=null,v=a.materials[b];b=a.submeshes[b];if(v.texture_slots.length)switch(v=v.texture_slots[0],v.texture_coords){case "UV":v=a.uv_textures.indexOf(v.uv_layer);
0==v||-1==v?A=new Float32Array(b.texcoord):1==v&&(A=new Float32Array(b.texcoord2));break;case "ORCO":for(var B=a.b4w_bounding_box_source,A=new Float32Array(2*b.base_length),v=(B.max_x+B.min_x)/2,x=(B.max_z+B.min_z)/2,z=B.max_x-B.min_x,B=B.max_z-B.min_z,L=0,F=0;F<b.position.length;F+=3)A[L++]=(b.position[F]-v)/z+.5,A[L++]=(x-b.position[F+2])/B+.5}null===A&&(A=new Float32Array(b.texcoord));b=A}else b=new Float32Array(0);if(r(d,"a_orco_tex_coord")){A=a.b4w_bounding_box_source;v=new Float32Array(3*h.base_length);
x=A.max_x-A.min_x;z=A.max_z-A.min_z;B=A.max_y-A.min_y;for(F=L=0;F<h.position.length;F+=3)0==x?v[L++]=-1:v[L++]=parseFloat(((h.position[F]-A.min_x)/x).toFixed(3)),0==z?v[L++]=-1:v[L++]=parseFloat(((-A.min_z-h.position[F+2])/z).toFixed(3)),0==B?v[L++]=-1:v[L++]=parseFloat(((h.position[F+1]-A.min_y)/B).toFixed(3));A=v}else A=new Float32Array(0);var T,v=h.group;if(r(d,"a_influence")&&e){x=new Float32Array(4*p);z=v.length/p;B=new Float32Array(z);for(L=0;L<z;L++)for(T in B[L]=-1,e)if(F=e[T],F.pt===L){B[L]=
F.fi;break}var R=3<z?z:4;e=new Float32Array(R);T=new Uint32Array(R);for(var L=new Float32Array(4),F=new Float32Array(R),R=new Uint32Array(R),V=new Float32Array(4),q=0;q<p;q++)e.set(F),T.set(R),L.set(V),x.set(n(v,z,q,p,B,e,T,L),4*q)}else x=new Float32Array(0);T=x;e=f?k.qa(f):{};e.a_color={Mf:!0};e.a_color.src=r(d,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,Nc:7}]:[];f={a_texcoord:b,a_influence:T,a_orco_tex_coord:A};T=h.vertex_colors;b=h.color;A=a.name;v=[];for(x=0;x<T.length;x++)v.push(T[x].name);
for(var E in e)if(x=e[E].src,x.length){for(B=z=0;B<x.length;B++)z+=k.pg(x[B].Nc);f[E]=new Float32Array(z*p);for(B=L=0;B<x.length;B++){var J=x[B].name,F=x[B].Nc,R=k.ls(F),S=v.indexOf(J);-1==S&&k.pa('vertex color "'+J+'" for mesh "'+A+'" not found.');V=T[S].mask;q=k.pg(V);(F&V)!==F&&G.error("Wrong color extraction from "+J+" to "+E+".");for(var ea=J=0;ea<S;ea++)J+=k.pg(T[ea].mask);S=J*p;for(J=0;J<p;J++)for(ea=0;3>ea;ea++)R[ea]&&(f[E][J*z+(L+k.Si(F,ea))]=b[S+J*q+k.Si(V,ea)]);L+=q}}else f[E]=new Float32Array(0);
E=a.uv_textures;e=h.texcoord;T=h.texcoord2;b=a.name;if(g)for(var D in g){A=E.indexOf(D);-1==A&&k.pa('uv map "'+D+'" for mesh "'+b+'" not found');if(0==A)var U=new Float32Array(e);else 1==A&&(U=new Float32Array(T));f[g[D]]=U}l.H=f;l.ea=new Uint32Array(h.indices);g=h.position.length/p/3;U=(D=r(d,"a_normal")&&h.normal.length?!0:!1)&&r(d,"a_tangent")&&h.tangent.length?!0:!1;E=D&&t.texture_slots.length&&r(d,"a_tangent")&&"ORCO"==t.texture_slots[0].texture_coords?!0:!1;0<a.b4w_shape_keys.length&&(y=!0);
for(f=0;f<g;f++){t=m(h,d,p,D,U,E,f);if(y)if(e={},e.name=a.b4w_shape_keys[f].name,l.V.push(e),0!=f){e.Qb=t;e.ak=a.b4w_shape_keys[f].value;continue}else e.Qb=m(h,d,p,D,U,E,f),e.ak=1;l.A.push(t)}if(1<g&&!y){a=l.A[0];var t={},va;for(va in a)t[va]=new Float32Array(a[va]);l.A.push(t)}r(d,"a_polyindex")&&(c(l,1,!0),l.H.a_polyindex=u(l));return l}function m(a,b,c,d,e,f,g){var l={},h=new Float32Array(3*c),m=new Float32Array(d?3*c:0),p=new Float32Array(e||f?4*c:0),n=g*c*3;h.set(a.position.subarray(n,n+3*c),
0);d&&(n=g*c*3,m.set(a.normal.subarray(n,n+3*c),0));if(e)n=g*c*4,p.set(a.tangent.subarray(n,n+4*c),0);else if(f)for(a=p,G.warn('Not precise tangents calculation for normalmap using GENERATED texture coordinates in mesh: "'+mesh.name+'". Please add a UV-map.'),b=0;b<c;b++)d=L,e=J,d[0]=m[3*b],d[1]=m[3*b+1],d[2]=m[3*b+2],F.cross(d,k.AXIS_Z,e),0==F.length(e)&&F.cross(d,k.AXIS_X,e),F.normalize(e,e),a[4*b]=e[0],a[4*b+1]=e[1],a[4*b+2]=e[2],a[4*b+3]=1;else if(d&&r(b,"a_tangent"))for(p=new Float32Array(4*
c),c=0;c<p.length;c++)p[c]=1;l.a_position=h;l.a_normal=m;l.a_tangent=p;return l}function r(a,b){return-1<a.indexOf(b)?!0:!1}function n(b,c,d,e,f,g,l,k){for(var h=!0,m=0;m<c;m++){var p=b[m*e+d];if(-1!==p){var n=f[m];-1!==n&&(g[m]=p,l[m]=n,h=!1)}}if(h)return k;v(g,l,a.bl,!1);for(m=b=0;4>m;m++)b+=g[m];if(.01>b)return k;for(m=0;4>m;m++)g[m]/=b;if(.01>Math.abs(g[0]-1))k[0]=l[0]+1;else for(m=0;4>m;m++)k[m]=l[m]+g[m];return k}function y(a,b){if(0==b)return 0;var c=a.length,d=c/b;if(d!=Math.floor(d))throw"Array size mismatch during geometry calculation: array length="+
c+", base length="+b;return d}function v(b,c,d,e){for(var f=b.length,g=f,l=!1,k=e?-1:1;1<g||l;){1<g&&(g=Math.floor(g/1.247330950103979));for(var l=!1,h=0;g+h<f;h++)if(d==a.bl?0>k*(b[h]-b[h+g]):b[h]<b[h+g]&&e)l=b[h],b[h]=b[h+g],b[h+g]=l,l=c[h],c[h]=c[h+g],c[h+g]=l,l=!0}}function E(a,b,c){var d=[],e=[];F.subtract(b,a,d);F.subtract(c,a,e);F.normalize(d,d);F.normalize(e,e);return Math.acos(F.dot(d,e))}function x(a,b,c){b||(b=[]);c=c?a.A[0].a_normal:a.A[0].a_position;if(d(a)){a=a.ea;for(var e=a.length/
3,f=0;f<e;f++){var g=new Float32Array(9),l=a[3*f];g[0]=c[3*l];g[1]=c[3*l+1];g[2]=c[3*l+2];l=a[3*f+1];g[3]=c[3*l];g[4]=c[3*l+1];g[5]=c[3*l+2];l=a[3*f+2];g[6]=c[3*l];g[7]=c[3*l+1];g[8]=c[3*l+2];b[f]=g}}else for(f=0;f<c.length;f++)g=new Float32Array(9),g[0]=c[9*f],g[1]=c[9*f+1],g[2]=c[9*f+2],g[3]=c[9*f+3],g[4]=c[9*f+4],g[5]=c[9*f+5],g[6]=c[9*f+6],g[7]=c[9*f+7],g[8]=c[9*f+8],b[f]=g;return b}function u(a){for(var b=new Float32Array(a.K),c=0;c<a.K;c++)b[c]=c%3;return b}function B(a,b,c){var d=F.dist(a,
b);a=F.dist(a,c);b=F.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function t(a,b,c,d,e){c-=b;for(var f=0;f<c;f+=d)f%d==e&&vec3.normalize(a.subarray(f+b-e,f+b+1),a.subarray(f+b-e,f+b+1))}var G=q("__print"),A=q("__tsr"),k=q("__util"),I=q("__extensions"),F=q("vec3"),L=new Float32Array(3),J=new Float32Array(3),P=new Float32Array(3);a.Kd=10;a.Ho=20;a.JC=30;a.jj=10;a.Ao=20;a.ij=30;a.zo=40;a.xt=50;a.bl=0;a.Hu=1;a.Ph=a.jj;var z=null;a.bd=function(a){z=a};a.nD=function(a){var b=_buffers[a];z.deleteBuffer(b.fe);
z.deleteBuffer(b.mf);delete _buffers[a]};a.eB=function(e,g,l,k){b(e)&&c(e);var m=e.ea,p=e.K,n=e.A,t={},r;for(r in e.H)r in k&&!k[r].Mf||(t[r]=e.H[r]);k={Oe:null,ed:null,Km:0,count:0,Ub:{},mode:0,aj:0,Lj:0,Np:0,mf:null,fe:null,Zj:null,V:null};if(0<e.V.length){r=n[0];for(var A=1;A<e.V.length;A++){for(var u=e.V[A].Qb,G=u.a_position,v=u.a_normal,B=r.a_position,x=r.a_normal,L=G.length,F=e.V[A].ak,J=0;J<L;J++)B[J]+=F*G[J],x[J]+=F*v[J];u=u.a_tangent;G=r.a_tangent;v=u.length;for(J=0;J<v;J++)G[J]+=F*u[J]}}if(m.length)if(r=
m.length,65536>=p)var A=new Uint16Array(m),T=z.UNSIGNED_SHORT;else A=new Uint32Array(m),T=z.UNSIGNED_INT;else r=p,A=null;var F=0,J=n.length,R;for(R in n[0])u=n[0][R],F+=u.length*J;for(R in t)u=t[R],F+=u.length;R=new Float32Array(F);var F=0,J={},V;for(V in t)if(G=t[V],u=G.length)R.set(G,F),J[V]={WC:V,sd:y(G,p),offset:F,frames:1,length:u},F+=u;t=n.length;for(V in n[0])if(G=n[0][V],u=G.length,G=y(G,p),u)for(J[V]={sd:G,offset:F,frames:t,length:u},1<t&&(J[V+"_next"]={sd:G,offset:F+u,frames:t,length:u}),
v=0;v<t;v++)G=n[v][V],R.set(G,F),F+=u;k.count=r;k.Oe=A;k.ed=R;k.Km=T;k.Ub=J;f(k,l);h(k);g!=a.Kd&&d(e)&&(k.Zj={jz:new Float32Array(m.length),kz:new Float32Array(m.length),fx:new Float32Array(m.length/3),type:g});k.V=e.V;return k};a.Qy=b;a.Py=d;a.Un=c;a.AB=function(a,b,c){f(a,b);a.count=c.length;a.Oe=c;a.Km=c instanceof Uint16Array?z.UNSIGNED_SHORT:z.UNSIGNED_INT};a.Rk=function(a,b,c,d){var e=a.ed,f=a.Ub,g=f[b];g?(c&&g.sd!=c&&k.pa('invalid num_comp for "'+b+'"'),e.set(d,g.offset)):(e=e.length,g=new Float32Array(e+
d.length),g.set(a.ed),g.set(d,e),a.ed=g,f[b]={sd:c,offset:e});h(a)};a.qx=g;a.rE=function(a){a.aj=z.STATIC_DRAW};a.dz=function(a){a.aj=z.DYNAMIC_DRAW};a.et=h;a.xp=function(a){a.fe&&z.deleteBuffer(a.fe);a.mf&&z.deleteBuffer(a.mf)};a.Kq=function(a,b){return a.submeshes[b].base_length?!1:!0};a.Ss=function(a,b){for(var c=0;c<a.A.length;c++){var d=a.A[c].a_position;A.transform_vectors(d,b,d,0);d=a.A[c].a_normal;0<d.length&&A.transform_dir_vectors(d,b,d,0);d=a.A[c].a_tangent;0<d.length&&A.transform_tangents(d,
b,d,0)}(c=a.H.au_center_pos)&&c.length&&A.transform_vectors(c,b,c,0);return a};a.cB=function(a,b){var c=a.H.au_center_pos;if(c&&c.length){var d=new Float32Array(c);A.transform_vectors(d,b,d,0);for(var e=0;e<a.A.length;e++)for(var f=0;f<d.length;f++)a.A[e].a_position[f]+=d[f]-c[f];c.set(d)}else throw'Attribute "au_center_pos" is missing in particle submesh';};a.bB=function(a,b){var c=a.K,d;for(d in b){var e=b[d].length;a.H[d]=new Float32Array(e*c);for(var f=0;f<c;f++)for(var g=0;g<e;g++)a.H[d][f*e+
g]=b[d][g]}};a.dB=p;a.cz=function(a,b,d){if(!a.K)return k.lb("EMPTY");var e=d.length;65536<a.K*e&&!I.sq()&&c(a,e);var f=a.ea,g=a.K,l=a.H;a=a.A;for(var h in b){var m=b[h].length,p=m*g;l[h]=new Float32Array(p);for(var n=0;n<g;n++)for(p=0;p<m;p++)l[h][n*m+p]=b[h][p]}b=k.lb("CLONE_"+e+"_SUBMESHES");b.K=g*e;b.ea=new Uint32Array(f.length*e);for(n=0;n<e;n++)for(m=f.length*n,h=g*n,p=0;p<f.length;p++)b.ea[m+p]=f[p]+h;for(var t in l)for(f=l[t],p=f.length*e,m=y(f,g),b.H[t]=new Float32Array(p),n=0;n<e;n++)h=
g*m*n,b.H[t].set(f,h);for(t in a[0])for(n=0;n<a.length;n++)for(f=a[n][t],p=f.length*e,m=y(f,g),b.A[n]=b.A[n]||{},b.A[n][t]=new Float32Array(p),p=0;p<e;p++)switch(l=d[p],h=g*m*p,t){case "a_position":A.transform_vectors(f,l,b.A[n][t],h);break;case "a_normal":A.transform_dir_vectors(f,l,b.A[n][t],h);break;case "a_tangent":A.transform_tangents(f,l,b.A[n][t],h);break;default:throw"Wrong attribute name: "+t;}return b};a.$p=l;a.tx=function(a){var b=a.K,c=a.A[0].a_position,d=new Float32Array(12*b),e=new Float32Array(8*
b);a=new Uint16Array(4*a.ea.length);for(var f=0;f<b;f++)d[12*f]=c[3*f],d[12*f+1]=c[3*f+1],d[12*f+2]=c[3*f+2],d[12*f+3]=c[3*f],d[12*f+4]=c[3*f+1],d[12*f+5]=c[3*f+2],d[12*f+6]=c[3*f],d[12*f+7]=c[3*f+1],d[12*f+8]=c[3*f+2],d[12*f+9]=c[3*f],d[12*f+10]=c[3*f+1],d[12*f+11]=c[3*f+2],e[8*f]=-.5,e[8*f+1]=-.5,e[8*f+2]=-.5,e[8*f+3]=.5,e[8*f+4]=.5,e[8*f+5]=.5,e[8*f+6]=.5,e[8*f+7]=-.5,a[6*f]=4*f+2,a[6*f+1]=4*f+1,a[6*f+2]=4*f,a[6*f+3]=4*f+2,a[6*f+4]=4*f,a[6*f+5]=4*f+3;c=k.lb("HALO");c.A=[];c.A[0]={};c.K=4*b;c.A[0].a_position=
d;c.H.a_halo_bb_vertex=e;c.ea=a;return c};a.Ay=r;a.aq=function(a,b,c){for(var d=[],e=0;e<a.submeshes.length;e++){var f=l(a,e,b,null,c,null);f.K&&d.push(f)}return 0==d.length?k.lb("EMPTY"):1==d.length?d[0]:p(d)};a.zB=function(a,b,c){for(var d=a.Oe,e=g(a,"a_position"),f=a.Zj,l=f.jz,h=f.kz,f=f.fx,m=d,p=m.length/3,n=0;n<p;n++){var t=m[3*n],r=m[3*n+1],y=m[3*n+2],u=e[3*t+1],A=e[3*t+2],G=e[3*r+1],v=e[3*r+2],B=e[3*y+1],x=e[3*y+2];l[3*n]=(e[3*t]+e[3*r]+e[3*y])/3;l[3*n+1]=(u+G+B)/3;l[3*n+2]=(A+v+x)/3}k.We(l,
b,h);b=h.length/3;for(e=0;e<b;e++)l=h[3*e]-c[0],m=h[3*e+1]-c[1],p=h[3*e+2]-c[2],f[e]=l*l+m*m+p*p;c=d;d=f.length;if(!(2>d))for(h=d,e=!1;1<h||e;)for(1<h&&(h=Math.floor(h/1.247330950103979)),e=!1,b=0;h+b<d;b++)0>f[b]-f[b+h]&&(e=f[b],f[b]=f[b+h],f[b+h]=e,e=c,l=b,m=b+h,p=e[3*l],n=e[3*l+1],t=e[3*l+2],e[3*l]=e[3*m],e[3*l+1]=e[3*m+1],e[3*l+2]=e[3*m+2],e[3*m]=p,e[3*m+1]=n,e[3*m+2]=t,e=!0);d=c;z.bindBuffer(z.ELEMENT_ARRAY_BUFFER,a.fe);z.bufferData(z.ELEMENT_ARRAY_BUFFER,d,z.DYNAMIC_DRAW)};a.Es=v;a.kp=function(a,
b,c){for(var d=b.length/3,e=a.length/3,f=[],g=Array(3),l=Array(3),k=Array(3),h=0;h<e;h++){for(var m=a[3*h],p=a[3*h+1],n=a[3*h+2],t=0;3>t;t++)g[t]=b[3*m+t],l[t]=b[3*p+t],k[t]=b[3*n+t];if(c)var t=E(g,l,k),r=E(l,k,g),y=Math.PI-t-r;else y=r=t=1;var u=f,A;A=g;var G=k,v=[],B=[],x=[];F.subtract(l,A,v);F.subtract(G,A,B);F.cross(v,B,x);F.normalize(x,x);A=x;for(G=0;3>G;G++)v=3*p+G,B=3*n+G,u[3*m+G]=t*A[G],u[v]=r*A[G],u[B]=y*A[G]}if(c)for(var z in c)for(h=c[z],a=0;3>a;a++){b=3*h[0]+a;for(e=1;e<h.length;e++)g=
3*h[e]+a,f[b]+=f[g];for(e=1;e<h.length;e++)g=3*h[e]+a,f[g]=f[b]}for(h=0;h<d;h++){c=h;z=f;a=new Float32Array(3);for(b=0;3>b;b++)e=3*c+b,a[b]=z[e];F.normalize(a,a);for(b=0;3>b;b++)e=3*c+b,z[e]=a[b]}return f};a.mp=function(a,b,c){for(var d={},e=b.length/3,f=0;f<e;f++){var g=String(b[3*f])+String(b[3*f+1])+String(b[3*f+2]);d[g]=[]}e=a.length;for(f=0;f<e;f++)b=a[f],g=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),g in d&&d[g].push(b);return d};a.wm=function(a,b,c,d){var e=x(a,null,!1);if(c)var f=x(a,
null,!0);var g=e.length,l=new Float32Array(g),h=L,m=J;for(a=0;a<g;a++){var p=e[a];h.set(p.subarray(0,3));m.set(p.subarray(3,6));P.set(p.subarray(6));l[a]=Math.sqrt(B(h,m,P))}h=new Float32Array(g);h[0]=l[0];for(a=1;a<g;a++)h[a]=h[a-1]+l[a];g=h[l.length-1];l=[];for(a=0;a<b;a++){var m=g*k.Rc(d),m=k.xj(h,m,0,h.length-1),p=c?f[m]:e[m],m=a,n=p,t=d,p=void 0,p=new Float32Array(3),r=n[0],y=n[1],u=n[2],A=n[3],G=n[4],v=n[5],z=n[6],F=n[7],q=n[8],n=k.Rc(t),t=k.Rc(t);1<n+t&&(n=1-n,t=1-t);var E=1-n-t,y=E*y+n*G+
t*F,u=E*u+n*v+t*q;p[0]=E*r+n*A+t*z;p[1]=y;p[2]=u;l[m]=p}return l};a.tD=x;a.Zp=u;a.OE=B;a.cA=function(a,b,c){a=a.A[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.pv=function(a,b,c){var d=a.n;a=a.d.af;for(var e=1;e<a.length;e++)a[e].name==b&&(a[e].value=c);for(e=0;e<d.length;e++)if(!d[e].Jf&&d[e].Dd&&!d[e].Ng){var f=d[e].R.Ub;b=d[e].R.ed;z.bindBuffer(z.ARRAY_BUFFER,d[e].R.mf);if(f.a_position){var g=f.a_position.offset,
l=f.a_position.length+g,k=d[e].R.V[0].Qb.a_position;for(c=g;c<l;c++)b[c]=k[c-g];for(k=1;k<d[e].R.V.length;k++){var h=d[e].R.V[k].Qb.a_position,m=a[k].value;if(m)for(c=g;c<l;c++)b[c]+=m*h[c-g]}z.bufferSubData(z.ARRAY_BUFFER,4*g,b.subarray(g))}if(f.a_normal){g=f.a_normal.offset;l=f.a_normal.length+g;k=d[e].R.V[0].Qb.a_normal;for(c=g;c<l;c++)b[c]=k[c-g];for(k=1;k<d[e].R.V.length;k++)if(h=d[e].R.V[k].Qb.a_normal,m=a[k].value)for(c=g;c<l;c++)b[c]+=m*h[c-g];t(b,g,l,3,2);z.bufferSubData(z.ARRAY_BUFFER,4*
g,b.subarray(g))}if(f.a_tangent){g=f.a_tangent.offset;f=f.a_tangent.length+g;k=d[e].R.V[0].Qb.a_tangent;for(c=g;c<f;c++)b[c]=k[c-g];for(k=1;k<d[e].R.V.length;k++)if(l=d[e].R.V[k].Qb.a_tangent,m=a[k].value)for(c=g;c<f;c++)b[c]+=m*l[c-g];t(b,g,f,4,3);z.bufferSubData(z.ARRAY_BUFFER,4*g,b.subarray(g))}}};a.check_shape_keys=function(a){return a.d.Dd};a.get_shape_keys_names=function(a){var b=[];if(a.d)for(var c=1;c<a.d.af.length;c++)b.push(a.d.af[c].name);return b};a.get_shape_key_value=function(a,b){if(a.d)for(var c=
1;c<a.d.af.length;c++)if(b==a.d.af[c].name)return a.d.af[c].value;return 0};a.Mq=function(a,b){var c=a.d.af;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.si=function(a){return a&&a.d&&a.d.nd?!0:!1}};b4w.module.__objects=function(a,q){function b(a){a={type:a,pc:0,yy:[0,0],h:new Float32Array(3),quat:new Float32Array(4),Ab:new Float32Array(8),T:new Float32Array(16),Sq:new Float32Array(16),Lb:new Float32Array(3),Sb:new Float32Array(3),$g:0,ah:0,Pm:!1,Gj:null,$c:0,Xn:!1,it:!1,ua:n.MS_STATIC,mo:1,lo:1,no:1,dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,Yd:null,at:!1,Xd:0,Gf:0,Ua:!1,Rb:null,fd:null,xb:null,dm:!0,G:null,Ei:null,nc:null,vc:null,ec:null,oi:0,ji:0,qm:0,Ai:0,$f:0,Vr:"",Tk:!1,Ac:!1,Yb:!1,
hc:!1,Vb:!1,Mb:!1,yc:!1,le:!1,Af:!1,Gc:!1,Mj:!1,nd:!1,mb:!1,Pg:!1,Zg:!1,gk:!1,qg:!1,ok:!1,Fb:!1,nk:!1,Br:!1,ek:!1,is_visible:!1,sm:!1,ej:0,Fd:0,ue:0,Vd:0,Ud:0,Qd:0,he:"",Jb:null,wj:!1,kd:!1,Xh:"",Wh:!1,Kf:0,time:0,ko:0,lt:0,je:0,ni:!1,Xk:!1,Dd:!1,af:[],bh:!1,Ce:!1,Be:1,kl:0,jl:1,Pk:new Int8Array([-1,-1]),Kk:[],qr:[],ws:[],xc:null,wc:null,Fc:null,Ec:null,Kc:null,Wr:null,ml:null,ll:null,ie:null,bg:null,hk:null,tc:null,ag:null,ik:null,Pb:null,sl:null,ql:null,rl:null,bb:null,Vc:null,vb:null,yf:null,zf:null,
scale:1,Re:1E4};L.identity(a.quat);I.identity(a.Ab);P.identity(a.T);P.identity(a.Sq);return a}function d(a){var b=a.parent;if(b&&b.Eg)return!0;switch(a.type){case "MESH":var c=l.bk(a),d=a.b4w_do_not_batch,e=a.b4w_collision,f=a.b4w_vehicle,g=a.b4w_floating,b=a.b4w_character,k=t.Cy(a),h=B.Lq(a),m=0<a.data.b4w_shape_keys.length,p=a.b4w_dynamic_geometry;if(!(c=c||d||e||f||m||g))a:{a=a.data;for(c=0;c<a.materials.length;c++)if("LENS_FLARES"===a.materials[c].name){c=!0;break a}c=!1}return c||k||b||h||p;
case "EMPTY":return b=l.bk(a),k=B.Lq(a),a=a.b4w_do_not_batch,b||k||a;default:return!0}}function c(a,b,d,f,g,l,k,h,m){for(var p=0;p<a.nodes.length;p++){var n=a.nodes[p];if("VALUE"==n.type){var t=b+n.name;f.push(n.outputs[0].default_value);g.push(t,g.length/2)}else"RGB"==n.type?(t=b+n.name,n=n.outputs[0].default_value.slice(0,3),k.push(n[0],n[1],n[2]),h.push(t,h.length/2)):"GROUP"==n.type&&(t=n.node_group.node_tree,c(t,b+n.name+"%join%",t.animation_data,f,g,l,k,h,m))}if(d)for((a=d.action)&&e(a,b,l,
g,m,h),d=d.nla_tracks,f=0;f<d.length;f++)for(k=d[f].strips,p=0;p<d[f].strips.length;p++)a=k[p].action,e(a,b,l,g,m,h)}function e(a,b,c,d,e,f){var l=a.d.Ra,k;for(k in l){var h=b+k.match(/"(.*?)"/)[1],l=g(d,h);null!=l?(h=a.name+"%join%"+k,c.push(h,l)):(l=g(f,h),null!=l&&(h=a.name+"%join%"+k,e.push(h,l)))}}function g(a,b){for(var c=0;c<a.length;c+=2)if(a[c]==b)return a[c+1];return null}function f(a,b,c){return{name:a,type:b,modifiers:[],particle_systems:[],constraints:[],data:null,parent:null,b4w_vehicle_settings:null,
b4w_floating_settings:null,b4w_character_settings:null,b4w_vehicle:!1,b4w_character:!1,b4w_floating:!1,n:[],Io:c,Ic:[],ze:[],Ld:[],Tc:null,Wa:null,Jc:null,k:null,D:[],m:null,j:null,na:null}}function h(a){return a instanceof Array?a.slice():a}function p(a){if("object"!=typeof a||null===a)return a;var b=a instanceof Array?[]:{},c=null,d=null,e=null;a.L&&(c=a.L,a.L=null);a.Gb&&(d=a.Gb,a.Gb=null);a.V&&(e=a.V,a.V=null);for(var f in a)b[f]=a[f]&&"object"==typeof a[f]?a[f]instanceof Float32Array?new Float32Array(a[f]):
a[f]instanceof Uint32Array?new Uint32Array(a[f]):a[f]instanceof Uint16Array?new Uint16Array(a[f]):a[f]instanceof WebGLUniformLocation?a[f]:a[f]instanceof WebGLProgram?a[f]:a[f]instanceof WebGLShader?a[f]:a[f]instanceof WebGLBuffer?null:p(a[f]):a[f];c&&(b.L=c,a.L=c);d&&(b.Gb=d,a.Gb=d);e&&(b.V=e,a.V=e);return b}var l=q("__animation"),m=q("__batch"),r=q("__boundings"),n=q("__camera"),y=q("__config"),v=q("__constraints"),E=q("__curve"),x=q("__geometry"),u=q("__lights"),B=q("__nla"),t=q("__particles"),
G=q("__print"),A=q("__scenes"),k=q("__transform"),I=q("__tsr"),F=q("__util"),L=q("quat"),J=q("vec3"),P=q("mat4"),z=y.Fb,N=0,H=0,K=[],O=new Float32Array(4);a.Ij=b;a.Sk=function(a,e){var f=d(a);a.Eg=f;a.d=b("MESH"===a.type?f?"DYNAMIC":"STATIC":a.type);a.Io=!1;a.Wa=null;a.Ic=[];a.D=[];a.m=null;a.j=null;a.na=null;a.za||(a.za=null);var f=a.d,g=a.location,h=a.scale[0];F.xn(a.rotation_quaternion,O);k.set_translation(a,g);k.set_rotation(a,O);k.set_scale(a,h);switch(a.type){case "ARMATURE":g=a.pose.bones;
for(h=0;h<g.length;h++){var p=g[h],t=p.bone,y=new Float32Array(t.matrix_local),B=new Float32Array(16);P.invert(y,B);var x=new Float32Array(p.matrix_basis),q=new Float32Array(3);J.subtract(t.tail_local,t.head_local,q);F.eC(q,B,q);p.Uu=q;p.Ou=[p].concat(p.parent_recursive);p.Ko=I.from_mat4(y,I.create());p.Jo=I.from_mat4(x,I.create());p.fl=I.create();p.oj=!1}g=l.Jv(a);f.Kc=g;g=l.lp(a,g);a.b4w_animation_mixing?(f.xc=new Float32Array(g.ya),f.wc=new Float32Array(g.ya),f.Fc=new Float32Array(g.h),f.Ec=new Float32Array(g.h)):
(f.xc=g.ya,f.wc=g.ya,f.Fc=g.h,f.Ec=g.h);f.Wr=g;f.Kf=0;f.Ce=a.b4w_animation_mixing;break;case "MESH":f.qg=z.outlining_overview_mode||a.b4w_selectable;f.ok=a.b4w_selectable;f.Fb=z.outlining_overview_mode||a.b4w_outlining;f.nk=a.b4w_outlining;f.Br=z.outlining_overview_mode||a.b4w_outline_on_select;f.kd=a.b4w_billboard;f.cp=a.b4w_pres_glob_orientation;f.Xh="BASIC";f.Wh="SPHERICAL"==a.b4w_billboard_geometry;f.Ei={pk:a.b4w_outline_settings.outline_duration,qk:a.b4w_outline_settings.outline_period,rk:a.b4w_outline_settings.outline_relapses};
f.qg&&(a.d.Gj=F.jq(N),N++);if("MESH"!=a.type)throw"Wrong object type: "+a.name;a.d.Xk=a.data.b4w_vertex_anim.length?!0:!1;if("MESH"!=a.type)throw"Wrong object type: "+a.name;h=a.d;if(a.data.b4w_shape_keys.length)for(h.Dd=!0,g=0;g<a.data.b4w_shape_keys.length;g++)p={},p.value=a.data.b4w_shape_keys[g].value,p.name=a.data.b4w_shape_keys[g].name,h.af.push(p);else h.Dd=!1;if(h=l.get_first_armature_object(a)){g=a.d;t=a.data.vertex_groups;if(t.length){y=h.data.bones;B=h.pose.bones;x=0;p={};for(q=0;q<y.length;q++){var ia=
y[q].name,ga=F.keysearch("name",ia,t);if(ga){var pa=F.Am(B,"name",ia);p[ia]={ip:q,fi:x++,un:pa,pt:ga.index}}}t=x;g.Kc=p;p=l.vq();g.je=t;t>2*p?(g.bh=!1,G.error('too many bones for "'+a.name+'" / '+g.je+" bones (max "+p+" with blending, "+2*p+" without blending). Skinning will be disabled.")):g.bh=!0}g=a.d.Kc;g=l.lp(h,g);h.b4w_animation_mixing?(f.xc=new Float32Array(g.ya),f.wc=new Float32Array(g.ya),f.Fc=new Float32Array(g.h),f.Ec=new Float32Array(g.h)):(f.xc=g.ya,f.wc=g.ya,f.Fc=g.h,f.Ec=g.h);f.ml=
new Float32Array(4);f.ll=L.create();f.Wr=g;f.Kf=0}h=a.d;g=a.data.materials;p=[];t=[];y=[];B=[];x=[];q=[];for(ia=0;ia<g.length;ia++)ga=g[ia],(pa=ga.node_tree)&&c(pa,ga.name+"%join%",pa.animation_data,p,t,y,B,x,q);h.ie=p;h.bg=t;h.hk=y;h.tc=B;h.ag=x;h.ik=q;a.n=[];f.Ac=a.b4w_shadow_cast;f.Yb=a.b4w_shadow_receive;f.hc=a.b4w_shadow_cast_only&&f.Ac;f.Vb=a.b4w_reflexible;f.Mb=a.b4w_reflexible_only&&f.Vb;f.yc=a.b4w_reflective;f.le=a.b4w_reflection_type;a.el=null;if(a.b4w_reflective)if(h=a.d,"CUBE"==a.b4w_reflection_type)h.nc=
H++;else{a:{g=a.constraints;for(p=0;p<g.length;p++)if(t=g[p],"LOCKED_TRACK"==t.type&&"REFLECTION PLANE"==t.name){g=t.target;break a}g=null}if(g){p=null;for(t=0;t<K.length;t++)if(K[t]==g){p=t;break}null==p?(K.push(g),h.vc=K.length-1):h.vc=p;a.el=g}}f.Af=a.b4w_caustics;f.Gc=a.b4w_wind_bending;f.ej=a.b4w_wind_bending_angle;h=m.lC(a.b4w_wind_bending_angle,m.zv(a.data.b4w_bounding_box),a.scale[0]);f.Fd=h;f.ue=a.b4w_wind_bending_freq;f.Vd=a.b4w_detail_bending_freq;f.Ud=a.b4w_detail_bending_amp;f.Qd=a.b4w_branch_bending_amp;
f.Zg=!1;f.he=a.b4w_main_bend_stiffness_col;h=a.b4w_detail_bend_colors;f.Jb={};f.Jb.hr=h.leaves_stiffness_col;f.Jb.gr=h.leaves_phase_col;f.Jb.Dr=h.overall_stiffness_col;f.Pg=a.b4w_do_not_cull;f.Mj=a.b4w_disable_fogging;f.nd=a.b4w_dynamic_geometry;if("MESH"!==a.type)throw"Wrong object";h=a.data.materials[0];f.oi=h.physics.friction;f.ji=h.physics.elasticity;f.Ai=0;f.Re=1E4;f.$f=a.b4w_lod_transition;f.gk=!0;break;case "CAMERA":n.Lv(a);n.uv(a);break;case "LAMP":u.Wy(a);break;case "CURVE":if(h=E.Jw(a))a.Tu=
h;break;case "EMPTY":f.Pb=r.Gd(),h=r.fj(),f.Vc=h}if(!e&&(a.parent&&"OBJECT"==a.parent_type?(g=f.h,p=f.quat,h=f.scale,v.To(a,a.parent,g,p,h)):a.parent&&"BONE"==a.parent_type&&"ARMATURE"==a.parent.type?(g=f.h,p=f.quat,h=f.scale,v.So(a,a.parent,a.parent_bone,g,p,h)):a.za&&a.za.b4w_group_relative?(h=I.create_sep(f.h,f.scale,f.quat),v.Yu(a,a.za,h)):a.za&&!a.za.b4w_group_relative&&(k.u(a),I.multiply(a.za.d.Ab,a.d.Ab,a.d.Ab),k.set_translation(a,I.get_trans_view(a.d.Ab)),k.set_scale(a,I.get_scale(a.d.Ab)),
k.set_rotation(a,I.get_quat_view(a.d.Ab))),h=a.dupli_group))for(g=h.objects,h=0;h<g.length;h++)g[h].za=a;a.field&&(f.qm=a.field.strength,A.dt(a));f.Tk=a.game.use_collision_compound;f.Vr=a.game.physics_type;k.u(a)};a.IB=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.d||"DYNAMIC"!=c.d.type&&"CAMERA"!=c.d.type||k.u(c);c.b4w_use_default_animation&&l.bk(c)&&(l.apply_def(c),c.D.length&&l.play(c,null,l.SLOT_ALL))}};a.cc=function(a){return a.Eg?!0:!1};a.ti=function(a){return"MESH"==a.type&&a.Eg?!0:
!1};a.get_meta_tags=function(a){a=a.b4w_object_tags;return{title:a?a.title:"",description:a?a.description:"",category:a?a.category:""}};a.cleanup=function(){H=N=0;K=[]};a.Qq=f;a.copy=function(a,b,c){b=f(b,a.type,!1);var d=[];if(c){for(var e=0;e<a.n.length;e++)a.n[e].Jf||(b.n.push(p(a.n[e])),d.push(a.n[e].R));for(e=0;e<a.n.length;e++)if(a.n[e].Jf){var g=p(a.n[e]);b.n.push(g);for(var l=0;l<d.length;l++)d[l]==a.n[e].R&&(g.R=b.n[l].R)}}else b.n=h(a.n);b.d=p(a.d);a.Eg&&(b.Eg=a.Eg);a.za&&(b.za=a.za);a.Ld&&
(b.Ld=h(a.Ld));!a.m||a.b4w_vehicle||a.b4w_character||a.b4w_floating||(b.m=p(a.m));b.game=p(a.game);b.b4w_collision_id=a.b4w_collision_id;b.b4w_correct_bounding_offset=a.b4w_correct_bounding_offset;b.b4w_collision=a.b4w_collision;b.data=a.data;b.particle_systems=c?p(a.particle_systems):h(a.particle_systems);if(c)for(e=0;e<b.n.length;e++){b.n[e].R&&x.et(b.n[e].R);if("PARTICLES"==b.n[e].type&&b.n[e].wn)for(l=0;l<b.yE.length;l++)if(b.particle_systems[l].name==b.n[e].wn){b.n[e].uc=b.particle_systems[l];
break}b.n[e].mh=b.uuid;m.wB(b.n[e],F.Jg(b.d,0))}b.uuid=F.vm();b.d.Pm=!0;b.d.Gj=F.jq(N);N++;return b};a.kw=p;a.ry=function(a,b){for(var c=a.d.bg,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null};a.ly=function(a,b){for(var c=a.d.ag,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null}};b4w.module.__particles=function(a,q){function b(){throw"_rand() undefined";}function d(a,b,c,d,e,f,g){var l=a.P.$l,h=a.P.od,k=a.P.time;a=a.P.Xr;for(var m=b?4:1,F=0;F<l.length;F+=m){var L=l[F];if(k>a&&k>=L&&L>a||k<a&&(L>a||k>=L))for(L=0;8>L;L++)h[8*F+L]=e[L];for(L=0;8>L;L++)r[L]=h[8*F+L];L=n;L[0]=c[3*F];L[1]=c[3*F+1];L[2]=c[3*F+2];p.transform_vec3(L,r,L);f[3*F]=L[0];f[3*F+1]=L[1];f[3*F+2]=L[2];var J=n;J[0]=d[3*F];J[1]=d[3*F+1];J[2]=d[3*F+2];p.transform_dir_vec3(J,r,J);g[3*F]=J[0];g[3*F+1]=J[1];g[3*
F+2]=J[2];if(b)for(L=1;4>L;L++)f[3*(F+L)]=f[3*F],f[3*(F+L)+1]=f[3*F+1],f[3*(F+L)+2]=f[3*F+2],g[3*(F+L)]=J[0],g[3*(F+L)+1]=J[1],g[3*(F+L)+2]=J[2]}}function c(a){a?(h.XA(a),b=function(){return h.Jz()}):b=function(){return Math.random()}}var e=q("__config"),g=q("__geometry"),f=q("__scenes"),h=q("__util"),p=q("__tsr"),l=q("vec3"),m=e.Nd,r=new Float32Array(8),n=new Float32Array(3);a.Yg=function(a){return 0<a.particle_systems.length?!0:!1};a.Hm=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==
a.particle_systems[b].settings.type)return!0;return!1};a.RD=function(a){for(var b=0;b<a.particle_systems.length;b++)if("HAIR"==a.particle_systems[b].settings.type)return!0;return!1};a.Cy=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.Kx=function(a,e,f,p){f.P=f.P||{};var n=g.aq(e,["a_position","a_normal"],null),r=f.settings.count,t=f.settings.frame_start/m.Ha,G=f.settings.frame_end/m.Ha,A=f.settings.lifetime/
m.Ha,k=f.settings.lifetime_random,q=f.settings.emit_from,F=f.settings.factor_random,L=f.settings.angular_velocity_mode,J=f.settings.angular_velocity_factor,P=f.settings.b4w_randomize_emission,z=f.settings.b4w_cyclic;c(f.seed);var N=f.P.bC="WORLD"==f.settings.b4w_coordinate_system?!0:!1;f.P.frame=0;if(e=!a.Pf){var H;H=[];for(var K=0;K<r;K++)H.push(-.5,-.5,-.5,.5,.5,.5,.5,-.5);H=new Float32Array(H);for(var K=[],O=0;O<r;O++)K.push(4*O,4*O+2,4*O+1,4*O,4*O+3,4*O+2);K=new Uint16Array(K)}switch(q){case "VERT":for(var O=
n.A[0].a_position,n=n.A[0].a_normal,X=O.length/3,q=[],aa=0;aa<r;aa++){var Z=Math.round((X-1)*b());q.push(Z);e&&(q.push(Z),q.push(Z),q.push(Z))}X=[];for(aa=0;aa<q.length;aa++)X.push(O[3*q[aa]]),X.push(O[3*q[aa]+1]),X.push(O[3*q[aa]+2]);O=new Float32Array(X);X=[];for(aa=0;aa<q.length;aa++)X.push(n[3*q[aa]]),X.push(n[3*q[aa]+1]),X.push(n[3*q[aa]+2]);q=new Float32Array(X);break;case "FACE":O=[];q=[];aa=[];h.$j(0,aa);X=g.wm(n,r,!1,aa);h.$j(0,aa);n=g.wm(n,r,!0,aa);for(aa=0;aa<X.length;aa++)O.push(X[aa][0],
X[aa][1],X[aa][2]),e&&(O.push(X[aa][0],X[aa][1],X[aa][2]),O.push(X[aa][0],X[aa][1],X[aa][2]),O.push(X[aa][0],X[aa][1],X[aa][2])),q.push(n[aa][0],n[aa][1],n[aa][2]),e&&(q.push(n[aa][0],n[aa][1],n[aa][2]),q.push(n[aa][0],n[aa][1],n[aa][2]),q.push(n[aa][0],n[aa][1],n[aa][2]));O=new Float32Array(O);q=new Float32Array(q);break;case "VOLUME":throw"Particle emission from volume is not supported";default:throw"Wrong emit from option";}q=[O,q];n=q[0];q=q[1];f.P.Li=new Float32Array(n);f.P.qz=new Float32Array(q);
f.P.Cz=new Float32Array(n.length);f.P.rz=new Float32Array(q.length);f.P.time=0;f.P.Xr=-1;O=[];G=(G-t)/r;for(X=0;X<r;X++)aa=P?G*X+10*G*(.5-b()):G*X,z||(aa+=t),O.push(aa),e&&(O.push(aa),O.push(aa),O.push(aa));t=new Float32Array(O);f.P.$l=new Float32Array(t);f.P.Pp=new Float32Array(t);f.P.od=new Float32Array(8*t.length);for(P=0;P<8*t.length;P++)for(z=0;8>z;z++)f.P.od[8*P+z]=p[z];N&&d(f,e,n,q,p,n,q);f=[];p=A*k;for(k=0;k<r;k++)N=p*b(),f.push(A-N),e&&(f.push(A-N),f.push(A-N),f.push(A-N));A=new Float32Array(f);
f=[];for(p=0;p<r;p++){k=[b()-.5,b()-.5,b()-.5];l.normalize(k,k);f.push(F*k[0]);f.push(F*k[1]);f.push(F*k[2]);switch(L){case "NONE":f.push(0);break;case "SPIN":case "VELOCITY":f.push(J);break;case "RAND":f.push(2*J*(b()-.5));break;default:throw"Undefined velocity factor";}if(e)for(k=f.slice(-4),N=0;12>N;N++)f.push(k[N%4])}r=new Float32Array(f);F=h.lb("EMITTER_PARTICLES");L=h.Wc();L.a_position=n;L.a_normal=q;F.A[0]=L;e?(a.Zd=g.ij,F.ea=K):(a.Zd=g.zo,F.ea=new Uint16Array(0));F.K=n.length/3;F.H.a_p_delay=
t;F.H.a_p_lifetime=A;F.H.a_p_vels=r;e&&(F.H.a_p_bb_vertex=H);return F};a.FB=function(a){for(var b=a.n,c=0;c<b.length;c++){var e=b[c],f=b[c].uc;if(f){var l=e.R;if(!f.P.bC)break;var h=f.P.Cz,m=f.P.rz;d(f,!e.Pf,f.P.Li,f.P.qz,a.d.Ab,h,m);g.dz(l);g.Rk(l,"a_position",3,h);g.Rk(l,"a_normal",3,m)}}};a.lA=function(a,b,c){var d=b.settings.lifetime/m.Ha,e=b.settings.normal_factor,g=9.81*b.settings.effector_weights.gravity,l=b.settings.effector_weights.wind,h=b.settings.mass,p=b.settings.b4w_fade_in/m.Ha,k=b.settings.b4w_fade_out/
m.Ha,n=b.settings.b4w_cyclic;a.Mr=b.settings.frame_end/m.Ha-b.settings.frame_start/m.Ha;a.Ir=n?1:0;a.qn=e;a.Lr=g;e=f.wy();a.sk[0]=e[0]*l;a.sk[1]=e[1]*l;a.sk[2]=e[2]*l;a.Or=d;a.Nr=h;a.Jr=p;a.Kr=k;a.Pf?(d=c.halo.size,l=c.halo.hardness,30>l?(l=.5,h=.9):40>l?(l=.1,h=1):50>l?(l=0,h=.8):(l=0,h=.5)):(d=b.settings.particle_size,h=l=1);a.rn=d;a.Fr=l;a.Er=h;d=b.settings.texture_slots;b=[-1,0,-1,0,-1,0,-1,0];if(d[0]&&d[0].use_map_size&&d[0].texture&&"BLEND"==d[0].texture.type&&d[0].texture.use_color_ramp){d=
d[0].texture.color_ramp.elements;l=Math.min(2*d.length,b.length);for(h=0;h<l;h+=2)p=d[h/2],b[h]=p.position,b[h+1]=(p.color[0]+p.color[1]+p.color[2])/3;a.Qr=d.length}a.Pr.set(b);b=c.texture_slots;c=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(b[0]&&"STRAND"==b[0].texture_coords&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp){d=b[0].texture.color_ramp.elements;l=Math.min(4*d.length,c.length);for(h=0;h<l;h+=4)p=d[h/4],c[h]=p.position,c[h+1]=p.color[0],c[h+2]=p.color[1],c[h+3]=p.color[2];
a.Hr=d.length}a.Gr.set(c)};a.vA=function(a,b){a.P.Xr=a.P.time;a.P.time=b};a.Ez=function(a){for(var b=a.K,c=a.A[0].a_position,d=a.H.a_texcoord,e=[],f=[],g=0;g<b;g++)f.push(c[3*g]),f.push(c[3*g+1]),e.push(c[3*g+2]);e=new Float32Array(e);f=new Float32Array(f);a.H.a_lf_dist=e;a.H.a_lf_bb_vertex=f;a.H.a_texcoord=d;return a};a.set_size=function(a,b,c){a=a.n;for(var d=0;d<a.length;d++){var e=a[d],f=e.uc;f&&f.name==b&&(e.rn=c)}};a.set_normal_factor=function(a,b,c){a=a.n;for(var d=0;d<a.length;d++){var e=
a[d],f=e.uc;f&&f.name==b&&(e.qn=c)}};a.set_factor=function(a,b,c){a=a.n;for(var d=0;d<a.length;d++){var e=a[d],f=e.uc;if(f&&f.name==b){var l=f.P.$l;if(1==c)f=l;else if(0==c)for(var h=!e.Pf,m=h?4:1,f=f.P.Pp,k=0;k<f.length;k+=m)f[k]=1E4,h&&(f[k+1]=f[k],f[k+2]=f[k],f[k+3]=f[k]);else for(var p=1/c,f=f.P.Pp,m=(h=!e.Pf)?4:1,n=0,k=0;k<f.length;k+=m)k>=n?(f[k]=l[k],n+=p):f[k]=1E4,h&&(f[k+1]=f[k],f[k+2]=f[k],f[k+3]=f[k]);g.Rk(e.R,"a_p_delay",1,f)}}};a.OB=function(a,b,c){a=a.particle_systems;for(var d=0;d<
a.length;d++){var e=a[d];if("EMITTER"==e.settings.type)for(var f=e.P.$l,d=0;d<8*f.length;d++)e.P.od[8*d]=b[0],e.P.od[8*d+1]=b[1],e.P.od[8*d+2]=b[2],e.P.od[8*d+3]=b[3],e.P.od[8*d+4]=c[0],e.P.od[8*d+5]=c[1],e.P.od[8*d+6]=c[2],e.P.od[8*d+7]=c[3]}}};b4w.module.__primitives=function(a,q){function b(a,b,c,d){for(var e=[],g=[],h=[],q=[],x=2*c/(a-1),u=2*d/(b-1),B=0;B<a;B++)for(var t=-c+B*x,G=0;G<b;G++)if(g.push(t,0,-d+G*u),h.push(0,1,0),q.push(B/(a-1),G/(b-1)),B&&G){var A=B*b+G,k=A-1,I=(B-1)*b+G,F=I-1;e.push(A,k,I);e.push(k,F,I)}a=f.Wc();a.a_position=new Float32Array(g);a.a_normal=new Float32Array(h);h=f.lb("GRID_PLANE");h.A[0]=a;h.H.a_texcoord=new Float32Array(q);h.ea=new Uint32Array(e);h.K=g.length/3;return h}function d(a){var b=a.length;if(b%
4)throw"Wrong array";for(var c=[],d=[],g=0;g<b;g+=4){var h=a[g+1],v=a[g+2],q=a[g+3];e(a[g],d);e(h,d);e(v,d);e(q,d);c.push(g,g+1,g+2);c.push(g,g+2,g+3)}a=f.Wc();a.a_position=new Float32Array(d);b=f.lb("FROM_QUADS");b.A[0]=a;b.ea=new Uint32Array(c);b.K=d.length/3;return b}function c(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function e(a,b){b.push(a[0],a[1],a[2])}var g=q("__geometry"),f=q("__util"),h=q("__config").o;a.JD=function(a){for(var b=f.lb("LINE"),c=[],d=0;d<2*a;d++)c.push(d);d=f.Wc();d.a_point=
new Float32Array(c);b.A[0]=d;b.ea=new Uint32Array(c);b.K=2*a;return b};a.KD=function(a,c){var d=b(2,2,a,c);d.name="PLANE";return d};a.ID=b;a.Px=function(a,b,c){function d(a,b){return 1==a%2&&(0==b||b==q-1)||1==b%2&&(0==a||a==v-1)?!0:!1}var e=c/=Math.pow(2,a-1),y=c,v=b+1,q=b+1;b=[];c=[];for(var x=0,u=0,B=-1,t=[],G=0;G<a;G++){for(var A=2*e/(v-1),k=2*y/(q-1),I=[],F=[],L=0,J=0;J<v;J++){for(var P=-e+J*A,z=[],N=0;N<q;N++){var H=-y+N*k;if(P>-x&&P<x&&H>-u&&H<u)z.push(-1),L++;else{for(var K=null,O=0;O<t.length;O+=
3)if(P==t[O]&&H==t[O+1]){K=t[O+2];break}O=null!==K?K:B+1;d(J,N)?(z.push(-2),L++):(null==K&&(0==N||N==q-1||0==J||J==v-1?(K=G==a-1?A:2*A,I.push(P,H,O)):K=A,c.push(P,K,H),B++),z.push(O));if(J&&N)if(1==J)if(d(J-1,N)){if(1<N){var H=O-1,K=F[J-1][N+1],X=K-1;b.push(O,H,X)}else K=F[J-1][N+1],X=K-1;b.push(O,X,K)}else d(J,N)||(H=O-1,K=F[J-1][N],b.push(O,H,K));else if(J==v-1){if(!d(J,N))if(N==q-1)H=O-1,K=F[J-1][N-1],X=F[J-2][N],b.push(O,H,K),b.push(O,K,X);else{var H=O-1,K=F[J-1][N],X=K-1,aa=K+1;b.push(O,H,X);
b.push(O,X,K);b.push(O,K,aa);2==N&&(aa=F[J-2][N-2],b.push(H,aa,X))}}else 1==N?d(J,N-1)?(H=F[J-1][N],K=F[J-1][N-1],b.push(O,K,H)):(H=z[N-1],K=F[J-1][N],X=F[J-2][N-1],b.push(O,H,K),b.push(H,X,K)):N==q-1?d(J,N)||(H=z[N-1],K=F[J-1][N-1],X=F[J-2][N],b.push(O,H,K),b.push(O,K,X)):-1!=F[J-1][N]&&-1!=F[J-1][N-1]&&-1!=z[N-1]?(H=z[N-1],K=F[J-1][N],X=F[J-1][N-1],b.push(O,H,K),b.push(H,X,K),N==q-2&&d(J,N+1)&&(aa=F[J-1][N+1],b.push(O,K,aa))):N==q-2&&d(J,N+1)&&(K=F[J-1][N],aa=F[J-1][N+1],b.push(O,K,aa))}}F.push(z)}t=
I;x=e;u=y;e*=2;y*=2}2E4>x&&(a=-(2*x)/(v-1),c.push(-2E4,a,-2E4),c.push(-2E4,a,2E4),c.push(-x,a,-u),c.push(-x,a,u),c.push(2E4,a,-2E4),c.push(2E4,a,2E4),c.push(x,a,-u),c.push(x,a,u),O=B+1,b.push(O+3,O+2,O+1,O+2,O+0,O+1,O+6,O+4,O+2,O+4,O+0,O+2,O+5,O+7,O+1,O+7,O+3,O+1,O+5,O+4,O+7,O+7,O+4,O+6));a=f.Wc();a.a_position=new Float32Array(c);e=f.lb("multigrid_plane");e.A[0]=a;e.ea=new Uint32Array(b);e.K=c.length/3;h.ut&&(g.Un(e,1,!0),a.a_polyindex=g.Zp(e));return e};a.HD=function(a){var b=a.length;if(b%3)throw"Wrong array";
for(var c=[],d=[],g=0;g<b;g+=3){var h=a[g+1],v=a[g+2];e(a[g],d);e(h,d);e(v,d);c.push(g,g+1,g+2)}a=f.Wc();a.a_position=new Float32Array(d);b=f.lb("FROM_TRIANGLES");b.A[0]=a;b.ea=new Uint32Array(c);b.K=d.length/3;return b};a.GD=d;a.Lx=function(a){a=f.fC(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=d(b);a.name="FRUSTUM";return a};a.nb=function(){var a=f.lb("FULLSCREEN_TRI"),
b=f.Wc();b.a_position=new Float32Array([0,0,1,0,0,1]);a.A[0]=b;a.ea=new Uint32Array([0,1,2]);a.K=3;return a};a.Mx=function(){var a=f.lb("FULLSCREEN_QUAD"),b=f.Wc();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.A[0]=b;a.ea=new Uint32Array([0,2,1,1,2,3]);a.K=4;return a};a.Hx=function(){var a=f.lb("BILLBOARD"),b=f.Wc();b.a_bb_vertex=new Float32Array([-.5,-.5,-.5,.5,.5,.5,.5,-.5]);a.A[0]=b;a.ea=new Uint32Array([0,2,1,0,3,2]);a.K=4;return a};a.Ix=function(){var a=f.lb("CUBEMAP_BOARD"),b=f.Wc();
b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.A[0]=b;a.ea=new Uint32Array([0,2,1,0,3,2]);a.K=4;return a};a.mq=function(a,b){var d=f.lb("UV_SPHERE"),h,n,y=[],v=[],q=[];for(n=0;8>=n;n++)for(h=0;16>=h;h++){var x=h/16,u=n/8;v.push(-a*Math.cos(2*x*Math.PI)*Math.sin(u*Math.PI)+b[0],a*Math.cos(u*Math.PI)+b[1],a*Math.sin(2*x*Math.PI)*Math.sin(u*Math.PI)+b[2])}for(n=x=0;8>n;n++)for(h=0;16>h;h++){var u=c(v,17*n+h+1),B=c(v,17*n+h),t=c(v,17*(n+1)+h),G=c(v,17*(n+1)+h+1);Math.abs(u[1])==a+b[1]?(e(u,y),
e(t,y),e(G,y),q.push(x,x+1,x+2),x+=3):Math.abs(t[1])==a+b[1]?(e(u,y),e(B,y),e(t,y),q.push(x,x+1,x+2),x+=3):(e(u,y),e(B,y),e(t,y),e(G,y),q.push(x,x+1,x+2),q.push(x,x+2,x+3),x+=4)}h={};h.a_position=y;v=g.mp(q,v,y);h.a_normal=g.kp(q,y,v);h.a_tangent=[];d.H.a_influence=[];d.H.a_color=[];d.H.a_texcoord=[];d.A[0]=h;d.ea=q;d.K=y.length/3;return d};a.lq=function(a){var b=f.lb("INDEX"),c=f.Wc();c.a_index=new Float32Array(a);for(var d=0;d<a;d++)c.a_index[d]=d;b.A[0]=c;b.ea=new Uint16Array(0);b.K=a;return b}};b4w.module.__prerender=function(a,q){function b(a,b){var d=a.td,e=b.i;d.is_visible=!1;var f;if(!(f=!d||d.Zg)){var l=e.Le,h=d.vb.F;f=d.Re;l=Math.sqrt((h[0]-l[0])*(h[0]-l[0])+(h[1]-l[1])*(h[1]-l[1])+(h[2]-l[2])*(h[2]-l[2]));h=d.$f*d.vb.Da;f=!(l>=d.Ai&&l<f+h)}if(f)return!1;d.is_visible=!0;(f="OUTLINE_MASK"==b.type&&!Boolean(d.$c))||(e=e.Qj,d.Pg?f=!1:("STATIC"===d.type?(f=d.vb,d=f.F,d=g.SA(d,e,f.Da)):(f=d.zf,d=f.F,d=g.kx(d,e,f.vf,f.wf,f.xf)),f=d));return f?!1:"WIREFRAME"==b.type?a.B.wireframe_mode==c.Go.WM_DEBUG_SPHERES?
a.B.Ng:!a.B.Ng:!0}var d=q("__config"),c=q("__debug"),e=q("__geometry"),g=q("__util"),f=q("__renderer"),h=q("vec3"),p=d.o,l="MAIN_OPAQUE MAIN_BLEND MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT MAIN_GLOW SHADOW_CAST DEPTH OUTLINE_MASK WIREFRAME COLOR_PICKING MAIN_XRAY COLOR_PICKING_XRAY".split(" ");a.vn=function(a){if(-1<l.indexOf(a.type)){for(var c=!1,d=a.p,g=0;g<d.length;g++){var v=d[g];if("MAIN_CUBE_REFLECT"==a.type)for(var q=0;6>q;q++)a.i.Qj=a.Ul[q],v.bm[q]=b(v,a),v.bm[q]&&(c=!0);else v.Xa=b(v,a),v.Xa&&
(c=!0)}switch(a.type){case "WIREFRAME":break;default:"MAIN_OPAQUE"===a.type||"DEPTH"===a.type||c?a.Xa=!0:(a.Xa&&f.clear(a),a.Xa=!1)}}if("MAIN_BLEND"==a.type&&p.alpha_sort&&a.p){c=a.i.Le;d=h.dist(c,a.wt)>p.alpha_sort_threshold;for(g=0;g<a.p.length;g++)if(q=a.p[g],v=q.td,v.sm||d){var x=q.B;if(x&&x.Fa&&x.we!=e.Kd){x=x.R;if(!x||!q.Xa)continue;(q=x.Zj)&&q.type==e.Ho&&e.zB(x,v.T,c)}v.sm=!1}d&&a.wt.set(c)}}};b4w.module.__print=function(a){function q(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var d=1;d<a.length;d++)c.push(a[d]);return c}var b=!1,d=0,c=0;a.xA=function(a){b=a};a.$y=function(){console.log.apply(console,arguments)};a.log=function(){if(b){var a=q(arguments,"B4W LOG");console.log.apply(console,a)}};a.error=function(){d++;var a=q(arguments,"B4W ERROR");console.error.apply(console,a)};a.warn=function(){c++;var a=q(arguments,"B4W WARN");console.warn.apply(console,
a)};a.info=function(){var a=q(arguments,"B4W INFO");console.info.apply(console,a)};a.ox=function(){d++;var a=q(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.px=function(){c++;var a=q(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){b&&console.time.apply(console,arguments)};a.timeEnd=function(){b&&console.timeEnd.apply(console,arguments)};a.group=function(){b&&console.group.apply(console,arguments)};a.groupCollapsed=function(){b&&console.groupCollapsed.apply(console,
arguments)};a.groupEnd=function(){b&&console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)};a.vy=function(){return c};a.ey=function(){return d};a.clear_errors_warnings=function(){d=c=0}};b4w.module.print=b4w.module.__print;b4w.module.__reformer=function(a,q){function b(a){switch(a.type){case "MAPPING":a.vector_type||(a.vector_type="POINT",c("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"specular_shader"in a||(a.specular_shader="COOKTORR",c("node material",a,"specular_shader"));"specular_hardness"in a||(a.specular_hardness=50,c("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,c("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=
.5,c("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,c("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,c("node material",a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",c("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,c("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,c("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in
a||(a.diffuse_fresnel_factor=.5,c("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,c("node "+a.type,a,"use_clamp"));break;case "GROUP":switch(a.node_tree_name=a.node_tree_name.replace(/\.[0-9]{3,}$/g,""),a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name=
"B4W_"+a.node_tree_name}}}function d(a){if(a=a.nla_tracks)for(var b=0;b<a.length;b++)for(var d=a[b],e=0;e<d.strips.length;e++){var f=d.strips[e];"action"in f||(f.action=null,c("strip",f,"action"));"action_frame_start"in f||(f.action_frame_start=0,c("strip",f,"action_frame_start"));"action_frame_end"in f||(f.action_frame_end=f.frame_end-f.frame_start,c("strip",f,"action_frame_end"));"repeat"in f||(f.repeat=1,c("strip",f,"repeat"));"use_reverse"in f||(f.use_reverse=!1,c("strip",f,"use_reverse"));"scale"in
f||(f.scale=1,c("strip",f,"scale"))}}function c(a,b,c){c=c+">>"+a;c in E||(E[c]={Tn:[],js:"undefined",type:a});E[c].Tn.push(b.name)}function e(a,b){param_id in E||(E[param_id]={Tn:[],js:"deprecated",type:a});E[param_id].Tn.push(b.name)}function g(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var e=l.Df(a);a.materials=c;a.submeshes=d;e.name=b;e.materials=a.materials.slice(0);e.submeshes=[];for(c=0;c<d.length;c++){var f=l.Fj(d[c]);e.submeshes.push(f)}return e}
var f=q("__boundings"),h=q("__curve"),p=q("__print"),l=q("__util"),m=q("vec3"),r=q("vec4"),n=q("quat"),y=q("mat4"),v=[5,4],E={};a.up=function(a){return-1!=l.nt(a,v)};a.Qv=function(a){E={};var f=a.worlds;if(0==f.length){p.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var g={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},use_sky_paper:!1,
use_sky_blend:!1,use_sky_real:!1,b4w_fog_color:[.5,.5,.5],b4w_fog_density:0,texture_slots:[]};f.push(g)}for(var f=a.worlds,h=0;h<f.length;h++){g=f[h];"use_sky_blend"in g||(c("world",g,"use_sky_blend"),g.use_sky_blend=!1);"use_sky_paper"in g||(c("world",g,"use_sky_paper"),g.use_sky_paper=!1);"use_sky_real"in g||(c("world",g,"use_sky_real"),g.use_sky_real=!1);"b4w_sky_settings"in g&&"rayleigh_brightness"in g.b4w_sky_settings||(c("world",g,"rayleigh_brightness"),g.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,
use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"render_sky"in g.b4w_sky_settings||(c("world",g,"render_sky"),g.b4w_sky_settings.render_sky=!1);"b4w_fog_density"in g||(c("world",g,"b4w_fog_density"),g.b4w_fog_density=0);for(var m=g.texture_slots,g=0;g<m.length;g++){var n=m[g];"blend_type"in n||(n.blend_type=
"MIX",c("world_texture_slot",n,"blend_type"));"use_map_blend"in n||(n.use_map_blend=!1,c("world_texture_slot",n,"use_map_blend"));"use_map_horizon"in n||(n.use_map_horizon=!0,c("world_texture_slot",n,"use_map_horizon"));"use_map_zenith_up"in n||(n.use_map_zenith_up=!1,c("world_texture_slot",n,"use_map_zenith_up"));"use_rgb_to_intensity"in n||(n.use_rgb_to_intensity=!1,c("world_texture_slot",n,"use_rgb_to_intensity"));"invert"in n||(n.invert=!1,c("world_texture_slot",n,"invert"));"color"in n||(n.color=
[1,0,1],c("world_texture_slot",n,"color"));"blend_factor"in n||(n.blend_factor=0,c("world_texture_slot",n,"blend_factor"));"horizon_factor"in n||(n.horizon_factor=1,c("world_texture_slot",n,"horizon_factor"));"zenith_up_factor"in n||(n.zenith_up_factor=0,c("world_texture_slot",n,"zenith_up_factor"));"zenith_down_factor"in n||(n.zenith_down_factor=0,c("world_texture_slot",n,"zenith_down_factor"));"default_value"in n||(n.default_value=1,c("world_texture_slot",n,"default_value"))}}g=a.scenes;for(h=0;h<
g.length;h++)m=g[h],n=m.world,"timeline_markers"in m||(m.timeline_markers=null,c("scene",m,"timeline_markers")),"b4w_use_nla"in m||(m.b4w_use_nla=!1,c("scene",m,"b4w_use_nla")),"fps"in m||(m.fps=24,c("scene",m,"fps")),"b4w_nla_cyclic"in m||(m.b4w_nla_cyclic=!1,c("scene",m,"b4w_nla_cyclic")),"b4w_nla_script"in m||(m.b4w_nla_script=[],c("scene",m,"b4w_nla_script")),"b4w_detect_collisions"in m&&(e("scene",m),delete m.b4w_detect_collisions),"audio_doppler_speed"in m||(m.audio_doppler_speed=343.3),"audio_doppler_factor"in
m||(m.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in m||(m.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},c("scene",m,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in m||(m.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in m||(m.b4w_enable_bloom=!1,c("scene",m,"b4w_enable_bloom")),"b4w_enable_motion_blur"in m||(m.b4w_enable_motion_blur=!1,c("scene",m,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in m||(m.b4w_enable_color_correction=
!1,c("scene",m,"b4w_enable_color_correction")),"b4w_enable_antialiasing"in m||(m.b4w_enable_antialiasing=!0,c("scene",m,"b4w_enable_antialiasing")),"b4w_tags"in m||(m.b4w_tags={title:"",description:""},c("scene",m,"b4w_tags")),"b4w_enable_object_selection"in m||(m.b4w_enable_object_selection="AUTO",c("scene",m,"b4w_enable_object_selection")),"b4w_enable_outlining"in m||(m.b4w_enable_outlining="AUTO",c("scene",m,"b4w_enable_outlining")),"b4w_enable_glow_materials"in m||(m.b4w_enable_glow_materials=
"AUTO",c("scene",m,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in m||(m.b4w_enable_anchors_visibility="AUTO",c("scene",m,"b4w_enable_anchors_visibility")),"b4w_outline_color"in m||(m.b4w_outline_color=[1,1,1],c("scene",m,"b4w_outline_color")),"b4w_outline_factor"in m||(m.b4w_outline_factor="b4w_glow_factor"in m?m.b4w_glow_factor:1,c("scene",m,"b4w_outline_factor")),"b4w_shadow_settings"in m||(c("scene",m,"b4w_shadow_settings"),f=n.b4w_shadow_settings,m.b4w_shadow_settings=f?f:{csm_resolution:2048,
self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),f=m.b4w_shadow_settings,"csm_resolution"in f||(c("scene",m,"b4w_shadow_settings.csm_resolution"),f.csm_resolution=2048),"self_shadow_polygon_offset"in f||(c("scene",m,"b4w_shadow_settings.self_shadow_polygon_offset"),f.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in f||
(c("scene",m,"b4w_shadow_settings.self_shadow_normal_offset"),f.self_shadow_normal_offset=.01),"b4w_enable_csm"in f||(c("scene",m,"b4w_shadow_settings.b4w_enable_csm"),f.b4w_enable_csm=!1),"csm_num"in f||(c("scene",m,"b4w_shadow_settings.csm_num"),f.csm_num=1),"csm_first_cascade_border"in f||(c("scene",m,"b4w_shadow_settings.csm_first_cascade_border"),f.csm_first_cascade_border=10),"first_cascade_blur_radius"in f||(c("scene",m,"b4w_shadow_settings.first_cascade_blur_radius"),f.first_cascade_blur_radius=
3),"csm_last_cascade_border"in f||(c("scene",m,"b4w_shadow_settings.csm_last_cascade_border"),f.csm_last_cascade_border=100),"last_cascade_blur_radius"in f||(c("scene",m,"b4w_shadow_settings.last_cascade_blur_radius"),f.last_cascade_blur_radius=1.5),"fade_last_cascade"in f||(c("scene",m,"b4w_shadow_settings.fade_last_cascade"),f.fade_last_cascade=!0),"blend_between_cascades"in f||(c("scene",m,"b4w_shadow_settings.blend_between_cascades"),f.blend_between_cascades=!0),"b4w_ssao_settings"in m||(c("scene",
m,"b4w_ssao_settings"),f=n.b4w_ssao_settings,m.b4w_ssao_settings=f?f:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),f=m.b4w_ssao_settings,"dist_factor"in f||(c("scene",m,"b4w_ssao_settings.dist_factor"),f.dist_factor=0),"samples"in f||(c("scene",m,"b4w_ssao_settings.samples"),f.samples=16),"hemisphere"in f||(c("scene",m,"b4w_ssao_settings.hemisphere"),f.hemisphere=!1),"blur_depth"in f||(c("scene",m,"b4w_ssao_settings.blur_depth"),f.blur_depth=!1),"blur_discard_value"in
f||(c("scene",m,"b4w_ssao_settings.blur_discard_value"),f.blur_discard_value=1),"b4w_bloom_settings"in m||(c("scene",m,"b4w_bloom_settings"),f=n.b4w_bloom_settings,m.b4w_bloom_settings=f?f:{key:.2,blur:4,edge_lum:1}),"key"in m.b4w_bloom_settings||(c("scene",m,"b4w_bloom_settings.key"),m.b4w_bloom_settings.key=.2),"blur"in m.b4w_bloom_settings||(c("scene",m,"b4w_bloom_settings.blur"),m.b4w_bloom_settings.blur=4),"edge_lum"in m.b4w_bloom_settings||(c("scene",m,"b4w_bloom_settings.edge_lum"),m.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in m||(c("scene",m,"b4w_motion_blur_settings"),f=n.b4w_motion_blur_settings,m.b4w_motion_blur_settings=f?f:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in m.b4w_motion_blur_settings||(c("scene",m,"b4w_motion_blur_settings.motion_blur_factor"),m.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in m.b4w_motion_blur_settings||(c("scene",m,"b4w_motion_blur_settings.motion_blur_decay_threshold"),m.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in m||(c("scene",m,"b4w_color_correction_settings"),f=n.b4w_color_correction_settings,m.b4w_color_correction_settings=f?f:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in m||(c("scene",m,"b4w_god_rays_settings"),f=n.b4w_god_rays_settings,m.b4w_god_rays_settings=f?f:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in m.b4w_god_rays_settings||(c("scene",m,"b4w_god_rays_settings.steps_per_pass"),m.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in m||(c("scene",m,"b4w_glow_settings"),m.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},f=m.b4w_glow_settings,"b4w_render_glow_over_blend"in n&&(f.render_glow_over_blend=n.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in n&&(f.small_glow_mask_coeff=n.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in n&&(f.large_glow_mask_coeff=n.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
n&&(f.small_glow_mask_width=n.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in n&&(f.large_glow_mask_width=n.b4w_large_glow_mask_width)),n=m.b4w_render_shadows,"AUTO"!=n&&"OFF"!=n&&"ON"!=n&&(m.b4w_render_shadows=n?"ON":"OFF"),n=m.b4w_render_reflections,"OFF"!=n&&"ON"!=n&&(m.b4w_render_reflections=n?"ON":"OFF"),n=m.b4w_render_refractions,"AUTO"!=n&&"OFF"!=n&&"ON"!=n&&(m.b4w_render_refractions=n?"ON":"OFF");m=a.meshes;for(h=0;h<m.length;h++){n=m[h];n.b4w_bounding_box||(c("mesh",n,"b4w_bounding_box"),
n.b4w_bounding_box={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0});n.b4w_bounding_box_source||(c("mesh",n,"b4w_bounding_box_source"),n.b4w_bounding_box_source=n.b4w_bounding_box);n.uv_textures||(c("mesh",n,"uv_textures"),n.uv_textures=[]);n.b4w_bounding_sphere_center||(n.b4w_bounding_sphere_center=[0,0,0]);n.b4w_bounding_cylinder_center||(n.b4w_bounding_cylinder_center=[0,0,0]);n.b4w_bounding_ellipsoid_center||(n.b4w_bounding_ellipsoid_center=[0,0,0]);n.b4w_bounding_ellipsoid_axes||(g=n.b4w_bounding_box,
n.b4w_bounding_ellipsoid_axes=[(g.max_x-g.min_x)/2,(g.max_y-g.min_y)/2,(g.max_z-g.min_z)/2]);"b4w_shape_keys"in n||(n.b4w_shape_keys=[],c("mesh",n,"b4w_shape_keys"));for(var g=n,f=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],k=null,r=0;r<f.length;r++)g[f[r]]&&(k?(g[f[r]]=!1,p.warn('WARNING property "'+f[r]+'" of object "'+g.name+'" has been set to "false". Foreground property "'+k+'" already exists.')):k=f[r]);for(g=0;g<n.b4w_vertex_anim.length;g++)f=
n.b4w_vertex_anim[g],"allow_nla"in f||(c('mesh["b4w_vertex_anim"]',n,"allow_nla"),f.allow_nla=!0)}g=a.cameras;for(h=0;h<g.length;h++)m=g[h],m.type||(m.type="PERSP",c("camera",m,"type")),"b4w_eye_target_dist"in m&&(delete m.b4w_eye_target_dist,e("camera",m)),"b4w_trans_velocity"in m||(m.b4w_trans_velocity=1,c("camera",m,"b4w_trans_velocity")),"b4w_rot_velocity"in m||(m.b4w_rot_velocity=1,c("camera",m,"b4w_rot_velocity")),"b4w_zoom_velocity"in m||(m.b4w_zoom_velocity=.1,c("camera",m,"b4w_zoom_velocity")),
"b4w_use_distance_limits"in m||(m.b4w_use_distance_limits=!1,c("camera",m,"b4w_use_distance_limits")),"b4w_distance_min"in m||(m.b4w_distance_min=1,c("camera",m,"b4w_distance_min")),"b4w_distance_max"in m||(m.b4w_distance_max=100,c("camera",m,"b4w_distance_max")),"b4w_horizontal_translation_min"in m||(m.b4w_horizontal_translation_min=-100,c("camera",m,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in m||(m.b4w_horizontal_translation_max=100,c("camera",m,"b4w_horizontal_translation_max")),
"b4w_vertical_translation_min"in m||(m.b4w_vertical_translation_min=-100,c("camera",m,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in m||(m.b4w_vertical_translation_max=100,c("camera",m,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in m||(m.b4w_use_horizontal_clamping=!1,c("camera",m,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in m||(m.b4w_rotation_left_limit=-Math.PI,c("camera",m,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in m||(m.b4w_rotation_right_limit=
Math.PI,c("camera",m,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in m||(m.b4w_horizontal_clamping_type="LOCAL",c("camera",m,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in m||(m.b4w_use_vertical_clamping=!1,c("camera",m,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in m||(m.b4w_rotation_down_limit=-Math.PI/2,c("camera",m,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in m||(m.b4w_rotation_up_limit=Math.PI/2,c("camera",m,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in
m||(m.b4w_vertical_clamping_type="LOCAL",c("camera",m,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in m||(m.b4w_hover_angle_min=Math.PI/6,c("camera",m,"b4w_hover_angle_min")),"b4w_hover_angle_max"in m||(m.b4w_hover_angle_max=Math.PI/6,c("camera",m,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in m||(m.b4w_enable_hover_hor_rotation=!0,c("camera",m,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in m||(m.b4w_use_panning=!0,c("camera",m,"b4w_use_panning"));g=a.lamps;for(h=0;h<g.length;h++)m=
g[h],"b4w_generate_shadows"in m||(m.b4w_generate_shadows=!1,c("lamp",m,"b4w_generate_shadows")),"b4w_dynamic_intensity"in m||(m.b4w_dynamic_intensity=!1,c("lamp",m,"b4w_dynamic_intensity")),"use_diffuse"in m||(m.use_diffuse=!0,c("lamp",m,"use_diffuse")),"use_specular"in m||(m.use_specular=!0,c("lamp",m,"use_specular"));g=a.speakers;for(h=0;h<g.length;h++)m=g[h],"b4w_behavior"in m||(m.b4w_behavior=m.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_disable_doppler"in m||(m.b4w_disable_doppler=
!1),"b4w_delay"in m||(m.b4w_delay=0),"b4w_delay_random"in m||(m.b4w_delay_random=0),"b4w_volume_random"in m||(m.b4w_volume_random=0),"b4w_pitch_random"in m||(m.b4w_pitch_random=0),"b4w_fade_in"in m||(m.b4w_fade_in=0),"b4w_fade_out"in m||(m.b4w_fade_out=0),"b4w_loop"in m||(m.b4w_loop=!1),"b4w_loop_count"in m||(m.b4w_loop_count=0),"b4w_loop_count_random"in m||(m.b4w_loop_count_random=0),"b4w_playlist_id"in m||(m.b4w_playlist_id=""),m.animation_data&&d(m.animation_data);g=a.textures;for(h=0;h<g.length;h++)m=
g[h],"b4w_anisotropic_filtering"in m||(m.b4w_anisotropic_filtering="OFF",c("texture",m,"b4w_anisotropic_filtering")),"b4w_water_foam"in m||(m.b4w_water_foam=!1,c("texture",m,"b4w_water_foam")),"b4w_foam_uv_freq"in m||(m.b4w_foam_uv_freq=[1,1],c("texture",m,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in m||(m.b4w_foam_uv_magnitude=[1,1],c("texture",m,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in m||(m.b4w_parallax_steps=5,c("material",m,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in m||(m.b4w_parallax_lod_dist=
10,c("material",m,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in m||(m.b4w_shore_dist_map=!1,c("texture",m,"b4w_shore_dist_map")),"b4w_shore_boundings"in m||(m.b4w_shore_boundings=new Float32Array(4),m.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],c("texture",m,"b4w_shore_boundings")),"b4w_max_shore_dist"in m||(m.b4w_max_shore_dist=100,c("texture",m,"b4w_max_shore_dist")),"b4w_disable_compression"in m||(m.b4w_disable_compression=!1,c("texture",m,"b4w_disable_compression")),"b4w_source_type"in m||(m.b4w_source_type=
"",c("texture",m,"b4w_source_type")),"b4w_source_id"in m||(m.b4w_source_id="",c("texture",m,"b4w_source_id")),"b4w_source_size"in m||(m.b4w_source_size=1024,c("texture",m,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in m||(m.b4w_enable_canvas_mipmapping=!0,c("texture",m,"b4w_enable_canvas_mipmapping"));f=a.materials;for(h=0;h<f.length;h++){k=f[h];"b4w_node_mat_type"in k&&e("material",k);"b4w_skydome"in k&&e("material",k);"b4w_procedural_skydome"in k&&e("material",k);k.b4w_water&&("b4w_water_shore_smoothing"in
k||(k.b4w_water_shore_smoothing=!1,c("material",k,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in k||(k.b4w_water_dynamic=!1,c("material",k,"b4w_water_dynamic")),"b4w_waves_height"in k||(k.b4w_waves_height=1,c("material",k,"b4w_waves_height")),"b4w_waves_length"in k||(k.b4w_waves_length=1,c("material",k,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in k||(k.b4w_water_dst_noise_scale0=.05,c("material",k,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in k||(k.b4w_water_dst_noise_scale1=
.03,c("material",k,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in k||(k.b4w_water_dst_noise_freq0=1.3,c("material",k,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in k||(k.b4w_water_dst_noise_freq1=1,c("material",k,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in k||(k.b4w_water_dir_min_shore_fac=.4,c("material",k,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in k||(k.b4w_water_dir_freq=.5,c("material",k,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in
k||(k.b4w_water_dir_noise_scale=.05,c("material",k,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in k||(k.b4w_water_dir_noise_freq=.07,c("material",k,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in k||(k.b4w_water_dir_min_noise_fac=.5,c("material",k,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in k||(k.b4w_water_dst_min_fac=.2,c("material",k,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in k||(k.b4w_water_waves_hor_fac=5,c("material",k,"b4w_water_waves_hor_fac")),
"b4w_water_absorb_factor"in k||(k.b4w_water_absorb_factor=6,c("material",k,"b4w_water_absorb_factor")),"b4w_water_fog_color"in k||(k.b4w_water_fog_color=new Float32Array(3),k.b4w_water_fog_color=[.5,.7,.7],c("material",k,"b4w_water_fog_color")),"b4w_foam_factor"in k||(k.b4w_foam_factor=5,c("material",k,"b4w_foam_factor")),"b4w_generated_mesh"in k||(k.b4w_generated_mesh=!1,c("material",k,"b4w_generated_mesh")),"b4w_water_num_cascads"in k||(k.b4w_water_num_cascads=5,c("material",k,"b4w_water_num_cascads")),
"b4w_water_subdivs"in k||(k.b4w_water_subdivs=64,c("material",k,"b4w_water_subdivs")),"b4w_water_detailed_dist"in k||(k.b4w_water_detailed_dist=1E3,c("material",k,"b4w_water_detailed_dist")));"b4w_dynamic_grass_size"in k||(k.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in k||(k.b4w_dynamic_grass_color="");"diffuse_intensity"in k||(k.diffuse_intensity=1,c("material",k,"diffuse_intensity"));"b4w_use_ghost"in k||(k.b4w_use_ghost=!1);"b4w_collision_margin"in k||(k.b4w_collision_margin=.04,c("material",
k,"b4w_collision_margin"));"b4w_collision_group"in k||(k.b4w_collision_group=128,c("material",k,"b4w_collision_group"));"b4w_collision_mask"in k||(k.b4w_collision_mask=127,c("material",k,"b4w_collision_mask"));"b4w_do_not_render"in k||(k.b4w_do_not_render=!1,c("material",k,"b4w_do_not_render"));"HALO"!=k.type||"b4w_halo_sky_stars"in k||(k.b4w_halo_sky_stars=!1,c("material",k,"b4w_halo_sky_stars"));"HALO"!=k.type||"b4w_halo_stars_blend_height"in k||(k.b4w_halo_stars_blend_height=10,c("material",k,
"b4w_halo_stars_blend_height"));"HALO"!=k.type||"b4w_halo_stars_min_height"in k||(k.b4w_halo_stars_min_height=0,c("material",k,"b4w_halo_stars_min_height"));"specular_shader"in k||(k.specular_shader="COOKTORR",c("material",k,"specular_shader"));"diffuse_shader"in k||(k.diffuse_shader="LAMBERT",c("material",k,"diffuse_shader"));"roughness"in k||(k.roughness=.5,c("material",k,"roughness"));"diffuse_fresnel"in k||(k.diffuse_fresnel=.1,c("material",k,"diffuse_fresnel"));"diffuse_fresnel_factor"in k||
(k.diffuse_fresnel_factor=.5,c("material",k,"diffuse_fresnel_factor"));"specular_slope"in k||(k.specular_slope=.2,c("material",k,"specular_slope"));"specular_toon_size"in k||(k.specular_toon_size=.5,c("material",k,"specular_toon_size"));"specular_toon_smooth"in k||(k.specular_toon_smooth=.1,c("material",k,"specular_toon_smooth"));"specular_alpha"in k||(k.specular_alpha=1,c("material",k,"specular_alpha"));"b4w_wettable"in k||(k.b4w_wettable=!1,c("material",k,"b4w_wettable"));"b4w_refractive"in k||
(k.b4w_refractive=!1,c("material",k,"b4w_refractive"));"b4w_refr_bump"in k||(k.b4w_refr_bump=0,c("material",k,"b4w_refr_bump"));"b4w_shallow_water_col"in k||(k.b4w_shallow_water_col=[0,.8,.3],c("material",k,"b4w_shallow_water_col"));"b4w_shore_water_col"in k||(k.b4w_shore_water_col=[0,.9,.2],c("material",k,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in k||(k.b4w_shallow_water_col_fac=1,c("material",k,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in k||(k.b4w_shore_water_col_fac=.5,
c("material",k,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in k||(k.b4w_water_sss_strength=5.9,c("material",k,"b4w_water_sss_strength"));"b4w_water_sss_width"in k||(k.b4w_water_sss_width=.45,c("material",k,"b4w_water_sss_width"));"b4w_render_above_all"in k||(k.b4w_render_above_all=!1,c("material",k,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in k||(k.b4w_water_norm_uv_velocity=.05,c("material",k,"b4w_water_norm_uv_velocity"));"specular_ior"in k||(k.specular_ior=1,c("material",k,"specular_ior"));
"darkness"in k||(k.darkness=0,c("material",k,"darkness"));"diffuse_toon_size"in k||(k.diffuse_toon_size=0,c("material",k,"diffuse_toon_size"));"diffuse_toon_smooth"in k||(k.diffuse_toon_smooth=0,c("material",k,"diffuse_toon_smooth"));m=k.texture_slots;for(g=0;g<m.length;g++)n=m[g],"blend_type"in n||(n.blend_type="MIX",c("texture_slot",n,"blend_type"));if(k.node_tree){m=k.node_tree.nodes;for(g=0;g<m.length;g++)b(m[g]);k.node_tree.animation_data&&d(k.node_tree.animation_data)}}n=a.node_groups;for(h=
0;h<n.length;h++)for(m=n[h].node_tree.nodes,g=0;g<m.length;g++)b(m[g]);m=a.objects;for(h=0;h<m.length;h++){n=m[h];switch(n.type){case "MESH":"b4w_dynamic_geometry"in n||(n.b4w_dynamic_geometry=!1);"b4w_reflexible"in n||(n.b4w_reflexible=!1);"b4w_reflexible_only"in n||(n.b4w_reflexible_only=!1);"b4w_reflective"in n||(n.b4w_reflective=!1);"b4w_reflection_type"in n||(n.b4w_reflection_type="PLANE",c("object",n,"b4w_reflection_type"));"b4w_wind_bending"in n||(n.b4w_wind_bending=!1,c("object",n,"b4w_wind_bending"));
"b4w_wind_bending_angle"in n||(n.b4w_wind_bending_angle=10,n.b4w_wind_bending_freq=.25,c("object",n,"wind bending params"));"b4w_detail_bending_amp"in n||(n.b4w_detail_bending_amp=.1,n.b4w_branch_bending_amp=.3,c("object",n,"detail bending params"));"b4w_detail_bending_freq"in n||(n.b4w_detail_bending_freq=1,c("object",n,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in n||(n.b4w_main_bend_stiffness_col="",c("object",n,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in n||(n.b4w_detail_bend_colors=
{leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},c("object",n,"b4w_detail_bend_colors"));"b4w_caustics"in n||(n.b4w_caustics=!1);"vertex_groups"in n&&n.vertex_groups.length&&n.data&&0==n.data.vertex_groups.length&&(n.data.vertex_groups=n.vertex_groups,delete n.vertex_groups,c("object",n,"vertex_groups"));"b4w_vertex_anim"in n&&n.b4w_vertex_anim.length&&n.data&&0==n.data.b4w_vertex_anim.length&&(n.data.b4w_vertex_anim=n.b4w_vertex_anim,delete n.b4w_vertex_anim,c("object",n,"b4w_vertex_anim"));
"b4w_do_not_render"in n||(n.b4w_do_not_render=!1);"use_ghost"in n.game||(n.game.use_ghost=!1);"use_sleep"in n.game||(n.game.use_sleep=!1);"velocity_min"in n.game||(n.game.velocity_min=0);"velocity_max"in n.game||(n.game.velocity_max=0);"collision_group"in n.game||(n.game.collision_group=1);"collision_mask"in n.game||(n.game.collision_mask=255);"b4w_vehicle_settings"in n?n.b4w_vehicle_settings&&("steering_ratio"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.steering_ratio=10),"steering_max"in n.b4w_vehicle_settings||
(n.b4w_vehicle_settings.steering_max=1),"inverse_control"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.inverse_control=!1),"force_max"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.force_max=1500),"brake_max"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.brake_max=100),"speed_ratio"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in n.b4w_vehicle_settings||
(n.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.roll_influence=
.1),"max_suspension_travel_cm"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.floating_factor=3),"floating_factor"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in n.b4w_vehicle_settings||(n.b4w_vehicle_settings.water_rot_damp=.9)):(n.b4w_vehicle_settings=null,c("object",n,"b4w_vehicle_settings"));
"b4w_floating_settings"in n?n.b4w_floating_settings&&("floating_factor"in n.b4w_floating_settings||(n.b4w_floating_settings.floating_factor=3),"water_lin_damp"in n.b4w_floating_settings||(n.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in n.b4w_floating_settings||(n.b4w_floating_settings.water_rot_damp=.8)):(n.b4w_floating_settings=null,c("object",n,"b4w_floating_settings"));"b4w_character_settings"in n?n.b4w_character_settings&&("walk_speed"in n.b4w_character_settings||(n.b4w_character_settings.walk_speed=
4),"run_speed"in n.b4w_character_settings||(n.b4w_character_settings.run_speed=8),"step_height"in n.b4w_character_settings||(n.b4w_character_settings.step_height=.25),"jump_strength"in n.b4w_character_settings||(n.b4w_character_settings.jump_strength=5),"waterline"in n.b4w_character_settings||(n.b4w_character_settings.waterline=0)):(n.b4w_character_settings=null,c("object",n,"b4w_character_settings"));"b4w_selectable"in n||(n.b4w_selectable=!1,c("object",n,"b4w_selectable"));"b4w_outlining"in n||
(n.b4w_outlining=!1,c("object",n,"b4w_outlining"));"b4w_outline_on_select"in n||(n.b4w_outline_on_select=!1,c("object",n,"b4w_outline_on_select"));"b4w_billboard"in n||(n.b4w_billboard=!1,c("object",n,"b4w_billboard"));"b4w_billboard_geometry"in n||(n.b4w_billboard_geometry="SPHERICAL",c("object",n,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in n||(n.b4w_pres_glob_orientation=!1,c("object",n,"b4w_pres_glob_orientation"));"b4w_outline_settings"in n||("b4w_glow_settings"in n?n.b4w_outline_settings=
n.b4w_glow_settings:(n.b4w_outline_settings={},n.b4w_outline_settings.outline_duration=1,n.b4w_outline_settings.outline_period=1,n.b4w_outline_settings.outline_relapses=0),c("object",n,"b4w_outline_settings"));"b4w_lod_transition"in n||(n.b4w_lod_transition=.01,c("object",n,"b4w_lod_transition"));"lod_levels"in n||(n.lod_levels=[],c("object",n,"lod_levels"));"b4w_animation_mixing"in n||(n.b4w_animation_mixing=!1,c("object",n,"b4w_animation_mixing"));break;case "EMPTY":"b4w_group_relative"in n||(n.b4w_group_relative=
!1,c("object",n,"b4w_group_relative")),"b4w_anchor"in n||(n.b4w_anchor=null,c("object",n,"b4w_anchor")),!n.b4w_anchor||"max_width"in n.b4w_anchor||(n.b4w_anchor.max_width=250)}"collision_margin"in n.game||(n.game.collision_margin=.04,c("object",n,"collision_margin"));"b4w_anim_behavior"in n||(n.b4w_anim_behavior=n.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",c("object",n,"b4w_anim_behavior"));if(!("rotation_quaternion"in n)){g=[0,0,0,1];l.euler_to_quat(n.rotation_euler,g);var f=g,k=g[0],r=g[1],y=g[2];
f[0]=g[3];f[1]=k;f[2]=r;f[3]=y;n.rotation_quaternion=g;c("object",n,"rotation_quaternion")}"webgl_do_not_batch"in n&&(n.b4w_do_not_batch=n.webgl_do_not_batch)&&e("object",n);"b4w_shadow_cast_only"in n||(n.b4w_shadow_cast_only=!1,c("object",n,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in n||(n.b4w_correct_bounding_offset="AUTO",c("object",n,"b4w_correct_bounding_offset"));f=n.particle_systems;for(g=0;g<f.length;g++)k=f[g],r=k.settings,"use_rotation_dupli"in r||(r.use_rotation_dupli=!1,c("object",
r,"use_rotation_dupli")),"use_whole_group"in r||(r.use_whole_group=!1,c("object",r,"use_whole_group")),k.transforms||(k.transforms=new Float32Array,c("particle_system",k,"transforms")),"b4w_billboard_align"in r||(r.b4w_billboard_align="VIEW",c("particle_settings",r,"b4w_billboard_align")),"b4w_dynamic_grass"in r||(r.b4w_dynamic_grass=!1,c("object",r,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in r||(r.b4w_dynamic_grass_scale_threshold=.01,c("object",r,"b4w_dynamic_grass_scale_threshold")),
"b4w_initial_rand_rotation"in r||(r.b4w_initial_rand_rotation=!1,c("particle_settings",r,"b4w_initial_rand_rotation")),"b4w_rotation_type"in r||(r.b4w_rotation_type="Z",c("particle_settings",r,"b4w_rotation_type")),"b4w_rand_rotation_strength"in r||(r.b4w_rand_rotation_strength=1,c("particle_settings",r,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in r||(r.b4w_hair_billboard=!1,c("particle_settings",r,"b4w_hair_billboard")),"b4w_hair_billboard_type"in r||(r.b4w_hair_billboard_type="BASIC",c("particle_settings",
r,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in r||(r.b4w_hair_billboard_jitter_amp=0,c("particle_settings",r,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in r||(r.b4w_hair_billboard_jitter_freq=0,c("particle_settings",r,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in r||(r.b4w_hair_billboard_geometry="SPHERICAL",c("particle_settings",r,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in r||(r.b4w_wind_bend_inheritance="PARENT",c("particle_settings",
r,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in r||(r.b4w_shadow_inheritance="PARENT",c("particle_settings",r,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in r||(r.b4w_reflection_inheritance="PARENT",c("particle_settings",r,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in r||(r.b4w_vcol_from_name="",c("particle_settings",r,"b4w_vcol_from_name")),"b4w_vcol_to_name"in r||(r.b4w_vcol_to_name="",c("particle_settings",r,"b4w_vcol_to_name")),"b4w_coordinate_system"in r||(r.b4w_coordinate_system=
"LOCAL",c("particle_settings",r,"b4w_coordinate_system")),"b4w_allow_nla"in r||(r.b4w_allow_nla=!0,c("particle_settings",r,"b4w_allow_nla"));"constraints"in n||(n.constraints=[],c("object",n,"constraints"));f=n.modifiers;for(g=0;g<f.length;g++){a:{k=f[g];switch(k.type){case "ARRAY":if(!("fit_type"in k)){p.error("WARNING Incomplete modifier "+String(k.type)+' for "'+n.name+'", reexport "'+a.b4w_filepath_blend+'" scene');k=!1;break a}}k=!0}k||(f.splice(g,1),g--)}"animation_data"in n||(n.animation_data=
{action:null,nla_tracks:[]},c("object",n,"animation_data"));n.animation_data&&("action"in n.animation_data||(n.animation_data.action=null,p.warn("no action in animation data "+n.name)),"nla_tracks"in n.animation_data||(n.animation_data.nla_tracks=[],p.warn("no NLA in animation data "+n.name)),d(n.animation_data));"b4w_collision_id"in n||(n.b4w_collision_id="",c("material",n,"b4w_collision_id"));g=n.scale;0==g[0]&&0==g[1]&&0==g[2]?g=!0:(f=Math.abs((g[1]-g[2])/g[1]),g=.005>Math.abs((g[0]-g[1])/g[0])&&
.005>f);g||p.warn("non-uniform scale for object "+n.name)}for(var q in E)h=E[q],g=q.match(/.*?(?=>>|$)/i)[0],p.warn("WARNING "+String(g)+" is "+h.js+" for "+h.type+", reexport "+a.b4w_filepath_blend)};a.Nv=function(a,b){"num_channels"in a||(a.num_channels=1,p.warn('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.nv=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var d=b[c].type;if("ARRAY"==d||"CURVE"==d){b=!0;break a}}b=!1}if(!b)return null;
b=g(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var e=a[c];switch(e.type){case "ARRAY":for(var d=b,p=e,k=0,q=0,v=0,L=new Float32Array(16),e=[],J=1;J<p.count;J++){p.use_constant_offset&&(k+=p.constant_offset_displace[0],q+=p.constant_offset_displace[1],v+=p.constant_offset_displace[2]);if(p.use_relative_offset)var E=d.b4w_bounding_box,k=k+(E.max_x-E.min_x)*p.relative_offset_displace[0],q=q+(E.max_y-E.min_y)*p.relative_offset_displace[1],v=v+(E.max_z-E.min_z)*p.relative_offset_displace[2];
l.oB(k,q,v,L);for(var z=E=g(d),N=L,H=0;H<z.submeshes.length;H++){var K=z.submeshes[H];l.We(K.position,N,K.position,0);l.gC(K.normal,N,K.normal);l.lB(K.tangent,N,K.tangent)}e.push(E)}for(J=0;J<e.length;J++)for(p=d,k=e[J],q=0;q<p.submeshes.length;q++){v=p.submeshes[q];L=k.submeshes[q];E=v.base_length;z=v.indices.length;v.base_length+=L.base_length;for(var O in v)if("base_length"!=O)if("indices"==O)for(v[O]=l.sB(v[O],L[O]),N=z;N<v.indices.length;N++)v.indices[N]+=E;else"vertex_colors"!=O&&(v[O]=l.xx(v[O],
L[O]))}break;case "CURVE":for(var d=b,J=e.object.Tu,p=new Float32Array(16),q=J.Qe?4:3,k=new Float32Array(q),q=new Float32Array(q),v=new Float32Array(3),L=new Float32Array(4),E=new Float32Array(4),z=new Float32Array(3),N=new Float32Array(3),H=new Float32Array(3),K=new Float32Array(4),X=new Float32Array(4),aa=0;aa<d.submeshes.length;aa++){var Z=d.submeshes[aa],Q=Z.position,ha=Z.normal,Z=Z.tangent,ka;a:switch(ka=e.deform_axis,ka){case "POS_X":case "NEG_X":ka=0;break a;case "POS_Y":case "NEG_Y":ka=1;
break a;case "POS_Z":case "NEG_Z":ka=2;break a;default:throw"Wrong deform axis value "+ka;}z[0]=0;z[1]=0;z[2]=0;z[ka]=1;for(var qa=h.VA(J),w=0;w<Q.length/3;w++){H[0]=Q[3*w];H[1]=Q[3*w+1];H[2]=Q[3*w+2];var ba=H[ka],ma=h.UA(J,ba);h.WA(J,ma,k);v[0]=k[0];v[1]=k[1];v[2]=k[2];h.TA(J,ma,q);N[0]=q[0];N[1]=0;N[2]=q[2];m.normalize(N,N);n.rotationTo(z,N,L);0>ba?(k[0]=N[0],k[1]=N[1],k[2]=N[2],m.scale(k,ba,k),m.add(v,k,v)):ba>qa&&(k[0]=N[0],k[1]=N[1],k[2]=N[2],m.scale(k,ba-qa,k),m.add(v,k,v));y.fromRotationTranslation(L,
v,p);J.Qe&&(n.setAxisAngle(z,k[3],E),m.transformQuat(H,E,H));H[ka]=0;m.transformMat4(H,p,H);Q[3*w]=H[0];Q[3*w+1]=H[1];Q[3*w+2]=H[2];ha.length&&(K[0]=ha[3*w],K[1]=ha[3*w+1],K[2]=ha[3*w+2],K[3]=0,r.transformMat4(K,p,K),ha[3*w]=K[0],ha[3*w+1]=K[1],ha[3*w+2]=K[2]);Z.length&&(X[0]=Z[3*w],X[1]=Z[3*w+1],X[2]=Z[3*w+2],X[3]=0,r.transformMat4(X,p,X),Z[3*w]=X[0],Z[3*w+1]=X[1],Z[3*w+2]=X[2])}}}f.Kz(b)}return b};a.iD=function(){return{name:"DEFAULT",use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],
diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,
b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]}};a.vv=function(a,b){for(var c=0;c<
b.length;c++){var d=b[c];if(d.b4w_use_nla)for(var d=d.b4w_nla_script,e=0;e<d.length;e++){var f=d[e];switch(f.type){case "SELECT":case "SELECT_PLAY":for(var g=0;g<a.length;g++){var l=a[g];l.name==f.object&&(l.b4w_selectable=!0)}break;case "SHOW":case "HIDE":for(g=0;g<a.length;g++)l=a[g],l.name==f.object&&(l.b4w_do_not_batch=!0)}}}}};b4w.module.__scenegraph=function(a,q){function b(a){a=ua.qa(a);a.be=null;a.eb=null;a.Lc=null;return a}function d(a,b){var d=[];M.se(a,function(b,c,f){-1<d.indexOf(f)?M.Uz(a,b,c,f,e(f)):d.push(f)});M.O(a,function(c,f){for(var g=0;g<f.fa.length;g++){var D=f.fa[g];b||"MAIN_PLANE_REFLECT"!=f.type&&"MAIN_CUBE_REFLECT"!=f.type&&"MAIN_XRAY"!=f.type||(D.xg=!0);-1<d.indexOf(D)?f.fa[g]=e(D):d.push(D)}"ANTIALIASING"==f.type&&M.te(a,c,function(a,b){if("MOTION_BLUR"==b.type)for(var c=0;c<b.fa.length;c++){var d=
b.fa[c];d.Z=Y.r;d.Y=Y.r}});b||M.te(a,c,function(a,b,c){"DEPTH"==c.M&&(c.xg=!0)})});M.O(a,function(b){var d={};c(a,b,d);for(var e in d){b=d[e];for(var f=b[0],g=0;g<b.length;g++)if(b[g].Z==Y.r){f=b[g];break}for(var D=b[0],g=0;g<b.length;g++)if(b[g].Y==Y.r){D=b[g];break}for(var l=b[0],g=0;g<b.length;g++)if(!b[g].xg){l=b[g];break}for(g=0;g<b.length;g++)b[g].Z=f.Z,b[g].Y=D.Y,b[g].xg=l.xg}})}function c(a,b,d){M.te(a,b,function(b,e,f){f.Ma&&f.M==f.la&&(d[f.M]=d[f.M]||[],-1==d[f.M].indexOf(f)&&d[f.M].push(f),
c(a,b,d))});M.kf(a,b,function(a,b,c){c.Ma&&(d[c.M]=d[c.M]||[],-1==d[c.M].indexOf(c)&&d[c.M].push(c))});b=M.Ya(a,b);if("MOTION_BLUR"==b.type)for(var e=0;e<b.fa.length;e++){var f=b.fa[e];d[f.M].push(f)}}function e(a){if(a.ta)throw"Failed to clone slink with attached texture";return ua.Df(a)}function g(a){var b=M.bo(a),c=[];M.O(b,function(a,d){switch(d.type){case "MOTION_BLUR":case "SMAA_RESOLVE":case "SMAA_NEIGHBORHOOD_BLENDING":case "MAIN_PLANE_REFLECT":var e=[];break;default:e=c}for(var f=0;f<d.fa.length;f++){var g=
d.fa[f],D=m(e,g,h(g));g.ta=D;d.Bd[f]=D}for(f=0;f<d.Bd.length;f++)D=d.Bd[f],l(e,D);switch(d.type){case "MOTION_BLUR":case "SMAA_RESOLVE":case "SMAA_NEIGHBORHOOD_BLENDING":case "MAIN_PLANE_REFLECT":e=[]}M.kf(b,a,function(c,d,f){if(!f.ta){if((c=p(b,a,f.M))&&f.Ma&&!f.ta){d=e;for(var g=c,D=0;D<d.length;D++){var l=d[D];l.Yn===g&&l.Oi++}}else c=m(e,f,h(f));f.ta=c}});M.te(b,a,function(a,b,c){l(e,c.ta)});M.kf(b,a,function(a,b,c){c.ta&&"NONE"==c.la&&l(e,c.ta)})})}function f(a){n(a,function(b,c,d){b.Ih&&(V(a,
d,"SMAA_NEIGHBORHOOD_BLENDING")&&"SMAA_NEIGHBORHOOD_BLENDING"!=d.type||V(a,d,"ANTIALIASING")||"ANCHOR_VISIBILITY"==d.type)&&(b.ef*=da.render_resolution_factor)})}function h(a){a=ua.Df(a);delete a.la;delete a.Ma;delete a.ta;return JSON.stringify(a)}function p(a,b,c){var d=null;M.te(a,b,function(a,b,e){if(e.Ma&&e.M==e.la&&e.M==c&&e.ta)return d=e.ta,!0});M.kf(a,b,function(a,b,e){if(e.Ma&&e.M==c&&e.ta)return d=e.ta,!0});return d}function l(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.Yn===b&&d.Oi&&d.Oi--}}
function m(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=a[e];if(f.id==c&&0===f.Oi){d=f;break}}if(d&&!da.mr)return d.Oi++,d.Yn;b=r(b);a.push({id:c,Oi:1,Yn:b});return b}function r(a){var b=a.ef*a.size;switch(a.M){case "COLOR":var c=Y.Jj("COLOR",Y.Dg);Y.resize(c,b,b);Y.Gn(c,a.Z,a.Y);return c;case "DEPTH":return a.xg?(c=Y.Jj("DEPTH_RBUF",Y.Cg),Y.resize(c,b,b)):(c=Y.Jj("DEPTH_TEX",Y.Qh),Y.resize(c,b,b),Y.Gn(c,a.Z,a.Y)),c;case "CUBEMAP":return c=Y.sw(b);case "SCREEN":return null;default:throw"Wrong slink param: "+
a.M;}}function n(a,b){var c=!1;M.se(a,function(d,e,f){if(f&&(d=M.Ya(a,d),e=M.Ya(a,e),b(f,!1,d,e)))return c=!0});c||M.O(a,function(a,c){for(var d=0;d<c.fa.length;d++)if(b(c.fa[d],!0,c,null))return!0})}function y(a){M.O(a,function(b,c){if("SINK"!=c.type){var d=c.i;M.kf(a,b,function(a,b,c){c.Ma&&c.ta&&(D.Gk(d,c.M,c.ta),c.M==c.la&&b.i&&D.Gk(b.i,c.M,c.ta))});for(var e=0;e<c.fa.length;e++){var f=c.fa[e];f.Ma&&f.M==f.la&&D.Gk(d,f.M,c.Bd[e])}!d.eb&&!d.Lc||d.be||(d.be=Xb.Tz(d.eb,d.Lc))}})}function v(a){var b=
null,c=0;M.O(a,function(a,d){if(d.type==sb.hB){if(c==sb.gB)return b=d,!0;c++}});return b}function E(a,b){var c=M.cg(a,b),d=A("NONE"),e=M.s(a,d),f=M.Aq(a)[0];M.se(a,function(b,c){c==f&&M.Lz(a,b,f,b,e)});M.se(a,function(e,f,g){if(e==c)return M.l(a,b,d,B(sb.HA,"u_color",g.size,g.ef,g.Ih)),!0});M.Uc(a,e,f,B("SCREEN","NONE",.5,.5,!0))}function x(a,b){var c=u("SHADOW_CAST");c.Sl=a;c.self_shadow_polygon_offset=b.self_shadow_polygon_offset;switch(b.Wm){case "SPOT":case "POINT":c.i=D.kb(D.Hb);D.Hk(c.i,180*
b.dd/Math.PI,.1,2*b.distance);break;default:c.i=D.kb(D.tf)}return c}function u(a){return{type:a,Ka:"",Fa:!1,Rr:!1,ol:!1,kk:!1,ei:0,time:0,i:null,di:null,Ul:[],p:[],fa:[],Bd:[],dj:new Float32Array(3),wt:new Float32Array(3),bc:new Float32Array(3),$b:new Float32Array(4),mc:new Float32Array(16),zs:0,Ke:0,eg:0,Vf:null,Xf:null,Uf:null,Wf:null,Ne:new Float32Array(3),rf:new Float32Array(3),As:new Float32Array(4),Ts:new Float32Array([0,0,0]),Nk:new Float32Array(3),Us:new Float32Array(4),ys:new Float32Array(3),
Fi:0,cm:0,vi:!1,Ue:new Float32Array(3),of:0,$a:null,Vk:!1,bf:new Float32Array(2),cf:new Float32Array(2),th:0,hh:0,Dl:0,gd:null,qf:0,Bg:0,pf:0,Af:!1,pp:0,qp:new Float32Array(2),op:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,uh:new Float32Array(3),ssao_hemisphere:0,ssao_blur_depth:0,ssao_blur_discard_value:0,yh:0,
xh:0,wh:0,Ls:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,gh:0,Ck:0,Bh:0,Sl:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,kt:null,bp:null,jg:null,bloom_key:0,bloom_blur:0,bloom_edge_lum:0,vl:0,im:0,mb_decay_threshold:0,mb_factor:0,rr:0,yk:"",Uy:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,Zn:new Float32Array(2),w:new Float32Array(2),Xa:!0,enqueue:!0,da:!0,ia:!0,Db:!0,
ja:!0,re:1}}function B(a,b,c,d,e){return{M:a,la:b,size:c,ef:d,Ih:e,Ma:!0,ta:null,xg:!1,Z:Y.Id,Y:Y.Id}}function t(a,b){for(var c=0,d=ra(a,b),e=0;e<d.length;e++){var f=d[e];"SHADOW_CAST"==f.type&&(f=f.i,b.xz=f.Pa/(f.Pa-f.Qa),b.kt=f.ma,b.bp=new Float32Array([.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1]),b.jg=b.jg||[],b.jg[c]=f.sa,c++)}}function G(){var a=u("GRASS_MAP");a.i=D.kb(D.ye);return a}function A(a){var b=u("POSTPROCESSING");b.da=!1;b.ia=!1;b.Db=!1;b.i=D.kb(D.tb);b.yk=a;switch(a){case "NONE":b.w[0]=
1;b.w[1]=1;break;case "GRAYSCALE":b.w[0]=1;b.w[1]=1;break;case "X_BLUR":b.w[0]=1;b.w[1]=0;break;case "Y_BLUR":b.w[0]=0;b.w[1]=1;break;case "X_GLOW_BLUR":b.w[0]=1;b.w[1]=0;break;case "Y_GLOW_BLUR":b.w[0]=0;b.w[1]=1;break;case "X_EXTEND":b.w[0]=1;b.w[1]=0;break;case "Y_EXTEND":b.w[0]=0;b.w[1]=1;break;default:throw"Wrong postprocessing effect: "+a;}return b}function k(a){var b=u("BLOOM_BLUR");b.da=!1;b.ia=!1;b.Db=!1;b.i=D.kb(D.tb);b.yk=a;switch(a){case "X_BLUR":b.w[0]=1;b.w[1]=0;break;case "Y_BLUR":b.w[0]=
0;b.w[1]=1;break;default:throw"Wrong postprocessing effect for bloom blur: "+a;}return b}function I(a,b){var c=u("GLOW_COMBINE");c.da=!1;c.ia=!1;c.Db=!1;c.small_glow_mask_coeff=b.Me.small_glow_mask_coeff;c.large_glow_mask_coeff=b.Me.large_glow_mask_coeff;c.small_glow_mask_width=b.Me.small_glow_mask_width;c.large_glow_mask_width=b.Me.large_glow_mask_width;c.w[0]=1;c.w[1]=1;c.i=a;return c}function F(a,b,c,d,e,f,g,D,l){var k=u("MAIN_"+a);if("OPAQUE"===a)k.da=!0,k.ia=c,k.Fa=!1;else if("BLEND"===a)k.da=
!1,k.ia=!1,k.Fa=!0;else if("XRAY"===a)k.da=!1,k.ia=!0,k.Fa=!0;else if("PLANE_REFLECT"===a||"CUBE_REFLECT"===a)k.da=!0,k.ia=!0,k.Fa=!1;else if("GLOW"===a)k.da=!0,k.ia=!1,k.Fa=!1;else throw"wrong main subscene type";k.Fa&&D&&(k.self_shadow_normal_offset=D.self_shadow_normal_offset);k.i=b;if(a=g.Kn)k.As.set([a.Dv,a.Ey,a.pC,a.oC]),k.ys.set(a.color),k.zs=a.Aa;k.Ne.set(g.Ne);k.rf.set(g.rf);k.Ke=g.Ke;k.$b=f;d&&(k.$a=d,d.$b&&(k.gd=new Float32Array(d.$b)),k.qf=d.waves_height,k.Bg=d.waves_length,k.pf=d.pf,
d.Dj&&l&&(k.Af=!0,k.pp=d.Dj,k.qp.set(d.Gl),k.op=d.Fl),d.Jk&&(k.Vk=!0,f=d.FA,k.bf[0]=(f[0]+f[1])/2,k.bf[1]=(f[2]+f[3])/2,k.cf[0]=f[0]-f[1],k.cf[1]=f[2]-f[3],k.th=d.th,k.hh=d.hh));k.Vf=new Float32Array(3*e);k.Xf=new Float32Array(3*e);k.Uf=new Float32Array(3*e);k.Wf=new Float32Array(0==e%2?2*e:2*e+2);return k}function L(a,b){var c=u("COLOR_PICKING");b&&(c.type+="_XRAY",c.da=!1,c.ia=!0);c.enqueue=!1;c.i=a;return c}function J(a){var b=u("WIREFRAME");b.Xa=!1;b.da=!1;b.ia=!1;b.i=a;return b}function P(a){var b=
u("ANCHOR_VISIBILITY");b.da=!0;b.ia=!1;b.w[0]=1;b.w[1]=1;b.i=a;return b}function z(a,b){var c=u("DEPTH");c.i=a;c.self_shadow_normal_offset=b.self_shadow_normal_offset;return c}function N(a,b,c){var d=u("SSAO");d.da=!1;d.ia=!1;d.Db=!1;d.i=a;d.w[0]=1;d.w[1]=1;d.$b=b;d.gd=new Float32Array(b);d.yh=c.radius_increase;d.ssao_hemisphere=c.Dy;d.xh=c.influence;d.wh=c.dist_factor;d.Ls=c.aA;return d}function H(a,b){var c=u("SSAO_BLUR");c.da=!1;c.ia=!1;c.Db=!1;c.w[0]=1;c.w[1]=1;c.i=a;c.ssao_blur_depth=b.Fv;c.ssao_blur_discard_value=
b.hp;return c}function K(){var a=u("ANTIALIASING");a.da=!1;a.ia=!1;a.Db=!1;a.re=1/da.render_resolution_factor;a.w[0]=1;a.w[1]=1;a.i=D.kb(D.tb);return a}function O(a){var b=u(a);b.da="SMAA_BLENDING_WEIGHT_CALCULATION"==a||"SMAA_EDGE_DETECTION"==a?!0:!1;b.ia=!1;b.Db=!1;b.re=1/da.render_resolution_factor;b.w[0]=1;b.w[1]=1;b.i=D.kb(D.tb);"SMAA_BLENDING_WEIGHT_CALCULATION"==a&&(b.Vy=new Float32Array(4));return b}function X(a,b,c,d){var e=u("COMPOSITING");e.da=!1;e.ia=!1;e.Db=!1;e.w[0]=1;e.w[1]=1;e.i=D.kb(D.tb);
e.brightness=a;e.contrast=b;e.exposure=c;e.saturation=d;return e}function aa(a,b){var c=u("MOTION_BLUR");c.da=!1;c.ia=!1;c.Db=!1;c.i=D.kb(D.tb);c.ol=!0;c.mb_decay_threshold=a;c.mb_factor=b;return c}function Z(a){var b=u("DOF");b.da=!1;b.ia=!1;b.Db=!1;b.w[0]=1;b.w[1]=1;b.i=a;b.re=b.i.dof_power;return b}function Q(a){var b=u("OUTLINE_MASK");b.Db=!1;b.w[0]=1;b.w[1]=1;b.i=a;return b}function ha(a){var b=u("OUTLINE");b.Ue.set(a.Ue);b.Fi=a.Fi;b.im=5;b.vl=3;b.Db=!1;b.i=D.kb(D.tb);return b}function ka(){var a=
u("REFRACT");a.da=!1;a.ia=!1;a.Db=!1;a.i=D.kb(D.tb);return a}function qa(a,b,c,d,e,f,g){var D=u("GOD_RAYS");D.da=!1;D.ia=!1;D.Db=!1;D.Ne=new Float32Array([1,1,1]);D.rf=new Float32Array([1,1,1]);D.Ke=1;D.Rr=d;D.of=b;D.Ck=e;D.gh=c;D.Bh=g;D.i=a;D.eg=f;D.Vf=new Float32Array(3*f);D.Xf=new Float32Array(3*f);D.Uf=new Float32Array(3*f);D.w[0]=1;D.w[1]=1;D.Wf=new Float32Array(0==f%2?2*f:2*f+2);return D}function w(a,b){var c=u("GOD_RAYS_COMBINE");c.da=!1;c.ia=!1;c.Db=!1;c.i=D.kb(D.tb);c.god_rays_intensity=
a;c.eg=b;c.Vf=new Float32Array(3*b);c.Xf=new Float32Array(3*b);c.Uf=new Float32Array(3*b);c.w[0]=1;c.w[1]=1;c.Wf=new Float32Array(0==b%2?2*b:2*b+2);return c}function ba(a,b){var c=u("SKY");c.enqueue=!1;c.da=!1;c.ia=!1;c.Db=!1;var d=D.kb(D.tb);d.width=Ya.Fe;d.height=Ya.Fe;c.i=d;c.di=ua.Jx();c.eg=a;c.Vf=new Float32Array(3*a);c.Xf=new Float32Array(3*a);c.Uf=new Float32Array(3*a);c.Wf=new Float32Array(0==a%2?2*a:2*a+2);c.Ne=new Float32Array([1,1,1]);c.rf=new Float32Array([1,1,1]);c.Ke=1;c.uh.set(b.uh);
c.procedural_skydome=b.procedural_skydome;c.use_as_environment_lighting=b.use_as_environment_lighting;c.rayleigh_brightness=b.rayleigh_brightness;c.mie_brightness=b.mie_brightness;c.spot_brightness=b.spot_brightness;c.scatter_strength=b.scatter_strength;c.rayleigh_strength=b.rayleigh_strength;c.mie_strength=b.mie_strength;c.rayleigh_collection_power=b.rayleigh_collection_power;c.mie_collection_power=b.mie_collection_power;c.mie_distribution=b.mie_distribution;c.w[0]=1;c.w[1]=1;return c}function ma(){var a=
u("COPY");a.da=!1;a.ia=!1;a.i=D.kb(D.tb);return a}function W(){var a=u("ANAGLYPH");a.da=!1;a.ia=!1;a.i=D.kb(D.tb);return a}function ia(){var a=u("LUMINANCE");a.da=!1;a.ia=!1;a.w[0]=1;a.w[1]=1;a.i=D.kb(D.tb);return a}function ga(){var a=u("AVERAGE_LUMINANCE");a.da=!1;a.ia=!1;a.w[0]=1;a.w[1]=1;a.i=D.kb(D.tb);return a}function pa(a,b,c,d){var e=u("LUMINANCE_TRUNCED");e.da=!1;e.ia=!1;e.bloom_key=a;e.bloom_edge_lum=b;e.w[0]=1;e.w[1]=1;e.i=d;e.Vf=new Float32Array(3*c);e.Xf=new Float32Array(3*c);e.Uf=new Float32Array(3*
c);e.Wf=new Float32Array(0==c%2?2*c:2*c+2);return e}function T(a){var b=u("BLOOM");b.da=!1;b.ia=!1;b.w[0]=1;b.w[1]=1;b.i=D.kb(D.tb);b.bloom_blur=a;return b}function R(){var a=u("SINK");a.enqueue=!1;return a}function V(a,b,c){if(b.type===c)return!0;b=sa(a,b);for(var d=0;d<b.length;d++)if(V(a,b[d],c))return!0;return!1}function ja(a,b,c){if(b.type===c)return!0;b=ra(a,b);for(var d=0;d<b.length;d++)if(ja(a,b[d],c))return!0;return!1}function ra(a,b){var c=M.cg(a,b);if(c==M.Co)throw"Subscene not in graph";
for(var d=[],e=M.Pq(a,c),f=0;f<e;f++){var g=M.Tj(a,c,f);g!=c&&d.push(M.Ya(a,g))}return d}function sa(a,b){var c=M.cg(a,b);if(c==M.Co)throw"Subscene not in graph";for(var d=[],e=M.ig(a,c),f=0;f<e;f++){var g=M.Of(a,c,f);g!=c&&d.push(M.Ya(a,g))}return d}function S(a){var b=[],c=[];n(a,function(a){a.ta&&-1==b.indexOf(a.ta)&&(b.push(a.ta),c.push(a.ta,b.length-1))});return c}function ea(a,b){var c;c=""+(a.M+"\\n");c+="NONE"!=a.la?a.la+"\\n":"";c+="(";if(a.Ih){var d=a.ef;Math.round(d)!=d&&(d=d.toFixed(2));
d=(1==d?"":d)+"S";c+=d+"x"+d}else c+=a.size+"x"+a.size;if("SCREEN"!=a.M){c+=" ";if(a.xg)c+="RR";else{var d=a.Z,e=a.Y,f="";d==Y.r?f+="L":d==Y.Id&&(f+="N");e==Y.r?f+="L":e==Y.Id&&(f+="N");c+=f}for(d=0;d<b.length;d+=2)b[d]==a.ta&&(c+=" "+b[d+1])}return c+")\\n"}var D=q("__camera"),U=q("__config"),va=q("__debug"),M=q("__graph"),Xb=q("__renderer"),Y=q("__textures"),ua=q("__util");q("vec4");var sb=U.Zl,da=U.o,Ya=U.Ti;a.Wv=function(a){switch(a.la){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "NONE":return!1;
default:return!0}};a.rB=n;a.Dw=function(a,c,e){function l(d,e){var f=b(wa[e]);c.G.push(f);f=F(d,f,!1,$a,na,Jb,Kb,Sa,a.tg);U.push(f);M.s(h,f);M.l(h,m[e],f,S[e]);"XRAY"==d?f.fa.push(B("DEPTH","DEPTH",1,1,!0)):M.l(h,m[e],f,p[e]);Wa&&(M.l(h,Wa,f,Rb),M.l(h,Wa,f,hb));if(Qa){for(var g=0;g<sa.length;g++)M.l(h,sa[g],f,Xb[g]);if(ob.fc&&ub||Ba){var g=Yb[e],D=b(g.i);c.G.push(D);var k=u("DEPTH_PACK");k.da=!1;k.ia=!1;k.i=D;M.s(h,k);var D=B("DEPTH","u_depth",1,1,!0),n=B("COLOR","u_scene_depth",1,1,!0);n.Z=Y.Id;
n.Y=Y.Id;M.l(h,g,k,D);M.l(h,k,f,n)}}if(r.length)for(k=r.length/wa.length,g=0;g<k;g++)D=k*e+g,M.l(h,r[D],f,ea[D]);if(ja.length)for(g=0;g<ja.length;g++)M.l(h,ja[g],f,ra[g]);q.length&&M.l(h,q[e],f,V[e]);return f}var h=M.create(),m=[],U=[],n=[],S=[],p=[],r=[],ea=[],q=[],V=[],sa=[],Xb=[],ja=[],ra=[],na=a.dr,$a=a.$a,Ba=a.shore_smoothing,Ga=a.Dn,pb=a.ff,Ca=a.Xg,ob=a.fz,Cb=a.zb,tc=a.Ig,uc=a.jh,vc=a.Mg,Lb=a.antialiasing,Kb=a.vo,Jb=a.$b,Sa=a.wd,ab=a.iz,vb=a.Ev,Ra=a.Mv,Da=a.xy,gb=a.vz,wb=a.Qg,Qa=a.bx,ub=a.fc,
ya=Boolean(e.length),wa=[];if(a.anaglyph_use&&!ya){var xb=c.G[0],qb=b(xb);D.or(xb,D.ub);D.or(qb,D.Bb);wa.push(xb,qb);c.G.push(qb)}else{var xa=c.G[0];wa.push(xa)}if(Ga){D.ho(wa[0],Sa);for(var ic=Sa.csm_num,ca=0;ca<ic;ca++){var yb=x(ca,Sa);M.s(h,yb);sa.push(yb);var Na=Sa.csm_resolution,xa=yb.i;xa.width=Na;xa.height=Na;yb.da=!1;Xb.push(B("DEPTH","u_shadow_map"+ca,Na,1,!1));(va.sp()||da.cq)&&yb.fa.push(B("COLOR","COLOR",Na,1,!1))}}if(Cb&&Cb.xr&&!ya)for(ca=0;ca<Cb.xr;ca++){xa=D.kb(D.Hb);xa.width=Ya.Fe;
xa.height=Ya.Fe;D.Hk(xa,90,.1,100);D.$e(xa,xa.wa);var za=F("CUBE_REFLECT",xa,!1,$a,na,Jb,Kb,null,a.tg);za.di=ua.Nx();for(var Aa=0;6>Aa;Aa++)za.Ul.push(D.vw());M.s(h,za);var jb=B("CUBEMAP","u_cube_reflection",Ya.Fe,1,!1);jb.Z=Y.r;jb.Y=Y.r;var Kc=B("DEPTH","DEPTH",Ya.Fe,1,!1);ra.push(jb);za.fa.push(Kc);ja.push(za);Cb.Kj.push(za)}if(Cb&&0<Cb.Dk.length&&!ya)for(ca=0;ca<wa.length;ca++)for(Aa=0;Aa<Cb.Dk.length;Aa++)xa=b(wa[ca]),xa.ec=new Float32Array(4),c.G.push(xa),za=F("PLANE_REFLECT",xa,!1,$a,na,Jb,
Kb,null,a.tg),M.s(h,za),jb=B("COLOR","u_plane_reflection",1,da.Pi,!0),jb.Z=Y.r,jb.Y=Y.r,Kc=B("DEPTH","DEPTH",1,da.Pi,!0),ea.push(jb),za.fa.push(Kc),r.push(za),Cb.Ki.push(za);m=[];U=[];if(a.mb){var Wa=G();M.s(h,Wa);Na=Ya.Uj;Wa.i.width=Na;Wa.i.height=Na;var Rb=B("DEPTH","u_grass_map_depth",Na,1,!1);Rb.Z=Y.r;Rb.Y=Y.r;var hb=B("COLOR","u_grass_map_color",Na,1,!1);hb.Z=Y.r;hb.Y=Y.r}else hb=Rb=Wa=null;for(var Mb=[],jc=[],Yb=[],wc=[],ca=0;ca<wa.length;ca++){var xa=wa[ca],bb={};p.push(B("DEPTH","DEPTH",1,
1,!0));if(Qa){var Zb=b(xa);c.G.push(Zb);bb=z(Zb,Sa);Yb.push(bb);M.s(h,bb);va.sp()&&bb.fa.push(B("COLOR","COLOR",1,1,!0));if(Ga){for(Aa=0;Aa<sa.length;Aa++)yb=sa[Aa],M.l(h,yb,bb,Xb[Aa]);var Pc=B("COLOR","u_color",1,1,!0),xc=B("DEPTH","u_depth",1,1,!0);if(pb){var C=b(xa);c.G.push(C);var Nb=a.YA,Ia=N(C,Jb,Nb);M.s(h,Ia);var Ta=B("COLOR","u_ssao_mask",1,1,!0);M.l(h,bb,Ia,Pc);M.l(h,bb,Ia,xc);var zb=b(xa);c.G.push(zb);var fa=H(zb,Nb);M.s(h,fa);var kc=B("COLOR","u_shadow_mask",1,1,!0);M.l(h,Ia,fa,Ta);M.l(h,
bb,fa,xc)}}Wa&&(M.l(h,Wa,bb,Rb),M.l(h,Wa,bb,hb))}za=F("OPAQUE",xa,!Qa,$a,na,Jb,Kb,null,a.tg);M.s(h,za);U.push(za);jc.push(za);Qa&&(M.l(h,bb,za,p[ca]),Ta?M.l(h,fa,za,kc):Ga&&M.l(h,bb,za,B("COLOR","u_shadow_mask",1,1,!0)));var kb=B("COLOR","u_color",1,1,!0);S.push(B("COLOR","COLOR",1,1,!0));Wa&&(M.l(h,Wa,za,Rb),M.l(h,Wa,za,hb));if(r.length)for(var cb=r.length/wa.length,Aa=0;Aa<cb;Aa++){var lc=cb*ca+Aa;M.l(h,r[lc],za,ea[lc])}if(ja.length)for(Aa=0;Aa<ja.length;Aa++)M.l(h,ja[Aa],za,ra[Aa])}m=U;U=[];if(!ya&&
a.cw){xa=b(m[0].i);c.G.push(xa);var ta=L(xa,!1);M.s(h,ta);if(a.ve){xa=b(m[0].i);c.G.push(xa);var rb=L(xa,!0);M.s(h,rb);M.l(h,ta,rb,B("COLOR","COLOR",1,1,!0));M.l(h,ta,rb,B("DEPTH","DEPTH",1,1,!0))}}else ta=null;if(ob.fc&&!ya)for(ca=0;ca<wa.length;ca++){var Ab=ka();M.s(h,Ab);M.l(h,m[ca],Ab,kb);q.push(Ab);V.push(B("COLOR","u_refractmap",1,1,!0))}if(a.Cm){for(ca=0;ca<wa.length;ca++)za=l("BLEND",ca),Mb.push(za);m=U;U=[]}if(a.ee){for(ca=0;ca<wa.length;ca++){var ed=b(wa[ca]);c.G.push(ed);var Oa=F("GLOW",
ed,!1,$a,na,Jb,Kb);M.s(h,Oa);M.l(h,jc[ca],Oa,p[ca]);var Ob=A("X_GLOW_BLUR");Ob.Ka="GLOW_MASK_SMALL";Ob.re=a.Me.small_glow_mask_width;var Qc=B("COLOR","u_color",1,1,!0);Qc.Z=Y.r;Qc.Y=Y.r;M.s(h,Ob);M.l(h,Oa,Ob,Qc);var db=A("Y_GLOW_BLUR");db.Ka="GLOW_MASK_SMALL";db.re=a.Me.small_glow_mask_width;var $b=B("COLOR","u_color",1,.5,!0);$b.Z=Y.r;$b.Y=Y.r;M.s(h,db);M.l(h,Ob,db,$b);var ac=A("X_GLOW_BLUR");ac.Ka="GLOW_MASK_LARGE";ac.re=a.Me.large_glow_mask_width;var mc=B("COLOR","u_color",1,.5,!0);mc.Z=Y.r;mc.Y=
Y.r;M.s(h,ac);M.l(h,db,ac,mc);var nc=A("Y_GLOW_BLUR");nc.Ka="GLOW_MASK_LARGE";nc.re=a.Me.large_glow_mask_width;var Rc=B("COLOR","u_color",1,.25,!0);Rc.Z=Y.r;Rc.Y=Y.r;M.s(h,nc);M.l(h,ac,nc,Rc);var Zc=b(wa[ca]);c.G.push(Zc);var bc=I(Zc,a);M.s(h,bc);a.Cm?M.l(h,Mb[ca],bc,B("COLOR","u_src_color",1,1,!0)):M.l(h,jc[ca],bc,B("COLOR","u_src_color",1,1,!0));var $c=B("COLOR","u_glow_mask_small",1,.5,!0);$c.Z=Y.r;$c.Y=Y.r;M.l(h,db,bc,$c);var lb=B("COLOR","u_glow_mask_large",1,.25,!0);lb.Z=Y.r;lb.Y=Y.r;M.l(h,
nc,bc,lb);n.push(bc)}m=n;U=[]}if(!a.Cm){for(ca=0;ca<wa.length;ca++)za=l("BLEND",ca),Mb.push(za);m=U;U=[]}if(a.ve){for(ca=0;ca<wa.length;ca++){var Lc=l("XRAY",ca);wc.push(Lc)}m=U;U=[]}if(da.wireframe_debug){for(ca=0;ca<wa.length;ca++){xa=ua.qa(wa[ca]);c.G.push(xa);var eb=J(xa);U.push(eb);M.s(h,eb);M.l(h,m[ca],eb,S[ca]);M.l(h,m[ca],eb,p[ca]);Wa&&(M.l(h,Wa,eb,Rb),M.l(h,Wa,eb,hb))}m=U;U=[]}if(!ya&&a.Vu){xa=ua.qa(wa[0]);c.G.push(xa);var yc=P(xa);M.s(h,yc);M.l(h,m[0],yc,p[0])}if(Ca&&Qa&&!ya){for(ca=0;ca<
wa.length;ca++){var ib=Da.gh,oc=Da.Jy,Bb=Da.Bh,Ma=m[ca],Db=$a?1:0,zc=B("DEPTH","u_input",1,1,!0);zc.Z=Y.r;zc.Y=Y.r;var Eb=B("COLOR","u_input",1,.25,!0);Eb.Z=Y.r;Eb.Y=Y.r;var Sb=ib/Bb,Ac=b(wa[ca]);c.G.push(Ac);var Hb=qa(Ac,Db,ib,!0,Sb,na,Bb);M.s(h,Hb);M.l(h,Ma,Hb,zc);var Sb=ib/Bb*.5,Ua=b(wa[ca]);c.G.push(Ua);var Pa=qa(Ua,Db,ib,!1,Sb,na,Bb);M.s(h,Pa);M.l(h,Hb,Pa,Eb);var Sb=ib/Bb*.25,Pb=b(wa[ca]);c.G.push(Pb);var Sc=qa(Pb,Db,ib,!1,Sb,na,Bb);M.s(h,Sc);M.l(h,Pa,Sc,Eb);var Qb=w(oc,na);U.push(Qb);M.s(h,
Qb);M.l(h,Ma,Qb,B("COLOR","u_main",1,1,!0));M.l(h,Sc,Qb,B("COLOR","u_god_rays",1,1,!0))}m=U;U=[]}if(tc&&!ya){for(ca=0;ca<wa.length;ca++){var Ma=m[ca],ld=ia();M.s(h,ld);M.l(h,Ma,ld,B("COLOR","u_input",1,1,!0));var Bc=ga();M.s(h,Bc);Bc.i.width=1;Bc.i.height=1;var ad=B("COLOR","u_input",1,.25,!0);ad.Z=Y.r;ad.Y=Y.r;var fd=B("COLOR","u_luminance",1,.25,!0);fd.Z=Y.r;fd.Y=Y.r;M.l(h,ld,Bc,ad);var Tb=vb.key,ud=vb.hx,pd=b(wa[ca]);c.G.push(pd);var Tc=pa(Tb,ud,na,pd);M.s(h,Tc);M.l(h,Ma,Tc,B("COLOR","u_main",
1,1,!0));M.l(h,ld,Tc,fd);M.l(h,Bc,Tc,B("COLOR","u_average_lum",1,1,!1));var cc=B("COLOR","u_color",1,.25,!0);cc.Z=Y.r;cc.Y=Y.r;Ob=k("X_BLUR");M.s(h,Ob);M.l(h,Tc,Ob,cc);db=k("Y_BLUR");M.s(h,db);M.l(h,Ob,db,cc);var fb=T(vb.blur);M.s(h,fb);var Uc=B("COLOR","u_bloom",1,.25,!0);Uc.Z=Y.r;Uc.Y=Y.r;M.l(h,db,fb,Uc);M.l(h,Ma,fb,B("COLOR","u_main",1,1,!0));U.push(fb)}m=U;U=[]}if(uc&&!ya){for(ca=0;ca<m.length;ca++){var qd=m[ca],Vc=aa(ab.mb_decay_threshold,ab.mb_factor);U.push(Vc);M.s(h,Vc);M.l(h,qd,Vc,B("COLOR",
"u_mb_tex_curr",1,1,!0));Vc.fa.push(B("COLOR","u_mb_tex_accum",1,1,!0))}m=U;U=[]}if(wb&&Qa&&!ya){for(ca=0;ca<m.length;ca++){var Ma=m[ca],Cc=b(wa[ca]);c.G.push(Cc);cc=B("COLOR","u_color",1,1,!0);cc.Z=Y.r;cc.Y=Y.r;var pc=A("X_BLUR");M.s(h,pc);M.l(h,Ma,pc,cc);var Dc=A("Y_BLUR");M.s(h,Dc);M.l(h,pc,Dc,cc);var bb=Mb[ca],bd=Z(Cc);Cc.dof_distance=c.dof_distance;Cc.Yd=c.Yd;Cc.dof_front=c.dof_front;Cc.dof_rear=c.dof_rear;Cc.dof_power=c.dof_power;Cc.dof_on=1;U.push(bd);M.s(h,bd);M.l(h,Ma,bd,B("COLOR","u_sharp",
1,1,!0));M.l(h,Dc,bd,B("COLOR","u_blurred",1,1,!0));M.l(h,bb,bd,B("DEPTH","u_depth",1,1,!0))}m=U;U=[]}if(!ya&&a.outline){for(ca=0;ca<wa.length;ca++){var Ma=m[ca],rd=b(wa[ca]);c.G.push(rd);var md=Q(rd);M.s(h,md);var Mc=A("X_EXTEND"),sd=B("COLOR","u_color",1,1,!0),gd=B("COLOR","u_outline_mask",1,1,!0);Mc.vi=!0;M.s(h,Mc);M.l(h,md,Mc,sd);var qc=B("COLOR","u_color",1,.5,!0);qc.Z=Y.r;qc.Y=Y.r;var Ec=A("Y_EXTEND");Ec.vi=!0;M.s(h,Ec);M.l(h,Mc,Ec,qc);pc=A("X_BLUR");pc.vi=!0;M.s(h,pc);M.l(h,Ec,pc,qc);var Fb=
B("COLOR","u_color",1,.25,!0);Fb.Z=Y.r;Fb.Y=Y.r;var Wc=B("COLOR","u_outline_mask_blurred",1,.25,!0);Wc.Z=Y.r;Wc.Y=Y.r;Dc=A("Y_BLUR");Dc.vi=!0;M.s(h,Dc);M.l(h,pc,Dc,Fb);var Xc=ha(gb);M.s(h,Xc);M.l(h,Ma,Xc,B("COLOR","u_outline_src",1,1,!0));M.l(h,md,Xc,gd);M.l(h,Dc,Xc,Wc);U.push(Xc)}m=U;U=[]}if(vc&&!ya){for(ca=0;ca<m.length;ca++){var Ma=m[ca],Ub=X(Ra.brightness,Ra.contrast,Ra.exposure,Ra.saturation);M.s(h,Ub);M.l(h,Ma,Ub,B("COLOR","u_color",1,1,!0));U.push(Ub)}m=U;U=[]}if(Lb){for(ca=0;ca<m.length;ca++)if(Ma=
m[ca],da.smaa){var cd=B("COLOR","u_color",1,1,!0);cd.Z=Y.r;cd.Y=Y.r;var Yc=O("SMAA_EDGE_DETECTION");M.s(h,Yc);M.l(h,Ma,Yc,cd);var Vb=O("SMAA_BLENDING_WEIGHT_CALCULATION");M.s(h,Vb);M.l(h,Yc,Vb,cd);var Fc=B("COLOR","u_search_tex",1,1,!1),hd=B("COLOR","u_area_tex",1,1,!1);Fc.Z=Y.r;Fc.Y=Y.r;hd.Z=Y.r;hd.Y=Y.r;Vb.fa.push(Fc);Vb.fa.push(hd);var oa=O("SMAA_NEIGHBORHOOD_BLENDING");M.s(h,oa);M.l(h,Ma,oa,cd);var Va=B("COLOR","u_blend",1,1,!0);Va.Z=Y.r;Va.Y=Y.r;M.l(h,Vb,oa,Va);U.push(oa)}else{var jd=K();M.s(h,
jd);var rc=B("COLOR","u_color",1,1,!0);rc.Z=Y.r;rc.Y=Y.r;M.l(h,Ma,jd,rc);if(1<da.render_resolution_factor){var Ka=A("NONE");M.s(h,Ka);M.l(h,jd,Ka,rc);U.push(Ka)}else U.push(jd)}m=U;U=[]}if(a.anaglyph_use&&!ya){var Xa=W();M.s(h,Xa);M.l(h,m[0],Xa,B("COLOR","u_sampler_left",1,1,!0));M.l(h,m[1],Xa,B("COLOR","u_sampler_right",1,1,!0));U.push(Xa)}else U.push(m[0]);var vd=M.cg(h,m[0]),mb=!1;M.te(h,vd,function(a,b,c){if(c.M==c.la)return mb=!0});if(mb){var dc=ma();M.s(h,dc);M.l(h,m[0],dc,B("COLOR","u_color",
1,1,!0));m=U;U=[];U.push(dc)}ta&&(rb?U.push(rb):U.push(ta));yc&&U.push(yc);if(!ya&&a.Lk.procedural_skydome){var Nc=ba(na,a.Lk);M.s(h,Nc);U.push(Nc)}var Wb=R();M.s(h,Wb);for(ca=0;ca<U.length;ca++){var ec=U[ca];switch(ec.type){case "COLOR_PICKING":case "COLOR_PICKING_XRAY":M.l(h,ec,Wb,B("COLOR","NONE",1,1,!0));M.l(h,ec,Wb,B("DEPTH","NONE",1,1,!0));break;case "SKY":M.l(h,ec,Wb,B("CUBEMAP","u_sky",Ya.Fe,1,!1));break;case "ANCHOR_VISIBILITY":M.l(h,ec,Wb,B("COLOR","NONE",1,1,!0));break;default:if(ya){var dd=
e[0].d,fc=B("COLOR","OFFSCREEN",1,1,!0);fc.ta=dd;M.l(h,U[ca],Wb,fc);for(Aa=1;Aa<e.length;Aa++){var td=e[Aa].d,dc=ma();M.s(h,dc);M.l(h,U[ca],dc,B("COLOR","u_color",1,1,!0));fc=B("COLOR","OFFSCREEN",1,td.rg/dd.rg,!0);fc.ta=td;M.l(h,dc,Wb,fc)}}else M.l(h,U[ca],Wb,B("SCREEN","NONE",1,1,!0))}}if(sb.enabled){var nd=v(h);nd&&E(h,nd)}d(h,Qa);1<da.render_resolution_factor&&f(h);g(h);y(h);if(Ga){for(ca=0;ca<Yb.length;ca++)t(h,Yb[ca]);for(ca=0;ca<Mb.length;ca++)t(h,Mb[ca]);for(ca=0;ca<wc.length;ca++)t(h,wc[ca])}return h};
a.aE=u;a.zc=function(a,b,c){var d=a.re;a.Zn[0]=b*a.w[0]*d;a.Zn[1]=c*a.w[1]*d};a.Nb=function(a,b){a.re=b};a.wD=function(a){var b=null;M.O(a,function(a,c){return c.i&&null===c.i.be?(b=c,!0):!1});return b};a.Ga=function(a,b,c){a=ra(a,b);for(b=0;b<a.length;b++)if(a[b].type===c)return a[b];return null};a.SD=V;a.UD=ja;a.uq=ra;a.OD=sa;a.Ba=function(a,b){var c=null;M.O(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.Sw=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',
b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=S(a);M.O(a,function(a,d){var e=b+="    ",f="",f=d.type.replace(/_/g," ");"POSTPROCESSING"==d.type&&(f+=" ("+d.yk.replace(/_/g," ")+")");if(d.i){for(var f=f+"\\n",g=0;g<c.length;g+=2)c[g]==d.i.eb&&(f+="C"+c[g+1]+" ");for(g=0;g<c.length;g+=2)c[g]==d.i.Lc&&(f+="D"+c[g+1])}d.fa.length&&(f+="\\n-----\\n");for(g=0;g<d.fa.length;g++)f+=ea(d.fa[g],c);g="SINK"==d.type?"dotted":d.enqueue?"solid":"dashed";b=e+(String(a)+
' [label="'+f+'" color="black" style="'+(g+",bold")+'"];\n')});M.se(a,function(a,d,e){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+ea(e,c)+'" style="'+(e.Ma?"solid":"dotted")+'"];\n'});return b+="}"};a.Ew=function(a){a=M.nB(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.enqueue&&b.push(d)}return b}};b4w.module.__textures=function(a,q){function b(){return{name:"",type:0,source:"",Nn:"",width:0,height:0,Ol:1,qj:!0,rg:1024,Vp:!1,Rd:null,La:null,qh:null,os:1,ne:0,rh:!1,Yk:!1,Tf:!1,I:0,ra:0,Ug:0,SB:!1,vg:!1,kn:0,ac:0,Ob:0,Va:null,nf:null}}function d(d,e,f,g){var h=d.type,l=new Uint8Array([204,204,204,255]),m=b();switch(h){case "DATA_TEX2D":case "IMAGE":var n=k.createTexture(),p=k.TEXTURE_2D;k.bindTexture(p,n);k.texImage2D(p,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,l);d.image&&"MOVIE"==d.image.source&&
(m.Tf=!0,m.I=d.frame_start,m.ra=d.frame_offset,m.Ug=d.frame_duration,m.SB=d.use_auto_refresh,m.vg=d.use_cyclic,m.kn=d.movie_length,0!=m.ra&&y.warn('Frame offset for texture "'+d.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));break;case "NONE":n=k.createTexture();p=k.TEXTURE_2D;k.bindTexture(p,n);if("NONE"==d.b4w_source_type)return null;if("SCENE"==d.b4w_source_type)if(d.b4w_source_id&&(f=x.keysearch("name",d.b4w_source_id,f)))m.rg=d.b4w_source_size,f.jd=f.jd||
[],f.jd.push(d),k.texImage2D(p,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,l);else return null;break;case "ENVIRONMENT_MAP":n=k.createTexture();p=k.TEXTURE_CUBE_MAP;k.bindTexture(p,n);f="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var r=0;6>r;r++)u.Om?k.texImage2D(k["TEXTURE_CUBE_MAP_"+f[r]],0,k.RGB,1,1,0,k.RGB,k.UNSIGNED_BYTE,l):k.texImage2D(k["TEXTURE_CUBE_MAP_"+f[r]],0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,l);break;case "VORONOI":case "BLEND":return null;default:return y.error('texture "'+
d.name+'" has unsupported type "'+h+'"'),null}("NONE"!=h||d.b4w_enable_canvas_mipmapping&&"CANVAS"==d.b4w_source_type)&&"DATA_TEX2D"!=h?u.Om&&"ENVIRONMENT_MAP"==h?k.texParameteri(p,k.TEXTURE_MIN_FILTER,k.LINEAR):k.texParameteri(p,k.TEXTURE_MIN_FILTER,I[u.Ok]):k.texParameteri(p,k.TEXTURE_MIN_FILTER,k.LINEAR);k.texParameteri(p,k.TEXTURE_MAG_FILTER,k.LINEAR);l=p;f=d.b4w_anisotropic_filtering;"DEFAULT"===f&&(f=e);"OFF"!==f&&u.rj&&(e=E.Vx())&&(f=parseFloat(f.split("x")[0]),k.texParameterf(l,e.TEXTURE_MAX_ANISOTROPY_EXT,
f));"REPEAT"!=d.extension||d.b4w_shore_dist_map?(k.texParameteri(p,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE),k.texParameteri(p,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE)):(k.texParameteri(p,k.TEXTURE_WRAP_S,k.REPEAT),k.texParameteri(p,k.TEXTURE_WRAP_T,k.REPEAT));m.type=a.Dg;m.width=1;m.height=1;m.Va=n;m.Ob=p;"CANVAS"==d.b4w_source_type&&"NONE"==h?(h=d.b4w_source_id,n=d.b4w_source_size,m.Vp=d.b4w_enable_canvas_mipmapping,m.Nn=h,m.source="CANVAS",p=document.createElement("canvas"),p.width=n,p.height=n,m.Rd=p.getContext("2d"),
g in G||(G[g]={}),G[g][h]=m,c(m)):"SCENE"==d.b4w_source_type&&"NONE"==h?(m.Nn=d.b4w_source_id,m.source="SCENE"):(m.source=h,k.generateMipmap(p),k.bindTexture(p,null));m.name=d.name;return d.d=m}function c(a){if("CANVAS"!=a.source)throw"Wrong texture";var b=a.Ob;k.bindTexture(b,a.Va);var c=h(a),d=p(a),e=a.Rd.canvas;k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!0);k.texImage2D(b,0,c,c,d,e);k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!1);a.Vp&&k.generateMipmap(b);k.bindTexture(b,null);a.width=e.width;a.height=e.height}
function e(a){var b=a.Ob;k.bindTexture(b,a.Va);k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!0);k.texImage2D(b,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,a.qh[a.ne]);k.bindTexture(b,null)}function g(a){k.texParameteri(a,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(a,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);k.texParameteri(a,k.TEXTURE_MAG_FILTER,k.LINEAR);k.texParameteri(a,k.TEXTURE_MIN_FILTER,k.LINEAR)}function f(a,b){var c=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384];return-1==c.indexOf(a)||-1==c.indexOf(b)}
function h(b){switch(b.type){case a.Dg:b=k.RGBA;break;case a.cl:b=k.RGB;break;case a.lj:b=k.RGBA;break;case a.mj:b=k.RGB;break;case a.Qh:b=k.DEPTH_COMPONENT;break;default:throw"Wrong texture type";}return b}function p(b){switch(b.type){case a.Dg:b=k.UNSIGNED_BYTE;break;case a.cl:b=k.UNSIGNED_BYTE;break;case a.lj:b=k.FLOAT;break;case a.mj:b=k.FLOAT;break;case a.Qh:b=k.UNSIGNED_INT;break;default:throw"Wrong texture type";}return b}function l(a,b){return b in A&&a in A[b]?(u.Sc?A[b][a].rh=!0:A[b][a].La.play(),
!0):null}function m(a,b){if(b in A&&a in A[b]){var c=A[b][a];u.Sc?(c.ne=c.ra,e(c),c.ne++):c.La.currentTime=c.ra/c.ac;return!0}return null}function r(a,b){return b in A&&a in A[b]?(u.Sc?A[b][a].rh=!1:A[b][a].La.pause(),!0):null}var n=q("__config"),y=q("__print"),v=q("__dds"),E=q("__extensions"),x=q("__util"),u=n.o,B=n.Nd,t=n.cd;a.Id=0;a.r=0;a.Lu=0;a.Ju=0;a.Ku=0;a.Iu=0;a.Dg=10;a.cl=20;a.lj=30;a.mj=40;a.Qh=50;a.Cg=60;var G={},A={},k=null,I;a.bd=function(b){I=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,
b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.Id=b.NEAREST;a.r=b.LINEAR;a.Lu=b.NEAREST_MIPMAP_NEAREST;a.Ju=b.LINEAR_MIPMAP_NEAREST;a.Ku=b.NEAREST_MIPMAP_LINEAR;a.Iu=b.LINEAR_MIPMAP_LINEAR;k=b};a.Zx=function(a,b){return b in G&&a in G[b]?G[b][a].Rd:null};a.DB=function(a,b){return b in G&&a in G[b]?(c(G[b][a]),!0):!1};a.Jj=function(c,d){var e=b();e.name=c;e.type=d;e.source="NONE";if(d==a.Cg)e.nf=k.createRenderbuffer();else{var f=k.TEXTURE_2D,g=k.createTexture();k.bindTexture(f,g);k.texParameteri(f,
k.TEXTURE_MAG_FILTER,k.LINEAR);k.texParameteri(f,k.TEXTURE_MIN_FILTER,k.LINEAR);k.texParameteri(f,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(f,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);k.bindTexture(f,null);e.Ob=f;e.Va=g}return e};a.sw=function(c){var d=k.createTexture(),e=k.TEXTURE_CUBE_MAP;k.bindTexture(e,d);k.texParameteri(e,k.TEXTURE_MAG_FILTER,k.LINEAR);k.texParameteri(e,k.TEXTURE_MIN_FILTER,k.LINEAR);k.texParameteri(e,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(e,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);
for(var f="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),g=0;6>g;g++)k.texImage2D(k[f[g]],0,k.RGBA,c,c,0,k.RGBA,k.UNSIGNED_BYTE,null);k.bindTexture(e,null);e=b();e.name="CUBEMAP";e.type=a.Dg;e.source="NONE";e.width=3*c;e.height=2*c;e.Ol=1;e.Va=d;e.Ob=k.TEXTURE_CUBE_MAP;return e};a.Gn=function(b,c,d){if(b.type!=a.Cg){var e=b.Ob;k.bindTexture(e,b.Va);c&&k.texParameteri(e,
k.TEXTURE_MIN_FILTER,c);d&&k.texParameteri(e,k.TEXTURE_MAG_FILTER,d);k.bindTexture(e,null)}};a.ND=function(b){if(b.type==a.Cg)return{min:a.Id,bz:a.Id};var c=b.Ob;k.bindTexture(c,b.Va);b=k.getTexParameter(c,k.TEXTURE_MIN_FILTER);var d=k.getTexParameter(c,k.TEXTURE_MAG_FILTER);k.bindTexture(c,null);return{min:b,bz:d}};a.resize=function(b,c,d){c=Math.max(c,1);d=Math.max(d,1);if(b.width!=c||b.height!=d){if(b.type==a.Cg)k.bindRenderbuffer(k.RENDERBUFFER,b.nf),k.renderbufferStorage(k.RENDERBUFFER,k.DEPTH_COMPONENT16,
c,d),k.bindRenderbuffer(k.RENDERBUFFER,null);else{var e=b.Ob;k.bindTexture(e,b.Va);var f=h(b),g=p(b);k.texImage2D(e,0,f,c,d,0,f,g,null);k.bindTexture(e,null)}c>u.Kb||d>u.Kb?y.error('Slink texture "'+b.name+'" has unsupported size: '+c+"x"+d+". Max available: "+u.Kb+"x"+u.Kb+"."):(b.width=c,b.height=d)}};a.Mw=d;a.PB=function(a){var b=a.Ob;k.bindTexture(b,a.Va);k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!0);4!=a.La.length?k.texImage2D(b,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,a.La):k.texImage2D(b,0,k.RGBA,1,1,0,k.RGBA,
k.UNSIGNED_BYTE,a.La);k.bindTexture(b,null)};a.MB=e;a.Zi=function(a,b,c,d,e){var h=a.source,l=a.Ob;k.bindTexture(l,a.Va);if(4==b.length){var m=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==h)if(m)k.texImage2D(l,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(c){c=v.Bq(b);if(c.width>u.Kb||c.height>u.Kb){y.error('Texture "'+d+'" has unsupported size: '+c.width+"x"+c.height+". Max available: "+u.Kb+"x"+u.Kb+".");return}v.RB(k,E.yq(),b,!0);f(c.width,c.height)&&
(a.ap||y.warn("using NPOT texture",d),g(l));a.width=c.width;a.height=c.height;a.Ol=v.ay(b)}else{k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!0);if(b.width>u.Kb||b.height>u.Kb){y.error('Texture "'+d+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+u.Kb+"x"+u.Kb+".");return}a.Tf?u.Sc?b&&(e in A||(A[e]={}),A[e][a.name]=a,a.qh=b,a.ac=a.kn/b.length,a.Ug=Math.round(a.Ug/a.ac),a.ra=Math.round(a.ra/a.ac),a.I=Math.round(a.I/a.ac),a.ne=a.ra,k.texImage2D(l,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,a.qh[0])):
(a.La=b,a.La.loop=a.vg,b&&(e in A||(A[e]={}),A[e][a.name]=a),a.ac=B.Ha,b.duration&&(a.ac=a.kn/b.duration),t.Sp||(b.playbackRate=B.Ha/a.ac,t.wp&&2<b.playbackRate&&(b.playbackRate=2)),k.texImage2D(l,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,a.La)):k.texImage2D(l,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,b);a.Tf?u.Sc?(a.width=b[0].width,a.height=b[0].height):(a.width=b.videoWidth,a.height=b.videoHeight):(a.width=b.width,a.height=b.height);f(a.width,a.height)?(a.ap||(a.Tf?y.warn("using NPOT video texture",d):y.warn("using NPOT texture",
d)),g(l)):a.Tf||k.generateMipmap(l)}else if("ENVIRONMENT_MAP"==h)if(c=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],m){for(m=0;6>m;m++)e=c[m],k.texImage2D(k["TEXTURE_CUBE_MAP_"+e[0]],0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!1);h=b.width/3;if(h>u.Bi||h>u.Bi){y.error('Cubemap texture "'+d+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*u.Bi+"x"+2*
u.Bi+".");return}for(m=0;6>m;m++){e=c[m];var n=document.createElement("canvas");n.width=h;n.height=h;var p=n.getContext("2d");"POSITIVE_Y"==e[0]||"NEGATIVE_Y"==e[0]?(p.translate(0,h),p.scale(1,-1)):(p.translate(h,0),p.scale(-1,1));p.drawImage(b,e[1]*h,e[2]*h,h,h,0,0,h,h);k.texImage2D(k["TEXTURE_CUBE_MAP_"+e[0]],0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,n)}a.width=3*h;a.height=2*h;f(b.width/3,b.height/2)?(y.warn("using NPOT cube map texture",d),g(l)):k.generateMipmap(l)}else"DATA_TEX2D"==h&&(k.texImage2D(l,
0,k.RGBA,b.width,b.height,0,k.RGBA,k.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);k.bindTexture(l,null)};a.ax=function(a){k.deleteTexture(a)};a.xi=function(a){return a&&a.name&&(a.Va||a.nf)?!0:!1};a.Xq=function(a){return a&&a.name&&a.nf?!0:!1};a.fE=function(b){return b.type==a.lj||b.type==a.mj?!0:!1};a.qy=function(b){var c=0;switch(b.type){case a.Dg:case a.cl:c=4;break;case a.lj:case a.mj:c=16;break;case a.Qh:c=3;break;case a.Cg:c=2}return c};a.Rx=function(a){var b=null,b={name:"special_ssao_texture",
type:"DATA_TEX2D",extension:"REPEAT",b4w_anisotropic_filtering:"OFF"};d(b,null,a,0);b.image={filepath:null};return b};a.cleanup=function(){if(!u.Sc)for(var a in A)for(var b in A[a])A[a][b].La.pause(),A[a][b].La.src="",A[a][b].La.load();G={};A={}};a.play_video=l;a.reset_video=m;a.pause_video=r;a.pause=function(){for(var a in A)for(var b in A[a])u.Sc&&!A[a][b].rh||!u.Sc&&A[a][b].La.paused||(r(b,a),A[a][b].Yk=!0)};a.reset=function(){for(var a in A)for(var b in A[a])m(b,a),A[a][b].Yk=!1};a.play=function(a){for(var b in A)for(var c in A[b])if(!a||
A[b][c].Yk)l(c,b),A[b][c].Yk=!1}};b4w.module.__assets=function(a,q){function b(){return v.Ly()?q(v.Tb.Aj).data:null}function d(){var a={nj:null,Su:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.nj=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var c=b();c&&a.nj in c&&(a.status=200,c[a.nj]&&(a.response=a.Su(c[a.nj])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function c(b){for(var c=0,d=0;d<b.length;d++){var k=b[d];20===k.state&&c++;if(c>=G.gz)break;if(10===k.state)switch(k.state=20,c++,k.type){case a.AT_ARRAYBUFFER:e(k,"arraybuffer");break;case a.AT_JSON:e(k,"json");break;case a.AT_TEXT:e(k,"text");break;case a.AT_AUDIOBUFFER:g(k);break;case a.AT_IMAGE_ELEMENT:f(k);
break;case a.AT_AUDIO_ELEMENT:h(k);break;case a.hj:p(k);break;case a.gj:l(k);break;default:u.pa("Wrong asset type: "+k.type)}}}function e(a,c){var e=b(),f=e&&a.q in e?new d:new XMLHttpRequest;f.open("GET",a.q,!0);"text"==c?(f.overrideMimeType("text/plain"),f.responseType="text"):"json"==c?(f.overrideMimeType("application/json"),f.responseType="text"):f.responseType=c;f.onreadystatechange=function(){if(40!=a.state&&4==f.readyState){if(200==f.status||0==f.status){var b=f.response;if(b){if("json"==c&&
"string"==typeof b)try{b=JSON.parse(b)}catch(d){a.jb(null,a.uri,a.type,a.q,a.ob);E.error(d+" (parsing JSON "+a.q+")");return}a.jb(b,a.uri,a.type,a.q,a.ob)}else a.jb(null,a.uri,a.type,a.q,a.ob),E.error("empty responce when trying to get "+a.q)}else a.jb(null,a.uri,a.type,a.q,a.ob),E.error(f.status+" when trying to get "+a.q);a.state=30}};f.addEventListener("progress",function(b){b.lengthComputable&&a.$r(b.loaded/b.total)},!1);f.send(null)}function g(a){var c=b(),e=c&&a.q in c?new d:new XMLHttpRequest;
e.open("GET",a.q,!0);e.responseType="arraybuffer";e.onreadystatechange=function(){if(40!=a.state&&4==e.readyState)if(200==e.status||0==e.status){var b=e.response;b?x.Ww(b,function(b){a.jb(b,a.uri,a.type,a.q,a.ob);a.state=30},function(){a.jb(null,a.uri,a.type,a.q,a.ob);E.error("failed to decode "+a.q);a.state=30}):(a.jb(null,a.uri,a.type,a.q,a.ob),E.error("empty responce when trying to get "+a.q),a.state=30)}else a.jb(null,a.uri,a.type,a.q,a.ob),E.error(e.status+" when trying to get "+a.q),a.state=
30};e.send(null)}function f(a){var c=document.createElement("img");A.allow_cors&&(c.crossOrigin="Anonymous");c.onload=function(){40!=a.state&&(a.jb(c,a.uri,a.type,a.q,a.ob),a.state=30)};c.addEventListener("error",function(){40!=a.state&&(a.jb(null,a.uri,a.type,a.q,a.ob),E.error("could not load image: "+a.q),a.state=30)},!1);var d=b();if(d&&a.q in d)if(d[a.q]){var e=r(a.q);c.src="data:"+e+";base64,"+d[a.q]}else t.Qm()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=
new CustomEvent("error"),c.dispatchEvent(d);else c.src=a.q}function h(a){var c=document.createElement("audio");A.allow_cors&&(c.crossOrigin="Anonymous");c.addEventListener("loadeddata",function(){40!=a.state&&(a.jb(c,a.uri,a.type,a.q,a.ob),a.state=30)},!1);c.addEventListener("error",function(){40!=a.state&&(a.jb(null,a.uri,a.type,a.q,a.ob),E.error("could not load sound: "+a.q),a.state=30)},!1);var d=b();if(d&&a.q in d)if(d[a.q]){var e=n(a.q);c.src="data:"+e+";base64,"+d[a.q];40!=a.state&&(a.jb(c,
a.uri,a.type,a.q,a.ob),a.state=30)}else t.Qm()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),c.dispatchEvent(d);else c.src=a.q,A.Sf&&c.load();setTimeout(function(){c.KA=1},5E3)}function p(a){function c(){40!=a.state&&(a.jb(null,a.uri,a.type,a.q),E.error("could not load video: "+a.q,a.ob),a.state=30)}var d=document.createElement("video");d.muted=!0;if(A.allow_cors||A.Sf)d.crossOrigin="Anonymous";d.addEventListener("loadeddata",function(){d.removeEventListener("error",
c,!1);40!=a.state&&(a.jb(d,a.uri,a.type,a.q,a.ob),a.state=30)},!1);d.addEventListener("error",c,!1);var e=b();if(e&&a.q in e)if(e[a.q]){var f=y(a.q);d.src="data:"+f+";base64,"+e[a.q];40!=a.state&&d.addEventListener("loadeddata",function(){a.jb(d,a.uri,a.type,a.q,a.ob);a.state=30},!1)}else t.Qm()?(e=document.createEvent("CustomEvent"),e.initCustomEvent("error",!1,!1,null)):e=new CustomEvent("error"),d.dispatchEvent(e);else d.src=a.q,A.Sf&&d.load();setTimeout(function(){d.KA=1},1E4)}function l(a){function c(b){a.jb(b,
a.uri,a.type,a.q,a.ob)}var e=b(),f=e&&a.q in e?new d:new XMLHttpRequest;f.open("GET",a.q,!0);f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=a.state&&4==f.readyState){if(200==f.status||0==f.status){var b=f.response;b?m(b,c):(a.jb(null,a.uri,a.type,a.q,a.ob),E.error("empty responce when trying to get "+a.q))}else a.jb(null,a.uri,a.type,a.q,a.ob),E.error(f.status+" when trying to get "+a.q);a.state=30}};f.addEventListener("progress",function(b){b.lengthComputable&&a.$r(b.loaded/
b.total)},!1);f.send(null)}function m(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],gp:[],ac:c[4]},g=20,h=0;h<e;h++){var l=c[g/4],k=new Blob([d.subarray(g+4,g+4+l)],{type:"image/jpg"}),m=document.createElement("img");m.src=window.URL.createObjectURL(k);f.images.push(m);f.gp.push(k);g+=l+8-l%4}m.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.gp;b(f)}}function r(a){var b="image";switch(u.ym(a).toLowerCase()){case "jpeg":case "jpg":b+=
"/jpeg";break;case "png":b+="/png"}return b}function n(a){var b="audio";switch(u.ym(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function y(a){var b="video";switch(u.ym(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var v=q("__config"),E=q("__print"),x=q("__sfx"),u=q("__util"),B=q("__version"),t=q("__compat"),G=v.Od,A=v.o;a.AT_ARRAYBUFFER=
10;a.AT_JSON=20;a.AT_TEXT=30;a.AT_AUDIOBUFFER=40;a.AT_IMAGE_ELEMENT=50;a.AT_AUDIO_ELEMENT=60;a.hj=70;a.gj=80;var k=[],I=0,F={};a.Wi=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.py=function(a){if(F[a])return F[a];var b=G.Yr?a+B.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return F[a]=b;u.pa("Error XHR: responce is empty, GET "+
a)}else u.pa("Error XHR: "+c.status+", GET "+a)};a.cleanup=function(){for(var a=0;a<k.length;a++)k[a].state=40;k=[];I=0;F={}};a.enqueue=function(a,d,e,f){for(var g=0;g<a.length;g++){var h=a[g],h={uri:h[0],type:h[1],q:h[2],ob:h[3],state:10,jb:d||function(){},Sr:e||function(){},$r:f||function(){},Tr:I};if(G.Yr){var l=b();l&&h.q in l||(h.q+=B.timestamp())}k.push(h)}c(k);I++};a.update=function(){c(k);for(var a=k,b=0,d=!0,e=0;e<a.length;e++){var f=a[e];f.Tr===a[b].Tr?30!==f.state&&(d=!1):(d&&(a[e-1].Sr(),
d=e-b,a.splice(b,d),e-=d),b=e,d=30===a[e].state?!0:!1);e===a.length-1&&d&&(a[e].Sr(),a.splice(b))}}};b4w.module.__loader=function(a,q){function b(b,c,e,f){var g=u,h=v.create(),l;for(l in c){var m=d(c[l]);(f&&m.gb||!b&&m.yb)&&r(m);v.s(h,m)}for(l in c)for(m=c[l],m.name=l,b=0;b<m.J.length;b++)v.l(h,c[m.J[b]],m,null);c=d({name:"out",Ta:a.yt,cb:function(a,b,c,d,e){0===b.id&&(g.Rn=!0);y(b)||(b.status=2);b.lr(b.id,!0);e(b,c);E.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},ib:5});var n=[];if(e)for(e=v.Aq(h),b=0;b<e.length;b++)n.push(v.Ya(h,e[b]));else v.O(h,function(a,b){b.ab||n.push(b)});v.s(h,
c);for(b=0;b<n.length;b++)c.J.push(n[b].name),v.l(h,n[b],c,null);return h}function d(a){a.ab=a.ab||!1;a.Ta||0===a.Ta||(a.Ta=a.hd);a.J=a.J||[];a.ui=a.ui||!1;a.Jn=a.Jn||!1;a.ib=a.ib||0;a.gb=a.gb||!1;a.yb=a.yb||!1;a.status=0;a.pE=0;a.bn=0;a.Cf=a.Cf||null;return a}function c(a,b){for(var c=[],d=[],e=0;e<b.length;e++){var f=b[e];v.Ya(a.zd,f).ui&&(v.kf(a.zd,f,function(d){var e=!0;v.te(a.zd,d,function(a,b){if(!b.ui)return e=!1,1});e&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(e))}for(e=d.length-
1;0<=e;e--)b.splice(d[e],1);return c}function e(a){function b(c,d){var e=v.Ya(a.zd,c),f=v.Ya(a.zd,d),g=f.Ta-e.Ta;0==g&&(g=e.ab-f.ab);return g}var d=[],e=a.qe,f=!1;do{var g=c(a,e);d.push.apply(d,e);0<g.length&&(f=!0);e=g}while(0<g.length);f&&d.sort(b);a.qe=d;return a.qe.length}function g(a,b,c){if(b.Jn)return b.ui=!0,h(a,b),!1;if(!b.cb&&!b.Bf&&!b.Zh)return h(a,b),!1;if(0==b.status&&(b.status++,b.cb))return b.cb(c,a,b,b.Cf,h,p),!0;if(1==b.status){if(b.Bf)return b.Bf(c,a,b,b.Cf,h,p),!0;b.status++}return 2==
b.status&&(b.status++,b.Zh)?(b.Zh(c,a,b,b.Cf,h,p),!0):!1}function f(a){if(0==a.Mk)return 100;var b=0;v.O(a.zd,function(c,d){a.do_not_load_resources&&d.gb||(b+=d.bn*d.ib)});return x.trunc(100*b/a.Mk)}function h(a,b){b.ui=!0;b.status=3;l(a,b,1)}function p(a,b,c){1>c?l(a,b,c):b.status++}function l(a,b,c){var d=u;if(b.cb||b.Bf||b.Zh)if(b.bn=c,b=f(a),a.Lp!=b||1==c)a.Qn(b,performance.now()-a.Xs),a.Lp=b,d.dn=!0}function m(a,b){var c=null;v.O(a.zd,function(a,d){if(d.name==b)return c=d,1});return c}function r(a){a.Jn=
!0;a.bn=1}function n(a){a.Qn=null;a.Nl=null;a.zd=null;a.qe=null}function y(a){return a&&(3==a.status||4==a.status)}var v=q("__graph"),E=q("__print"),x=q("__util");a.hd=0;a.xe=1;a.yt=2;var u=null;a.zq=function(){return u};a.Fw=function(){var a={Cd:[],Xl:0,pj:0,Rn:!1,dn:!1};return u=a};a.Nw=function(a,c,d,e,f,g,h,l){var m=u,n={id:m.Cd.length,status:0,q:c,dp:"",lr:d||function(){},an:l||!1,SE:g,Xs:0,Lp:0,Mk:0,En:!1,Qn:e||function(){},Nl:f||function(){},zd:null,qe:null,Jm:!1,Im:!1,Mm:!1};a=b(0===n.id,
a,g,h);n.zd=a;c=[];d=v.ny(a);for(e=0;e<d.length;e++)c.push(d[e]);n.qe=c;v.O(a,function(a,b){!(b.cb||b.Bf||b.Zh)||n.do_not_load_resources&&b.gb||(n.Mk+=b.ib)});m.Cd.push(n);m.pj++;return n.id};a.LB=function(b){var c=u;if(c&&0!=u.pj)if(c.dn)c.dn=!1;else{var d=performance.now();do{var f=c.Cd[c.Xl],h=b[f.id];if(!y(f))if(0==f.status&&(f.status=1,f.Xs=performance.now(),f.Qn(0,0)),e(f)){var l=f,m=l.qe.length;do{var p=v.Ya(l.zd,l.qe[0]),r=g(l,p,h);p.Ta==a.xe&&(l.En=!0);p=l.qe.shift();l.qe.push(p);m--}while(!r&&
0!=m)}else l=c,m=f,m.Nl(h,m),m.status=3,l.pj--,n(m);c.Rn&&(c.Xl=(c.Xl+1)%c.Cd.length);if(f.En){f.En=!1;break}}while(16>performance.now()-d)}};a.Lo=function(a){var b=u;a.Nl(null,a);a.status=3;b.pj--;n(a);a.status=4;0===a.id&&(b.Rn=!0);a.lr(a.id,!1)};a.KE=p;a.xs=function(a,b){var c=m(a,b);null!==c&&r(c)};a.mB=y;a.is_primary_loaded=function(a){var b=u;if(!b)return!1;a|=0;return b.Cd[a]&&(3==b.Cd[a].status||2==b.Cd[a].status)};a.cleanup=function(){u=null}};b4w.module.__nla=function(a,q){function b(){return{type:"CLIP",I:0,U:0,me:!1,paused:!1,uf:"",Vh:"",Ib:0,Th:0,Sh:0,Yp:0,Xp:0,Ch:!1,jt:!1,scale:1,repeat:1}}function d(a,b){if(a.animation_data){var c=a.animation_data.nla_tracks;if(c)for(var e=0;e<c.length;e++)b.push(c[e])}c=a.nodes;for(e=0;e<c.length;e++){var f=c[e];f.node_group&&(f=f.node_group.node_tree)&&d(f,b)}}function c(a,b){for(var c=a.b4w_nla_script,d=b.Ye,e=0;e<c.length;e++){var f=c[e];switch(f.type){case "PLAY":d.push({type:"PLAY",I:f.frame_range[0],
U:f.frame_range[1],Pe:!1});break;case "SELECT":case "SELECT_PLAY":var g=B.rd(B.sf,f.object,0),h=B.my(a),l=h.indexOf(g);if(-1==l){u.error("NLA script error: non-selectable object");return}for(var f={type:f.type,Cs:"SELECT"==f.type?f.target_slot:e+1,IA:e+1,Ze:-1,gA:h.length,fA:l,I:f.frame_range[0],U:f.frame_range[1],Pe:!1},l=[],k=0;k<h.length;k++)l.push(E.create_selection_sensor(h[k],!0));E.create_sensor_manifold(g,"NLA_SELECT_"+e,E.CT_SHOT,l,E.Xw,function(a,c,d,e){if(!(b.Cb>=b.Ye.length)&&(d=b.Ye[b.Cb],
"SELECT"==d.type||"SELECT_PLAY"==d.type&&!d.Pe)){for(d=0;d<e.gA;d++)if(E.get_sensor_value(a,c,d)&&d==e.fA){e.Ze=1;return}e.Ze=0}},f);d.push(f);break;case "JUMP":d.push({type:"JUMP",Ln:f.target_slot});break;case "CONDJUMP":d.push({type:"CONDJUMP",Ln:f.target_slot,fw:f.condition,Qi:f.register1,Ri:f.register2,on:f.number1,pn:f.number2});break;case "REGSTORE":d.push({type:"REGSTORE",Mz:f.registerd,sz:f.number1});break;case "MATH":d.push({type:"MATH",uz:f.operation,Qi:f.register1,Ri:f.register2,on:f.number1,
pn:f.number2,oh:f.registerd});break;case "SHOW":case "HIDE":g=B.rd(B.sf,f.object,0);d.push({type:f.type,obj:g});break;case "REDIRECT":d.push({type:"REDIRECT",url:f.url});break;case "PAGEPARAM":d.push({type:"PAGEPARAM",wz:f.param_name,oh:f.registerd});break;case "NOOP":d.push({type:"NOOP"})}}}function e(a,b,c,d){if(a.Ye.length){if(a.Cb>=a.Ye.length)if(a.cyclic)a.Cb=0;else{a.ra-=k.Ha*c;return}var h=f(a,b,!1,d),l=a.Ye[a.Cb];switch(l.type){case "PLAY":l.Pe?h>=l.U&&(l.Pe=!1,a.Cb++,e(a,b,c,d)):(a.ra+=l.I-
h,l.Pe=!0,g(a,l));break;case "SELECT":case "SELECT_PLAY":-1<l.Ze?"SELECT"==l.type||"SELECT_PLAY"==l.type&&0==l.Ze?(a.Cb=l.Ze?l.Cs:l.IA,l.Ze=-1,e(a,b,c,d)):l.Pe?h>=l.U&&(l.Pe=!1,a.Cb=l.Cs,l.Ze=-1,e(a,b,c,d)):(a.ra+=l.I-h,l.Pe=!0,g(a,l)):a.ra-=k.Ha*c;break;case "JUMP":a.Cb=l.Ln;e(a,b,c,d);break;case "CONDJUMP":var h=-1==l.Qi?l.on:a.ud[l.Qi],m=-1==l.Ri?l.pn:a.ud[l.Ri],n=!1;switch(l.fw){case "EQUAL":h==m&&(n=!0);break;case "NOTEQUAL":h!=m&&(n=!0);break;case "LESS":h<m&&(n=!0);break;case "GREATER":h>m&&
(n=!0);break;case "LEQUAL":h<=m&&(n=!0);break;case "GEQUAL":h>=m&&(n=!0)}n?a.Cb=l.Ln:a.Cb++;e(a,b,c,d);break;case "REGSTORE":a.ud[l.Mz]=l.sz;a.Cb++;e(a,b,c,d);break;case "MATH":h=-1==l.Qi?l.on:a.ud[l.Qi];m=-1==l.Ri?l.pn:a.ud[l.Ri];switch(l.uz){case "ADD":a.ud[l.oh]=h+m;break;case "MUL":a.ud[l.oh]=h*m;break;case "SUB":a.ud[l.oh]=h-m;break;case "DIV":0==m&&G.pa("Division by zero in NLA script"),a.ud[l.oh]=h/m}a.Cb++;e(a,b,c,d);break;case "SHOW":B.show_object(l.obj);a.Cb++;e(a,b,c,d);break;case "HIDE":B.hide_object(l.obj);
a.Cb++;e(a,b,c,d);break;case "REDIRECT":window.location.href=l.url;a.Ye.length=0;break;case "PAGEPARAM":a:{h=location.href.toString();if(-1!=h.indexOf("?"))for(h=h.split("?")[1].split("&"),m=0;m<h.length;m++)if(n=h[m].split("="),1<n.length&&n[0]==l.wz){h=Number(n[1]);break a}h=0}a.ud[l.oh]=h;a.Cb++;e(a,b,c,d);break;case "NOOP":a.Cb++,e(a,b,c,d)}}}function g(a,b){for(var c=a.Ye,d=0;d<c.length;d++){var e=c[d];e!=b&&(e.Ze=-1)}}function f(a,b,c,d){b=(b-d)*k.Ha+a.ra-a.I;a.cyclic&&c&&(b%=a.U-a.I+1);return b+=
a.I}function h(a,b){a=G.clamp(a,b.I,b.U);var c=a-b.I,d=(b.U-b.I)/b.repeat,c=c/d&&0==c%d?b.Sh:b.Th+c%d/b.scale;b.jt&&(c=b.Sh-c+b.Th);return c}function p(a,b,c){b?A.pause_video(a.name,c):(A.reset_video(a.name,c),A.play_video(a.name,c))}function l(a,c){for(var d=[],e=0;e<a.length;e++){var f=a[e].strips;if(f)for(var g=0;g<f.length;g++){var h=f[g],l=b();l.type=h.type;l.I=h.frame_start;l.U=h.frame_end;l.Ib=c;l.Th=h.action_frame_start;l.Sh=h.action_frame_end;l.jt=h.use_reverse;l.scale=h.scale;l.repeat=h.repeat;
h.action&&(l.uf=h.action.name,l.Vh=h.action.uuid);d.push(l)}}return d}function m(a){return t.ge(a)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function r(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}function n(a,b){var c=B.get_active();
c.ga&&(c.ga.ra-=f(c.ga,b,!0,L)-a,c.ga.rm=!0)}var y=q("__animation"),v=q("__camera"),E=q("__controls"),x=q("__config");q("__loader");var u=q("__print"),B=q("__scenes"),t=q("__sfx"),G=q("__util"),A=q("__textures"),k=x.Nd,I=x.o,F=[],L=-1;a.KB=function(a,e,f){e={I:a.frame_start,U:a.frame_end,ra:0,yi:-1,zn:a.frame_end,An:a.frame_start,Jh:null,pc:f,cyclic:e,ke:[],L:[],Ye:[],wi:!1,rm:!1,DE:a.name,Cb:0,ud:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}};a.ga=e;c(a,e);for(var g=B.Ia(a,"ALL",B.DATA_ID_ALL),h=0;h<
g.length;h++){var k=g[h],n=0,p=[];if((f=k.animation_data)&&f.nla_tracks.length){var r=f.nla_tracks;if(G.is_armature(k)||v.is_camera(k)||G.is_mesh(k)||G.ck(k)||t.ge(k))r=l(r,n),r.length&&(p=p.concat(r),n++)}m(k)&&(r=k.data.animation_data.nla_tracks,r=l(r,n),r.length&&(p=p.concat(r),n++));if(y.zy(k)){var q=k.data.materials;for(f=0;f<q.length;f++){var x=q[f].node_tree;if(x&&(r=[],d(x,r),r=l(r,n),r.length)){for(var x=n,E=r,A=y.nq(),L=[],w=0,ba=0;ba<E.length;ba++){var ma=E[ba];""!=ma.Vh?ma=G.keysearch("uuid",
ma.Vh,A):(ma=ma.uf,ma=G.keysearch("name",ma,A)||G.keysearch("name",ma+"_B4W_BAKED",A));var ma=ma.fcurves,W=[],ia;for(ia in ma)W.push(ia);L.push(W)}for(ba=0;ba<L.length;ba++){A=!1;for(ma=0;ma<ba;ma++)if(G.sv(L[ba],L[ma])){E[ba].Ib=E[ma].Ib;A=!0;break}A||(E[ba].Ib=n+w++)}n=x+w;p=p.concat(r)}}}for(f=0;f<k.particle_systems.length;f++)r=k.particle_systems[f],q=r.settings,"EMITTER"==q.type&&q.b4w_allow_nla&&(q=b(),q.type="CLIP",q.I=e.I,q.U=e.U+1,q.uf=r.name,q.Ib=n,q.Th=q.I,q.Sh=q.U,p.push(q),n++);r=n+1;
if(G.is_mesh(k)&&k.data)for(f=0;f<k.data.b4w_vertex_anim.length;f++)x=k.data.b4w_vertex_anim[f],x.allow_nla&&(n=r,q=b(),q.type="CLIP",q.I=e.I,q.U=e.U+1,q.uf=x.name,q.Ib=n,q.Th=q.I,q.Sh=q.U,p.push(q));p.length&&(k.dl=p,e.ke.push(k))}a=a.d.Kh;for(f=0;f<a.length;f++)if(ia=a[f].d,ia.La||ia.qh)q=b(),q.type="VIDEO",g=1,I.Sc&&(g=ia.ac),q.I=Math.min(ia.I*g,e.U),q.U=ia.vg?e.U:Math.min((ia.Ug+ia.I+ia.ra)*g,e.U),q.uf=a[f].name,ia.Qu=q,e.L.push(ia);a=e.I;f=e.U;for(ia=0;ia<e.ke.length;ia++)for(g=e.ke[ia],h=g.dl,
k=0;k<h.length;k++)p=h[k],q=g.name+" ["+p.I+":"+p.U+"]",p.I=Math.max(a,p.I),p.U=Math.min(f+1,p.U),p.I>p.U?(u.warn("NLA: out of scene range: "+q),h.splice(k,1),k--):p.uf||"CLIP"!=p.type||(u.warn('NLA: no action in strip for object "'+g.name+'".'),h.splice(k,1),k--);for(a=0;a<e.ke.length;a++)for(f=e.ke[a].dl,ia=0;ia<f.length;ia++){g=f[ia];h=e.I;k=e.U+1;for(p=0;p<f.length;p++)q=f[p],g.Ib==q.Ib&&(q.U<=g.I&&(h=g.I),q.I>=g.U&&(k=Math.min(k,q.I)));g.Yp=h;g.Xp=k}F.push(e)};a.start=function(){L=0};a.update=
function(a,b){if(!(0>L)){0==L&&(L=a);for(var c=0;c<F.length;c++){var d=F[c];if(d.wi&&(d.ra-=k.Ha*b,!d.rm))continue;d.rm=!1;e(d,a,b,L);var g=f(d,a,!0,L);if(g>=d.zn+1)if(d.cyclic)d.Jh&&d.Jh(),n(d.An,a),g=f(d,a,!0,L);else{d.wi=!0;d.Jh&&d.Jh();continue}for(var l=0;l<d.ke.length;l++){for(var m=d.ke[l],r=m.dl,q=0;q<r.length;q++){var v=r[q];"SOUND"==v.type&&g<d.yi-1E-6&&(v.me=!1)}for(q=0;q<r.length;q++)switch(v=r[q],v.type){case "CLIP":if(v.Yp<=g&&g<v.Xp&&!v.me){var u=m,x=v;""!=x.Vh?y.lv(u,x.Vh,x.Ib):y.apply(u,
x.uf,x.Ib);y.set_behavior(u,y.AB_FINISH_STOP,x.Ib);var E=h(x.I,x);y.set_current_frame_float(u,E,x.Ib);for(u=0;u<r.length;u++)r[u]!=v&&r[u].Ib==v.Ib&&(r[u].me=!1);v.me=!0}v.me&&(u=m,x=h(g,v),E=y.get_current_frame_float(u,v.Ib),1E-6<Math.abs(x-E)&&y.set_current_frame_float(u,x,v.Ib));break;case "SOUND":(g<d.yi-1E-6||d.yi<v.I)&&v.I<=g&&g<v.U&&!v.me&&(t.play(m,(v.I-g)/k.Ha,(v.U-v.I)/k.Ha),v.me=!0),d.yi<v.U&&v.U<=g&&v.me&&(v.me=!1)}}for(l=0;l<d.L.length;l++)v=d.L[l].Qu,v.I<=Math.round(g)&&Math.round(g)<
v.U&&!v.Ch&&(p(d.L[l],v.Ch,d.pc),v.Ch=!0),v.U<=Math.round(g)&&v.Ch&&(p(d.L[l],v.Ch,d.pc),v.Ch=!1);d.yi=g}}};a.cleanup=function(){F.length=0;L=-1};a.Lq=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||m(a)||r(a)?!0:!1};a.set_frame=n;a.get_frame=function(a){var b=B.get_active();return b.ga?f(b.ga,a,!0,L):-1};a.ZA=function(){var a=B.get_active();a.ga&&(a.ga.wi=!0)};a.Bz=function(a){var b=B.get_active();b.ga&&(b.ga.wi=!1,b.ga.Jh=a?a:null)};a.get_frame_start=function(){var a=B.get_active();
return a.ga?a.ga.I:-1};a.get_frame_end=function(){var a=B.get_active();return a.ga?a.ga.U:-1};a.is_play=function(){var a=B.get_active();return a.ga?!a.ga.wi:!1};a.check_nla=function(){var a=B.get_active();return a.ga?a.b4w_use_nla:!1};a.check_nla_scripts=function(){var a=B.get_active();return a.ga?0<a.b4w_nla_script.length:!1};a.set_range=function(a,b){var c=B.get_active();if(c.ga)c.ga.An=a,c.ga.zn=b;else return!1};a.reset_range=function(){var a=B.get_active();if(a.ga)a=a.ga,a.An=a.I,a.zn=a.U;else return!1};
a.set_cyclic=function(a){var b=B.get_active();if(b.ga)b.ga.cyclic=a;else return!1};a.clear_callback=function(){var a=B.get_active();a.ga&&(a.ga.Jh=null)}};b4w.module.__camera=function(a,q){function b(b){b=b.d;switch(b.ua){case a.MS_TARGET_CONTROLS:b.$g=Q.dist(b.h,b.Lb);b.ah=b.G[0].top;break;case a.MS_HOVER_CONTROLS:b.Ua&&(b.$g=Q.dist(b.h,b.Sb),b.ah=b.G[0].top)}}function d(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),Qa:new Float32Array([0,0,0,0]),Pa:new Float32Array([0,0,0,0])}}function c(b){switch(b){case "STATIC":return a.MS_STATIC;case "TARGET":return a.MS_TARGET_CONTROLS;
case "EYE":return a.MS_EYE_CONTROLS;case "HOVER":return a.MS_HOVER_CONTROLS;default:throw"Unknown move style";}}function e(b){var c={type:b,name:"",ef:1,width:0,height:0,be:null,eb:null,Lc:null,wa:0,sc:0,Qa:0,Pa:0,left:0,right:0,top:0,bottom:0,Le:new Float32Array(3),bq:new Float32Array(3),quat:new Float32Array(4),ma:new Float32Array(16),YC:new Float32Array(16),sa:new Float32Array(16),Lh:new Float32Array(16),Iz:new Float32Array(16),xd:new Float32Array(16),vs:new Float32Array(16),Ed:new Float32Array(16),
dof_distance:0,dof_front:0,dof_rear:0,dof_power:0,Yd:null,dof_on:0,Qj:d(),Xi:0,Ad:0,ec:null,ci:null,Tl:null,Jp:new Float32Array(4),xk:new Float32Array(4)};if(b==a.tb)return c;switch(b){case a.Hb:p(c,40,.1,1E3);break;case a.Hc:p(c,2.5,.1,1E3);break;case a.Jd:break;case a.ye:break;case a.tf:break;case a.ub:case a.Bb:throw"Stereo camera may only be created from perspective one";default:throw"Unknown camera type";}return c}function g(b,c,d){if(b.type!=a.ub&&b.type!=a.Bb)throw"set_stereo_params(): wrong camera type";
b.Xi=c;b.Ad=d;A(b,b.wa);if(aa.ha())for(c=aa.get_active(),b=c.d.wd,c=aa.Rj(c).d.G,d=0;d<c.length;d++)P(c[d],b)}function f(a,b){return h(a.d.quat,b)}function h(a,b){var c=Z.quat_to_dir(a,Z.AXIS_Y,W),d=Z.quat_to_dir(a,Z.AXIS_Z,ia),e=-Math.asin(c[1]/Q.length(c)),c=Math.abs(e)>Math.PI/4?Q.scale(d,-Z.sign(e),ga):Q.scale(c,-Z.sign(d[1]),ga),f=Math.atan(Math.abs(c[0]/c[2]));0<d[1]&&(e=Z.sign(e)*Math.PI-e);d=f;0>c[2]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=e;return b}function p(b,c,d,e,f){switch(b.type){case a.Hb:case a.ub:case a.Bb:b.sc=
c;b.wa=1;break;case a.Hc:b.top=c;b.wa=1;break;case a.Jd:delete b.sc;b.sc=c;b.wa=f/c;break;case a.ye:b.top=c;b.wa=f/c;break;default:X.error("set_frustum(): Unsupported camera type: "+b.type)}b.Qa=d;b.Pa=e}function l(b,c){var d=c.d.h,e=c.d.quat,f=ra;w.rotateX(c.d.T,-Math.PI/2,f);w.invert(f,b.ma);if(b.ec){var f=b.ec[0],g=b.ec[1],h=b.ec[2],l=b.ec[3],m=ra;m[0]=1-2*f*f;m[1]=-2*f*g;m[2]=-2*f*h;m[3]=0;m[4]=-2*f*g;m[5]=1-2*g*g;m[6]=-2*g*h;m[7]=0;m[8]=-2*f*h;m[9]=-2*g*h;m[10]=1-2*h*h;m[11]=0;m[12]=-2*f*l;m[13]=
-2*g*l;m[14]=-2*h*l;m[15]=1;w.multiply(b.ma,m,b.ma);A(b,b.wa,!0);f=R;g=ra;w.invert(b.ma,g);w.transpose(g,g);ha.transformMat4(b.ec,g,f);g=V;g[0]=(Z.sign(f[0])+b.sa[8])/b.sa[0];g[1]=(Z.sign(f[1])+b.sa[9])/b.sa[5];g[2]=-1;g[3]=(1+b.sa[10])/b.sa[14];ha.scale(f,2/(f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3]),f);b.sa[2]=f[0];b.sa[6]=f[1];b.sa[10]=f[2]+1;b.sa[14]=f[3]}b.type==a.ub?b.ma[12]+=b.Ad/2:b.type==a.Bb&&(b.ma[12]-=b.Ad/2);w.multiply(b.sa,b.ma,b.Ed);I(b);k(b);Q.copy(b.Le,b.bq);Q.copy(d,b.Le);ka.copy(e,
b.quat)}function m(b,c,d,e){w.lookAt(c,d,e,b.ma);b.type==a.ub?b.ma[12]+=b.Ad/2:b.type==a.Bb&&(b.ma[12]-=b.Ad/2);w.multiply(b.sa,b.ma,b.Ed);I(b);k(b);Q.copy(c,b.Le)}function r(a){var b=a.d.G;if(!b)throw"Wrong object";for(var c=a.d,d=0;d<b.length;d++){var e=b[d];l(e,a);Z.jm(e.Ed,e.Qj);if(e.Yd)if(e.dof_on){var f=Q.dist(c.h,e.Yd.location);e.dof_distance=f}else e.dof_distance=0}}function n(b){b=b.d;if(b.ua==a.MS_TARGET_CONTROLS){var c=Z.quat_to_dir(b.quat,Z.AXIS_Z,W);b.Xn=0<c[1]}}function y(b,c){var d=
b.d,e=d.Rb;!e||d.ua!=a.MS_EYE_CONTROLS&&d.ua!=a.MS_TARGET_CONTROLS||(c&&(d=f(b,ba),e.left+=d[0],e.right+=d[0]),e.left=Z.angle_wrap_0_2pi(e.left),e.right=Z.angle_wrap_0_2pi(e.right))}function v(b,c){var d=b.d,e=d.fd;!e||d.ua!=a.MS_EYE_CONTROLS&&d.ua!=a.MS_TARGET_CONTROLS||(c&&(d=f(b,ba),e.Za+=d[1],e.Oa+=d[1]),e.Za=Z.angle_wrap_periodic(e.Za,-Math.PI,Math.PI),e.Oa=Z.angle_wrap_periodic(e.Oa,-Math.PI,Math.PI))}function E(b){var c=b.d;if(L(b)&&c.G[0].type===a.Hc){if(c.ua===a.MS_TARGET_CONTROLS)var d=
Q.dist(c.h,c.Lb),c=d/c.$g*c.ah;else c.Ua&&c.ua===a.MS_HOVER_CONTROLS?(d=Q.distance(c.h,c.Sb),c=d/c.$g*c.ah):c=b.d.G[0].top;for(var e in b.d.G)d=b.d.G[e],d.top=c,A(d,d.wa);r(b)}}function x(a,b,c,d,e){var g=a.d,h=b,l=c;if(d||e)a=f(a,ma),d&&(h=b-a[0]),e&&(l=c-a[1]);if(h||l)b=ka.identity(pa),h&&(h=ka.setAxisAngle(Z.AXIS_Y,h,T),ka.multiply(b,h,b)),l&&(h=Z.quat_to_dir(g.quat,Z.AXIS_X,W),l=ka.setAxisAngle(h,l,T),ka.normalize(l,l),ka.multiply(b,l,b)),ka.multiply(b,g.quat,g.quat)}function u(a,b,c,d,e){var g=
a.d,h=b,l=c;if(d||e){var k=f(a,ma);d&&(h=b-k[0]);e&&(l=c-k[1])}t(a,a.d.Lb,h,l);a=f(a,ma);a=Z.angle_wrap_periodic(a[1],-Math.PI,Math.PI);g.Xn=Math.abs(a)>Math.PI/2}function B(a,b,c,d,e){var g=a.d,h=b,l=c;if(d||e){var k=f(a,ma);d&&(h=b-k[0]);e&&(l=c-k[1])}g.dm||(h=0);t(a,g.Sb,h,l);l&&G(a)}function t(a,b,c,d){var e=a.d;if(c||d){var f=ka.identity(pa);c&&(c=ka.setAxisAngle(Z.AXIS_Y,c,T),ka.multiply(f,c,f));a=J(a);d&&(!a||a&&e.Ua)&&(a=Z.quat_to_dir(e.quat,Z.AXIS_X,W),d=ka.setAxisAngle(a,d,T),ka.normalize(d,
d),ka.multiply(f,d,f));Z.Yz(e.h,b,f,e.h);ka.multiply(f,e.quat,e.quat)}}function G(a){var b=a.d;if(b.Ua){var c=f(a,ba)[1];a=a.d;a.xb.Oa-a.xb.Za?(c=(a.xb.Oa-c)/(a.xb.Oa-a.xb.Za),c=Math.max(c,0)):c=0;c=c*(a.Gf-a.Xd)+a.Xd;a=Z.quat_to_dir(b.quat,Z.AXIS_MY,W);Q.normalize(a,a);Q.scale(a,c,a);Q.subtract(b.Sb,a,b.h)}}function A(b,c,d){switch(b.type){case a.Hb:if(!c)throw"No aspect ratio";b.wa=c;case a.Jd:w.perspective(Z.Bk(b.sc),b.wa,b.Qa,b.Pa,b.sa);break;case a.Hc:if(!c)throw"No aspect ratio";b.wa=c;case a.ye:c=
b.top*b.wa;w.ortho(-c,c,-b.top,b.top,b.Qa,b.Pa,b.sa);break;case a.tf:w.ortho(b.left,b.right,b.bottom,b.top,b.Qa,b.Pa,b.sa);break;case a.ub:case a.Bb:if(!c)throw"No aspect ratio";b.wa=c;var e=Math.tan(b.sc*Math.PI/360);c=b.Qa*e;var f=b.wa*b.Xi*e;b.type==a.ub?(e=f-b.Ad/2,f+=b.Ad/2):(e=f+b.Ad/2,f-=b.Ad/2);e=-(b.Qa/b.Xi*e);f*=b.Qa/b.Xi;w.frustum(e,f,-c,c,b.Qa,b.Pa,b.sa);b.left=e;b.right=f;break;case a.tb:return;default:throw"Wrong camera type: "+b.type;}d||(w.multiply(b.sa,b.ma,b.Ed),I(b),k(b))}function k(a){w.copy(a.ma,
a.xd);a.xd[12]=0;a.xd[13]=0;a.xd[14]=0;a.xd[15]=1;w.multiply(a.sa,a.xd,a.xd);w.invert(a.xd,a.xd)}function I(a){w.copy(a.ma,a.Lh);w.multiply(a.sa,a.Lh,a.Lh);w.invert(a.Lh,a.Lh)}function F(b,c,d,e,f){e||(e=new Float32Array(24));c||(c=b.Qa);d||(d=b.Pa);var g,h,l,k,m,n,p,r;switch(b.type){case a.tb:throw"Extraction from NONE camera is not possible";case a.Hb:case a.Jd:g=c*Math.tan(b.sc*Math.PI/360);k=-g;h=g*b.wa;l=-h;m=d/c*g;r=-m;n=m*b.wa;p=-n;break;case a.Hc:case a.ye:l=b.top*b.wa;g=m=b.top;h=n=l;k=r=
-b.top;l=p=-l;break;case a.tf:g=m=b.top;h=n=b.right;k=r=b.bottom;l=p=b.left;break;case a.ub:case a.Bb:m=c/b.Qa;g=c*Math.tan(b.sc*Math.PI/360);k=-g;h=b.right*m;l=b.left*m;p=d/c;m=g*p;r=-m;n=h*p;p*=l;break;default:throw"Wrong camera type: "+b.type;}e[0]=l;e[1]=k;e[2]=-c;e[3]=h;e[4]=k;e[5]=-c;e[6]=h;e[7]=g;e[8]=-c;e[9]=l;e[10]=g;e[11]=-c;e[12]=p;e[13]=r;e[14]=-d;e[15]=p;e[16]=m;e[17]=-d;e[18]=n;e[19]=m;e[20]=-d;e[21]=n;e[22]=r;e[23]=-d;f&&(c=ra,w.invert(b.ma,c),Z.We(e,c,e,0));return e}function L(a){return"CAMERA"===
a.type?!0:!1}function J(b){return L(b)&&b.d&&b.d.ua==a.MS_HOVER_CONTROLS?!0:!1}function P(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.ci){var d=b.csm_num;a.ci=Array(d);for(var e=0;e<d;e++)a.ci[e]=new Float32Array(3);a.Tl=new Float32Array(d)}for(d=0;d<c;d++){var e=0==d?a.Qa:z(b,a,d-1),f=z(b,a,d),e=F(a,e,f,sa),e=H.hy(e);a.ci[d].set(e.F);a.Tl[d]=e.Da;a.Jp[d]=Q.length(e.F);a.xk[d]=N(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.xk[0]=b.first_cascade_blur_radius}function z(a,b,c){var d=
a.csm_num,e=Z.clamp(a.csm_first_cascade_border,b.Qa,b.Pa);a=Z.clamp(a.csm_last_cascade_border,b.Qa,b.Pa);return Z.clamp(N(e,a,d,c),b.Qa,b.Pa)}function N(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-1))}return a}var H=q("__boundings");q("__config");var K=q("__constraints"),O=q("__container"),X=q("__print"),aa=q("__scenes"),Z=q("__util"),Q=q("vec3"),ha=q("vec4"),ka=q("quat"),qa=q("mat3"),w=q("mat4");a.tb=10;a.Hb=20;a.Hc=30;a.Jd=40;a.ye=50;a.tf=60;a.ub=70;a.Bb=
80;a.MS_STATIC=0;a.MS_TARGET_CONTROLS=2;a.MS_EYE_CONTROLS=3;a.MS_HOVER_CONTROLS=4;var ba=new Float32Array(2),ma=new Float32Array(2),W=new Float32Array(3),ia=new Float32Array(3),ga=new Float32Array(3),pa=new Float32Array(4),T=new Float32Array(4),R=new Float32Array(4),V=new Float32Array(4),ja=new Float32Array(16),ra=new Float32Array(16),sa=new Float32Array(24);a.Lv=function(d){var g=d.d,h=d.data;switch(h.type){case "PERSP":var l=e(a.Hb);if(h.angle_y)var k=h.angle_y/Math.PI*180;p(l,k,h.clip_start,h.clip_end);
break;case "ORTHO":l=e(a.Hc),p(l,h.ortho_scale/2,h.clip_start,h.clip_end)}l.name=d.name;g.at=!1;g.ua=c(h.b4w_move_style);g.dof_distance=d.data.dof_distance;g.Yd=d.data.dof_object;g.dof_front=d.data.b4w_dof_front;g.dof_rear=d.data.b4w_dof_rear;g.dof_power=d.data.b4w_dof_power;g.dm=d.data.b4w_enable_hover_hor_rotation;g.G=[l];g.mo=d.data.b4w_trans_velocity;g.lo=d.data.b4w_rot_velocity;g.no=d.data.b4w_zoom_velocity;g.ua==a.MS_TARGET_CONTROLS&&(g.Lb.set(h.b4w_target),n(d));h=d.d;k=h.ua;if(k===a.MS_TARGET_CONTROLS||
k===a.MS_EYE_CONTROLS||k===a.MS_HOVER_CONTROLS){var m=d.data,r=null,t=null,q=null;k===a.MS_TARGET_CONTROLS||k===a.MS_EYE_CONTROLS?(m.b4w_use_panning&&(h.it=m.b4w_use_panning),m.b4w_use_horizontal_clamping&&(r={left:m.b4w_rotation_left_limit,right:m.b4w_rotation_right_limit}),m.b4w_use_vertical_clamping&&(t={Oa:m.b4w_rotation_down_limit,Za:m.b4w_rotation_up_limit}),k===a.MS_TARGET_CONTROLS&&(h.Ua=m.b4w_use_distance_limits&&m.b4w_distance_min<=m.b4w_distance_max,h.Ua&&(h.Xd=m.b4w_distance_min,h.Gf=
m.b4w_distance_max))):k===a.MS_HOVER_CONTROLS&&(m.b4w_use_horizontal_clamping&&m.b4w_horizontal_translation_min<=m.b4w_horizontal_translation_max&&(r={left:m.b4w_horizontal_translation_min,right:m.b4w_horizontal_translation_max}),m.b4w_use_vertical_clamping&&m.b4w_vertical_translation_min<=m.b4w_vertical_translation_max&&(t={Oa:m.b4w_vertical_translation_min,Za:m.b4w_vertical_translation_max}),h.Ua=m.b4w_use_distance_limits&&m.b4w_hover_angle_min<=m.b4w_hover_angle_max&&m.b4w_distance_min<=m.b4w_distance_max,
h.Ua&&(q={Oa:m.b4w_hover_angle_min,Za:m.b4w_hover_angle_max},h.Xd=m.b4w_distance_min,h.Gf=m.b4w_distance_max));var u=r;u&&k==a.MS_EYE_CONTROLS&&(u.left*=-1,u.right*=-1);if(u=t)switch(k){case a.MS_TARGET_CONTROLS:u.Oa*=-1;u.Za*=-1;break;case a.MS_HOVER_CONTROLS:var T=-u.Oa;u.Oa=-u.Za;u.Za=T}(u=q)&&k==a.MS_HOVER_CONTROLS&&(u.Oa*=-1,u.Za*=-1);h.Rb=r;h.fd=t;h.xb=q;y(d,"LOCAL"==m.b4w_horizontal_clamping_type);v(d,"LOCAL"==m.b4w_vertical_clamping_type)}if(g.ua===a.MS_HOVER_CONTROLS)if(g=d.d,g.Ua){h=d.d;
k=Z.quat_to_dir(h.quat,Z.AXIS_MY,W);m=R;m.set(Z.AXIS_Y);m[3]=0;k=Z.line_plane_intersect(m,0,h.h,k,h.Sb);if(!k||100<Q.len(k))h.Sb[0]=h.h[0],h.Sb[1]=0,h.Sb[2]=h.h[2];h=f(d,ba);g=Z.De(h[1],g.xb.Za,g.xb.Oa);0<h[1]&&X.warn("Active hover camera has wrong orientation");g?B(d,0,g):G(d)}else g.dm=!1;l.type==a.Hc&&b(d)};a.Gy=b;a.vw=d;a.kb=e;a.ZC=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.eb);case "DEPTH":return Boolean(a.Lc);case "SCREEN":return!Boolean(a.eb)&&!Boolean(a.Lc);default:throw"Wrong attachment type: "+
b;}};a.Gk=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.eb=c;break;case "DEPTH":a.Lc=c;break;case "SCREEN":a.eb=null;a.Lc=null;break;default:throw"Wrong attachment type: "+b;}};a.LD=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.eb;case "DEPTH":return a.Lc;case "SCREEN":return null;default:throw"Wrong attachment type: "+b;}};a.or=function(b,c){if(b.type!=a.Hb||c!=a.ub&&c!=a.Bb)throw"make_stereo(): wrong camera type";b.type=c;g(b,6,.065)};a.uA=g;a.get_camera_angles=f;a.pq=h;
a.get_camera_angles_char=function(a,b){f(a,b);b[0]=Z.angle_wrap_0_2pi(b[0]+Math.PI);b[1]*=-1;return b};a.get_angles=function(a,b){var c=a.d,d=Z.quat_to_dir(c.quat,Z.AXIS_MY,W),e=Math.asin(d[1]/Q.length(d));0==d[0]&&0==d[2]?c=0:(Math.abs(e)>Math.PI/4&&(d=0>=e?Z.quat_to_dir(c.quat,Z.AXIS_MZ,ia):Z.quat_to_dir(c.quat,Z.AXIS_Z,ia)),c=Math.atan(Math.abs(d[0]/d[2])),0<d[2]&&(c=Math.PI-c),0<d[0]&&(c=2*Math.PI-c));b[0]=c;b[1]=e;return b};a.Hk=p;a.mA=function(b,c,d,e,f,g,h){switch(b.type){case a.tf:b.left=
c;b.right=d;b.bottom=e;b.top=f;b.Qa=g;b.Pa=h;break;default:X.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.get_move_style=function(a){return a.d.ua};a.yA=l;a.EE=m;a.ss=function(a,b,c){var d=W;d[0]=0;d[1]=-1;d[2]=0;Q.transformQuat(d,c,d);d[0]+=b[0];d[1]+=b[1];d[2]+=b[2];var e=ia;e[0]=0;e[1]=0;e[2]=-1;Q.transformQuat(e,c,e);m(a,b,d,e)};a.ux=function(a,b,c,d,e){d[0]=a[0];d[1]=a[1];d[2]=a[2];w.lookAt(a,b,c,ra);w.invert(ra,ra);w.rotateX(ra,Math.PI/2,ra);qa.fromMat4(ra,ja);ka.fromMat3(ja,
e)};a.CB=r;a.BB=function(b){var c=b.d,d=b.d;if(d.ua===a.MS_TARGET_CONTROLS||d.ua===a.MS_EYE_CONTROLS){if(d.Rb){var e=d.Rb.left,g=d.Rb.right,h=f(b,ba);(h=d.ua==a.MS_TARGET_CONTROLS?Z.De(h[0],e,g):Z.De(h[0],g,e))&&(d.ua==a.MS_TARGET_CONTROLS?u(b,h,0):x(b,h,0))}d.fd&&(e=d.fd.Oa,g=d.fd.Za,h=f(b,ba),(h=d.ua==a.MS_TARGET_CONTROLS?Z.De(h[1],g,e):Z.De(h[1],e,g))&&(d.ua==a.MS_TARGET_CONTROLS?u(b,0,h):x(b,0,h)));d.ua===a.MS_TARGET_CONTROLS&&d.Ua&&(h=b.d,e=Q.subtract(h.h,h.Lb,W),g=Q.length(e),g>h.Gf?(Q.scale(e,
h.Gf/g,e),Q.add(h.Lb,e,h.h)):g<h.Xd&&(g=Z.quat_to_dir(h.quat,Z.AXIS_MY,ia),Q.scale(g,100*h.Xd,g),Q.add(e,g,e),Q.scale(e,-h.Xd/Q.length(e),e),Q.add(h.Lb,e,h.h)))}d.ua===a.MS_HOVER_CONTROLS&&(d=b.d,h=d.Ua?d.Sb:d.h,d.Rb&&(e=Z.clamp(h[0],d.Rb.left,d.Rb.right)-h[0],h[0]+=e,d.Ua&&(d.h[0]+=e)),d.fd&&(e=Z.clamp(h[2],d.fd.Oa,d.fd.Za)-h[2],h[2]+=e,d.Ua&&(d.h[2]+=e)),d=b.d,d.Ua&&d.xb&&(h=f(b,ba)[1],h=Z.De(h,d.xb.Za,d.xb.Oa),Z.quat_to_dir(d.quat,Z.AXIS_MY,W),h&&B(b,0,h)));E(b);switch(c.ua){case a.MS_TARGET_CONTROLS:K.Zz(c.h,
c.quat,c.Lb);K.correct_up(b,Z.AXIS_Y);break;case a.MS_EYE_CONTROLS:b.Wa||K.correct_up(b,Z.AXIS_Y)}n(b)};a.io=n;a.Dz=y;a.Hz=v;a.JB=E;a.rotate_eye_camera=x;a.rotate_target_camera=u;a.rotate_hover_camera=B;a.Fy=G;a.gE=function(b){switch(b.type){case a.Hb:case a.Hc:case a.ub:case a.Bb:return!0;default:return!1}};a.Tx=function(b){b=b.d.G[0];switch(b.type){case a.Hb:case a.Jd:case a.ub:case a.Bb:return Math.PI*b.sc/180;default:return X.error("get_min_fov(): Unsupported camera type: "+b.type),0}};a.$e=A;
a.Cl=k;a.np=I;a.sx=F;a.uv=function(a){a=a.d;var b=H.Gd();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.Pb=b;var c=H.Rl(1,[0,0,0]);a.Vc=c;a.ql=H.Fp(1,b);a.sl=H.Hp(1,b);a.rl=H.Gp(1,b)};a.is_camera=L;a.is_target_camera=function(b){return L(b)&&b.d&&b.d.ua==a.MS_TARGET_CONTROLS?!0:!1};a.is_eye_camera=function(b){return L(b)&&b.d&&b.d.ua==a.MS_EYE_CONTROLS?!0:!1};a.is_hover_camera=J;a.ho=P;a.Qw=z;a.project_point=function(b,c,d){b=b.d.G[0];switch(b.type){case a.Hb:case a.Jd:case a.Hc:case a.ye:case a.ub:case a.Bb:var e=
R;e.set(c);e[3]=1;ha.transformMat4(e,b.Ed,e);c=-e[1]/e[3];d[0]=(e[0]/e[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;O.hC(d[0],d[1],d,b);2<d.length&&(d[2]=(e[2]/Math.abs(e[3])+1)/2);return d;default:return X.error("Non-compatible camera"),d}};a.fy=function(a){return a.d.G[0]};a.Sj=function(b,c){switch(b.type){case a.Hb:case a.Jd:case a.ub:case a.Bb:var d=Math.tan(Z.Bk(b.sc)/2);switch(c){case "LEFT":return-d*b.wa;case "RIGHT":return d*b.wa;case "TOP":return d;case "BOTTOM":return-d}break;case a.Hc:case a.ye:switch(c){case "LEFT":return-b.top*
b.wa;case "RIGHT":return b.top*b.wa;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.tf:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;default:Z.pa("Unknown camera type")}};a.Ty=function(b){switch(b.type){case a.Hc:case a.ye:case a.tf:return!0;default:return!1}};a.get_fov=function(b,c){switch(b.type){case a.Hb:case a.Jd:case a.ub:case a.Bb:var d=Z.Bk(b.sc);return c?d*b.wa:d;default:return 0}}};b4w.module.__lights=function(a,q){function b(a){return{name:"",index:0,type:a,direction:new Float32Array(3),color:new Float32Array(3),Kg:new Float32Array(3),dd:0,sg:0,Qx:!1,Up:!1,wg:!0,lf:!0,Je:1,distance:25,vD:"INVERSE_SQUARE"}}function d(a){a.Kg[0]=a.color[0]*a.Je;a.Kg[1]=a.color[1]*a.Je;a.Kg[2]=a.color[2]*a.Je}var c=q("__util"),e=q("vec3");a.$D=b;a.Wy=function(a){var f=a.data,h=b(f.type);h.name=a.name;h.wg=f.use_diffuse;h.lf=f.use_specular;var p=c.quat_to_dir(a.d.quat,c.AXIS_Y,[]);e.normalize(p,
p);h.direction[0]=p[0];h.direction[1]=p[1];h.direction[2]=p[2];h.color[0]=f.color[0];h.color[1]=f.color[1];h.color[2]=f.color[2];h.Je=f.energy;d(h);h.distance=f.distance;if("POINT"===h.type||"SPOT"===h.type)h.distance=f.distance;"SPOT"===h.type?(h.sg=f.spot_blend,h.dd=f.spot_size):"POINT"===h.type&&(h.dd=Math.PI/2);h.Qx=f.b4w_generate_shadows;h.Up=f.b4w_dynamic_intensity;a.na=h};a.oA=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];d(a)};a.qA=function(a,b){a.sg=b};a.pA=function(a,b){a.distance=
b};a.rA=function(a,b){a.dd=b};a.ps=function(a,b){a.Je=b;d(a)};a.Rm=function(a){return"LAMP"===a.type?!0:!1};a.GB=function(a){if("LAMP"!=a.type)throw"Wrong light object";var b=a.na;b&&(c.quat_to_dir(a.d.quat,c.AXIS_Y,b.direction),e.normalize(b.direction,b.direction))}};b4w.module.__scenes=function(a,q){function b(){vb||(vb=d(Da));return vb}function d(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.jd||!c.jd.length)return c}return null}function c(){if(!Ra)throw"No active scene available";return Ra}function e(a,b,c,d){for(var e=null,f=0;f<b.length;f++){var g=b[f];if((c?g.origin_name:g.name)==a&&g.d.pc==d){e=g;break}}return e}function g(a,b){b||(b="ALL");var c=[];f(a.objects,b,c);return c}function f(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];"ALL"!=b&&b!=e.type||
c.push(e);(e=e.dupli_group)&&f(e.objects,b,c)}}function h(b){if(Ca.Vi)switch(b.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var c=!1,d=!1;if(0==ga(b,"LAMP",a.DATA_ID_ALL).length)return!1;b=ga(b,"MESH",a.DATA_ID_ALL);for(var e=0;e<b.length;e++){var f=b[e];f.b4w_shadow_cast&&(c=!0);f.b4w_shadow_receive&&(d=!0);if(c&&d)return!0}return!1}function p(a){if(!a.va)return!1;a=a.va.LAMP;for(var b=0;b<a.length;b++)if("SUN"==a[b].na.type)return!0;return!1}function l(a){if(!Ca.shore_smoothing)return!1;
a=pa(a);for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function m(b){var c=pa(b),d=[];b=ga(b,"MESH",a.DATA_ID_ALL);for(var e=0;e<c.length;e++){var f=c[e];if(f.b4w_water){for(var g={},h=0;h<b.length;h++)for(var l=b[h],D=l.data.materials,k=0;k<D.length;k++)D[k]==f&&(g.pf=l.location[1]);if(Ca.gi)for(g.$b=f.b4w_water_fog_color.slice(0),g.$b.push(f.b4w_water_fog_density),f.b4w_water_dynamic?(g.Rg=!0,g.waves_height=f.b4w_waves_height,g.waves_length=
f.b4w_waves_length,g.dst_noise_scale0=f.b4w_water_dst_noise_scale0,g.dst_noise_scale1=f.b4w_water_dst_noise_scale1,g.dst_noise_freq0=f.b4w_water_dst_noise_freq0,g.dst_noise_freq1=f.b4w_water_dst_noise_freq1,g.dir_min_shore_fac=f.b4w_water_dir_min_shore_fac,g.dir_freq=f.b4w_water_dir_freq,g.dir_noise_scale=f.b4w_water_dir_noise_scale,g.dir_noise_freq=f.b4w_water_dir_noise_freq,g.dir_min_noise_fac=f.b4w_water_dir_min_noise_fac,g.dst_min_fac=f.b4w_water_dst_min_fac,g.waves_hor_fac=f.b4w_water_waves_hor_fac):
(g.Rg=!1,g.waves_height=0,g.waves_length=0),g.Dj=null,g.Fl=null,g.Gl=new Float32Array(2),g.Jk=null,f=f.texture_slots,h=0;h<f.length;h++)l=f[h].texture,"VORONOI"==l.type&&(g.Dj=l.noise_scale,g.Gl.set([.3,.7]),g.Fl=l.noise_intensity),!0===l.b4w_shore_dist_map&&(g.Jk=l.image,g.th=l.image.size[0],g.FA=l.b4w_shore_boundings,g.hh=l.b4w_max_shore_dist);else g.waves_height=0,g.waves_length=0,g.Dj=null,g.Fl=null,g.Gl=null,g.$b=null,g.Rg=!1;d.push(g)}}if(0<d.length){g=d[0];if(!g.Rg)for(e=0;e<d.length;e++)d[e].Rg&&
(g=d[e]);return g}return null}function r(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d];"GROUP"==e.type&&e.node_group&&b(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==e.node_tree_name&&(c.fc=!0)}}}var c={fc:!1};a=pa(a);for(var d=0;d<a.length;d++){var e=a[d];e.b4w_refractive&&(c.fc=!0);e.node_tree&&b(e.node_tree)}return c}function n(b){if(Ca.Ek)switch(b.b4w_render_reflections){case "OFF":return!1}else return!1;var c=[],d=0;b=ga(b,"MESH",a.DATA_ID_ALL);for(var e=
0;e<b.length;e++){var f=b[e];if(f.d.yc)if("CUBE"==f.d.le)d++;else{var g=f.el;f.el=null;if(g){g.d||tb.Sk(g,!1);for(var f=null,h=0;h<c.length;h++)if(c[h]==g){f=h;break}null==f&&c.push(g)}}}return{Dk:c,xr:d,Kj:[],Ki:[]}}function y(a,b){var c={},d=a.world.b4w_sky_settings;c.Rz=d.render_sky;c.procedural_skydome=d.procedural_skydome&&b;c.use_as_environment_lighting=d.use_as_environment_lighting;c.uh=d.color;c.rayleigh_brightness=d.rayleigh_brightness;c.mie_brightness=d.mie_brightness;c.spot_brightness=
d.spot_brightness;c.scatter_strength=d.scatter_strength;c.rayleigh_strength=d.rayleigh_strength;c.mie_strength=d.mie_strength;c.rayleigh_collection_power=d.rayleigh_collection_power;c.mie_collection_power=d.mie_collection_power;c.mie_distribution=d.mie_distribution;c.Vb=d.reflexible;c.Mb=d.reflexible_only;!b&&d.procedural_skydome&&Ea.warn("There is no sun on the scene. Procedural sky won't be rendered");return c}function v(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.Dy=
a.hemisphere;b.Fv=a.blur_depth;b.hp=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.aA=a.samples;return b}function E(a){var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.hx=a.edge_lum;b.key=a.key;return b}function x(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function u(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;
b.saturation=a.saturation;return b}function B(a){var b={};a=a.b4w_god_rays_settings;b.Jy=a.intensity;b.gh=a.max_ray_length;b.Bh=a.steps_per_pass;return b}function t(a){var b={};b.Ue=a.b4w_outline_color;b.Fi=a.b4w_outline_factor;return b}function G(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function A(a,b){var c=
a.world,d=c.light_settings,e={};e.Ke=d.environment_energy;e.jo=d.use_environment_light;e.em=d.environment_color;e.Ne=c.horizon_color.slice(0);e.rf=c.zenith_color.slice(0);e.$B=c.use_sky_paper;e.ZB=c.use_sky_blend;e.aC=c.use_sky_real;e.Bs=null;e.Kn=null;e.fm=null;if(e.jo&&"SKY_TEXTURE"==e.em&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var d=null,f=0;f<c.texture_slots.length;f++)if(c.texture_slots[f].texture.b4w_use_as_environment_lighting){d=c.texture_slots[f];break}d?e.fm=d:(Ea.warn("environment lighting is set to 'Sky Texture', but there is no world texture with 'Sky Texture Usage' property set to 'ENVIRONMENT_LIGHTING'"),
e.jo=!1)}for(f=0;f<c.texture_slots.length;f++)if(c.texture_slots[f].texture.b4w_use_as_skydome){c=c.texture_slots[f];e.Bs=c;e.Kn={Dv:c.blend_factor,Ey:c.horizon_factor,pC:c.zenith_up_factor,oC:c.zenith_down_factor,color:c.color,Aa:c.default_value,invert:c.invert,YB:c.use_rgb_to_intensity,fp:c.blend_type,UB:c.use_map_blend,VB:c.use_map_horizon,XB:c.use_map_zenith_up,WB:c.use_map_zenith_down};break}return e}function k(b){if(!Ca.mb)return!1;var c=!1,d=!1;b=ga(b,"MESH",a.DATA_ID_ALL);for(var e=0;e<b.length;e++){for(var f=
b[e],g=f.data.materials,h=0;h<g.length;h++)g[h].b4w_terrain&&(c=!0);f=f.particle_systems;for(h=0;h<f.length;h++)g=f[h].settings,"HAIR"==g.type&&g.b4w_dynamic_grass&&(d=!0);if(c&&d)return!0}return!1}function I(b){if(ob.outlining_overview_mode)return!0;if(Ca.enable_selectable)switch(b.b4w_enable_object_selection){case "OFF":return!1;case "ON":return!0;case "AUTO":b=ga(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)if(b[c].d.qg)return!0;return!1}else return!1}function F(b){if(ob.outlining_overview_mode)return!0;
if(Ca.enable_outlining)switch(b.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":b=ga(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)if(b[c].d.Fb)return!0;return!1}else return!1}function L(b){if(Ca.ee)switch(b.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":b=ga(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,e=0;e<d.length;e++)if(Hc.tp(d[e]))return!0;return!1}else return!1}function J(a,b){if(Ca.fc)switch(a.b4w_render_refractions){case "OFF":return!1;
case "ON":return!0;case "AUTO":return b.fc}else return!1}function P(b){b=ga(b,"MESH",a.DATA_ID_ALL);for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,e=0;e<d.length;e++){var f=d[e],g=f.game_settings.alpha_blend;if(f.b4w_render_above_all&&"OPAQUE"!=g&&"CLIP"!=g)return!0}return!1}function z(b){switch(b.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0}b=ga(b,"EMPTY",a.DATA_ID_ALL);for(var c=0;c<b.length;c++){var d=b[c];if(d.b4w_anchor&&d.b4w_anchor.detect_visibility)return!0}return!1}
function N(a,b,c){var d=Ja.cg(a,b);Ja.te(a,d,function(a,b,d){if(d.Ma){switch(d.M){case "COLOR":case "CUBEMAP":a=b.i.eb;break;case "DEPTH":a=b.i.Lc;break;case "SCREEN":a=null;break;case "MAIN_CUBE_REFLECT":return;default:throw"Wrong slink";}switch(d.la){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "u_cube_reflection":case "u_plane_reflection":break;default:if(!a)throw"Connection of SCREEN is forbidden";if(a.nf)throw"Batch texture can't use renderbuffer";
na.vp(c.Xb,d.la)&&da.Hg(c,a,d.la)}}});for(a=0;a<b.fa.length;a++){var d=b.fa[a],e=b.Bd[a];switch(d.la){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":break;default:if(e.nf)throw"Batch texture can't use renderbuffer";na.vp(c.Xb,d.la)&&da.Hg(c,e,d.la)}}}function H(a,b){return{Xa:!0,bm:[!0,!0,!0,!0,!0,!0],td:a,B:b}}function K(a,b,c,d,e){switch(a.type){case "MAIN_OPAQUE":O(a,b,c,"OPAQUE",d,e);break;case "MAIN_BLEND":O(a,b,c,"BLEND",d,e);break;case "MAIN_XRAY":O(a,b,
c,"XRAY",d,e);break;case "MAIN_GLOW":O(a,b,c,"GLOW",d,e);break;case "MAIN_PLANE_REFLECT":case "MAIN_CUBE_REFLECT":for(var f=b.d,g=b.n,h=0;h<g.length;h++){var l=g[h];if(("MAIN"==l.type||"NODES"==l.type||"PARTICLES"==l.type)&&"REFLECT"==l.Ka){if("MAIN_PLANE_REFLECT"==a.type){var D;a:{if(d.d.zb){D=d.d.zb.Ki;for(var k=0;k<D.length;k++)if(D[k]==a){D=k;break a}}D=null}if(D==f.vc)continue}else{a:{if(d.d.zb)for(D=d.d.zb.Kj,k=0;k<D.length;k++)if(D[k]==a){D=k;break a}D=null}if(D==f.nc)continue}e||(X(l,a,b,
c,"REFLECT",d),D=l.pb,na.v(D,"DISABLE_FOG",0),na.v(D,"WATER_EFFECTS",0),"special_skydome.glslf"==na.tq(D)&&na.v(D,"REFLECTION_PASS",1),na.v(D,"TEXTURE_NORM",0),Z(d,l),da.rb(l),Q(l));a.p.push(H(f,l))}}break;case "DEPTH":f=b.d;b=b.n;for(g=0;g<b.length;g++)if(h=b[g],"DEPTH"==h.type&&!h.hc&&"DEPTH"==h.Ka){if(!e){l=h;k=a;D=f;var m=c,n=d,U=l.pb,p=la.Ba(m,"SHADOW_CAST");p?l.Yb?(na.v(U,"SHADOW_USAGE","SHADOW_MASK_GENERATION"),da.nl(l,n.d.wd,p),la.uq(m,k)):na.v(U,"SHADOW_USAGE","NO_SHADOWS"):na.v(U,"SHADOW_USAGE",
"NO_SHADOWS");l.mb&&(k=la.Ba(m,"GRASS_MAP"))&&ka(l,k,D);da.rb(l);Q(l)}a.p.push(H(f,h));N(c,a,h);ha(h)}break;case "SHADOW_CAST":f=!1;g=b.d;b=b.n;h=la.Ba(c,"GRASS_MAP");for(l=0;l<b.length;l++)D=b[l],"DEPTH"==D.type&&"SHADOW_CAST"==D.Ka&&(f=!0,e||(na.v(D.pb,"SHADOW_USAGE","SHADOW_CASTING"),D.mb&&h&&ka(D,h,g),da.ka(D,"SHADOW_TEX_RES",na.t(d.d.wd.csm_resolution)),da.rb(D),Q(D)),a.p.push(H(g,D)));f&&w(a,la.Ba(c,"MAIN_OPAQUE"),a.p,d,!0);break;case "COLOR_PICKING":ma(a,b,e);break;case "COLOR_PICKING_XRAY":ma(a,
b,e);break;case "OUTLINE_MASK":c=b.d;d=b.n;for(b=0;b<d.length;b++)f=d[b],"COLOR_ID"==f.type&&"OUTLINE"==f.Ka&&(e||(da.ka(f,"USE_OUTLINE",1),da.rb(f),Q(f)),a.p.push(H(c,f)));break;case "GRASS_MAP":c=b.d;d=b.n;for(b=0;b<d.length;b++)f=d[b],"GRASS_MAP"==f.type&&(e||(da.rb(f),Q(f)),a.p.push(H(c,f)),f=a.i,D=c.bb,g=a.bc[0],h=a.bc[1],l=a.bc[2],0==g&&0==h?(g=D.min_y,h=D.max_y):(g=Math.min(g,D.min_y),h=Math.max(h,D.max_y)),D=1E-4*(h-g),a.bc[0]=g-D,a.bc[1]=h+D,La.Hk(f,l/2,-h,-g,l/2),La.$e(f));break;case "WIREFRAME":for(d=
b.d,b=b.n,f=0;f<b.length;f++)g=b[f],"WIREFRAME"==g.type&&(e||(g.mb&&(h=la.Ba(c,"GRASS_MAP"))&&ka(g,h,d),da.rb(g),Q(g)),a.p.push(H(d,g)),N(c,a,g),ha(g))}}function O(a,b,c,d,e,f){for(var g=b.d,h=b.n,l=0;l<h.length;l++){var D=h[l];D.hc||D.Mb||"MAIN"!=D.type&&"NODES"!=D.type&&"NODES_GLOW"!=D.type&&"PARTICLES"!=D.type||!("OPAQUE"==D.Ka&&"OPAQUE"==d||"BLEND"==D.Ka&&"BLEND"==d||"XRAY"==D.Ka&&"XRAY"==d||"NODES_GLOW"==D.type&&"GLOW"==d)||(f||(X(D,a,b,c,d,e),Z(e,D),da.rb(D),Q(D)),a.p.push(H(g,D)),N(c,a,D),
ha(D))}a.p.sort(function(a,b){var c;if(a.B&&b.B){c=a.B.Fa;var d=b.B.Fa;(c=c==d?0:c>d?1:-1)||(c=a.B.fg,d=b.B.fg,c=c==d?0:c>d?1:-1)}else c=0;return c})}function X(a,b,c,d,e,f){var g=c.d,h="NO_SHADOWS",l=la.Ba(d,"SHADOW_CAST");if(l&&a.Yb)switch(e){case "OPAQUE":h="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":h="SHADOW_MAPPING_BLEND";break;case "REFLECT":case "GLOW":h="NO_SHADOWS";break;default:throw"Wrong main subscene type";}e=a.pb;var D=f.d.wd;na.v(e,"SHADOW_USAGE",h);da.nl(a,D,l);h=b.eg;
na.v(e,"NUM_LIGHTS",h);na.v(e,"NUM_LFACTORS",0==h%2?h/2:Math.floor(h/2)+1);"special_skydome.glslf"==na.tq(e)&&na.v(e,"REFLECTION_PASS",0);na.v(e,"SSAO_ONLY",0);b.$a&&b.gd?na.v(e,"WATER_EFFECTS",1):na.v(e,"WATER_EFFECTS",0);b.$a&&b.Af&&g.Af?(na.v(e,"CAUSTICS",1),na.v(e,"CAUST_SCALE",b.pp),na.v(e,"CAUST_SPEED",na.t(b.qp,2)),na.v(e,"CAUST_BRIGHT",b.op)):na.v(e,"CAUSTICS",0);b.$a&&(na.v(e,"WAVES_HEIGHT",na.t(b.qf)),na.v(e,"WAVES_LENGTH",na.t(b.Bg)),na.v(e,"WATER_LEVEL",na.t(b.pf)));-1!==a.Gb.indexOf("u_mirrormap")?
na.v(e,"REFLECTION_TYPE","REFL_MIRRORMAP"):a.yc?null!=g.nc&&la.Ba(d,"MAIN_CUBE_REFLECT")?(c=f.d.zb?f.d.zb.Kj[c.d.nc]:null)?(c=c.i.eb,da.Hg(a,c,"u_cube_reflection"),na.v(e,"REFLECTION_TYPE","REFL_CUBE")):na.v(e,"REFLECTION_TYPE","REFL_NONE"):null!=g.vc&&la.Ba(d,"MAIN_PLANE_REFLECT")?(c=f.d.zb?f.d.zb.Ki[c.d.vc]:null)?(c=c.i.eb,da.Hg(a,c,"u_plane_reflection"),na.v(e,"REFLECTION_TYPE","REFL_PLANE")):na.v(e,"REFLECTION_TYPE","REFL_NONE"):na.v(e,"REFLECTION_TYPE","REFL_NONE"):na.v(e,"REFLECTION_TYPE","REFL_NONE");
(h=la.Ba(d,"SKY"))?a.Zr?(c=h.i.eb,da.Hg(a,c,"u_sky")):Ca.zk?(a.mc=h.mc,na.v(e,"PROCEDURAL_FOG",1)):na.v(e,"PROCEDURAL_FOG",0):na.v(e,"PROCEDURAL_FOG",0);c=f.d.vo;c.jo&&(na.v(e,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==c.em?(c=c.fm?da.Xx(c.fm,!1):h.i.eb,na.v(e,"SKY_TEXTURE",1),da.Hg(a,c,"u_sky_texture")):"SKY_COLOR"==c.em&&na.v(e,"SKY_COLOR",1));a.mb&&(c=la.Ba(d,"GRASS_MAP"))&&ka(a,c,g);a.Cn?(Ca.gi&&na.v(e,"USE_REFRACTION_CORRECTION",1),"NODES"==a.type||"NODES_GLOW"==a.type?(na.v(e,"REFRACTIVE",1),
f.d.fc?na.v(e,"USE_REFRACTION",1):na.v(e,"USE_REFRACTION",0)):f.d.fc?na.v(e,"REFRACTIVE",1):na.v(e,"REFRACTIVE",0)):(na.v(e,"REFRACTIVE",0),na.v(e,"USE_REFRACTION",0),na.v(e,"USE_REFRACTION_CORRECTION",0));a.of&&(Ca.shore_smoothing&&a.so&&la.Ba(d,"DEPTH")?na.v(e,"SHORE_SMOOTHING",1):na.v(e,"SHORE_SMOOTHING",0),a.water_dynamic&&b.$a&&b.qf?na.v(e,"DYNAMIC",1):na.v(e,"DYNAMIC",0));"PARTICLES"==a.type&&(na.v(e,"SIZE_RAMP_LENGTH",a.Qr),na.v(e,"COLOR_RAMP_LENGTH",a.Hr));if(!a.Jf)for(b=a.L,d=0;d<b.length;d++)if(c=
b[d],"SCENE"==c.source)for(g=0;g<Da.length;g++)for(h=Da[g],l=Da[g].jd,D=0;D<l.length;D++)l[D].d==c&&Ja.l(gb,h,f,null);if(a.dh){b=0;for(var k in a.dh)b++;a.Vm=new Float32Array(3*b);a.Tm=new Float32Array(3*b);a.Sm=new Float32Array(3*b);a.Um=new Float32Array(4*b);na.v(e,"NUM_LAMP_LIGHTS",b);for(d=0;d<f.va.LAMP.length;d++)aa(a,f.va.LAMP[d])}}function aa(a,b){var c=b.uuid;if(c in a.dh){c=a.dh[c];a.Vm.set(b.d.h,3*c);a.Tm.set(b.na.direction,3*c);a.Sm.set(b.na.Kg,3*c);var d=wa,e=b.na;d[0]=-1;d[1]=-1;d[2]=
-1;d[3]=e.lf?1:0;switch(e.type){case "POINT":d[2]=e.distance;break;case "SPOT":d[2]=e.distance;var f=d[0]=Math.cos(e.dd/2);d[1]=e.sg*(1-f)}a.Um.set(d,4*c)}}function Z(b,c){var d=ga(b,"LAMP",a.DATA_ID_ALL);c.pb.Zm=[];for(var e=ba(d)||d[0],f=0;f<d.length;f++){var g=d[f].na;if("AREA"!=g.type){if("SPOT"==g.type||"POINT"==g.type)var h=Math.cos(g.dd/2);if("SPOT"==g.type)var l=g.sg*(1-h);var D=g.index;c.pb.Zm.push({type:g.type,index:D,Yy:Math.floor(D/2),Xy:0==D%2?"rg":"ba",dd:h,sg:l,distance:g.distance,
Sy:g.wg||g.lf,Fx:D==e.na.index})}}}function Q(a){var b=a.Xb.attributes,c=a.R.Ub,d;for(d in b)c[d]||Ba.pa('missing data for "'+d+'" attribute');if("MAIN"==a.type||"NODES"==a.type||"NODES_GLOW"==a.type)if(b=na.sy(a.Xb.po),10<b&&("MAIN"==a.type&&Ea.warn("Varying limit exceeded for main shader - "+b+', materials: "'+a.Pc.join(", ")+'"'),"NODES"==a.type||"NODES_GLOW"==a.type))d=c=0,a.zg&&(c=Ba.qd(a.zg)),a.sb&&(d=Ba.qd(a.sb)),Ea.warn("Varying limit exceeded for node shader - "+b+", uv: "+c+", vc: "+d+', materials: "'+
a.Pc.join(", ")+'"')}function ha(a){8<a.L.length&&Ea.warn("too many textures used - "+a.L.length+' (max 8), materials "'+a.Pc.join(", ")+'"')}function ka(a,b,c){a.bc=b.bc;var d=b.bc[0],e=b.bc[1],f=b.bc[2];c=c.Pb;c=Math.max(c.max_x-c.min_x,c.max_z-c.min_z);f=0==f?c:Math.max(f,c);b.bc[2]=f;b=b.i;La.Hk(b,f/2,-e,-d,f/2);La.$e(b);d=a.Dm||0;d=0==d?c:Math.max(d,c);a.Dm=d}function qa(a){var b=V(a,"MAIN_OPAQUE"),c=!0;Ja.O(a.d.fb,function(d,e){"SHADOW_CAST"===e.type&&(w(e,b,e.p,a,c),c=!1)})}function w(b,c,
d,e,f){if(0!=d.length){var g=b.i;c=c.i;var h=ga(e,"LAMP",a.DATA_ID_ALL),h=ba(h)||h[0],l=h.d;La.ss(g,l.h,l.quat);Ga.copy(c.Le,g.Le);pb.copy(c.ma,g.vs);if("SPOT"==h.na.type||"POINT"==h.na.type)La.$e(g,g.wa);else{h=ca;Ya.Gd(h);for(l=0;l<d.length;l++){var D=d[l].td;0==l?Ya.Ep(D.bb,h):Ya.Wp(h,D.bb)}d=Ya.rx(h,xa);Ba.We(d,g.ma,d);if(e.d.wd.enable_csm){e=Ga.copy(c.ci[b.Sl],ya);h=pb.invert(c.ma,qb);Ba.We(e,h,e);Ba.We(e,g.ma,e);b=c.Tl[b.Sl];if(f)for(za=0,Aa=-Infinity,f=2;f<d.length;f+=3)za=Math.min(za,d[f]),
Aa=Math.max(Aa,d[f]);f=ca;f.max_x=e[0]+b;f.max_y=e[1]+b;f.max_z=Aa;f.min_x=e[0]-b;f.min_y=e[1]-b;f.min_z=za}else{b=f=ca;c=ic;c.set(d);e=Qa/9;d=pb.identity(qb);pb.rotate(d,e,Ba.AXIS_MZ,d);l=h=-1;for(D=0;10>D;D++){var k=Ya.Av(c,yb),m=(k.max_x-k.min_x)*(k.max_y-k.min_y);if(-1==h||m<h)h=m,l=D,Ya.Ep(k,b);Ba.We(c,d,c)}b=l*e;0<b&&(c=pb.identity(qb),pb.rotate(c,b,Ba.AXIS_MZ,c),pb.multiply(c,g.ma,g.ma));b=f.max_x-f.min_x;c=f.max_y-f.min_y;b&&c&&(e=Math.abs(b-c)/2,2<b/c?(f.max_y+=e,f.min_y-=e):2<c/b&&(f.max_x+=
e,f.min_x-=e));f.max_x+=.005;f.max_y+=.005;f.max_z+=.005;f.min_x-=.005;f.min_y-=.005;f.min_z-=.005}La.mA(g,f.min_x,f.max_x,f.min_y,f.max_y,-f.max_z,-f.min_z);La.$e(g)}Ba.jm(g.Ed,g.Qj)}}function ba(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.data.b4w_generate_shadows)return c}return!1}function ma(a,b,c){var d=b.d;b=b.n;for(var e=0;e<b.length;e++){var f=b[e];"COLOR_ID"==f.type&&("COLOR_PICKING"==a.type&&"COLOR_ID"==f.Ka||"COLOR_PICKING_XRAY"==a.type&&"COLOR_ID_XRAY"==f.Ka)&&(c||(da.ka(f,"USE_OUTLINE",
0),da.rb(f),Q(f)),a.p.push(H(d,f)))}}function W(a,b){for(var c=R(b,Lb),d=a.na,e=a.d,f=d.index,g=0;g<c.length;g++){var h=c[g];h.Xf.set(e.h,3*f);h.Vf.set(d.direction,3*f);h.Uf.set(d.Kg,3*f);switch(d.type){case "SUN":if(h.Us.set(e.quat),h.Ts=d.Kg,"SKY"===h.type){var l=ya;l[0]=l[1]=l[2]=1;var D=Math.acos(Ga.dot(h.Nk,l)),l=Math.acos(Ga.dot(d.direction,l));h.kk=Math.floor(D/.025)!=Math.floor(l/.025)?!0:!1;Ga.copy(d.direction,h.Nk);ia(b,h)}else Ga.copy(d.direction,h.Nk);case "HEMI":case "POINT":case "SPOT":break;
default:Ea.error("Unknown light type: "+d.type+'".')}D=ub;D[0]=d.wg?1:0;D[1]=d.lf?1:0;h.Wf.set(D,2*f);h.ja=!0;for(D=0;D<h.p.length;D++)l=h.p[D].B,l.dh&&aa(l,a)}}function ia(a,b){Fa.ii(b);if(b.kk)for(var c=R(a,["MAIN_OPAQUE","MAIN_BLEND","MAIN_XRAY","MAIN_GLOW"]),d=0;d<c.length;d++)for(var e=c[d].p,f=0;f<e.length;f++){var g=e[f];g.Xa&&(g=g.B,da.Ov(g)&&Fa.yB(g))}}function ga(b,c,d){if(!b.va)throw"Access to uninitialized scene";b=b.va[c];if(d==a.DATA_ID_ALL)return b;c=[];for(var e=0;e<b.length;e++){var f=
b[e];f.d.pc==d&&c.push(f)}return c}function pa(b){var c=[];b=ga(b,"MESH",a.DATA_ID_ALL);for(var d=0;d<b.length;d++)for(var e=b[d].data,f=0;f<e.materials.length;f++){var g=e.materials[f];-1==c.indexOf(g)&&c.push(g)}return c}function T(a,b,c){for(var d=a.d,e=a.camera.d.G,f=0;f<e.length;f++){var g=e[f];La.$e(g,b/c);d.Dn&&La.ho(g,d.wd)}d.Dn&&(d.lk=!0,V(a,"DEPTH").ja=!0,V(a,"MAIN_BLEND").ja=!0);var h=d.fb;la.rB(h,function(d,e,f){if(d.Ih){var g=d.ef*b,l=d.ef*c;if(e)for(e=0;e<f.fa.length;e++)f.fa[e]==d&&
$a.resize(d.ta,g,l);else switch($a.xi(d.ta)&&$a.resize(d.ta,g,l),d=f.i,d.width=g,d.height=l,f.type){case "DOF":ja(a,{dof_power:f.i.dof_power,dof_on:f.i.dof_on});break;case "GLOW_COMBINE":sa(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case "BLOOM":ra(a,{bloom_blur:f.bloom_blur});break;case "OUTLINE":f=la.Ga(h,f,"POSTPROCESSING");g=la.Ga(h,f,"POSTPROCESSING");l=la.Ga(h,g,"POSTPROCESSING");d=la.Ga(h,l,"POSTPROCESSING");la.zc(f,1/b,1/c);la.zc(g,
1/b,1/c);la.zc(l,1/b,1/c);la.zc(d,1/b,1/c);break;case "ANTIALIASING":case "SMAA_RESOLVE":case "SMAA_EDGE_DETECTION":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_NEIGHBORHOOD_BLENDING":case "SSAO":case "SSAO_BLUR":la.zc(f,1/b,1/c)}}})}function R(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];Ja.O(a.d.fb,function(a,b){b.type==e&&c.push(b)})}return c}function V(a,b){return la.Ba(a.d.fb,b)}function ja(a,b){var c=V(a,"DOF");if(!c)return Ea.error("DOF is not enabled on the scene. Check camera settings"),
0;var d=a.d.fb;"boolean"==typeof b.dof_on&&(c.i.dof_on=parseFloat(b.dof_on));"number"==typeof b.dof_distance&&(c.i.dof_distance=b.dof_distance);"number"==typeof b.dof_front&&(c.i.dof_front=b.dof_front);"number"==typeof b.dof_rear&&(c.i.dof_rear=b.dof_rear);if("number"==typeof b.dof_power){c.i.dof_power=b.dof_power;var e=la.Ga(d,c,"POSTPROCESSING"),d=la.Ga(d,e,"POSTPROCESSING");la.Nb(e,c.i.dof_power);la.zc(e,1/c.i.width,1/c.i.height);la.Nb(d,c.i.dof_power);la.zc(d,1/c.i.width,1/c.i.height)}c.ja=!0}
function ra(a,b){var c=V(a,"LUMINANCE_TRUNCED"),d=V(a,"BLOOM");if(!c||!d)return Ea.error("Bloom is not enabled on the scene"),0;"number"==typeof b.bloom_key&&(c.bloom_key=b.bloom_key,c.ja=!0);"number"==typeof b.bloom_edge_lum&&(c.bloom_edge_lum=b.bloom_edge_lum,c.ja=!0);if("number"==typeof b.bloom_blur){var e=a.d.fb,c=la.Ga(e,d,"BLOOM_BLUR"),e=la.Ga(e,c,"BLOOM_BLUR");d.bloom_blur=b.bloom_blur;la.Nb(c,b.bloom_blur);la.zc(c,1/d.i.width,1/d.i.height);la.Nb(e,b.bloom_blur);la.zc(e,1/d.i.width,1/d.i.height)}}
function sa(a,b){var c=V(a,"GLOW_COMBINE");if(!c)return Ea.error("Glow is not enabled on the scene"),null;for(var d=a.d.fb,e=la.uq(d,c),f=0;f<e.length;++f){var g=e[f];if("POSTPROCESSING"===g.type&&"GLOW_MASK_LARGE"===g.Ka)var h=g;if("POSTPROCESSING"===g.type&&"GLOW_MASK_SMALL"===g.Ka)var l=g}e=la.Ga(d,h,"POSTPROCESSING");d=la.Ga(d,l,"POSTPROCESSING");"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.ja=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=
b.large_glow_mask_coeff,c.ja=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,la.Nb(l,b.small_glow_mask_width),la.zc(l,1/c.i.width,1/c.i.height),l.ja=!0,la.Nb(d,b.small_glow_mask_width),la.zc(d,1/c.i.width,1/c.i.height),d.ja=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,la.Nb(h,b.large_glow_mask_width),la.zc(h,1/c.i.width,1/c.i.height),h.ja=!0,la.Nb(e,b.large_glow_mask_width),la.zc(e,1/c.i.width,1/c.i.height),
e.ja=!0)}function S(a,b){var c=V(Ra,"MAIN_OPAQUE");if(!c||!c.$a)return Ea.error("get_water_surface_level() - no water parameters on the scene"),0;var d=c.qf,e=c.Bg,f=c.pf,g=c.$a;if(!d||!g.Rg)return g.pf;var h=Ga.length(c.dj),l=c.time;h&&(l*=h);var D=ub;D[0]=20/e*(a-.25*l);D[1]=20/e*(b-.25*l);h=Ba.rp(D);D[0]=17/e*(b+.1*l);D[1]=17/e*(a+.1*l);var D=Ba.rp(D),h=h+D-1,k=g.dst_noise_scale0,D=g.dst_noise_scale1,m=g.dst_noise_freq0,n=g.dst_noise_freq1,U=ub;U[0]=k*(a+m*l);U[1]=k*(b+m*l);k=Ba.Mn(U);U[0]=D*(b-
n*l);U[1]=D*(a-n*l);D=Ba.Mn(U);D*=d*k;if(c.Vk)if(n=(a-c.bf[0])/c.cf[0],U=(c.bf[1]+b)/c.cf[1],n+=.5,U+=.5,1<n||0>n||1<U||0>U)d=D;else var n=Ba.oq(Ra.d.Hn,c.th,n,U),k=g.dir_freq,p=g.dir_noise_scale,r=g.dir_noise_freq,m=g.dir_min_noise_fac,U=g.dst_min_fac,c=e/c.hh/Math.PI,p=[p/e*(a+r*l),p/e*(b+r*l)],e=Math.sqrt(n),d=d*Math.max(n,g.dir_min_shore_fac)*Math.sin(e/c+k*l)*Math.max(Ba.Mn(p),m),g=Math.max(e,U),d=d*(1-g)+D*g,h=h*n;else d=D;return f+(d+.05*h)}function ea(a,b){a.vi&&"POSTPROCESSING"==a.type&&
b.Xa!=a.Xa&&(a.Xa=b.Xa);b.Xa||"OUTLINE"!=a.type||(a.cm=0)}function D(a,b,c,d){var e=Ja.Ya(a,b);La.Gk(e.i,c,d);e.ol=!0;Ja.kf(a,b,function(b,e,f){f.Ma&&f.M==c&&la.Wv(f)&&U(a,b,f.la,d)});Ja.te(a,b,function(b,e,f){f.Ma&&f.M==c&&f.M==f.la&&D(a,b,c,d)})}function U(a,b,c,d){a=Ja.Ya(a,b).p;for(b=0;b<a.length;b++)da.Vz(a[b].B,d,c)}function va(a){var b=V(a,"GRASS_MAP");if(b){var c=b.i,d=a.camera.d,e=d.h;a=ya;a[0]=0;a[1]=-b.bc[2]/2;a[2]=0;Ga.transformQuat(a,d.quat,a);a[0]+=e[0];a[1]=0;a[2]+=e[2];b=xb;b[0]=0;
b[1]=0;b[2]=0;b[3]=1;La.ss(c,a,b)}}function M(a,b){Ja.O(a,function(c,d){if("MOTION_BLUR"==d.type){if(!d.fa[0]||!d.Bd[0])throw"Wrong MOTION_BLUR subscene";var e=d.fa[0],f=d.Bd[0];d.Bd[0]=d.i.eb;Ja.kf(a,c,function(b,c,d){d.Ma&&U(a,b,d.la,f)});D(a,c,e.M,f);U(a,c,e.la,d.Bd[0]);d.rr=Math.exp(-b/d.mb_factor)}})}function Xb(b,c){var d=0,e=b.Ru;0==e.$n&&(e.$n=c);var f=c-e.$n;if(e.hs&&f/e.Qc>=e.hs)a.clear_outline_anim(b);else{f%=e.Qc;if(f<e.Cr)switch(e=f/(e.Cr/5),f=Math.floor(e),f){case 0:d=(e-f)/2;break;
case 1:d=(e-f)/2+.5;break;case 2:d=1;break;case 3:d=1-(e-f)/2;break;case 4:d=.5-(e-f)/2}b.d.$c=d}}function Y(a){Ja.O(a.d.fb,function(a,b){b.ja=!0})}function ua(a){if("WIND"==a.field.type){a=a.d;Ba.quat_to_dir(a.quat,Ba.AXIS_Y,Na);Ga.normalize(Na,Na);Ga.scale(Na,a.qm,Na);a=Da;for(var b=0;b<a.length;b++)for(var c=R(a[b],Jb),d=0;d<c.length;d++)c[d].dj.set(Na)}}function sb(a){var b=c();if(b=V(b,"OUTLINE"))b.Ue.set(a),b.ja=!0}var da=q("__batch"),Ya=q("__boundings"),La=q("__camera"),gc=q("__config"),Ha=
q("__container"),sc=q("__constraints"),Gb=q("__data"),Za=q("__debug"),hc=q("__geometry"),Ja=q("__graph"),Gc=q("__hud"),Hc=q("__nodemat"),tb=q("__objects");q("__particles");var nb=q("__physics"),Ib=q("__prerender"),Ic=q("__primitives"),Ea=q("__print"),Fa=q("__renderer"),la=q("__scenegraph"),Oc=q("__sfx"),na=q("__shaders"),$a=q("__textures"),Ba=q("__util"),Ga=q("vec3"),pb=q("mat4"),Ca=gc.o,ob=gc.Fb,Cb=gc.Nd,tc="ARMATURE CAMERA EMPTY LAMP MESH SPEAKER".split(" "),uc=["ARMATURE","EMPTY","MESH","SPEAKER"],
vc="GRASS_MAP SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY DEPTH OUTLINE_MASK WIREFRAME".split(" ");a.FC=vc;var Lb="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT GOD_RAYS GOD_RAYS_COMBINE SKY LUMINANCE_TRUNCED".split(" "),Kb="MAIN_OPAQUE SSAO MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),Jb="SHADOW_CAST MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT COLOR_PICKING COLOR_PICKING_XRAY DEPTH GOD_RAYS OUTLINE_MASK WIREFRAME".split(" "),
Sa="MAIN_OPAQUE MAIN_BLEND MAIN_XRAY MAIN_GLOW MAIN_PLANE_REFLECT MAIN_CUBE_REFLECT".split(" "),ab=0,vb=null,Ra=null,Da=[],gb=null,wb=[],Qa=Math.PI/2;a.sf=0;a.$k=1;a.al=2;a.DATA_ID_ALL=-1;var ub=new Float32Array(2),ya=new Float32Array(3);new Float32Array(4);var wa=new Float32Array(4),xb=new Float32Array(4),qb=new Float32Array(16),xa=new Float32Array(24),ic=new Float32Array(24),ca=Ya.Gd(),yb=Ya.Gd(),Na=new Float32Array(3),za=0,Aa=-Infinity;a.set_active=function(a){Ra=a;Oc.jA(a)};a.Gz=function(a,b){var c=
a.d,d=la.Ew(c.fb);if(a==b){T(a,Ha.uy(),Ha.ty());for(var e=0;e<d.length;e++)a.d.ng.push(d[e])}else for(e=a.jd[0],T(a,e.d.rg,e.d.rg),e=0;e<d.length;e++)b.d.ng.push(d[e]);d=R(a,Jb);for(e=0;e<d.length;e++)d[e].dj.set(Na);for(e=0;e<c.ng.length;e++)"SHADOW_CAST"==c.ng[e].type&&Fa.ii(c.ng[e])};a.Wg=b;a.lm=d;a.get_active=c;a.ha=function(){return Ra?!0:!1};a.Rj=function(a){return a.camera};a.ri=function(){return Da};a.ky=function(){if(1==Da.length)return Da;for(var a=0;a<Da.length;a++){var b=Da[a].d.fb;Ja.O(b,
function(b,c){for(var d=0;d<c.p.length;d++){for(var e=c.p[d].B.L,f=null,g=0;g<e.length;g++)if("SCENE"==e[g].source&&e[g].Nn==Da[a].name&&"COPY"!=c.type){Ea.error('Texture-scene loop detected. A scene is rendered to texture "'+e[g].name+'" yet this texture belongs to the same scene.');Ja.cg(gb,Da[a]);f=c.p[d].B;break}f&&(f.L=[],f.Gb=[],da.xB(f,null),da.rb(f))}})}for(var c=[],a=0;a<Da.length;a++)if(b=Da[a],!b.jd.length){b=Ja.cg(gb,b);Ja.lx(gb,b);b=Ja.Rs(gb,b,Ja.yo);b=Ja.bo(b);Ja.O(b,function(a,b){c.push(b)});
break}return c};a.rd=function(b,c,d,f){for(var g=Da,h=null,l=0;l<g.length;l++){var D=ga(g[l],"ALL",a.DATA_ID_ALL);switch(b){case a.sf:h=e(c,D,!1,d);break;case a.$k:h=null;(D=e(c,D,!1,f))&&D.dupli_group&&(h=e(d,D.dupli_group.objects,!0,f));break;case a.al:for(var h=null,k=0;k<c.length;k++)if((h=e(c[k],D,0!=k,d))&&h.dupli_group)D=h.dupli_group.objects;else break}if(h)break}return h};a.hv=function(a,b,c){for(var d in uc){var e=uc[d],f=g(a,e),h=b.d.Kh,l=!1;for(d=0;d<c.length;d++)if(l=!0,c[d].d&&c[d].d.Tf){for(var D=
0;D<h.length;D++)h[D]==c[d]&&(l=!1);l&&h.push(c[d])}e in b.va||(b.va[e]=[]);for(D=0;D<f.length;D++)Ba.is_armature(f[D])&&f[D].proxy||(b.va.ALL.push(f[D]),b.va[e].push(f[D]))}};a.bv=function(b,c){b.va={ALL:[]};for(var d in tc){var e=tc[d],f=g(b,e);b.va[e]=[];for(var D=0;D<f.length;D++)Ba.is_armature(f[D])&&f[D].proxy||(b.va.ALL.push(f[D]),b.va[e].push(f[D]))}b.jd=b.jd||[];b.d=b.d||{};b.ga=null;e=b.d;f=b.camera.d;d=b.b4w_shadow_settings;D=e.wd={};d.csm_resolution>Ca.Kb?(D.csm_resolution=Ca.Kb,Ea.error("Shadow map texture has unsupported size. Changed to "+
Ca.Kb+".")):D.csm_resolution=d.csm_resolution;D.self_shadow_polygon_offset=d.self_shadow_polygon_offset;D.self_shadow_normal_offset=d.self_shadow_normal_offset;D.enable_csm=d.b4w_enable_csm;var U=ga(b,"LAMP",a.DATA_ID_ALL);if(U=ba(U)||U[0])D.Wm=U.na.type,D.dd=U.na.dd,D.distance=U.na.distance,"SPOT"!=D.Wm&&"POINT"!=D.Wm||!D.enable_csm||(Ea.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),D.enable_csm=!1);D.enable_csm?(D.csm_num=d.csm_num,D.csm_first_cascade_border=
d.csm_first_cascade_border,D.first_cascade_blur_radius=d.first_cascade_blur_radius,D.csm_last_cascade_border=d.csm_last_cascade_border,D.last_cascade_blur_radius=d.last_cascade_blur_radius,D.fade_last_cascade=d.fade_last_cascade,D.blend_between_cascades=d.blend_between_cascades):(D.csm_num=1,D.csm_first_cascade_border=d.csm_first_cascade_border,D.first_cascade_blur_radius=d.first_cascade_blur_radius,D.csm_last_cascade_border=d.csm_last_cascade_border,D.last_cascade_blur_radius=d.last_cascade_blur_radius,
D.fade_last_cascade=!1,D.blend_between_cascades=!1);e.Kh=[];for(d=0;d<c.length;d++)c[d].d&&c[d].d.Tf&&e.Kh.push(c[d]);D=b.world.b4w_fog_color;U=b.world.b4w_fog_density;d=r(b);e.$b=new Float32Array([D[0],D[1],D[2],U]);e.tg=p(b);e.Lk=y(b,e.tg);e.vo=A(b,e.Lk);e.dr=ga(b,"LAMP",a.DATA_ID_ALL).length;e.$a=m(b);e.fz=d;e.ve=P(b);e.Vu=z(b);e.yr=0;f.G[0].type!=La.Hb&&Ca.anaglyph_use?(Ea.warn("Anaglyph stereo is disabled for the non-perspective camera"),D=!1):D=Ca.anaglyph_use;e.anaglyph_use=D;e.Dn=Ca.gi&&h(b);
e.zD=b.world.b4w_fog_color;e.shore_smoothing=l(b);e.zb=n(b);e.Ev=E(b);e.iz=x(b);e.Mv=u(b);e.xy=B(b);e.vz=t(b);e.Me=G(b);e.Qg=Ca.Qg&&(0<f.dof_distance||f.Yd);e.mb=k(b);e.jh=Ca.jh&&b.b4w_enable_motion_blur;e.Mg=Ca.Mg&&b.b4w_enable_color_correction;e.antialiasing=Ca.antialiasing&&b.b4w_enable_antialiasing;e.Ig=Ca.Ig&&b.b4w_enable_bloom&&e.tg;e.ff=Ca.ff&&b.b4w_enable_ssao;e.YA=v(b);e.Xg=Ca.Xg&&b.b4w_enable_god_rays&&e.tg;e.fc=J(b,d);e.bx=Ca.gi;e.cw=I(b);e.outline=F(b);e.ee=L(b);e.Cm=b.world.b4w_render_glow_over_blend;
d=b.jd.sort(function(a,b){return b.d.rg-a.d.rg});e.fb=la.Dw(e,f,d);e.ng=[];e.lk=!1;e.ln=!1;Da.push(b);gb||(gb=Ja.create());Ja.s(gb,b)};a.Ml=g;a.zm=function(a){return a.d.fb};a.Gx=function(a){Ja.O(a,function(b,c){var d=null;switch(c.type){case "POSTPROCESSING":d=da.Ip(c.yk);break;case "SSAO":d=da.Kw(c);break;case "SSAO_BLUR":d=da.Lw(c);break;case "DEPTH_PACK":d=da.tw();break;case "REFRACT":case "COPY":d=da.Ip("NONE");break;case "GOD_RAYS":la.Ga(a,c,"WIREFRAME")||la.Ga(a,c,"MAIN_BLEND")||la.Ga(a,c,
"GOD_RAYS");d=da.xw(c.Rr,c.of,c.Bh);break;case "GOD_RAYS_COMBINE":la.Ga(a,c,"WIREFRAME")||la.Ga(a,c,"MAIN_BLEND");la.Ga(a,c,"GOD_RAYS");d=da.yw();break;case "MOTION_BLUR":d=da.Bw();break;case "DOF":var d=da.uw(),e=la.Ga(a,c,"POSTPROCESSING"),f=la.Ga(a,e,"POSTPROCESSING");la.Nb(e,c.i.dof_power);la.Nb(f,c.i.dof_power);break;case "OUTLINE":var d=da.Cw(),e=la.Ga(a,c,"POSTPROCESSING"),f=la.Ga(a,e,"POSTPROCESSING"),g=la.Ga(a,f,"POSTPROCESSING"),h=la.Ga(a,g,"POSTPROCESSING");la.Nb(f,c.vl);la.Nb(e,c.vl);
la.Nb(h,c.im*c.Fi);la.Nb(g,c.im*c.Fi);break;case "GLOW_COMBINE":d=da.ww();break;case "COMPOSITING":d=da.rw();break;case "ANTIALIASING":d=da.nw();break;case "SMAA_RESOLVE":case "SMAA_EDGE_DETECTION":case "SMAA_BLENDING_WEIGHT_CALCULATION":case "SMAA_NEIGHBORHOOD_BLENDING":d=da.Iw(c.type);break;case "ANAGLYPH":d=da.lw();break;case "SKY":d=da.Hw();break;case "LUMINANCE":d=da.zw();break;case "AVERAGE_LUMINANCE":d=da.ow();break;case "LUMINANCE_TRUNCED":d=da.Aw();break;case "BLOOM_BLUR":d=da.pw();break;
case "BLOOM":d=la.Ga(a,c,"BLOOM_BLUR");e=la.Ga(a,d,"BLOOM_BLUR");la.Nb(d,c.bloom_blur);la.Nb(e,c.bloom_blur);d=da.qw();break;case "VELOCITY":d=da.Ow();break;case "ANCHOR_VISIBILITY":d=da.mw()}d&&(e=H(tb.Ij("NONE"),d),Q(d),c.p.push(e),N(a,c,d),ha(d))})};a.append_object=function(a,b,c){switch(b.type){case "MESH":var d=a.d.fb,e=b.d;!la.Ba(d,"SHADOW_CAST")&&e.Yb&&(e.Yb=!1);e=R(a,vc);c&&(nb.has_physics(b)&&nb.append_object(b,a),a.va.ALL.push(b),a.va[b.type].push(b),b.za&&b.za.dupli_group.objects&&(b.origin_name=
b.name,b.za.dupli_group.objects.push(b)));for(var f=0;f<e.length;f++)K(e[f],b,d,a,c);break;case "LAMP":b.na.index=a.d.yr++;c=R(a,Lb);for(d=0;d<c.length;d++)c[d].eg++;W(b,a)}};a.remove_object=function(a){if(!a.d.Pm)return!1;var b=c();Gb.Fz(b,a,!1);var d=b.va.ALL.indexOf(a);-1!=d&&b.va.ALL.splice(d,1);d=b.va[a.type].indexOf(a);-1!=d&&b.va[a.type].splice(d,1);a.za&&a.za.dupli_group.objects&&(d=a.za.dupli_group.objects.indexOf(a),-1!=d&&a.za.dupli_group.objects.splice(d,1));sc.Rv(a)&&sc.remove(a);return!0};
a.LC=K;a.Fn=function(a){a.d.lk=!0};a.by=function(a,b){for(var c=a.d.wd,d=new Float32Array(c.csm_num),e=0;e<c.csm_num;e++)d[e]=La.Qw(c,b,e);return d};a.hide_object=function(a){a.d.Zg=!0};a.show_object=function(a){a.d.Zg=!1};a.is_hidden=function(a){return a.d.Zg};a.Pz=function(a,b,c){b=b.d;a=R(a,vc);for(var d=0;d<a.length;d++)for(var e=a[d].p,f=e.length-1;0<=f;f--){var g=e[f];g.td==b&&(g.B&&c&&hc.xp(g.B.R),e.splice(f,1))}};a.check_object=function(a,b){return b.va[a.type]&&-1<b.va[a.type].indexOf(a)?
!0:!1};a.LA=function(a){var b=a.va.LAMP;if(b.length==a.d.yr){for(var c=[],d=0;d<b.length;d++)c[b[d].na.index]=d;for(d=0;d<c.length-1;d++)for(var e=d+1;e<c.length;e++){var f=b[c[d]].na,g=b[c[e]].na;if(g.wg&&g.lf&&(!f.wg||!f.lf)||!f.wg&&(g.wg||!f.lf&&g.lf))f=c[d],c[d]=c[e],c[e]=f}for(d=0;d<c.length;d++)b[c[d]].na.index=d,W(b[c[d]],a)}};a.ug=W;a.cleanup=function(){for(var a=0;a<Da.length;a++){var b=Da[a];Ja.O(b.d.fb,function(a,b){if("SINK"!=b.type){var c=b.i;Fa.Sz(c.be,c.eb,c.Lc,c.width,c.height);for(var c=
b.p,d=0;d<c.length;d++){var e=c[d].B;e&&da.bw(e)}}});b.d.fb=[];b.d.ng=[]}Ra=vb=null;Da.length=0;gb=null;wb.length=0;Na[0]=0;Na[1]=0;Na[2]=0};a.nr=function(a,b,c){a=La.sx(a,a.Qa,a.Pa,null,!0);var d=Ic.Lx(a);a=tb.Ij("DYNAMIC");a.bb=a.Pb={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.vb=a.Vc=Ya.Cv();var e=a.vb.Da;a.zf=a.yf=Ya.Ql([e,0,0],[0,e,0],[0,0,e],a.vb.F);c=da.Gw(d,c);b.p.push(H(a,c))};a.Ia=ga;a.PD=function(a){return[a.frame_start,a.frame_end]};a.ts=function(a,b,c){Ha.CA(a,
b,c);Ra&&T(Ra,a,b)};a.fB=R;a.ca=V;a.get_environment_colors=function(a){a=R(a,Lb)[0];var b=a.Ne,c=a.rf,d=[],e=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];e[0]=c[0];e[1]=c[1];e[2]=c[2];return[a.Ke,d,e]};a.set_environment_colors=function(a,b,c,d){a=R(a,Lb);for(var e=0;e<a.length;e++){var f=a[e];isNaN(b)||(f.Ke=b);c&&f.Ne.set(c);d&&f.rf.set(d);f.ja=!0}};a.get_sky_params=function(a){if(a=V(a,"SKY")){var b={};b.color=Array(3);Ga.copy(a.uh,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=
a.use_as_environment_lighting;b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.set_sky_params=function(a,b){var c=V(a,"SKY");c&&("number"==typeof b.procedural_skydome&&
(c.procedural_skydome=b.procedural_skydome),"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.uh.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),
"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.ja=!0,c.kk=!0,ia(a,c))};a.get_fog_color_density=function(a,b){var c=b||[],d=R(a,Kb)[0].$b;
c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.set_fog_color_density=function(a,b){for(var c=R(a,Kb),d=0;d<c.length;d++){var e=c[d];e.$b.set(b);e.ja=!0}};a.get_ssao_params=function(a){var b=V(a,"SSAO");a=V(a,"SSAO_BLUR");if(!b)return null;var c=b.p[0].B,d={};d.ssao_quality=da.wb(c,"SSAO_QUALITY")[1];d.ssao_hemisphere=b.ssao_hemisphere;d.ssao_blur_depth=a.ssao_blur_depth;d.hp=a.ssao_blur_discard_value;d.radius_increase=b.yh;d.influence=b.xh;d.dist_factor=b.wh;d.ssao_only=b.ssao_only;d.ssao_white=
da.wb(c,"SSAO_WHITE")[1];return d};a.set_ssao_params=function(a,b){var c=V(a,"SSAO"),d=V(a,"SSAO_BLUR");if(!c)return Ea.error("SSAO is not enabled on the scene"),0;if("string"==typeof b.ssao_quality){var e=c.p[0].B;da.ka(e,"SSAO_QUALITY",b.ssao_quality);da.rb(e,!0)}"number"==typeof b.ssao_hemisphere&&(e=c.p[0].B,da.ka(e,"SSAO_HEMISPHERE",b.ssao_hemisphere),da.rb(e,!0));"number"==typeof b.ssao_blur_depth&&(e=d.p[0].B,da.ka(e,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),da.rb(e,!0));"number"==typeof b.ssao_blur_discard_value&&
(d.ssao_blur_discard_value=b.ssao_blur_discard_value);"number"==typeof b.yh&&(c.yh=b.yh);"number"==typeof b.xh&&(c.xh=b.xh);"number"==typeof b.wh&&(c.wh=b.wh);if("number"==typeof b.ssao_only){c=V(a,"MAIN_OPAQUE");c.ssao_only=b.ssao_only;for(var f=0;f<c.p.length;f++)e=c.p[f].B,da.ka(e,"SSAO_ONLY",b.ssao_only),da.rb(e,!0)}"number"==typeof b.ssao_white&&(e=c.p[0].B,da.ka(e,"SSAO_WHITE",b.ssao_white),da.rb(e,!0));c.ja=!0;d.ja=!0};a.get_dof_params=function(a){a=V(a,"DOF");if(!a)return null;var b={};b.dof_distance=
a.i.dof_distance;b.dof_front=a.i.dof_front;b.dof_rear=a.i.dof_rear;b.dof_power=a.i.dof_power;b.Yd=a.i.Yd;return b};a.set_dof_params=ja;a.get_god_rays_params=function(a){var b=R(a,["GOD_RAYS"]);a=V(a,"GOD_RAYS_COMBINE");if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].gh;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=da.wb(b[0].p[0].B,"STEPS_PER_PASS")[1];return c};a.set_god_rays_params=function(a,b){var c=R(a,["GOD_RAYS"]),d=V(a,"GOD_RAYS_COMBINE");if(!c||!d)return Ea.error("God Rays are not enabled on the scene"),
0;"number"==typeof b.god_rays_intensity&&(d.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var e=b.god_rays_max_ray_length,f=0;f<c.length;f++)c[f].gh=e,c[f].Ck=e/c[f].Bh/(f+1),c[f].ja=!0;if("number"==typeof b.god_rays_steps)for(var g=na.t(b.god_rays_steps,1),e=c[0].gh,f=0;f<c.length;f++){c[f].Bh=g;c[f].Ck=e/g/(f+1);c[f].ja=!0;var h=c[f].p[0].B;da.ka(h,"STEPS_PER_PASS",g);da.rb(h,!0)}d.ja=!0};a.get_bloom_params=function(a){var b=V(a,"LUMINANCE_TRUNCED");
a=V(a,"BLOOM");if(!b||!a)return null;var c={};c.bloom_key=b.bloom_key;c.bloom_edge_lum=b.bloom_edge_lum;c.bloom_blur=a.bloom_blur;return c};a.set_bloom_params=ra;a.get_glow_material_params=function(a){a=V(a,"GLOW_COMBINE");if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.set_glow_material_params=sa;a.get_wind_params=function(){var a=
Na,b=Ga.length(a);if(0==b)return null;var c={};c.wind_dir=180*Math.atan(a[0]/a[2])/Math.PI;c.wind_strength=b;return c};a.set_wind_params=function(b,c){for(var d=ga(b,"ALL",a.DATA_ID_ALL),e=0;e<d.length;e++){var f=d[e];if("EMPTY"===f.type&&f.field&&"WIND"===f.field.type)var g=f}if(!g)return Ea.error("There is no wind on the scene"),0;d=g.d;"number"==typeof c.wind_dir&&(ya=[0,c.wind_dir/180*Math.PI,-Math.PI/2],Ba.euler_to_quat(ya,xb),d.quat.set(xb),ua(g));"number"==typeof c.wind_strength&&(d.qm=c.wind_strength,
ua(g));Y(b)};a.eA=function(a){a.d.ln=!0};a.get_water_surface_level=S;a.get_water_mat_params=function(a,b){var c=V(a,"MAIN_OPAQUE");if(c&&(b.waves_height=c.qf,b.waves_length=c.Bg,c.gd)){b.water_fog_density=c.gd[3];var d=b.water_fog_color=[];d[0]=c.gd[0];d[1]=c.gd[1];d[2]=c.gd[2]}};a.set_water_params=function(a,b){var c=V(a,"MAIN_OPAQUE");if(!c||!c.$a)return Ea.error("set_water_params() - no water parameters on the scene"),null;c=c.$a;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);
"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);
"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.Rg=b.water_dynamic);for(var d=R(a,Sa),e=0;e<d.length;e++){var f=d[e];"number"==typeof b.water_fog_density&&c.$b&&(f.gd[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.$b&&f.gd.set(b.water_fog_color);"number"==typeof b.waves_height&&(f.qf=b.waves_height);
"number"==typeof b.waves_length&&(f.Bg=b.waves_length);f.ja=!0}};a.get_shore_dist=function(a,b){var c=V(Ra,"MAIN_OPAQUE");if(!c.Vk)return 100;var d=c.hh,e=c.pf,f=(a[0]-c.bf[0])/c.cf[0],g=(c.bf[1]+a[2])/c.cf[1],f=f+.5,g=g+.5;if(1<f||0>f||1<g||0>g)e=1;else return c=d*Ba.oq(Ra.d.Hn,c.th,f,g),e=(e-a[1])*b,e=Math.sqrt(c*c+e*e)};a.update=function(a,b){for(var d=c().camera.d,e=0;e<Da.length;e++){var f=Da[e],g=f.d.fb;if(f.d.$a)var h=d.h[1]-S(d.h[0],d.h[2]);for(var l=f.d.Kh,D=0;D<l.length;D++){var k=l[D].d,
m=k.La,n=k.Ug+k.ra;if(m){var U=Math.round(m.currentTime*k.ac),p=k.ra/k.ac;if(U<k.ra-(Ca.Sf?5:0)||l[D].d.vg&&U>n)m.currentTime=p;!k.vg&&U>n&&m.pause();2<=m.readyState&&!m.paused&&$a.PB(k)}else if(k.qh){m=Math.min(k.qh.length,k.Ug+k.ra);if(k.ne<k.ra||k.vg&&k.ne>=m)k.ne=k.ra;!k.vg&&k.ne>=m&&(k.rh=!1);m=Math.round(a*Cb.Ha/k.ac)*k.os;m!=ab&&k.rh&&($a.MB(k),k.ne++);ab=m}}Ja.O(g,function(b,c){-1<Jb.indexOf(c.type)&&(c.time=a);f.d.$a&&(c.Dl=h)})}for(e=0;e<Da.length;e++)if(f=Da[e],D=f.d,d=D.ng,D.lk&&(qa(f),
D.lk=!1),D.ln&&(va(f),D.ln=!1),d.length){f.b4w_enable_motion_blur&&M(D.fb,b);if(D.outline){for(var r=0,e=0;e<f.va.MESH.length;e++)D=f.va.MESH[e],r+=D.d.$c,-1!=wb.indexOf(D)&&Xb(D,a);Ja.O(f.d.fb,function(a,b){"OUTLINE"===b.type&&(b.cm=r)})}g=null;for(D=0;D<d.length;D++)"OUTLINE_MASK"==d[D].type&&(g=D);for(D=0;D<d.length;D++)l=d[D],Ib.vn(l),null!==g&&ea(l,d[g]),Fa.ii(l)}Ca.show_hud_debug_info&&Gc.GA(Da,b)};a.xm=function(a){var b=[];Ja.O(a.d.fb,function(a,c){b.push(c)});return b};a.apply_outline_anim=
function(a,b,c,d){a.Ru={$n:0,Cr:b,Qc:c,hs:d};-1==wb.indexOf(a)&&wb.push(a)};a.clear_outline_anim=function(a){a.d.$c=0;a=wb.indexOf(a);-1!=a&&wb.splice(a,1)};a.dD=function(){wb=[]};a.get_cam_water_depth=function(){var a=V(Ra,"MAIN_BLEND"),b=Ra;return a||b.d.$a?a.Dl:null};a.get_object_data_id=function(a){return a.d.pc};a.gt=Y;a.AA=function(a,b){switch(b){case "WM_NONE":a.Xa=!1;break;case "WM_OPAQUE_WIREFRAME":case "WM_TRANSPARENT_WIREFRAME":case "WM_FRONT_BACK_VIEW":case "WM_DEBUG_SPHERES":for(var c=
0;c<a.p.length;c++)a.p[c].B.wireframe_mode=Za.Go[b];a.Xa=!0}a.Fa="WM_TRANSPARENT_WIREFRAME"==b;a.ja=!0};a.zA=function(a,b){for(var c=0;c<a.p.length;c++)a.p[c].B.wireframe_edge_color=b,a.ja=!0};a.Po=function(a,b){for(var c=0;c<b.length;c++)a.va.ALL.push(b[c]),a.va.MESH.push(b[c])};a.dt=ua;a.pick_object=function(c,d){var e=b();if(!e)return Ea.error("No active scene"),null;var f=V(e,"COLOR_PICKING");if(f){var g=Ha.El(c,d,ub,f.i);Ib.vn(f);Fa.ii(f);var h=V(e,"COLOR_PICKING_XRAY");h?(Ib.vn(h),Fa.ii(h),
f=h.i):f=f.i;g[1]=f.height-g[1];h=Fa.fs(f.be,g[0],g[1]);g=ga(e,"MESH",a.DATA_ID_ALL);for(f=0;f<g.length;f++){var l=g[f].d,D=l.Gj;if(D&&3>Math.abs(255*D[0]-h[0])&&3>Math.abs(255*D[1]-h[1])&&3>Math.abs(255*D[2]-h[2]))return l.Fb&&l.Br&&(ob.outlining_overview_mode?(sb(ob.Ue),l.$c=ob.$c,a.apply_outline_anim(g[f],ob.pk,ob.qk,ob.rk)):(sb(e.b4w_outline_color),l.$c=e.b4w_outline_factor,e=l.Ei,a.apply_outline_anim(g[f],e.pk,e.qk,e.rk))),g[f]}}else Ea.error("Object Selection is not available on the scene");
return null};a.set_outline_color=sb;a.wy=function(){return Na};a.my=function(b){var c=[];b=ga(b,"MESH",a.DATA_ID_ALL);for(var d=0;d<b.length;d++){var e=b[d];e.d.qg&&c.push(e)}return c};a.get_meta_tags=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.uB=function(){for(var b=Ra,c=ga(b,"MESH",a.DATA_ID_ALL),d=0;d<c.length;d++)for(var e=c[d].n,f=0;f<e.length;f++){var g=e[f];if("MAIN"==g.type||"NODES"==g.type)Z(b,g),da.rb(g)}};
a.ct=function(a,b){var c=b.d.vb.F,d=a.d.zb?a.d.zb.Kj[b.d.nc]:null;if(d){var e=ya;Ga.negate(c,e);for(c=0;6>c;c++){var f=d.di[c],g=d.Ul[c],h=d.i;pb.translate(Ba.zt[c],e,f);pb.multiply(h.sa,f,h.Ed);Ba.jm(h.Ed,g)}}};a.wv=function(a,b){b.d.zb&&(a.d.ec=b.d.zb.Ki[a.d.vc].i.ec)};a.ft=function(a,b){var c=b.d.zb.Dk[a],d=b.d.zb.Ki[a].i;Ba.pB(c.d.h,c.d.quat,Ba.AXIS_Y,d.ec);La.yA(d,b.camera)};a.marker_frame=function(a,b){return a.timeline_markers[b]}};b4w.module.__physics=function(a,q){function b(a,c){for(var d=a.Ic,e=0;e<d.length;e++)d[e].d.Tk&&c.push(d[e]),b(d[e],c)}function d(a,b){for(var c=a.m.p,d=0;d<c.length;d++)for(var e=c[d].Sa,f=0;f<e.Zb.length;f++){var g=e.Zb[f];"ANY"!=g.Na&&b!=g.Na||x(g)}}function c(a,b){if(ba)switch(a){case z.It:ba.m.vt=!0;z.C(z.ou,Date.now()-performance.now(),ha.Zc,ha.Bl?ka.gq:0);break;case z.Jt:J.$y("URANIUM:",b.slice(1));break;case z.Et:J.error(b);break;case z.Ft:P.fbmsg.apply(this,b.slice(1));break;case z.Ot:var c=
e(b.body_id);if(c){var d=b.trans,f=b.quat,h=b.linvel,l=b.angvel,c=c.m;c.Vl=b.time;K.set_sep(d,1,f,c.Wl);aa.copy(h,c.jr);aa.copy(l,c.Qo)}break;case z.Lt:(d=e(b.chassis_hull_body_id))&&K.set_sep(b.trans,1,b.quat,d.k.Ni[b.prop_ind]);break;case z.Gt:if(f=e(b[1]))d=b[4],f=f.Jc.yj[b[2]],H.set_translation(f,b[3]),H.set_rotation(f,d),H.u(f);break;case z.Pt:if(c=e(b[1]))c.k.speed=b[2];break;case z.At:g(ba,b.body_id_a|0,b.body_id_b|0,b.result,null,null,0);break;case z.Ct:g(ba,b.body_id_a|0,b.body_id_b|0,b.result,
b.coll_point,b.coll_norm,b.coll_dist);break;case z.Bt:if(c=e(b[1]))d=c.m,d.Ef&&d.Ef(b[2]);break;case z.Bo:case z.Mt:if(d=ba.m.nh[b.id])if(f=e(b.body_id_hit),a==z.Bo)h=d.callback,h(d.id,b.hit_fract,f,b.hit_time);else{var h=b.hit_fract,l=b.hit_time,c=b.hit_pos,k=d.callback;c?k(d.id,h,f,l,c,b.hit_norm):k(d.id,h,f,l)}break;case z.Nt:t(id);break;case z.Kt:console.log("Physics message ping: ",performance.now()-b[1]);break;case z.Ht:qa=b[1];break;case z.Dt:console.log(b[1]);break;default:J.error("Wrong message: "+
a)}}function e(a){return ma[a]||null}function g(a,b,c,d,f,g,h){a=a.m.p;for(var l=0;l<a.length;l++)for(var k=a[l].Sa,m=0;m<k.Zb.length;m++){for(var n=k.Zb[m],p=n.Ve,r=!1,t=0;t<p.length;t++){var y=p[t];if(y[0]===b&&y[1]===c){n.tk[t]=d;r=!0;break}}if(r){r=n.tk;for(t=p=0;t<r.length;t++)p=p||r[t];f&&n.wl!=b&&(t=f,r=g,y=h,t[0]+=r[0]*y,t[1]+=r[1]*y,t[2]+=r[2]*y,r[0]*=-1,r[1]*=-1,r[2]*=-1);n.callback(p,p?n.wl==b?e(c):e(b):null,f,g,h)}}}function f(){ga.body++;return ga.body}function h(a){if("ANY"==a)return 0;
var b=ia.indexOf(a);return-1==b?(ia.push(a),ia.length-1):b}function p(a){return{S:a,en:0,dk:!1,df:!0,iE:!1,is_character:!1,Ny:!1,Hj:null,Na:"",$h:0,gD:{},Zb:[],Ef:null,Vl:0,Wl:new Float32Array([0,0,0,1,0,0,0,1]),jr:new Float32Array(3),Qo:new Float32Array(3),Cj:new Float32Array(3),Bj:new Float32Array(4)}}function l(a,b){switch(a){case "BOX":var c=b.Pb;break;case "CYLINDER":c=b.sl;break;case "CONE":c=b.rl;break;case "SPHERE":c=b.Vc;break;case "CAPSULE":c=b.ql}return c}function m(a){if(!a)return null;
var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.F&&(b.center=a.F);"number"===typeof a.Da&&(b.radius=a.Da);"number"===typeof a.height&&(b.height=a.height);return b}function r(a,b,c,d){var e=a.d.h,f=b.d.T,g=new Float32Array(16);Q.invert(f,g);f=new Float32Array(3);
aa.transformMat4(e,g,f);switch(b.k.type){case 10:b=b.b4w_vehicle_settings;a=a.d.Pb;z.C(z.St,c,f,b.suspension_rest_length,b.roll_influence,(a.max_y-a.min_y)/2,d);break;case 20:z.C(z.Rt,c,f,a.ME)}}function n(a){return a.m&&a.m.Hj?!0:!1}function y(a,b,c,d,e,f,g,h,l,k){var m;ga.Dp++;m=ga.Dp.toString(16);z.C(z.Zt,m,a,h,b.m.S,c,d,e.m.S,f,g,l,k);b.m.Hj=m}function v(a){var b=a.m;if(b&&(0===b.en||!0===b.dk||!1===b.df||"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type)&&(a.d.h[0]!=a.m.Cj[0]||a.d.h[1]!=a.m.Cj[1]||a.d.h[2]!=
a.m.Cj[2]||a.d.quat[0]!=a.m.Bj[0]||a.d.quat[1]!=a.m.Bj[1]||a.d.quat[2]!=a.m.Bj[2])){a.m.Cj.set(a.d.h);a.m.Bj.set(a.d.quat);var b=a.m,c=z.wq(z.kj);c.body_id=a.m.S;c.trans=a.d.h;"DYNAMIC"===b.type?(c.quat=T,Z.identity(T)):c.quat=a.d.quat;z.C(z.kj,c)}a=a.Ic;for(b=0;b<a.length;b++)v(a[b])}function E(a,b,c,d,e){e=e||new Float32Array(3);a=a.d.quat;e[0]=b;e[1]=c;e[2]=d;aa.transformQuat(e,a,e)}function x(a){var b=a.Ve,c=a.tk,d=a.wl,e=[],f=a.Na,g=ba;if(!e)throw"At least one destination required";for(var h=
0;h<g.m.p.length;h++){var l=g.m.p[h];if("ANY"==f||l.Sa.Na==f)l=l.Sa.S,e&&-1==e.indexOf(l)&&e.push(l)}for(f=0;f<e.length;f++)g=e[f],d<g&&!u(b,d,g)?(b.push([d,g]),c.push(0)):d>g&&!u(b,g,d)&&(b.push([g,d]),c.push(0));z.C(z.Qt,d);z.C(z.Yt,b,a.ld)}function u(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function B(a){a.m&&a.m.Ef&&(a=a.m,z.C(z.ku,a.S),a.Ef=null)}function t(a){var b=ba.m;b.nh[a]&&(delete b.nh[a],b.Bn.splice(b.Bn.indexOf,1),z.C(z.su,a))}function G(a,b){if(b.Ah){var c=
a.m.S,d=b.Sg*b.fq,e=b.Yh*b.jp,f=-b.zh*b.Sn*2*Math.PI/b.Ns;b.Tq&&(f*=-1);switch(b.type){case 10:z.C(z.Fu,c,d,e,f);break;case 20:z.C(z.Eu,c,d,e,f)}}}function A(a){return a.b4w_vehicle&&"CHASSIS"==a.b4w_vehicle_settings.part?!0:!1}function k(a){return a.b4w_vehicle&&"HULL"==a.b4w_vehicle_settings.part?!0:!1}function I(a){return a.b4w_character?!0:!1}function F(a){return a.b4w_floating&&"MAIN_BODY"==a.b4w_floating_settings.part?!0:!1}var L=q("__config");q("__constraints");var J=q("__print"),P=q("__debug"),
z=q("__ipc");q("__renderer");var N=q("__scenes"),H=q("__transform"),K=q("__tsr"),O=q("__util"),X=q("__version"),aa=q("vec3"),Z=q("quat"),Q=q("mat4"),ha=L.Sa,ka=L.o,qa=0,w=null,ba=null,ma={},W=[],ia=[],ga={body:0,Dp:0,cs:0},pa=new Float32Array(3),T=new Float32Array(4),R=new Float32Array(4),V=new Float32Array(16),ja=new Float32Array(8),ra=new Float32Array(8);a.Hy=function(a){if(ba)J.warn("Multiple physics scenes are currently not supported");else{a.m={vt:!1,p:[],nh:{},Bn:[]};var b=ha.$i+X.timestamp();
J.log("%cLOAD PHYSICS","color: #0a0",b,"Max FPS: "+ha.Zc);w=new Worker(b);z.init(w,c);ba=a}};a.Xv=function(a){return a.m?a.m.vt:!0};a.cleanup=function(){if(ba){w.terminate();ba=w=null;ma={};W.length=0;ia.length=0;for(var a in ga)ga[a]=0}};a.append_object=function(a,c){var e=a.d;if(!e)throw"No object render: "+a.name;if(a.parent&&e.Tk)return null;var g=[];e.Tk&&b(a,g);var U=c.m.p;if(A(a)||k(a)||I(a)||F(a)||a.b4w_collision){var t,q=a,v=e.Vr,u=q.d,T=q.game,w=f();if("CAMERA"==q.type)var H=T.use_collision_bounds?
T.collision_bounds_type:"BOX",x=l(H,u),E=u.oi,B=u.ji,E=.5,B=0;else"EMPTY"==q.type?(H="EMPTY",x=null,B=E=0):(H=T.use_collision_bounds?T.collision_bounds_type:"BOX",x=l(H,u),E=u.oi,B=u.ji);var K=u.h,ja=u.quat,L=T.use_ghost,ra=T.use_sleep,X=T.mass,P=T.velocity_min,ha=T.velocity_max,ga=T.damping,ia=T.rotation_damping,nb=q.b4w_collision_id,ka=h(nb),pa=T.collision_margin,Ea=T.collision_group,Fa=T.collision_mask,la=u.Vc.Da,qa=m(x),na=q.b4w_correct_bounding_offset,$a;var Ba=H;if(g.length){var Ga=[],pb={};
pb.quat=new Float32Array([0,0,0,1]);pb.trans=new Float32Array(3);pb.worker_bounding=qa;pb.bounding_type=Ba;Ga.push(pb);Q.invert(u.T,V);Z.invert(u.quat,R);for(var Ca=0;Ca<g.length;Ca++){var ob={},Cb=g[Ca],tc=Cb.game.collision_bounds_type,uc=new Float32Array(4),vc=new Float32Array(3);aa.transformMat4(Cb.d.h,V,vc);Z.multiply(R,Cb.d.quat,uc);ob.trans=vc;ob.quat=uc;ob.bounding_type=tc;ob.worker_bounding=m(l(tc,Cb.d));Ga.push(ob)}$a=Ga}else $a=[];z.C(z.Vt,w,K,ja,v,L,ra,X,P,ha,ga,ia,ka,pa,Ea,Fa,H,qa,la,
E,B,$a,na);ma[w]=q;W.push(q);var Lb=p(w);Lb.type=v;Lb.en=X;Lb.dk=L;Lb.Na=nb;Lb.$h=ka;t=Lb;a.m=t;var Kb={B:null,Sa:t};U.push(Kb);d(c,t.Na)}else for(var Jb=a.n||[],Sa=0;Sa<Jb.length;Sa++){var ab=Jb[Sa],vb;if(vb="PHYSICS"==ab.type){var Ra;a:{for(var Da=c.m.p,gb=0;gb<Da.length;gb++){var wb=Da[gb].B;if(wb&&wb.id==ab.id){Ra=!0;break a}}Ra=!1}vb=!Ra}if(vb)if(ab.Cc.K)if(ab.of&&c.d.$a){var Qa=ab,ub=ba,ya=N.ca(ub,"MAIN_OPAQUE");z.C(z.du,ya.pf);if(ya.$a&&Qa.kC){var wa={};wa.dst_noise_scale0=Qa.dst_noise_scale0;
wa.dst_noise_scale1=Qa.dst_noise_scale1;wa.dst_noise_freq0=Qa.dst_noise_freq0;wa.dst_noise_freq1=Qa.dst_noise_freq1;wa.dir_min_shore_fac=Qa.dir_min_shore_fac;wa.dir_freq=Qa.dir_freq;wa.dir_noise_scale=Qa.dir_noise_scale;wa.dir_noise_freq=Qa.dir_noise_freq;wa.dir_min_noise_fac=Qa.dir_min_noise_fac;wa.dst_min_fac=Qa.dst_min_fac;wa.waves_hor_fac=Qa.waves_hor_fac;var xb=ya.qf,qb=ya.Bg;ya.Vk?z.C(z.Do,wa,ya.cf[0],ya.cf[1],ya.bf[0],ya.bf[1],ya.hh,xb,qb,ya.th,ub.d.Hn):z.C(z.Do,wa,0,0,0,0,0,xb,qb,0,null)}}else{var xa;
if(ab.TB){var ic=a,ca=ab,yb=f(),Na=ca.Cc,za=Na.A[0].a_position,Aa=Na.ea||null,jb=ca.Na,Kc=h(jb);z.C(z.au,yb,za,Aa,ic.d.h,Kc,ca.Ap,ca.zp,ca.Bp);var Wa=p(yb);Wa.dk=!0;Wa.Na=jb;Wa.$h=Kc;xa=Wa}else{var Rb=a,hb=ab,Mb=f(),jc=hb.Cc,Yb=jc.A[0].a_position,wc=jc.ea||null,bb=Rb.d.h,Zb=hb.oi,Pc=hb.ji,xc=hb.Na,C=h(xc);z.C(z.cu,Mb,Yb,wc,bb,Zb,Pc,C,hb.Ap,hb.zp,hb.Bp);var Nb=p(Mb);Nb.Na=xc;Nb.$h=C;xa=Nb}t=xa;Kb={B:ab,Sa:t};U.push(Kb);d(c,t.Na)}else J.error("Object "+a.name+" has collision material with no assigned vertices")}if(A(a)||
k(a)){var Ia=a,Ta=Ia.m.S;A(Ia)?(Ia.k.type=10,z.C(z.Wt,Ta,Ia.k.iB,Ia.k.kB,Ia.k.jB,Ia.k.mC,Ia.k.hz)):k(Ia)&&(Ia.k.type=20,z.C(z.Ut,Ta,Ia.k.nm,Ia.k.qo,Ia.k.ro));if(Ia.k.mg){var zb=Ia.k.mg;switch(Ia.k.type){case 10:r(zb[1],Ia,Ta,!0);r(zb[0],Ia,Ta,!0);r(zb[3],Ia,Ta,!1);r(zb[2],Ia,Ta,!1);break;case 20:for(var fa=0;fa<zb.length;fa++)r(zb[fa],Ia,Ta,!1)}}G(a,a.k)}else if(I(a)){var kc=a.d,kb=a.m,cb=kc.Pb.max_y-kc.Pb.min_y,lc=kb.S,ta=a.b4w_character_settings,rb=ta.walk_speed,Ab=ta.run_speed,ed=ta.step_height,
Oa=ta.jump_strength,Ob=ta.waterline,Qc=O.ex(a);z.C(z.Xt,lc,Qc,cb,rb,Ab,ed,Oa,Ob);kb.is_character=!0}else if(F(a)){var db=a,$b=db.m.S;z.C(z.$t,$b,db.Jc.nm,db.Jc.qo,db.Jc.ro);if(db.Jc.yj)for(var ac=db.Jc.yj,mc=0;mc<ac.length;mc++){var nc=ac[mc],Rc=nc.d.h,Zc=db.d.T,bc=new Float32Array(16);Q.invert(Zc,bc);var $c=new Float32Array(3);aa.transformMat4(Rc,bc,$c);z.C(z.Tt,$b,$c,nc.Gv)}db.m.Ny=!0}for(Sa=0;Sa<W.length;Sa++)if(a=W[Sa],a.m){var lb=a;if(!n(lb))for(var Lc=0;Lc<lb.constraints.length;Lc++){var eb=
lb.constraints[Lc],yc=eb.target,ib=eb.pivot_type;if("RIGID_BODY_JOINT"==eb.type&&yc.m){var oc=new Float32Array([eb.pivot_x,eb.pivot_y,eb.pivot_z]),Bb,Ma=new Float32Array([eb.axis_x,eb.axis_y,eb.axis_z]);Bb=O.euler_to_quat(Ma,new Float32Array(4));var Db=Q.fromRotationTranslation(Bb,oc,new Float32Array(16)),zc=Q.multiply(lb.d.T,Db,new Float32Array(16)),Eb=Q.invert(yc.d.T,new Float32Array(16)),Sb=Q.multiply(Eb,zc,Eb),Ac=O.fh(Sb),Hb=O.matrix_to_quat(Sb),Ua=eb,Pa={};Pa.use_limit_x=Ua.use_limit_x;Pa.use_limit_y=
Ua.use_limit_y;Pa.use_limit_z=Ua.use_limit_z;Pa.use_angular_limit_x=Ua.use_angular_limit_x;Pa.use_angular_limit_y=Ua.use_angular_limit_y;Pa.use_angular_limit_z=Ua.use_angular_limit_z;Pa.limit_max_x=Ua.limit_max_x;Pa.limit_min_x=Ua.limit_min_x;Pa.limit_max_y=Ua.limit_max_y;Pa.limit_min_y=Ua.limit_min_y;Pa.limit_max_z=Ua.limit_max_z;Pa.limit_min_z=Ua.limit_min_z;Pa.limit_angle_max_x=Ua.limit_angle_max_x;Pa.limit_angle_min_x=Ua.limit_angle_min_x;Pa.limit_angle_max_y=Ua.limit_angle_max_y;Pa.limit_angle_min_y=
Ua.limit_angle_min_y;Pa.limit_angle_max_z=Ua.limit_angle_max_z;Pa.limit_angle_min_z=Ua.limit_angle_min_z;y(ib,lb,oc,Bb,yc,Ac,Hb,Pa,null,null)}}}};a.wx=e;a.update=function(){for(var a=0;a<W.length;a++){var b=W[a],c=b.m;if(c.df&&c.Vl){var d=performance.now()/1E3-c.Vl,d=Math.min(d,10/ha.Zc),d=d-1/ha.Zc;ka.nz&&(d=0);var e=ja;K.Iy(c.Wl,d,c.jr,c.Qo,ja);H.wA(b,e);H.u(b);v(b);if(b.k)for(var c=b,d=c.k.mg,e=c.d.Ab,f=ja,g=0;g<d.length;g++){var h=d[g];K.multiply(e,c.k.Ni[g],f);H.set_tsr(h,f);H.u(h)}b.k&&b.k.Ah&&
(c=b.k,d=c.Ah)&&(e=b.k.Os,h=V,f=b.d.h,g=b.d.quat,O.eo(b.k.Ps,g,f,h),O.fh(h,d.d.h),O.matrix_to_quat(h,d.d.quat),h=T,O.fo(e,g,f,h),e=R,Z.setAxisAngle(h,-c.zh*c.Sn*2*Math.PI,e),Z.multiply(e,d.d.quat,d.d.quat),H.u(d));b.k&&b.k.Pn&&(c=b.k,d=c.Pn)&&(f=b.k.Is,e=V,g=b.d.h,h=b.d.quat,O.eo(b.k.Js,h,g,e),O.fh(e,d.d.h),O.matrix_to_quat(e,d.d.quat),e=T,O.fo(f,h,g,e),f=R,g=Math.abs(c.speed)*c.Hs,g>c.gn&&(g=c.gn),Z.setAxisAngle(e,-g,f),Z.multiply(f,d.d.quat,d.d.quat),H.u(d));b.k&&b.k.Wn&&(c=b.k,d=c.Wn)&&(e=b.k.Vs,
h=V,f=b.d.h,g=b.d.quat,O.eo(b.k.Ws,g,f,h),O.fh(h,d.d.h),O.matrix_to_quat(h,d.d.quat),b=T,O.fo(e,g,f,b),e=R,Z.setAxisAngle(b,-Math.abs(c.Sg)*c.Qp,e),Z.multiply(e,d.d.quat,d.d.quat),H.u(d))}}if(a=ba)a=N.ca(a,"MAIN_OPAQUE"),a.$a&&0<a.$a.waves_height&&(b=aa.length(a.dj),z.C(z.Du,a.time*b))};a.Sx=function(){return ba};a.pause=function(){ba&&z.C(z.pu)};a.resume=function(){ba&&z.C(z.tu)};a.enable_simulation=function(a){a=a.m;if(!a)throw"No object physics";if(!a.df){var b=a.S;a.df=!0;z.C(z.nu,b)}};a.disable_simulation=
function(a){a=a.m;if(!a)throw"No object physics";if(a.df){var b=a.S;a.df=!1;z.C(z.mu,b)}};a.has_physics=function(a){return a.m?!0:!1};a.has_dynamic_physics=function(a){return(a=a.m)&&a.df&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.en&&0==a.dk?!0:!1};a.has_simulated_physics=function(a){return(a=a.m)&&a.df?!0:!1};a.set_gravity=function(a,b){z.C(z.Cu,a.m.S,b)};a.By=n;a.apply_constraint=y;a.clear_constraint=function(a){a=a.m;z.C(z.ru,a.Hj);a.Hj=null};a.pull_to_constraint_pivot=function(b,c,d,e,f,
g){c=K.create_sep(c,1,d,ja);f=K.create_sep(f,1,g,ra);K.invert(c,c);K.multiply(f,c,c);H.get_tsr(e,f);K.multiply(f,c,c);H.set_tsr(b,c);H.u(b);a.set_transform(b,b.d.h,b.d.quat)};a.set_transform=function(a,b,c){K.set_sep(a.d.h,1,a.d.quat,a.m.Wl);var d=z.wq(z.kj);d.body_id=a.m.S;d.trans=b;d.quat=c;z.C(z.kj,d)};a.sync_transform=v;a.apply_velocity=function(a,b,c,d){E(a,b,c,d,pa);a=a.m.S;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);var e=Math.abs(pa[0]),f=Math.abs(pa[1]),g=Math.abs(pa[2]);pa[0]=e?pa[0]/e*Math.max(e,
b):0;pa[1]=f?pa[1]/f*Math.max(f,c):0;pa[2]=g?pa[2]/g*Math.max(g,d):0;z.C(z.Fo,a,pa[0],pa[1],pa[2])};a.apply_velocity_world=function(a,b,c,d){z.C(z.Fo,a.m.S,b,c,d)};a.apply_force=function(a,b,c,d){E(a,b,c,d,pa);z.C(z.eu,a.m.S,pa[0],pa[1],pa[2])};a.apply_torque=function(a,b,c,d){E(a,b,c,d,pa);z.C(z.gu,a.m.S,pa[0],pa[1],pa[2])};a.set_character_move_dir=function(a,b,c){z.C(z.wu,a.m.S,b,c)};a.set_character_move_type=function(a,b){z.C(z.xu,a.m.S,b)};a.set_character_walk_velocity=function(a,b){z.C(z.Bu,
a.m.S,b)};a.set_character_run_velocity=function(a,b){z.C(z.zu,a.m.S,b)};a.set_character_fly_velocity=function(a,b){z.C(z.uu,a.m.S,b)};a.character_jump=function(a){z.C(z.iu,a.m.S)};a.character_rotation_inc=function(a,b,c){z.C(z.ju,a.m.S,b,c)};a.set_character_rotation=function(a,b,c){z.C(z.yu,a.m.S,b,c)};a.set_character_rotation_h=function(a,b){z.C(z.vu,a.m.S,b)};a.set_character_rotation_v=function(a,b){z.C(z.Au,a.m.S,b)};a.append_collision_test=function(a,b,c,d){a=a.m;var e=a.S;b=b||"ANY";for(var f=
0;f<a.Zb.length;f++){var g=a.Zb[f];if(g.Na==b&&g.callback==c)return}g={wl:e,ld:d||!1,Na:b,callback:c,Ve:[],tk:[]};a.Zb.push(g);x(g)};a.remove_collision_test=function(a,b,c){a=a.m;b=b||"ANY";for(var d=0;d<a.Zb.length;d++){var e=a.Zb[d];if(e.Na==b&&e.callback==c){a.Zb.splice(d,1);d--;for(var e=e.Ve,f=ba.m.p,g=0;g<f.length;g++)for(var h=f[g].Sa,l=0;l<h.Zb.length;l++)for(var k=h.Zb[l],m=0;m<k.Ve.length;m++)for(var n=k.Ve[m],p=0;p<e.length;p++){var r=e[p];n[0]==r[0]&&n[1]==r[1]&&(e.splice(p,1),p--)}e.length&&
z.C(z.Eo,e)}}};a.apply_collision_impulse_test=function(a,b){a.m&&a.m.Ef&&B(a);var c=a.m;z.C(z.fu,c.S);c.Ef=b};a.clear_collision_impulse_test=B;a.append_ray_test=function(a,b,c,d,e,f,g,l,k){var m;ga.cs++;m=ga.cs;d=d||"ANY";a={id:m,S:a?a.m.S:0,M:new Float32Array(b),la:new Float32Array(c),Na:d,$h:h(d),$o:f,Iv:g,ld:l,Yj:k,callback:e};b=ba.m;m=a.id;b.nh[m]=a;b.Bn.push(a);z.C(z.bu,a.id,a.S,a.M,a.la,a.$h,a.$o,a.Iv,a.ld,a.Yj);return m};a.remove_ray_test=t;a.change_ray_test_from_to=function(a,b,c){var d=ba.m.nh[a];
d&&!d.$o&&(d.M.set(b),d.la.set(c),z.C(z.hu,a,b,c))};a.Wq=function(a){return ba.m.nh[a]?!0:!1};a.vehicle_throttle=function(a,b){var c=a.k;c.Sg=b;G(a,c)};a.vehicle_steer=function(a,b){var c=a.k;c.zh=b;G(a,c)};a.vehicle_brake=function(a,b){var c=a.k;c.Yh=b;G(a,c)};a.is_vehicle_chassis=A;a.is_vehicle_hull=k;a.My=function(a){if(!a.b4w_vehicle)return!1;a=a.b4w_vehicle_settings.part;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.Ky=function(a){return a.b4w_vehicle?
"BOB"==a.b4w_vehicle_settings.part?!0:!1:!1};a.Oy=function(a){return a.b4w_floating?"BOB"==a.b4w_floating_settings.part?!0:!1:!1};a.Zq=function(a){return a.b4w_vehicle&&"STEERING_WHEEL"==a.b4w_vehicle_settings.part?!0:!1};a.Yq=function(a){return a.b4w_vehicle&&"SPEEDOMETER"==a.b4w_vehicle_settings.part?!0:!1};a.$q=function(a){return a.b4w_vehicle&&"TACHOMETER"==a.b4w_vehicle_settings.part?!0:!1};a.get_vehicle_speed=function(a){return a.k.speed};a.nC=function(a){switch(a){case "WHEEL_FRONT_LEFT":return 0;
case "WHEEL_FRONT_RIGHT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.is_character=I;a.hE=F;a.gy=function(){return qa};a.Vw=function(){z.C(z.lu)};a.Oz=function(a){var b=W.indexOf(a);-1==b&&J.error("Object "+a.name+" doesn't have bounding physics");for(var c=ba,d=a.m.S,e=c.m.p,f=[],g=0;g<e.length;g++)for(var h=e[g].Sa,l=0;l<h.Zb.length;l++)for(var k=h.Zb[l],m=0;m<k.Ve.length;m++){var n=k.Ve[m];if(n[0]==d||n[1]==d)k.Ve.splice(m,1),k.tk.splice(m,1),m--,f.push(n)}f.length&&
z.C(z.Eo,f);a.m&&a.m.Ef&&B(a);delete ma[d];W.splice(b,1);a=c.m.p;for(b=0;b<a.length;b++)a[b].Sa.S==d&&(a.splice(b,1),b--);z.C(z.qu,d)}};b4w.module.__data=function(a,q){function b(a,b){if(a)for(var c=ma(a,b.id),d=0;d<c.length;d++){var e=c[d];"MESH"==e.type&&delete e.data.submeshes}tb[b.id]=null;nb[b.id]=null}function d(a,b,c){var d;a instanceof ArrayBuffer&&(a=ra.Bq(a));d=a.width;a=a.height;M.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(Ib)&&c&&M.warn("image",b,"is not from app root.")}function c(a,b,c,d,e,f){d=b.q;if(!d)throw"Nothing requested";ea.enqueue([[d,ea.AT_JSON,
d]],function(d,f,g,h){if(d){M.log("%cLOAD METADATA","color: #616",h);f=Ha.$A(d.b4w_format_version);switch(Ha.nt(f,Za.Ci)){case -1:f[0]<Za.Ci[0]?Ha.pa("JSON version is too old relative to B4W engine: "+Ha.Wk(f)+", required: "+Ha.Wk(Za.Ci)+". Reexport scene with the latest B4W addon to fix it."):M.warn("JSON version is a bit old relative to B4W engine: "+ +Ha.Wk(f)+", required: "+Ha.Wk(Za.Ci)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>
Za.Ci[0]?Ha.pa("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):M.warn("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}Za.cn=f;for(var l in d)a[l]=d[l];(d=a.binaries[0].binfile)?b.dp=d:(S.xs(b,"load_binaries"),S.xs(b,"prepare_bindata"));if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)M.ox(a.b4w_export_errors[d]);if(a.b4w_export_warnings)for(d=
0;d<a.b4w_export_warnings.length;d++)M.px(a.b4w_export_warnings[d]);e(b,c)}else S.Lo(b)},null,function(a){f(b,c,a)})}function e(a,b,c,d,e,f){d=ka(b.q)+b.dp;if(!d)throw"Binary data is missing";ea.enqueue([[d,ea.AT_ARRAYBUFFER,d]],function(d,f,g,h){d?(M.log("%cLOAD BINARY","color: #616",h),a.bin_data=d,e(b,c)):S.Lo(b)},null,function(a){f(b,c,a)})}function g(a,b,c,d,e){d=a.bin_data;var g=a.binaries[0],h=a.objects,l=a.meshes;a=a.actions;for(var k=Ha.Sv(),D=["indices"],m=["normal","tangent"],n=["color",
"group"],U=["position","texcoord","texcoord2"],p=0;p<l.length;p++)for(var r=l[p].submeshes,t=0;t<r.length;t++)for(var y in r[t]){var q=r[t][y][1];if(-1!=D.indexOf(y)){var v=4*r[t][y][0]+g["int"],u=r[t],va=y,M=d;if(k)var R=new Uint32Array(M,v,q);else for(var R=new Uint32Array(q),M=new DataView(M),V=0;V<q;V++)R[V]=M.getUint32(v+4*V,!0);u[va]=R}else if(-1!=U.indexOf(y))v=4*r[t][y][0]+g["float"],r[t][y]=f(d,v,q,k);else if(-1!=m.indexOf(y)){v=2*r[t][y][0]+g["short"];u=r[t];va=y;M=d;R=new Float32Array(q);
M=new DataView(M);for(V=0;V<q;V++)R[V]=M.getInt16(v+2*V,!0)/32767;u[va]=R}else if(-1!=n.indexOf(y)){v=2*r[t][y][0]+g.ushort;u=r[t];va=y;M=d;R=new Float32Array(q);M=new DataView(M);for(V=0;V<q;V++)R[V]=M.getUint16(v+2*V,!0)/65535;u[va]=R}}for(y=0;y<h.length;y++)for(l=h[y].particle_systems,D=0;D<l.length;D++)m=l[D],m.transforms=f(d,4*m.transforms[0]+g["float"],m.transforms[1],k);for(h=0;h<a.length;h++){y=a[h];var l=y.fcurves,D=y.frame_range,n=D[0],U=D[1],p=T.Wx(n,U),D=null,t=r=!1,w;for(w in l)r|=-1<
w.indexOf("rotation_euler"),t|=-1<w.indexOf("rotation_quaternion");m=[];for(w in l)if(r&&t&&-1<w.indexOf("rotation_euler"))delete l[w];else{var q=l[w],H;for(H in q)v=q[H],u=f(d,g["float"]+4*v.bin_data_pos[0],v.bin_data_pos[1],k),va=new Float32Array(p),null===D&&(D=new Int8Array(p)),T.qv(v,u,va,D,n,U),v.kc=va;-1<w.indexOf("rotation_euler")&&(T.vx(l[w]),m.push(w))}for(n=0;n<m.length;n++)U=m[n],p=U.replace("euler","quaternion"),l[p]=l[U],delete l[U];y.Nu=D}e(b,c)}function f(a,b,c,d){if(d)d=new Float32Array(a,
b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+4*e,!0)}return d}function h(a,b,c,d,e){0===b.id&&(Ic=a);var f=a.cameras,g=a.groups,h=a.materials,D=a.meshes,k=a.node_groups,m=a.objects,n=a.particles,r=a.scenes,t=a.speakers,y=a.textures,q=a.worlds;k||(M.warn('"node_groups" datablock undefined. reexport main scene.'),k=a.node_groups=[]);for(var u="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),
R={},V=0;V<u.length;V++)for(var w=a[u[V]],H=0;H<w.length;H++){var S=w[H];R[S.uuid]=S}for(var x=0;x<r.length;x++){for(var A=r[x],B=A.objects,Y=0;Y<B.length;Y++)E(B,Y,R);A.camera&&E(A,"camera",R);A.world&&E(A,"world",R)}for(x=0;x<g.length;x++)for(var G=g[x].objects,Y=0;Y<G.length;Y++)E(G,Y,R);for(x=0;x<m.length;x++){var K=m[x];K.dupli_group&&E(K,"dupli_group",R);K.parent&&E(K,"parent",R);if(K.animation_data){var z=K.animation_data;z.action&&E(z,"action",R);if(z.nla_tracks)for(Y=0;Y<z.nla_tracks.length;Y++)for(var ea=
z.nla_tracks[Y],da=0;da<ea.strips.length;da++)ea.strips[da].action&&E(ea.strips[da],"action",R)}switch(K.type){case "MESH":if(!K.data)throw"mesh not found for object "+K.name;E(K,"data",R);for(var ja=K.modifiers,Y=0;Y<ja.length;Y++){var F=ja[Y];"ARMATURE"==F.type?E(F,"object",R):"CURVE"==F.type&&E(F,"object",R)}var I=K.particle_systems;if(I)for(Y=0;Y<I.length;Y++)E(I[Y],"settings",R);break;case "ARMATURE":E(K,"data",R);for(var O=K.pose.bones,Ya=K.data.bones,Y=0;Y<O.length;Y++){var sb=O[Y];sb.bone=
Ya[sb.bone];for(var gc=sb.parent_recursive,da=0;da<gc.length;da++)gc[da]=O[gc[da]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":E(K,"data",R)}var ra=K.constraints;if(ra)for(Y=0;Y<ra.length;Y++){var sa=ra[Y];sa.target&&E(sa,"target",R)}var X=K.lod_levels;if(X)for(Y=0;Y<X.length;Y++){var N=X[Y];N.object&&E(N,"object",R)}}for(x=0;x<D.length;x++)for(var Q=D[x].materials,Y=0;Y<Q.length;Y++)E(Q,Y,R);for(x=0;x<h.length;x++){for(var C=h[x],aa=C.texture_slots,Y=0;Y<aa.length;Y++)E(aa[Y],"texture",
R);var P=C.node_tree;P&&v(P,R)}for(x=0;x<k.length;x++)(P=k[x].node_tree)&&v(P,R);for(x=0;x<y.length;x++){var nb=y[x],Z=nb.type;"IMAGE"!=Z&&"ENVIRONMENT_MAP"!=Z||E(nb,"image",R)}for(x=0;x<f.length;x++){var ha=f[x];ha.dof_object&&E(ha,"dof_object",R)}for(x=0;x<t.length;x++){var la=t[x];la.sound&&E(la,"sound",R);if(la.animation_data&&(z=la.animation_data,z.action&&E(z,"action",R),z.nla_tracks))for(Y=0;Y<z.nla_tracks.length;Y++)for(ea=z.nla_tracks[Y],da=0;da<ea.strips.length;da++)ea.strips[da].action&&
E(ea.strips[da],"action",R)}for(x=0;x<n.length;x++){for(var kb=n[x],aa=kb.texture_slots,Y=0;Y<aa.length;Y++)E(aa[Y],"texture",R);kb.dupli_group&&E(kb,"dupli_group",R);kb.dupli_object&&E(kb,"dupli_object",R)}for(x=0;x<q.length;x++)if(aa=q[x].texture_slots)for(Y=0;Y<aa.length;Y++)E(aa[Y],"texture",R);Xb.Qv(a);for(var cb=a.textures,lc=p(a)?a.scenes[0].b4w_anisotropic_filtering:l().b4w_anisotropic_filtering,ta=0;ta<cb.length;ta++)p(a)||"SCENE"!=cb[ta].b4w_source_type||(cb[ta].b4w_source_id=""),La.Mw(cb[ta],
lc,a.scenes,b.id);for(var rb={},Za=a.objects,ga=0;ga<Za.length;ga++){var Oa=Za[ga];if("MESH"===Oa.type&&!Oa.particle_systems.length)for(var ka=Oa.data,ia=ka.name,ba=ka.submeshes,Fa=ka.materials,hc=0;hc<ba.length;hc++)0!==ba[hc].base_length||rb[ia]||(Fa[hc]&&M.warn('material "'+Fa[hc].name+'" is not assigned to any face (object "'+Oa.name+'").'),rb[ia]=!0)}for(var Ea=a.meshes,tb=0;tb<Ea.length;tb++){var pa=Ea[tb];pa.materials.length||pa.uv_textures.length&&M.warn('mesh "'+pa.name+'" has a UV map but has no exported material.')}a.materials.push({name:"DEFAULT",
use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,
b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[]});
for(var Ib=a.meshes,qa=Ha.keysearch("name","DEFAULT",a.materials),Hc=0;Hc<Ib.length;Hc++){var Ga=Ib[Hc];0==Ga.materials.length&&Ga.materials.push(qa)}for(var Ba=a.actions,Oc=b.id,$a=0;$a<Ba.length;$a++){var ib=Ba[$a];ib.Pu=Oc;T.Xu(ib)}for(var oc=a.scenes,Bb=0;Bb<oc.length;Bb++){for(var Ma=oc[Bb],Db=ua.Ml(Ma,"ALL"),zc=[],Eb=0;Eb<Db.length;Eb++)for(var Sb=Db[Eb].particle_systems,Ac=0;Ac<Sb.length;Ac++){var Hb=Sb[Ac].settings;if("HAIR"==Hb.type)if("OBJECT"==Hb.render_type)U.Sk(Hb.dupli_object,!0);else if("GROUP"==
Hb.render_type){for(var Ua=Hb.dupli_group,Pa=ua.Ml(Ma,"EMPTY"),Pb=0;Pb<Pa.length;Pb++)Pa[Pb].dupli_group==Ua&&zc.push(Pa[Pb]);for(Pb=0;Pb<Ua.objects.length;Pb++)U.Sk(Ua.objects[Pb],!0)}else M.warn("render type",Hb.render_type,"not supported for particle systems ("+Hb.name+").")}for(Eb=0;Eb<zc.length;Eb++)J(zc[Eb],[Ma])}W(a,b.id);for(var Sc=a.scenes,Qb=0;Qb<Sc.length;Qb++){for(var ld=Sc[Qb],Bc=[],ad=[],fd=Sc[Qb].objects,Tb=0;Tb<fd.length;Tb++){var ud=fd[Tb];L(fd,ud,Bc,ad);var pd=ud.dupli_group;if(pd)for(var Tc=
pd.objects,cc=0;cc<Tc.length;cc++)L(Tc,Tc[cc],Bc,ad)}for(Tb=0;Tb<ad.length;Tb++)J(ad[Tb],[ld]);for(Tb=0;Tb<Bc.length;Tb++)Ha.kv(Bc[Tb][0],Bc[Tb][1])}W(a,b.id);var fb=ma(a,b.id);Xb.vv(fb,a.scenes);for(ta=0;ta<fb.length;ta++){var Uc=fb[ta];!p(a)&&Uc.parent&&-1<na.indexOf(Uc.parent.type)&&(Uc.parent="");U.Sk(Uc,!1);Uc.d.pc=b.id}for(var qd=0;qd<fb.length;qd++){var Vc=fb[qd];if("MESH"==Vc.type){var Cc=T.get_first_armature_object(Vc);if(Cc){var pc=Cc.d;if(pc.Ce){var Dc=Vc.d.Kc,bd=[],rd;for(rd in Dc){var md=
Dc[rd];bd.push(4*md.fi,4*md.ip)}pc.qr.push(bd)}pc.Kk.push(Vc.d)}}}for(var Mc=-1,sd=-1,gd=T.vq(),qc=0;qc<fb.length;qc++){var Ec=fb[qc],Fb=Ec.d;if(Ha.is_mesh(Ec)&&Fb.bh){var Wc=Fb.je;Wc>Mc&&(Mc=Wc);gd>=Wc&&Wc>sd&&(sd=Wc)}}for(qc=0;qc<fb.length;qc++)Ec=fb[qc],Fb=Ec.d,Ha.is_mesh(Ec)&&Fb.bh&&(Fb.ni=!0,Mc<gd?Fb.je=Mc:Fb.je<=gd?Fb.je=sd:(M.warn('too many bones for "'+Ec.name+'" / '+Fb.je+" bones (max "+gd+" with blending, "+2*gd+" without blending). Blending between frames will be disabled."),Fb.je=Mc,Fb.ni=
!1),Fb.ni=Fb.ni&&!Gc.hq);for(var Xc=0;Xc<fb.length;Xc++){var Ub=fb[Xc];if(Ha.is_mesh(Ub)){var cd=Ub.lod_levels.length;if(cd)for(var Yc=Ub,Vb=0;Vb<cd;Vb++){var Fc=Ub.lod_levels[Vb].object;if(!Fc){Yc.d.gk=!0;Yc.d.Re=Ub.lod_levels[Vb].distance;break}Fc.d.$f=Ub.d.$f;Yc.d.Re=Ub.lod_levels[Vb].distance;Fc.d.Ai=Ub.lod_levels[Vb].distance;if(Ub.lod_levels[Vb+1])Fc.d.Re=Ub.lod_levels[Vb+1].distance;else{Fc.d.gk=!0;Fc.d.Re=1E4;break}Yc.d.gk=!1;Yc=Fc}}}for(var hd=0;hd<fb.length;hd++){var oa=fb[hd];if(oa.b4w_vehicle){var Va=
oa.b4w_vehicle_settings;if("CHASSIS"==Va.part){oa.k={};oa.k.fq=Va.force_max;oa.k.jp=Va.brake_max;oa.k.iB=Va.suspension_compression;oa.k.kB=Va.suspension_stiffness;oa.k.jB=Va.suspension_damping;oa.k.mC=Va.wheel_friction;oa.k.CE=Va.roll_influence;oa.k.hz=Va.max_suspension_travel_cm;oa.k.Sg=0;oa.k.Yh=1;oa.k.zh=0;oa.k.speed=0;oa.k.mg=[];oa.k.Ni=[];oa.k.Ah=null;for(var jd=oa.za?oa.za.dupli_group.objects:fb,rc=0;rc<jd.length;rc++){var Ka=jd[rc];if(Ka.b4w_vehicle){var Xa=Ka.b4w_vehicle_settings;if(va.My(Ka)&&
Va.name==Xa.name){var vd=va.nC(Ka.b4w_vehicle_settings.part);oa.k.mg[vd]=Ka;oa.k.Ni[vd]=new Float32Array(8)}else if(va.Zq(Ka)&&Va.name==Xa.name){oa.k.Ah=Ka;oa.k.Sn=Xa.steering_max;oa.k.Ns=Xa.steering_ratio;oa.k.Tq=Xa.inverse_control;var mb=Gb.invert(oa.d.T,new Float32Array(16)),dc=Gb.multiply(mb,Ka.d.T,mb);oa.k.Ps=dc;var Nc=new Float32Array([1,0,0,0]);sc.transformMat4(Nc,dc,Nc);oa.k.Os=Nc}else if(va.Yq(Ka)&&Va.name==Xa.name){oa.k.Pn=Ka;oa.k.Hs=Xa.speed_ratio;oa.k.gn=Xa.max_speed_angle;var mb=Gb.invert(oa.d.T,
new Float32Array(16)),Wb=Gb.multiply(mb,Ka.d.T,mb);oa.k.Js=Wb;var ec=new Float32Array([1,0,0,0]);sc.transformMat4(ec,Wb,ec);oa.k.Is=ec}else if(va.$q(Ka)&&Va.name==Xa.name){oa.k.Wn=Ka;oa.k.Qp=Xa.delta_tach_angle;var mb=Gb.invert(oa.d.T,new Float32Array(16)),dd=Gb.multiply(mb,Ka.d.T,mb);oa.k.Ws=dd;var fc=new Float32Array([1,0,0,0]);sc.transformMat4(fc,dd,fc);oa.k.Vs=fc}}}if(4!=oa.k.mg.length)throw"Not enough wheels for chassis "+oa.name;}else if("HULL"==Va.part){oa.k={};oa.k.mg=[];oa.k.Ni=[];oa.k.fq=
Va.force_max;oa.k.jp=Va.brake_max;oa.k.nm=Va.floating_factor;oa.k.qo=Va.water_lin_damp;oa.k.ro=Va.water_rot_damp;oa.k.Sg=0;oa.k.Yh=1;oa.k.zh=0;oa.k.speed=0;oa.k.Ah=null;for(var td=oa.za?oa.za.dupli_group.objects:fb,rc=0;rc<td.length;rc++)Ka=td[rc],Ka.b4w_vehicle&&(Xa=Ka.b4w_vehicle_settings,va.Ky(Ka)&&Va.name==Xa.name?(oa.k.mg.push(Ka),oa.k.Ni.push(new Float32Array(8))):va.Zq(Ka)&&Va.name==Xa.name?(oa.k.Ah=Ka,oa.k.Sn=Xa.steering_max,oa.k.Ns=Xa.steering_ratio,oa.k.Tq=Xa.inverse_control,mb=Gb.invert(oa.d.T,
new Float32Array(16)),dc=Gb.multiply(mb,Ka.d.T,mb),oa.k.Ps=dc,Nc=new Float32Array([1,0,0,0]),sc.transformMat4(Nc,dc,Nc),oa.k.Os=Nc):va.Yq(Ka)&&Va.name==Xa.name?(oa.k.Pn=Ka,oa.k.Hs=Xa.speed_ratio,oa.k.gn=Xa.max_speed_angle,mb=Gb.invert(oa.d.T,new Float32Array(16)),Wb=Gb.multiply(mb,Ka.d.T,mb),oa.k.Js=Wb,ec=new Float32Array([1,0,0,0]),sc.transformMat4(ec,Wb,ec),oa.k.Is=ec):va.$q(Ka)&&Va.name==Xa.name&&(oa.k.Wn=Ka,oa.k.Qp=Xa.delta_tach_angle,mb=Gb.invert(oa.d.T,new Float32Array(16)),dd=Gb.multiply(mb,
Ka.d.T,mb),oa.k.Ws=dd,fc=new Float32Array([1,0,0,0]),sc.transformMat4(fc,dd,fc),oa.k.Vs=fc))}}}for(var nd=0;nd<fb.length;nd++){var Jc=fb[nd];if(Jc.b4w_floating){var od=Jc.b4w_floating_settings;if("MAIN_BODY"==od.part){Jc.Jc={};Jc.Jc.nm=od.floating_factor;Jc.Jc.qo=od.water_lin_damp;Jc.Jc.ro=od.water_rot_damp;Jc.Jc.yj=[];for(var yd=Jc.za?Jc.za.dupli_group.objects:fb,wd=0;wd<yd.length;wd++){var kd=yd[wd];if(kd.b4w_floating){var zd=kd.b4w_floating_settings;va.Oy(kd)&&od.name==zd.name&&(Jc.Jc.yj.push(kd),
kd.Gv=kd.b4w_floating_settings.synchronize_position)}}}}}for(ta=0;ta<a.scenes.length;ta++){var xd=a.scenes[ta];Ja.enabled&&xd.b4w_enable_physics&&(p(a)||!va.has_physics(l())&&xd==ua.lm(a))&&va.Hy(xd)}e(b,c)}function p(a){return a==Ic?!0:!1}function l(){return ua.lm(Ic.scenes)}function m(a,b,c,d,e){!p(a)&&1<a.scenes.length&&(a.scenes=[ua.lm(a.scenes)],M.warn("loading data contains multiple scenes.","Only the first one will be loaded."));d=l();-1==Gc.Ha&&(Gc.Ha=d.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(d),
1),a.scenes.unshift(d));for(var f=0;f<a.scenes.length;f++){var g=a.scenes[f];if(p(a)&&!g.camera)throw"Scene check failed: No camera";for(var h=ua.Ml(g,"MESH"),D=0;D<h.length;D++){var k=h[D],m=Xb.nv(k);m&&(a.meshes.push(m),k.data=m)}for(var D=ma(a,b.id),k=a.meshes,m=k.slice(0),n=0;n<D.length;n++){var U=D[n];"MESH"==U.type&&(U=m.indexOf(U.data),-1<U&&m.splice(U,1))}for(n=0;n<m.length;n++)k.splice(k.indexOf(m[n]),1);p(a)?(ua.bv(g,a.textures),g.d.Kh.length&&(b.Jm=!0),g.b4w_enable_audio&&da.Wo(g),D=ua.zm(g),
k=g.b4w_batch_grid_size):(ua.hv(g,d,a.textures),g.b4w_enable_audio&&!d.j&&da.Wo(d),D=ua.zm(d),k=d.b4w_batch_grid_size);m=[];R.Ox(D,k,h,d.d.vo,d.d.Lk,m,d.d.dr);p(a)?(ua.Po(g,m),ua.Gx(D)):ua.Po(d,m)}d=a.materials;if(hc.Yl&&Za.ht)for(a=0;a<d.length;a++){h=d[a];D=h.texture_slots;for(f=0;f<D.length;f++)if(k=D[f],m=k.texture,"IMAGE"==m.type||"ENVIRONMENT_MAP"==m.type)g=m.image,g.jc||(-1<g.filepath.indexOf(".dds")?g.jc=!0:(g.jc=!m.b4w_disable_compression&&!k.use_map_normal&&"ENVIRONMENT_MAP"!=m.type&&!m.b4w_shore_dist_map&&
"MOVIE"!=g.source,g.jc&&(g.filepath+=".dds")));if(f=h.node_tree)for(h=f.nodes,f=0;f<h.length;f++)g=h[f],"TEXTURE"==g.type&&(D=g.texture)&&(g=D.image)&&!g.jc&&(g.jc=D.d.qj&&!D.b4w_disable_compression&&"MOVIE"!=g.source,g.jc&&(g.filepath+=".dds"))}else for(a=a.images,d=0;d<a.length;d++)f=a[d],f.jc=Boolean("FILE"==f.source&&-1<f.filepath.indexOf(".dds"));e(b,c)}function r(a,b,c,d,e){d=a.groups;a=a.objects;for(var f={},g={},h={},l={},D=0;D<d.length;D++){var k=d[D];f[k.uuid]=k;h[k.uuid]=k}for(D=0;D<a.length;D++)k=
a[D],g[k.uuid]=k,l[k.uuid]=k;n(a,null,l,h);for(var m in h)m in f||d.push(h[m]);for(m in l)m in g||a.push(l[m]);e(b,c)}function n(a,b,c,d){for(var e=[],f=0;f<a.length;f++){var g=a[f],h=c[g.uuid];if(g=h.proxy){b&&-1==e.indexOf(g.uuid)&&e.push(g.uuid);for(var l=c[g.uuid],k=l.constraints,g=0;g<k.length;g++){var m=Ha.Df(k[g]);m.name+="_CLONE";h.constraints.push(m)}"b4w_proxy_inherit_anim"in h&&!h.b4w_proxy_inherit_anim||(h.animation_data&&(l.animation_data=Ha.Df(h.animation_data)),l.b4w_use_default_animation=
h.b4w_use_default_animation,l.b4w_auto_skel_anim=h.b4w_auto_skel_anim,l.b4w_anim_behavior=h.b4w_anim_behavior,l.b4w_cyclic_animation=h.b4w_cyclic_animation)}}for(f=0;f<e.length;f++)h=Ha.Am(a,"uuid",e[f]),-1<h&&a.splice(h,1);e={};for(f=0;f<a.length;f++)g=a[f],h=c[g.uuid],b&&(k=Ha.Df(h),h="origin_name"in h?h.origin_name:h.name,k.name=b+"*"+h,k.origin_name=h,y(k),c[k.uuid]=k,e[g.uuid]=k.uuid,g.uuid=k.uuid),h=c[g.uuid],h.dupli_group&&(g=h.dupli_group,k=d[g.uuid],l=Ha.Df(k),l.name=Ha.Qk(k.name+"_CLONE"),
l.uuid=D.Nq("Group"+l.name),d[l.uuid]=l,g.uuid=l.uuid,n(l.objects,h.name,c,d));if(b)for(f=0;f<a.length;f++){g=a[f];h=c[g.uuid];h.parent&&h.parent.uuid in e?h.parent.uuid=e[h.parent.uuid]:h.parent&&(M.warn("Object's \""+h.name+'" parent is not in dupli group. Disabling parenting.'),h.parent=null);k=h.constraints;for(g=0;g<k.length;g++)b=k[g],b.target&&b.target.uuid in e&&(b.target.uuid=e[b.target.uuid]);b=h.modifiers;for(g=0;g<b.length;g++)d=b[g],d.object&&d.object.uuid in e&&(d.object.uuid=e[d.object.uuid]);
if((h=h.lod_levels)&&h.length)for(g=0;g<h.length;g++)b=h[g],b.object&&b.object.uuid in e&&(b.object.uuid=e[b.object.uuid])}for(var U in e)Ea[U]=e[U]}function y(a){a.uuid=D.Nq("Object"+a.name)}function v(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];"TEXTURE"==e.type&&e.texture&&E(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in Ea&&(e.lamp.uuid=Ea[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&E(e,"node_group",b)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];
x(f,"from_node",c);x(f,"to_node",c);u(f,"from_socket",f.from_node.outputs);u(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&E(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(e=c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&E(e.strips[f],"action",b)}function E(a,b,c){(c=c[a[b].uuid])||M.error("Dangling link found:",b,a);a[b]=c}function x(a,b,c){c=Ha.keysearch("name",a[b].name,c);a[b]=c}function u(a,b,c){c=Ha.keysearch("identifier",a[b].identifier,
c);a[b]=c}function B(a,b,c,e,f,g){if(!Za.do_not_load_resources){for(var h=ka(b.q),l=a.images,k={},D=[],m=0;m<l.length;m++){var n=l[m],U=n.uuid;if("FILE"===n.source||"MOVIE"===n.source){var p=t(n,a.textures);if(!p.length)M.warn("image ",n.name," has no users.");else if(!p[0].b4w_shore_dist_map){p=w(h+n.filepath);if("FILE"===n.source){var r=n.jc?ea.AT_ARRAYBUFFER:ea.AT_IMAGE_ELEMENT;hc.hn&&Za.Uk&&(p=ea.Wi(p),"dds"==p[1]?(p=ea.Wi(p[0]),p=p[0]+".min50."+p[1]+".dds"):p=p[0]+".min50."+p[1])}else"MOVIE"===
n.source&&(Za.Sc?(p=ea.Wi(p),p=p[0]+".altconv.seq",r=ea.gj):(p=ea.Wi(p),r=da.detect_video_container(p[1]),p=r!=p[1]?p[0]+".altconv."+r:p[0]+"."+r,r=ea.hj));D.push([U,r,p]);k[U]=n}}}D.length?(e.Oq=0,ea.enqueue(D,function(f,h,l,m){if(f){if(l==ea.hj||l==ea.gj){if(l==ea.hj)var n=f.videoWidth,U=f.videoHeight;else n=f.images[0].width,U=f.images[0].height;M.log("%cLOAD VIDEO "+n+"x"+U,"color: #"+(2048<n||2048<U?"a00":1024<n||1024<U?"aa0":"0a0"),m);-1==m.indexOf(Ib)&&M.warn("video",m,"is not from app root.")}else d(f,
m,!0);h=k[h];m=t(h,a.textures);for(n=0;n<m.length;n++){var U=m[n],p=U.image.filepath;l==ea.gj?(U.d.os=f.ac,La.Zi(U.d,f.images,h.jc,p,b.id)):La.Zi(U.d,f,h.jc,p,b.id)}}f=++e.Oq/D.length;g(b,c,f)},function(){M.log("%cLOADED ALL IMAGES","color: #0a0");f(b,c)})):f(b,c)}}function t(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];e.image===a&&c.push(e)}return c}function G(a,b,c,d,e,f){if(!Za.do_not_load_resources){a=ma(a,b.id);for(var g=ka(b.q),h=[],l={},k=0;k<a.length;k++){var D=a[k];if(A(D)){var m=D.data.sound,
n=m.uuid;"BACKGROUND_MUSIC"==da.Bm(D)?(n=Ha.vm(),b.Im=!0):"NONE"!=da.Bm(D)&&Za.Rq&&(b.Mm=!0);if(!(n in l)){l[n]=[];m=w(g+m.filepath);switch(da.Fs(D)){case da.Zk:var U=ea.AT_AUDIOBUFFER;break;case da.wo:U=ea.AT_AUDIO_ELEMENT}var m=ea.Wi(m),p=da.detect_audio_container(m[1]),m=p!=m[1]?m[0]+".altconv."+p:m[0]+"."+p;h.push([n,U,m])}l[n].push(D)}}h.length?ea.enqueue(h,function(a,e,g,k){if(a)for(M.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf(Ib)&&M.warn("sound",k,"is not from app root."),e=l[e],g=0;g<
e.length;g++)da.NB(e[g],a);a=++d.MA/h.length;f(b,c,a)},function(){M.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,c)}):e(b,c)}}function A(a){return da.ge(a)&&da.Fs(a)!=da.xo?!0:!1}function k(a,b){for(var c=ua.Ia(a,"SPEAKER",ua.DATA_ID_ALL),d=0;d<c.length;d++){var e=c[d];da.ge(e)&&(da.is_cyclic(e)||b)&&da.play_def(e)}}function I(a){a=a.d.Kh;for(var b=0;b<a.length;b++)Za.Sc&&a[b].use_auto_refresh?a[b].d.rh=!0:a[b].d.La&&a[b].use_auto_refresh&&a[b].d.La.play()}function F(a,b,c,d,e){sb.start();M.log("%cSTART NLA",
"color: #0a0");e(b,c)}function L(a,b,c,d){if(b.lod_levels&&b.lod_levels.length)for(var e=b.lod_levels.length,f=0;f<e;f++){var g=b.lod_levels[f],h=g.object;if(h){var l=Ha.Fj(h);l.name=b.name+"_LOD_"+String(f+1);y(l);l.lod_levels=[];c.push([a,l]);d.push(h);g.object=l}}}function J(a,b){for(var c=0;c<b.length;c++){for(var d=b[c].objects,e=0;e<d.length;e++){var f=d[e].dupli_group;f&&(f=f.objects,g=f.indexOf(a),-1<g&&f.splice(g,1))}var g=d.indexOf(a);-1<g&&d.splice(g,1)}}function P(a,b,c,d,e){d=!0;for(var f=
0;f<a.scenes.length;f++)if(!va.Xv(a.scenes[f])){d=!1;break}d&&(e(b,c),M.log("%cPHYSICS READY","color: #0a0"))}function z(a,b,c,d,e){d=l();for(var f=0;f<a.scenes.length;f++){var g=a.scenes[f],h=p(a)?va.has_physics(g):va.has_physics(d)||va.has_physics(g);p(a)||(g=d);for(var k=0;k<$a.length;k++)for(var D=ua.Ia(g,$a[k],ua.DATA_ID_ALL),m=0;m<D.length;m++){var n=D[m];n.d.pc==b.id&&Ja.enabled&&h&&(va.append_object(n,g),b.an&&va.has_physics(n)&&va.disable_simulation(n))}}e(b,c)}function N(a,b,c,e,f){var g=
{};e=[];for(var h=a.scenes,l=0;l<a.scenes.length;l++){var k=h[l];if(k.d.$a&&(k=k.d.$a.Jk)&&"FILE"===k.source){var D=k.uuid,m=w(ka(b.q)+k.filepath);e.push([D,k.jc?ea.AT_ARRAYBUFFER:ea.AT_IMAGE_ELEMENT,m]);g[D]=k}}e.length?ea.enqueue(e,function(c,e,f,l){if(c){d(c,l,!0);e=g[e];l=t(e,a.textures);for(f=0;f<l.length;f++){var k=l[f];La.Zi(k.d,c,e.jc,k.image.filepath,b.id)}for(f=0;f<h.length;f++)if(l=h[f],l.d.$a.Jk===e){var D=c,m=document.createElement("canvas"),k=e.size[0],n=e.size[1];m.width=k;m.height=
n;m=m.getContext("2d");m.drawImage(D,0,0);D=m.getImageData(0,0,k,n).data;m=new Float32Array(4);m[0]=1/16581375;m[1]=1/65025;m[2]=1/255;m[3]=1;for(var k=k*n,n=new Float32Array(k),U=0;U<k;U++)n[U]=m[1]*D[4*U+2]+m[2]*D[4*U+3];l.d.Hn=n}}},function(){f(b,c)}):f(b,c)}function H(a,b,c,e,f){if(Za.antialiasing&&Za.smaa){e=a.scenes[0];a=[];for(var g=["SMAA_EDGE_DETECTION","SMAA_BLENDING_WEIGHT_CALCULATION","SMAA_NEIGHBORHOOD_BLENDING","SMAA_RESOLVE"],h=0;h<g.length;h++){var l=ua.ca(e,g[h]);l&&a.push(l)}if(a.length){e=
[];h=ea.AT_IMAGE_ELEMENT;e.push(["SEARCH_TEXTURE",h,V.Tb.smaa_search_texture_path]);e.push(["AREA_TEXTURE",h,V.Tb.smaa_area_texture_path]);for(h=0;h<a.length;h++)if(g=a[h],"SMAA_BLENDING_WEIGHT_CALCULATION"==g.type){a=g.fa;for(h=0;h<a.length;h++)if(g=a[h],"u_search_tex"==g.la)var k=g.ta;else if("u_area_tex"==g.la)var D=g.ta;break}e.length?ea.enqueue(e,function(a,c,e,f){a&&(d(a,f,!1),c="SEARCH_TEXTURE"==c?k:D,c.source="IMAGE",c.ap=!0,La.Zi(c,a,-1!=f.indexOf(".dds")?1:0,f,b.id),La.Gn(c,La.r,La.r))},
function(){f(b,c)}):f(b,c)}else f(b,c)}else f(b,c)}function K(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];p(a)||(e=l());for(var f=ua.Ia(e,"LAMP",ua.DATA_ID_ALL),g=0;g<f.length;g++){var h=f[g];h.d.pc==b.id&&(b.an&&Ha.is_mesh(h)&&ua.hide_object(h),d.hl.push({ns:e,obj:h}))}f=ua.Ia(e,"ALL",ua.DATA_ID_ALL);for(g=0;g<f.length;g++)h=f[g],"LAMP"!=h.type&&h.d.pc==b.id&&(b.an&&Ha.is_mesh(h)&&ua.hide_object(h),d.hl.push({ns:e,obj:h}))}}function O(a,b,c,d,e,f){e=d.hl;var g=d.Ar;e.length?(a=e[g].obj,
g=e[g].ns,ua.append_object(g,a,!1),-1!=Ba.indexOf(a.type)&&g.b4w_enable_audio&&da.append_object(a,g),pa.is_anchor(a)&&pa.append(a),d=++d.Ar/e.length,"LAMP"==a.type&&ua.LA(g),null!=a.d.nc&&ua.ct(g,a),a.d.yc&&"PLANE"==a.d.le&&g.d.zb&&(ua.wv(a,g),ua.ft(a.d.vc,g))):d=1;f(b,c,d)}function X(a,b,c,d,e){if(p(a)){d=ua.ky();for(var f=ua.Wg(),g=0;g<d.length;g++){var h=d[g];ua.Gz(h,f);h.b4w_use_nla&&sb.KB(h,h.b4w_nla_cyclic,b.id)}ua.set_active(f)}else ua.gt(l());a=ma(a,b.id);U.IB(a);e(b,c)}function aa(a,b,c,
d,e){if(p(a))for(d=0;d<a.scenes.length;d++)a.scenes[d].b4w_use_nla||I(a.scenes[d]),k(a.scenes[d]);else a.scenes[0].b4w_use_nla||I(l()),k(l());e(b,c)}function Z(a,b,c,d,e){Za.Sf&&(b.Jm||b.Im||b.Mm)?Fa||Q(a,e,b,c):e(b,c)}function Q(a,b,c,d){var e=Ga.parentElement;Oc=e.style.zIndex;e.style.zIndex="999";Fa=document.createElement("div");Fa.style.position="relative";Fa.style.height="88px";Fa.style.width="88px";var f=Math.round(Ga.offsetWidth/2-44);Fa.style.top=Math.round(Ga.offsetHeight/2-44).toString()+
"px";Fa.style.left=f.toString()+"px";Fa.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
Fa.style.backgroundSize="88px";la=document.createElement("div");la.style.position="relative";la.style.height=Ga.offsetHeight.toString()+"px";la.style.width=Ga.offsetWidth.toString()+"px";la.style.background="rgba(0, 0, 0, 0.5)";la.style.zIndex="999";e.appendChild(la);la.appendChild(Fa);Fa.addEventListener("click",function(){c.Jm&&(La.play(),La.pause(),La.reset());if(c.Im){if(p(a))for(var e=0;e<a.scenes.length;e++)k(a.scenes[e],!0);else k(l(),!0);da.pause()}c.Mm&&da.Az();ha();b(c,d)},!1)}function ha(){if(Fa){var a=
Ga.parentElement;a.style.zIndex=Oc;la.removeChild(Fa);a.removeChild(la);Fa=la=null;Oc=0}}function ka(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function qa(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var e=a[d];""!=e&&"."!=e&&(".."!=e||!b&&!c.length||c.length&&".."==c[c.length-1]?c.push(e):c.length&&c.pop())}a=c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}function w(a){var b=
a.split("://",2);return 1<b.length?(b[1]=qa(b[1]),b.join("://")):qa(a)}function ba(a,b,c){T.is_animated(b)&&T.remove(b);ua.clear_outline_anim(b);va.has_physics(b)&&va.Oz(b);ja.check_sensor_manifold(b)&&ja.remove_sensor_manifold(b);ua.Pz(a,b,c);da.ge(b)&&da.OA(b);pa.is_anchor(b)&&pa.remove(b)}function ma(a,b){nb[b]||W(a,b);return nb[b]}function W(a,b){for(var c=a.scenes,d=[],e=0;e<c.length;e++)ia(c[e].objects,0,p(a),d);nb[b]=[];for(e=0;e<d.length;e++)for(var c=d[e],f=0;f<c.length;f++)for(var g=c[f],
h=0;h<g.length;h++)nb[b].push(g[h])}function ia(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var g=a[f],h=ga(g);e[h]=e[h]||[];(c||-1==na.indexOf(g.type))&&-1==e[h].indexOf(g)&&e[h].push(g);(g=g.dupli_group)&&ia(g.objects,b+1,c,d)}}function ga(a){return(a=a.parent||T.get_first_armature_object(a))?1+ga(a):0}var pa=q("__anchors"),T=q("__animation"),R=q("__batch"),V=q("__config"),ja=q("__controls"),ra=q("__dds"),sa=q("__extensions");q("__lights");var S=q("__loader"),ea=q("__assets"),D=q("__md5"),
U=q("__objects"),va=q("__physics"),M=q("__print"),Xb=q("__reformer"),Y=q("__renderer"),ua=q("__scenes"),sb=q("__nla"),da=q("__sfx"),Ya=q("__shaders"),La=q("__textures"),gc=q("__nodemat"),Ha=q("__util");q("__transform");var sc=q("vec4"),Gb=q("mat4"),Za=V.o,hc=V.Od,Ja=V.Sa,Gc=V.Nd,Hc=V.cd,tb=null,nb=null,Ib="",Ic=!1,Ea={},Fa=null,la=null,Oc=0,na=["LAMP","CAMERA"],$a=["MESH","CAMERA","EMPTY"],Ba=["SPEAKER"],Ga=null;a.is_primary_loaded=function(a){return S.is_primary_loaded(a)};a.update=function(){S.LB(tb)};
a.BA=function(a){Ga=a};a.HB=function(a,b){if(Fa){la.style.height=b.toString()+"px";la.style.width=a.toString()+"px";var c=Math.round(a/2-44);Fa.style.top=Math.round(b/2-44).toString()+"px";Fa.style.left=c.toString()+"px"}};a.load=function(a,d,f,l,k){var D={load_main:{Ta:S.xe,ab:!1,J:[],gb:!1,ib:500,yb:!1,cb:c},duplicate_objects:{Ta:S.hd,ab:!1,J:["load_main"],gb:!1,ib:50,yb:!1,cb:r},load_binaries:{Ta:S.xe,ab:!1,J:["load_main"],gb:!1,ib:500,yb:!1,cb:e},prepare_bindata:{Ta:S.hd,ab:!1,J:["duplicate_objects",
"load_binaries"],gb:!1,ib:0,yb:!1,cb:g},prepare_root_datablocks:{Ta:S.hd,ab:!1,J:["duplicate_objects","prepare_bindata"],gb:!1,ib:150,yb:!1,cb:h},prepare_root_scenes:{Ta:S.hd,ab:!1,J:["prepare_root_datablocks"],gb:!1,ib:350,yb:!1,cb:m},load_smaa_textures:{Ta:S.xe,ab:!0,J:["prepare_root_scenes"],gb:!1,ib:10,yb:!0,cb:H},load_shoremap:{Ta:S.xe,ab:!0,J:["prepare_root_scenes"],gb:!1,ib:10,yb:!0,cb:N},load_textures:{Ta:S.xe,ab:!0,J:["prepare_root_scenes"],gb:!0,ib:500,yb:!1,cb:B,Cf:{Oq:0}},wait_physics_workers:{Ta:S.xe,
ab:!0,J:["load_shoremap"],gb:!1,ib:20,yb:!1,Bf:P},add_physics_objects:{Ta:S.hd,ab:!1,J:["wait_physics_workers"],gb:!1,ib:20,yb:!1,cb:z},add_objects:{Ta:S.hd,ab:!1,J:["add_physics_objects"],gb:!1,ib:800,yb:!1,cb:K,Bf:O,Zh:X,Cf:{hl:[],Ar:0}},load_speakers:{Ta:S.xe,ab:!0,J:["add_objects"],gb:!0,ib:30,yb:!1,cb:G,Cf:{MA:0}},mobile_media_start:{Ta:S.hd,ab:!Za.Sf,J:["load_textures","load_speakers"],gb:!0,ib:5,yb:!1,cb:Z,Bf:Z},synchronize_media:{Ta:S.hd,ab:!0,J:["mobile_media_start"],gb:!0,ib:70,yb:!1,cb:aa},
start_nla:{Ta:S.hd,ab:!0,J:["mobile_media_start"],gb:!1,ib:5,yb:!1,cb:F}},n=S.zq();n||(n=S.Fw(),tb={},nb={},Ea={});tb[n.Cd.length]={};return S.Nw(D,a,d,f,b,l||Hc.Yo,Za.do_not_load_resources,k)};a.unload=function(a){var b=S.zq();if(!b||!b.Cd.length||a&&!S.mB(b.Cd[a]))M.error("Unable to unload data!");else{if(0==a)M.log("%cUNLOAD ALL","color: #00a"),pa.cleanup(),T.cleanup(),da.cleanup(),sb.cleanup(),ua.cleanup(),S.cleanup(),va.cleanup(),U.cleanup(),Ha.cleanup(),Y.cleanup(),gc.cleanup(),Ya.cleanup(),
ja.cleanup(),sa.cleanup(),ea.cleanup(),La.cleanup(),nb=null,Ea={},Ic=!1,tb=null;else{M.log("%cUNLOAD DATA "+a,"color: #00a");T.Nz(a);for(var b=ua.ri(),c=0;c<b.length;c++)for(var d=b[c],e=ua.Ia(d,"ALL",ua.DATA_ID_ALL),f=e.length-1;0<=f;f--){var g=e[f];if(g.d.pc==a){ba(d,g,!0);e.splice(f,1);var h=ua.Ia(d,g.type,ua.DATA_ID_ALL),g=h.indexOf(g);-1!=g&&h.splice(g,1)}}}ha()}};a.Fz=ba;a.set_debug_resources_root=function(a){Ib=a}};b4w.module.__batch=function(a,q){function b(a){a={type:a,Ka:"",id:0,Qz:0,mh:"",L:[],Gb:[],Pc:[],ai:[],zg:null,sb:{},Xb:null,pb:null,Xo:[],uc:null,R:null,Kc:null,Dd:!1,Ng:!1,Mp:!1,wireframe_mode:0,num_vertices:0,num_triangles:0,ar:0,br:0,Cq:0,Dm:0,bc:new Float32Array(3),mc:new Float32Array(16),Fa:!1,Cp:!1,W:!1,ve:!1,Ja:!1,yg:!1,nd:!1,Ac:!1,hc:!1,Yb:!1,Vb:!1,Mb:!1,yc:!1,mb:!1,Zr:!1,Zd:Q.Ph,we:Q.Kd,Jf:!1,wn:"",GE:"",Dq:!1,Hq:0,Eq:0,Iq:0,Jq:0,Gq:new Float32Array(3),Fq:new Float32Array(3),Pf:!1,Md:0,$d:0,
He:1,og:0,Gs:0,vh:1,kg:0,Ge:0,Ae:1,wr:0,jn:0,fg:0,gs:0,qc:Array(2),ic:new Float32Array(3),jf:new Float32Array(3),yd:new Float32Array(3),Mc:new Float32Array(4),Yc:new Float32Array(4),dh:null,Vm:null,Tm:null,Sm:null,Um:null,of:!1,water_dynamic:!1,so:!1,rt:!1,st:0,tt:0,qt:0,Oh:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,eq:new Float32Array(2),dq:new Float32Array(2),om:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),dg:null,Cn:!1,Mr:0,Ir:0,
qn:0,Lr:0,Or:0,Nr:0,Jr:0,Kr:0,rn:0,Fr:0,Er:0,Qr:0,Hr:0,sk:new Float32Array(3),Pr:new Float32Array(8),Gr:new Float32Array(16)};a.Mc[3]=1;a.Cp=!0;a.W=!0;return a}function d(a){switch(a.type){case "MAIN":case "NODES":case "PARTICLES":a.Ka=a.Fa?a.ve?"XRAY":"BLEND":"OPAQUE";break;case "DEPTH":a.Ka="DEPTH";break;case "COLOR_ID":a.Ka=a.ve?"COLOR_ID_XRAY":"COLOR_ID"}}function c(a,b){for(var c=[],d=ia.Ba(b,"SHADOW_CAST"),f=ia.Ba(b,"MAIN_PLANE_REFLECT"),g=ia.Ba(b,"MAIN_CUBE_REFLECT"),h=ia.Ba(b,"OUTLINE_MASK"),
l=ia.Ba(b,"COLOR_PICKING"),k=0;k<a.n.length;k++){var m=a.n[k],n=null;"DEPTH"==m.type&&d&&m.Ac&&(n=e(m),n.Ka="SHADOW_CAST");"MAIN"!=m.type&&"NODES"!=m.type&&"PARTICLES"!=m.type||!f&&!g||m.Fa||!m.Vb||(n=e(m),n.Ka="REFLECT");"COLOR_ID"==m.type&&(h&&l?(n=e(m),n.Ka="OUTLINE"):h&&!l&&(m.Ka="OUTLINE"));n&&(n.Jf=!0,J(n,a.d.id),c.push(n))}a.n.push.apply(a.n,c)}function e(a){var b=a.R,c=a.uc;a.R=null;a.uc=null;var d=qa.kw(a);a.R=b;d.R=b;a.uc=c;d.uc=c;return d}function g(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=
a[e],g=f.d,l=p(f.data.b4w_bounding_box),k=f.data.b4w_bounding_cylinder_radius,m=f.data.b4w_bounding_sphere_radius,n=f.data.b4w_bounding_sphere_center,r=f.data.b4w_bounding_ellipsoid_axes,t=f.data.b4w_bounding_ellipsoid_center;if(g.kd){var m=Math.max(Math.abs(l.max_x),Math.abs(l.min_x)),k=Math.max(Math.abs(l.max_y),Math.abs(l.min_y)),y=Math.max(Math.abs(l.max_z),Math.abs(l.min_z)),y=Math.sqrt(m*m+k*k+y*y),m=Math.sqrt(m*m+k*k);l.max_x=l.max_y=l.max_z=y;l.min_x=l.min_y=l.min_z=-y;k=m;m=y;n[0]=n[1]=n[2]=
0;r[0]=r[1]=r[2]=y;t[0]=t[1]=t[2]=0}g.Pb=l;y=K.xl(l,g.T);g.bb=y;var y=g,q=k;y.sl=K.Hp(q,l);y.ql=K.Fp(k,l);y.rl=K.Gp(q,l);n=K.Rl(m,n);g.Vc=n;n=K.zl(n,g.T);g.vb=n;r=K.Ql([r[0],0,0],[0,r[1],0],[0,0,r[2]],t);g.yf=r;r=K.yl(r,g.Ab);g.zf=r;d=d.concat(h(f,g,b,c))}return d}function f(a,b,c,d){for(var e=[],f=[],g={},l=0;l<a.length;l++){var k=a[l],m=k.d,n=p(k.data.b4w_bounding_box),r=K.xl(n,m.T),t=K.Rl(k.data.b4w_bounding_sphere_radius,k.data.b4w_bounding_sphere_center),y=K.zl(t,m.T),q=k.data.b4w_bounding_ellipsoid_axes,
q=K.Ql([q[0],0,0],[0,q[1],0],[0,0,q[2]],k.data.b4w_bounding_ellipsoid_center),v=K.yl(q,m.Ab);m.Pb=n;m.bb=r;m.Vc=t;m.vb=y;m.yf=q;m.zf=v;n={};n.Ac=m.Ac;n.hc=m.hc;n.Yb=m.Yb;n.qg=m.qg;n.ok=m.ok;n.Fb=m.Fb;n.nk=m.nk;n.Ei=m.Ei;n.Vb=m.Vb;n.Mb=m.Mb;n.yc=m.yc;n.nc=m.nc;n.vc=m.vc;n.le=m.le;n.Af=m.Af;n.Gc=m.Gc;n.he=m.he;n.Jb=m.Jb;n.kd=m.kd;n.Xh=m.Xh;n.Wh=m.Wh;n.mb=m.mb;n.Pg=m.Pg;n.Mj=m.Mj;n.ie=m.ie;n.bg=m.bg;n.hk=m.hk;n.tc=m.tc;n.ag=m.ag;n.ik=m.ik;n.nd=m.nd;r=m.vb.F;n.yy=0==c?[0,0]:[Math.floor(r[0]/c),Math.floor(r[2]/
c)];n.Re=m.Re;n.Ai=m.Ai;n.$f=m.$f;m=JSON.stringify(n);g[m]=g[m]||[];g[m].push(k)}for(var u in g){n=JSON.parse(u);c=g[u];var k=qa.Ij("STATIC"),V;for(V in n)k[V]=n[V];k.pc=a[0].d.pc;k.Fd=0;k.ue=0;k.Vd=0;k.Ud=0;k.Qd=0;k.Zg=!1;for(l=0;l<c.length;l++)m=c[l],0==l?(k.bb=R.qa(m.d.bb),k.vb=R.qa(m.d.vb),k.yf=R.qa(m.d.yf),k.zf=R.qa(m.d.zf)):(K.Wp(k.bb,m.d.bb),K.nx(k.vb,m.d.vb));k.Pb=R.qa(k.bb);k.Vc=R.qa(k.vb);f.push({Wb:k,ke:c})}for(a=0;a<f.length;a++)for(g=f[a].Wb,l=f[a].ke,u=0;u<l.length;u++){V=l[u];c=h(V,
g,b,d);V.d.kd&&!V.d.cp?(k=T.create(),T.set_trans(V.d.h,k)):(k=V.d,k=T.create_sep(k.h,k.scale,k.quat));m={};if(g.Gc||g.kd)m.au_center_pos=[k[0],k[1],k[2]];g.Gc&&(m.au_wind_bending_amp=[V.d.Fd],m.au_wind_bending_freq=[V.b4w_wind_bending_freq],m.au_detail_bending_amp=[V.b4w_detail_bending_amp],m.au_detail_bending_freq=[V.b4w_detail_bending_freq],m.au_branch_bending_amp=[V.b4w_branch_bending_amp]);for(n=0;n<c.length;n++)y=c[n].Wb,r=c[n].Cc,t=c[n].B,y.ek?y.kd?Q.cB(r,k):Q.Ss(r,k):("COLOR_ID"==t.type&&(y=
c[n].Wb=V.d,t.mh=V.uuid,G(t,y),J(t,R.Jg(y,0))),r=Q.Ss(r,k),Q.bB(r,m));e=e.concat(c)}return e}function h(a,c,d,e){for(var f=[],g=l(d,c),h=R.Jg(c,0),n=a.data,p=n.materials,r=0;r<g.length;r++){var t=g[r];if(!a.b4w_do_not_render||"PHYSICS"==t)for(var y=0;y<p.length;y++){var q=p[y];if(("LENS_FLARES"!=q.name||0!=e)&&!Q.Kq(n,y)){var v=b(t);if(L(v,q)){v.Zd=c.Dd||c.nd?Q.ij:Q.Ph;G(v,c);for(var u=v,T=a.particle_systems,H=0;H<T.length;H++){var S=T[H].settings.b4w_vcol_from_name,x=T[H].settings.b4w_vcol_to_name;
""!==S&&""!==x&&(u.sb[S]={Mf:!1,src:[{name:S,Nc:7}]})}"DYNAMIC"==c.type&&(v.mh=a.uuid);J(v,h);u=Q.$p(n,y,v.ai,v.Kc,v.sb,v.zg);"LENS_FLARES"==q.name&&(u=w.Ez(u));f.push({B:v,Cc:u,Oc:[q.name],Wb:c,ad:[a]})}}}}g=a.particle_systems;if(0<g.length&&f.length){t=e=!1;for(r=0;r<g.length&&(y=g[r],q=y.settings,q.use_render_emitter&&(e=!0),"HAIR"!=q.type||"OBJECT"!=q.render_type&&"GROUP"!=q.render_type&&y.transforms.length||(t=!0),!e||!t);r++);r=f[0].B.sb;if(t)if(1<p.length){p={};for(t=0;t<g.length;t++)q=g[t].settings,
"HAIR"!=q.type||"OBJECT"!=q.render_type&&"GROUP"!=q.render_type||(y=q.b4w_vcol_from_name,q=q.b4w_vcol_to_name,""!==y&&""!==q&&(p[y]=R.qa(r[y])));"a_bending_col_main"in r&&(p.a_bending_col_main=R.qa(r.a_bending_col_main));"a_bending_col_detail"in r&&(p.a_bending_col_detail=R.qa(r.a_bending_col_detail));n=Q.aq(n,[],p)}else n=f[0].Cc;else n=null;p=[];g=a.particle_systems;t=a.data;for(y=0;y<g.length;y++)if(q=g[y],v=q.settings,v.count)if("EMITTER"==v.type){if("DYNAMIC"==c.type){u=b("PARTICLES");T=t.materials;
H=q.settings.material-1;H>=T.length&&(aa.warn('Wrong material used for rendering particle system "'+q.name+'"'),H=0);T=T[H];"HALO"===q.settings.render_type&&(u.Pf=!0);m(u,T);G(u,c);H=u;S=q;switch(S.settings.b4w_billboard_align){case "VIEW":k(H,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":k(H,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":k(H,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":k(H,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:throw"Wrong billboard align value";
}k(H,"BILLBOARD",0);ga.v(H.pb,"WORLD_SPACE","WORLD"==S.settings.b4w_coordinate_system?1:0);u.nd=!0;u.mh=a.name+"_"+v.uuid;u.wn=q.name;J(u,h);u.uc=q;v=w.Kx(u,t,q,a.d.Ab);w.lA(u,q,T);p.push({B:u,Cc:v,Oc:[T.name],Wb:c,ad:[a]})}}else if("HAIR"==v.type){u=R.$j(q.seed);v.b4w_dynamic_grass&&(c.Pg=!0);var E=ma.up(sa.cn)&&!v.b4w_initial_rand_rotation&&!v.b4w_hair_billboard,A=4;E&&(A=8);if(q.transforms.length)var B=q.transforms;else for(var T=Q.wm(n,v.count,!1,u),B=new Float32Array(T.length*A),K=0;K<T.length;K++)H=
.75+.5*R.Rc(u),B[K*A]=T[K][0],B[K*A+1]=T[K][1],B[K*A+2]=T[K][2],B[K*A+3]=H,E&&(B[K*A+4]=1,B[K*A+5]=0,B[K*A+6]=0,B[K*A+7]=0);T=ia.Ba(d,"GRASS_MAP")?!0:!1;if("OBJECT"==v.render_type)H=[l(d,v.dupli_object.d,!0)],q=F(a,c,r,n,[v.dupli_object],H,[B],v,q,T,u,!1),p=p.concat(q);else if("GROUP"==v.render_type){S=v.dupli_group.objects;x=!1;H=[];for(K=0;K<S.length;K++){var z=l(d,v.dupli_group.objects[K].d,!0);H.push(z)}if(v.use_whole_group){for(var x=B,B=S,K=E,E=A,A={},z=new Float32Array([0,0,0,1]),ea=0;ea<x.length;ea+=
E)for(var ja=0;ja<B.length;ja++){var I=V.create();V.scale(B[ja].d.h,B[ja].d.scale,I);var O=V.clone([x[ea],x[ea+1],x[ea+2]]);A[ja]||(A[ja]=new Float32Array(x.length));K&&(A[ja][ea+4]=z[0]=x[ea+4],A[ja][ea+5]=z[1]=x[ea+5],A[ja][ea+6]=z[2]=x[ea+6],A[ja][ea+7]=z[3]=x[ea+7],R.xn(z,z),R.qB(I,z,I));V.add(O,I,O);A[ja][ea]=O[0];A[ja][ea+1]=O[1];A[ja][ea+2]=O[2];A[ja][ea+3]=x[ea+3]}B=A;x=!0}else if(v.use_group_count){I=S;O=v.dupli_weights;K=u;z={};ea=[];for(ja=0;ja<I.length;ja++)for(var ra=I[ja],ra=ra.origin_name||
ra.name,X=0;X<O.length;X++){var N=O[X];ra==N.name.split(": ")[0]&&ea.push(N)}O.length!=ea.length&&aa.error("dupli weights match failed");for(ja=0;ja<B.length;ja+=A){var P,O=ea;P=[0];for(I=0;I<O.length;I++)P[I+1]=P[I]+O[I].count;O=P[P.length-1]*R.Rc(K);for(I=ra=0;I<P.length;I++)if(O>=P[I]&&O<P[I+1]){ra=I;break}P=ra;z[P]=z[P]||[];z[P].push(B[ja],B[ja+1],B[ja+2],B[ja+3]);E&&z[P].push(B[ja+4],B[ja+5],B[ja+6],B[ja+7])}for(P in z)z[P]=new Float32Array(z[P]);B=z}else{K=u;z=S.length;ea={};for(ja=0;ja<B.length;ja+=
A){var Z=Math.floor(z*R.Rc(K));ea[Z]=ea[Z]||[];ea[Z].push(B[ja],B[ja+1],B[ja+2],B[ja+3]);E&&ea[Z].push(B[ja+4],B[ja+5],B[ja+6],B[ja+7])}for(Z in ea)ea[Z]=new Float32Array(ea[Z]);B=ea}q=F(a,c,r,n,S,H,B,v,q,T,u,x);p=p.concat(q)}"INSTANCE"==v.b4w_wind_bend_inheritance&&a.d.Gc&&aa.warn('Emitter object "'+a.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else throw"Unknown particle settings type";
a=p;f=e?f.concat(a):a}return f}function p(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}}function l(a,b,c){var d=["MAIN","NODES","NODES_GLOW"];(b.qg&&ia.Ba(a,"COLOR_PICKING")||b.Fb&&ia.Ba(a,"OUTLINE_MASK"))&&!c&&d.push("COLOR_ID");ia.Ba(a,"WIREFRAME")&&d.push("WIREFRAME");d.push("PHYSICS");(ia.Ba(a,"DEPTH")||ia.Ba(a,"SHADOW_CAST"))&&d.push("DEPTH");ia.Ba(a,"GRASS_MAP")&&d.push("GRASS_MAP");if(b.hc||b.Mb)for(a=null,b.hc&&(a="MAIN NODES NODES_GLOW COLOR_ID PHYSICS WIREFRAME".split(" ")),
b.Mb&&(b=["COLOR_ID","PHYSICS","DEPTH","WIREFRAME"],a=null!==a?R.rv(a,b):b),b=a,a=0;a<b.length;a++)c=d.indexOf(b[a]),-1!==c&&d.splice(c,1);return d}function m(a,b){var c;switch(a.type){case "MAIN":if(b.b4w_do_not_render||b.use_nodes)c=!1;else{n(a,b);c=b.game_settings.alpha_blend;a.ve=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.fg=b.offset_z;a.jf.set([1,1,1]);var d=b.texture_slots;ja.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Mc);switch(b.name){case "LENS_FLARES":z(a,
"special_lens_flares.glslv","special_lens_flares.glslf");A(a,"a_position");A(a,"a_texcoord");var e=y(d[0],null);N(a,e);break;default:z(a,"main.glslv","main.glslf");var f=v("use_map_color_diffuse",d),g=v("use_map_color_spec",d),h=v("use_map_normal",d),l=v("use_map_mirror",d),m=v("use_stencil",d);c=f[0];g=g[0];h=h[0];l=l[0];f=f[1];d=m[0]&&v("use_rgb_to_intensity",d)[0];if(c){switch(c.blend_type){case "MIX":k(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":k(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}e=y(c,null);N(a,e,"u_colormap0");a.Ge=c.diffuse_color_factor;a.Ae=c.use_map_alpha?c.alpha_factor:0;a.jf.set(c.scale)}m=c&&c==g;g&&(m||(e=y(g,null),N(a,e,"u_specmap0")),a.Gs=g.specular_color_factor);if(h&&(A(a,"a_normal"),A(a,"a_tangent"),e=y(h,null),N(a,e,"u_normalmap0"),a.wr=h.normal_factor,e=h.texture,e.b4w_use_map_parallax&&sa.Hi)){var p=ga.t(e.b4w_parallax_steps),t=ga.t(e.b4w_parallax_lod_dist);k(a,"PARALLAX",1);k(a,"PARALLAX_STEPS",p);k(a,"PARALLAX_LOD_DIST",t);
a.kg=e.b4w_parallax_scale}l&&(e=y(l,null),N(a,e,"u_mirrormap"),a.jn=l.mirror_factor);if(l=c&&f&&d?1:0)e=y(f,null),N(a,e,"u_colormap1"),e=y(d,null),N(a,e,"u_stencil0");(e=c||g||h)&&a.jf.set(e.scale);k(a,"TEXTURE_SPEC",void 0==g?0:1);k(a,"ALPHA_AS_SPEC",m?1:0);k(a,"TEXTURE_STENCIL_ALPHA_MASK",l);A(a,"a_position");A(a,"a_normal");(c||g||h)&&A(a,"a_texcoord");if(b.b4w_water){a.of=!0;a.so=b.b4w_water_shore_smoothing;a.water_dynamic=b.b4w_water_dynamic;l=b.texture_slots;z(a,"special_water.glslv","special_water.glslf");
A(a,"a_position");A(a,"a_texcoord");A(a,"a_normal");A(a,"a_tangent");sa.ut?(A(a,"a_polyindex"),a.W=!0,a.wireframe_edge_color=[0,0,0],k(a,"DEBUG_WIREFRAME",1)):k(a,"DEBUG_WIREFRAME",0);e=v("use_map_normal",l);m=v("use_map_mirror",l)[0];e.length&&(p=y(e[0]),N(a,p,"u_normalmap0"),a.Oh=b.b4w_water_norm_uv_velocity);k(a,"NUM_NORMALMAPS",e.length);a.dg=Array(e.length);for(p=0;p<e.length;p++)a.dg[p]=new Float32Array(2),a.dg[p].set([e[p].scale[0],e[p].scale[1]]);m&&(e=y(m),N(a,e,"u_mirrormap"),a.jn=m.mirror_factor);
m=null;for(p=0;p<l.length;p++){var q=l[p];if(!0===q.texture.b4w_water_foam){m=q;break}}m&&sa.Tg?(k(a,"FOAM",1),e=y(m),N(a,e,"u_foam"),a.foam_factor=b.b4w_foam_factor,a.eq.set(m.texture.b4w_foam_uv_freq),a.dq.set(m.texture.b4w_foam_uv_magnitude),a.om[0]=m.scale[0],a.om[1]=m.scale[1]):k(a,"FOAM",0);for(p=0;p<l.length;p++)if(q=l[p],!0===q.texture.b4w_shore_dist_map){var T=q;break}T&&sa.il?(T=y(T),N(a,T,"u_shore_dist_map"),k(a,"SHORE_PARAMS",1),T=q.texture.b4w_shore_boundings,k(a,"MAX_SHORE_DIST",ga.t(q.texture.b4w_max_shore_dist)),
k(a,"SHORE_MAP_SIZE_X",ga.t(T[0]-T[1])),k(a,"SHORE_MAP_SIZE_Y",ga.t(T[2]-T[3])),k(a,"SHORE_MAP_CENTER_X",ga.t((T[0]+T[1])/2)),k(a,"SHORE_MAP_CENTER_Y",ga.t((T[2]+T[3])/2))):k(a,"SHORE_PARAMS",0);b.b4w_generated_mesh&&sa.gi?(k(a,"GENERATED_MESH",1),a.rt=!0,a.st=b.b4w_water_num_cascads,a.tt=b.b4w_water_subdivs,a.qt=b.b4w_water_detailed_dist):k(a,"GENERATED_MESH",0);if(b.b4w_water_dynamic){var q=ga.t(b.b4w_water_dst_noise_scale0),T=ga.t(b.b4w_water_dst_noise_scale1),l=ga.t(b.b4w_water_dst_noise_freq0),
m=ga.t(b.b4w_water_dst_noise_freq1),e=ga.t(b.b4w_water_dir_min_shore_fac),p=ga.t(b.b4w_water_dir_freq),t=ga.t(b.b4w_water_dir_noise_scale),R=ga.t(b.b4w_water_dir_noise_freq),V=ga.t(b.b4w_water_dir_min_noise_fac),H=ga.t(b.b4w_water_dst_min_fac),w=ga.t(b.b4w_water_waves_hor_fac);k(a,"DST_NOISE_SCALE_0",q);k(a,"DST_NOISE_SCALE_1",T);k(a,"DST_NOISE_FREQ_0",l);k(a,"DST_NOISE_FREQ_1",m);k(a,"DIR_MIN_SHR_FAC",e);k(a,"DIR_FREQ",p);k(a,"DIR_NOISE_SCALE",t);k(a,"DIR_NOISE_FREQ",R);k(a,"DIR_MIN_NOISE_FAC",V);
k(a,"DST_MIN_FAC",H);k(a,"WAVES_HOR_FAC",w)}x(a,b);u(a,b);a.shallow_water_col.set(b.b4w_shallow_water_col);a.shore_water_col.set(b.b4w_shore_water_col);a.shallow_water_col_fac=b.b4w_shallow_water_col_fac;a.shore_water_col_fac=b.b4w_shore_water_col_fac;k(a,"ABSORB",ga.t(b.b4w_water_absorb_factor));k(a,"SSS_STRENGTH",ga.t(b.b4w_water_sss_strength));k(a,"SSS_WIDTH",ga.t(b.b4w_water_sss_width))}"HALO"===b.type&&(q=b.halo,z(a,"halo.glslv","halo.glslf"),k(a,"NUM_RINGS",q.ring_count),k(a,"NUM_LINES",q.line_count),
k(a,"NUM_STARS",q.star_tip_count),k(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0),a.ai=["a_position"],a.Hq=q.size,a.Eq=q.hardness/20,a.Gq.set(q.b4w_halo_rings_color),a.Fq.set(q.b4w_halo_lines_color),a.Iq=1/b.b4w_halo_stars_blend_height,a.Jq=b.b4w_halo_stars_min_height,a.Dq=!0);k(a,"TEXCOORD",0);k(a,"NORMAL_TEXCOORD",0);c&&r(a,c,"TEXTURE_COLOR0_CO");f&&r(a,f,"TEXTURE_COLOR1_CO");d&&r(a,d,"TEXTURE_STENCIL_ALPHA_MASK_CO");g&&r(a,g,"TEXTURE_SPEC_CO");h&&r(a,h,"TEXTURE_NORM_CO");k(a,"SHADELESS",b.use_shadeless?
1:0);a.yg=b.use_shadeless}c=b.game_settings.alpha_blend;k(a,"ALPHA","OPAQUE"===c?0:1);k(a,"ALPHA_CLIP","CLIP"===c?1:0);k(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);b.use_vertex_color_paint?(k(a,"VERTEX_COLOR",1),A(a,"a_color")):k(a,"VERTEX_COLOR",0);a.Md=b.ambient;a.He=b.diffuse_intensity;a.$d=b.emit;a.yd.set(b.specular_color);a.vh=b.specular_alpha;x(a,b);u(a,b);b.b4w_wettable?k(a,"WETTABLE",1):k(a,"WETTABLE",0);E(a,b);a.Cn=b.b4w_refractive;a.gs=b.b4w_refr_bump;c=!0}break;case "NODES":c=
B(a,b);break;case "NODES_GLOW":c=B(a,b,!0);break;case "DEPTH":if("LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type)c=!1;else if(n(a,b),a.Fa)c=!1;else{z(a,"depth.glslv","depth.glslf");A(a,"a_position");A(a,"a_normal");g=b.game_settings.alpha_blend;k(a,"ALPHA","OPAQUE"===g?0:1);a.jf.set([1,1,1]);if((c=v("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===g){a.jf.set(c.scale);k(a,"TEXTURE_COLOR",1);A(a,"a_texcoord");if("IMAGE"==c.texture.d.source||"ENVIRONMENT_MAP"==c.texture.d.source)g=
y(c),N(a,g,"u_colormap0");"NONE"==c.texture.d.source&&(g=y(c),N(a,g,"u_colormap0"))}else k(a,"TEXTURE_COLOR",0);c=!0}break;case "PHYSICS":b.b4w_collision?(a.TB=b.b4w_use_ghost,a.Na=b.b4w_collision_id,a.Ap=b.b4w_collision_margin,a.zp=b.b4w_collision_group,a.Bp=b.b4w_collision_mask,a.oi=b.physics.friction,a.ji=b.physics.elasticity,c=!0):b.b4w_water?(a.of=!0,a.kC=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,
a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if("LENS_FLARES"===b.name||b.b4w_do_not_render||"HALO"===b.type)c=!1;else{n(a,b);a.we=Q.Kd;a.W=!0;a.Fa=!1;g=b.game_settings.alpha_blend;
a.ve=b.b4w_render_above_all&&"OPAQUE"!=g&&"CLIP"!=g;z(a,"color_id.glslv","color_id.glslf");A(a,"a_position");g=b.game_settings.alpha_blend;k(a,"ALPHA","OPAQUE"===g?0:1);a.jf.set([1,1,1]);if((c=v("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===g){a.jf.set(c.scale);k(a,"TEXTURE_COLOR",1);A(a,"a_texcoord");if("IMAGE"==c.texture.d.source||"ENVIRONMENT_MAP"==c.texture.d.source)g=y(c),N(a,g,"u_colormap0");"NONE"==c.texture.d.source&&(g=y(c),N(a,g,"u_colormap0"))}else k(a,"TEXTURE_COLOR",0);c=!0}break;
case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?c=!1:(n(a,b),a.Fa=!1,a.we=Q.Kd,a.W=!0,z(a,"grass_map.glslv","grass_map.glslf"),A(a,"a_position"),c=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,g=b.b4w_dynamic_grass_color?b.b4w_dynamic_grass_color:null,a.sb.a_grass_size={Mf:!0,src:[]},c?(a.sb.a_grass_size.src.push({name:c,Nc:4}),k(a,"DYNAMIC_GRASS_SIZE",1)):k(a,"DYNAMIC_GRASS_SIZE",0),a.sb.a_grass_color={Mf:!0,src:[]},g?(a.sb.a_grass_color.src.push({name:g,Nc:7}),k(a,"DYNAMIC_GRASS_COLOR",
1)):k(a,"DYNAMIC_GRASS_COLOR",0),c=!0);break;case "WIREFRAME":"LENS_FLARES"===b.name||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type?c=!1:(z(a,"wireframe.glslv","wireframe.glslf"),A(a,"a_position"),A(a,"a_normal"),A(a,"a_polyindex"),a.W=!0,a.wireframe_mode=0,a.wireframe_edge_color=[0,0,0],c=!0);break;case "PARTICLES":if(b.b4w_do_not_render)c=!1;else{c=b.texture_slots;if(a.Pf)z(a,"particles_color.glslv","particles_color.glslf");else if(z(a,"particles_texture.glslv","particles_texture.glslf"),c=
v("use_map_color_diffuse",c)[0]){k(a,"TEXTURE_COLOR",1);switch(c.blend_type){case "MIX":k(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":k(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Ge=c.diffuse_color_factor;a.Ae=c.use_map_alpha?c.alpha_factor:0;c=y(c);N(a,c)}ja.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Mc);a.Md=b.ambient;a.He=b.diffuse_intensity;a.$d=b.emit;a.yd.set(b.specular_color);a.vh=b.specular_alpha;A(a,"a_position");A(a,"a_normal");
c=b.game_settings.alpha_blend;k(a,"ALPHA","OPAQUE"===c?0:1);k(a,"ALPHA_CLIP","CLIP"===c?1:0);k(a,"PARTICLES_SHADELESS",b.use_shadeless?1:0);x(a,b);u(a,b);n(a,b);c=b.game_settings.alpha_blend;a.ve=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.fg=b.offset_z;c=!0}break;default:throw"Wrong batch type: "+a.type;}return c}function r(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":k(a,c,"TEXTURE_COORDS_UV_ORCO");k(a,"TEXCOORD",1);break;case "NORMAL":k(a,c,"TEXTURE_COORDS_NORMAL");k(a,"NORMAL_TEXCOORD",
1);break;default:k(a,c,0)}}function n(a,b){var c=b.game_settings,d=c.alpha_blend;switch(d){case "ALPHA_SORT":a.Fa=!0;a.we=Q.Ho;a.W=!0;break;case "ALPHA":a.Fa=!0;a.we=Q.Kd;a.W=!0;break;case "CLIP":a.Fa=!1;a.we=Q.Kd;a.W=!0;break;case "ADD":a.Fa=!0;a.we=Q.Kd;a.W=!1;break;case "OPAQUE":a.Fa=!1;a.we=Q.Kd;a.W=!0;break;default:throw Error("Unknown alpha blend mode: "+d);}a.Ja=c.use_backface_culling}function y(a,b){var c=a.texture,d=c.d,c=c.image;d&&b&&c&&pa.Zi(d,b,c.jc,c.filepath);return d}function v(a,
b){for(var c=[],d=b.length,e=0;e<d;e++){var f=b[e];1==f[a]&&f.texture&&f.texture.d&&c.push(f)}return c}function E(a,b){var c=b.raytrace_transparency;a.Yc[0]=c.fresnel;a.Yc[1]=1-c.fresnel_factor/5;c=b.raytrace_mirror;a.og=c.reflect_factor;a.Yc[2]=c.fresnel;a.Yc[3]=1-c.fresnel_factor/5}function x(a,b){var c,d=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":k(a,"SPECULAR_SHADER","SPECULAR_PHONG");c=b.specular_hardness;break;case "WARDISO":k(a,"SPECULAR_SHADER","SPECULAR_WARDISO");c=b.specular_slope;
break;case "TOON":k(a,"SPECULAR_SHADER","SPECULAR_TOON");c=b.specular_toon_size;d=b.specular_toon_smooth;break;case "BLINN":k(a,"SPECULAR_SHADER","SPECULAR_BLINN");c=b.specular_ior;d=b.specular_hardness;break;default:aa.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.ic[0]=b.specular_intensity;a.ic[1]=c;a.ic[2]=d}function u(a,b){switch(b.diffuse_shader){case "LAMBERT":k(a,"DIFFUSE_SHADER","DIFFUSE_LAMBERT");a.qc[0]=0;a.qc[1]=0;break;case "OREN_NAYAR":k(a,
"DIFFUSE_SHADER","DIFFUSE_OREN_NAYAR");a.qc[0]=b.roughness;a.qc[1]=0;break;case "FRESNEL":k(a,"DIFFUSE_SHADER","DIFFUSE_FRESNEL");a.qc[0]=b.diffuse_fresnel;a.qc[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":k(a,"DIFFUSE_SHADER","DIFFUSE_MINNAERT");a.qc[0]=b.darkness;a.qc[1]=0;break;case "TOON":k(a,"DIFFUSE_SHADER","DIFFUSE_TOON");a.qc[0]=b.diffuse_toon_size;a.qc[1]=b.diffuse_toon_smooth;break;default:aa.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.qc[0]=
0,a.qc[1]=0}}function B(a,b,c){if(!b.use_nodes||b.b4w_do_not_render)return!1;var d=ka.dw(b.node_tree,c?R.vm():b.uuid,!1,b.name,c);if(!d)return aa.error('Failed to create node graph for material "'+b.name+'", disable nodes'),t(a,b),!0;z(a,"main.glslv","main.glslf");k(a,"NODES",1);k(a,"NODES_GLOW",c?1:0);c=b.game_settings.alpha_blend;k(a,"ALPHA","OPAQUE"===c?0:1);k(a,"ALPHA_CLIP","CLIP"===c?1:0);k(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);A(a,"a_position");b.use_orco_tex_coord&&A(a,
"a_orco_tex_coord");n(a,b);a.fg=b.offset_z;c=b.game_settings.alpha_blend;a.ve=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;ja.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Mc);a.$d=b.emit;a.Md=b.ambient;E(a,b);b.b4w_wettable?k(a,"WETTABLE",1):k(a,"WETTABLE",0);a.pb.nn=ka.ew(d);var e=!1;ha.O(d,function(b,c){switch(c.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var d=c.data.name,f=c.data.value;a.zg||(a.zg={});a.zg[f]=d;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":d=
c.data.name;a.sb[d]={Mf:!0,src:[{name:c.data.value}]};f=0;if("GEOMETRY_VC"==c.type)f=7;else for(var g=0;g<c.Ca.length;g++){var h="RGB".indexOf(c.Ca[g].identifier);-1<h&&(f|=1<<2-h)}a.sb[d].src[0].Nc=f;break;case "TEX_COORD_NO":case "GEOMETRY_NO":A(a,"a_normal");break;case "MATERIAL":case "MATERIAL_EXT":d=c.data.value;A(a,"a_normal");k(a,"DIFFUSE_SHADER","DIFFUSE_"+d.dx);k(a,"SPECULAR_SHADER","SPECULAR_"+d.RA);k(a,"SHADELESS_MAT",d.yg?1:0);a.yg=d.yg;a.vh=d.vh;e=!0;break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":d=
c.data.name;f=c.data.value;!1!==f.d.qj&&(f.d.qj="TEXTURE_ENVIRONMENT"!=c.type?!0:!1);N(a,f.d,d);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":k(a,"CALC_TBN_SPACE",1);A(a,"a_normal");A(a,"a_tangent");d=c.data.name;f=c.data.value;f.d.qj=!1;N(a,f.d,d);break;case "LAMP":c.data&&(a.dh=c.data);break;case "B4W_REFRACTION":a.Cn=!0}});e||(a.yg=!0);return!0}function t(a,b){z(a,"main.glslv","main.glslf");k(a,"SHADELESS",1);A(a,"a_position");A(a,"a_normal");ja.set(1,0,1,1,a.Mc);if(b){var c=b.game_settings.alpha_blend;
k(a,"ALPHA","OPAQUE"===c?0:1);k(a,"ALPHA_CLIP","CLIP"===c?1:0);k(a,"VERTEX_COLOR",0);a.fg=b.offset_z;n(a,b)}return!0}function G(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.ek?k(a,"AU_QUALIFIER","attribute"):k(a,"AU_QUALIFIER","uniform"),k(a,"STATIC_BATCH",0)):(k(a,"AU_QUALIFIER","attribute"),k(a,"STATIC_BATCH",1));"WIREFRAME"==a.type&&(Z.oy()?k(a,"WIREFRAME_QUALITY",1):k(a,"WIREFRAME_QUALITY",0),a.Ng?(k(a,"DEBUG_SPHERE",1),a.Mp?k(a,"DEBUG_SPHERE_DYNAMIC",1):k(a,"DEBUG_SPHERE_DYNAMIC",0)):k(a,
"DEBUG_SPHERE",0),k(a,"ALPHA",1));b.Dd&&(a.Dd=b.Dd);b.Gc?(""!==b.he?(a.sb.a_bending_col_main={Mf:!0,src:[{name:b.he,Nc:4}]},A(a,"a_bending_col_main"),""!==b.Jb.hr&&""!==b.Jb.gr&&""!==b.Jb.Dr?(a.sb.a_bending_col_detail={Mf:!0,src:[{name:b.Jb.hr,Nc:4},{name:b.Jb.gr,Nc:2},{name:b.Jb.Dr,Nc:1}]},A(a,"a_bending_col_detail"),A(a,"a_normal"),k(a,"DETAIL_BEND",1)):k(a,"DETAIL_BEND",0),k(a,"MAIN_BEND_COL",1)):k(a,"MAIN_BEND_COL",0),k(a,"WIND_BEND",1)):k(a,"WIND_BEND",0);b.wj?k(a,"BEND_CENTER_ONLY",1):k(a,"BEND_CENTER_ONLY",
0);k(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.cp|0);b.kd?k(a,"BILLBOARD",1):k(a,"BILLBOARD",0);b.kd&&b.ek?k(a,"HAIR_BILLBOARD",1):k(a,"HAIR_BILLBOARD",0);b.Wh?k(a,"BILLBOARD_SPHERICAL",1):k(a,"BILLBOARD_SPHERICAL",0);switch(b.Xh){case "RANDOM":k(a,"BILLBOARD_RANDOM",1);k(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":k(a,"BILLBOARD_RANDOM",0);k(a,"BILLBOARD_JITTERED",1);break;default:k(a,"BILLBOARD_RANDOM",0),k(a,"BILLBOARD_JITTERED",0)}b.mb&&sa.il?k(a,"DYNAMIC_GRASS",1):k(a,"DYNAMIC_GRASS",0);a.mb=
b.mb;a.nd=b.nd;a.Ac=b.Ac;a.hc=b.hc;a.Yb=b.Yb&&!a.yg&&!(a.Fa&&sa.Rp);a.Vb=b.Vb;a.Mb=b.Mb;a.yc=b.yc;b.bh?(A(a,"a_influence"),k(a,"SKINNED",1),b.ni?k(a,"FRAMES_BLENDING",1):k(a,"FRAMES_BLENDING",0),k(a,"MAX_BONES",b.je)):(k(a,"SKINNED",0),k(a,"FRAMES_BLENDING",0));b.Xk?(k(a,"VERTEX_ANIM",1),sa.ot?k(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):k(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):k(a,"VERTEX_ANIM",0);if(b.bh&&b.Xk)throw"Skinning and vertex animation are mutually exlusive";b.Mj?k(a,"DISABLE_FOG",
1):k(a,"DISABLE_FOG",0);b.Kc&&(a.Kc=b.Kc);if("NODES"==a.type||"NODES_GLOW"==a.type){for(var c=a.pb.nn,d=b.bg,e=b.ag,f=0;f<c.length;f++){var g=c[f];switch(g.id){case "VALUE":var h=g.uk[0];if(h)for(var l=0;l<d.length;l+=2)if(d[l]==h){g.Wd.push(["VALUE_IND",d[l+1]]);break}break;case "RGB":if(h=g.uk[0])for(l=0;l<e.length;l+=2)if(e[l]==h){g.Wd.push(["RGB_IND",e[l+1]]);break}}}k(a,"NUM_VALUES",b.ie.length);k(a,"NUM_RGBS",b.tc.length)}}}function A(a,b){var c=a.ai;-1==c.indexOf(b)&&c.push(b)}function k(a,
b,c){ga.v(a.pb,b,c)}function I(a,b){if("PHYSICS"==a.type)a.Cc=b;else{var c=a.we,d=a.Zd;a.Dq&&(b=Q.tx(b));a.rt&&(b=ba.Px(a.st,a.tt,a.qt));c=Q.eB(b,c,d,a.sb);a.R=c;a.nd||c.Zj||a.Dd||(c.Oe=null,c.ed=null);c=b.A.length;a.num_vertices=b.K*c;a:switch(a.Zd){case Q.Ph:case Q.jj:case Q.ij:d=!0;break a;default:d=!1}d?Q.Py(b)?a.num_triangles=b.ea.length/3*c:a.num_triangles=b.K/3*c:a.num_triangles=0}}function F(a,c,d,e,f,g,h,l,m,k,n,p){var r=[],t=l.b4w_dynamic_grass;if(!k&&t)return r;for(var y="INSTANCE"==l.b4w_wind_bend_inheritance,
q="INSTANCE"==l.b4w_shadow_inheritance,v="INSTANCE"==l.b4w_reflection_inheritance,u=[],H=[],w=0;w<f.length;w++){var S=f[w],x=R.Fj(c);x.kd=l.b4w_hair_billboard;x.Xh=l.b4w_hair_billboard_type;x.Wh="SPHERICAL"==l.b4w_hair_billboard_geometry;x.mb=t;x.ek=!0;x.ie=S.d.ie;x.bg=S.d.bg;x.tc=S.d.tc;x.ag=S.d.ag;y?(x.Gc=S.d.Gc,x.ej=S.d.ej,x.ue=S.d.ue,x.Vd=S.d.Vd,x.he=S.d.he,x.Ud=S.d.Ud,x.Qd=S.d.Qd,x.Fd=S.d.Fd,x.Jb=S.d.Jb,x.wj=!1):(x.Gc=a.d.Gc,x.ej=a.d.ej,x.ue=a.d.ue,x.Vd=a.d.Vd,x.he=a.d.he,x.Ud=a.d.Ud,x.Qd=a.d.Qd,
x.Fd=a.d.Fd,x.Jb=a.d.Jb,x.wj=!0);q?(x.Ac=S.d.Ac,x.hc=S.d.hc,x.Yb=S.d.Yb):(x.Ac=a.d.Ac,x.hc=a.d.hc,x.Yb=a.d.Yb);v?(x.Vb=S.d.Vb,x.Mb=S.d.Mb,x.yc=S.d.yc,x.nc=S.d.nc,x.vc=S.d.vc,x.le=S.d.le):(x.Vb=a.d.Vb,x.Mb=a.d.Mb,x.yc=a.d.yc,x.nc=a.d.nc,x.vc=a.d.vc,x.le=a.d.le);u.push(x);var A=h[w];A||(A=new Float32Array);p&&R.$j(m.seed,n);var E=new Float32Array(3),B=new Float32Array([0,0,0,1]),K=[],z=ma.up(sa.cn)&&!l.b4w_initial_rand_rotation&&!l.b4w_hair_billboard,I=4;z&&(I=8);for(var F=0;F<A.length;F+=I){E[0]=A[F];
E[1]=A[F+1];E[2]=A[F+2];var O=A[F+3]*S.d.scale;if(l.b4w_initial_rand_rotation){switch(l.b4w_rotation_type){case "XYZ":var X=new Float32Array([R.Rc(n),R.Rc(n),R.Rc(n)]);V.normalize(X,X);break;case "Z":X=new Float32Array([0,1,0]);break;default:throw"Unsupported random rotation type: "+l.b4w_rotation_type;}ra.setAxisAngle(X,l.b4w_rand_rotation_strength*(2*Math.PI*R.Rc(n)-Math.PI),B)}else z&&(B.set(A.subarray(F+4,F+8)),R.xn(B,B),l.use_whole_group||(l.use_rotation_dupli?ra.multiply(B,S.d.quat,B):ra.multiply(B,
ea,B)));var N=T.create_sep(E,O,B);K.push(N)}H.push(K)}for(var P={},w=0;w<f.length;w++){var Z=g[w],x=u[w],W={};x.Gc&&(W.au_wind_bending_amp=[x.Fd],W.au_wind_bending_freq=[x.ue],W.au_detail_bending_freq=[x.Vd],W.au_detail_bending_amp=[x.Ud],W.au_branch_bending_amp=[x.Qd],x.Fd=0,x.ue=0,x.Vd=0,x.Ud=0,x.Qd=0);var ha=R.Jg(x,0),K=H[w];if(K.length)for(var ga=f[w].data,ka=ga.materials,F=0;F<ka.length;F++)if(!Q.Kq(ga,F))for(var ia=0;ia<Z.length;ia++){var ba=b(Z[ia]),pa=ka[F];if(L(ba,pa)){ba.Zd=Q.Ph;G(ba,x);
ba.mh=l.uuid;"JITTERED"==l.b4w_hair_billboard_type&&(ba.ar=l.b4w_hair_billboard_jitter_amp,ba.br=l.b4w_hair_billboard_jitter_freq);t&&(ba.Cq=l.b4w_dynamic_grass_scale_threshold);y||(delete ba.sb.a_bending_col_main,delete ba.sb.a_bending_col_detail);J(ba,ha);var qa=Q.$p(ga,F,ba.ai,ba.Kc,ba.sb,ba.zg),Sa=Q.cz(qa,W,K),ab=Sa,vb=K;ab.H.au_center_pos=new Float32Array(3*ab.K);for(var Ra=vb.length,Da=ab.K/Ra,gb=0;gb<Ra;gb++)for(var wb=vb[gb],Qa=3*Da*gb,ub=0;ub<Da;ub++)ab.H.au_center_pos[Qa+3*ub]=wb[0],ab.H.au_center_pos[Qa+
3*ub+1]=wb[1],ab.H.au_center_pos[Qa+3*ub+2]=wb[2];Sa=ab;if(x.Gc&&x.wj){var ya=Sa,wa=a.d.T;ya.H.a_emitter_center=new Float32Array(3*ya.K);var xb=ja.fromValues(0,0,0,1);ja.transformMat4(xb,wa,xb);for(var qb=0;qb<ya.K;qb++)ya.H.a_emitter_center[3*qb]=xb[0],ya.H.a_emitter_center[3*qb+1]=xb[1],ya.H.a_emitter_center[3*qb+2]=xb[2];Sa=ya}var xa=l.b4w_vcol_from_name,ic=l.b4w_vcol_to_name,ca=ba,yb=d,Na=!y,za=ga,Aa=[];if(""!==xa&&""!==ic){var jb,Kc=ic,Wa=ca.sb,Rb=[],hb=void 0;for(hb in Wa)for(var Mb=Wa[hb].src,
jc=0,Yb=0;Yb<Mb.length;Yb++){var wc=Mb[Yb].Nc;Kc==Mb[Yb].name&&Rb.push(hb,wc,jc);jc+=R.pg(wc)}jb=Rb;if(0<jb.length)for(var bb=0;bb<jb.length;bb+=3)Aa.push({ki:xa,Pj:7,vk:jb[bb],wk:jb[bb+1],Nj:jb[bb+2]});else Q.Ay(ca.ai,"a_color")&&ic==za.active_vcol_name&&Aa.push({ki:xa,Pj:7,vk:"a_color",wk:7,Nj:0})}Na&&("a_bending_col_main"in yb&&Aa.push({ki:"a_bending_col_main",Pj:4,vk:"a_bending_col_main",wk:4,Nj:0}),"a_bending_col_detail"in yb&&Aa.push({ki:"a_bending_col_detail",Pj:7,vk:"a_bending_col_detail",
wk:7,Nj:0}));for(var Zb=Sa,Pc=K,xc=e,C=Aa,Nb=ba.sb,Ia=!1,Ta=0;Ta<C.length;Ta++){var zb=C[Ta].ki,fa=xc.H[zb];if(fa&&0<fa.length){Ia=!0;break}}if(Ia){var kc,kb=a.d.Pb,cb=xc.A[0].a_position,lc=Pc,ta=P,rb=new Float32Array(3),Ab=new Float32Array(3),ed=new Uint32Array(lc.length);if(!("verts_indices"in ta)){ta.Sd=new Float32Array(3);ta.Pd=new Float32Array(3);ta.oo=new Uint32Array(cb.length/3);ta.Di=new Uint32Array(cb.length/3);ta.Sd[0]=(kb.max_x-kb.min_x)/20;ta.Sd[1]=(kb.max_y-kb.min_y)/20;ta.Sd[2]=(kb.max_z-
kb.min_z)/20;ta.Pd[0]=kb.min_x;ta.Pd[1]=kb.min_y;ta.Pd[2]=kb.min_z;for(var Oa=0;Oa<cb.length/3;Oa++){var Ob=R.trunc((cb[3*Oa]-ta.Pd[0])/ta.Sd[0]),Qc=R.trunc((cb[3*Oa+1]-ta.Pd[1])/ta.Sd[1]),db=R.trunc((cb[3*Oa+2]-ta.Pd[2])/ta.Sd[2]),Ob=R.clamp(Ob,0,19),Qc=R.clamp(Qc,0,19),db=R.clamp(db,0,19);ta.oo[Oa]=Oa;ta.Di[Oa]=db*Math.pow(20,2)+20*Qc+Ob}Q.Es(ta.Di,ta.oo,Q.bl,!0);ta.Ag=new Uint32Array(Math.pow(20,3));for(Oa=0;Oa<ta.Di.length;Oa++)ta.Ag[ta.Di[Oa]]++;delete ta.Di;for(Oa=1;Oa<ta.Ag.length;Oa++)ta.Ag[Oa]+=
ta.Ag[Oa-1]}for(var $b=0;$b<lc.length;$b++){rb[0]=lc[$b][0];rb[1]=lc[$b][1];rb[2]=lc[$b][2];for(var ac=1E10,mc=-1,nc=R.trunc((rb[0]-ta.Pd[0])/ta.Sd[0]),Rc=R.trunc((rb[1]-ta.Pd[1])/ta.Sd[1]),Zc=R.trunc((rb[2]-ta.Pd[2])/ta.Sd[2]),nc=R.clamp(nc,0,19),Rc=R.clamp(Rc,0,19),Zc=R.clamp(Zc,0,19),bc=Zc*Math.pow(20,2)+20*Rc+nc,$c=ta.Ag[bc],lb=0==bc?0:ta.Ag[bc-1];lb<$c;lb++){var Lc=ta.oo[lb];Ab[0]=cb[3*Lc];Ab[1]=cb[3*Lc+1];Ab[2]=cb[3*Lc+2];V.sub(Ab,rb,Ab);var eb=V.sqrLen(Ab);eb<=ac&&(ac=eb,mc=Lc)}if(-1==mc)for(lb=
0;lb<cb.length/3;lb++)Ab[0]=cb[3*lb],Ab[1]=cb[3*lb+1],Ab[2]=cb[3*lb+2],V.sub(Ab,rb,Ab),eb=V.sqrLen(Ab),eb<=ac&&(ac=eb,mc=lb);ed[$b]=mc}kc=ed;for(var yc=Zb.K/Pc.length,Ta=0;Ta<C.length;Ta++){var ib=C[Ta].vk,oc=C[Ta].wk,zb=C[Ta].ki,Bb=C[Ta].Pj,fa=xc.H[zb];switch(ib){case "a_bending_col_main":var Ma=1;break;case "a_bending_col_detail":Ma=3;break;case "a_color":Ma=3;break;default:for(var Db=Ma=0;Db<Nb[ib].src.length;Db++)Ma+=R.pg(Nb[ib].src[Db].Nc)}if(fa&&0<fa.length){var zc=R.pg(Bb),Eb=R.pg(oc),Sb=Bb&
oc,Ac=R.ls(Sb);Sb!=oc&&aa.error("Wrong color extraction from "+zb+" to "+ib+".");if("a_bending_col_main"==ib||"a_bending_col_detail"==ib)Zb.H[ib]=new Float32Array(Zb.K*Eb);for(Db=0;Db<Pc.length;Db++){var Hb=kc[Db],Ua=Hb*zc,Pa=Db*yc*Ma;if(-1!=Hb)for(var Pb=0;Pb<yc;Pb++)for(var Sc=Pb*Ma,Qb=0;Qb<Ac.length;Qb++)Ac[Qb]&&(Zb.H[ib][Pa+Sc+(C[Ta].Nj+R.Si(oc,Qb))]=fa[Ua+R.Si(Bb,Qb)])}}else Zb.H[ib]=new Float32Array(0)}}Sa=Zb;r.push({B:ba,Cc:Sa,Oc:[pa.name],Wb:x,ad:[a]})}}}return r}function L(a,b){var c=!0;
"NODES_GLOW"==a.type&&(c=ka.tp(b));return c=c&&m(a,b)}function J(a,b){for(var c=null,d=null,e=0;e<a.L.length;e++){var f=a.L[e].Rd;f&&(c||(c={}),c[e]=f,a.L[e].Rd=null);if(f=a.L[e].La)d||(d={}),d[e]=f,a.L[e].La=null}a.id=0;a.Qz=b;a.id=R.Jg(a,b);if(c)for(var g in c)a.L[g].Rd=c[g];if(d)for(g in d)a.L[g].La=d[g]}function P(a,c,d,e,f){var g=b("WIREFRAME");z(g,"wireframe.glslv","wireframe.glslf");g.wireframe_mode=0;g.Ng=!0;g.W=!0;g.mh=d;f&&(g.Mp=!0);G(g,c);J(g,R.Jg(c,0));e?(c=ba.mq(1,a.F),Q.cA(c,[a.vf[0],
a.wf[1],a.xf[2]],a.F)):c=ba.mq(a.Da,a.F);Q.Un(c,1,!0);c.H.a_polyindex=Q.Zp(c);I(g,c);return g}function z(a,b,c){a.pb={bj:b,mi:c,Ie:[],Zm:[],nn:[]};ga.kA(a.pb)}function N(a,b,c){1==a.L.length&&0==a.Gb.length&&a.Gb.push("default0");c=c||"default"+String(a.L.length);-1==a.Gb.indexOf(c)&&(a.L.push(b),a.Gb.push(c));a.Xb&&W.Vo(a)}function H(a){if(!a.pb)throw"No shaders info for batch "+a.name;a.Xb=ga.$x(a.pb);W.xv(a.Xb);W.Uo(a);W.Vo(a)}var K=q("__boundings"),O=q("__camera"),X=q("__config"),aa=q("__print"),
Z=q("__extensions"),Q=q("__geometry"),ha=q("__graph"),ka=q("__nodemat"),qa=q("__objects"),w=q("__particles"),ba=q("__primitives"),ma=q("__reformer"),W=q("__renderer"),ia=q("__scenegraph"),ga=q("__shaders"),pa=q("__textures"),T=q("__tsr"),R=q("__util"),V=q("vec3"),ja=q("vec4"),ra=q("quat"),sa=X.o,S=["MAIN","NODES"],ea=new Float32Array([0,-Math.sqrt(.5),0,Math.sqrt(.5)]);a.ZD=b;a.Ox=function(a,e,h,l,m,n,p){for(var r=[],t=[],q=[],v=0;v<h.length;v++){var u=h[v];qa.cc(u)?t.push(u):q.push(u)}v=[];v=v.concat(g(t,
a,p));t=v=v.concat(f(q,a,e,p));v=[];u=[];q={};for(e=0;e<t.length;e++){var T=t[e].B,x=t[e].Wb,V=null;if(T.id in q){var w=q[T.id],H=u[w].B,B=u[w].Wb,E=null,G=null;for(p=0;p<T.L.length;p++){var ea=T.L[p].Rd;ea&&(E||(E={}),E[p]=ea,T.L[p].Rd=null);if(ea=T.L[p].La)G||(G={}),G[p]=ea,T.L[p].La=null}R.Qs(T,H)&&R.Qs(x,B)&&(V=u[w]);if(E)for(p in E)T.L[p].Rd=E[p];if(G)for(p in G)T.L[p].La=G[p];if(!V){do T.id++;while(q[T.id])}}V||(V={B:T,Wb:t[e].Wb,ad:[],Vn:[],Oc:[]},q[T.id]=u.length,u.push(V));V.ad=V.ad.concat(t[e].ad);
t[e].Cc&&t[e].Cc.K&&V.Vn.push(t[e].Cc);V.Oc=V.Oc.length?V.Oc.concat(t[e].Oc):t[e].Oc;Q.Es(V.Oc,V.Vn,Q.Hu,!1)}for(e=0;e<u.length;e++){t=u[e].Vn;if(0==t.length)p=R.lb(R.Qk("%empty"));else if(1==t.length)p=t[0];else{q=[];for(p=0;p<t.length;p++)Q.Qy(t[p])||q.push(p);if(q.length<t.length)for(p=0;p<q.length;p++)Q.Un(t[q[p]]);p=Q.dB(t)}v.push({B:u[e].B,Wb:u[e].Wb,Cc:p,Oc:u[e].Oc,ad:u[e].ad})}r.push.apply(r,v);for(v=0;v<r.length;v++)r[v].B.Pc=r[v].Oc,I(r[v].B,r[v].Cc);for(v=0;v<r.length;v++)if(e=r[v].B,"STATIC"==
r[v].Wb.type&&"COLOR_ID"!=e.type)u=qa.Qq(R.Qk("%meta"),"MESH",!0),u.d=r[v].Wb,u.n=[e],n.push(u);else for(t=[],p=0;p<r[v].ad.length;p++)if(u=r[v].ad[p],-1==t.indexOf(u.name)){for(q=0;q<u.n.length;q++)if(u.n[q]==e)throw"Batch already exist in object";u.n.push(e);t.push(u.name)}if(sa.wireframe_debug){for(v=0;v<r.length;v++)if(e=r[v].Wb,"DYNAMIC"==e.type&&(u=r[v].ad[0],-1<S.indexOf(r[v].B.type))){t=!1;for(p=0;p<u.n.length;p++)u.n[p].Ng&&(t=!0);t||(e=P(e.yf,e,u.name,!0,!0),u.n.push(e))}for(v=0;v<n.length;v++)u=
n[v],e=u.d,-1<S.indexOf(u.n[0].type)&&(e=P(e.Vc,e,u.name,!1),u.n.push(e))}if(m.Rz||m.procedural_skydome){e=b("MAIN");z(e,"special_skydome.glslv","special_skydome.glslf");if(m.procedural_skydome)k(e,"PROCEDURAL_SKYDOME",1),e.Zr=!0;else{if(r=l.Kn){k(e,"WO_SKYTEX",1);v=y(l.Bs,null);N(e,v,"u_sky");r.invert&&k(e,"MTEX_NEGATIVE",1);r.YB&&k(e,"MTEX_RGBTOINT",1);switch(r.fp){case "MIX":v=0;break;case "ADD":v=1;break;case "SUBTRACT":v=2;break;case "MULTIPLY":v=3;break;case "SCREEN":v=4;break;case "OVERLAY":v=
5;break;case "DIFFERENCE":v=6;break;case "DIVIDE":v=7;break;case "DARKEN":v=8;break;case "LIGHTEN":v=9;break;case "HUE":v=10;break;case "SATURATION":v=11;break;case "VALUE":v=12;break;case "COLOR":v=13;break;case "SOFT_LIGHT":v=14;break;case "LINEAR_LIGHT":v=15;break;default:aa.warn('Unknown sky texture blend type"'+r.fp+'"'),v=0}k(e,"BLENDTYPE",v);r.UB&&k(e,"WOMAP_BLEND",1);r.VB&&k(e,"WOMAP_HORIZ",1);r.XB&&k(e,"WOMAP_ZENUP",1);r.WB&&k(e,"WOMAP_ZENDOWN",1)}l.ZB&&k(e,"WO_SKYBLEND",1);l.$B&&k(e,"WO_SKYPAPER",
1);l.aC&&k(e,"WO_SKYREAL",1)}m.Vb&&(e.Vb=!0,m.Mb&&(e.Mb=!0));A(e,"a_position");e.fg=99999;l=ba.Mx();I(e,l);u=qa.Qq(R.Qk("%meta"),"MESH",!0);u.d=qa.Ij("DYNAMIC");u.d.Pg=!0;u.d.Pb=K.Gd();u.d.Vc=K.fj();u.d.bb=K.Gd();u.d.vb=K.fj();u.n=[e];n.push(u)}for(v=0;v<h.length;v++)for(p=0;p<h[v].n.length;p++)d(h[v].n[p]);for(v=0;v<n.length;v++)for(p=0;p<n[v].n.length;p++)d(n[v].n[p]);for(v=0;v<h.length;v++)c(h[v],a);for(v=0;v<n.length;v++)c(n[v],a)};a.lC=function(a,b,c){if(b)b=c*(b.max_y-b.min_y);else throw"No bounding box for mesh";
return 0==b?0:.5*(Math.sqrt(2*Math.sqrt(4*b*Math.tan(a/180*Math.PI)+1)+2)/2-1)/b};a.zv=p;a.Xx=y;a.xB=t;a.nl=function(a,b,c){c&&c.i.type==O.Hb&&k(a,"PERSPECTIVE_SHADOW_CAST",1);k(a,"CSM_SECTION0",0);k(a,"CSM_SECTION1",0);k(a,"CSM_SECTION2",0);k(a,"CSM_SECTION3",0);for(c=0;c<b.csm_num;c++)k(a,"CSM_SECTION"+String(c),1);k(a,"SHADOW_TEX_RES",ga.t(b.csm_resolution));k(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);k(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)};a.ka=k;a.wb=function(a,
b){return ga.dy(a.pb,b)};a.wB=J;a.Hg=N;a.Vz=function(a,b,c){c=a.Gb.indexOf(c);-1<c&&(a.L[c]=b)};a.Gw=function(a,c){var d=b("MAIN");d.Fa=!0;ja.set(c[0],c[1],c[2],.5,d.Mc);d.Zd=Q.jj;I(d,a);z(d,"main.glslv","main.glslf");k(d,"SHADELESS",1);H(d);return d};a.rb=H;a.Ov=function(a){return a.Xb.Ii.length?a.Xb.tn.u_cube_fog?!0:!1:!1};a.tw=function(){var a=b("DEPTH_PACK");a.Ja=!0;a.W=!1;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");H(a);return a};a.Ip=function(a){var c=
b("POSTPROCESSING");z(c,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":k(c,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":k(c,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":k(c,"POST_EFFECT","POST_EFFECT_X_BLUR");break;case "Y_BLUR":k(c,"POST_EFFECT","POST_EFFECT_Y_BLUR");break;case "X_GLOW_BLUR":k(c,"POST_EFFECT","POST_EFFECT_X_GLOW_BLUR");break;case "Y_GLOW_BLUR":k(c,"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR");break;case "X_EXTEND":k(c,
"POST_EFFECT","POST_EFFECT_X_EXTEND");break;case "Y_EXTEND":k(c,"POST_EFFECT","POST_EFFECT_Y_EXTEND");break;default:throw"Wrong postprocessing effect: "+a;}c.Ja=!0;c.W=!1;a=ba.nb();I(c,a);H(c);return c};a.Kw=function(a){var c=b("SSAO");c.W=!1;c.Ja=!0;var d=ba.nb();I(c,d);z(c,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");k(c,"SSAO_QUALITY","SSAO_QUALITY_"+a.Ls);k(c,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={texture:pa.Rx(a)};d={width:4,height:4,data:new Uint8Array([150,123,254,
0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};a=y(a,d);N(c,a,"u_ssao_special_tex");H(c);return c};a.Lw=function(a){var c=b("SSAO_BLUR");c.W=!1;c.Ja=!0;var d=ba.nb();I(c,d);z(c,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");k(c,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);H(c);return c};a.uw=function(){var a=b("DOF");a.W=!1;a.Ja=!0;var c=
ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");k(a,"DEPTH_RGBA",1);H(a);return a};a.Cw=function(){var a=b("OUTLINE");a.W=!1;a.Ja=!0;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");H(a);return a};a.ww=function(){var a=b("GLOW_COMBINE");a.W=!1;a.Ja=!0;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");H(a);return a};a.xw=function(a,c,d){var e=b("GOD_RAYS");e.W=!1;e.Ja=!0;var f=
ba.Hx();I(e,f);z(e,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");k(e,"DEPTH_RGBA",a?1:0);k(e,"WATER_EFFECTS",c?1:0);k(e,"STEPS_PER_PASS",ga.t(d,1));H(e);return e};a.yw=function(){var a=b("GOD_RAYS_COM");a.W=!1;a.Ja=!0;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");H(a);return a};a.Hw=function(){var a=b("SKY");a.W=!1;a.Ja=!0;var c=ba.Ix();I(a,c);z(a,"procedural_skydome.glslv","procedural_skydome.glslf");k(a,"WATER_EFFECTS",
1);H(a);return a};a.nw=function(){var a=b("ANTIALIASING");a.W=!1;a.Ja=!0;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");k(a,"AA_METHOD","AA_METHOD_FXAA_QUALITY");H(a);return a};a.Iw=function(a){var c=b("SMAA"),d=ba.nb();I(c,d);z(c,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");k(c,"AA_METHOD","AA_METHOD_SMAA_HIGH");k(c,"SMAA_PASS",a);k(c,"SMAA_PREDICATION",0);k(c,"SMAA_REPROJECTION",0);H(c);c.W=!1;c.Ja=!0;return c};a.rw=function(){var a=
b("COMPOSITING");a.W=!1;a.Ja=!0;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");H(a);return a};a.Bw=function(){var a=b("MOTION_BLUR");a.Ja=!0;a.W=!1;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");H(a);return a};a.lw=function(){var a=b("ANAGLYPH");a.Ja=!0;a.W=!1;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/anaglyph.glslf");H(a);return a};a.zw=function(){var a=b("LUMINANCE");
a.W=!1;a.Ja=!0;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");H(a);return a};a.ow=function(){var a=b("LUMINANCE");a.W=!1;a.Ja=!0;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");H(a);return a};a.Aw=function(){var a=b("LUMINANCE_X_BLUR");a.W=!1;a.Ja=!0;var c=ba.nb();I(a,c);z(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");H(a);return a};a.pw=function(){var a=b("POSTPROCESSING");
a.Ja=!0;a.W=!1;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");H(a);return a};a.qw=function(){var a=b("BLOOM");a.W=!1;a.Ja=!0;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");H(a);return a};a.Ow=function(){var a=b("VELOCITY");a.W=!1;a.Ja=!0;var c=ba.nb();I(a,c);z(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");H(a);return a};a.mw=function(){var a=b("ANCHOR_VISIBILITY");a.W=
!0;a.Ja=!0;a.Zd=Q.Ao;z(a,"anchors.glslv","anchors.glslf");var c=ba.lq(1);I(a,c);k(a,"ANCHOR_NUM",1);H(a);a.Li=new Float32Array([0,0,0]);return a};a.vB=function(a,b){var c=b.length/3;if(c!=a.Li.length/3){var d=ba.lq(c);I(a,d);k(a,"ANCHOR_NUM",c);H(a)}a.Li=b};a.ba=function(a,b,c){for(var d=0;d<a.n.length;d++)if(a.n[d].type==c&&!a.n[d].Jf&&-1!=a.n[d].Pc.indexOf(b))return a.n[d];return null};a.rc=function(a,b,c){for(var d=0;d<a.n.length;d++)if(a.n[d].type==c&&a.n[d].Jf&&-1!=a.n[d].Pc.indexOf(b))return a.n[d];
return null};a.qs=function(a,b){a.Mc.set(b.Mc);a.He=b.He;a.yd.set(b.yd);a.ic.set(b.ic);a.$d=b.$d;a.Md=b.Md;a.Ge=b.Ge;a.Ae=b.Ae;a.og=b.og;a.Yc.set(b.Yc);a.kg=b.kg;a.shallow_water_col.set(b.shallow_water_col);a.shallow_water_col_fac=b.shallow_water_col_fac;a.shore_water_col.set(b.shore_water_col);a.shore_water_col_fac=b.shore_water_col_fac;a.foam_factor=b.foam_factor;a.Oh=b.Oh};a.$C=function(a,b){for(var c=a.n,d=0;d<c.length;d++)if(c[d].type==b)return!0;return!1};a.bw=function(a){for(var b=a.L,c=0;c<
b.length;c++)pa.ax(b[c].Va);Q.xp(a.R)}};b4w.module.__nodemat=function(a,q){function b(a,b,c,k,p){if(b in ra)return ra[b];for(var r=W.create(),t=a.nodes,v=a.links,q=a.animation_data,y=0;y<t.length;y++)if(!B(r,t[y],0,q,k))return ra[b]=null;if(c&&-1==x(a,r,"GROUP_OUTPUT","group"))return null;y=Z(r);if(!Q(r,v,y))return null;if(c)return r;for(y=0;y<v.length;y++){c=v[y];for(var t=f(c.from_node,r),u=f(c.to_node,r),T=0;T<t.length;T++)for(var R=0;R<u.length;R++){for(var V=t[T],w=u[R],H=W.Ya(r,V),S=W.Ya(r,w),A=r,K=S,S=[],G=c.from_socket.identifier,
z=c.to_socket.identifier,ea=H.Ca,H=0;H<ea.length;H++)if(ea[H].identifier==G){S.push(H);break}K=K.J;for(H=0;H<K.length;H++)if(K[H].identifier==z){S.push(H);break}2==S.length&&W.Uc(A,V,w,S)}}g(r);a=p?x(a,r,"B4W_GLOW_OUTPUT","material",!0):x(a,r,"OUTPUT","material",!1,!0);-1==a&&(r=W.create(),a={data:null,Wd:[],Ra:[],J:[{default_value:new Float32Array([0,0,0]),identifier:"Color",is_linked:!1,name:"Color"},{default_value:1,identifier:"Alpha",is_linked:!1,name:"Alpha"}],Ca:[],type:"OUTPUT",Nh:[]},W.sj(r,
0,a),a=0);h(r);r=W.Rs(r,a,W.yo);d(r);m(r);n(r);l(r);E(r);e(r,q,k);return ra[b]=r}function d(a){W.O(a,function(b,d){for(var e=d.J,f=d.Ca,g=0;g<e.length;g++)c(a,e[g],b,g,1);for(g=0;g<f.length;g++)c(a,f[g],b,g,0)})}function c(a,b,c,d,e){if(b.Eb){var f=!0;W.se(a,function(a,b,g){if(!e&&a==c&&g[0]==d||e&&b==c&&g[1]==d)f=!1});f&&(b.Eb=!1)}}function e(a,b,c){var d=[];W.se(a,function(e,f,g){var h=W.Ya(a,e),l=W.Ya(a,f),h=ga.is_vector(h.Ca[g[0]].Aa),l=ga.is_vector(l.J[g[1]].Aa);if(h!=l){var m,k={default_value:[0,
0,0],identifier:"Vector",is_linked:!0,name:"Vector"},n={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};h&&!l?m=u("vector_to_scalar","B4W_VECTOSCAL",[k],[n]):!h&&l&&(m=u("scalar_to_vector","B4W_SCALTOVEC",[n],[k]));B(a,m,0,b,c);d.push([e,f,a.X[a.X.length-2],g])}});for(var e=0;e<d.length;++e)W.Xe(a,d[e][0],d[e][1],-1),W.Uc(a,d[e][0],d[e][2],[d[e][3][0],0]),W.Uc(a,d[e][2],d[e][1],[0,d[e][3][1]])}function g(a){var b=[];W.O(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":W.se(a,function(a,
e,f){a==c&&"Translucency"==d.Ca[f[0]].name&&b.push(a,e,[f[0]+1,f[1]+1])})}});for(var c=0;c<b.length;c+=3)W.Uc(a,b[c],b[c+1],b[c+2])}function f(a,b){var c=[];W.O(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;throw"Node not found";}function h(a){var b=[];W.O(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],e=b[c+1];if("B4W_PARALLAX"==e.type){var f=p(a,d);if(-1!=f){var g=W.Tj(a,f,0);W.Xe(a,f,d,-1);-1!=g&&W.Xe(a,g,f,-1);
d=W.Ya(a,f);e.data=d.data;e.Ra[0]=d.Ra[0];W.ph(a,f)}e.J.splice(1,1)}else if("REROUTE"==e.type){for(var e=W.Tj(a,d,0),h=W.ig(a,d),f=[],g=[],l=[],m=0;m<h;m++){var k=W.Of(a,d,m),n=g.indexOf(k);-1!=n?l[n]+=1:(g.push(k),l.push(1),f.push(d,k))}if(-1!=e)for(h=W.Nf(a,e,d,0)[0],m=0;m<g.length;m++)for(k=0;k<l[m];k++)n=W.Nf(a,d,g[m],k)[1],W.Uc(a,e,g[m],[h,n]);for(m=0;m<f.length;m+=2)W.Xe(a,f[m],f[m+1],-1)}}}function p(a,b){for(var c=a.oa,d=0;d<c.length;d+=3)if(c[d+1]==b&&1==c[d+2][1])return c[d];return-1}function l(a){var b=
[],c="",d="",e={};W.O(a,function(a,f){if("GEOMETRY_UV"==f.type||"UVMAP"==f.type||"TEX_COORD_UV"==f.type){b.push(a,f);var g=f.data.value;c?c==g||d||(d=g,e[d]=0):(c=g,e[c]=0);e[g]++}});for(var f in e)if(2>e[f]){for(var g=0;g<b.length;g+=2)b[g+1].data.value==f&&b.splice(g,2);delete e[f];c==f&&(c=d,d="");d==f&&(d="")}if(!(3>b.length)){var g={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},h={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};f=u("merged_uv",
"UV_MERGED",[],[g,h]);f.uv_layer=c;B(a,f,0,null,"");var l=a.X[a.X.length-2];f=a.X[a.X.length-1];if(d){h=u("merged_uv","UV_MERGED",[],[g,h]);h.uv_layer=d;B(a,h,0,null,"");var m=a.X[a.X.length-2],h=a.X[a.X.length-1]}else h=null;for(var k=-1,n=null,g=0;g<b.length;g+=2){var p=b[g],r=b[g+1];v(r,b[1])?(k=l,n=f):h&&(k=m,n=h);for(var t=[],y=W.ig(a,p),q={},T=0;T<y;T++){var R=W.Of(a,p,T);R in q||(q[R]=0);var V=W.Nf(a,p,R,q[R]++);t.push(p,R,V);V=V.splice(0,V.length);switch(r.type){case "GEOMETRY_UV":V[0]=0;
n.Ca[0].Eb=!0;break;case "UVMAP":case "TEX_COORD_UV":V[0]=1,n.Ca[1].Eb=!0}W.Uc(a,k,R,V)}for(var T=0;T<t.length;T+=3)W.Xe(a,t[T],t[T+1],0);W.ph(a,p)}}}function m(a){var b=[];W.O(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type||b.push(a,c)});for(var c=[],d=0;d<b.length;d+=2){for(var e=b[d],f=b[d+1],g=!0,h=0;h<c.length;h++){var l=c[h];if(y(f,l.lc)){g=[];h=W.ig(a,e);for(n=0;n<
h;n++){var m=W.Of(a,e,n),k=W.Nf(a,e,m,0);g.push(e,m,k);W.Uc(a,l.id,m,k)}for(var n=0;n<g.length;n+=3)W.Xe(a,g[n],g[n+1],0);W.ph(a,e);g=!1;break}}g&&(l={id:e,lc:f},c.push(l))}}function r(a){for(var b={},c=0;c<a.X.length;c+=2){var d=a.X[c];b[d]=[]}for(c=0;c<a.oa.length;c+=3){var e=a.oa[c],f=a.oa[c+1];b[f].push(e);b[f].push(b[e])}for(d in b)b[d]=JSON.stringify(b[d]).match(/\d+/g)||[],b[d]=b[d].map(function(a){return parseInt(a)});return b}function n(a){var b=[];W.O(a,function(a,c){"TEXTURE_COLOR"!=c.type&&
"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=r(a),d=[],e=0;e<b.length;e+=2){for(var f=b[e],g=b[e+1],h=!0,l=0;l<d.length;l++){var m=d[l];if(!(3<=m.ih.length||!y(g,m.lc)||-1<c[f].indexOf(m.id)||-1<c[m.id].indexOf(f))){for(var k=!1,n=0;n<m.ih.length;n++){var p=m.ih[n].id;if(-1<c[f].indexOf(p)||-1<c[p].indexOf(f)){k=!0;break}}if(!k){for(var l=[],p=W.Pq(a,f),t={},n=0;n<p;n++)k=W.Tj(a,f,n),k in t||(t[k]=0),h=W.Nf(a,k,f,t[k]++),l.push(k,f,h);for(var p=[],t=W.ig(a,f),v={},n=0;n<t;n++)k=
W.Of(a,f,n),k in v||(v[k]=0),h=W.Nf(a,f,k,v[k]++),p.push(f,k,h);h=l.concat(p);for(n=0;n<h.length;n+=3)W.Xe(a,h[n],h[n+1],0);W.ph(a,f);n={id:f,lc:g,ix:l,jx:p};m.ih.push(n);h=!1;break}}}h&&(m={id:f,lc:g,ih:[]},d.push(m))}for(e=0;e<d.length;e++){m=d[e];c=m.ih.length;for(l=0;l<c;l++){g=m.ih[l];n=g.lc;f=g.ix;g=g.jx;m.lc.J[l+1].Eb=n.J[0].Eb;m.lc.J[l+1].Aa=n.J[0].Aa;m.lc.Ca[2*(l+1)].Eb=n.Ca[0].Eb;m.lc.Ca[2*(l+1)].Aa=n.Ca[0].Aa;m.lc.Ca[2*(l+1)+1].Eb=n.Ca[1].Eb;m.lc.Ca[2*(l+1)+1].Aa=n.Ca[1].Aa;for(n=0;n<f.length;n+=
3)k=f[n],h=f[n+2],h[1]+=l+1,W.Uc(a,k,m.id,h);for(n=0;n<g.length;n+=3)k=g[n+1],h=g[n+2],h[0]+=2*(l+1),W.Uc(a,m.id,k,h);m.lc.Wd.push(["USE_uv"+(l+2),1])}W.ph(a,m.id);W.sj(a,m.id,m.lc)}}}function y(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":return!0;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value==b.data.value;default:return!1}}
function v(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:!1}function E(a){var b=[];W.O(a,function(a,c){"GEOMETRY_VC"==c.type&&b.push(a,c)});for(var c=0;c<b.length;c+=2){for(var d=b[c],e=b[c+1],f=!1,g=[],h=[],l=[[],[],[]],m=W.ig(a,d),k=0;k<m;k++){var n=W.Of(a,d,k);if("SEPRGB"!=W.Ya(a,n).type){f=!1;break}g.push(d,n);for(var p={},r=W.ig(a,n),f=0;f<r;f++){var t=W.Of(a,n,f);t in p||(p[t]=0);var v=W.Nf(a,n,t,p[t]++);g.push(n,
t);l[v[0]].push(d,t,v)}h.push(n);f=!0}if(f){for(k=d=m=0;k<l.length;k++)l[k].length&&(m++,d|=1<<2-k);if(m){e.type+=m;e.Ca=[];for(k=0;k<l.length;k++)if(l[k].length)for(e.Ca.push({Aa:0,identifier:"RGB"[k],Eb:!0,name:"RGB"[k]}),f=0;f<l[k].length;f+=3)l[k][f+2][0]=ga.Si(d,k);for(k=0;k<g.length;k+=2)W.Xe(a,g[k],g[k+1],0);for(k=0;k<h.length;k++)W.ph(a,h[k]);for(k=0;k<l.length;k++)for(f=0;f<l[k].length;f+=3)W.Uc(a,l[k][f],l[k][f+1],l[k][f+2])}}}}function x(a,b,c,d,e,g){a=a.nodes;for(var h=null,l=0;l<a.length;l++){var m=
a[l];e?"GROUP"==m.type&&m.node_tree_name==c&&(h=m):m.type==c&&(h=m)}return h?f(h,b)[0]:(g||ma.error('No "'+c+'" node in node '+d),-1)}function u(a,b,c,d){return{name:a,type:b,inputs:c,outputs:d}}function B(a,b,c,d,e){var f=b.name,g=b.type,h=[],l=[],m=[],n=[],p=null,r=[];switch(g){case "BSDF_ANISOTROPIC":case "BSDF_DIFFUSE":case "BSDF_GLOSSY":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "EMISSION":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BUMP":case "NORMAL_MAP":case "VECT_TRANSFORM":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_IMAGE":case "TEX_ENVIRONMENT":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_VORONOI":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "LAYER_WEIGHT":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "PARTICLE_INFO":case "HAIR_INFO":case "OBJECT_INFO":case "SCRIPT":l=
K(b);m=O(b);ma.warn(g+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":case "MIX_SHADER":l=K(b);m=O(b);break;case "UVMAP":var p=k("param_"+g+"_a"),v=k("param_"+g+"_v");h.push(X(p));h.push(X(v));m=O(b);n.push(X(v));p={name:p,value:b.uv_layer};break;case "UV_MERGED":p=k("param_UV_MERGED_a");v=k("param_UV_MERGED_v");h.push(X(p));h.push(X(v));m.push(z(b,"UV_geom"));m.push(z(b,"UV_cycles"));n.push(X(v));p={name:p,value:b.uv_layer};break;case "CAMERA":l=[];m=O(b);break;case "COMBRGB":case "COMBHSV":l=
K(b);m=O(b);break;case "CURVE_RGB":l=K(b);m=O(b);ma.warn("CURVE_RGB node is not fully supported.");break;case "CURVE_VEC":l=K(b);m=O(b);ma.warn("CURVE_VEC node is not fully supported.");break;case "GEOMETRY":if(!I(b))return!0;g=F(b,c);if(!g)return ma.error("Geometry output is not supported"),!1;switch(g){case "GEOMETRY_UV":if(!b.uv_layer)return ma.error('Missing uv layer in node "',b.name,'"'),!1;p=k("param_GEOMETRY_UV_a");v=k("param_GEOMETRY_UV_v");h.push(X(p));h.push(X(v));m.push(z(b,"UV"));n.push(X(v));
p={name:p,value:b.uv_layer};break;case "GEOMETRY_VC":if(!b.color_layer)return ma.error("Missing vertex color layer in node ",b.name),!1;p=k("param_GEOMETRY_VC_a");v=k("param_GEOMETRY_VC_v");h.push(X(p));h.push(X(v));m.push(z(b,"Vertex Color"));n.push(X(v));p={name:p,value:b.color_layer};break;case "GEOMETRY_NO":m.push(z(b,"Normal"));break;case "GEOMETRY_FB":m.push(z(b,"Front/Back"));break;case "GEOMETRY_VW":m.push(z(b,"View"));break;case "GEOMETRY_GL":m.push(z(b,"Global"));break;case "GEOMETRY_LO":m.push(z(b,
"Local"));break;case "GEOMETRY_OR":v=k("param_GEOMETRY_OR_v"),h.push(X(v)),m.push(z(b,"Orco")),n.push(X(v))}break;case "TEX_COORD":if(!I(b))return!0;g=L(b,c);if(!g)return ma.error("Texture coordinate output is not supported"),!1;switch(g){case "TEX_COORD_UV":p=k("param_TEX_COORD_UV_a");v=k("param_TEX_COORD_UV_v");h.push(X(p));h.push(X(v));m.push(z(b,"UV"));n.push(X(v));p={name:p,value:b.uv_layer};break;case "TEX_COORD_NO":m.push(z(b,"Normal"));break;case "TEX_COORD_GE":v=k("param_TEX_COORD_GE_v");
h.push(X(v));m.push(z(b,"Generated"));n.push(X(v));break;case "TEX_COORD_OB":m.push(z(b,"Object"));ma.warn('Output "Object" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_CA":m.push(z(b,"Camera"));break;case "TEX_COORD_WI":m.push(z(b,"Window"));ma.warn('Output "Window" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_RE":m.push(z(b,"Reflection")),ma.warn('Output "Reflection" of node "Texture Coordinate" doesn\'t supported fully.')}break;
case "GROUP":v=b.node_tree_name;switch(v){case "B4W_LINEAR_TO_SRGB":if(!t(b,[1],[1])){p=G(b,e);break}g="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!t(b,[1],[1])){p=G(b,e);break}g="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!t(b,[1],[1])){p=G(b,e);break}g="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!t(b,[1,1],[1])){p=G(b,e);break}g="B4W_REFLECT";break;case "B4W_REFRACTION":if(!t(b,[1,0],[1])){p=G(b,e);break}g="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!t(b,
[1,1,0,0,0],[1])){p=G(b,e);break}var g="B4W_PARALLAX",y=k("temp_texture");n.push(X(y));break;case "B4W_CLAMP":if(!t(b,[1],[1])){p=G(b,e);break}g="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!t(b,[0,0,0,0,0],[0])){p=G(b,e);break}g="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!t(b,[],[0])){p=G(b,e);break}g="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!t(b,[0,0,0],[0])){p=G(b,e);break}g="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":g="B4W_GLOW_OUTPUT";break;default:p=G(b,e)}l=K(b);m=O(b);"B4W_TRANSLUCENCY"==
v&&(v=H("TranslucencyParams","TranslucencyParams",[0,0,0,0]),v.Eb=m[0].Eb,m.push(v));break;case "LAMP":p=b.lamp;if(!p)return ma.error("There is no lamp in node: "+b.name),!1;m.push(z(b,"Color"));m.push(z(b,"Light Vector"));m.push(z(b,"Distance"));m.push(z(b,"Visibility Factor"));p.uuid in sa?r.push(["LAMP_INDEX",String(sa[p.uuid])]):(sa[p.uuid]=S,r.push(["LAMP_INDEX",String(S++)]));p=sa;break;case "NORMAL":l=K(b);m=O(b);v=z(b,"Normal");n.push(X(k("param_NORMAL_Normal"),v.Aa,3));break;case "MAPPING":v=
b.vector_type;g="MAPPING";l.push(P(b,"Vector"));m.push(z(b,"Vector"));var y=b.rotation,q=b.scale,u=b.translation,x=R.create(),w=ga.mx(y),A=new Float32Array([q[0],0,0,0,q[1],0,0,0,q[2]]);R.multiply(w,A,x);x=ga.ez(x,V.create());switch(v){case "POINT":x[12]=u[0];x[13]=u[1];x[14]=u[2];break;case "TEXTURE":x[12]=u[0];x[13]=u[1];x[14]=u[2];x=V.invert(x,x);break;case "NORMAL":V.invert(x,x),V.transpose(x,x)}switch(v){case "NORMAL":r.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":r.push(["MAPPING_TRS_MATRIX",
ia.t(x,16)]);break;case "POINT":0!==T.length(y)?r.push(["MAPPING_TRS_MATRIX",ia.t(x,16)]):(0!==T.length(q)&&r.push(["MAPPING_SCALE",ia.t(q,3)]),0!==T.length(u)&&r.push(["MAPPING_TRANSLATION",ia.t(u,3)]));break;case "VECTOR":0!==T.length(y)?r.push(["MAPPING_TRS_MATRIX",ia.t(x,16)]):0!==T.length(q)&&r.push(["MAPPING_SCALE",ia.t(q,3)])}b.use_min&&r.push(["MAPPING_MIN_CLIP",ia.t(b.min,3)]);b.use_max&&r.push(["MAPPING_MAX_CLIP",ia.t(b.max,3)]);break;case "MATERIAL":case "MATERIAL_EXT":p=P(b,"Color");p.Aa.splice(3);
l.push(p);(p=P(b,"Alpha"))?l.push(p):l.push(H("Alpha","Alpha",1));p=P(b,"Spec");p.Aa.splice(3);l.push(p);v=P(b,"Normal");v.Aa.splice(3);l.push(v);m.push(z(b,"Color"));m.push(z(b,"Alpha"));m.push(z(b,"Normal"));"MATERIAL_EXT"==g&&((p=P(b,"Emit"))?l.push(p):l.push(H("Emit","Emit",0)),p=P(b,"Translucency"),p.Aa=0,p.name="Translucency",p.identifier="Translucency",p?l.push(p):l.push(H(p.name,p.identifier,p.Aa)),p=P(b,"Translucency"),p.Aa=[0,0,0,0],p.name="TranslucencyParams",p.identifier="TranslucencyParams",
p?l.push(p):l.push(H(p.name,p.identifier,p.Aa)),p=P(b,"Reflectivity"),y=P(b,"Ray Mirror"),p?y="Reflectivity":y?(p=y,y="Ray Mirror"):y="Reflectivity",p?l.push(p):l.push(H(y,y,0)),(p=P(b,"SpecTra"))?l.push(p):l.push(H("SpecTra","SpecTra",0)),m.push(z(b,"Diffuse")),m.push(z(b,"Spec")));y=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":p=b.specular_hardness;break;case "WARDISO":p=b.specular_slope;break;case "TOON":p=b.specular_toon_size;y=b.specular_toon_smooth;break;default:ma.error("unsupported specular shader: "+
b.specular_shader+' (material "'+b.material_name+'")'),p=b.specular_hardness}switch(b.diffuse_shader){case "LAMBERT":u=q=0;break;case "OREN_NAYAR":q=b.roughness;u=0;break;case "FRESNEL":q=b.diffuse_fresnel;u=b.diffuse_fresnel_factor;break;default:ma.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),u=q=0}n.push(X(k("param_MATERIAL_diffuse"),[q,u],2));n.push(X(k("param_MATERIAL_spec"),[b.specular_intensity,p,y],3));p={name:b.name,value:{RA:b.specular_shader,
dx:b.diffuse_shader,yg:b.use_shadeless,vh:b.specular_alpha}};v.Eb&&r.push(["USE_MATERIAL_NORMAL",1]);b.use_diffuse&&r.push(["USE_MATERIAL_DIFFUSE",1]);b.use_specular&&r.push(["USE_MATERIAL_SPECULAR",1]);break;case "MATH":switch(b.operation){case "ADD":g="MATH_ADD";break;case "SUBTRACT":g="MATH_SUBTRACT";break;case "MULTIPLY":g="MATH_MULTIPLY";break;case "DIVIDE":g="MATH_DIVIDE";break;case "SINE":g="MATH_SINE";break;case "COSINE":g="MATH_COSINE";break;case "TANGENT":g="MATH_TANGENT";break;case "ARCSINE":g=
"MATH_ARCSINE";break;case "ARCCOSINE":g="MATH_ARCCOSINE";break;case "ARCTANGENT":g="MATH_ARCTANGENT";break;case "POWER":g="MATH_POWER";break;case "LOGARITHM":g="MATH_LOGARITHM";break;case "MINIMUM":g="MATH_MINIMUM";break;case "MAXIMUM":g="MATH_MAXIMUM";break;case "ROUND":g="MATH_ROUND";break;case "LESS_THAN":g="MATH_LESS_THAN";break;case "GREATER_THAN":g="MATH_GREATER_THAN";break;case "MODULO":g="MATH_MODULO";break;case "ABSOLUTE":g="MATH_ABSOLUTE";break;default:return ma.error("Unsupported MATH operation: "+
b.operation),!1}r.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);l=K(b);m=O(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":g="MIX_RGB_MIX";break;case "ADD":g="MIX_RGB_ADD";break;case "MULTIPLY":g="MIX_RGB_MULTIPLY";break;case "SUBTRACT":g="MIX_RGB_SUBTRACT";break;case "SCREEN":g="MIX_RGB_SCREEN";break;case "DIVIDE":g="MIX_RGB_DIVIDE";break;case "DIFFERENCE":g="MIX_RGB_DIFFERENCE";break;case "DARKEN":g="MIX_RGB_DARKEN";break;case "LIGHTEN":g="MIX_RGB_LIGHTEN";break;case "OVERLAY":g="MIX_RGB_OVERLAY";
break;case "DODGE":g="MIX_RGB_DODGE";break;case "BURN":g="MIX_RGB_BURN";break;case "HUE":g="MIX_RGB_HUE";break;case "SATURATION":g="MIX_RGB_SATURATION";break;case "VALUE":g="MIX_RGB_VALUE";break;case "COLOR":g="MIX_RGB_COLOR";break;case "SOFT_LIGHT":g="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":g="MIX_RGB_LINEAR_LIGHT";break;default:return ma.error("Unsupported MIX_RGB blend type: "+b.blend_type),!1}r.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);l=K(b);m=O(b);break;case "OUTPUT":l=K(b);m=[];
break;case "RGB":v=e+"%join%"+b.name;v={name:"-1",value:v};n.push(v);m.push(z(b,"Color"));break;case "SEPRGB":case "SEPHSV":l=K(b);m=O(b);break;case "TEXTURE":g=J(b);if("TEXTURE_EMPTY"==g)m.push(z(b,"Color")),m.push(z(b,"Normal")),m.push(z(b,"Value"));else if("TEXTURE_ENVIRONMENT"==g)l.push(P(b,"Vector")),m.push(z(b,"Color")),m.push(z(b,"Value"));else{if("TEXTURE_NORMAL"==g&&"ENVIRONMENT_MAP"==b.texture.type)return ma.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),!1;for(q=0;4>q;++q)q?
(p=H("Vector"+q,"Vector"+q,[0,0,0]),"TEXTURE_COLOR"==g&&(v=H("Color"+q,"Color"+q,[0,0,0]),y=H("Value"+q,"Value"+q,0)),"TEXTURE_NORMAL"==g&&(v=H("Normal"+q,"Normal"+q,[0,0,0]),y=H("Value"+q,"Value"+q,0))):(p=P(b,"Vector"),"TEXTURE_COLOR"==g&&(v=z(b,"Color"),y=z(b,"Value")),"TEXTURE_NORMAL"==g&&(v=z(b,"Normal"),y=z(b,"Value"))),l.push(p),m.push(v),m.push(y)}y=k("param_TEXTURE_texture");n.push(X(y));p={name:y,value:b.texture};break;case "VALTORGB":l=K(b);m=O(b);ma.warn("VALTORGB node is not fully supported.");
break;case "VALUE":g="VALUE";v=e+"%join%"+b.name;v={name:"-1",value:v};n.push(v);m.push(z(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":g="VECT_MATH_ADD";break;case "SUBTRACT":g="VECT_MATH_SUBTRACT";break;case "AVERAGE":g="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":g="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":g="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":g="VECT_MATH_NORMALIZE";break;default:return ma.error("Unsupported VECT_MATH operation: "+b.operation),!1}l=K(b);
m=O(b);break;default:l=K(b),m=O(b)}f={name:f,type:g,Nh:h,J:l,Ca:m,Ra:n,data:p,Wd:r};W.sj(a,W.kq(a),f);if(!(f="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type)){a:{f=b.outputs;for(h=g=0;h<f.length;h++)if(f[h].is_linked&&g++>c){f=!0;break a}f=!1}f=!f}return f||B(a,b,++c,d,e)?!0:!1}function t(a,b,c){for(var d=a.inputs,e=a.outputs,f=a.node_tree_name,g=0;g<b.length;g++){var h=d[g],l=b[g];if(!h||h.default_value instanceof Array!=l)return ma.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),
!1}for(g=0;g<c.length;g++)if(b=e[g],d=c[g],!b||b.default_value instanceof Array!=d)return ma.warn('Wrong outputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1;return!0}function G(a,c){var d=a.node_group.node_tree,e={},f;for(f in d)if("links"==f||"nodes"==f){e[f]=[];for(var g=0;g<d[f].length;g++){e[f][g]={};for(var h in d[f][g])if("links"==f){e[f][g][h]={};for(var l in d[f][g][h])e[f][g][h][l]=A(d[f][g][h][l])}else e[f][g][h]=A(d[f][g][h])}}else e[f]=A(d[f]);
d=a.node_tree_name;if("B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d)f=u("Group input","GROUP_INPUT",[],a.inputs),g=u("Group output","GROUP_OUTPUT",a.outputs,[]),h=null,h="B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d&&(ea.quality==pa.P_LOW||ea.pm)?{from_node:f,from_socket:f.outputs[1],to_node:g,to_socket:g.inputs[0]}:{from_node:f,from_socket:f.outputs[0],to_node:g,to_socket:g.inputs[0]},e.nodes=[f,g],e.links=[h];d=a.name;f=e.nodes;g=e.links;for(h=0;h<f.length;h++)f[h].name=aa(f[h].type,d,f[h].name);
for(h=0;h<g.length;h++)g[h].from_node.name=aa(g[h].from_node.type,d,g[h].from_node.name),g[h].to_node.name=aa(g[h].to_node.type,d,g[h].to_node.name);return{oz:b(e,a.node_group.uuid,!0,c),pz:e.links}}function A(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?ga.Fj(a):a}function k(a){ja[a]||(ja[a]=0);var b=a+ja[a],b=b.replace(/ /g,"_").replace(/\//g,"_");ja[a]++;return b}function I(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function F(a,b){for(var c=
a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";case "Normal":return"GEOMETRY_NO";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";default:return null}}}function L(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function J(a){if(!a.texture)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,e=!1,f=0;f<b.length;f++){var g=b[f];if(g.is_linked)switch(g.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":e=!0;break;default:throw"Unknown texture output";}}if(c)return d&&
ma.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function P(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return N(e)}return null}function z(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return N(e)}return null}function N(a){var b=
a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=ga.is_vector(a)?a.slice(0):a;return{name:b,identifier:c,Eb:d,Aa:a}}function H(a,b,c){return{name:a,identifier:b,Eb:!1,Aa:c}}function K(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=N(a.inputs[c]);d.Aa.length&&d.Aa.splice(3);b.push(d)}return b}function O(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=N(a.outputs[c]);b.push(d)}return b}function X(a,b,c){b=null===b||void 0===b?null:ia.t(b,c);return{name:a,value:b}}function aa(a,b,c){return"GROUP_INPUT"==
a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function Z(a){var b=[];W.O(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function Q(a,b,c){for(var d=0;d<c.length;d++){var e=c[d].data.oz,f=c[d].data.pz;if(!e)return!1;W.O(e,function(b,c){W.sj(a,W.kq(a),c)});for(e=0;e<f.length;e++)b.push(f[e]);ba(c[d],b,a)}return!0}function ha(a,b,c,d,e,f){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||e.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+
"*GO*")||f.push(c)}}function ka(a,b,c){for(var d=[],e=0;e<c.length;e++){for(var f=c[e],g=null,h=0;h<b.length;h++)if(f.from_socket.identifier==b[h].to_socket.identifier){g=b[h];break}g?(f.from_node=g.from_node,f.from_socket=g.from_socket):d.push(f)}for(e=0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return d}function qa(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function w(a,b,c,d){for(var e=0;e<d.length;e++){for(var g=d[e],h,l=0;l<c.J.length;l++)if(g.from_socket.identifier==
c.J[l].identifier){h=c.J[l].Aa;break}for(var l=g,m=b,k=h,n=f(l.to_node,m),p=0;p<n.length;p++)for(var r=W.Ya(m,n[p]),t=0;t<r.J.length;t++)if(r.J[t].identifier==l.to_socket.identifier){r.J[t].Aa=k;break}g=a.indexOf(g);-1!=g&&a.splice(g,1)}}function ba(a,b,c){for(var d=a.name,e=[],f=[],g=[],h=[],l=0;l<b.length;l++){var m=b[l];ha(m.from_node,d,m,e,g,h);ha(m.to_node,d,m,f,g,h)}f=ka(b,f,g);e=ka(b,h,e);qa(b,f);w(b,c,a,f);if(e.length){var k;W.O(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||
(k=b)});w(b,c,k,e)}}var ma=q("__print"),W=q("__graph"),ia=q("__shaders"),ga=q("__util"),pa=q("__config"),T=q("vec3");q("vec4");var R=q("mat3"),V=q("mat4"),ja={},ra={},sa={},S=0;new Float32Array(4);var ea=pa.o;a.dw=b;a.ew=function(a){var b=[],c={};ja={};var d=W.bo(a);W.O(d,function(a,d){var e;e=[];for(var f=[],g=[],h=[],l=[],m=[],n=0;n<d.J.length;n++){var p=d.J[n];if(p.Eb)e.push(null),f.push(null);else{e.push(k("in_"+d.type+"_"+p.identifier));var r=ia.t(p.Aa,0);ea.us&&(0<=d.type.indexOf("MIX_RGB_")&&
("Color1"==p.identifier||"Color2"==p.identifier||"Fac"==p.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==p.identifier||"Value_001"==p.identifier)||0<=d.type.indexOf("VECT_MATH_")&&"Vector_001"==p.identifier)&&(p=r,p=p.replace(/(,)/g,"$1 "),p=p.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1ZERO_VALUE_NODES$3"),p=p.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1UNITY_VALUE_NODES$3"),r=p=p.replace(/\s+/g,""));f.push(r)}}for(n=0;n<d.Ca.length;n++)p=d.Ca[n],p.Eb?g.push(null):g.push(k("out_"+d.type+
"_"+p.identifier));for(n=0;n<d.Ra.length;n++)p=d.Ra[n],h.push(p.name),l.push(p.value);for(n=0;n<d.Nh.length;n++)m.push(d.Nh[n].name);e={id:d.type,J:e,Nm:f,Ca:g,Ra:h,uk:l,Nh:m,Wd:JSON.parse(JSON.stringify(d.Wd))};b.push(e);c[a]=e});W.se(d,function(a,b,e){var f=W.Ya(d,a);W.Ya(d,b);var g=f.Ca[e[0]];a=c[a].Ca;b=c[b].J;f=a[e[0]]||k("out_"+f.type+"_"+g.identifier);a[e[0]]=f;b[e[1]]=f});return b};a.tp=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==
c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.cleanup=function(){for(var a in ra)delete ra[a];for(var b in sa)delete sa[b];S=0}};b4w.module.__animation=function(a,q){function b(a,b){var c=a.D[b];c&&c.mm&&c.li&&(c.li=!1,c.mm(a))}function d(a,b,c){c=a.D[c];c.type=30;var d=b.frame_start,e=b.frame_end-d+1;c.start=d;c.length=e;c.oc=d;c.Fg=b.name;for(e=d=0;e<a.data.b4w_vertex_anim.length;e++){var f=a.data.b4w_vertex_anim[e];if(f==b)break;else d+=f.frame_end-f.frame_start+1}c.mt=d}function c(a,b,c){a=a.D[c];a.type=50;a.Fg=b.name;c=b.settings;a.start=c.frame_start;a.length=c.frame_end-a.start;b.settings.b4w_cyclic||(a.length+=c.lifetime);
a.uc=b}function e(a){return a.replace(/_B4W_BAKED$/,"")}function g(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:w.pa("Wrong animation behavior")}}function f(a){var b=[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c].node_tree;d&&h(d,b)}return b}function h(a,b){if(a.animation_data){var c=a.animation_data.action;c&&w.qd(c.fcurves)&&b.push(c)}for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];e.node_group&&(e=e.node_group.node_tree)&&
h(e,b)}}function p(a){return w.is_mesh(a)&&a.d.Xk?!0:!1}function l(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}function m(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function r(a,c,d,e){t(a,c,d,e);b(a,d);a.d.Ce&&(k(a,c),A(a,c))}function n(a,b,c){var d=b.frame_range,e=b.d,f=a.D[c];f.Fg=b.name;f.gl=d;f.No=e.zz;f.Mo=e.Bv;f.Ej=e.Ej;f.start=d[0];f.length=d[1]-d[0];f.oc=d[0];d=w.qd(e.zj);if(w.is_armature(a)&&d){f.type=
10;var g=y(a,b);g||(g=I(a,b,x(a)),a.Ld.push(b,g));f.h=g.h;f.ya=g.ya;var f=a.d,g=f.Kk,h=a.D[c],e=h.In,l;a:{l=f.ws;for(var m=0;m<l.length;m+=2)if(b==l[m]){l=l[m+1];break a}l=null}if(l)h.In=l;else{for(h=0;h<g.length;h++)l=I(a,b,g[h].Kc),e.push(l);f.ws.push(b,e)}f.Ce&&(b=f.Pk,c>b[1]?(f=b[1],b[1]=c,b[0]=f):c>b[0]&&c<b[1]&&(b[0]=c),v(a))}else if(ha.ge(a)&&(e.Ra.volume||e.Ra.pitch))f.volume=e.Ra.volume||null,f.pitch=e.Ra.pitch||null,f.type=40;else if("MESH"==a.type&&B(b)){f.type=60;e=y(a,b);if(!e){e=[];
h=[];l=[];var m=[],k=b.d,n=a.d.hk,p=a.d.ik;for(g in k.Ra){var r=b.name+"%join%"+g;u(g,r,k,h,e,n);u(g,r,k,m,l,p)}e={cC:e,values:h,Wz:l,Xz:m};a.Ld.push(b,e)}f.tr=e.cC;f.vr=e.values;f.sr=e.Wz;f.ur=e.Xz}else if(g=e.Ra.tsr){f.type=20;e=y(a,b);if(!e){e=b.d.zr;h=[];l=[];for(m=0;m<e;m++)h.push(g.subarray(8*m,8*m+4)),l.push(g.subarray(8*m+4,8*m+8));e={h:h,ya:l};a.Ld.push(b,e)}f.h=e.h;f.ya=e.ya;aa.Yg(a)&&aa.OB(a,f.h[0],f.ya[0])}else return Q.warn('Incompatible action "'+b.name+'" has been applied to object "'+
a.name+'"'),!1;w.is_armature(a)&&!d&&E(a,c);return!0}function y(a,b){for(var c=a.Ld,d=0;d<c.length;d+=2)if(b==c[d])return c[d+1];return null}function v(a){var b=a.d.Pk;if(-1!=b[0]&&-1!=b[1]){var c=a.D;a=c[b[1]].oc;var d=Math.floor(a),e=a-d,b=c[b[0]];a=b.oc;d=Math.floor(a);b.oc=d+e}}function E(a,b){var c=a.d.Pk,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var e=a.D;0<=d;d--){var f=e[d];if(f&&10==f.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function x(a){var b=a.data.bones;a=a.pose.bones;for(var c=
{},d=0;d<b.length;d++){var e=b[d].name;c[e]={ip:d,fi:d,un:w.Am(a,"name",e),pt:-1}}return c}function u(a,b,c,d,e,f){for(var g=0;g<f.length;g+=2)b==f[g]&&(e.push(f[g+1]),d.push(new Float32Array(c.Ra[a])))}function B(a){a=a.d;for(var b in a.Ra)if(-1!=b.indexOf("nodes"))return!0;return!1}function t(a,b,c,d){if((c=a.D[c])&&null!=c.type&&(c.play||d)){var e=a.d;d=c.oc;var f=c.start,g=c.length;d+=c.speed*b*ia.Ha;var h=c.type,l=c.speed;if(0<=l&&d>=f+g||0>l&&d<f)switch(c.li=!0,c.behavior){case 10:d=0<=l?(d-
f)%g+f:f+g-1E-6;break;case 20:d=0<=l?f:f+g-1E-6;c.play=!1;break;case 30:d=0<=l?f+g-1E-6:f,c.play=!1}c.oc=d;switch(h){case 10:if(!e.Ce){d=G(c,d,ga);b=d[0];f=d[1];d=d[2];e.xc=c.ya[b];e.wc=c.ya[f];e.Fc=c.h[b];e.Ec=c.h[f];e.Kf=d;e=e.Kk;c=c.In;for(g=0;g<e.length;g++)h=e[g],l=c[g],h.xc=l.ya[b],h.wc=l.ya[f],h.Fc=l.h[b],h.Ec=l.h[f],h.Kf=d;ka.u(a)}break;case 20:h=d=G(c,d,ga);(e=pa)||(e=new Float32Array(4));var f=h[0],g=h[1],h=h[2],l=c.h,m=l[f][1],k=l[f][2],n=l[g][1],p=l[g][2];e[0]=(1-h)*l[f][0]+h*l[g][0];
e[1]=(1-h)*m+h*n;e[2]=(1-h)*k+h*p;f=d;(g=R)||(g=new Float32Array(4));h=c.ya;ma.slerp(h[f[0]].subarray(0,4),h[f[1]].subarray(0,4),f[2],g);f=g;g=d[2];h=c.h;d=(1-g)*h[d[0]][3]+g*h[d[1]][3];c.co&&(g=T,ka.get_translation(a,g),w.smooth_v(e,g,b,c.co,e));c.yn&&(g=V,ka.get_rotation(a,g),w.Ds(f,g,b,c.yn,f));c=c.Ej;c[0]&&ka.set_translation(a,e);c[1]&&ka.set_rotation(a,f);c[2]&&ka.set_scale(a,d);ka.u(a);Z.sync_transform(a);break;case 30:(a=ga)||(a=Array(3));f=d-c.start;0>f&&(f=0);f>=c.length&&(f=c.length);b=
Math.floor(f);d=b+1;f-=b;10!=c.behavior&&d==c.length&&(d=--b,f=1);c=c.mt;a[0]=b+c;a[1]=d+c;a[2]=f;d=ga;e.ko=d[0];e.lt=d[2];break;case 40:d=G(c,d,ga);b=d[0];e=d[1];d=d[2];c.volume&&ha.set_volume(a,(1-d)*c.volume[b]+d*c.volume[e]);c.pitch&&ha.playrate(a,(1-d)*c.pitch[b]+d*c.pitch[e]);break;case 50:aa.vA(c.uc,d/ia.Ha);break;case 60:d=G(c,d,ga);b=d[0];e=d[1];d=d[2];l=c.vr;m=c.tr;f=c.ur;c=c.sr;for(g=0;g<m.length;g++)k=l[g],h=m[g],a.d.ie[h]=(1-d)*k[b]+d*k[e];for(g=0;g<c.length;g++)l=f[g],h=c[g],l=W.lerp(l.subarray(3*
b,3*b+3),l.subarray(3*e,3*e+3),d,pa),a.d.tc[h]=l[0],a.d.tc[h+1]=l[1],a.d.tc[h+2]=l[2];break;default:w.pa("Unknown animation type:"+h)}}}function G(a,b,c){c||(c=Array(3));var d=a.gl[0],e=a.gl[1]-d;b-=d;0>b&&(b=0);b>=e&&(b=e);b/=a.No;e=Math.floor(b);a=a.Mo[e]?b-e:0;c[0]=e;c[1]=e+1;c[2]=a;return c}function A(a,b){var c=a.d,d=c.Be,e=c.Pk,f=e[0],e=e[1];if(-1!=e){if(-1!=f){var g=a.D[f];if(g.play||0==b)var h=G(g,g.oc,ga),l=h[0],m=h[1],h=h[2],k=g.ya[l],n=g.ya[m],l=g.h[l],m=g.h[m];else d=1}else d=1;e=a.D[e];
if(e.play||0==b)var h=G(e,e.oc,ga),p=h[0],r=h[1],h=h[2];else if(-1!=f&&g.play)d=0;else return;f=e.ya[p];g=e.ya[r];p=e.h[p];e=e.h[r];if(1==d)c.xc.set(f),c.wc.set(g),c.Fc.set(p),c.Ec.set(e);else if(0==d)c.xc.set(k),c.wc.set(n),c.Fc.set(l),c.Ec.set(m);else{for(r=0;r<k.length;r+=4){for(var t=R,v=V,y=0;4>y;y++)t[y]=k[r+y],v[y]=f[r+y];ma.slerp(t,v,d,t);for(y=0;4>y;y++)c.xc[r+y]=t[y];for(y=0;4>y;y++)t[y]=n[r+y],v[y]=g[r+y];ma.slerp(t,v,d,t);for(y=0;4>y;y++)c.wc[r+y]=t[y]}w.ep(l,p,d,c.Fc);w.ep(m,e,d,c.Ec)}ka.u(a);
d=c.Kk;k=c.qr;for(r=0;r<d.length;r++){n=d[r];l=k[r];for(m=0;m<l.length;m+=2)for(p=l[m],f=l[m+1],g=0;4>g;g++)n.xc[p+g]=c.xc[f+g],n.wc[p+g]=c.wc[f+g],n.Fc[p+g]=c.Fc[f+g],n.Ec[p+g]=c.Ec[f+g];n.Kf=h}}}function k(a,b){var c=a.d,d=c.Be,e=c.kl;if(0!=e){var d=c.jl-d,f=e*b;w.sign(d)==w.sign(e)&&Math.abs(f)<Math.abs(d)?c.Be+=f:(c.Be=c.jl,c.kl=0)}}function I(a,b,c){for(var d=a.pose.bones,e=[],f=[],g=b.d.zr,h=0;h<g;h++){for(var l=0;l<d.length;l++){var m=d[l],k=qa.create(),n=b.d.zj[m.name];n&&qa.copy(n.subarray(8*
h,8*h+8),k);m.Jo=k;m.oj=!1}l=F(a,c);e.push(l.h);f.push(l.ya)}return{h:e,ya:f}}function F(a,b){var c=[],d=[],e=a.pose.bones,f=new Float32Array(4),g=new Float32Array(4),h;for(h in b){var l=b[h],m=l.fi,k=e[l.un],l=f,n=g,p=k.Ou,r=p[p.length-1],t=r.fl;r.oj||qa.identity(t);for(r=p.length-1;0<=r;r--){var k=p[r],v=k.fl;if(k.oj)t=v;else{var y=k.Ko,q=k.Jo;qa.invert(y,ja);qa.multiply(q,ja,ja);qa.multiply(y,ja,ja);qa.multiply(t,ja,v);t=v;k.oj=!0}}k=k.fl;l[0]=k[0];l[1]=k[1];l[2]=k[2];l[3]=k[3];n[0]=k[4];n[1]=
k[5];n[2]=k[6];n[3]=k[7];ma.normalize(n,n);for(l=0;4>l;l++)n=4*m+l,c[n]=f[l],d[n]=g[l]}c=new Float32Array(c);d=new Float32Array(d);return{h:c,ya:d}}function L(a){var b=[0,0,0],c;for(c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1);return b}function J(a,b,c,d,e,f,g){var h=a+(b-a)/2,l=P(h,d,e,f,g)-c;return.02>Math.abs(l)?h:0<l?J(a,h,c,d,e,f,g):J(h,b,c,d,e,f,g)}function P(a,b,c,d,e){var f=1-a;return b*f*f*f+3*c*f*f*a+3*d*f*a*a+e*a*a*a}function z(a,b){if(!a.D.length)for(var c=
0;8>c;c++)a.D.push(null);a.D[b]={type:null,Fg:null,gl:null,No:0,Mo:null,Ej:null,ya:null,h:null,In:[],play:!1,behavior:20,oc:0,start:0,length:0,co:0,yn:0,li:!1,mt:null,speed:1,volume:null,pitch:null,vr:[],tr:[],ur:[],sr:[]};a.Ld=a.Ld||[];-1==ra.indexOf(a)&&ra.push(a)}function N(a,b){ka.u(a);Z.sync_transform(a);r(a,0,b,!0)}function H(a,b,e){e=e||0;if(w.is_mesh(a)){var f=w.keysearch("name",b,a.data.b4w_vertex_anim);if(f)return z(a,e),d(a,f,e),N(a,e),!0;if((f=w.keysearch("name",b,a.particle_systems))&&
"EMITTER"==f.settings.type)return z(a,e),c(a,f,e),N(a,e),!0}if(f=w.keysearch("name",b,sa)||w.keysearch("name",b+"_B4W_BAKED",sa)){z(a,e);if(n(a,f,e))return N(a,e),!0;a.D[e]=null}Q.error('Unsupported object: "'+a.name+'" or animation name: "'+b+'"');return!1}function K(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c.use_nodes&&d&&O(d))return!0}return!1}function O(a){if(a.animation_data)return!0;a=a.nodes;for(var b=0;b<
a.length;b++){var c=a[b];if(c.node_group&&(c=c.node_group.node_tree)&&O(c))return!0}return!1}var X=q("__config"),aa=q("__particles"),Z=q("__physics"),Q=q("__print");q("__scenes");var ha=q("__sfx"),ka=q("__transform"),qa=q("__tsr"),w=q("__util"),ba=q("__reformer");q("mat4");var ma=q("quat");q("vec4");var W=q("vec3"),ia=X.Nd;a.OBJ_ANIM_TYPE_NONE=0;a.OBJ_ANIM_TYPE_ARMATURE=10;a.OBJ_ANIM_TYPE_OBJECT=20;a.OBJ_ANIM_TYPE_VERTEX=30;a.OBJ_ANIM_TYPE_SOUND=40;a.OBJ_ANIM_TYPE_PARTICLES=50;a.OBJ_ANIM_TYPE_MATERIAL=
60;a.SLOT_0=0;a.SLOT_1=1;a.SLOT_2=2;a.SLOT_3=3;a.SLOT_4=4;a.SLOT_5=5;a.SLOT_6=6;a.SLOT_7=7;a.SLOT_ALL=-1;a.AB_CYCLIC=10;a.AB_FINISH_RESET=20;a.AB_FINISH_STOP=30;var ga=Array(3),pa=new Float32Array(3),T=new Float32Array(3),R=new Float32Array(4),V=new Float32Array(4),ja=new Float32Array(8);new Float32Array(16);var ra=[],sa=[];a.vq=function(){return w.trunc((X.o.pr-50)/4)};a.frame_to_sec=function(a){return a/ia.Ha};a.update=function(a){for(var c=0;c<ra.length;c++){for(var d=ra[c],e=0;8>e;e++)t(d,a,e);
d.d.Ce&&(k(d,a),A(d,a))}for(c=0;c<ra.length;c++)for(d=ra[c],e=0;8>e&&d.D.length;e++)b(d,e)};a.nq=function(){return sa};a.get_anim_names=function(a){var b=[];if(p(a))for(var c=0;c<a.data.b4w_vertex_anim.length;c++)b.push(a.data.b4w_vertex_anim[c].name);var d,c=[];for(d=0;d<sa.length;d++){var g=sa[d],h=g.d;w.qd(g.d.zj)?"ARMATURE"==a.type&&c.push(g):h.Ra.volume||h.Ra.pitch?ha.ge(a)&&c.push(g):!B(g)&&w.qd(g.fcurves)&&c.push(g)}"MESH"==a.type&&(c=c.concat(f(a)));d=c;for(c=0;c<d.length;c++)b.push(e(d[c].name));
if(aa.Yg(a)&&aa.Hm(a))for(c=0;c<a.particle_systems.length;c++)b.push(a.particle_systems[c].name);return b};a.aB=e;a.get_anim_type=function(a,b){var c=a.D[b];return c?c.type:0};a.apply_def=function(a){var b=0,e;e=[];var h=a.animation_data;if(h&&h.action&&(h=h.action,w.qd(h.fcurves))){var l=w.qd(h.d.zj);"ARMATURE"!=a.type&&l||e.push(h)}ha.ge(a)&&a.data.animation_data&&a.data.animation_data.action&&e.push(a.data.animation_data.action);"MESH"==a.type&&(e=e.concat(f(a)));l=a.particle_systems;for(h=0;h<
l.length;h++){var m=l[h],k=m.settings;"EMITTER"==k.type&&(z(a,b),c(a,m,b),N(a,b),a.D[b].behavior=g(a.b4w_anim_behavior),k.b4w_cyclic&&(a.D[b].behavior=10),b++)}for(h=0;h<e.length;h++)l=e[h],z(a,b),n(a,l,b)?(N(a,b),a.D[b].behavior=g(a.b4w_anim_behavior),b++):a.D[b]=null;p(a)&&(z(a,b),d(a,a.data.b4w_vertex_anim[0],b),N(a,b),a.D[b].behavior=g(a.b4w_anim_behavior))};a.get_first_armature_object=l;a.play=function(a,b,c){m(a.D,c,function(a){a.play=!0;a.mm=b?b:null;a.li=!1});a.d.Ce&&v(a)};a.stop=function(a,
b){m(a.D,b,function(a){a.play=!1;a.mm=null;a.li=!1})};a.is_play=function(a,b){var c=a.D[b];return c?c.play:!1};a.set_current_frame_float=function(a,b,c){var d=a.D;if(-1==c)for(c=0;8>c;c++){var e=d[c];e&&(e.oc=b,r(a,0,c,!0))}else if(e=d[c])e.oc=b,r(a,0,c,!0)};a.get_current_frame_float=function(a,b){var c=a.D[b];return c&&c.oc?c.oc:0};a.is_cyclic=function(a,b){var c=a.D[b];return c&&10==c.behavior};a.set_behavior=function(a,b,c){m(a.D,c,function(a){a.behavior=b})};a.get_behavior=function(a,b){var c=
a.D[b];return c&&c.behavior};a.apply_smoothing=function(a,b,c,d){m(a.D,d,function(a){a.co=b||0;a.yn=c||0})};a.remove_slot_animation=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.D[c]=null;else a.D[b]=null;a.d.Ce&&E(a,b)};a.update_object_animation=r;a.bk=function(a){if("ARMATURE"==a.type||l(a))return!0;var b=a.animation_data;return b&&b.action||"SPEAKER"==a.type&&a.data.animation_data&&a.data.animation_data.action||aa.Yg(a)&&aa.Hm(a)||"MESH"==a.type&&a.data.b4w_vertex_anim.length||K(a)?!0:!1};a.is_animated=
function(a){return Boolean(a.D.length)};a.Jv=x;a.lp=F;a.Xu=function(a){function b(a,c){for(var d=0;d<c;d++){var e=a.subarray(8*d+4,8*d+8);ma.normalize(e,e)}}function c(a,b){if(-1<a.indexOf("location"))var d=0,e=b;else-1<a.indexOf("rotation_quaternion")?(d=4,e=0==b?3:b-1):-1<a.indexOf("scale")?(d=3,e=0):(d=0,e=b);return d+e}function d(a,b,c,e,h){if(-1<c.search(f)){a=b;c=c.split('"')[1];var l=g}else 8==h?(c="tsr",l=g):l=1<h?new Float32Array(h):0;if(!a[c]){h=a;b=c;if("object"==typeof l&&l.length)for(var m=
l.length,k=new Float32Array(e*m),n=0;n<e;n++)for(var p=0;p<m;p++)k[n*m+p]=l[p];else if("number"==typeof l)for(k=new Float32Array(e),n=0;n<e;n++)k[n]=l;else w.pa("Wrong storage default value");h[b]=k}return a[c]}a.d={};var e=a.d;e.zz=1/ia.Lf;var f=new RegExp(/pose.bones\[\".+\"\]/g),g=qa.create(),h=a.fcurves,l={},m={},k=0,n;for(n in h){var p=h[n],r;for(r in p){var t=p[r],v=t.kc;ba.Nv(t,a);t=t.num_channels;k||(k=v.length);for(var t=d(l,m,n,k,t),y=t.length/k,q=c(n,r|0),u=0;u<k;u++)t[u*y+q]=v[u]}}for(var T in l)"tsr"==
T&&b(l[T],k);for(var R in m)b(m[R],k);e.Ra=l;e.zj=m;e.Bv=a.Nu;e.zr=k;e.Ej="tsr"in l?L(h):null;sa.push(a)};a.Wx=function(a,b){return(b-a)*ia.Lf+1};a.qv=function(a,b,c,d,e,f){var g,h,l=new Float32Array(2),m=new Float32Array(2),k=new Float32Array(2),n=new Float32Array(2),p=b[1],r=b[2],t=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var v=0,y=0,q=null;e<=f;e++)if(e<p)for(var u=0;u<ia.Lf;u++)c[v++]=r;else if(e>t)for(u=0;u<ia.Lf;u++)c[v++]=a;else{var T=b[y],R=3;0===T&&(R+=2);0===q&&(R+=2);var x=
2===T?0:1;if(b[y+1]==b[y+R+1])q=T,y+=R;else{u=0;e==b[y+1]&&(x&&(d[v]=1),c[v]=b[y+2],v++,u++);if(e==t)for(;u<ia.Lf;u++)c[v++]=a;else for(l[0]=b[y+1],l[1]=b[y+2],0!==T?(m[0]=0,m[1]=0):0===q?(m[0]=b[y+5],m[1]=b[y+6]):(m[0]=b[y+3],m[1]=b[y+4]),0!==T?(k[0]=0,k[1]=0):(k[0]=b[y+R+3],k[1]=b[y+R+4]),n[0]=b[y+R+1],n[1]=b[y+R+2];u<ia.Lf;u++){var V=e+u/ia.Lf;switch(T){case 0:g=l;h=m;var H=k,A=n,E=[],B=[],K=void 0,G=void 0,z=void 0,K=void 0;E[0]=g[0]-h[0];E[1]=g[1]-h[1];B[0]=A[0]-H[0];B[1]=A[1]-H[1];z=A[0]-g[0];
K=Math.abs(E[0]);G=Math.abs(B[0]);0!=K+G&&K+G>z&&(K=z/(K+G),h[0]=g[0]-K*E[0],h[1]=g[1]-K*E[1],H[0]=A[0]-K*B[0],H[1]=A[1]-K*B[1]);x&&(d[v]=1);c[v]=P(J(0,1,V,l[0],m[0],k[0],n[0]),l[1],m[1],k[1],n[1]);v++;break;case 1:h=l[0];H=l[1];g=A=(n[1]-H)/(n[0]-h);h=H-A*h;x&&(d[v]=1);c[v]=g*V+h;v++;break;case 2:x&&(d[v]=1);c[v]=b[y+2];v++;break;default:w.pa("Unknown keyframe intepolation mode: "+T)}}e+1==b[y+R+1]&&(q=T,y+=R)}}};a.xD=function(a){for(var b=0;b<a.length;b++)if(a[b].KC)return a[b];return!1};a.apply=
H;a.lv=function(a,b,c){c=c||0;var d=w.keysearch("uuid",b,sa);if(d){z(a,c);if(n(a,d,c)){N(a,c);return}a.D[c]=null}Q.error('Unsupported object: "'+a.name+'" or animation uuid: "'+b+'"')};a.dC=function(a,b){var c=w.keysearch("name",b,sa)||w.keysearch("name",b+"_B4W_BAKED",sa);return c?w.qd(c.fcurves)?!0:!1:w.keysearch("name",b,a.particle_systems)?!0:!1};a.get_slot_num_by_anim=function(a,b){for(var c=a.D,d=0;d<c.length;d++){var f=c[d];if(f&&e(f.Fg)==e(b))return d}return-1};a.Ux=function(a,b){var c=a.D[b];
return c&&c.Fg?e(c.Fg):null};a.remove=function(a){a.D.length=0;a=ra.indexOf(a);-1!=a&&ra.splice(a,1)};a.Nz=function(a){for(var b=sa.length-1;0<=b;b--)sa[b].Pu==a&&sa.splice(b,1)};a.apply_to_first_empty_slot=function(a,b){if(!a.D.length)return H(a,b,0)?0:-1;for(var c=0;c<a.D.length;c++)if(!a.D[c])return H(a,b,c)?c:-1};a.set_skel_mix_factor=function(a,b,c){a.d.kl=(b-a.d.Be)/c;a.d.jl=b};a.set_speed=function(a,b,c){m(a.D,c,function(a){a.speed=b})};a.get_speed=function(a,b){return a.D[b].speed};a.get_anim_start_frame=
function(a,b){return a.D[b].start};a.get_anim_length=function(a,b){return a.D[b].length};a.zy=K;a.cleanup=function(){ra.length=0;sa.length=0};a.vx=function(a){var b=(a[0]||a[1]||a[2]).kc.length,c=R,d=pa,e=Boolean(a[0]);e||(a[0]={kc:new Float32Array(b),num_channels:8});var f=Boolean(a[1]);f||(a[1]={kc:new Float32Array(b),num_channels:8});var g=Boolean(a[2]);g||(a[2]={kc:new Float32Array(b),num_channels:8});a[3]={kc:new Float32Array(b),num_channels:8};for(var h=0;h<b;h++)d[0]=e?a[0].kc[h]:0,d[1]=f?
a[1].kc[h]:0,d[2]=g?a[2].kc[h]:0,w.euler_to_quat(d,c),a[0].kc[h]=c[3],a[1].kc[h]=c[0],a[2].kc[h]=c[1],a[3].kc[h]=c[2]}};b4w.module.__time=function(a,q){q("__util");var b=0,d=0,c=[],e=0,g=[];a.rs=function(a){b=a;d=performance.now();for(a=0;a<c.length;a++){var e=c[a];b>e.gm&&(c.splice(a,1),a--,e.callback())}for(a=0;a<g.length;a++){var e=g[a],p=1-(e.gm-b)/e.duration,p=Math.min(p,1);e.callback(e.M+p*(e.la-e.M));1==p&&(g.splice(a,1),a--)}};a.get_timeline=function(){return b};a.set_timeout=function(a,g){var p;e++;p=e;c.push({id:p,callback:a,gm:b+(performance.now()-d+g)/1E3});return p};a.clear_timeout=function(a){for(var b=
0;b<c.length;b++)if(c[b].id==a){c.splice(b,1);break}};a.animate=function(a,c,d,e){d/=1E3;g.push({callback:e,M:a,la:c,gm:b+d,duration:d});e(a)};a.reset=function(){d=b=0;e=c.length=0}};b4w.module.__transform=function(a,q){function b(a,b){var c=a.d;c.h[0]=b[0];c.h[1]=b[1];c.h[2]=b[2];c.scale=b[3];c.quat[0]=b[4];c.quat[1]=b[5];c.quat[2]=b[6];c.quat[3]=b[7]}function d(a){var b=a.d,n=p.Wg();"CAMERA"==a.type&&e.io(a);g.EB(a,A);"CAMERA"==a.type&&e.BB(a);var t=b.h,q=b.scale,u=b.quat;m.set_sep(t,q,u,b.Ab);var E=b.T;x.identity(E);x.fromQuat(u,E);"CAMERA"!=a.type&&r.bA(E,q,E);E[12]=t[0];E[13]=t[1];E[14]=t[2];x.invert(E,b.Sq);a.D.length&&h.Hm(a)&&h.FB(a);b.Pb&&b.bb&&(c.xl(b.Pb,E,b.bb),c.zl(b.Vc,
E,b.vb),c.yl(b.yf,b.Ab,b.zf),b.Ac&&p.Fn(n),null!=b.nc&&n&&p.ct(n,a));if(n&&n.d.zb)for(E=n.d.zb.Dk,q=0;q<E.length;q++)if(E[q]==a){p.ft(q,n);break}switch(a.type){case "SPEAKER":l.QA(a,A);break;case "CAMERA":e.CB(a);n&&p.Rj(n)==a&&l.Zy(n,t,u,A);break;case "LAMP":f.GB(a);n&&p.ug(a,n);break;case "EMPTY":a.field&&p.dt(a);break;case "MESH":t=a.modifiers;u=null;for(q=0;q<t.length;q++)E=t[q],"ARMATURE"==E.type&&(u=E.object);u&&(m.invert(u.d.Ab,G),m.multiply(G,b.Ab,G),y.set(G[0],G[1],G[2],G[3],b.ml),v.set(G[4],
G[5],G[6],G[7],b.ll))}"LAMP"!=a.type&&"CAMERA"!=a.type||!n||(p.Fn(n),p.eA(n));a=a.Ic;for(q=0;q<a.length;q++)d(a[q]);b.sm=!0}var c=q("__boundings"),e=q("__camera"),g=q("__constraints"),f=q("__lights"),h=q("__particles"),p=q("__scenes"),l=q("__sfx"),m=q("__tsr"),r=q("__util"),n=q("vec3"),y=q("vec4"),v=q("quat"),E=q("mat3"),x=q("mat4"),u=new Float32Array(3),B=new Float32Array(4),t=new Float32Array(9),G=new Float32Array(8),A=0;a.SPACE_WORLD=0;a.SPACE_LOCAL=1;a.update=function(a){A=a};a.set_translation=
function(a,b){g.de(a)==g.Hd?m.set_trans(b,g.ce(a)):a.d.h.set(b)};a.get_translation=function(a,b){g.de(a)==g.Hd?n.copy(m.get_trans_view(g.ce(a)),b):n.copy(a.d.h,b)};a.set_rotation=function(a,b){g.de(a)==g.Hd?m.set_quat(b,g.ce(a)):a.d.quat.set(b)};a.get_rotation=function(a,b){g.de(a)==g.Hd?v.copy(m.get_quat_view(g.ce(a)),b):v.copy(a.d.quat,b)};a.set_rotation_euler=function(a,b){if(g.de(a)==g.Hd){var c=r.euler_to_quat(b,B);m.set_quat(c,g.ce(a))}else r.euler_to_quat(b,a.d.quat)};a.set_scale=function(a,
b){g.de(a)==g.Hd?m.set_scale(b,g.ce(a)):a.d.scale=b};a.get_scale=function(a){return g.de(a)==g.Hd?m.get_scale(g.ce(a)):a.d.scale};a.get_tsr=function(a,b){if(g.de(a)==g.Hd)m.copy(g.ce(a),b);else{var c=a.d;m.set_sep(c.h,c.scale,c.quat,b)}};a.set_tsr=function(a,c){g.de(a)==g.Hd?m.copy(c,g.ce(a)):b(a,c)};a.wA=b;a.get_object_size=function(a){var b=a.d,c=a.data.b4w_bounding_box;a=b.scale*(c.max_x-c.min_x);var d=b.scale*(c.max_y-c.min_y),b=b.scale*(c.max_z-c.min_z);return.5*Math.sqrt(a*a+d*d+b*b)};a.get_object_center=
function(a,b,c){c||(c=new Float32Array(3));b?(b=a.d,n.copy(b.vb.F,c)):(b=a.d,a=a.data.b4w_bounding_box,c[0]=(a.max_x+a.min_x)/2,c[1]=(a.max_y+a.min_y)/2,c[2]=(a.max_z+a.min_z)/2,n.transformMat4(c,b.T,c));return c};a.move_local=function(a,b,c,d){a=a.d;u[0]=b;u[1]=c;u[2]=d;b=E.fromMat4(a.T,t);n.transformMat3(u,b,u);n.add(a.h,u,a.h)};a.u=d;a.distance=function(a,b){return n.dist(a.d.h,b.d.h)};a.tz=function(a,b){return n.dist(a.d.h,b)};a.get_object_bounding_box=function(a){return{max_x:a.d.bb.max_x,min_x:a.d.bb.min_x,
max_y:a.d.bb.max_y,min_y:a.d.bb.min_y,max_z:a.d.bb.max_z,min_z:a.d.bb.min_z}}};b4w.module.__tsr=function(a,q){function b(a,b,c,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=b;d[4]=c[0];d[5]=c[1];d[6]=c[2];d[7]=c[3]}function d(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],p=b[5],q=b[6];b=b[7];var t=a[0]*g,G=a[1]*g,A=a[2]*g;a=b*t+p*A-q*G;var g=b*G+q*t-h*A,k=b*A+h*G-p*t,t=-h*t-p*G-q*A;c[0]=a*b+t*-h+g*-q-k*-p;c[1]=g*b+t*-p+k*-h-a*-q;c[2]=k*b+t*-q+a*-p-g*-h;c[0]+=d;c[1]+=e;c[2]+=f;return c}var c=q("__util"),e=q("vec3"),g=q("quat"),f=q("mat4"),h=new Float32Array(3),p=new Float32Array(4);
new Float32Array(16);a.create=function(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a};a.from_values=function(a,b,c,d,e,f,g,h){var p=new Float32Array(8);p[0]=a;p[1]=b;p[2]=c;p[3]=d;p[4]=e;p[5]=f;p[6]=g;p[7]=h;return p};a.copy=function(a,b){b.set(a)};a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.create_sep=function(a,c,d,e){e||(e=new Float32Array(8));b(a,c,d,e);return e};a.set_sep=b;a.set_trans=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2]};a.set_scale=
function(a,b){b[3]=a};a.set_transcale=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.set_quat=function(a,b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3]};a.get_trans_view=function(a){return a.subarray(0,3)};a.get_scale=function(a){return a[3]};a.get_quat_view=function(a){return a.subarray(4)};a.invert=function(a,b){var c=1/a[3];if(!c)return null;var d=a[0],e=a[1],f=a[2];p[0]=a[4];p[1]=a[5];p[2]=a[6];p[3]=a[7];g.invert(p,p);var h=p[0],q=p[1],u=p[2],B=p[3],d=d*c,e=e*c,t=f*c,f=B*d+q*t-u*e,G=B*e+
u*d-h*t,A=B*t+h*e-q*d,d=-h*d-q*e-u*t;b[0]=-(f*B+d*-h+G*-u-A*-q);b[1]=-(G*B+d*-q+A*-h-f*-u);b[2]=-(A*B+d*-u+f*-q-G*-h);b[3]=c;b[4]=h;b[5]=q;b[6]=u;b[7]=B;return b};a.to_mat4=function(a,b){var c=a[3];f.fromRotationTranslation(a.subarray(4),a.subarray(0,3),b);for(var d=0;12>d;d++)b[d]*=c;return b};a.from_mat4=function(a,d){var e=c.fh(a,h),f=c.fn(a),g=c.matrix_to_quat(a,p);b(e,f,g,d);return d};a.multiply=function(a,b,c){d(b,a,c);c[3]=a[3]*b[3];var e=a[4],f=a[5],g=a[6];a=a[7];var h=b[4],p=b[5],q=b[6];
b=b[7];c[4]=e*b+a*h+f*q-g*p;c[5]=f*b+a*p+g*h-e*q;c[6]=g*b+a*q+e*p-f*h;c[7]=a*b-e*h-f*p-g*q;return c};a.transform_vec3=d;a.transform_vec3_inv=function(a,b,c){var d=b[3],e=a[0]-b[0],f=a[1]-b[1],g=a[2]-b[2];a=b[4];var h=b[5],p=b[6];b=b[7];var q=a*a+h*h+p*p+b*b,q=q?1/q:0;a=-a*q;h=-h*q;p=-p*q;b*=q;var q=b*e+h*g-p*f,t=b*f+p*e-a*g,G=b*g+a*f-h*e,e=-a*e-h*f-p*g;c[0]=q*b+e*-a+t*-p-G*-h;c[1]=t*b+e*-h+G*-a-q*-p;c[2]=G*b+e*-p+q*-h-t*-a;c[0]/=d;c[1]/=d;c[2]/=d;return c};a.transform_vectors=function(a,b,c,d){d||
(d=0);var e=a.length,f=b[0],g=b[1],h=b[2],p=b[3],q=b[4],t=b[5],G=b[6];b=b[7];for(var A=0;A<e;A+=3){var k=a[A]*p,I=a[A+1]*p,F=a[A+2]*p,L=b*k+t*F-G*I,J=b*I+G*k-q*F,P=b*F+q*I-t*k,k=-q*k-t*I-G*F;c[d+A]=L*b+k*-q+J*-G-P*-t;c[d+A+1]=J*b+k*-t+P*-q-L*-G;c[d+A+2]=P*b+k*-G+L*-t-J*-q;c[d+A]+=f;c[d+A+1]+=g;c[d+A+2]+=h}return c};a.transform_dir_vectors=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],h=b[5],p=b[6];b=b[7];for(var q=0;q<e;q+=3){var t=a[q]*f,G=a[q+1]*f,A=a[q+2]*f,k=b*t+h*A-p*G,I=b*G+p*t-g*
A,F=b*A+g*G-h*t,t=-g*t-h*G-p*A;c[d+q]=k*b+t*-g+I*-p-F*-h;c[d+q+1]=I*b+t*-h+F*-g-k*-p;c[d+q+2]=F*b+t*-p+k*-h-I*-g}return c};a.transform_dir_vec3=function(a,b,c){var d=b[3],e=b[4],f=b[5],g=b[6];b=b[7];var h=a[0]*d,p=a[1]*d,q=a[2]*d;a=b*h+f*q-g*p;var d=b*p+g*h-e*q,t=b*q+e*p-f*h,h=-e*h-f*p-g*q;c[0]=a*b+h*-e+d*-g-t*-f;c[1]=d*b+h*-f+t*-e-a*-g;c[2]=t*b+h*-g+a*-f-d*-e;return c};a.transform_tangents=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],h=b[5],p=b[6];b=b[7];for(var q=0;q<e;q+=4){var t=a[q]*
f,G=a[q+1]*f,A=a[q+2]*f,k=b*t+h*A-p*G,I=b*G+p*t-g*A,F=b*A+g*G-h*t,t=-g*t-h*G-p*A;c[d+q]=k*b+t*-g+I*-p-F*-h;c[d+q+1]=I*b+t*-h+F*-g-k*-p;c[d+q+2]=F*b+t*-p+k*-h-I*-g;c[d+q+3]=a[q+3]}return c};a.translate=function(a,b,c){var d=a[3],e=a[4],f=a[5],g=a[6],h=a[7],p=b[0]*d,q=b[1]*d,t=b[2]*d;b=h*p+f*t-g*q;var d=h*q+g*p-e*t,G=h*t+e*q-f*p,p=-e*p-f*q-g*t;c[0]=a[0]+b*h+p*-e+d*-g-G*-f;c[1]=a[1]+d*h+p*-f+G*-e-b*-g;c[2]=a[2]+G*h+p*-g+b*-f-d*-e;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.interpolate=
function(a,b,c,d){d||(d=new Float32Array(8));e.lerp(a.subarray(0,3),b.subarray(0,3),c,d.subarray(0,3));var f=a[3];d[3]=f+c*(b[3]-f);g.slerp(a.subarray(4),b.subarray(4),c,d.subarray(4));return d};a.uD=function(a,b,c,d){d||(d=new Float32Array(8));var e=a.subarray(0,3),f=b.subarray(0,3),h=d.subarray(0,3);h[0]=f[0]*(c+1)-e[0]*c;h[1]=f[1]*(c+1)-e[1]*c;h[2]=f[2]*(c+1)-e[2]*c;d[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4);b=b.subarray(4);e=d.subarray(4);e[0]=b[0]*(c+1)-a[0]*c;e[1]=b[1]*(c+1)-a[1]*c;e[2]=b[2]*(c+
1)-a[2]*c;e[3]=b[3]*(c+1)-a[3]*c;g.normalize(e,e);return d};a.Iy=function(a,b,c,d,e){e[0]=a[0]+b*c[0];e[1]=a[1]+b*c[1];e[2]=a[2]+b*c[2];e[3]=a[3];c=d[0];var f=d[1];d=d[2];var g=a[4],h=a[5],p=a[6],q=a[7];e[4]=.5*(c*q+f*p-d*h);e[5]=.5*(f*q+d*g-c*p);e[6]=.5*(d*q+c*h-f*g);e[7]=.5*(-c*g-f*h-d*p);e[4]=a[4]+e[4]*b;e[5]=a[5]+e[5]*b;e[6]=a[6]+e[6]*b;e[7]=a[7]+e[7]*b;a=e[4];b=e[5];c=e[6];f=e[7];a=a*a+b*b+c*c+f*f;0<a&&(a=1/Math.sqrt(a),e[4]*=a,e[5]*=a,e[6]*=a,e[7]*=a)}};b4w.module.__util=function(a,q){function b(a,b,c){for(var d=[],e=c.length,f=0;f<e;f++){var g=c[f];g[a]==b&&d.push(g)}return d}function d(a){return 0<a?1:0>a?-1:0}function c(a,b){var d=a instanceof Array?[]:{},e;for(e in a)d[e]=!a[e]||"object"!=typeof a[e]||-1!=b.indexOf(a[e])||a[e]instanceof Float32Array?a[e]:c(a[e],b);return d}function e(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=Math.sqrt(b*b+c*c+d*d),f=1/f;a[0]=b*f;a[1]=c*f;a[2]=d*f;a[3]=e*f}function g(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]}
function f(a,b){var c=b;switch(typeof a){case "number":return h(a,c);case "string":return p(a,c);case "boolean":return h(a|0,c);case "function":case "undefined":return h(0,c);case "object":if(a){var d=a instanceof Array;if(a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength)for(d=0;d<a.length;d++)c=h(a[d],c);else if(d)for(d=0;d<a.length;d++)c=f(a[d],c);else for(var e in a)c=f(a[e],c)}else c=h(0,c)}return c}function h(a,b){var c=b;X[0]=a;c=(c<<5)-c+aa[0];c&=c;c=(c<<5)-c+aa[1];return c&c}function p(a,
b){for(var c=b,d=0;d<a.length;d++)c=(c<<5)-c+a.charCodeAt(d),c&=c;return c}function l(a){return(34*a+1)*a%289}function m(a){return a-Math.floor(a)}function r(a){return n((34*a+5)*a)}function n(a){return a-289*Math.floor(a/289)}function y(a){return a-7*Math.floor(a/7)}function v(a,b,c){a-=b;c-=b;return b+(a-Math.floor(a/c)*c)}function E(a){return v(a,0,2*Math.PI)}function x(a,b){if(a&&b){var c=a instanceof Array,d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength,e=b.buffer instanceof ArrayBuffer&&
"undefined"!==b.byteLength;if(c!=b instanceof Array||d!=e)return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!u(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{for(var f in a)if(!u(a[f],b[f]))return!1;for(f in b)if(!(f in a))return!1}return!0}return!(a||b)}function u(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return x(a,b);default:return!0}}
var B=q("__print"),t=q("vec3"),G=q("vec4"),A=q("quat"),k=q("mat3"),I=q("mat4"),F=0,L={},J=new Float32Array(3),P=new Float32Array(3),z=new Float32Array(4),N=new Float32Array(4),H=new Float32Array(9),K=new Float32Array(16),O=new Float32Array(16),X=new Float64Array(1),aa=new Uint32Array(X.buffer),Z=new Float32Array([0,0,0]),Q=new Float32Array([0,0,0,1]),ha=new Float32Array([0,0,0,1,0,0,0,1]),ka=new Float32Array([1,0,0]),qa=new Float32Array([0,1,0]),w=new Float32Array([0,0,1]),ba=new Float32Array([-1,
0,0]),ma=new Float32Array([0,-1,0]),W=new Float32Array([0,0,-1]),ia=Math.floor(44488.07041494893),ga=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.Mu=Z;a.Gu=Q;a.HC=ha;a.AXIS_X=ka;a.AXIS_Y=qa;a.AXIS_Z=w;a.AXIS_MX=ba;a.AXIS_MY=
ma;a.AXIS_MZ=W;a.zt=ga;a.keyfind=b;a.xx=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.sB=function(a,b){var c=a.length,d=new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.Sv=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.rv=function(a,b){var c=[],d={},e=b.length,f,g;for(f=0;f<e;f++)d[b[f]]=!0;e=a.length;for(f=0;f<e;f++)g=a[f],g in d&&c.push(g);return c};a.sign=d;a.kE=function(a,b,c){for(var d=c.length,
e=0;e<d;e++)if(c[e][a]==b)return!0;return!1};a.keysearch=function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];if(e[a]===b)return e}return null};a.jE=function(a,b,c,d,e){for(var f=0;f<e.length;f++){var g=e[f];if(g[a]==b&&g[c]==d)return g}return null};a.Am=function(a,b,c){for(var d=0;d<a.length;d++)if(a[d][b]==c)return d;return-1};a.kv=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.cD=function(a){for(var b=0;b<a.length-1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;
return!0};a.wE=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];e.type==b&&c.push(e)}return c};a.uE=function(a,c){var d=b("name",c,a);1<d.length&&B.error("obj_by_name(): name resolution ambiguity");return d};a.vE=function(a,c){var d=b("name",c,a),e=d.length;1<e&&B.error("obj_by_name(): name resolution ambiguity");if(0>=e)return[];for(var f=[],g=0;g<e;g++){var h=d[g];if("EMPTY"==h.type&&h.dupli_group)for(var h=h.dupli_group.objects,l=0;l<h.length;l++)f.push(h[l])}return d=d.concat(f)};a.oB=
function(a,b,c,d){d||(d=new Float32Array(16));I.identity(d);d[12]=a;d[13]=b;d[14]=c};var pa=1;a.Jz=function(){pa=(69069*pa+5)%Math.pow(2,32);return Math.round(pa/65536)%32768/32767};a.XA=function(a){pa=a};a.Rc=function(a){var b=a[0]%ia*48271-3399*Math.floor(a[0]/ia);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.$j=function(a,b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));var c=Math.cos(a[1]/2),d=Math.cos(a[2]/2),e=Math.cos(a[0]/2),f=Math.sin(a[1]/
2),g=Math.sin(a[2]/2),h=Math.sin(a[0]/2);b[0]=f*g*e+c*d*h;b[1]=f*d*e+c*g*h;b[2]=c*g*e-f*d*h;b[3]=c*d*e-f*g*h;return b};a.mx=function(a){var b=k.create(),c=Math.cos(a[0]),d=Math.cos(a[1]),e=Math.cos(a[2]),f=Math.sin(a[0]),g=Math.sin(a[1]);a=Math.sin(a[2]);var h=c*e,l=c*a,m=f*e,n=f*a;b[0]=d*e;b[1]=d*a;b[2]=-g;b[3]=g*m-l;b[4]=g*n+h;b[5]=d*f;b[6]=g*h+n;b[7]=g*l-m;b[8]=d*c;return b};a.quat_to_euler=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=e*e,h=c*d+e*f;.499999<h?(b[0]=0,b[1]=2*Math.atan2(c,f),b[2]=
Math.PI/2):-.499999>h?(b[0]=0,b[1]=-2*Math.atan2(c,f),b[2]=-Math.PI/2):(b[0]=Math.atan2(2*c*f-2*d*e,1-2*c*c-2*g),b[1]=Math.atan2(2*d*f-2*c*e,1-2*d*d-2*g),b[2]=Math.asin(2*c*d+2*e*f));return b};a.quat_to_dir=function(a,b,c){c||(c=new Float32Array(3));t.transformQuat(b,a,c);return c};a.pD=function(a,b,c){c||(c=new Float32Array(4));a=t.normalize(a,J);var d=t.dot(b,a);a=t.cross(b,a,P);d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2);return c};a.pB=
function(a,b,c,d){d||(d=new Float32Array(4));t.transformQuat(c,b,d);d[3]=-t.dot(a,d)};a.ex=function(a){var b=a.d.quat;switch(a.type){case "CAMERA":J[0]=0;J[1]=-1;J[2]=0;t.transformQuat(J,b,J);P[0]=0;P[1]=0;P[2]=-1;break;case "MESH":J[0]=0;J[1]=0;J[2]=1;t.transformQuat(J,b,J);P[0]=0;P[1]=0;P[2]=1;break;case "EMPTY":J[0]=0,J[1]=1,J[2]=0,t.transformQuat(J,b,J),P[0]=0,P[1]=1,P[2]=0}J[1]=0;t.normalize(J,J);a=t.dot(J,P);return Math.acos(a)*(0<-J[0]*P[2]?-1:1)};a.ep=function(a,b,c,d){if(0!=c){d=d||[];for(var e=
0;e<a.length;e++)d[e]=(1-c)*a[e]+c*b[e]}};a.PE=function(){F++;return F.toString(16)};a.Qk=function(a){L[a]||(L[a]=0);var b=a+L[a];L[a]++;return b};a.Wc=function(){return{a_position:new Float32Array(0),a_tangent:new Float32Array(0),a_normal:new Float32Array(0)}};a.lb=function(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};return{name:a,K:0,ea:null,A:[],H:b,V:[]}};a.Df=function(a){return JSON.parse(JSON.stringify(a))};a.eD=function(a,b){var d=[],
e;for(e in b){var f=b[e];if(f)for(var g=0;g<f.length;g++)d.push(f[g])}return c(a,d)};a.qa=function(b){var c=b instanceof Array?[]:{},d;for(d in b)c[d]=b[d]&&"object"==typeof b[d]?b[d]instanceof Float32Array?new Float32Array(b[d]):b[d]instanceof Uint32Array?new Uint32Array(b[d]):b[d]instanceof Uint16Array?new Uint16Array(b[d]):a.qa(b[d]):b[d];return c};a.Fj=function(a){var b=a instanceof Array?[]:{},c;for(c in a)b[c]=a[c]&&"object"==typeof a[c]?a[c]instanceof Float32Array?new Float32Array(a[c]):a[c]instanceof
Uint32Array?new Uint32Array(a[c]):a[c]instanceof Uint16Array?new Uint16Array(a[c]):a[c]instanceof Array?a[c].slice(0):a[c]:a[c];return b};a.is_mesh=function(a){return"MESH"===a.type?!0:!1};a.ck=function(a){return"EMPTY"===a.type?!0:!1};a.is_armature=function(a){return"ARMATURE"===a.type?!0:!1};a.matrix_to_quat=function(a,b){b||(b=new Float32Array(4));k.fromMat4(a,H);var c=H[0],d=H[3],e=H[6],f=H[1],g=H[4],h=H[7],l=H[2],m=H[5],n=H[8],c=Math.sqrt(c*c+d*d+e*e)||1,f=Math.sqrt(f*f+g*g+h*h)||1,l=Math.sqrt(l*
l+m*m+n*n)||1;H[0]/=c;H[3]/=c;H[6]/=c;H[1]/=f;H[4]/=f;H[7]/=f;H[2]/=l;H[5]/=l;H[8]/=l;A.fromMat3(H,b);return b};a.fh=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.fn=function(a){z[0]=.577350269189626;z[1]=.577350269189626;z[2]=.577350269189626;z[3]=0;G.transformMat4(z,a,z);return G.length(z)};a.jm=function(a,b){var c=b.left,d=b.right,f=b.top,g=b.bottom,h=b.Qa,l=b.Pa;c[0]=a[3]+a[0];c[1]=a[7]+a[4];c[2]=a[11]+a[8];c[3]=a[15]+a[12];d[0]=a[3]-a[0];d[1]=a[7]-a[4];
d[2]=a[11]-a[8];d[3]=a[15]-a[12];f[0]=a[3]-a[1];f[1]=a[7]-a[5];f[2]=a[11]-a[9];f[3]=a[15]-a[13];g[0]=a[3]+a[1];g[1]=a[7]+a[5];g[2]=a[11]+a[9];g[3]=a[15]+a[13];h[0]=a[3]+a[2];h[1]=a[7]+a[6];h[2]=a[11]+a[10];h[3]=a[15]+a[14];l[0]=a[3]-a[2];l[1]=a[7]-a[6];l[2]=a[11]-a[10];l[3]=a[15]-a[14];e(c);e(d);e(f);e(g);e(h);e(l)};a.SA=function(a,b,c){return c<-g(a,b.left)||c<-g(a,b.right)||c<-g(a,b.top)||c<-g(a,b.bottom)||c<-g(a,b.Qa)||c<-g(a,b.Pa)?!0:!1};a.kx=function(a,b,c,d,e){f=t.dot(c,b.Pa);h=t.dot(d,b.Pa);
l=t.dot(e,b.Pa);f=Math.sqrt(f*f+h*h+l*l);if(f<-g(a,b.Qa)||f<-g(a,b.Pa))return!0;var f=t.dot(c,b.left),h=t.dot(d,b.left),l=t.dot(e,b.left);if(Math.sqrt(f*f+h*h+l*l)<-g(a,b.left))return!0;f=t.dot(c,b.right);h=t.dot(d,b.right);l=t.dot(e,b.right);if(Math.sqrt(f*f+h*h+l*l)<-g(a,b.right))return!0;f=t.dot(c,b.top);h=t.dot(d,b.top);l=t.dot(e,b.top);if(Math.sqrt(f*f+h*h+l*l)<-g(a,b.top))return!0;f=t.dot(c,b.bottom);h=t.dot(d,b.bottom);l=t.dot(e,b.bottom);return Math.sqrt(f*f+h*h+l*l)<-g(a,b.bottom)?!0:!1};
a.We=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],l=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*l+b[12];c[d+f+1]=b[1]*g+b[5]*h+b[9]*l+b[13];c[d+f+2]=b[2]*g+b[6]*h+b[10]*l+b[14]}};a.gC=function(a,b,c){for(var d=0,d=0,e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],l=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*l;c[d+f+1]=b[1]*g+b[5]*h+b[9]*l;c[d+f+2]=b[2]*g+b[6]*h+b[10]*l}};a.lB=function(a,b,c){for(var d=0,d=0,e=a.length,f=0;f<e;f+=4){var g=a[f],h=a[f+1],l=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*
l;c[d+f+1]=b[1]*g+b[5]*h+b[9]*l;c[d+f+2]=b[2]*g+b[6]*h+b[10]*l;c[d+f+3]=a[f+3]}};a.eC=function(a,b,c){c||(c=new Float32Array(3));z[0]=a[0];z[1]=a[1];z[2]=a[2];z[3]=0;G.transformMat4(z,b,z);c[0]=z[0];c[1]=z[1];c[2]=z[2]};a.yD=function(a,b){var c=a.length;if(!c)throw"flatten(): Wrong or empty array";var d=a[0].length;if(!d)throw"flatten(): Wrong or empty subarray";b||(b=new Float32Array(c*d));for(var e=0;e<c;e++)for(var f=0;f<d;f++)b[e*d+f]=a[e][f];return b};a.fC=function(a){for(var b=[],c=0;c<a.length;c+=
3){var d=new Float32Array([a[c],a[c+1],a[c+2]]);b[c/3]=d}return b};a.xj=function(b,c,d,e){if(e<d)return d;var f=d+Math.floor((e-d)/2);return b[f]>c?a.xj(b,c,d,f-1):b[f]<c?a.xj(b,c,f+1,e):f};a.Ee=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0};a.fD=function(a,b,c){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-b[d])>c)return!1;return!0};a.bA=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15]};a.eo=function(a,
b,c,d){d||(d=new Float32Array(16));b=I.fromRotationTranslation(b,c,K);I.multiply(b,a,d)};a.transform_vec3=function(a,b,c,d,e){e||(e=new Float32Array(3));c=I.fromRotationTranslation(c,d,K);1!==b&&(d=I.identity(O),b=t.set(b,b,b,J),I.scale(d,b,d),I.multiply(c,d,c));t.transformMat4(a,c,e);return e};a.fo=function(a,b,c,d){d||(d=new Float32Array(4));b=I.fromRotationTranslation(b,c,K);G.transformMat4(a,b,d)};a.bE=function(a,b,c,d,e){e||(e=new Float32Array(3));b=I.fromRotationTranslation(c,d,K);I.invert(b,
b);t.transformMat4(a,b,e);return e};a.NE=function(a,b,c){c||(c=new Float32Array(16));I.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.tE=function(b,c,d){a.fh(b,c);c[3]=a.fn(b);a.matrix_to_quat(b,d)};a.NC=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return JSON.stringify(b)};a.Yz=function(a,b,c,d){d||(d=new Float32Array(3));t.subtract(b,a,J);t.transformQuat(J,c,J);t.subtract(b,J,d)};a.Jx=function(){J[0]=0;J[1]=0;J[2]=0;var a=new Float32Array(16),b=new Float32Array(16),
c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16);I.lookAt(J,[-1,0,0],[0,-1,0],a);I.scale(a,[-1,1,1],a);I.scale(a,[-1,1,-1],b);I.lookAt(J,[0,-1,0],[0,0,-1],c);I.scale(c,[1,1,-1],c);I.scale(c,[1,-1,-1],d);I.lookAt(J,[0,0,-1],[0,-1,0],e);I.scale(e,[-1,1,1],e);I.scale(e,[-1,1,-1],f);return[a,b,c,d,e,f]};a.Nx=function(){J[0]=0;J[1]=0;J[2]=0;var a=new Float32Array(16),b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=
new Float32Array(16);I.lookAt(J,[1,0,0],[0,-1,0],a);I.scale(a,[-1,1,-1],b);I.lookAt(J,[0,1,0],[0,0,1],c);I.scale(c,[1,-1,-1],d);I.lookAt(J,[0,0,1],[0,-1,0],e);I.scale(e,[-1,1,-1],f);return[a,b,c,d,e,f]};a.Jg=function(a,b){return f(a,b)};a.hash_code=f;a.VD=p;a.sE=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f,g,h,l,m,k,n,p,r,t,q,v;if(!c||a===c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;f=a[0];g=a[1];
h=a[2];l=a[3];m=a[4];k=a[5];n=a[6];p=a[7];r=a[8];t=a[9];q=a[10];v=a[11];c[0]=f;c[1]=g;c[2]=h;c[3]=l;c[4]=m;c[5]=k;c[6]=n;c[7]=p;c[8]=r;c[9]=t;c[10]=q;c[11]=v;c[12]=f*d+m*e+r*b+a[12];c[13]=g*d+k*e+t*b+a[13];c[14]=h*d+n*e+q*b+a[14];c[15]=l*d+p*e+v*b+a[15];return c};a.ez=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.quat_to_angle_axis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*
a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.Bk=function(a){return a*Math.PI/180};a.Zw=function(a){return 180*a/Math.PI};a.Mn=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],c=Math.floor(a[0]+b),d=Math.floor(a[1]+b),e=.211324865405187*c+.211324865405187*d,b=a[0]-c+e;a=a[1]-d+e;var f=b>a?1:0,g=1-f,e=b+.211324865405187-f,h=a+
.211324865405187-g,k=b+-.577350269189626,n=a+-.577350269189626,c=c%289,d=d%289,p=l(l(d)+c),g=l(l(d+g)+c+f),r=l(l(d+1)+c+1),c=Math.max(.5-(b*b+a*a),0),d=Math.max(.5-(e*e+h*h),0),f=Math.max(.5-(k*k+n*n),0),t=2*m(.024390243902439*p)-1,q=2*m(.024390243902439*g)-1,v=2*m(.024390243902439*r)-1,p=Math.abs(t)-.5,g=Math.abs(q)-.5,r=Math.abs(v)-.5,t=t-Math.floor(t+.5),q=q-Math.floor(q+.5),v=v-Math.floor(v+.5),c=c*c*c*c*(1.79284291400159-.85373472095314*(t*t+p*p)),d=d*d*d*d*(1.79284291400159-.85373472095314*
(q*q+g*g)),f=f*f*f*f*(1.79284291400159-.85373472095314*(v*v+r*r));return 130*(c*(t*b+p*a)+d*(q*e+g*h)+f*(v*k+r*n))};a.rp=function(a){var b=1/7,c=b/2,d=n(Math.floor(a[0])),e=n(Math.floor(a[1])),f=m(a[0]);a=m(a[1]);var g=f-.5,h=f-1.5,f=a-.5;a-=1.5;var l=r(d),k=r(d+1),p=l,d=k,l=r(l+e),k=r(k+e),p=r(p+e+1),d=r(d+e+1),e=g+.7*(y(l)*b+c),t=h+.7*(y(k)*b+c),g=g+.7*(y(p)*b+c),h=h+.7*(y(d)*b+c),l=f+.7*(y(Math.floor(l*b))*b+c),f=f+.7*(y(Math.floor(k*b))*b+c),p=a+.7*(y(Math.floor(p*b))*b+c),b=a+.7*(y(Math.floor(d*
b))*b+c);return Math.min(e*e+l*l,t*t+f*f,g*g+p*p,h*h+b*b)};a.quat_project=function(a,b,c,d,e){e||(e=new Float32Array(4));a=t.transformQuat(b,a,J);b=c[0];var f=c[1];c=c[2];H[0]=f*f+c*c;H[1]=-f*b;H[2]=-c*b;H[3]=-b*f;H[4]=b*b+c*c;H[5]=-c*f;H[6]=-b*c;H[7]=-f*c;H[8]=b*b+f*f;t.transformMat3(a,H,a);t.normalize(a,a);A.rotationTo(d,a,e);return e};a.cam_quat_to_mesh_quat=function(a,b){b||(b=new Float32Array(4));var c=z,d=N,c=A.setAxisAngle([0,1,0],Math.PI,A.create()),d=A.setAxisAngle([1,0,0],Math.PI/2,A.create());
A.multiply(c,d,c);A.multiply(a,c,b);return b};a.cleanup=function(){F=0;L={}};a.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};a.smooth=function(a,b,c,d){c=Math.exp(-c/d);return(1-c)*a+c*b};a.smooth_v=function(a,b,c,d,e){e||(e=new Float32Array(a.length));c=Math.exp(-c/d);for(d=0;d<e.length;d++)e[d]=(1-c)*a[d]+c*b[d];return e};a.Ds=function(a,b,c,d,e){e||(e=new Float32Array(a.length));A.slerp(a,b,Math.exp(-c/d),e)};a.cE=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?
!0:!1};a.is_vector=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.correct_cam_quat_up=function(a,b){var c=k.fromQuat(a,H);P[0]=0;P[1]=1;P[2]=0;J[0]=c[3];J[1]=c[4];J[2]=c[5];var d=t.cross(P,J,J);t.normalize(d,d);var e=c[7];!b&&0<e&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);P[0]=c[0];P[1]=c[1];P[2]=c[2];t.normalize(P,P);A.rotationTo(P,d,N);A.multiply(N,a,a)};a.oq=function(a,b,c,d){c=c*b-.5;var e=d*b-.5;d=c-Math.floor(c);var f=e-Math.floor(e);
c=Math.floor(c);var e=Math.floor(e),g=b-1,h=a[e*b+c],l=a[e*b+Math.min(c+1,g)],k=a[Math.min(e+1,g)*b+c];a=a[Math.min(e+1,g)*b+Math.min(c+1,g)];return(h*(1-d)+l*d)*(1-f)+(k*(1-d)+a*d)*f};a.pg=function(a){for(var b=0,c=0;3>c;c++)0<(a&1<<c)&&b++;return b};a.ls=function(a){for(var b=[0,0,0],c=0;3>c;c++)0<(a&1<<c)&&(b[2-c]=1);return b};a.Si=function(a,b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.vm=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=
16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.qd=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.random_from_array=function(a){if(!a.length)return null;var b=Math.floor(Math.random()*a.length);return a[b]};a.xz_direction=function(a,b,c){c||(c=new Float32Array(3));c[0]=a[0]-b[0];c[1]=0;c[2]=a[2]-b[2];t.normalize(c,c)};a.qB=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1],h=b[2];b=b[3];var l=g*a-h*e,k=h*d-f*a,m=f*e-g*d,n=g*m-h*k,h=h*l-f*m,f=f*k-g*l;c[0]=
d+2*l*b+2*n;c[1]=e+2*k*b+2*h;c[2]=a+2*m*b+2*f};a.assert=function(a){if(!a)throw Error("Assertion failed");};a.pa=function(a){a&&B.error.apply(B,arguments);throw"panic: see above for possible error messages";};a.angle_wrap_periodic=v;a.angle_wrap_0_2pi=E;a.ym=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.Qs=function(a,b){for(var c in a){var d=!0,e=a[c],f=b[c];switch(typeof e){case "number":case "string":case "boolean":d=e==f;break;case "object":d=x(e,f)}if(!d)return!1}return!0};a.xn=function(a,
b){var c=a[0],d=a[2],e=a[3];b[0]=a[1];b[1]=d;b[2]=e;b[3]=c};a.jq=function(a){a+=1;132651<a&&B.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var c=Math.floor(a/51);return new Float32Array([b/51,c/51,a%51/51])};a.line_plane_intersect=function(a,b,c,d,e){z.set(a);z[3]=b;N.set(d);N[3]=0;a=G.dot(z,N);if(0==a)return null;N.set(c);N[3]=1;a=-G.dot(z,N)/a;e[0]=c[0]+a*d[0];e[1]=c[1]+a*d[1];e[2]=c[2]+a*d[2];return e};a.jy=function(a,b,c,d){var e=b[0]-a[0],f=c[0]-a[0],g=b[1]-a[1],h=c[1]-a[1];
b=b[2]-a[2];a=c[2]-a[2];d[0]=g*a-b*h;d[1]=f*b-e*a;d[2]=e*h-g*f;return d};a.hD=function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b};a.$z=function(a,b,c){var d=t.dot(a,b);-.9999999>d?(t.cross(ka,a,J),1E-6>t.length(J)&&t.cross(qa,a,J),t.normalize(J,J),A.setAxisAngle(J,Math.PI,c)):(t.cross(a,b,J),c.set(J),c[3]=1+d,A.normalize(c,c));return c};a.De=function(a,b,c){if(b==c)return c-a;a=E(a);b=E(b);c=E(c);var d=Math.abs(b-c);if(.001>d||.001>Math.abs(d-2*Math.PI))return 0;b=2*Math.PI-b;c=E(c+b);a=
E(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.smooth_step=function(a){return a*a*(3-2*a)};a.sv=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(b[d]==a[c])return!0;return!1};a.kD=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=0;return b};a.nt=function(a,b){for(var c=Math.max(a.length,b.length),e=0;e<c;e++){var f=d((e>=a.length?0:a[e])-(e>=b.length?0:b[e]));if(f)return f}return 0};a.Wk=function(a){return a.join(".")};a.$A=function(a){return a.split(".").map(function(a){return a|
0})};a.Ks=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2)};a.$m=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b}};b4w.module.__sfx=function(a,q){function b(){var a=window.AudioContext||window.webkitAudioContext;if(a){a=new a;if(a.createGain)return a;E.warn("deprecated WebAudio implementation");return null}E.warn("WebAudio is not supported");return null}function d(a,b,d){var e=a.j;if("NONE"!=e.behavior){d||(d=0);var l=e.loop,k=e.pitch;if(e.src&&(l||0<=d)){e.pl=Math.floor(5E4*Math.random());var m=L.currentTime+b;e.Bc=m;e.state=20;c(a);"POSITIONAL"==e.behavior||"BACKGROUND_SOUND"==e.behavior?(b=L.createBufferSource(),
b.buffer=e.src,b.playbackRate.value=k,l?(e.qb&&e.qb.disconnect(),b.loop=!0,b.start(m),e.duration=0):(l=b.buffer?b.buffer.duration:0,d>l?(l=m+d+e.ae,b.loop=!0,b.start(m),b.stop(l),e.duration=d):(b.loop=!1,b.start(m),e.duration=l)),b.connect(e.dc),e.qb=b,g(e),f(e)):"BACKGROUND_MUSIC"==e.behavior&&(x.clear_timeout(e.tl),x.clear_timeout(e.ul),d=function(){var b=a.j,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.qb=b.qb||L.createMediaElementSource(c),b.qb.connect(b.dc),20==b.state&&(c.currentTime&&(c.currentTime=
0),c.play()))},0==b?d():e.tl=x.set_timeout(d,1E3*b),e.duration=l?0:y(a));h(e,m)}}}function c(a){var b=a.j;if(!b.dc){var c=a.d.h;a=a.d.quat;if(t.jk){var d=L.createBiquadFilter();d.type="peaking"}else d=null;var e=L.createGain();switch(b.behavior){case "POSITIONAL":var f=L.createPanner();"string"!=typeof f.panningModel?(f.panningModel=f.EQUALPOWER,f.distanceModel=f.INVERSE_DISTANCE):(f.panningModel="equalpower",f.distanceModel="inverse");f.setPosition(c[0],c[1],c[2]);b.Xm.set(c);c=G;u.quat_to_dir(a,
u.AXIS_MY,c);f.setOrientation(c[0],c[1],c[2]);b.direction.set(c);f.refDistance=b.dist_ref;f.maxDistance=b.dist_max;f.rolloffFactor=b.attenuation;f.coneInnerAngle=b.gw;f.coneOuterAngle=b.hw;f.coneOuterGain=b.iw;var g=L.createGain();g.gain.value=n(b);d?(f.connect(d),d.connect(g)):f.connect(g);g.connect(e);b.dc=f;if(b.Mh){var h=L.createGain();e.connect(h);h.connect(L?J.j.dc:null)}else h=null,e.connect(L?J.j.dc:null);break;case "BACKGROUND_SOUND":f=null;g=L.createGain();g.gain.value=n(b);d?(b.dc=d,d.connect(g)):
b.dc=g;g.connect(e);b.Mh?(h=L.createGain(),e.connect(h),h.connect(L?J.j.dc:null)):(h=null,e.connect(L?J.j.dc:null));break;case "BACKGROUND_MUSIC":h=f=null,g=L.createGain(),g.gain.value=n(b),d?(b.dc=d,d.connect(g)):b.dc=g,g.connect(e),e.connect(L?J.j.dc:null)}b.Gi=f;b.pd=d;b.Vg=g;b.If=e;b.bs=h}}function e(a){var b=a.j,c=b.duration,b=b.delay+b.$w*Math.random();d(a,b,c)}function g(a){a.Mh&&a.bs.gain.cancelScheduledValues(a.Bc);a.Ji&&a.qb.playbackRate.cancelScheduledValues(a.Bc);a.cj=a.Bc}function f(a){if(a.Mh||
a.Ji){var b=a.bs,c=a.qb,d=c.buffer?c.buffer.duration:0;if(d){var e=a.Bc;z[0]=a.pl;for(var f=0;5>f;){var g=a.pitch+a.Ji*u.Rc(z);if(e>=a.cj){if(a.Mh){var h=1-u.clamp(a.Mh,0,1)*Math.random();b.gain.setValueAtTime(h,e)}a.Ji&&c.playbackRate.setValueAtTime(g,e);f++}e+=d/g}a.cj=e-.001}}}function h(a,b){if(a.km||a.ae){var c=a.If;c.gain.cancelScheduledValues(b);a.km?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.km)):c.gain.setValueAtTime(1,b);a.ae&&!a.loop&&(c.gain.setValueAtTime(1,b+a.duration),
c.gain.linearRampToValueAtTime(0,b+a.duration+a.ae))}}function p(a){if("SPEAKER"!=a.type)throw"Wrong object type";var b=a.j;if(20==b.state||40==b.state){var c=b.If,d=L.currentTime;b.ae&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.ae));"BACKGROUND_MUSIC"==b.behavior?b.src&&(x.clear_timeout(b.tl),x.clear_timeout(b.ul),b.ul=x.set_timeout(function(){var b=a.j.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.ae)):(c=b.qb,b.duration<c.buffer.duration?b.ae&&20==
b.state?c.stop(d+b.ae):20==b.state&&(c.stop(0),c.disconnect()):c.disconnect(),b.Bc=0,b.sn=0,b.Al=0);b.state=30}}function l(a){a=a.j;if(20==a.state){var b=L.currentTime;a.sn=b;if("BACKGROUND_MUSIC"==a.behavior){var c=a.src;c&&c.pause()}else{if(b>a.Bc){z[0]=a.pl;for(var d=a.qb.buffer.duration,e=a.Bc;e<b;)c=a.pitch+a.Ji*u.Rc(z),e+=d/c;c*=d/c-(e-b)}else c=0;a.Al=c;a.qb.stop(0);a.qb.disconnect();g(a)}a.state=40}}function m(a){var b=a.j;if(40==b.state){var c=L.currentTime;b.Bc+=c-b.sn;if("BACKGROUND_MUSIC"==
b.behavior)b.src.play();else{a=a.j;var d=L.createBufferSource();d.loop=a.qb.loop;d.buffer=a.qb.buffer;d.playbackRate.value=a.qb.playbackRate.value;a.Gi?d.connect(a.Gi):d.connect(a.Vg);a.qb=d;b.cj=c;b.qb.start(b.Bc,b.Al);f(b)}h(b,b.Bc);b.state=20}}function r(a){return!a.j||20!=a.j.state&&40!=a.j.state&&30!=a.j.state?!1:!0}function n(a){return a.muted?0:a.volume}function y(a){a=a.j;return(a=a.src)?a.duration:0}var v=q("__config"),E=q("__print"),x=q("__time"),u=q("__util"),B=q("vec3"),t=v.cd;a.xo=10;
a.Zk=20;a.wo=30;var G=new Float32Array(3),A=new Float32Array(3),k=new Float32Array(3),I=[],F=[],L=null,J=null,P=[],z=[1],N=null;a.init=function(){var a=document.createElement("audio"),c=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(I.push("ogg"),I.push("ogv")),""!=a.canPlayType("audio/mpeg")&&I.push("mp3"),""!=a.canPlayType("audio/mp4")&&(I.push("mp4"),I.push("m4v")),""!=a.canPlayType("audio/webm")&&I.push("webm"));c.canPlayType&&(""!=c.canPlayType("video/ogg")&&
F.push("ogv"),""!=c.canPlayType("video/mp4")&&F.push("m4v"),""!=c.canPlayType("video/webm")&&F.push("webm"));(L=t.to?b():null)&&E.log("%cINIT WEBAUDIO: "+L.sampleRate+"Hz","color: #00a")};a.Wo=function(a){var b={Yf:new Float32Array(3),kr:new Float32Array(3),eh:new Float32Array(3)};a.j=b;if(L){var c=L.createGain(),d=L.createGain();b.Vg=c;b.If=d;c.connect(d);d.connect(L.destination);if(a.b4w_enable_dynamic_compressor){var d=L.createDynamicsCompressor(),e=a.b4w_dynamic_compressor_settings;d.threshold.value=
e.threshold;d.knee.value=e.knee;d.ratio.value=e.ratio;d.attack.value=e.attack;d.release.value=e.release;d.connect(c);b.bi=d;b.dc=d}else b.bi=null,b.dc=c;c=L.listener;b.Og=v.o.Hl;b.Og||(c.dopplerFactor=a.audio_doppler_factor,c.speedOfSound=a.audio_doppler_speed);b.muted=!1;b.volume=1;b.Hf=0}};a.jA=function(a){J=a};a.detect_audio_container=function(a){a||(a="ogg");return-1<I.indexOf(a)?a:"ogg"==a&&-1<I.indexOf("mp4")?"mp4":"mp3"==a&&-1<I.indexOf("ogg")?"ogg":"mp4"==a&&-1<I.indexOf("ogg")?"ogg":"ogv"==
a&&-1<I.indexOf("m4v")?"m4v":"webm"==a&&-1<I.indexOf("m4v")?"m4v":"m4v"==a&&-1<I.indexOf("webm")?"webm":""};a.detect_video_container=function(a){a||(a="webm");return-1<F.indexOf(a)?a:"ogv"==a&&-1<F.indexOf("m4v")?"m4v":"webm"==a&&-1<F.indexOf("m4v")?"m4v":"m4v"==a&&-1<F.indexOf("webm")?"webm":""};a.append_object=function(a){if("SPEAKER"!=a.type)throw"Wrong speaker object";var b=a.data;a.j={};switch(b.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":a.j.behavior=L?b.b4w_behavior:"NONE";break;
case "BACKGROUND_MUSIC":var c=a.j,d;L?(window.MediaElementAudioSourceNode?d=!0:(E.warn("MediaElementAudioSourceNode not found"),d=!1),d=d?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):d="NONE";c.behavior=d;break;default:throw"Wrong speaker behavior";}b.sound||(a.j.behavior="NONE");a.j.Og=b.b4w_disable_doppler&&v.o.Hl;a.j.muted=b.muted;a.j.volume=b.volume;a.j.pitch=b.pitch;a.j.attenuation=b.attenuation;a.j.dist_ref=b.distance_reference;a.j.dist_max=b.distance_max||1E4;a.j.gw=b.cone_angle_inner;a.j.hw=b.cone_angle_outer;
a.j.iw=b.cone_volume_outer;a.j.cyclic=b.b4w_cyclic_play;a.j.loop=b.b4w_loop;a.j.delay=b.b4w_delay;a.j.$w=b.b4w_delay_random;a.j.Mh=b.b4w_volume_random;a.j.Ji=b.b4w_pitch_random;a.j.km=b.b4w_fade_in;a.j.ae=b.b4w_fade_out;a.j.Bc=0;a.j.sn=0;a.j.Al=0;a.j.duration=0;a.j.cj=0;a.j.pl=1;a.j.src=null;a.j.state=10;a.j.Xm=new Float32Array(3);a.j.direction=new Float32Array(3);a.j.On=new Float32Array(3);a.j.tl=-1;a.j.ul=-1;a.j.Hf=0;P.push(a)};a.Fs=function(b){if("SPEAKER"!=b.type)throw"Wrong object type";switch(b.j.behavior){case "POSITIONAL":return a.Zk;
case "BACKGROUND_SOUND":return a.Zk;case "BACKGROUND_MUSIC":return a.wo;case "NONE":return a.xo;default:throw"Wrong speaker behavior";}};a.NB=function(a,b){var c=a.j;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:throw"Wrong speaker behavior";}};a.Az=function(){var a=L.createBufferSource();a.buffer=L.createBuffer(1,22050,22050);a.connect(L.destination);a.start(0)};a.Ww=function(a,b,c){L?L.decodeAudioData(a,b,c):c()};a.OA=
function(a){p(a);delete a.j;P.splice(P.indexOf(a),1)};a.cleanup=function(){for(var a=0;a<P.length;a++){var b=P[a].j;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():b.qb&&b.qb.disconnect()}J&&J.j&&(a=J.j,a.Yf[0]=0,a.Yf[1]=0,a.Yf[2]=0,a.eh[0]=0,a.eh[1]=0,a.eh[2]=0);J=null;P.splice(0);N=null};a.update=function(a){if(L&&0!=P.length){for(var b=0;b<P.length;b++){var c=P[b],d=c.j,g=L.currentTime;L&&!d.loop&&d.cyclic&&20==d.state&&d.duration&&d.Bc+d.duration<g&&e(c);20==d.state&&3>d.cj-g&&f(d)}N&&N.pe.length&&
(-1==N.Ma||a>N.Oo+N.Tp[N.Ma])&&(b=N,-1<b.Ma&&p(b.pe[b.Ma]),-1==b.Ma&&b.random?c=Math.round(Math.random()*(b.pe.length-1)):b.random?(c=1+Math.round(Math.random()*(b.pe.length-2)),c=(b.Ma+c)%b.pe.length):c=(b.Ma+1)%b.pe.length,e(b.pe[c]),b.Ma=c,b.Oo=a)}};a.play=d;a.play_def=e;a.stop=p;a.is_play=function(a){return 20==a.j.state};a.NA=l;a.PA=m;a.playrate=function(a,b){var c=a.j;c.pitch=b;!r(a)||"POSITIONAL"!=c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.qb.playbackRate.value=b,g(c),f(c))};a.get_playrate=
function(a){return a.j.pitch};a.cyclic=function(a,b){a.j.cyclic=Boolean(b)};a.is_cyclic=function(a){return a.j.cyclic};a.Zy=function(a,b,c,d){if(L&&a.j){var e=G;e[0]=0;e[1]=-1;e[2]=0;B.transformQuat(e,c,e);A[0]=0;A[1]=0;A[2]=-1;B.transformQuat(A,c,A);c=L.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(e[0],e[1],e[2],A[0],A[1],A[2]);a.j.kr.set(e);!a.j.Og&&d&&(k[0]=(b[0]-a.j.Yf[0])/d,k[1]=(b[1]-a.j.Yf[1])/d,k[2]=(b[2]-a.j.Yf[2])/d,u.smooth_v(k,a.j.eh,d,.3,k),c.setVelocity(k[0],k[1],k[2]),a.j.eh.set(k));
a.j.Yf.set(b)}};a.listener_reset_speed=function(a,b){if(L&&J.j&&!J.j.Og){var c=G;b?c.set(b):c.set(J.j.kr);B.scale(c,a,c);L.listener.setVelocity(c[0],c[1],c[2]);J.j.eh.set(c)}};a.QA=function(a,b){var c=a.j;if(r(a)&&"POSITIONAL"==c.behavior){var d=a.d.h,e=c.Gi;e.setPosition(d[0],d[1],d[2]);var f=G;u.quat_to_dir(a.d.quat,u.AXIS_MY,f);e.setOrientation(f[0],f[1],f[2]);f=c.Xm;!c.Og&&b&&(A[0]=(d[0]-f[0])/b,A[1]=(d[1]-f[1])/b,A[2]=(d[2]-f[2])/b,u.smooth_v(A,c.On,b,.3,A),e.setVelocity(A[0],A[1],A[2]),c.On.set(A));
f.set(d)}};a.speaker_reset_speed=function(a,b,c){var d=a.j;if(r(a)&&"POSITIONAL"==d.behavior&&!d.Og){var e=G;c?e.set(c):e.set(d.direction);B.scale(e,b,e);d.Gi.setVelocity(e[0],e[1],e[2]);d.On.set(e);d.Xm.set(a.d.h)}};a.ge=function(a){return a.j?!0:!1};a.Bm=function(a){return a.j.behavior};a.check_active_speakers=function(){for(var a=0;a<P.length;a++)if(r(P[a]))return!0;return!1};a.sA=function(a){var b=J.j;b&&(b.volume=a,L&&(b.Vg.gain.value=n(b)))};a.iy=function(){var a=J.j;return a?a.volume:0};a.set_volume=
function(a,b){var c=a.j;c.volume=b;r(a)&&(c.Vg.gain.value=n(c))};a.get_volume=function(a){return a.j.volume};a.mute=function(a,b){a.j.muted=Boolean(b);r(a)&&(a.j.Vg.gain.value=n(a.j))};a.is_muted=function(a){return a.j.muted};a.mz=function(a){var b=J.j;b&&(b.muted=Boolean(a),L&&(b.Vg.gain.value=n(b)))};a.Ry=function(){var a=J.j;return a?a.muted:!1};a.get_speaker_objects=function(){return P};a.pause=function(){for(var a=0;a<P.length;a++)l(P[a])};a.resume=function(){for(var a=0;a<P.length;a++)m(P[a])};
a.set_compressor_params=function(a,b){if(a.j&&a.j.bi){var c=a.j.bi;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=b.attack;c.release.value=b.release}};a.get_compressor_params=function(a){if(!a.j||!a.j.bi)return null;a=a.j.bi;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.duck=function(a,b,c){if(r(a)){a=a.j;var d=a.If,e=L.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(b,
e+c);a.Hf=c}};a.unduck=function(a){if(r(a)){a=a.j;var b=a.If,c=L.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Hf);a.Hf=0}};a.gx=function(a,b){if(L){var c=J.j,d=c.If,e=L.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(a,e+b);c.Hf=b}};a.tB=function(){if(L){var a=J.j,b=a.If,c=L.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Hf);a.Hf=0}};a.apply_playlist=function(a,b,c){N={Ma:-1,Oo:0,random:c,
pe:[],Tp:[]};for(c=0;c<a.length;c++){var d=a[c],e=y(d);0==e?E.warn("Ignoring speaker with zero duration: "+d.name):(p(d),d.j.cyclic=!1,N.pe.push(d),N.Tp.push(e+b))}};a.get_duration=y;a.clear_playlist=function(){if(N)for(var a=N.pe,b=0;b<a.length;b++)p(a[b]);N=null};a.get_positional_params=function(a){return(a=a.j)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.set_positional_params=function(a,b){var c=a.j;if(c&&"POSITIONAL"==c.behavior){c.dist_ref=
b.dist_ref;c.dist_max=b.dist_max;c.attenuation=b.attenuation;var d=c.Gi;d&&(d.refDistance=c.dist_ref,d.maxDistance=c.dist_max,d.rolloffFactor=c.attenuation)}};a.set_filter_params=function(a,b){var c=a.j;c&&c.pd&&(c.pd.frequency.value=b.freq,c.pd.Q.value=b.Q,c.pd.gain.value=b.gain)};a.get_filter_params=function(a){return(a=a.j)&&a.pd?{freq:a.pd.frequency.value,Q:a.pd.Q.value,gain:a.pd.gain.value}:null};a.get_filter_freq_response=function(a,b,c,d){a=a.j;if(!a||!a.pd)return null;a.pd.getFrequencyResponse(b,
c,d)}};b4w.module.vec3=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array,b=Math.random;a.create=function(){var a=new q(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new q(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,e){var g=new q(3);g[0]=a;g[1]=b;g[2]=e;return g};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,e,g){g[0]=a;g[1]=b;g[2]=e;return g};a.add=function(a,b,e){e[0]=a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];return e};
a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],b[2]);return e};
a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;return e};a.scaleAndAdd=function(a,b,e,g){g[0]=a[0]+b[0]*e;g[1]=a[1]+b[1]*e;g[2]=a[2]+b[2]*e;return g};a.distance=function(a,b){var e=b[0]-a[0],g=b[1]-a[1],f=b[2]-a[2];return Math.sqrt(e*e+g*g+f*f)};a.dist=a.distance;a.squaredDistance=function(a,b){var e=b[0]-a[0],g=b[1]-a[1],f=b[2]-a[2];return e*e+g*g+f*f};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],e=a[1];a=a[2];return Math.sqrt(b*b+e*e+a*a)};a.len=a.length;a.squaredLength=
function(a){var b=a[0],e=a[1];a=a[2];return b*b+e*e+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var e=a[0],g=a[1],f=a[2],e=e*e+g*g+f*f;0<e&&(e=1/Math.sqrt(e),b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,e){var g=a[0],f=a[1];a=a[2];var h=b[0],p=b[1];b=b[2];e[0]=f*b-a*p;e[1]=
a*h-g*b;e[2]=g*p-f*h;return e};a.lerp=function(a,b,e,g){var f=a[0],h=a[1];a=a[2];g[0]=f+e*(b[0]-f);g[1]=h+e*(b[1]-h);g[2]=a+e*(b[2]-a);return g};a.random=function(a,c){a=a||1;var e=2*b()*Math.PI,g=2*b()-1,f=Math.sqrt(1-g*g)*a;c[0]=Math.cos(e)*f;c[1]=Math.sin(e)*f;c[2]=g*a;return c};a.transformMat4=function(a,b,e){var g=a[0],f=a[1];a=a[2];var h=b[3]*g+b[7]*f+b[11]*a+b[15],h=h||1;e[0]=(b[0]*g+b[4]*f+b[8]*a+b[12])/h;e[1]=(b[1]*g+b[5]*f+b[9]*a+b[13])/h;e[2]=(b[2]*g+b[6]*f+b[10]*a+b[14])/h;return e};a.transformMat3=
function(a,b,e){var g=a[0],f=a[1];a=a[2];e[0]=g*b[0]+f*b[3]+a*b[6];e[1]=g*b[1]+f*b[4]+a*b[7];e[2]=g*b[2]+f*b[5]+a*b[8];return e};a.transformQuat=function(a,b,e){var g=a[0],f=a[1],h=a[2];a=b[0];var p=b[1],l=b[2];b=b[3];var m=b*g+p*h-l*f,r=b*f+l*g-a*h,n=b*h+a*f-p*g,g=-a*g-p*f-l*h;e[0]=m*b+g*-a+r*-l-n*-p;e[1]=r*b+g*-p+n*-a-m*-l;e[2]=n*b+g*-l+m*-p-r*-a;return e};a.rotateX=function(a,b,e,g){var f=[],h=[];f[0]=a[0]-b[0];f[1]=a[1]-b[1];f[2]=a[2]-b[2];h[0]=f[0];h[1]=f[1]*Math.cos(e)-f[2]*Math.sin(e);h[2]=
f[1]*Math.sin(e)+f[2]*Math.cos(e);g[0]=h[0]+b[0];g[1]=h[1]+b[1];g[2]=h[2]+b[2];return g};a.rotateY=function(a,b,e,g){var f=[],h=[];f[0]=a[0]-b[0];f[1]=a[1]-b[1];f[2]=a[2]-b[2];h[0]=f[2]*Math.sin(e)+f[0]*Math.cos(e);h[1]=f[1];h[2]=f[2]*Math.cos(e)-f[0]*Math.sin(e);g[0]=h[0]+b[0];g[1]=h[1]+b[1];g[2]=h[2]+b[2];return g};a.rotateZ=function(a,b,e,g){var f=[],h=[];f[0]=a[0]-b[0];f[1]=a[1]-b[1];f[2]=a[2]-b[2];h[0]=f[0]*Math.cos(e)-f[1]*Math.sin(e);h[1]=f[0]*Math.sin(e)+f[1]*Math.cos(e);h[2]=f[2];g[0]=h[0]+
b[0];g[1]=h[1]+b[1];g[2]=h[2]+b[2];return g};a.forEach=function(){var b=a.create();return function(a,e,g,f,h,p){e||(e=3);g||(g=0);for(f=f?Math.min(f*e+g,a.length):a.length;g<f;g+=e)b[0]=a[g],b[1]=a[g+1],b[2]=a[g+2],h(b,p,b),a[g]=b[0],a[g+1]=b[1],a[g+2]=b[2];return a}}();a.MC=function(b,c){var e=a.fromValues(b[0],b[1],b[2]),g=a.fromValues(c[0],c[1],c[2]);a.normalize(e,e);a.normalize(g,g);e=a.dot(e,g);return 1<e?0:Math.acos(e)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};"undefined"!==
typeof a&&(a.vec3=a)};
b4w.module.vec4=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array,b=Math.random;a.create=function(){var a=new q(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new q(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,e,g){var f=new q(4);f[0]=a;f[1]=b;f[2]=e;f[3]=g;return f};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,e,g,f){f[0]=a;f[1]=b;f[2]=e;f[3]=g;return f};a.add=function(a,b,e){e[0]=
a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];e[3]=a[3]+b[3];return e};a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];e[3]=a[3]-b[3];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];e[3]=a[3]*b[3];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];e[3]=a[3]/b[3];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);e[3]=
Math.min(a[3],b[3]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],b[2]);e[3]=Math.max(a[3],b[3]);return e};a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;e[3]=a[3]*b;return e};a.scaleAndAdd=function(a,b,e,g){g[0]=a[0]+b[0]*e;g[1]=a[1]+b[1]*e;g[2]=a[2]+b[2]*e;g[3]=a[3]+b[3]*e;return g};a.distance=function(a,b){var e=b[0]-a[0],g=b[1]-a[1],f=b[2]-a[2],h=b[3]-a[3];return Math.sqrt(e*e+g*g+f*f+h*h)};a.dist=a.distance;a.squaredDistance=
function(a,b){var e=b[0]-a[0],g=b[1]-a[1],f=b[2]-a[2],h=b[3]-a[3];return e*e+g*g+f*f+h*h};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],e=a[1],g=a[2];a=a[3];return Math.sqrt(b*b+e*e+g*g+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],e=a[1],g=a[2];a=a[3];return b*b+e*e+g*g+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var e=a[0],g=a[1],f=a[2],h=a[3],e=e*e+g*g+f*f+h*h;0<e&&(e=1/Math.sqrt(e),b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e,b[3]=a[3]*e);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,e,g){var f=a[0],h=a[1],p=a[2];a=a[3];g[0]=f+e*(b[0]-f);g[1]=h+e*(b[1]-h);g[2]=p+e*(b[2]-p);g[3]=a+e*(b[3]-a);return g};a.random=function(d,c){d=d||1;c[0]=b();c[1]=b();c[2]=b();c[3]=b();a.normalize(c,c);a.scale(c,d,c);return c};a.transformMat4=function(a,b,e){var g=a[0],
f=a[1],h=a[2];a=a[3];e[0]=b[0]*g+b[4]*f+b[8]*h+b[12]*a;e[1]=b[1]*g+b[5]*f+b[9]*h+b[13]*a;e[2]=b[2]*g+b[6]*f+b[10]*h+b[14]*a;e[3]=b[3]*g+b[7]*f+b[11]*h+b[15]*a;return e};a.transformQuat=function(a,b,e){var g=a[0],f=a[1],h=a[2],p=b[0],l=b[1],m=b[2];b=b[3];var r=b*g+l*h-m*f,n=b*f+m*g-p*h,q=b*h+p*f-l*g,g=-p*g-l*f-m*h;e[0]=r*b+g*-p+n*-m-q*-l;e[1]=n*b+g*-l+q*-p-r*-m;e[2]=q*b+g*-m+r*-l-n*-p;e[3]=a[3];return e};a.forEach=function(){var b=a.create();return function(a,e,g,f,h,p){e||(e=4);g||(g=0);for(f=f?Math.min(f*
e+g,a.length):a.length;g<f;g+=e)b[0]=a[g],b[1]=a[g+1],b[2]=a[g+2],b[3]=a[g+3],h(b,p,b),a[g]=b[0],a[g+1]=b[1],a[g+2]=b[2],a[g+3]=b[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.vec4=a)};
b4w.module.quat=function(a,q){var b=q("vec3"),d=q("vec4"),c=q("mat3"),e="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new e(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var c=b.create(),d=b.fromValues(1,0,0),e=b.fromValues(0,1,0);return function(p,l,m){var r=b.dot(p,l);if(-.9999999>r)return b.cross(d,p,c),1E-6>b.length(c)&&b.cross(e,p,c),b.normalize(c,c),a.setAxisAngle(c,Math.PI,m),m;if(.9999999<r)return m[0]=0,m[1]=0,m[2]=0,m[3]=1,m;b.cross(p,
l,c);m[0]=c[0];m[1]=c[1];m[2]=c[2];m[3]=1+r;return a.normalize(m,m)}}();a.setAxes=function(){var b=c.create();return function(c,d,e,l){b[0]=d[0];b[3]=d[1];b[6]=d[2];b[1]=e[0];b[4]=e[1];b[7]=e[2];b[2]=-c[0];b[5]=-c[1];b[8]=-c[2];return a.normalize(a.fromMat3(b,l),l)}}();a.clone=d.clone;a.fromValues=d.fromValues;a.copy=d.copy;a.set=d.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,c){b*=.5;var d=Math.sin(b);c[0]=d*a[0];c[1]=d*a[1];c[2]=d*a[2];c[3]=Math.cos(b);
return c};a.add=d.add;a.multiply=function(a,b,c){var d=a[0],e=a[1],m=a[2];a=a[3];var r=b[0],n=b[1],q=b[2];b=b[3];c[0]=d*b+a*r+e*q-m*n;c[1]=e*b+a*n+m*r-d*q;c[2]=m*b+a*q+d*n-e*r;c[3]=a*b-d*r-e*n-m*q;return c};a.mul=a.multiply;a.scale=d.scale;a.rotateX=function(a,b,c){b*=.5;var d=a[0],e=a[1],m=a[2];a=a[3];var r=Math.sin(b);b=Math.cos(b);c[0]=d*b+a*r;c[1]=e*b+m*r;c[2]=m*b-e*r;c[3]=a*b-d*r;return c};a.rotateY=function(a,b,c){b*=.5;var d=a[0],e=a[1],m=a[2];a=a[3];var r=Math.sin(b);b=Math.cos(b);c[0]=d*
b-m*r;c[1]=e*b+a*r;c[2]=m*b+d*r;c[3]=a*b-e*r;return c};a.rotateZ=function(a,b,c){b*=.5;var d=a[0],e=a[1],m=a[2];a=a[3];var r=Math.sin(b);b=Math.cos(b);c[0]=d*b+e*r;c[1]=e*b-d*r;c[2]=m*b+a*r;c[3]=a*b-m*r;return c};a.calculateW=function(a,b){var c=a[0],d=a[1],e=a[2];b[0]=c;b[1]=d;b[2]=e;b[3]=Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b};a.dot=d.dot;a.lerp=d.lerp;a.slerp=function(a,b,c,d){var e=a[0],m=a[1],r=a[2];a=a[3];var n=b[0],q=b[1],v=b[2];b=b[3];var E,x,u;x=e*n+m*q+r*v+a*b;0>x&&(x=-x,n=-n,q=-q,
v=-v,b=-b);1E-6<1-x?(E=Math.acos(x),u=Math.sin(E),x=Math.sin((1-c)*E)/u,c=Math.sin(c*E)/u):x=1-c;d[0]=x*e+c*n;d[1]=x*m+c*q;d[2]=x*r+c*v;d[3]=x*a+c*b;return d};a.invert=function(a,b){var c=a[0],d=a[1],e=a[2],m=a[3],r=c*c+d*d+e*e+m*m,r=r?1/r:0;b[0]=-c*r;b[1]=-d*r;b[2]=-e*r;b[3]=m*r;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};a.length=d.length;a.len=a.length;a.squaredLength=d.squaredLength;a.sqrLen=a.squaredLength;a.normalize=d.normalize;a.fromMat3=function(a,
b){var c=a[0]+a[4]+a[8];if(0<c)c=Math.sqrt(c+1),b[3]=.5*c,c=.5/c,b[0]=(a[5]-a[7])*c,b[1]=(a[6]-a[2])*c,b[2]=(a[1]-a[3])*c;else{var d=0;a[4]>a[0]&&(d=1);a[8]>a[3*d+d]&&(d=2);var e=(d+1)%3,m=(d+2)%3,c=Math.sqrt(a[3*d+d]-a[3*e+e]-a[3*m+m]+1);b[d]=.5*c;c=.5/c;b[3]=(a[3*e+m]-a[3*m+e])*c;b[e]=(a[3*e+d]+a[3*d+e])*c;b[m]=(a[3*m+d]+a[3*d+m])*c}return b};a.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!==typeof a&&(a.quat=a)};
b4w.module.mat3=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new q(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[4];d[4]=a[5];d[5]=a[6];d[6]=a[8];d[7]=a[9];d[8]=a[10];return d};a.clone=function(a){var d=new q(9);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.copy=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=
a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,d){if(d===a){var c=a[1],e=a[2],g=a[5];d[1]=a[3];d[2]=a[6];d[3]=c;d[5]=a[7];d[6]=e;d[7]=g}else d[0]=a[0],d[1]=a[3],d[2]=a[6],d[3]=a[1],d[4]=a[4],d[5]=a[7],d[6]=a[2],d[7]=a[5],d[8]=a[8];return d};a.invert=function(a,d){var c=a[0],e=a[1],g=a[2],f=a[3],h=a[4],p=a[5],l=a[6],m=a[7],r=a[8],n=r*h-p*m,q=-r*f+p*l,v=
m*f-h*l,E=c*n+e*q+g*v;if(!E)return null;E=1/E;d[0]=n*E;d[1]=(-r*e+g*m)*E;d[2]=(p*e-g*h)*E;d[3]=q*E;d[4]=(r*c-g*l)*E;d[5]=(-p*c+g*f)*E;d[6]=v*E;d[7]=(-m*c+e*l)*E;d[8]=(h*c-e*f)*E;return d};a.adjoint=function(a,d){var c=a[0],e=a[1],g=a[2],f=a[3],h=a[4],p=a[5],l=a[6],m=a[7],r=a[8];d[0]=h*r-p*m;d[1]=g*m-e*r;d[2]=e*p-g*h;d[3]=p*l-f*r;d[4]=c*r-g*l;d[5]=g*f-c*p;d[6]=f*m-h*l;d[7]=e*l-c*m;d[8]=c*h-e*f;return d};a.determinant=function(a){var d=a[3],c=a[4],e=a[5],g=a[6],f=a[7],h=a[8];return a[0]*(h*c-e*f)+a[1]*
(-h*d+e*g)+a[2]*(f*d-c*g)};a.multiply=function(a,d,c){var e=a[0],g=a[1],f=a[2],h=a[3],p=a[4],l=a[5],m=a[6],r=a[7];a=a[8];var n=d[0],q=d[1],v=d[2],E=d[3],x=d[4],u=d[5],B=d[6],t=d[7];d=d[8];c[0]=n*e+q*h+v*m;c[1]=n*g+q*p+v*r;c[2]=n*f+q*l+v*a;c[3]=E*e+x*h+u*m;c[4]=E*g+x*p+u*r;c[5]=E*f+x*l+u*a;c[6]=B*e+t*h+d*m;c[7]=B*g+t*p+d*r;c[8]=B*f+t*l+d*a;return c};a.mul=a.multiply;a.translate=function(a,d,c){var e=a[0],g=a[1],f=a[2],h=a[3],p=a[4],l=a[5],m=a[6],r=a[7];a=a[8];var n=d[0];d=d[1];c[0]=e;c[1]=g;c[2]=f;
c[3]=h;c[4]=p;c[5]=l;c[6]=n*e+d*h+m;c[7]=n*g+d*p+r;c[8]=n*f+d*l+a;return c};a.rotate=function(a,d,c){var e=a[0],g=a[1],f=a[2],h=a[3],p=a[4],l=a[5],m=a[6],r=a[7];a=a[8];var n=Math.sin(d);d=Math.cos(d);c[0]=d*e+n*h;c[1]=d*g+n*p;c[2]=d*f+n*l;c[3]=d*h-n*e;c[4]=d*p-n*g;c[5]=d*l-n*f;c[6]=m;c[7]=r;c[8]=a;return c};a.scale=function(a,d,c){var e=d[0];d=d[1];c[0]=e*a[0];c[1]=e*a[1];c[2]=e*a[2];c[3]=d*a[3];c[4]=d*a[4];c[5]=d*a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.Dx=function(a,d){d[0]=1;d[1]=0;d[2]=
0;d[3]=0;d[4]=1;d[5]=0;d[6]=a[0];d[7]=a[1];d[8]=1;return d};a.Bx=function(a,d){var c=Math.sin(a),e=Math.cos(a);d[0]=e;d[1]=c;d[2]=0;d[3]=-c;d[4]=e;d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.Cx=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=a[1];d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.fromMat2d=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=0;d[3]=a[2];d[4]=a[3];d[5]=0;d[6]=a[4];d[7]=a[5];d[8]=1;return d};a.fromQuat=function(a,d){var c=a[0],e=a[1],g=a[2],f=a[3],h=c+c,p=e+e,l=g+g,c=c*h,m=e*h,e=e*p,r=g*h,n=
g*p,g=g*l,h=f*h,p=f*p,f=f*l;d[0]=1-e-g;d[3]=m-f;d[6]=r+p;d[1]=m+f;d[4]=1-c-g;d[7]=n-h;d[2]=r-p;d[5]=n+h;d[8]=1-c-e;return d};a.normalFromMat4=function(a,d){var c=a[0],e=a[1],g=a[2],f=a[3],h=a[4],p=a[5],l=a[6],m=a[7],r=a[8],n=a[9],q=a[10],v=a[11],E=a[12],x=a[13],u=a[14],B=a[15],t=c*p-e*h,G=c*l-g*h,A=c*m-f*h,k=e*l-g*p,I=e*m-f*p,F=g*m-f*l,L=r*x-n*E,J=r*u-q*E,r=r*B-v*E,P=n*u-q*x,n=n*B-v*x,q=q*B-v*u,v=t*q-G*n+A*P+k*r-I*J+F*L;if(!v)return null;v=1/v;d[0]=(p*q-l*n+m*P)*v;d[1]=(l*r-h*q-m*J)*v;d[2]=(h*n-p*
r+m*L)*v;d[3]=(g*n-e*q-f*P)*v;d[4]=(c*q-g*r+f*J)*v;d[5]=(e*r-c*n-f*L)*v;d[6]=(x*F-u*I+B*k)*v;d[7]=(u*A-E*F-B*G)*v;d[8]=(E*I-x*A+B*t)*v;return d};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.Ax=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!==typeof a&&(a.mat3=a)};
b4w.module.mat4=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new q(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var d=new q(16);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.copy=function(a,d){d[0]=a[0];d[1]=
a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,d){if(d===a){var c=a[1],e=a[2],g=a[3],f=a[6],h=a[7],p=a[11];d[1]=a[4];d[2]=a[8];d[3]=a[12];d[4]=c;d[6]=a[9];d[7]=a[13];d[8]=e;d[9]=f;d[11]=a[14];d[12]=g;d[13]=h;
d[14]=p}else d[0]=a[0],d[1]=a[4],d[2]=a[8],d[3]=a[12],d[4]=a[1],d[5]=a[5],d[6]=a[9],d[7]=a[13],d[8]=a[2],d[9]=a[6],d[10]=a[10],d[11]=a[14],d[12]=a[3],d[13]=a[7],d[14]=a[11],d[15]=a[15];return d};a.invert=function(a,d){var c=a[0],e=a[1],g=a[2],f=a[3],h=a[4],p=a[5],l=a[6],m=a[7],r=a[8],n=a[9],q=a[10],v=a[11],E=a[12],x=a[13],u=a[14],B=a[15],t=c*p-e*h,G=c*l-g*h,A=c*m-f*h,k=e*l-g*p,I=e*m-f*p,F=g*m-f*l,L=r*x-n*E,J=r*u-q*E,P=r*B-v*E,z=n*u-q*x,N=n*B-v*x,H=q*B-v*u,K=t*H-G*N+A*z+k*P-I*J+F*L;if(!K)return null;
K=1/K;d[0]=(p*H-l*N+m*z)*K;d[1]=(g*N-e*H-f*z)*K;d[2]=(x*F-u*I+B*k)*K;d[3]=(q*I-n*F-v*k)*K;d[4]=(l*P-h*H-m*J)*K;d[5]=(c*H-g*P+f*J)*K;d[6]=(u*A-E*F-B*G)*K;d[7]=(r*F-q*A+v*G)*K;d[8]=(h*N-p*P+m*L)*K;d[9]=(e*P-c*N-f*L)*K;d[10]=(E*I-x*A+B*t)*K;d[11]=(n*A-r*I-v*t)*K;d[12]=(p*J-h*z-l*L)*K;d[13]=(c*z-e*J+g*L)*K;d[14]=(x*G-E*k-u*t)*K;d[15]=(r*k-n*G+q*t)*K;return d};a.adjoint=function(a,d){var c=a[0],e=a[1],g=a[2],f=a[3],h=a[4],p=a[5],l=a[6],m=a[7],r=a[8],n=a[9],q=a[10],v=a[11],E=a[12],x=a[13],u=a[14],B=a[15];
d[0]=p*(q*B-v*u)-n*(l*B-m*u)+x*(l*v-m*q);d[1]=-(e*(q*B-v*u)-n*(g*B-f*u)+x*(g*v-f*q));d[2]=e*(l*B-m*u)-p*(g*B-f*u)+x*(g*m-f*l);d[3]=-(e*(l*v-m*q)-p*(g*v-f*q)+n*(g*m-f*l));d[4]=-(h*(q*B-v*u)-r*(l*B-m*u)+E*(l*v-m*q));d[5]=c*(q*B-v*u)-r*(g*B-f*u)+E*(g*v-f*q);d[6]=-(c*(l*B-m*u)-h*(g*B-f*u)+E*(g*m-f*l));d[7]=c*(l*v-m*q)-h*(g*v-f*q)+r*(g*m-f*l);d[8]=h*(n*B-v*x)-r*(p*B-m*x)+E*(p*v-m*n);d[9]=-(c*(n*B-v*x)-r*(e*B-f*x)+E*(e*v-f*n));d[10]=c*(p*B-m*x)-h*(e*B-f*x)+E*(e*m-f*p);d[11]=-(c*(p*v-m*n)-h*(e*v-f*n)+r*
(e*m-f*p));d[12]=-(h*(n*u-q*x)-r*(p*u-l*x)+E*(p*q-l*n));d[13]=c*(n*u-q*x)-r*(e*u-g*x)+E*(e*q-g*n);d[14]=-(c*(p*u-l*x)-h*(e*u-g*x)+E*(e*l-g*p));d[15]=c*(p*q-l*n)-h*(e*q-g*n)+r*(e*l-g*p);return d};a.determinant=function(a){var d=a[0],c=a[1],e=a[2],g=a[3],f=a[4],h=a[5],p=a[6],l=a[7],m=a[8],r=a[9],n=a[10],q=a[11],v=a[12],E=a[13],x=a[14];a=a[15];return(d*h-c*f)*(n*a-q*x)-(d*p-e*f)*(r*a-q*E)+(d*l-g*f)*(r*x-n*E)+(c*p-e*h)*(m*a-q*v)-(c*l-g*h)*(m*x-n*v)+(e*l-g*p)*(m*E-r*v)};a.multiply=function(a,d,c){var e=
a[0],g=a[1],f=a[2],h=a[3],p=a[4],l=a[5],m=a[6],r=a[7],n=a[8],q=a[9],v=a[10],E=a[11],x=a[12],u=a[13],B=a[14];a=a[15];var t=d[0],G=d[1],A=d[2],k=d[3];c[0]=t*e+G*p+A*n+k*x;c[1]=t*g+G*l+A*q+k*u;c[2]=t*f+G*m+A*v+k*B;c[3]=t*h+G*r+A*E+k*a;t=d[4];G=d[5];A=d[6];k=d[7];c[4]=t*e+G*p+A*n+k*x;c[5]=t*g+G*l+A*q+k*u;c[6]=t*f+G*m+A*v+k*B;c[7]=t*h+G*r+A*E+k*a;t=d[8];G=d[9];A=d[10];k=d[11];c[8]=t*e+G*p+A*n+k*x;c[9]=t*g+G*l+A*q+k*u;c[10]=t*f+G*m+A*v+k*B;c[11]=t*h+G*r+A*E+k*a;t=d[12];G=d[13];A=d[14];k=d[15];c[12]=t*e+
G*p+A*n+k*x;c[13]=t*g+G*l+A*q+k*u;c[14]=t*f+G*m+A*v+k*B;c[15]=t*h+G*r+A*E+k*a;return c};a.mul=a.multiply;a.translate=function(a,d,c){var e=d[0],g=d[1];d=d[2];var f,h,p,l,m,r,n,q,v,E,x,u;a===c?(c[12]=a[0]*e+a[4]*g+a[8]*d+a[12],c[13]=a[1]*e+a[5]*g+a[9]*d+a[13],c[14]=a[2]*e+a[6]*g+a[10]*d+a[14],c[15]=a[3]*e+a[7]*g+a[11]*d+a[15]):(f=a[0],h=a[1],p=a[2],l=a[3],m=a[4],r=a[5],n=a[6],q=a[7],v=a[8],E=a[9],x=a[10],u=a[11],c[0]=f,c[1]=h,c[2]=p,c[3]=l,c[4]=m,c[5]=r,c[6]=n,c[7]=q,c[8]=v,c[9]=E,c[10]=x,c[11]=u,
c[12]=f*e+m*g+v*d+a[12],c[13]=h*e+r*g+E*d+a[13],c[14]=p*e+n*g+x*d+a[14],c[15]=l*e+q*g+u*d+a[15]);return c};a.scale=function(a,d,c){var e=d[0],g=d[1];d=d[2];c[0]=a[0]*e;c[1]=a[1]*e;c[2]=a[2]*e;c[3]=a[3]*e;c[4]=a[4]*g;c[5]=a[5]*g;c[6]=a[6]*g;c[7]=a[7]*g;c[8]=a[8]*d;c[9]=a[9]*d;c[10]=a[10]*d;c[11]=a[11]*d;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.rotate=function(a,d,c,e){var g=c[0],f=c[1];c=c[2];var h=Math.sqrt(g*g+f*f+c*c),p,l,m,r,n,q,v,E,x,u,B,t,G,A,k,I,F,L,J,P;if(1E-7>Math.abs(h))return null;
h=1/h;g*=h;f*=h;c*=h;p=Math.sin(d);l=Math.cos(d);m=1-l;d=a[0];h=a[1];r=a[2];n=a[3];q=a[4];v=a[5];E=a[6];x=a[7];u=a[8];B=a[9];t=a[10];G=a[11];A=g*g*m+l;k=f*g*m+c*p;I=c*g*m-f*p;F=g*f*m-c*p;L=f*f*m+l;J=c*f*m+g*p;P=g*c*m+f*p;g=f*c*m-g*p;f=c*c*m+l;e[0]=d*A+q*k+u*I;e[1]=h*A+v*k+B*I;e[2]=r*A+E*k+t*I;e[3]=n*A+x*k+G*I;e[4]=d*F+q*L+u*J;e[5]=h*F+v*L+B*J;e[6]=r*F+E*L+t*J;e[7]=n*F+x*L+G*J;e[8]=d*P+q*g+u*f;e[9]=h*P+v*g+B*f;e[10]=r*P+E*g+t*f;e[11]=n*P+x*g+G*f;a!==e&&(e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]);
return e};a.rotateX=function(a,d,c){var e=Math.sin(d);d=Math.cos(d);var g=a[4],f=a[5],h=a[6],p=a[7],l=a[8],m=a[9],r=a[10],n=a[11];a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[4]=g*d+l*e;c[5]=f*d+m*e;c[6]=h*d+r*e;c[7]=p*d+n*e;c[8]=l*d-g*e;c[9]=m*d-f*e;c[10]=r*d-h*e;c[11]=n*d-p*e;return c};a.rotateY=function(a,d,c){var e=Math.sin(d);d=Math.cos(d);var g=a[0],f=a[1],h=a[2],p=a[3],l=a[8],m=a[9],r=a[10],n=a[11];a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],
c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[0]=g*d-l*e;c[1]=f*d-m*e;c[2]=h*d-r*e;c[3]=p*d-n*e;c[8]=g*e+l*d;c[9]=f*e+m*d;c[10]=h*e+r*d;c[11]=p*e+n*d;return c};a.rotateZ=function(a,d,c){var e=Math.sin(d);d=Math.cos(d);var g=a[0],f=a[1],h=a[2],p=a[3],l=a[4],m=a[5],r=a[6],n=a[7];a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]);c[0]=g*d+l*e;c[1]=f*d+m*e;c[2]=h*d+r*e;c[3]=p*d+n*e;c[4]=l*d-g*e;c[5]=m*d-f*e;c[6]=r*d-h*e;c[7]=n*d-p*e;return c};
a.Dx=function(a,d){d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=a[0];d[13]=a[1];d[14]=a[2];d[15]=1;return d};a.Cx=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=a[1];d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=a[2];d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.Bx=function(a,d,c){var e=d[0],g=d[1];d=d[2];var f=Math.sqrt(e*e+g*g+d*d),h;if(1E-7>Math.abs(f))return null;f=1/f;e*=f;g*=f;d*=f;f=Math.sin(a);a=Math.cos(a);h=1-a;c[0]=e*e*h+a;c[1]=g*e*h+d*
f;c[2]=d*e*h-g*f;c[3]=0;c[4]=e*g*h-d*f;c[5]=g*g*h+a;c[6]=d*g*h+e*f;c[7]=0;c[8]=e*d*h+g*f;c[9]=g*d*h-e*f;c[10]=d*d*h+a;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.DD=function(a,d){var c=Math.sin(a),e=Math.cos(a);d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=e;d[6]=c;d[7]=0;d[8]=0;d[9]=-c;d[10]=e;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.ED=function(a,d){var c=Math.sin(a),e=Math.cos(a);d[0]=e;d[1]=0;d[2]=-c;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=c;d[9]=0;d[10]=e;d[11]=0;d[12]=0;d[13]=0;
d[14]=0;d[15]=1;return d};a.FD=function(a,d){var c=Math.sin(a),e=Math.cos(a);d[0]=e;d[1]=c;d[2]=0;d[3]=0;d[4]=-c;d[5]=e;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.fromRotationTranslation=function(a,d,c){var e=a[0],g=a[1],f=a[2],h=a[3],p=e+e,l=g+g,m=f+f;a=e*p;var r=e*l,e=e*m,n=g*l,g=g*m,f=f*m,p=h*p,l=h*l,h=h*m;c[0]=1-(n+f);c[1]=r+h;c[2]=e-l;c[3]=0;c[4]=r-h;c[5]=1-(a+f);c[6]=g+p;c[7]=0;c[8]=e+l;c[9]=g-p;c[10]=1-(a+n);c[11]=0;c[12]=d[0];c[13]=d[1];c[14]=d[2];
c[15]=1;return c};a.fromQuat=function(a,d){var c=a[0],e=a[1],g=a[2],f=a[3],h=c+c,p=e+e,l=g+g,c=c*h,m=e*h,e=e*p,r=g*h,n=g*p,g=g*l,h=f*h,p=f*p,f=f*l;d[0]=1-e-g;d[1]=m+f;d[2]=r-p;d[3]=0;d[4]=m-f;d[5]=1-c-g;d[6]=n+h;d[7]=0;d[8]=r+p;d[9]=n-h;d[10]=1-c-e;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.frustum=function(a,d,c,e,g,f,h){var p=1/(d-a),l=1/(e-c),m=1/(g-f);h[0]=2*g*p;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*g*l;h[6]=0;h[7]=0;h[8]=(d+a)*p;h[9]=(e+c)*l;h[10]=(f+g)*m;h[11]=-1;h[12]=0;h[13]=0;h[14]=
f*g*2*m;h[15]=0;return h};a.perspective=function(a,d,c,e,g){a=1/Math.tan(a/2);var f=1/(c-e);g[0]=a/d;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=a;g[6]=0;g[7]=0;g[8]=0;g[9]=0;g[10]=(e+c)*f;g[11]=-1;g[12]=0;g[13]=0;g[14]=2*e*c*f;g[15]=0;return g};a.zE=function(a,d,c,e){var g=Math.tan(a.QE*Math.PI/180),f=Math.tan(a.qD*Math.PI/180),h=Math.tan(a.lE*Math.PI/180);a=Math.tan(a.BE*Math.PI/180);var p=2/(h+a),l=2/(g+f);e[0]=p;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=l;e[6]=0;e[7]=0;e[8]=-((h-a)*p*.5);e[9]=(g-f)*l*.5;e[10]=c/
(d-c);e[11]=-1;e[12]=0;e[13]=0;e[14]=c*d/(d-c);e[15]=0;return e};a.ortho=function(a,d,c,e,g,f,h){var p=1/(a-d),l=1/(c-e),m=1/(g-f);h[0]=-2*p;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=-2*l;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=2*m;h[11]=0;h[12]=(a+d)*p;h[13]=(e+c)*l;h[14]=(f+g)*m;h[15]=1;return h};a.lookAt=function(b,d,c,e){var g,f,h,p,l,m,r,n,q=b[0],v=b[1];b=b[2];h=c[0];p=c[1];f=c[2];r=d[0];c=d[1];g=d[2];if(1E-7>Math.abs(q-r)&&1E-7>Math.abs(v-c)&&1E-7>Math.abs(b-g))return a.identity(e);d=q-r;c=v-c;r=b-g;n=1/Math.sqrt(d*
d+c*c+r*r);d*=n;c*=n;r*=n;g=p*r-f*c;f=f*d-h*r;h=h*c-p*d;(n=Math.sqrt(g*g+f*f+h*h))?(n=1/n,g*=n,f*=n,h*=n):h=f=g=0;p=c*h-r*f;l=r*g-d*h;m=d*f-c*g;(n=Math.sqrt(p*p+l*l+m*m))?(n=1/n,p*=n,l*=n,m*=n):m=l=p=0;e[0]=g;e[1]=p;e[2]=d;e[3]=0;e[4]=f;e[5]=l;e[6]=c;e[7]=0;e[8]=h;e[9]=m;e[10]=r;e[11]=0;e[12]=-(g*q+f*v+h*b);e[13]=-(p*q+l*v+m*b);e[14]=-(d*q+c*v+r*b);e[15]=1;return e};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+
a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.Ax=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!==typeof a&&(a.mat4=a)};b4w.module.__gpp_eval=function(a){a.Ur=function(){function a(b,d,c,e,g,f){this.message=b;this.offset=e;this.zi=g;this.Lg=f;this.name="SyntaxError"}(function(a,d){function c(){this.constructor=a}c.prototype=d.prototype;a.prototype=new c})(a,Error);return{SyntaxError:a,parse:function(b){function d(a,b){switch(a){case "++":return++b;case "--":return--b;case "+":return+b;case "-":return-b;case "~":return~b;case "!":return!b}}function c(a){if(Nb!==a){Nb>a&&(Nb=0,Ia={zi:1,Lg:1,Ui:!1});var c=Ia,d,e;for(d=
Nb;d<a;d++)e=b.charAt(d),"\n"===e?(c.Ui||c.zi++,c.Lg=1,c.Ui=!1):"\r"===e||"\u2028"===e||"\u2029"===e?(c.zi++,c.Lg=1,c.Ui=!0):(c.Lg++,c.Ui=!1);Nb=a}return Ia}function e(a){C<Ta||(C>Ta&&(Ta=C,zb=[]),zb.push(a))}function g(){var a,c,d;a=C;c=Q();c!==w?(c=f(),c!==w?(d=Q(),d!==w?(fa++,10===b.charCodeAt(C)?(d=jc,C++):(d=w,0===fa&&e(Yb)),d===w&&(b.substr(C,2)===wc?(d=wc,C+=2):(d=w,0===fa&&e(bb)),d===w&&(13===b.charCodeAt(C)?(d=Zb,C++):(d=w,0===fa&&e(Pc)))),fa--,d===w&&0===fa&&e(Mb),d===w&&(d=null),d!==w?
a=c:(C=a,a=w)):(C=a,a=w)):(C=a,a=w)):(C=a,a=w);return a}function f(){var a,c,d,f,g,l,k,m;a=C;c=h();if(c!==w){d=[];f=C;g=Q();g!==w?(44===b.charCodeAt(C)?(l=W,C++):(l=w,0===fa&&e(ia)),l!==w?(k=Q(),k!==w?(m=h(),m!==w?f=g=[g,l,k,m]:(C=f,f=w)):(C=f,f=w)):(C=f,f=w)):(C=f,f=w);for(;f!==w;)d.push(f),f=C,g=Q(),g!==w?(44===b.charCodeAt(C)?(l=W,C++):(l=w,0===fa&&e(ia)),l!==w?(k=Q(),k!==w?(m=h(),m!==w?f=g=[g,l,k,m]:(C=f,f=w)):(C=f,f=w)):(C=f,f=w)):(C=f,f=w);d!==w?a=c=0==d.length?c:d[d.length-1]:(C=a,a=w)}else C=
a,a=w;return a}function h(){var a,c,d,g;a=C;c=p();c!==w?(d=Q(),d!==w?(63===b.charCodeAt(C)?(d=ga,C++):(d=w,0===fa&&e(pa)),d!==w?(d=Q(),d!==w?(d=f(),d!==w?(g=Q(),g!==w?(58===b.charCodeAt(C)?(g=T,C++):(g=w,0===fa&&e(R)),g!==w?(g=Q(),g!==w?(g=f(),g!==w?a=c?d:g:(C=a,a=w)):(C=a,a=w)):(C=a,a=w)):(C=a,a=w)):(C=a,a=w)):(C=a,a=w)):(C=a,a=w)):(C=a,a=w)):(C=a,a=w);a===w&&(a=p());return a}function p(){var a,b,c,d,e,f,g,h;a=C;b=l();if(b!==w){c=[];d=C;e=Q();e!==w?(f=Z(),f!==w?(g=Q(),g!==w?(h=l(),h!==w?d=e=[e,f,
g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);for(;d!==w;)c.push(d),d=C,e=Q(),e!==w?(f=Z(),f!==w?(g=Q(),g!==w?(h=l(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);if(c!==w)for(a=b,b=0;b<c.length;b++)a=a||c[b][3];else C=a,a=w}else C=a,a=w;return a}function l(){var a,b,c,d,e,f,g,h;a=C;b=m();if(b!==w){c=[];d=C;e=Q();e!==w?(f=aa(),f!==w?(g=Q(),g!==w?(h=m(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);for(;d!==w;)c.push(d),d=C,e=Q(),e!==w?(f=aa(),f!==w?(g=Q(),g!==w?
(h=m(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);if(c!==w)for(a=b,b=0;b<c.length;b++)a=a&&c[b][3];else C=a,a=w}else C=a,a=w;return a}function m(){var a,b,c,d,e,f,g,h;a=C;b=r();if(b!==w){c=[];d=C;e=Q();e!==w?(f=X(),f!==w?(g=Q(),g!==w?(h=r(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);for(;d!==w;)c.push(d),d=C,e=Q(),e!==w?(f=X(),f!==w?(g=Q(),g!==w?(h=r(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);if(c!==w)for(a=b,b=0;b<c.length;b++)a|=c[b][3];
else C=a,a=w}else C=a,a=w;return a}function r(){var a,b,c,d,e,f,g,h;a=C;b=n();if(b!==w){c=[];d=C;e=Q();e!==w?(f=O(),f!==w?(g=Q(),g!==w?(h=n(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);for(;d!==w;)c.push(d),d=C,e=Q(),e!==w?(f=O(),f!==w?(g=Q(),g!==w?(h=n(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);if(c!==w)for(a=b,b=0;b<c.length;b++)a^=c[b][3];else C=a,a=w}else C=a,a=w;return a}function n(){var a,b,c,d,e,f,g,h;a=C;b=y();if(b!==w){c=[];d=C;e=Q();e!==w?(f=K(),
f!==w?(g=Q(),g!==w?(h=y(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);for(;d!==w;)c.push(d),d=C,e=Q(),e!==w?(f=K(),f!==w?(g=Q(),g!==w?(h=y(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);if(c!==w)for(a=b,b=0;b<c.length;b++)a&=c[b][3];else C=a,a=w}else C=a,a=w;return a}function y(){var a,b,c,d,e,f,g,h;a=C;b=v();if(b!==w){c=[];d=C;e=Q();e!==w?(f=H(),f!==w?(g=Q(),g!==w?(h=v(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);for(;d!==w;)c.push(d),d=C,
e=Q(),e!==w?(f=H(),f!==w?(g=Q(),g!==w?(h=v(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);if(c!==w)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "==":a=a==c[b][3];break;case "!=":a=a!=c[b][3]}else C=a,a=w}else C=a,a=w;return a}function v(){var a,b,c,d,e,f,g,h;a=C;b=E();if(b!==w){c=[];d=C;e=Q();e!==w?(f=N(),f!==w?(g=Q(),g!==w?(h=E(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);for(;d!==w;)c.push(d),d=C,e=Q(),e!==w?(f=N(),f!==w?(g=Q(),g!==w?(h=E(),h!==w?d=e=[e,
f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);if(c!==w)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "<=":a=a<=c[b][3];break;case ">=":a=a>=c[b][3];break;case "<":a=a<c[b][3];break;case ">":a=a>c[b][3]}else C=a,a=w}else C=a,a=w;return a}function E(){var a,b,c,d,e,f,g,h;a=C;b=x();if(b!==w){c=[];d=C;e=Q();e!==w?(f=z(),f!==w?(g=Q(),g!==w?(h=x(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);for(;d!==w;)c.push(d),d=C,e=Q(),e!==w?(f=z(),f!==w?(g=Q(),g!==w?(h=x(),h!==w?d=e=[e,f,g,
h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);if(c!==w)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "<<":a<<=c[b][3];break;case ">>":a>>=c[b][3]}else C=a,a=w}else C=a,a=w;return a}function x(){var a,b,c,d,e,f,g,h;a=C;b=u();if(b!==w){c=[];d=C;e=Q();e!==w?(f=P(),f!==w?(g=Q(),g!==w?(h=u(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);for(;d!==w;)c.push(d),d=C,e=Q(),e!==w?(f=P(),f!==w?(g=Q(),g!==w?(h=u(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);if(c!==w)for(a=
b,b=0;b<c.length;b++)switch(c[b][1]){case "+":a+=c[b][3];break;case "-":a-=c[b][3]}else C=a,a=w}else C=a,a=w;return a}function u(){var a,b,c,d,e,f,g,h;a=C;b=B();if(b!==w){c=[];d=C;e=Q();e!==w?(f=J(),f!==w?(g=Q(),g!==w?(h=B(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);for(;d!==w;)c.push(d),d=C,e=Q(),e!==w?(f=J(),f!==w?(g=Q(),g!==w?(h=B(),h!==w?d=e=[e,f,g,h]:(C=d,d=w)):(C=d,d=w)):(C=d,d=w)):(C=d,d=w);if(c!==w)for(a=b,b=0;b<c.length;b++)switch(c[b][1]){case "*":a*=c[b][3];break;case "/":a=
Math.floor(a/c[b][3]);break;case "%":a%=c[b][3]}else C=a,a=w}else C=a,a=w;return a}function B(){var a,c,f;a=C;b.substr(C,7)===V?(c=V,C+=7):(c=w,0===fa&&e(ja));c!==w?(f=Q(),f!==w?(f=G(),f!==w?a=f:(C=a,a=w)):(C=a,a=w)):(C=a,a=w);if(a===w){a=C;c=t();if(c!==w)if(f=Q(),f!==w)if(b.substr(C,2)===Gc?(f=Gc,C+=2):(f=w,0===fa&&e(Hc)),f===w&&(b.substr(C,2)===tb?(f=tb,C+=2):(f=w,0===fa&&e(nb))),f!==w){a:{a=c;switch(f){case "++":c=++a;break a;case "--":c=--a;break a}c=void 0}a=c}else C=a,a=w;else C=a,a=w;else C=
a,a=w;a===w&&(a=t());a===w&&(a=C,b.substr(C,2)===Gc?(c=Gc,C+=2):(c=w,0===fa&&e(Hc)),c===w&&(b.substr(C,2)===tb?(c=tb,C+=2):(c=w,0===fa&&e(nb)),c===w&&(43===b.charCodeAt(C)?(c=Ib,C++):(c=w,0===fa&&e(Ic)),c===w&&(45===b.charCodeAt(C)?(c=Ea,C++):(c=w,0===fa&&e(Fa)),c===w&&(126===b.charCodeAt(C)?(c=la,C++):(c=w,0===fa&&e(Oc)),c===w&&(33===b.charCodeAt(C)?(c=na,C++):(c=w,0===fa&&e($a))))))),c!==w?(f=Q(),f!==w?(f=B(),f!==w?a=c=d(c,f):(C=a,a=w)):(C=a,a=w)):(C=a,a=w))}return a}function t(){var a,c,d;fa++;
var g;a=C;48===b.charCodeAt(C)?(c=U,C++):(c=w,0===fa&&e(va));if(c!==w)if(sb.test(b.charAt(C))?(c=b.charAt(C),C++):(c=w,0===fa&&e(da)),c!==w){c=C;d=[];g=k();if(g!==w)for(;g!==w;)d.push(g),g=k();else d=w;c=d!==w?b.substring(c,C):d;c!==w?a=c=parseInt("0x"+c):(C=a,a=w)}else C=a,a=w;else C=a,a=w;if(a===w){a=C;48===b.charCodeAt(C)?(c=U,C++):(c=w,0===fa&&e(va));if(c===w)if(c=C,Y.test(b.charAt(C))?(d=b.charAt(C),C++):(d=w,0===fa&&e(ua)),d!==w){var h;g=[];h=A();if(h!==w)for(;h!==w;)g.push(h),h=A();else g=
w;g===w&&(g=null);g!==w?c=d=[d,g]:(C=c,c=w)}else C=c,c=w;a=c!==w?b.substring(a,C):c;a!==w&&(a=parseInt(a))}fa--;a===w&&0===fa&&e(D);a===w&&(c=I(),c!==w&&(c=0),a=c,a===w&&(a=C,40===b.charCodeAt(C)?(c=ra,C++):(c=w,0===fa&&e(sa)),c!==w?(c=Q(),c!==w?(c=f(),c!==w?(d=Q(),d!==w?(41===b.charCodeAt(C)?(d=S,C++):(d=w,0===fa&&e(ea)),d!==w?a=c:(C=a,a=w)):(C=a,a=w)):(C=a,a=w)):(C=a,a=w)):(C=a,a=w)));return a}function G(){var a,c,d,f,g;c=I();c!==w&&(c=0);a=c;if(a===w){c=[];f=d=C;fa++;40===b.charCodeAt(C)?(g=ra,
C++):(g=w,0===fa&&e(sa));g===w&&(41===b.charCodeAt(C)?(g=S,C++):(g=w,0===fa&&e(ea)));fa--;g===w?f=void 0:(C=f,f=w);f!==w?(g=ka(),g!==w?d=f=[f,g]:(C=d,d=w)):(C=d,d=w);if(d!==w)for(;d!==w;)c.push(d),f=d=C,fa++,40===b.charCodeAt(C)?(g=ra,C++):(g=w,0===fa&&e(sa)),g===w&&(41===b.charCodeAt(C)?(g=S,C++):(g=w,0===fa&&e(ea))),fa--,g===w?f=void 0:(C=f,f=w),f!==w?(g=ka(),g!==w?d=f=[f,g]:(C=d,d=w)):(C=d,d=w);else c=w;c!==w&&(c=1);a=c;a===w&&(a=C,40===b.charCodeAt(C)?(c=ra,C++):(c=w,0===fa&&e(sa)),c!==w?(d=Q(),
d!==w?(f=G(),f!==w?(g=Q(),g!==w?(41===b.charCodeAt(C)?(c=S,C++):(c=w,0===fa&&e(ea)),c!==w?a=f:(C=a,a=w)):(C=a,a=w)):(C=a,a=w)):(C=a,a=w)):(C=a,a=w))}return a}function A(){var a;M.test(b.charAt(C))?(a=b.charAt(C),C++):(a=w,0===fa&&e(Xb));return a}function k(){var a;Ya.test(b.charAt(C))?(a=b.charAt(C),C++):(a=w,0===fa&&e(La));return a}function I(){var a,c;fa++;c=a=C;fa++;var d,f,g,h;d=C;b.substr(C,7)===V?(f=V,C+=7):(f=w,0===fa&&e(ja));f!==w?(g=C,fa++,h=L(),fa--,h===w?g=void 0:(C=g,g=w),g!==w?d=f=[f,
g]:(C=d,d=w)):(C=d,d=w);fa--;d===w?c=void 0:(C=c,c=w);if(c!==w){fa++;c=C;d=F();if(d!==w){f=[];for(g=L();g!==w;)f.push(g),g=L();f!==w?c=d+=f.join(""):(C=c,c=w)}else C=c,c=w;fa--;c===w&&0===fa&&e(gc);c!==w?a=c:(C=a,a=w)}else C=a,a=w;fa--;a===w&&0===fa&&e(gc);return a}function F(){var a;hc.test(b.charAt(C))?(a=b.charAt(C),C++):(a=w,0===fa&&e(Ja));a===w&&(36===b.charCodeAt(C)?(a=Ha,C++):(a=w,0===fa&&e(sc)),a===w&&(95===b.charCodeAt(C)?(a=Gb,C++):(a=w,0===fa&&e(Za))));return a}function L(){var a;a=F();
a===w&&(a=A());return a}function J(){var a,c,d,f;a=C;42===b.charCodeAt(C)?(c=Ba,C++):(c=w,0===fa&&e(Ga));c===w&&(47===b.charCodeAt(C)?(c=pb,C++):(c=w,0===fa&&e(Ca)),c===w&&(37===b.charCodeAt(C)?(c=ob,C++):(c=w,0===fa&&e(Cb))));c!==w?(d=C,fa++,61===b.charCodeAt(C)?(f=tc,C++):(f=w,0===fa&&e(uc)),fa--,f===w?d=void 0:(C=d,d=w),d!==w?a=c:(C=a,a=w)):(C=a,a=w);return a}function P(){var a,c,d;a=C;43===b.charCodeAt(C)?(c=Ib,C++):(c=w,0===fa&&e(Ic));c!==w?(c=C,fa++,43===b.charCodeAt(C)?(d=Ib,C++):(d=w,0===
fa&&e(Ic)),d===w&&(61===b.charCodeAt(C)?(d=tc,C++):(d=w,0===fa&&e(uc))),fa--,d===w?c=void 0:(C=c,c=w),c!==w?a="+":(C=a,a=w)):(C=a,a=w);a===w&&(a=C,45===b.charCodeAt(C)?(c=Ea,C++):(c=w,0===fa&&e(Fa)),c!==w?(c=C,fa++,45===b.charCodeAt(C)?(d=Ea,C++):(d=w,0===fa&&e(Fa)),d===w&&(61===b.charCodeAt(C)?(d=tc,C++):(d=w,0===fa&&e(uc))),fa--,d===w?c=void 0:(C=c,c=w),c!==w?a="-":(C=a,a=w)):(C=a,a=w));return a}function z(){var a;b.substr(C,2)===vc?(a=vc,C+=2):(a=w,0===fa&&e(Lb));a===w&&(b.substr(C,2)===Kb?(a=
Kb,C+=2):(a=w,0===fa&&e(Jb)));return a}function N(){var a;b.substr(C,2)===Sa?(a=Sa,C+=2):(a=w,0===fa&&e(ab));a===w&&(b.substr(C,2)===vb?(a=vb,C+=2):(a=w,0===fa&&e(Ra)),a===w&&(60===b.charCodeAt(C)?(a=Da,C++):(a=w,0===fa&&e(gb)),a===w&&(62===b.charCodeAt(C)?(a=wb,C++):(a=w,0===fa&&e(Qa)))));return a}function H(){var a;b.substr(C,2)===ub?(a=ub,C+=2):(a=w,0===fa&&e(ya));a===w&&(b.substr(C,2)===wa?(a=wa,C+=2):(a=w,0===fa&&e(xb)));return a}function K(){var a,c,d;a=C;38===b.charCodeAt(C)?(c=qb,C++):(c=
w,0===fa&&e(xa));c!==w?(c=C,fa++,38===b.charCodeAt(C)?(d=qb,C++):(d=w,0===fa&&e(xa)),fa--,d===w?c=void 0:(C=c,c=w),c!==w?a="&":(C=a,a=w)):(C=a,a=w);return a}function O(){var a,c,d;a=C;94===b.charCodeAt(C)?(c=ic,C++):(c=w,0===fa&&e(ca));c!==w?(c=C,fa++,94===b.charCodeAt(C)?(d=ic,C++):(d=w,0===fa&&e(ca)),fa--,d===w?c=void 0:(C=c,c=w),c!==w?a="^":(C=a,a=w)):(C=a,a=w);return a}function X(){var a,c,d;a=C;124===b.charCodeAt(C)?(c=yb,C++):(c=w,0===fa&&e(Na));c!==w?(c=C,fa++,124===b.charCodeAt(C)?(d=yb,C++):
(d=w,0===fa&&e(Na)),fa--,d===w?c=void 0:(C=c,c=w),c!==w?a="|":(C=a,a=w)):(C=a,a=w);return a}function aa(){var a;b.substr(C,2)===za?(a=za,C+=2):(a=w,0===fa&&e(Aa));a!==w&&(a="&&");return a}function Z(){var a;b.substr(C,2)===jb?(a=jb,C+=2):(a=w,0===fa&&e(Kc));a!==w&&(a="||");return a}function Q(){var a,b;a=[];for(b=ha();b!==w;)a.push(b),b=ha();return a}function ha(){var a;fa++;Rb.test(b.charAt(C))?(a=b.charAt(C),C++):(a=w,0===fa&&e(hb));fa--;a===w&&0===fa&&e(Wa);return a}function ka(){var a;b.length>
C?(a=b.charAt(C),C++):(a=w,0===fa&&e(xc));return a}var qa=1<arguments.length?arguments[1]:{},w={},ba={start:g},ma=g,W=",",ia={type:"literal",value:",",description:'","'},ga="?",pa={type:"literal",value:"?",description:'"?"'},T=":",R={type:"literal",value:":",description:'":"'},V="defined",ja={type:"literal",value:"defined",description:'"defined"'},ra="(",sa={type:"literal",value:"(",description:'"("'},S=")",ea={type:"literal",value:")",description:'")"'},D={type:"other",description:"number"},U="0",
va={type:"literal",value:"0",description:'"0"'},M=/^[0-9]/,Xb={type:"class",value:"[0-9]",description:"[0-9]"},Y=/^[1-9]/,ua={type:"class",value:"[1-9]",description:"[1-9]"},sb=/^[xX]/,da={type:"class",value:"[xX]",description:"[xX]"},Ya=/^[0-9a-fA-F]/,La={type:"class",value:"[0-9a-fA-F]",description:"[0-9a-fA-F]"},gc={type:"other",description:"identifier"},Ha="$",sc={type:"literal",value:"$",description:'"$"'},Gb="_",Za={type:"literal",value:"_",description:'"_"'},hc=/^[a-zA-Z]/,Ja={type:"class",
value:"[a-zA-Z]",description:"[a-zA-Z]"},Gc="++",Hc={type:"literal",value:"++",description:'"++"'},tb="--",nb={type:"literal",value:"--",description:'"--"'},Ib="+",Ic={type:"literal",value:"+",description:'"+"'},Ea="-",Fa={type:"literal",value:"-",description:'"-"'},la="~",Oc={type:"literal",value:"~",description:'"~"'},na="!",$a={type:"literal",value:"!",description:'"!"'},Ba="*",Ga={type:"literal",value:"*",description:'"*"'},pb="/",Ca={type:"literal",value:"/",description:'"/"'},ob="%",Cb={type:"literal",
value:"%",description:'"%"'},tc="=",uc={type:"literal",value:"=",description:'"="'},vc="<<",Lb={type:"literal",value:"<<",description:'"<<"'},Kb=">>",Jb={type:"literal",value:">>",description:'">>"'},Sa="<=",ab={type:"literal",value:"<=",description:'"<="'},vb=">=",Ra={type:"literal",value:">=",description:'">="'},Da="<",gb={type:"literal",value:"<",description:'"<"'},wb=">",Qa={type:"literal",value:">",description:'">"'},ub="==",ya={type:"literal",value:"==",description:'"=="'},wa="!=",xb={type:"literal",
value:"!=",description:'"!="'},qb="&",xa={type:"literal",value:"&",description:'"&"'},ic="^",ca={type:"literal",value:"^",description:'"^"'},yb="|",Na={type:"literal",value:"|",description:'"|"'},za="&&",Aa={type:"literal",value:"&&",description:'"&&"'},jb="||",Kc={type:"literal",value:"||",description:'"||"'},Wa={type:"other",description:"whitespace"},Rb=/^[\t\x0B\f ]/,hb={type:"class",value:"[\\t\\v\\f ]",description:"[\\t\\v\\f ]"},Mb={type:"other",description:"end of line"},jc="\n",Yb={type:"literal",
value:"\n",description:'"\\n"'},wc="\r\n",bb={type:"literal",value:"\r\n",description:'"\\r\\n"'},Zb="\r",Pc={type:"literal",value:"\r",description:'"\\r"'},xc={type:"any",description:"any character"},C=0,Nb=0,Ia={zi:1,Lg:1,Ui:!1},Ta=0,zb=[],fa=0,kc;if("startRule"in qa){if(!(qa.Ms in ba))throw Error("Can't start parsing from rule \""+qa.Ms+'".');ma=ba[qa.Ms]}kc=ma();if(kc!==w&&C===b.length)return kc;kc!==w&&C<b.length&&e({type:"end",description:"end of input"});throw function(d,e,f){function g(a){var b=
1;for(a.sort(function(a,b){return a.description<b.description?-1:a.description>b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function h(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+
b(a)}).replace(/[\u0100-\u0FFF]/g,function(a){return"\\u0"+b(a)}).replace(/[\u1000-\uFFFF]/g,function(a){return"\\u"+b(a)})}var d=Array(a.length),e;for(e=0;e<a.length;e++)d[e]=a[e].description;d=1<a.length?d.slice(0,-1).join(", ")+" or "+d[a.length-1]:d[0];e=b?'"'+c(b)+'"':"end of input";return"Expected "+d+" but "+e+" found."}var l=c(f),k=f<b.length?b.charAt(f):null;null!==e&&g(e);return new a(null!==d?d:h(e,k),0,0,f,l.zi,l.Lg)}(null,zb,Ta);}}}()};b4w.module.__md5=function(a){function q(a,g){var p=a[0],l=a[1],m=a[2],r=a[3],p=d(p,l,m,r,g[0],7,-680876936),r=d(r,p,l,m,g[1],12,-389564586),m=d(m,r,p,l,g[2],17,606105819),l=d(l,m,r,p,g[3],22,-1044525330),p=d(p,l,m,r,g[4],7,-176418897),r=d(r,p,l,m,g[5],12,1200080426),m=d(m,r,p,l,g[6],17,-1473231341),l=d(l,m,r,p,g[7],22,-45705983),p=d(p,l,m,r,g[8],7,1770035416),r=d(r,p,l,m,g[9],12,-1958414417),m=d(m,r,p,l,g[10],17,-42063),l=d(l,m,r,p,g[11],22,-1990404162),p=d(p,l,m,r,g[12],7,1804603682),r=d(r,p,l,m,
g[13],12,-40341101),m=d(m,r,p,l,g[14],17,-1502002290),l=d(l,m,r,p,g[15],22,1236535329),p=c(p,l,m,r,g[1],5,-165796510),r=c(r,p,l,m,g[6],9,-1069501632),m=c(m,r,p,l,g[11],14,643717713),l=c(l,m,r,p,g[0],20,-373897302),p=c(p,l,m,r,g[5],5,-701558691),r=c(r,p,l,m,g[10],9,38016083),m=c(m,r,p,l,g[15],14,-660478335),l=c(l,m,r,p,g[4],20,-405537848),p=c(p,l,m,r,g[9],5,568446438),r=c(r,p,l,m,g[14],9,-1019803690),m=c(m,r,p,l,g[3],14,-187363961),l=c(l,m,r,p,g[8],20,1163531501),p=c(p,l,m,r,g[13],5,-1444681467),r=
c(r,p,l,m,g[2],9,-51403784),m=c(m,r,p,l,g[7],14,1735328473),l=c(l,m,r,p,g[12],20,-1926607734),p=b(l^m^r,p,l,g[5],4,-378558),r=b(p^l^m,r,p,g[8],11,-2022574463),m=b(r^p^l,m,r,g[11],16,1839030562),l=b(m^r^p,l,m,g[14],23,-35309556),p=b(l^m^r,p,l,g[1],4,-1530992060),r=b(p^l^m,r,p,g[4],11,1272893353),m=b(r^p^l,m,r,g[7],16,-155497632),l=b(m^r^p,l,m,g[10],23,-1094730640),p=b(l^m^r,p,l,g[13],4,681279174),r=b(p^l^m,r,p,g[0],11,-358537222),m=b(r^p^l,m,r,g[3],16,-722521979),l=b(m^r^p,l,m,g[6],23,76029189),p=
b(l^m^r,p,l,g[9],4,-640364487),r=b(p^l^m,r,p,g[12],11,-421815835),m=b(r^p^l,m,r,g[15],16,530742520),l=b(m^r^p,l,m,g[2],23,-995338651),p=e(p,l,m,r,g[0],6,-198630844),r=e(r,p,l,m,g[7],10,1126891415),m=e(m,r,p,l,g[14],15,-1416354905),l=e(l,m,r,p,g[5],21,-57434055),p=e(p,l,m,r,g[12],6,1700485571),r=e(r,p,l,m,g[3],10,-1894986606),m=e(m,r,p,l,g[10],15,-1051523),l=e(l,m,r,p,g[1],21,-2054922799),p=e(p,l,m,r,g[8],6,1873313359),r=e(r,p,l,m,g[15],10,-30611744),m=e(m,r,p,l,g[6],15,-1560198380),l=e(l,m,r,p,g[13],
21,1309151649),p=e(p,l,m,r,g[4],6,-145523070),r=e(r,p,l,m,g[11],10,-1120210379),m=e(m,r,p,l,g[2],15,718787259),l=e(l,m,r,p,g[9],21,-343485551);a[0]=p+a[0]&4294967295;a[1]=l+a[1]&4294967295;a[2]=m+a[2]&4294967295;a[3]=r+a[3]&4294967295}function b(a,b,c,d,e,g){b=(b+a&4294967295)+(d+g&4294967295)&4294967295;return(b<<e|b>>>32-e)+c&4294967295}function d(a,c,d,e,g,r,n){return b(c&d|~c&e,a,c,g,r,n)}function c(a,c,d,e,g,r,n){return b(c&e|d&~e,a,c,g,r,n)}function e(a,c,d,e,g,r,n){return b(d^(c|~e),a,c,g,
r,n)}var g="0123456789abcdef".split("");a.Nq=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var d;for(d=64;d<=b.length;d+=64){for(var e=b.substring(d-64,d),r=[],n=void 0,n=0;64>n;n+=4)r[n>>2]=e.charCodeAt(n)+(e.charCodeAt(n+1)<<8)+(e.charCodeAt(n+2)<<16)+(e.charCodeAt(n+3)<<24);q(a,r)}b=b.substring(d-64);e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(d=0;d<b.length;d++)e[d>>2]|=b.charCodeAt(d)<<(d%4<<3);e[d>>2]|=128<<(d%4<<3);if(55<d)for(q(a,e),d=0;16>d;d++)e[d]=0;e[14]=8*
c;q(a,e);for(b=0;b<a.length;b++){c=a[b];d="";for(e=0;4>e;e++)d+=g[c>>8*e+4&15]+g[c>>8*e&15];a[b]=d}return a.join("")}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"void main ( ) { gl_FragColor = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={type:"group",a:[{type:"var",name:"ANCHOR_NUM",b:["0"]},{type:"textline",b:"attribute float a_index ; uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; void main ( ) { vec4 a = u_view_matrix * vec4 ( u_position [ int ( a_index ) ] , 1.0 ) ; gl_Position = u_proj_matrix * a ; gl_PointSize = 4.0 ; }".split(" ")}]};
a["color_id.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform vec3 u_color_id ; uniform vec4 u_diffuse_color ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_OUTLINE"],group:{type:"group",
a:[{type:"textline",b:["uniform","float","u_outline_intensity",";"]}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"float b = ( texture2D ( u_sampler , a ) ) . a ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"float b = u_diffuse_color . a ;".split(" ")}]}}]},{type:"textline",b:"if ( b < 0.5 ) discard ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_OUTLINE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["color_id.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},
{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",
a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; attribute vec3 a_normal ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",
a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"textline",
b:"void main ( ) { vec3 cD = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"cD = mix ( cD , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"vec3 cE = vec3 ( 0.0 ) ; vec3 cF = vec3 ( 0.0 ) ; vec3 cG = vec3 ( 0.0 ) ; bK ( cD , cE , cF , cG ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","||","BILLBOARD"],group:{type:"group",
a:[{type:"textline",b:["vec3","cH","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 cH = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"vec3 cI = ( u_model_matrix * vec4 ( cH , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","&&","!","STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"mat4 cJ = at ( u_camera_eye , cI , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 cJ = an ( u_camera_eye , cI , u_view_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","&&","BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"vec3 cK = ( u_model_matrix * vec4 ( cH , 1.0 ) ) . xyz ; cJ = cJ * ac ( u_wind , u_time , u_jitter_amp , u_jitter_freq , cK ) ;".split(" ")}]}}]},{type:"textline",b:"d cL = aA ( cD - cH , cH , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , cJ ) ; cL . b = cI ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"d cL = aA ( cD , cH , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL","&&","DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:["vec3","cM","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 cM = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:"cC ( cL . a , cL . b , cM ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"a = aD ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"textline",b:"gl_Position = u_proj_matrix * u_view_matrix * vec4 ( cL . a , 1.0 ) ; }".split(" ")}]};a["depth.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"textline",b:["uniform","vec4","u_diffuse_color",";"]},{type:"condition",
a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",
c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"textline",b:"varying vec4 cD ; varying vec4 cE ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",
a:[{type:"textline",b:["varying","vec4","cF",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cG",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cH",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","cI",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["!","SHADELESS"],group:{type:"group",a:[{type:"include",file:"procedural.glslf"},{type:"include",file:"shadow.glslf"}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"float fq = ( texture2D ( u_sampler , a ) ) . a ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"float fq = u_diffuse_color . a ;".split(" ")}]}}]},
{type:"textline",b:"if ( fq < 0.5 ) discard ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"SHADOW_USAGE == NO_SHADOWS || SHADOW_USAGE == SHADOW_CASTING".split(" "),group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}},{type:"elif",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( fk ( cD . z ) , 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["depth.glslv"]={type:"group",
a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:"WIND_BEND && MAIN_BEND_COL && DETAIL_BEND || SHADOW_USAGE == SHADOW_MASK_GENERATION".split(" "),
group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","||","DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],
group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",
a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",
b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",
b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD","&&","SHADOW_USAGE","==","SHADOW_CASTING"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_shadow_cast_billboard_view_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],
group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",
b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],
group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"textline",b:"varying vec4 cD ; varying vec4 cE ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cF",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cG",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cH",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",
b:["varying","vec3","cI",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"textline",b:"void main ( ) { vec3 gt = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"gt = mix ( gt , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",
b:"vec3 gu = vec3 ( 0.0 ) ; vec3 gv = vec3 ( 0.0 ) ; vec3 gw = vec3 ( 0.0 ) ; bK ( gt , gu , gv , gw ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"textline",b:["vec3","gx","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 gx = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","||","DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",
b:["vec3","gy","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 gy = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"d gz = ge ( gt , vec3 ( 0.0 ) , vec3 ( 0.0 ) , gx , gy , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"vec3 gA = ( u_model_matrix * vec4 ( gy , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:"! HAIR_BILLBOARD && SHADOW_USAGE == SHADOW_CASTING".split(" "),group:{type:"group",a:[{type:"textline",b:["mat4","gB","=","u_shadow_cast_billboard_view_matrix",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["mat4","gB","=","u_view_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION",
"&&","!","STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"mat4 gC = at ( u_camera_eye , gA , gB , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 gC = an ( u_camera_eye , gA , gB ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","&&","BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"vec3 gD = ( u_model_matrix * vec4 ( gy , 1.0 ) ) . xyz ; gC = gC * ac ( u_wind , u_time , u_jitter_amp , u_jitter_freq , gD ) ;".split(" ")}]}}]},
{type:"textline",b:"d gz = aA ( gt - gy , gy , vec3 ( 0.0 ) , vec3 ( 0.0 ) , gx , gC ) ; gz . b = gA ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"d gz = aA ( gt , gy , vec3 ( 0.0 ) , vec3 ( 0.0 ) , gx , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL","&&","DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:["vec3","gE","=","a_normal",";"]}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:"vec3 gE = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:"cC ( gz . a , gz . b , gE ) ;".split(" ")}]}}]},{type:"textline",b:"vec4 gF = u_view_matrix * vec4 ( gz . a , 1.0 ) ; vec4 gG = u_proj_matrix * gF ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:"gG . xy += u_subpixel_jitter * gG . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",
b:"a = aD ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MASK_GENERATION"],group:{type:"group",a:[{type:"textline",b:"go ( gz . a , gz . e ) ; cD = gF ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_CASTING"],group:{type:"group",a:[{type:"textline",b:"vec2 gH = ( u_proj_matrix * u_view_matrix [ 3 ] ) . xy ; float gI = SHADOW_TEX_RES / 2.0 ; gH = floor ( gH * gI + 0.5 ) / gI - gH ; gG . xy += gH ;".split(" ")}]}}]},
{type:"textline",b:["gl_Position","=","gG",";","}"]}]};a["grass_map.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","gt",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["varying","float","gt",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",
a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","gt",";"]}]}}]}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["gl_FragColor","=","gt",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( gt , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , gt ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["}"]}]};a["grass_map.glslv"]={type:"group",a:[{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",
a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_grass_size",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_grass_color",";"]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4",
"u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","&&","BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","gt",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["varying","float","gt",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","gt",";"]}]}}]}]}}]},{type:"textline",b:["void","main","(",")",
"{"]},{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"vec3 gu = ( u_model_matrix * vec4 ( vec3 ( 0.0 ) , 1.0 ) ) . xyz ; mat4 gv = an ( u_camera_eye , gu , u_view_matrix ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WIND_BEND","&&","BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"gv = gv * ac ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"textline",b:"d gw = aA ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , gv ) ; gw . b = gu ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"d gw = aA ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]},{type:"textline",b:"vec4 gx = u_proj_matrix * u_view_matrix * vec4 ( gw . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_SIZE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:"gt = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["gt","=","a_grass_size",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS_COLOR"],group:{type:"group",a:[{type:"textline",b:["gt","=","a_grass_color",";"]}]}}]}]}}]},{type:"textline",b:["gl_Position","=","gx",";","}"]}]};a["halo.glslf"]={type:"group",a:[{type:"var",name:"NUM_LINES",b:["0"]},{type:"var",name:"NUM_RINGS",b:["0"]},{type:"var",name:"NUM_STARS",b:["0"]},{type:"var",name:"WAVES_HEIGHT",
b:["0.0"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","!","DISABLE_FOG"],group:{type:"group",
a:[{type:"textline",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ; varying vec4 gB ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 a ; varying float gC ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS",">","NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"const int gD = NUM_RINGS ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const int gD = NUM_LINES ;".split(" ")}]}}]},{type:"textline",
b:"float gF ( float gE ) { return gE - floor ( gE * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"void gO ( inout float gG , in float gH [ gD ] , in float gI ) { for ( int gJ = 0 ; gJ < NUM_RINGS ; gJ ++ ) { float gK = 40.0 * gH [ gJ ] ; float gL = 300.0 * ( gF ( gK ) - 0.005 ) ; float gM = gK ; float gN = abs ( gM * ( u_halo_size * gL - gI ) ) ; gG += 1.0 - min ( gN , 1.0 ) ; } }".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"void gX ( inout float gP , in float gQ [ gD ] , in float gR ) { for ( int gS = 0 ; gS < NUM_LINES ; gS ++ ) { float gT = gQ [ gS ] ; float gU = gT ; float gV = 1000.0 * ( gF ( gT ) - 0.005 ) ; float gW = 20.0 * abs ( gU * a . x + gV * a . y ) ; gP += 1.0 - min ( gW , 1.0 ) ; } gP *= gR ; }".split(" ")}]}}]},{type:"textline",b:"void hd ( inout float gY , in vec2 gZ ) { float g_ , ha ; ha = atan ( gZ . y , gZ . x ) ; ha *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float hb = cos ( ha ) ; float hc = sin ( ha ) ; ha = ( hb * gZ . x + hc * gZ . y ) * ( hb * gZ . y - hc * gZ . x ) ; g_ = abs ( ha ) ; if ( g_ < 1.0 ) { g_ = ( 0.01 * u_halo_size ) / ( g_ ) ; gY *= sqrt ( min ( g_ , 1.0 ) ) ; } } void main ( ) { float he = ( a . x * a . x + a . y * a . y ) ; float hf = sqrt ( he ) ; he = max ( 1.0 - he , 0.0 ) ; he = pow ( he , u_halo_hardness ) ; float hg = u_diffuse_color . a ;".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_RINGS","||","NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"float hh [ gD ] ; for ( int hi = 0 ; hi < gD ; hi ++ ) { hh [ hi ] = fract ( gC / ( float ( hi ) + 0.01 ) ) - 1.0 ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"float hj = 0.0 ; gO ( hj , hh , hf ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"float hk = 0.0 ; gX ( hk , hh , he ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NUM_STARS"],group:{type:"group",a:[{type:"textline",b:"hd ( he , a ) ;".split(" ")}]}}]},{type:"textline",b:"he *= hg ; vec3 hl = u_diffuse_color . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_RINGS"],group:{type:"group",a:[{type:"textline",b:"hj *= he ; hl += u_halo_rings_color * hj ; he += hj ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_LINES"],group:{type:"group",a:[{type:"textline",b:"hk *= hg ; hl += u_halo_lines_color * hk ; he += hk ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"he *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:"float hm = u_halo_stars_blend * ( gB . y - u_halo_stars_height ) ; he *= clamp ( hm , 0.0 , 1.0 ) ; he *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"gx ( hl ) ; gA ( hl , he ) ; gl_FragColor = vec4 ( hl , he ) ; }".split(" ")}]};
a["halo.glslv"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:"attribute vec3 a_position ; attribute vec2 a_halo_bb_vertex ; uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ; uniform PRECISION float u_halo_size ; varying vec2 a ; varying float gC ;".split(" ")},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","gB",";"]}]}}]},{type:"textline",b:"void main ( ) { vec3 gD = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; a = a_halo_bb_vertex * 2.0 ; gC = fract ( gD . x + gD . y + gD . z ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",
a:[{type:"textline",b:"mat4 gE = N ( gD , u_view_matrix ) ; mat4 gF = u_view_matrix ; gF [ 3 ] [ 0 ] = 0.0 ; gF [ 3 ] [ 1 ] = 0.0 ; gF [ 3 ] [ 2 ] = 0.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 gE = N ( gD , u_view_matrix ) ;".split(" ")}]}}]},{type:"textline",b:"vec4 gG = vec4 ( a_halo_bb_vertex * 2.0 * u_halo_size , 0.0 , 1.0 ) ; vec4 gH = gE * gG ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKY_STARS"],group:{type:"group",a:[{type:"textline",b:"vec4 gI = u_proj_matrix * gF * gH ; gI . z = 0.99999 * gI . w ;".split(" ")},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["gB","=","gH",";"]}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec4 gI = u_proj_matrix * u_view_matrix * gH ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","gI",";","}"]}]};a["line.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; void main ( ) { gl_FragColor = u_diffuse_color ; }".split(" ")}]};
a["line.glslv"]={type:"group",a:[{type:"var",name:"NUM_POINTS",b:["0"]},{type:"textline",b:"attribute float a_point ; uniform vec3 u_line_points [ NUM_POINTS ] ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; void main ( ) { vec3 gD = u_line_points [ int ( a_point ) ] ; gl_Position = u_proj_matrix * u_view_matrix * vec4 ( gD , 1.0 ) ; }".split(" ")}]};a["main.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"NUM_LAMP_LIGHTS",
b:["0"]},{type:"var",name:"NUM_VALUES",b:["0"]},{type:"var",name:"NUM_RGBS",b:["0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"PARALLAX_STEPS",b:["0.0"]},{type:"var",name:"PARALLAX_LOD_DIST",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"fog.glslf"},{type:"condition",a:[{type:"if",c:["!",
"SHADELESS"],group:{type:"group",a:[{type:"include",file:"lighting.glslf"},{type:"include",file:"procedural.glslf"},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"include",file:"caustics.glslf"}]}}]}]}}]},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"},{type:"textline",b:["uniform","float","u_time",";"]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","&&","SKY_TEXTURE"],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube",
"u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","&&","SKY_COLOR"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["!","SHADELESS"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","CAUSTICS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_sun_quaternion",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye_frag",";"]}]}}]},{type:"condition",a:[{type:"if",c:"NORMAL_TEXCOORD || REFLECTION_TYPE == REFL_PLANE || USE_NODE_B4W_VECTOR_VIEW".split(" "),group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_view_matrix_frag",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","||","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_intensity",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","CAUSTICS"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_sun_direction",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG","&&","PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["TEXTURE_SPEC","&&","!","ALPHA_AS_SPEC"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",a:[{type:"textline",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE",
"==","REFL_PLANE"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_CUBE"],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",
a:[{type:"textline",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{type:"elif",c:["SHADOW_USAGE","==","SHADOW_MAPPING_BLEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_perspective_cast_far_bound",";"]}]}}]},{type:"textline",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],
group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","||","USE_NODE_B4W_REFRACTION"],group:{type:"group",
a:[{type:"textline",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",c:"( ! NODES || USE_NODE_B4W_REFRACTION && USE_REFRACTION && NODES ) && REFRACTIVE && USE_REFRACTION_CORRECTION".split(" "),group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{type:"textline",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{type:"condition",a:[{type:"if",
c:"REFLECTION_TYPE == REFL_PLANE || REFLECTION_TYPE == REFL_CUBE".split(" "),group:{type:"group",a:[{type:"textline",b:["uniform","float","u_reflect_factor",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_PLANE"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["NODES"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_LAMP"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_VALUE"],group:{type:"group",a:[{type:"textline",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_RGB"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_normal_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],
group:{type:"group",a:[{type:"textline",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{type:"textline",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","&&","PARALLAX"],group:{type:"group",a:[{type:"textline",b:["uniform",
"float","u_parallax_scale",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_refr_bump",";"]}]}}]}]}}]},{type:"textline",b:["varying","vec3","lA",";"]},{type:"condition",a:[{type:"if",c:"! NODES || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE || USE_NODE_TEX_COORD_NO".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec3","lB",";"]}]}}]},{type:"condition",a:[{type:"if",
c:"NODES || ! DISABLE_FOG || ( TEXTURE_NORM_CO && PARALLAX ) || ( WATER_EFFECTS && CAUSTICS )".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec4","cD",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","||","CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","lC",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","NODES"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","lD",";"]},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",
a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","||","DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","lE",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_BLEND"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cE",";"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cF",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cG",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cH",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || SHADOW_USAGE == SHADOW_MAPPING_OPAQUE || REFRACTIVE || USE_NODE_B4W_REFRACTION".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec3","cI",";"]}]}}]},{type:"condition",a:[{type:"if",
c:"REFRACTIVE && ( ! NODES || USE_NODE_B4W_REFRACTION )".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","float","lF",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","SHADELESS"],group:{type:"group",a:[{type:"include",file:"shadow.glslf"}]}}]},{type:"include",file:"mirror.glslf"},{type:"condition",a:[{type:"if",c:"REFRACTIVE && ! NODES || USE_NODE_B4W_REFRACTION && USE_REFRACTION && NODES".split(" "),group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"include",
file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"include",file:"nodes.glslf"}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:"NODES || ! DISABLE_FOG || ( TEXTURE_NORM_CO && PARALLAX ) || ( WATER_EFFECTS && CAUSTICS )".split(" "),group:{type:"group",a:[{type:"textline",b:"float yM = length ( cD ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"float yN = lA . y - WATER_LEVEL ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:"WATER_EFFECTS || ! DISABLE_FOG || ( CAUSTICS && WATER_EFFECTS )".split(" "),group:{type:"group",a:[{type:"textline",b:["vec3","yO","=","u_sun_intensity",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:"vec3 yP = normalize ( u_camera_eye_frag - lA ) ; vec3 yQ ; vec3 yR ; vec3 yS ; float yT ; float yU ; yL ( yP , yQ , yR , yS , yT , yU ) ; vec3 yV = yQ ; float yW = yU ; vec3 yX = yS ; float yY = yT ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["vec2","yZ","=","a",";"]}]}}]},{type:"textline",b:["vec3","y_","=","lB",";"]},{type:"condition",a:[{type:"if",c:["DOUBLE_SIDED_LIGHTING"],group:{type:"group",a:[{type:"textline",b:"if ( gl_FrontFacing ) y_ = y_ ; else y_ = - y_ ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"vec3 za = cross ( y_ , lC . xyz ) * lC . w ; mat3 zb = mat3 ( lC . xyz , za , y_ ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"vec2 zc = normalize ( u_view_matrix_frag * vec4 ( lB , 0.0 ) ) . st ; zc = zc * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","&&","PARALLAX"],group:{type:"group",a:[{type:"textline",b:"if ( yM < PARALLAX_LOD_DIST ) { float zd = clamp ( 0.5 * ( PARALLAX_LOD_DIST - yM ) , 0.0 , 1.0 ) ; float ze = u_parallax_scale * zd ; vec3 zf = normalize ( lD * zb ) ; float zg = 1.0 / PARALLAX_STEPS ; vec2 zh = zf . xy * ze / ( PARALLAX_STEPS * zf . z ) ; float zi = 1.0 ; float zj ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",a:[{type:"textline",b:["vec2","zk","=","zc",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vec2","zk","=","yZ",";"]}]}}]},{type:"textline",b:"zj = texture2D ( u_normalmap0 , zk ) . a ; for ( float zl = 1.0 ; zl <= PARALLAX_STEPS ; zl ++ ) { if ( zj < zi ) { zi -= zg ; zk -= zh ; zj = texture2D ( u_normalmap0 , zk ) . a ; } } vec2 zm = zk + zh ; float zn = texture2D ( u_normalmap0 , zm ) . a - ( zi + zg ) ; float zo = zj - zi ; float zp = zo / ( zo - zn ) ; zk = zp * zm + ( 1.0 - zp ) * zk ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"yZ += zk - zc ;".split(" ")}]}}]},{type:"textline",b:["zc","=","zk",";"]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"zc += zk - yZ ;".split(" ")}]}}]},{type:"textline",b:["yZ","=","zk",";"]}]}}]},{type:"textline",
b:["}"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:["vec4","zq",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",a:[{type:"textline",b:"zq = texture2D ( u_normalmap0 , zc ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zq = texture2D ( u_normalmap0 , yZ ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 zr = zq . rgb - 0.5 ; zr = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , zr , u_normal_factor ) ; vec3 yX = zb * zr ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:["vec3","yX","=","y_",";"]}]}}]},{type:"textline",b:"yX = normalize ( yX ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NORMAL_TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"zc = normalize ( u_view_matrix_frag * vec4 ( yX , 0.0 ) ) . st ; zc = zc * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 yP = normalize ( lD ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","||","DYNAMIC_GRASS"],
group:{type:"group",a:[{type:"textline",b:"vec3 zs = lE ; gv ( zs ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","||","DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"vec4 zt = vec4 ( zs , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vec4","zt","=","u_diffuse_color",";"]}]}}]},{type:"textline",b:["float","zu","=","1.0",";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",
a:[{type:"textline",b:"vec4 zv = texture2D ( u_colormap0 , zc ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_COLOR0_CO","==","TEXTURE_COORDS_UV_ORCO"],group:{type:"group",a:[{type:"textline",b:"vec4 zv = texture2D ( u_colormap0 , yZ ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR0_CO"],group:{type:"group",a:[{type:"textline",b:"gv ( zv . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK"],group:{type:"group",a:[{type:"textline",b:["vec4","zw",
";"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR1_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",a:[{type:"textline",b:"zw = texture2D ( u_colormap1 , zc ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zw = texture2D ( u_colormap1 , yZ ) ;".split(" ")}]}}]},{type:"textline",b:"gv ( zw . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_STENCIL_ALPHA_MASK_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",a:[{type:"textline",b:"vec4 zx = texture2D ( u_stencil0 , zc ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"vec4 zx = texture2D ( u_stencil0 , yZ ) ;".split(" ")}]}}]},{type:"textline",b:"zv = mix ( zv , zw , zx . r ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_BLEND_TYPE","==","TEXTURE_BLEND_TYPE_MIX"],group:{type:"group",a:[{type:"textline",b:"zt . rgb = mix ( zt . rgb , zv . rgb , u_diffuse_color_factor ) ; float zy = u_alpha_factor * zv . a ; zy += ( 1.0 - step ( 0.0 , zy ) ) ; zt . a = mix ( zy , 1.0 , u_diffuse_color . a ) ; zu = zv . a ;".split(" ")}]}},
{type:"elif",c:["TEXTURE_BLEND_TYPE","==","TEXTURE_BLEND_TYPE_MULTIPLY"],group:{type:"group",a:[{type:"textline",b:"zt . rgb *= mix ( vec3 ( 1.0 ) , zv . rgb , u_diffuse_color_factor ) ; zt . a = zv . a ; zu = zv . a ;".split(" ")}]}}]}]}}]},{type:"textline",b:"vec3 zz = u_diffuse_intensity * zt . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHADELESS"],group:{type:"group",a:[{type:"textline",b:["vec3","yV","=","zz",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 zA = u_environment_energy * mr ( yX ) ; vec3 zB = u_ambient * zA ; float yY = fp ( zz ) ; vec3 zC = u_emit * zt . rgb ; vec3 zD = u_specular_color ;".split(" ")},
{type:"condition",a:[{type:"if",c:["TEXTURE_SPEC"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["ALPHA_AS_SPEC"],group:{type:"group",a:[{type:"textline",b:"vec3 zE = vec3 ( zu ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_SPEC_CO","==","TEXTURE_COORDS_NORMAL"],group:{type:"group",a:[{type:"textline",b:"vec3 zE = texture2D ( u_specmap0 , zc ) . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 zE = texture2D ( u_specmap0 , yZ ) . rgb ;".split(" ")}]}}]},
{type:"textline",b:"gv ( zE . rgb ) ; zD = mix ( zD , zE , u_specular_color_factor ) ;".split(" ")}]}}]},{type:"textline",b:"float zF = u_specular_params [ 0 ] ; vec2 zG = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 zH = zF * zD ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS","==","0"],group:{type:"group",a:[{type:"textline",b:"hO zI = kZ ( zC , zB , zz ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"hO zI = kU ( zC , zB , zz , zH , lA , yX , yP , zG , u_diffuse_params , yY , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , 0.0 , vec4 ( 0.0 ) ) ;".split(" ")}]}}]},
{type:"textline",b:"vec3 yV = zI . a . rgb ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || REFLECTION_TYPE == REFL_CUBE".split(" "),group:{type:"group",a:[{type:"textline",b:"ma ( yV , yP , yX , u_reflect_factor ) ;".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:"ma ( yV , yP , yX , 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["!","SHADELESS"],group:{type:"group",a:[{type:"textline",
b:"yV += zI . b ;".split(" ")}]}}]},{type:"textline",b:"float yW = zt . a ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["!","SHADELESS"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WETTABLE"],group:{type:"group",a:[{type:"textline",b:"yV = max ( yV - sqrt ( 0.01 * - min ( yN , 0.0 ) ) , 0.5 * yV ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CAUSTICS"],group:{type:"group",a:[{type:"textline",
b:"lz ( yV , yN , u_time , yY , yX , u_sun_direction , yO , u_sun_quaternion , lA , yM ) ;".split(" ")}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["ALPHA_CLIP"],group:{type:"group",a:[{type:"textline",b:"if ( yW <= 0.5 ) discard ; yW = 1.0 ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["!","SHADELESS","&&","!","NODES"],group:{type:"group",a:[{type:"textline",b:"yW += zI . a . a * zH . r * u_specular_alpha ;".split(" ")}]}}]}]}}]}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["!","NODES_GLOW"],group:{type:"group",a:[{type:"textline",b:["yW","=","1.0",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["!","NODES"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"yV = mix ( mo ( cI , yX . xz * u_refr_bump ) , yV , yW ) ; yW = 1.0 ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:"! DISABLE_FOG && ( ! PROCEDURAL_FOG || WATER_EFFECTS )".split(" "),
group:{type:"group",a:[{type:"textline",b:"float zJ = clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"vec3 zK = hi ( u_cube_fog , yP ) ; vec4 zL = vec4 ( zK , u_fog_color_density . a ) ; gv ( zL . rgb ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec4 zL = u_fog_color_density ; zL . rgb *= zJ ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"hB ( yV , yM , yP , u_cam_water_depth , u_underwater_fog_color_density , zL , yN , zJ ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"hb ( yV , yM , zL ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SSAO_ONLY","&&","SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",
b:"vec2 zM = texture2DProj ( u_shadow_mask , cI ) . rg ; float zN = zM . g ; yV = vec3 ( zN ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:"SSAO_ONLY && SHADOW_USAGE == SHADOW_MAPPING_OPAQUE && ! SHADELESS".split(" "),group:{type:"group",a:[{type:"textline",b:"yV = vec3 ( dQ . a ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["gx","(","yV",")",";"]},{type:"condition",a:[{type:"if",c:"ALPHA && ! ALPHA_CLIP || NODES_GLOW".split(" "),group:{type:"group",
a:[{type:"textline",b:"gA ( yV , yW ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( yV , yW ) ; }".split(" ")}]};a["main.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{type:"include",file:"std_enums.glsl"},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},
{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:"! NODES || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE || WIND_BEND && MAIN_BEND_COL && DETAIL_BEND || USE_NODE_TEX_COORD_NO".split(" "),group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","||","CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4",
"a_tangent",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","||","DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute",
"float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",
a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]},{type:"condition",a:[{type:"if",c:"! NODES || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE || USE_NODE_TEX_COORD_NO".split(" "),group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_normal_next",";"]},{type:"condition",a:[{type:"if",
c:["TEXTURE_NORM_CO","||","CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["!","NODES"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_color",";"]}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ;".split(" ")},{type:"condition",a:[{type:"if",c:["!","NODES","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",
c:["SMAA_JITTER"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",
b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],
group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","NODES"],group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_BLEND"],group:{type:"group",a:[{type:"textline",b:"uniform float u_normal_offset ; uniform mat4 u_v_light_matrix ; uniform mat4 u_b_light_matrix ; uniform mat4 u_p_light_matrix0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix2",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE","||","USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"textline",b:["varying","vec3","lA",";"]},{type:"condition",a:[{type:"if",c:"! NODES || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE || USE_NODE_TEX_COORD_NO".split(" "),
group:{type:"group",a:[{type:"textline",b:["varying","vec3","lB",";"]}]}}]},{type:"condition",a:[{type:"if",c:"NODES || ! DISABLE_FOG || ( TEXTURE_NORM_CO && PARALLAX ) || ( WATER_EFFECTS && CAUSTICS )".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec4","cD",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO","||","CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","lC",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","NODES"],group:{type:"group",
a:[{type:"textline",b:["varying","vec3","lD",";"]},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_COLOR","||","DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","lE",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_BLEND"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cE",";"]},{type:"condition",a:[{type:"if",
c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cF",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cG",";"]}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cH",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || SHADOW_USAGE == SHADOW_MAPPING_OPAQUE || REFRACTIVE || USE_NODE_B4W_REFRACTION".split(" "),
group:{type:"group",a:[{type:"textline",b:["varying","vec3","cI",";"]}]}}]},{type:"condition",a:[{type:"if",c:"REFRACTIVE && ( ! NODES || USE_NODE_B4W_REFRACTION )".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","float","lF",";"]}]}}]},{type:"include",file:"dynamic_grass.glslv"},{type:"include",file:"shadow.glslv"},{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"include",file:"nodes.glslv"}]}}]},
{type:"textline",b:"void main ( ) { vec3 yR = a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:"CALC_TBN_SPACE || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || WIND_BEND && MAIN_BEND_COL && DETAIL_BEND || ! NODES".split(" "),group:{type:"group",a:[{type:"textline",b:["vec3","yS","=","a_normal",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 yS = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"CALC_TBN_SPACE || ! NODES && TEXTURE_NORM_CO == TEXTURE_COORDS_UV_ORCO".split(" "),
group:{type:"group",a:[{type:"textline",b:"vec3 yT = vec3 ( a_tangent ) ; vec3 yU = a_tangent [ 3 ] * cross ( yS , yT ) ;".split(" ")}]}},{type:"elif",c:"! NODES && TEXTURE_NORM_CO == TEXTURE_COORDS_NORMAL".split(" "),group:{type:"group",a:[{type:"textline",b:"vec3 yV = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; vec3 yW = normalize ( ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ) ; vec3 yX = yV - u_camera_eye ; vec3 yU = cross ( yX , yW ) ; vec3 yT = cross ( yW , yU ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 yT = vec3 ( 0.0 ) ; vec3 yU = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"yR = mix ( yR , a_position_next , u_va_frame_factor ) ;".split(" ")},{type:"condition",a:[{type:"if",c:"! NODES || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE".split(" "),group:{type:"group",a:[{type:"textline",b:"yS = mix ( yS , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["TEXTURE_NORM_CO"],group:{type:"group",a:[{type:"textline",b:"vec3 yY = vec3 ( a_tangent ) ; vec3 yZ = a_tangent_next [ 3 ] * cross ( a_normal_next , yY ) ; yT = mix ( yT , yY , u_va_frame_factor ) ; yU = mix ( yU , yZ , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"bK ( yR , yT , yU , yS ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","||","DYNAMIC_GRASS",
"||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["vec3","y_","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 y_ = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"d za = ge ( yR , yT , yU , yS , y_ , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"vec3 zb = ( u_model_matrix * vec4 ( y_ , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","&&","!","STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"mat4 zc = at ( u_camera_eye , zb , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 zc = an ( u_camera_eye , zb , u_view_matrix ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","&&","BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"vec3 zd = ( u_model_matrix * vec4 ( y_ , 1.0 ) ) . xyz ; zc = zc * ac ( u_wind , u_time , u_jitter_amp , u_jitter_freq , zd ) ;".split(" ")}]}}]},{type:"textline",b:"d za = aA ( yR - y_ , y_ , yT , yU , yS , zc ) ; za . b = zb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"d za = aA ( yR , y_ , yT , yU , yS , u_model_matrix ) ;".split(" ")}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["TEXTURE_NORM_CO","||","CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"float ze = ( dot ( cross ( za . e , za . c ) , za . d ) < 0.0 ) ? - 1.0 : 1.0 ; lC = vec4 ( za . c , ze ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"cC ( za . a , za . b , yS ) ;".split(" ")}]}}]},{type:"textline",b:"lA = za . a ;".split(" ")},{type:"condition",a:[{type:"if",c:"! NODES || USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE || WIND_BEND && MAIN_BEND_COL && DETAIL_BEND".split(" "),
group:{type:"group",a:[{type:"textline",b:"lB = za . e ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["!","NODES"],group:{type:"group",a:[{type:"textline",b:"lD = u_camera_eye - za . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXCOORD"],group:{type:"group",a:[{type:"textline",b:"a = aD ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"lE = za . f ;".split(" ")}]}},{type:"elif",c:["VERTEX_COLOR"],
group:{type:"group",a:[{type:"textline",b:["lE","=","a_color",";"]}]}}]}]}}]},{type:"textline",b:"vec4 zf = u_view_matrix * vec4 ( za . a , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:"NODES || ! DISABLE_FOG || ( TEXTURE_NORM_CO && PARALLAX ) || ( WATER_EFFECTS && CAUSTICS )".split(" "),group:{type:"group",a:[{type:"textline",b:["cD","=","zf",";"]}]}}]},{type:"textline",b:"vec4 zg = u_proj_matrix * zf ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_JITTER"],group:{type:"group",
a:[{type:"textline",b:"zg . xy += u_subpixel_jitter * zg . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:["go","(","zg",")",";"]}]}},{type:"elif",c:["SHADOW_USAGE","==","SHADOW_MAPPING_BLEND"],group:{type:"group",a:[{type:"textline",b:"go ( za . a , za . e ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || SHADOW_USAGE == SHADOW_MAPPING_OPAQUE || REFRACTIVE || USE_NODE_B4W_REFRACTION".split(" "),
group:{type:"group",a:[{type:"textline",b:"float zh = zg . x ; float zi = zg . y ; float zj = zg . w ; cI . x = ( zh + zj ) / 2.0 ; cI . y = ( zi + zj ) / 2.0 ; cI . z = zj ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"REFRACTIVE && ( ! NODES || USE_NODE_B4W_REFRACTION )".split(" "),group:{type:"group",a:[{type:"textline",b:"lF = - zf . z / u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NODES"],group:{type:"group",a:[{type:"textline",b:["yQ","(",")",";"]}]}}]},{type:"textline",
b:["gl_Position","=","zg",";","}"]}]};a["particles_color.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"fog.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform float u_p_alpha_start ; uniform float u_p_alpha_end ; uniform vec4 u_fog_color_density ; varying float yR ; varying vec3 lE ;".split(" ")},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["varying",
"vec3","cD",";"]}]}}]},{type:"textline",b:"void main ( ) { float yS = 2.0 * sqrt ( ( gl_PointCoord . x - 0.5 ) * ( gl_PointCoord . x - 0.5 ) + ( gl_PointCoord . y - 0.5 ) * ( gl_PointCoord . y - 0.5 ) ) ; float yT = smoothstep ( u_p_alpha_start , u_p_alpha_end , yS ) ; float yU = u_diffuse_color . a * yR * ( 1.0 - clamp ( yT , 0.0 , 1.0 ) ) ; vec3 yV = lE * u_diffuse_color . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:"hb ( yV , length ( cD ) , u_fog_color_density ) ;".split(" ")}]}}]},
{type:"textline",b:["gx","(","yV",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA","&&","!","ALPHA_CLIP"],group:{type:"group",a:[{type:"textline",b:"gA ( yV , yU ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( yV , yU ) ; }".split(" ")}]};a["particles_color.glslv"]={type:"group",a:[{type:"var",name:"COLOR_RAMP_LENGTH",b:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",b:["0"]},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_p_delay ; attribute float a_p_lifetime ; attribute vec4 a_p_vels ;".split(" ")},
{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec2 u_p_size_ramp [ SIZE_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform vec3 u_p_wind ; uniform float u_p_max_lifetime ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_p_size ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","WORLD_SPACE"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"varying float yR ; varying vec3 lE ; varying vec3 cD ;".split(" ")},{type:"include",file:"particles.glslv"},{type:"textline",b:"void main ( ) { yS zH ; zH = zG ( ) ; vec4 zI = u_view_matrix * vec4 ( zH . b , 1.0 ) ; gl_Position = u_proj_matrix * zI ; yR = zH . c ; lE = zH . d ; cD = zI . xyz ; float zJ = u_height * u_proj_matrix [ 1 ] [ 1 ] * u_p_size / gl_Position . z ; gl_PointSize = zH . a * zJ ; }".split(" ")}]};
a["particles_texture.glslf"]={type:"group",a:[{type:"include",file:"std_enums.glsl"},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"lighting.glslf"},{type:"include",file:"fog.glslf"},{type:"var",name:"PARTICLES_SHADELESS",b:["0"]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",
a:[{type:"if",c:["NUM_LIGHTS",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]}]}}]},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",
a:[{type:"textline",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","&&","SKY_TEXTURE"],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","&&","SKY_COLOR"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; varying float yR ; varying vec3 lE ; varying vec2 a ; varying vec3 lD ; varying vec3 lA ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cD",";"]}]}}]},{type:"include",file:"environment.glslf"},{type:"textline",b:"void main ( ) { vec4 zH = u_diffuse_color ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_COLOR"],group:{type:"group",a:[{type:"textline",b:"vec4 zI = texture2D ( u_sampler , a ) ; gv ( zI . rgb ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["TEXTURE_BLEND_TYPE","==","TEXTURE_BLEND_TYPE_MIX"],
group:{type:"group",a:[{type:"textline",b:"zH . rgb = mix ( zH . rgb , zI . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{type:"elif",c:["TEXTURE_BLEND_TYPE","==","TEXTURE_BLEND_TYPE_MULTIPLY"],group:{type:"group",a:[{type:"textline",b:"zH . rgb *= mix ( vec3 ( 1.0 ) , zI . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},{type:"textline",b:"zH . a = zI . a ;".split(" ")}]}}]},{type:"textline",b:"zH . rgb *= lE ; vec3 zJ = u_diffuse_intensity * zH . rgb ;".split(" ")},{type:"condition",a:[{type:"if",
c:["!","PARTICLES_SHADELESS"],group:{type:"group",a:[{type:"textline",b:"vec3 zK = u_emit * zH . rgb ; vec3 zL = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:"USE_ENVIRONMENT_LIGHT && ! SKY_TEXTURE && SKY_COLOR".split(" "),group:{type:"group",a:[{type:"textline",b:"vec3 zM = u_environment_energy * mr ( vec3 ( 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 zM = u_environment_energy * mr ( zL ) ;".split(" ")}]}}]},{type:"textline",
b:"vec3 zN = u_ambient * zM ; float zO = u_specular_params [ 0 ] ; vec2 zP = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 zQ = zO * u_specular_color ; vec3 zR = normalize ( lD ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",">","0"],group:{type:"group",a:[{type:"textline",b:"hO zS = kU ( zK , zN , zJ , zQ , lA , zL , zR , zP , u_diffuse_params , 1.0 , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , 0.0 , vec4 ( 0.0 ) ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"hO zS = kZ ( zK , zN , zJ ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 zT = zS . a . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vec3","zT","=","zJ",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:"hb ( zT , length ( cD ) , u_fog_color_density ) ;".split(" ")}]}}]},{type:"textline",b:"float zU = zH . a * yR ; gx ( zT ) ;".split(" ")},{type:"condition",
a:[{type:"if",c:["ALPHA","&&","!","ALPHA_CLIP"],group:{type:"group",a:[{type:"textline",b:"gA ( zT , zU ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( zT , zU ) ; }".split(" ")}]};a["particles_texture.glslv"]={type:"group",a:[{type:"var",name:"BILLBOARD_ALIGN",b:["0"]},{type:"var",name:"COLOR_RAMP_LENGTH",b:["0"]},{type:"var",name:"SIZE_RAMP_LENGTH",b:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"define",name:"BILLBOARD_ALIGN_VIEW",b:["1"]},
{type:"define",name:"BILLBOARD_ALIGN_XY",b:["2"]},{type:"define",name:"BILLBOARD_ALIGN_YZ",b:["3"]},{type:"define",name:"BILLBOARD_ALIGN_ZX",b:["4"]},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_p_delay ; attribute float a_p_lifetime ; attribute vec4 a_p_vels ; attribute vec2 a_p_bb_vertex ;".split(" ")},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec2 u_p_size_ramp [ SIZE_RAMP_LENGTH ] ;".split(" ")}]}}]},{type:"textline",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform vec3 u_p_wind ; uniform float u_p_max_lifetime ; uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ; uniform vec3 u_camera_eye ; uniform float u_p_size ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","WORLD_SPACE"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"varying float yR ; varying vec3 lE ; varying vec2 a ; varying vec3 lD ; varying vec3 lA ;".split(" ")},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","cD",";"]}]}}]},{type:"include",file:"particles.glslv"},{type:"textline",b:"float zJ ( vec2 zH , vec2 zI ) { return ( atan ( zI . y , zI . x ) - atan ( zH . y , zH . x ) ) ; } void main ( ) { yS zK ; zK = zG ( ) ; float zL ; mat4 zM ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { zL = zK . e ; zM = N ( zK . b , u_view_matrix ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { zL = zK . e ; zM = x ( ) ; zM [ 3 ] = vec4 ( zK . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { zL = zK . e ; zM = B ( radians ( 90.0 ) ) ; zM [ 3 ] = vec4 ( zK . b , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { zL = zJ ( vec2 ( EPSILON , 1.0 ) , vec2 ( a_normal . x , a_normal . z ) ) + zK . e ; zM = z ( radians ( - 90.0 ) ) ; zM [ 3 ] = vec4 ( zK . b , 1.0 ) ; } vec4 zN = vec4 ( a_p_bb_vertex * 2.0 * zK . a * u_p_size , 0.0 , 1.0 ) ; vec4 zO = zM * D ( zL ) * zN ; vec4 zP = u_view_matrix * zO ; vec4 zQ = u_proj_matrix * zP ; gl_Position = zQ ; yR = zK . c ; lE = zK . d ; a = a_p_bb_vertex + 0.5 ; lA = zO . xyz ; lD = u_camera_eye - zO . xyz ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["cD","=","zP",";"]}]}}]},{type:"textline",b:["}"]}]};a["procedural_skydome.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; varying vec3 zH ; const float zI = 0.99 ; const float zJ = 1.8 ; const int zK = 8 ; float zU ( vec3 zL , vec3 zM ) { float zN = dot ( zM , zM ) ; float zO = 2.0 * dot ( zM , zL ) ; float zP = dot ( zL , zL ) - 1.0 ; float zQ = zO * zO - 4.0 * zN * zP ; float zR = sqrt ( zQ ) ; float zS = ( - zO - zR ) / 2.0 ; float zT = zP / zS ; return zT ; } float Aa ( float zV , float zW ) { float zX = 3.0 * ( 1.0 - zW * zW ) ; float zY = 2.0 * ( 2.0 + zW * zW ) ; float zZ = 1.0 + zV * zV ; float z_ = pow ( 1.0 + zW * zW - 2.0 * zW * zV , 1.5 ) ; z_ = max ( z_ , 0.00001 ) ; return ( zX / zY ) * ( zZ / z_ ) ; } float Ai ( vec3 Ab , vec3 Ac , float Ad ) { float Ae = dot ( Ac , - Ab ) ; if ( Ae < 0.0 ) { return 1.0 ; } vec3 Af = Ab + Ae * Ac ; if ( length ( Af ) < Ad ) { return 0.0 ; } else if ( length ( Af ) >= Ad ) { vec3 Ag = normalize ( Af ) * Ad - Ab ; float Ah = acos ( dot ( normalize ( Ag ) , Ac ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( Ah * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 Am ( float Aj , vec3 Ak , float Al ) { return Ak - Ak * pow ( u_sky_color , vec3 ( Al / Aj ) ) ; } void main ( ) { vec3 An = normalize ( zH ) ; vec3 Ao = u_sun_direction ; float Ap = dot ( An , Ao ) ; float Aq = Aa ( Ap , - 0.01 ) * u_rayleigh_brightness * Ao . y ; float Ar = Aa ( Ap - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - Ao . y ) ; float As = smoothstep ( 0.0 , 100.0 , Aa ( Ap , 0.9995 ) ) * u_spot_brightness ; vec3 At = vec3 ( 0.0 , zI , 0.0 ) ; float Au = zU ( At , An ) ; float Av = Au / float ( zK ) ; float Aw = Ai ( At , An , zI - 0.3 ) ; vec3 Ax = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Ay = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int Az = 0 ; Az < zK ; Az ++ ) { float AA = Av * float ( Az ) ; vec3 AB = At + An * AA ; float AC = Ai ( AB , Ao , zI - 0.2 ) ; float AD = zU ( AB , Ao ) ; vec3 AE = Am ( AD , vec3 ( zJ ) , u_scatter_strength ) * AC ; Ax += Am ( sqrt ( AA ) , u_sky_color * AE , u_rayleigh_strength ) ; Ay += Am ( AA , AE , u_mie_strength ) ; } Ax = Ax * Aw * pow ( Au , u_rayleigh_collection_power ) / float ( zK ) ; Ay = ( Ay * Aw * pow ( Au , u_mie_collection_power ) ) / float ( zK ) ; vec3 AF = vec3 ( As * Ay + Ar * Ay + Aq * Ax ) ; gx ( AF ) ; gl_FragColor = vec4 ( AF , 1.0 ) ; }".split(" ")}]};
a["procedural_skydome.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec3 a_position ; uniform mat4 u_cube_view_matrix ; varying vec3 zH ; void main ( ) { vec4 zI = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 zJ = u_cube_view_matrix * zI ; zH = zJ . xyz ; gl_Position = zI ; }".split(" ")}]};a["special_lens_flares.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform sampler2D u_sampler ; varying vec2 a ; void main ( ) { vec4 zI = texture2D ( u_sampler , a ) ; gx ( zI . rgb ) ; gA ( zI . rgb , zI . a ) ; gl_FragColor = zI ; }".split(" ")}]};
a["special_lens_flares.glslv"]={type:"group",a:[{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"define",name:"LIGHT_INDEX",b:["0"]},{type:"textline",b:"attribute float a_lf_dist ; attribute vec2 a_lf_bb_vertex ; attribute vec2 a_texcoord ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; varying vec2 a ; void main ( ) { a = a_texcoord ; vec3 zI = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 zJ = u_proj_matrix * u_view_matrix * vec4 ( zI , 0.0 ) ; zJ . x /= zJ . w ; zJ . y /= zJ . w ; zJ += 99999.0 * step ( zJ . z , 0.0 ) ; zJ += 100.0 * ( step ( 1.0 , abs ( zJ . x ) ) + step ( 1.0 , abs ( zJ . y ) ) ) ; zJ . x = - a_lf_dist * zJ . x ; zJ . y = - a_lf_dist * zJ . y ; float zK = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 zL = vec2 ( a_lf_bb_vertex . x / zK , a_lf_bb_vertex . y ) ; if ( a_lf_dist > - 0.999 ) { const float zM = 1.9 ; zL *= ( 1.0 + zM * length ( zJ . xy ) ) ; } gl_Position = vec4 ( zJ . xy + zL , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslf"]={type:"group",a:[{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"define",name:"INV_PI",b:["0.318309886"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",c:["WO_SKYTEX","||","PROCEDURAL_SKYDOME"],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_sky",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","PROCEDURAL_SKYDOME","&&","WO_SKYTEX"],group:{type:"group",a:[{type:"include",file:"std_enums.glsl"},
{type:"include",file:"blending.glslf"},{type:"textline",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; vec3 BS ( vec3 BN , vec3 BO , float BP , float BQ ) { float BR = BP * BQ ;".split(" ")},{type:"condition",a:[{type:"if",c:["BLENDTYPE","==","MTEX_BLEND"],group:{type:"group",a:[{type:"textline",b:"return z_ ( BO , BN , BR ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_ADD"],group:{type:"group",a:[{type:"textline",b:"return Ad ( BN , BO , BR ) ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","==","MTEX_SUB"],group:{type:"group",a:[{type:"textline",b:"return Ah ( BN , BO , BR ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_MUL"],group:{type:"group",a:[{type:"textline",b:"return Am ( BN , BO , BR ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_SCREEN"],group:{type:"group",a:[{type:"textline",b:"return Ar ( BN , BO , BR ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_OVERLAY"],group:{type:"group",a:[{type:"textline",b:"return Aw ( BN , BO , BR ) ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","==","MTEX_DIFF"],group:{type:"group",a:[{type:"textline",b:"return AA ( BN , BO , BR ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_DIV"],group:{type:"group",a:[{type:"textline",b:"return AE ( BN , BO , BR ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_DARK"],group:{type:"group",a:[{type:"textline",b:"return AI ( BN , BO , BR ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_LIGHT"],group:{type:"group",a:[{type:"textline",b:"return AM ( BN , BO , BR ) ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","==","MTEX_BLEND_HUE"],group:{type:"group",a:[{type:"textline",b:"return AT ( BO , BN , BR ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_BLEND_SAT"],group:{type:"group",a:[{type:"textline",b:"return AZ ( BO , BN , BR ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_BLEND_VAL"],group:{type:"group",a:[{type:"textline",b:"return Be ( BO , BN , BR ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_BLEND_COLOR"],group:{type:"group",a:[{type:"textline",
b:"return Bl ( BO , BN , BR ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_SOFT_LIGHT"],group:{type:"group",a:[{type:"textline",b:"return Bq ( BO , BN , BR ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_LIN_LIGHT"],group:{type:"group",a:[{type:"textline",b:"return Bu ( BO , BN , BR ) ;".split(" ")}]}}]},{type:"textline",b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float B_ ( float BT , float BU , float BV , float BW ) { vec3 BX = vec3 ( BT ) , BY = vec3 ( BU ) ; float BZ = BV * BW ;".split(" ")},
{type:"condition",a:[{type:"if",c:["BLENDTYPE","==","MTEX_BLEND"],group:{type:"group",a:[{type:"textline",b:"return z_ ( BY , BX , BZ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_ADD"],group:{type:"group",a:[{type:"textline",b:"return Ad ( BX , BY , BZ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_SUB"],group:{type:"group",a:[{type:"textline",b:"return Ah ( BX , BY , BZ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_MUL"],group:{type:"group",a:[{type:"textline",
b:"return BA ( BT , BU , BZ , BW ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_SCREEN"],group:{type:"group",a:[{type:"textline",b:"return BG ( BT , BU , BZ , BW ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_OVERLAY"],group:{type:"group",a:[{type:"textline",b:"return BM ( BT , BU , BZ , BW ) ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_DIFF"],group:{type:"group",a:[{type:"textline",b:"return AA ( BX , BY , BZ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE",
"==","MTEX_DIV"],group:{type:"group",a:[{type:"textline",b:"return AE ( BX , BY , BZ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_DARK"],group:{type:"group",a:[{type:"textline",b:"return AI ( BX , BY , BZ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_LIGHT"],group:{type:"group",a:[{type:"textline",b:"return AM ( BX , BY , BZ ) . x ;".split(" ")}]}},{type:"elif",c:["BLENDTYPE","==","MTEX_SOFT_LIGHT"],group:{type:"group",a:[{type:"textline",b:"return Bq ( BY , BX , BZ ) . x ;".split(" ")}]}},
{type:"elif",c:["BLENDTYPE","==","MTEX_LIN_LIGHT"],group:{type:"group",a:[{type:"textline",b:"return Bu ( BY , BX , BZ ) . x ;".split(" ")}]}}]},{type:"textline",b:["return","0.0",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:["!","PROCEDURAL_SKYDOME"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS","&&","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_camera_eye_frag ; uniform vec3 u_sun_intensity ; uniform float u_environment_energy ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},
{type:"textline",b:["varying","vec3","zH",";"]},{type:"condition",a:[{type:"if",c:"! PROCEDURAL_SKYDOME && ( WO_SKYTEX || WO_SKYBLEND )".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"textline",b:"void main ( ) { vec3 Ca ; vec3 Cb = normalize ( zH ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_SKYDOME"],group:{type:"group",a:[{type:"textline",b:"Ca = textureCube ( u_sky , Cb ) . rgb ;".split(" ")}]}},{type:"elif",c:"! ( WO_SKYTEX || WO_SKYBLEND )".split(" "),
group:{type:"group",a:[{type:"textline",b:"Ca = u_horizon_color ; gx ( Ca ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vec3","Cc",";"]},{type:"condition",a:[{type:"if",c:["WO_SKYPAPER"],group:{type:"group",a:[{type:"textline",b:"Cc = vec3 ( a , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Cc = vec3 ( zH . xy , 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:["float","Cd",";"]},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["WO_SKYPAPER"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"Cd = abs ( a . y ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Cd = ( a . y + 1.0 ) * 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"float Ce = acos ( Cb . y ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"Cd = abs ( Ce * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"Cd = 1.0 - Ce * INV_PI ;".split(" ")}]}}]}]}}]}]}}]},{type:"textline",b:"vec3 Cf = u_horizon_color ; vec3 Cg = u_zenith_color ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYTEX"],group:{type:"group",a:[{type:"textline",b:"float Ch = 1.0 ; vec4 Ci = textureCube ( u_sky , Cb ) ; gv ( Ci . rgb ) ; Ch = Ci . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"Ch = dot ( Ci . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["MTEX_NEGATIVE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["!","MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"Ci = vec4 ( vec3 ( 1.0 ) - Ci . rgb , Ci . a ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Ch = 1.0 - Ch ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_HORIZ","||","WOMAP_ZENUP","||","WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MTEX_RGBTOINT"],group:{type:"group",
a:[{type:"textline",b:"Ci = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Ch = Ci . a ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_HORIZ"],group:{type:"group",a:[{type:"textline",b:"Cf = BS ( Ci . rgb , Cf , Ch , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP","||","WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",b:["float","Cj","=","0.0",";"]},{type:"condition",a:[{type:"if",
c:["WO_SKYREAL"],group:{type:"group",a:[{type:"textline",b:"if ( dot ( Cc , vec3 ( 0.0 , 1.0 , 0.0 ) ) >= 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP"],group:{type:"group",a:[{type:"textline",b:"Cj = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:[";"]}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",b:"else Cj = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WOMAP_ZENUP"],group:{type:"group",a:[{type:"textline",b:"Cj = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{type:"elif",c:["WOMAP_ZENDOWN"],group:{type:"group",a:[{type:"textline",b:"Cj = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{type:"textline",b:"if ( Cj != 0.0 ) Cg = BS ( Ci . rgb , Cg , Ch , Cj ) ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WOMAP_BLEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["!","MTEX_RGBTOINT"],group:{type:"group",a:[{type:"textline",b:"Ch = dot ( Ci . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{type:"textline",b:"Cd = B_ ( u_sky_tex_dvar , Cd , Ch , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"textline",b:"Ca = mix ( Cf , Cg , Cd ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["Ca","=","Cf",";"]}]}}]},{type:"textline",b:["gx","(","Ca",")",";"]}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gx ( Cf ) ; gx ( Cg ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["WO_SKYBLEND"],group:{type:"group",a:[{type:"textline",b:"Ca = mix ( Cf , Cg , Cd ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["Ca","=","Cf",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:"WATER_EFFECTS && ! DISABLE_FOG && ! REFLECTION_PASS".split(" "),group:{type:"group",a:[{type:"textline",b:"gv ( Ca ) ; float Ck = u_camera_eye_frag . y - WATER_LEVEL ; Ck = min ( - Ck * 0.03 , 0.8 ) ; float Cl = clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ; vec3 Cm = vec3 ( 0.0 ) ; vec4 Cn = u_underwater_fog_color_density ; Cn . rgb = mix ( Cn . rgb , Cm , min ( - Cb . y + Ck , 1.0 ) ) * Cl ; float Co = clamp ( sign ( Cb . y - 0.05 * Ck ) , 0.0 , 1.0 ) ; Ca = mix ( Cn . rgb , Ca , Co ) ; gx ( Ca ) ;".split(" ")}]}}]},
{type:"textline",b:"gl_FragColor = vec4 ( Ca , 1.0 ) ; }".split(" ")}]};a["special_skydome.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec3 a_position ; uniform mat4 u_sky_vp_inverse ; varying vec3 zH ;".split(" ")},{type:"condition",a:[{type:"if",c:"! PROCEDURAL_SKYDOME && ( WO_SKYTEX || WO_SKYBLEND )".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"textline",b:"void main ( ) { vec4 BN = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 BO = u_sky_vp_inverse * BN ; zH = BO . xyz ;".split(" ")},
{type:"condition",a:[{type:"if",c:"! PROCEDURAL_SKYDOME && ( WO_SKYTEX || WO_SKYBLEND )".split(" "),group:{type:"group",a:[{type:"textline",b:"a = a_position . xy ;".split(" ")}]}}]},{type:"textline",b:["gl_Position","=","BN",";","}"]}]};a["special_water.glslf"]={type:"group",a:[{type:"var",name:"ABSORB",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"SSS_STRENGTH",b:["6.0"]},{type:"var",name:"SSS_WIDTH",b:["0.0"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"include",file:"std_enums.glsl"},
{type:"include",file:"precision_statement.glslf"},{type:"include",file:"fog.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"lighting.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"math.glslv"},{type:"define",name:"REFL_BUMP",b:["0.001"]},{type:"define",name:"REFR_BUMP",b:["0.0005"]},{type:"textline",b:["uniform","float","u_time",";"]},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT","&&","SKY_TEXTURE"],group:{type:"group",
a:[{type:"textline",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{type:"elif",c:["USE_ENVIRONMENT_LIGHT","&&","SKY_COLOR"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{type:"textline",b:["uniform","float","u_environment_energy",";"]},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",">","0"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{type:"textline",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || REFRACTIVE || WATER_EFFECTS".split(" "),group:{type:"group",a:[{type:"textline",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","vec4","u_fog_color_density",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",
a:[{type:"textline",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG","&&","PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:["uniform",
"sampler2D","u_refractmap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_PLANE"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","sampler2D","u_scene_depth",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_foam",";"]}]}}]},{type:"textline",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",
">","0"],group:{type:"group",a:[{type:"textline",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","1"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_normalmap1_scale",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","2"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_normalmap2_scale",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","3"],group:{type:"group",
a:[{type:"textline",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_mirror_factor",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","float","u_reflect_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","||","!","DISABLE_FOG"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_view_max_depth",
";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",
b:["uniform","float","u_refr_bump",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:"const float BN = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{type:"textline",b:"varying vec3 lD ; varying vec3 lA ;".split(" ")},{type:"condition",a:[{type:"if",c:"( NUM_NORMALMAPS > 0 || FOAM ) && ! GENERATED_MESH".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],
group:{type:"group",a:[{type:"textline",b:["varying","vec3","lB",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:"varying vec3 lC ; varying vec3 BO ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","BP",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","BQ",";"]}]}}]},{type:"condition",
a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec3","cI",";"]}]}}]},{type:"condition",a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE || ! DISABLE_FOG".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","float","lF",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","BR",";"]}]}}]},
{type:"include",file:"environment.glslf"},{type:"condition",a:[{type:"if",c:["REFRACTIVE","&&","SHORE_SMOOTHING","&&","USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"include",file:"refraction.glslf"}]}}]},{type:"textline",b:"vec3 Cf ( in vec2 BS , in vec3 BT , in vec3 BU , in vec3 BV , out float BW ) { BW = 0.0 ; vec3 BX = reflect ( - BU , BT ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_PLANE"],group:{type:"group",a:[{type:"textline",b:"vec2 BY = BS . xy + BT . xz * REFL_BUMP / lF ; BW = u_reflect_factor ; vec3 BZ ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG","&&","WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"BZ = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"BZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"textline",b:"float B_ = dot ( BU , BT ) ; BW *= max ( 1.0 - 1.0 / B_ , 1.0 ) ; } else { BZ = texture2D ( u_plane_reflection , BY ) . rgb ; gv ( BZ ) ; }".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],
group:{type:"group",a:[{type:"textline",b:"BW = u_mirror_factor ; vec3 BZ = BV * textureCube ( u_mirrormap , BX ) . rgb ; gv ( BZ ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"BW = u_reflect_factor ; vec3 BZ = BV * vec3 ( 0.3 , 0.5 , 1.0 ) ; gv ( BZ ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 Ca = normalize ( BX + BU ) ; float Cb = 1.0 - dot ( BU , Ca ) ; float Cc = u_fresnel_params [ 3 ] ; float Cd = u_fresnel_params [ 2 ] ; float Ce = Cc + ( 1.0 - Cc ) * pow ( Cb , Cd ) ; BW = min ( BW * Ce , 1.0 ) ; return BZ ; } void main ( ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:"mat3 Cg = mat3 ( lC , BO , lB ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 Ch = normalize ( lB ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:"mat3 Cg = mat3 ( 1.0 , 0.0 , 0.0 , 0.0 , 0.0 , - 1.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"vec3 Ch = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC","&&","FOAM"],group:{type:"group",a:[{type:"textline",b:"float Ci = lA . y - WATER_LEVEL ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0","||","FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"vec2 Cj = vec2 ( BP . x , - BP . z ) + 0.5 ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"vec2 Cj = vec2 ( lA . x , - lA . z ) + 0.5 ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vec2","Cj","=","a",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:"vec3 Ck = vec3 ( 0.0 ) ; vec3 Cl = texture2D ( u_normalmap0 , Cj * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Ck += Cl ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"vec3 Cm = vec3 ( 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["NORM_FOAM0"],group:{type:"group",a:[{type:"textline",b:["Cm","+=","Cl",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","1"],group:{type:"group",a:[{type:"textline",b:"Cl = texture2D ( u_normalmap0 , Cj * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Ck += Cl ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM1"],group:{type:"group",a:[{type:"textline",b:["Cm","+=","Cl",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","2"],group:{type:"group",a:[{type:"textline",b:"Cl = texture2D ( u_normalmap0 , Cj * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Ck += Cl ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",
a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM2"],group:{type:"group",a:[{type:"textline",b:["Cm","+=","Cl",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","3"],group:{type:"group",a:[{type:"textline",b:"Cl = texture2D ( u_normalmap0 , Cj * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; Ck += Cl ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["NORM_FOAM3"],
group:{type:"group",a:[{type:"textline",b:["Cm","+=","Cl",";"]}]}}]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"vec3 Cn = Cg * Cm ; if ( ! g ( Cn , vec3 ( 0.0 ) ) ) Cn = normalize ( Cn ) ; vec3 Co = mix ( Ch , Cn , 0.2 ) ; Co = normalize ( Co ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"Ch = mix ( Ch , normalize ( Cg * Ck ) , 0.3 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"Ch = mix ( Ch , normalize ( Cg * Ck ) , 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:"Ch = normalize ( Ch ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 Cp = normalize ( lD ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_PLANE","||","REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"vec2 Cq = cI . xy / cI . z ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING","||","!","DISABLE_FOG"],
group:{type:"group",a:[{type:"textline",b:"float Cr = lF * u_view_max_depth ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:"float Cs = u_diffuse_color . a ; vec4 Ct = texture2DProj ( u_scene_depth , cI ) ; float Cu = gO ( Ct ) ; float Cv = max ( Cu - lF , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"vec2 Cw = Cq + Ch . xz * u_refr_bump / lF ; float Cx = mg ( Cu , Cw , Cq ) ; float Cy = max ( Cx - lF , 0.0 ) ; float Cz = u_view_max_depth / ABSORB * Cy ; float CA ; if ( u_cam_water_depth < 0.0 ) CA = 0.0 ; else CA = min ( Cs * Cz , 1.0 ) ; float CB = u_view_max_depth / ABSORB * Cv ; Cs = min ( 15.0 * Cs * u_view_max_depth * Cv , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"float CB = u_view_max_depth / ABSORB * Cv ; if ( u_cam_water_depth > 0.0 ) Cs = min ( Cs * CB , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"Cs *= min ( 5.0 * Cr , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"float Cs = u_diffuse_color . a ;".split(" ")},{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"float CA = 1.0 - Cs ; vec2 Cw = Cq + Ch . xz * u_refr_bump / lF ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"vec3 CC = texture2D ( u_refractmap , Cw ) . rgb ; gv ( CC ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"float CD = pow ( min ( BQ . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 CE = mix ( u_shallow_water_col , u_diffuse_color . rgb , CD ) ; CD = pow ( min ( BQ . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; CE = mix ( u_shore_water_col , CE , CD ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 CE = u_diffuse_color . rgb ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SHORE_SMOOTHING"],group:{type:"group",a:[{type:"textline",b:"float CF = max ( 1.0 - u_view_max_depth * Cv , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"float CF = 1.0 - Cs ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",
a:[{type:"textline",b:"float CG = max ( Ci / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"vec3 CH = normalize ( vec3 ( BQ . r , 0.0 , BQ . g ) ) ; vec3 CI = normalize ( mix ( vec3 ( 0.0 , 1.0 , 0.0 ) , CH , 0.8 ) ) ; float CJ = 1.25 * max ( dot ( Co , CI ) - 0.2 , 0.0 ) ; CJ += max ( dot ( Co , vec3 ( 0.0 , - 1.0 , 0.0 ) ) , 0.0 ) ; CF += CJ * ( 1.0 - BQ . b ) ; CG *= ( 1.0 - 0.95 * pow ( BQ . b , 0.1 ) ) ;".split(" ")}]}}]},
{type:"textline",b:"CF += CG ; CF = min ( u_foam_factor * CF , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"vec4 CK = texture2D ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + Cj * u_foam_scale ) ;".split(" ")}]}}]},{type:"textline",b:"float CL = u_specular_params [ 0 ] ; vec2 CM = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 CN = CL * u_specular_color ; vec3 CO = u_environment_energy * mr ( Ch ) ; vec3 CP = u_ambient * CO ; vec3 CQ = CP + u_sun_intensity ; float CR ;".split(" ")},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_PLANE"],group:{type:"group",a:[{type:"textline",b:"vec3 CS = Cf ( Cq , Ch , Cp , CQ , CR ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 CS = Cf ( vec2 ( 0.0 ) , Ch , Cp , CQ , CR ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 CT = u_diffuse_intensity * CE ;".split(" ")},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",">","0"],group:{type:"group",a:[{type:"textline",b:"hO CU = kU ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , CT , CN , lA , Ch , Cp , CM , u_diffuse_params , 1.0 , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , 0.0 , vec4 ( 0.0 ) ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"hO CU = kZ ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , CT ) ;".split(" ")}]}}]},{type:"textline",b:"CT = CU . a . rgb ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"float CV = max ( dot ( u_sun_direction , - lB ) + SSS_WIDTH , 0.0 ) * max ( dot ( - Cp , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; CV = clamp ( SSS_STRENGTH * CV , 0.0 , 1.0 ) ; CT = mix ( CT , u_shallow_water_col , CV ) ; CT = mix ( CT , u_shore_water_col , CV ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"CT = mix ( CC , CT , CA ) ;".split(" ")}]}}]},{type:"textline",b:"CT = mix ( CT , CS , CR ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:"float CW = mix ( CK . g , CK . r , max ( 4.0 * ( CF - 0.75 ) , 0.0 ) ) ; CW = mix ( CK . b , CW , max ( 2.0 * CF - 1.0 , 0.0 ) ) ; CW = mix ( 0.0 , CW , CF ) ; CT = mix ( CT , CQ , CW ) ;".split(" ")}]}}]},{type:"textline",
b:"CT += CU . b ;".split(" ")},{type:"condition",a:[{type:"if",c:["!","DISABLE_FOG"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"vec3 CX = hi ( u_cube_fog , Cp ) ; vec4 CY = vec4 ( CX , u_fog_color_density . a ) ; gv ( CY . rgb ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["vec4","CY","=","u_fog_color_density",";"]}]}}]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",
b:"if ( u_cam_water_depth < 0.0 ) { hK ( CT , Cr , u_cam_water_depth , u_underwater_fog_color_density , clamp ( length ( u_sun_intensity ) + u_environment_energy , 0.0 , 1.0 ) ) ; } else { hb ( CT , Cr , CY ) ; }".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"hb ( CT , Cr , CY ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:["gx","(","CT",")",";"]},{type:"condition",a:[{type:"if",c:["!","REFRACTIVE"],group:{type:"group",a:[{type:"textline",b:"Cs = max ( Cs , CU . b . r ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FOAM"],group:{type:"group",a:[{type:"textline",b:["Cs","+=","CW",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"textline",b:"gA ( CT , Cs ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"extension",b:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",b:"vec3 CZ = fwidth ( BR ) ; vec3 C_ = smoothstep ( vec3 ( 0.0 ) , CZ * BN , BR ) ; float Da = min ( min ( C_ . x , C_ . y ) , C_ . z ) ; Da = clamp ( Da , 0.0 , 1.0 ) ; CT = mix ( u_wireframe_edge_color , CT , Da ) ; Cs = mix ( 1.0 , Cs , Da ) ;".split(" ")}]}}]},
{type:"textline",b:"gl_FragColor = vec4 ( CT , Cs ) ; }".split(" ")}]};a["special_water.glslv"]={type:"group",a:[{type:"var",name:"DIR_MIN_SHR_FAC",b:["0.0"]},{type:"var",name:"DIR_FREQ",b:["0.0"]},{type:"var",name:"DIR_NOISE_SCALE",b:["0.0"]},{type:"var",name:"DIR_NOISE_FREQ",b:["0.0"]},{type:"var",name:"DIR_MIN_NOISE_FAC",b:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_0",b:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_0",b:["0.0"]},{type:"var",name:"DST_NOISE_SCALE_1",b:["0.0"]},{type:"var",name:"DST_NOISE_FREQ_1",
b:["0.0"]},{type:"var",name:"DST_MIN_FAC",b:["0.0"]},{type:"var",name:"MAX_SHORE_DIST",b:["0.0"]},{type:"var",name:"PRECISION",b:["mediump"]},{type:"var",name:"SHORE_MAP_CENTER_X",b:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_X",b:["0.0"]},{type:"var",name:"SHORE_MAP_CENTER_Y",b:["0.0"]},{type:"var",name:"SHORE_MAP_SIZE_Y",b:["0.0"]},{type:"var",name:"WAVES_HOR_FAC",b:["0.0"]},{type:"var",name:"WATER_LEVEL",b:["0.0"]},{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"var",name:"WAVES_LENGTH",b:["0.0"]},
{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"include",file:"scale_texcoord.glslv"},{type:"include",file:"procedural.glslf"},{type:"textline",b:["attribute","vec3","a_position",";"]},{type:"condition",a:[{type:"if",c:["!","GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:["attribute","vec2","a_texcoord",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_polyindex",";"]}]}}]},
{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE || ! DISABLE_FOG".split(" "),group:{type:"group",a:[{type:"textline",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{type:"textline",b:"varying vec3 lD ; varying vec3 lA ;".split(" ")},{type:"condition",a:[{type:"if",c:"! GENERATED_MESH && ( NUM_NORMALMAPS > 0 || FOAM )".split(" "),
group:{type:"group",a:[{type:"textline",b:["varying","vec2","a",";"]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","lB",";"]},{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:"varying vec3 lC ; varying vec3 BO ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","BP",";"]}]}}]}]}}]},{type:"condition",
a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","BQ",";"]}]}}]},{type:"condition",a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","vec3","cI",";"]}]}}]},{type:"condition",a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE || ! DISABLE_FOG".split(" "),group:{type:"group",a:[{type:"textline",b:["varying","float","lF",";"]}]}}]},{type:"condition",
a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:["varying","vec3","BR",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"vec3 BX ( in vec2 BN ) { vec2 BS = 0.5 + vec2 ( ( BN . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , - ( BN . y + SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 BT = texture2D ( u_shore_dist_map , BS ) ; const vec2 BU = vec2 ( 1.0 / 255.0 , 1.0 ) ; float BV = dot ( BT . ba , BU ) ; vec2 BW = normalize ( BT . rg * 2.0 - 1.0 ) ; return vec3 ( BW , BV ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"define",name:"SMALL_WAVES_FAC",b:["0.3"]},{type:"textline",b:"void Cn ( inout vec3 BY , in float BZ , in vec3 B_ ) { float Ca = dJ ( DST_NOISE_SCALE_0 * ( BY . xz + DST_NOISE_FREQ_0 * BZ ) ) * dJ ( DST_NOISE_SCALE_1 * ( BY . zx - DST_NOISE_FREQ_1 * BZ ) ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"float Cb = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float Cc = B_ . b ; float Cd = sqrt ( Cc ) ; float Ce = max ( Cc , DIR_MIN_SHR_FAC ) * sin ( Cd / Cb + DIR_FREQ * BZ ) ; float Cf = max ( dJ ( DIR_NOISE_SCALE * ( BY . xz + DIR_NOISE_FREQ * BZ ) ) , DIR_MIN_NOISE_FAC ) ; Ce *= Cf ; float Cg = WAVES_HEIGHT * mix ( Ce , Ca , max ( Cd , DST_MIN_FAC ) ) ; vec2 Ch = B_ . rg ; float Ci = WAVES_HOR_FAC * Ce * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - Cc ) , 0.0 ) ; vec2 Cj = Ci * Ch ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"float Cg = WAVES_HEIGHT * Ca ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"vec2 Ck = 2.0 * ( BY . xz - 0.1 * BZ ) ; vec2 Cl = 1.3 * ( BY . zx + 0.03 * BZ ) ; float Cm = dd ( 0.5 * Ck ) . x + dd ( 0.5 * Cl ) . x - 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"BY . xz += Cj ; Cm *= Cc ;".split(" ")}]}}]},{type:"textline",
b:"Cg += SMALL_WAVES_FAC * Cm ;".split(" ")}]}}]},{type:"textline",b:"BY . y += Cg ; }".split(" ")}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["DEBUG_WIREFRAME"],group:{type:"group",a:[{type:"textline",b:"if ( a_polyindex == 0.0 ) BR = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) BR = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) BR = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["vec3","Co","=","a_position",
";"]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"float Cp = abs ( Co . y ) ; vec2 Cq = u_camera_eye . xz - mod ( u_camera_eye . xz , Cp ) ; Co . y = WATER_LEVEL ; Co . xz += Cq ;".split(" ")}]}},{type:"elif",c:["NUM_NORMALMAPS",">","0","||","FOAM"],group:{type:"group",a:[{type:"textline",b:["a","=","a_texcoord",";"]}]}}]},{type:"textline",b:"d Cr = aA ( Co , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DYNAMIC","&&","GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"BP = Cr . a ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"BQ = BX ( Cr . a . xz ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"float Cs = length ( u_wind ) ; float Ct = u_time ; Ct *= Cs ;".split(" ")},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",
a:[{type:"textline",b:["float","Cu","=","Cp",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["float","Cu","=","0.1",";"]}]}}]},{type:"textline",b:"vec3 Cv = Cr . a + vec3 ( Cu , 0.0 , 0.0 ) ; vec3 Cw = Cr . a + vec3 ( 0.0 , 0.0 , Cu ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"vec3 Cx = BX ( Cv . xz ) ; vec3 Cy = BX ( Cw . xz ) ; Cn ( Cv , Ct , Cx ) ; Cn ( Cw , Ct , Cy ) ; Cn ( Cr . a , Ct , BQ ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"Cn ( Cv , Ct , vec3 ( 0.0 ) ) ; Cn ( Cw , Ct , vec3 ( 0.0 ) ) ; Cn ( Cr . a , Ct , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["GENERATED_MESH"],group:{type:"group",a:[{type:"textline",b:"if ( a_position . y < 0.0 ) { Cr . a . y = WATER_LEVEL - 1.0 ; Cv . y = Cr . a . y ; Cw . y = Cr . a . y ; }".split(" ")}]}}]},{type:"textline",b:"vec3 Cz = normalize ( Cv - Cr . a ) ; vec3 CA = normalize ( Cw - Cr . a ) ; lB = normalize ( cross ( CA , Cz ) ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["NUM_NORMALMAPS",">","0"],group:{type:"group",a:[{type:"textline",b:"lC = CA ; BO = cross ( lB , lC ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SHORE_PARAMS"],group:{type:"group",a:[{type:"textline",b:"float CB = dot ( lB , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float CC = clamp ( 0.8 - CB , 0.0 , 1.0 ) ; lB = mix ( lB , vec3 ( 0.0 , 1.0 , 0.0 ) , CC ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"lA = Cr . a ; lD = u_camera_eye - Cr . a ; vec4 CD = u_view_matrix * vec4 ( Cr . a , 1.0 ) ; vec4 CE = u_proj_matrix * CD ;".split(" ")},
{type:"condition",a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE".split(" "),group:{type:"group",a:[{type:"textline",b:"float CF = CE . x ; float CG = CE . y ; float CH = CE . w ; cI . x = ( CF + CH ) / 2.0 ; cI . y = ( CG + CH ) / 2.0 ; cI . z = CH ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:"SHORE_SMOOTHING || REFLECTION_TYPE == REFL_PLANE || REFRACTIVE || ! DISABLE_FOG".split(" "),group:{type:"group",a:[{type:"textline",b:"lF = - CD . z / u_view_max_depth ;".split(" ")}]}}]},
{type:"textline",b:["gl_Position","=","CE",";","}"]}]};a["wireframe.glslf"]={type:"group",a:[{type:"define",name:"WM_OPAQUE_WIREFRAME",b:["0"]},{type:"define",name:"WM_TRANSPARENT_WIREFRAME",b:["1"]},{type:"define",name:"WM_FRONT_BACK_VIEW",b:["2"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"condition",a:[{type:"if",c:["!","DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"uniform int u_wireframe_mode ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},
{type:"textline",b:"varying vec3 BR ; const float BN = 1.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE_DYNAMIC"],group:{type:"group",a:[{type:"textline",b:"const vec3 BS = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const vec3 BS = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"const vec3 BT = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 BU = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 BV = vec3 ( 1.0 , 1.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"void main ( ) { vec3 BW = vec3 ( 0.0 ) ; float BX = 0.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"vec3 BY = sign ( BR - vec3 ( 0.02 * BN ) ) ; if ( BY . x < 0.0 || BY . y < 0.0 || BY . z < 0.0 ) { BW = BS ; BX = 1.0 ; } else discard ;".split(" ")}]}},{type:"elif",c:["WIREFRAME_QUALITY","==","0"],group:{type:"group",a:[{type:"textline",b:"vec3 BY = sign ( BR - vec3 ( 0.02 * BN ) ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { if ( BY . x < 0.0 || BY . y < 0.0 || BY . z < 0.0 ) BW = u_wireframe_edge_color ; else BW = BV ; BX = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { if ( BY . x < 0.0 || BY . y < 0.0 || BY . z < 0.0 ) BX = 1.0 ; else BX = 0.0 ; BW = u_wireframe_edge_color ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( BY . x < 0.0 || BY . y < 0.0 || BY . z < 0.0 ) BW = u_wireframe_edge_color ; else if ( gl_FrontFacing ) BW = BT ; else BW = BU ; BX = 1.0 ; }".split(" ")}]}},
{type:"elif",c:["WIREFRAME_QUALITY","==","1"],group:{type:"group",a:[{type:"extension",b:["GL_OES_standard_derivatives",":","enable"]},{type:"textline",b:"vec3 BZ = fwidth ( BR ) ; vec3 B_ = smoothstep ( vec3 ( 0.0 ) , BZ * BN , BR ) ; float Ca = min ( min ( B_ . x , B_ . y ) , B_ . z ) ; Ca = clamp ( Ca , 0.0 , 1.0 ) ; if ( u_wireframe_mode == WM_OPAQUE_WIREFRAME ) { BW = vec3 ( mix ( u_wireframe_edge_color , BV , Ca ) ) ; BX = 1.0 ; } else if ( u_wireframe_mode == WM_TRANSPARENT_WIREFRAME ) { BW = u_wireframe_edge_color ; BX = mix ( 1.0 , 0.0 , Ca ) ; } else if ( u_wireframe_mode == WM_FRONT_BACK_VIEW ) { if ( gl_FrontFacing ) BW = mix ( u_wireframe_edge_color , BT , Ca ) ; else BW = mix ( u_wireframe_edge_color , BU , Ca ) ; BX = 1.0 ; }".split(" ")}]}}]},
{type:"textline",b:["gx","(","BW",")",";"]},{type:"condition",a:[{type:"if",c:["ALPHA"],group:{type:"group",a:[{type:"textline",b:"gA ( BW , BX ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = vec4 ( BW , BX ) ; }".split(" ")}]};a["wireframe.glslv"]={type:"group",a:[{type:"var",name:"AU_QUALIFIER",b:["uniform"]},{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"MAX_BONES",b:["0"]},{type:"include",file:"math.glslv"},{type:"include",file:"to_world.glslv"},{type:"textline",b:"attribute vec3 a_position ; attribute vec3 a_normal ; attribute float a_polyindex ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","DEBUG_SPHERE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"textline",b:["attribute","float","a_bending_col_main",";"]},{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{type:"textline",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:["attribute","vec3","a_emitter_center",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["WIND_BEND","||","DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",
a:[{type:"textline",b:["attribute","vec3","a_position_next",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:["attribute","vec4","a_influence",";"]}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"const mat4 u_model_matrix = mat4 ( 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["uniform","mat4","u_model_matrix",";"]}]}}]},{type:"textline",b:"uniform mat4 u_proj_matrix ; uniform mat4 u_view_matrix ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","DEBUG_SPHERE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD","&&","BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS","||","BILLBOARD"],
group:{type:"group",a:[{type:"textline",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],
group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},{type:"textline",
b:["varying","vec3","BR",";"]},{type:"condition",a:[{type:"if",c:["!","DEBUG_SPHERE"],group:{type:"group",a:[{type:"include",file:"skin.glslv"},{type:"include",file:"wind_bending.glslv"},{type:"include",file:"dynamic_grass.glslv"}]}}]},{type:"textline",b:"void main ( ) { if ( a_polyindex == 0.0 ) BR = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) BR = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) BR = vec3 ( 0.0 , 0.0 , 1.0 ) ; vec3 BN = a_position ; vec3 BS = a_normal ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DEBUG_SPHERE"],group:{type:"group",a:[{type:"textline",b:"d BT = aA ( BN , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["VERTEX_ANIM"],group:{type:"group",a:[{type:"textline",b:"BN = mix ( BN , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"textline",b:"vec3 BU = vec3 ( 0.0 ) ; vec3 BV = vec3 ( 0.0 ) ; bK ( BN , BU , BV , BS ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","||","DYNAMIC_GRASS","||","BILLBOARD"],group:{type:"group",a:[{type:"textline",b:["vec3","BW","=","au_center_pos",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 BW = vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"d BT = ge ( BN , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , BW , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , u_view_matrix ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"vec3 BX = ( u_model_matrix * vec4 ( BW , 1.0 ) ) . xyz ;".split(" ")},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","&&","!","STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"mat4 BY = at ( u_camera_eye , BX , u_view_matrix , u_model_matrix ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 BY = an ( u_camera_eye , BX , u_view_matrix ) ;".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND","&&","BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"vec3 BZ = ( u_model_matrix * vec4 ( BW , 1.0 ) ) . xyz ; BY = BY * ac ( u_wind , u_time , u_jitter_amp , u_jitter_freq , BZ ) ;".split(" ")}]}}]},{type:"textline",b:"d BT = aA ( BN - BW , BW , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , BY ) ; BT . b = BX ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"d BT = aA ( BN , BW , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_matrix ) ;".split(" ")}]}}]}]}}]},
{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"cC ( BT . a , BT . b , BS ) ;".split(" ")}]}}]}]}}]},{type:"textline",b:"vec4 B_ = u_view_matrix * vec4 ( BT . a , 1.0 ) ; gl_Position = u_proj_matrix * B_ ; }".split(" ")}]};a["postprocessing/anaglyph.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; varying vec2 a ; void main ( ) { vec4 BN = texture2D ( u_sampler_left , a ) ; vec4 BS = texture2D ( u_sampler_right , a ) ; gl_FragColor = vec4 ( BN [ 0 ] , BS [ 1 ] , BS [ 2 ] , BN [ 3 ] + BS [ 3 ] ) ; }".split(" ")}]};
a["postprocessing/antialiasing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"AA_METHOD_PASS",b:["1"]},{type:"define",name:"AA_METHOD_FXAA_LIGHT",b:["2"]},{type:"define",name:"AA_METHOD_FXAA_QUALITY",b:["3"]},{type:"define",name:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{type:"define",name:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{type:"define",name:"FXAA_SPAN_MAX",b:["8.0"]},{type:"textline",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; varying vec2 a ; vec4 BU ( float BN , float BS ) { vec2 BT = a + vec2 ( BN , BS ) * u_texel_size ; return texture2D ( u_color , BT ) ; } float BY ( vec4 BV ) { vec3 BW = vec3 ( 0.299 , 0.587 , 0.114 ) ; float BX = dot ( BV . rgb , BW ) ; return BX ; } vec4 Cq ( ) { vec4 BZ = BU ( - 1.0 , - 1.0 ) ; vec4 B_ = BU ( 1.0 , - 1.0 ) ; vec4 Ca = BU ( - 1.0 , 1.0 ) ; vec4 Cb = BU ( 1.0 , 1.0 ) ; vec4 Cc = BU ( 0.0 , 0.0 ) ; float Cd = BY ( BZ ) ; float Ce = BY ( B_ ) ; float Cf = BY ( Ca ) ; float Cg = BY ( Cb ) ; float Ch = BY ( Cc ) ; float Ci = min ( Ch , min ( min ( Cd , Ce ) , min ( Cf , Cg ) ) ) ; float Cj = max ( Ch , max ( max ( Cd , Ce ) , max ( Cf , Cg ) ) ) ; vec2 Ck ; Ck . x = - ( ( Cd + Ce ) - ( Cf + Cg ) ) ; Ck . y = ( ( Cd + Cf ) - ( Ce + Cg ) ) ; float Cl = max ( ( Cd + Ce + Cf + Cg ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float Cm = 1.0 / ( min ( abs ( Ck . x ) , abs ( Ck . y ) ) + Cl ) ; Ck = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , Ck * Cm ) ) * u_texel_size ; vec4 Cn = 0.5 * ( texture2D ( u_color , a + Ck * ( 1.0 / 3.0 - 0.5 ) ) + texture2D ( u_color , a + Ck * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 Co = Cn * 0.5 + 0.25 * ( texture2D ( u_color , a + Ck * - 0.5 ) + texture2D ( u_color , a + Ck * 0.5 ) ) ; float Cp = BY ( Co ) ; if ( ( Cp < Ci ) || ( Cp > Cj ) ) return Cn ; else return Co ; }".split(" ")},
{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD",b:["(","1.0","/","6.0",")"]},{type:"define",name:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["(","1.0","/","12.0",")"]},{type:"define",name:"FXAA_QUALITY_SUBPIX",b:["(","3.0","/","4.0",")"]},{type:"textline",b:"vec4 Eb ( ) { vec2 Cr ; Cr . x = a . x ; Cr . y = a . y ; vec4 Cs = texture2D ( u_color , Cr ) ; vec4 Ct = BU ( 0.0 , 1.0 ) ; vec4 Cu = BU ( 1.0 , 0.0 ) ; vec4 Cv = BU ( 0.0 , - 1.0 ) ; vec4 Cw = BU ( - 1.0 , 0.0 ) ; float Cx = BY ( Ct ) ; float Cy = BY ( Cu ) ; float Cz = BY ( Cv ) ; float CA = BY ( Cw ) ; float CB = BY ( Cs ) ; float CC = max ( Cx , CB ) ; float CD = min ( Cx , CB ) ; float CE = max ( Cy , CC ) ; float CF = min ( Cy , CD ) ; float CG = max ( Cz , CA ) ; float CH = min ( Cz , CA ) ; float CI = max ( CG , CE ) ; float CJ = min ( CH , CF ) ; float CK = CI * FXAA_QUALITY_EDGE_THRESHOLD ; float CL = CI - CJ ; float CM = max ( FXAA_QUALITY_EDGE_THRESHOLD_MIN , CK ) ; bool CN = CL < CM ; if ( CN ) return Cs ; vec4 CO = BU ( - 1.0 , - 1.0 ) ; vec4 CP = BU ( 1.0 , 1.0 ) ; vec4 CQ = BU ( 1.0 , - 1.0 ) ; vec4 CR = BU ( - 1.0 , 1.0 ) ; float CS = BY ( CO ) ; float CT = BY ( CP ) ; float CU = BY ( CQ ) ; float CV = BY ( CR ) ; float CW = Cz + Cx ; float CX = CA + Cy ; float CY = 1.0 / CL ; float CZ = CW + CX ; float C_ = ( - 2.0 * CB ) + CW ; float Da = ( - 2.0 * CB ) + CX ; float Db = CU + CT ; float Dc = CS + CU ; float Dd = ( - 2.0 * Cy ) + Db ; float De = ( - 2.0 * Cz ) + Dc ; float Df = CS + CV ; float Dg = CV + CT ; float Dh = ( abs ( C_ ) * 2.0 ) + abs ( Dd ) ; float Di = ( abs ( Da ) * 2.0 ) + abs ( De ) ; float Dj = ( - 2.0 * CA ) + Df ; float Dk = ( - 2.0 * Cx ) + Dg ; float Dl = abs ( Dj ) + Dh ; float Dm = abs ( Dk ) + Di ; float Dn = Df + Db ; float Do = u_texel_size . x ; bool Dp = Dl >= Dm ; float Dq = CZ * 2.0 + Dn ; if ( ! Dp ) Cz = CA ; if ( ! Dp ) Cx = Cy ; if ( Dp ) Do = u_texel_size . y ; float Dr = ( Dq * ( 1.0 / 12.0 ) ) - CB ; float Ds = Cz - CB ; float Dt = Cx - CB ; float Du = Cz + CB ; float Dv = Cx + CB ; bool Dw = abs ( Ds ) >= abs ( Dt ) ; float Dx = max ( abs ( Ds ) , abs ( Dt ) ) ; if ( Dw ) Do = - Do ; float Dy = clamp ( abs ( Dr ) * CY , 0.0 , 1.0 ) ; vec2 Dz ; Dz . x = Cr . x ; Dz . y = Cr . y ; vec2 DA ; DA . x = ( ! Dp ) ? 0.0 : u_texel_size . x ; DA . y = ( Dp ) ? 0.0 : u_texel_size . y ; if ( ! Dp ) Dz . x += Do * 0.5 ; if ( Dp ) Dz . y += Do * 0.5 ; vec2 DB ; DB . x = Dz . x - DA . x ; DB . y = Dz . y - DA . y ; vec2 DC ; DC . x = Dz . x + DA . x ; DC . y = Dz . y + DA . y ; float DD = ( ( - 2.0 ) * Dy ) + 3.0 ; float DE = BY ( texture2D ( u_color , DB ) ) ; float DF = Dy * Dy ; float DG = BY ( texture2D ( u_color , DC ) ) ; if ( ! Dw ) Du = Dv ; float DH = Dx * 1.0 / 4.0 ; float DI = CB - Du * 0.5 ; float DJ = DD * DF ; bool DK = DI < 0.0 ; DE -= Du * 0.5 ; DG -= Du * 0.5 ; bool DL = abs ( DE ) >= DH ; bool DM = abs ( DG ) >= DH ; if ( ! DL ) DB . x -= DA . x * 1.5 ; if ( ! DL ) DB . y -= DA . y * 1.5 ; bool DN = ( ! DL ) || ( ! DM ) ; if ( ! DM ) DC . x += DA . x * 1.5 ; if ( ! DM ) DC . y += DA . y * 1.5 ; if ( DN ) { if ( ! DL ) DE = BY ( texture2D ( u_color , DB . xy ) ) ; if ( ! DM ) DG = BY ( texture2D ( u_color , DC . xy ) ) ; if ( ! DL ) DE = DE - Du * 0.5 ; if ( ! DM ) DG = DG - Du * 0.5 ; DL = abs ( DE ) >= DH ; DM = abs ( DG ) >= DH ; if ( ! DL ) DB . x -= DA . x * 2.0 ; if ( ! DL ) DB . y -= DA . y * 2.0 ; DN = ( ! DL ) || ( ! DM ) ; if ( ! DM ) DC . x += DA . x * 2.0 ; if ( ! DM ) DC . y += DA . y * 2.0 ; if ( DN ) { if ( ! DL ) DE = BY ( texture2D ( u_color , DB . xy ) ) ; if ( ! DM ) DG = BY ( texture2D ( u_color , DC . xy ) ) ; if ( ! DL ) DE = DE - Du * 0.5 ; if ( ! DM ) DG = DG - Du * 0.5 ; DL = abs ( DE ) >= DH ; DM = abs ( DG ) >= DH ; if ( ! DL ) DB . x -= DA . x * 2.0 ; if ( ! DL ) DB . y -= DA . y * 2.0 ; DN = ( ! DL ) || ( ! DM ) ; if ( ! DM ) DC . x += DA . x * 2.0 ; if ( ! DM ) DC . y += DA . y * 2.0 ; if ( DN ) { if ( ! DL ) DE = BY ( texture2D ( u_color , DB . xy ) ) ; if ( ! DM ) DG = BY ( texture2D ( u_color , DC . xy ) ) ; if ( ! DL ) DE = DE - Du * 0.5 ; if ( ! DM ) DG = DG - Du * 0.5 ; DL = abs ( DE ) >= DH ; DM = abs ( DG ) >= DH ; if ( ! DL ) DB . x -= DA . x * 4.0 ; if ( ! DL ) DB . y -= DA . y * 4.0 ; DN = ( ! DL ) || ( ! DM ) ; if ( ! DM ) DC . x += DA . x * 4.0 ; if ( ! DM ) DC . y += DA . y * 4.0 ; if ( DN ) { if ( ! DL ) DE = BY ( texture2D ( u_color , DB . xy ) ) ; if ( ! DM ) DG = BY ( texture2D ( u_color , DC . xy ) ) ; if ( ! DL ) DE = DE - Du * 0.5 ; if ( ! DM ) DG = DG - Du * 0.5 ; DL = abs ( DE ) >= DH ; DM = abs ( DG ) >= DH ; if ( ! DL ) DB . x -= DA . x * 2.0 ; if ( ! DL ) DB . y -= DA . y * 2.0 ; if ( ! DM ) DC . x += DA . x * 2.0 ; if ( ! DM ) DC . y += DA . y * 2.0 ; } } } } float DO = Cr . x - DB . x ; float DP = DC . x - Cr . x ; if ( ! Dp ) DO = Cr . y - DB . y ; if ( ! Dp ) DP = DC . y - Cr . y ; bool DQ = ( DE < 0.0 ) != DK ; float DR = ( DP + DO ) ; bool DS = ( DG < 0.0 ) != DK ; float DT = 1.0 / DR ; bool DU = DO < DP ; float DV = min ( DO , DP ) ; bool DW = DU ? DQ : DS ; float DX = DJ * DJ ; float DY = ( DV * ( - DT ) ) + 0.5 ; float DZ = DX * FXAA_QUALITY_SUBPIX ; float D_ = DW ? DY : 0.0 ; float Ea = max ( D_ , DZ ) ; if ( ! Dp ) Cr . x += Ea * Do ; if ( Dp ) Cr . y += Ea * Do ; return texture2D ( u_color , Cr ) ; }".split(" ")},
{type:"define",name:"FXAA_CONSOLE_EDGE_SHARPNESS",b:["8.0"]},{type:"define",name:"FXAA_CONSOLE_EDGE_THRESHOLD",b:["0.125"]},{type:"define",name:"FXAA_CONSOLE_EDGE_THRESHOLD_MIN",b:["0.05"]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["AA_METHOD","==","AA_METHOD_PASS"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = texture2D ( u_color , a ) ;".split(" ")}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_FXAA_LIGHT"],group:{type:"group",a:[{type:"textline",
b:"gl_FragColor = Cq ( ) ;".split(" ")}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_FXAA_QUALITY"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = Eb ( ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( 1.0 , 1.0 , 0.0 , 1.0 ) * texture2D ( u_color , a ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 a ; void main ( ) { vec2 BN = vec2 ( 0.0 , 0.0 ) ; vec2 BS = u_texel_size ; vec4 BT = texture2D ( u_color , a ) ; gl_FragColor = BT * 0.0875447373698 ; BN += BS ; gl_FragColor += texture2D ( u_color , a + BN ) * 0.0858112354248 ; gl_FragColor += texture2D ( u_color , a - BN ) * 0.0858112354248 ; BN += BS ; gl_FragColor += texture2D ( u_color , a + BN ) * 0.0808139781061 ; gl_FragColor += texture2D ( u_color , a - BN ) * 0.0808139781061 ; BN += BS ; gl_FragColor += texture2D ( u_color , a + BN ) * 0.0731235112908 ; gl_FragColor += texture2D ( u_color , a - BN ) * 0.0731235112908 ; BN += BS ; gl_FragColor += texture2D ( u_color , a + BN ) * 0.0635705267419 ; gl_FragColor += texture2D ( u_color , a - BN ) * 0.0635705267419 ; BN += BS ; gl_FragColor += texture2D ( u_color , a + BN ) * 0.0530985673112 ; gl_FragColor += texture2D ( u_color , a - BN ) * 0.0530985673112 ; BN += BS ; gl_FragColor += texture2D ( u_color , a + BN ) * 0.0426125984122 ; gl_FragColor += texture2D ( u_color , a - BN ) * 0.0426125984122 ; BN += BS ; gl_FragColor += texture2D ( u_color , a + BN ) * 0.0328565115809 ; gl_FragColor += texture2D ( u_color , a - BN ) * 0.0328565115809 ; BN += BS ; gl_FragColor += texture2D ( u_color , a + BN ) * 0.0243407024472 ; gl_FragColor += texture2D ( u_color , a - BN ) * 0.0243407024472 ; gl_FragColor = max ( 0.7 * BT , gl_FragColor ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; varying vec2 a ; void main ( ) { vec4 BN = texture2D ( u_main , a ) ; vec4 BS = texture2D ( u_bloom , a ) ; vec4 BT = BN ; BT += BS ; gl_FragColor = vec4 ( BT . rgb , 1.0 ) ; }".split(" ")}]};a["postprocessing/compositing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"PI_4",
b:["0.785398163"]},{type:"textline",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; varying vec2 a ; void main ( ) { vec4 BN = texture2D ( u_color , a ) ; vec3 BS = BN . rgb ; if ( u_brightness < 0.0 ) BS = BS * ( 1.0 + u_brightness ) ; else BS = BS + ( ( 1.0 - BS ) * u_brightness ) ; BS = ( BS - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * PI_4 ) ) + 0.5 ; BS *= u_exposure ; vec3 BT = vec3 ( 0.299 , 0.587 , 0.114 ) ; float BU = dot ( BS , BT ) ; BS = mix ( vec3 ( BU ) , BS , u_saturation ) ; gl_FragColor = vec4 ( BS , BN . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; varying vec2 a ; void main ( ) { gl_FragColor = gK ( clamp ( BZ ( u_depth , a , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};a["postprocessing/dof.glslf"]=
{type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"textline",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front ; uniform float u_dof_rear ; uniform vec2 u_camera_range ; varying vec2 a ; void main ( ) { vec4 B_ = texture2D ( u_sharp , a ) ; if ( u_dof_dist > 0.0 ) { float Ca = BZ ( u_depth , a , u_camera_range ) ; Ca *= u_view_max_depth ; float Cb ; if ( Ca < u_dof_dist ) Cb = ( u_dof_dist - Ca ) / u_dof_front ; else Cb = ( Ca - u_dof_dist ) / u_dof_rear ; Cb = clamp ( Cb , 0.0 , 1.0 ) ; vec4 Cc = texture2D ( u_blurred , a ) ; gl_FragColor = mix ( B_ , Cc , Cb ) ; } else gl_FragColor = B_ ; }".split(" ")}]};
a["postprocessing/glow.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; varying vec2 a ; void main ( ) { vec4 BN = texture2D ( u_src_color , a ) ; vec4 B_ = texture2D ( u_glow_mask_small , a ) ; vec4 Ca = texture2D ( u_glow_mask_large , a ) ; gl_FragColor = BN ; if ( Ca . a != 0.0 ) { float Cb = u_glow_mask_large_coeff * Ca . a ; Cb = clamp ( Cb , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , Ca . rgb / Ca . a , Cb ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , Cb ) ; } if ( B_ . a != 0.0 ) { float Cc = u_glow_mask_small_coeff * B_ . a ; Cc = clamp ( Cc , 0.0 , 1.0 ) ; gl_FragColor . rgb = mix ( gl_FragColor . rgb , B_ . rgb / B_ . a , Cc ) ; gl_FragColor . a = mix ( gl_FragColor . a , 1.0 , Cc ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},{type:"include",file:"procedural.glslf"},{type:"include",file:"pack.glslf"},{type:"var",name:"STEPS_PER_PASS",b:["0.0"]},{type:"textline",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},{type:"condition",
a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"textline",b:["uniform","vec2","u_camera_range",";"]},{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"varying float B_ ; varying vec2 Ca ;".split(" ")}]}}]}]}}]},{type:"textline",b:"varying vec2 a ; varying vec4 Cb ; void main ( ) { vec2 Cc = ( Cb . xy - a ) ; float Cd = length ( Cc ) ; vec2 Ce = u_radial_blur_step * Cc / Cd ; float Cf = Cd / u_radial_blur_step ; Ce *= min ( Cf , STEPS_PER_PASS ) / STEPS_PER_PASS ; Cf = max ( Cf , STEPS_PER_PASS ) ; vec2 Cg = a ; float Ch = 0.0 ; for ( float Ci = 0.0 ; Ci < STEPS_PER_PASS ; Ci += 1.0 ) { if ( Ci <= Cf ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"textline",b:"float Cj = BZ ( u_input , Cg , u_camera_range ) ; Ch += max ( ( 1.0 - pow ( Cd , 0.3 ) ) * step ( 0.9 , Cj ) , 0.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec4 Ck = texture2D ( u_input , Cg ) ; Ch += gO ( Ck ) ;".split(" ")}]}}]},{type:"textline",b:"} Cg += Ce ; }".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA","&&","WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",
b:"vec2 Cl = a + Ca ; float Cm = dd ( vec2 ( 2.5 * ( Cl . x ) , 2.5 * ( Cl . y ) + 1.0 * u_time ) ) . x + 0.75 * dd ( vec2 ( 5.0 * ( Cl . x ) - 0.66 * u_time , 5.0 * ( Cl . y ) + 0.66 * u_time ) ) . x + 0.5 * dJ ( vec2 ( 7.5 * ( Cl . x ) + 0.33 * u_time , 7.5 * ( Cl . y ) - 0.33 * u_time ) ) ; Cm *= clamp ( 1.2 - sqrt ( 0.2 * Cd ) , 0.0 , 1.0 ) * B_ ; Ch = max ( Cm , Ch ) ;".split(" ")}]}}]},{type:"textline",b:"gl_FragColor = gK ( Ch / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]=
{type:"group",a:[{type:"include",file:"math.glslv"},{type:"textline",b:"attribute vec2 a_bb_vertex ; uniform mat4 u_view_matrix ; uniform mat4 u_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ; varying float B_ ; varying vec2 Ca ;".split(" ")}]}}]}]}}]},{type:"textline",
b:"varying vec2 a ; varying vec4 Cb ; void main ( ) { a = a_bb_vertex + 0.5 ; vec3 BN = normalize ( u_sun_direction ) ; Cb = u_proj_matrix * u_view_matrix * vec4 ( BN , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["DEPTH_RGBA","&&","WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"if ( u_cam_water_depth < 0.0 ) { B_ = 1.0 ; vec3 Cc = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 Cd = j ( u_camera_quat , Cc ) ; Cd = normalize ( Cd ) ; float Ce = dot ( Cd , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float Cf = atan ( Cd . x , Cd . z ) ; Ca = vec2 ( - Cf , acos ( Ce ) ) ; } else { B_ = 0.0 ; }".split(" ")}]}}]},
{type:"textline",b:"Cb . xy = 0.5 * ( Cb . xy / Cb . w + 1.0 ) ; Cb += 99999.0 * step ( Cb . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; varying vec2 a ; void main ( ) { vec4 BN = texture2D ( u_main , a ) ; vec3 Cc = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; gv ( BN . rgb ) ; float Cd = gO ( texture2D ( u_god_rays , a ) ) ; vec3 Ce = BN . rgb + u_god_rays_intensity * vec3 ( Cd ) * Cc ; gx ( Ce ) ; gl_FragColor . rgb = Ce ; gl_FragColor . a = BN . a ; }".split(" ")}]};
a["postprocessing/luminance.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_input ; varying vec2 a ; void main ( ) { vec4 BN = texture2D ( u_input , a ) ; float Cc = dot ( BN . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; gl_FragColor = vec4 ( vec3 ( Cc ) , 1.0 ) ; }".split(" ")}]};a["postprocessing/luminance_av.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_input ; void main ( ) { float BN ; float Cc = 0.0 ; for ( float Cd = 0.025 ; Cd < 1.0 ; Cd += 0.05 ) for ( float Ce = 0.025 ; Ce < 1.0 ; Ce += 0.05 ) { BN = max ( texture2D ( u_input , vec2 ( Cd , Ce ) ) . r , 0.01 ) ; Cc += log ( BN ) ; } float Cf = exp ( Cc / 400.0 ) ; gl_FragColor = vec4 ( vec3 ( Cf ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; varying vec2 a ; varying float Cc ; void main ( ) { float Cd = texture2D ( u_average_lum , vec2 ( 0.5 ) ) . r ; float Ce = texture2D ( u_luminance , a ) . r ; vec4 Cf = texture2D ( u_main , a ) ; float Cg = Ce / Cd ; float Ch = u_bloom_edge_lum ; gl_FragColor = Cf * max ( Cg - Ch , 0.0 ) * Cc ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec2 a_position ; uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; varying vec2 a ; varying float Cc ; const vec3 BN = vec3 ( 0.0 , 1.0 , 0.0 ) ; void Ck ( in vec4 Cd , in vec3 Ce , out vec3 Cf ) { float Cg = Cd . w * Ce . x + Cd . y * Ce . z - Cd . z * Ce . y ; float Ch = Cd . w * Ce . y + Cd . z * Ce . x - Cd . x * Ce . z ; float Ci = Cd . w * Ce . z + Cd . x * Ce . y - Cd . y * Ce . x ; float Cj = - Cd . x * Ce . x - Cd . y * Ce . y - Cd . z * Ce . z ; Cf . x = Cg * Cd . w - Cj * Cd . x - Ch * Cd . z + Ci * Cd . y ; Cf . y = Ch * Cd . w - Cj * Cd . y - Ci * Cd . x + Cg * Cd . z ; Cf . z = Ci * Cd . w - Cj * Cd . z - Cg * Cd . y + Ch * Cd . x ; } void main ( ) { a = 2.0 * a_position ; vec3 Cl ; Ck ( u_camera_quat , BN , Cl ) ; Cc = dot ( - Cl , u_sun_direction ) * u_bloom_key ; Cc *= max ( sign ( u_sun_direction . y ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"textline",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; varying vec2 a ; float BN = 0.0042 ; void main ( ) { vec4 Cd = texture2D ( u_mb_tex_curr , a ) ; vec4 Ce = texture2D ( u_mb_tex_accum , a ) ; if ( length ( Cd - Ce ) > u_motion_blur_decay_threshold ) { vec4 Cf = ( 1.0 - u_motion_blur_exp ) * Cd + u_motion_blur_exp * Ce ; vec4 Cg = Cf - Ce ; vec4 Ch = Cd - Ce ; vec4 Ci = min ( max ( abs ( Cg ) , vec4 ( BN ) ) , abs ( Ch ) ) * sign ( Cg ) ; gl_FragColor = Ce + Ci ; } else { gl_FragColor = Cd ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"textline",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; varying vec2 a ; void main ( ) { vec4 BN = texture2D ( u_outline_src , a ) ; gl_FragColor = BN ; if ( u_draw_outline != 0.0 ) { vec4 Cd = texture2D ( u_outline_mask , a ) ; vec4 Ce = texture2D ( u_outline_mask_blurred , a ) ; float Cf = Ce . a - Cd . a ; if ( Cf != 0.0 ) { float Cg = smoothstep ( 0.0 , 1.0 , Ce . a ) ; if ( Cd . a == 0.0 ) { vec3 Ch = u_outline_color ; gx ( Ch ) ; vec4 Ci = vec4 ( clamp ( Ch , 0.0 , 1.0 ) , 1.0 ) ; gl_FragColor = mix ( BN , Ci , Cg ) ; } } } }".split(" ")}]};
a["postprocessing/postprocessing.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"define",name:"POST_EFFECT_NONE",b:["1"]},{type:"define",name:"POST_EFFECT_GRAYSCALE",b:["2"]},{type:"define",name:"POST_EFFECT_X_BLUR",b:["3"]},{type:"define",name:"POST_EFFECT_Y_BLUR",b:["4"]},{type:"define",name:"POST_EFFECT_X_EXTEND",b:["5"]},{type:"define",name:"POST_EFFECT_Y_EXTEND",b:["6"]},{type:"textline",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; varying vec2 a ; void main ( ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["POST_EFFECT","==","POST_EFFECT_NONE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = texture2D ( u_color , a ) ;".split(" ")}]}},{type:"elif",c:["POST_EFFECT","==","POST_EFFECT_GRAYSCALE"],group:{type:"group",a:[{type:"textline",b:"vec4 BN = texture2D ( u_color , a ) ; gl_FragColor . rgb = vec3 ( ( BN . r + BN . g + BN . b ) / 3.0 ) ; gl_FragColor . a = 1.0 ;".split(" ")}]}},{type:"elif",c:"POST_EFFECT == POST_EFFECT_X_BLUR || POST_EFFECT == POST_EFFECT_Y_BLUR".split(" "),
group:{type:"group",a:[{type:"textline",b:"vec2 Cd = vec2 ( 0.0 , 0.0 ) ; vec2 Ce = u_texel_size ; vec4 Cf ; Cf = texture2D ( u_color , a ) ; gl_FragColor = Cf * 0.2270270270 ; Cd += Ce ; Cf = texture2D ( u_color , a + Cd ) ; gl_FragColor += Cf * 0.1945945946 ; Cf = texture2D ( u_color , a - Cd ) ; gl_FragColor += Cf * 0.1945945946 ; Cd += Ce ; Cf = texture2D ( u_color , a + Cd ) ; gl_FragColor += Cf * 0.1216216216 ; Cf = texture2D ( u_color , a - Cd ) ; gl_FragColor += Cf * 0.1216216216 ; Cd += Ce ; Cf = texture2D ( u_color , a + Cd ) ; gl_FragColor += Cf * 0.0540540541 ; Cf = texture2D ( u_color , a - Cd ) ; gl_FragColor += Cf * 0.0540540541 ; Cd += Ce ; Cf = texture2D ( u_color , a + Cd ) ; gl_FragColor += Cf * 0.0162162162 ; Cf = texture2D ( u_color , a - Cd ) ; gl_FragColor += Cf * 0.0162162162 ;".split(" ")}]}},
{type:"elif",c:"POST_EFFECT == POST_EFFECT_X_GLOW_BLUR || POST_EFFECT == POST_EFFECT_Y_GLOW_BLUR".split(" "),group:{type:"group",a:[{type:"textline",b:"vec2 Cd = vec2 ( 0.0 , 0.0 ) ; vec2 Ce = u_texel_size ; vec4 Cf ; Cf = texture2D ( u_color , a ) ; gl_FragColor = Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.152507 ; Cd += Ce ; Cf = texture2D ( u_color , a + Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.141763 ; Cf = texture2D ( u_color , a - Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.141763 ; Cd += Ce ; Cf = texture2D ( u_color , a + Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.113861 ; Cf = texture2D ( u_color , a - Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.113861 ; Cd += Ce ; Cf = texture2D ( u_color , a + Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.079019 ; Cf = texture2D ( u_color , a - Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.079019 ; Cd += Ce ; Cf = texture2D ( u_color , a + Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.047383 ; Cf = texture2D ( u_color , a - Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.047383 ; Cd += Ce ; Cf = texture2D ( u_color , a + Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.024549 ; Cf = texture2D ( u_color , a - Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.024549 ; Cd += Ce ; Cf = texture2D ( u_color , a + Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.01099 ; Cf = texture2D ( u_color , a - Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.01099 ; Cd += Ce ; Cf = texture2D ( u_color , a + Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.00425 ; Cf = texture2D ( u_color , a - Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.00425 ; Cd += Ce ; Cf = texture2D ( u_color , a + Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.00142 ; Cf = texture2D ( u_color , a - Cd ) ; gl_FragColor += Cf * ( 1.0 - step ( 0.0 , - Cf . a ) ) * 0.00142 ; gl_FragColor = clamp ( gl_FragColor , 0.0 , 1.0 ) ;".split(" ")}]}},
{type:"elif",c:"POST_EFFECT == POST_EFFECT_X_EXTEND || POST_EFFECT == POST_EFFECT_Y_EXTEND".split(" "),group:{type:"group",a:[{type:"textline",b:"vec2 Ce = u_texel_size ; vec4 Cf = texture2D ( u_color , a ) ; gl_FragColor = Cf ; if ( Cf . a == 0.0 ) { Cf = texture2D ( u_color , a + Ce ) ; if ( Cf . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , Cf . a ) ; else { Cf = texture2D ( u_color , a - Ce ) ; if ( Cf . a > 0.0 ) gl_FragColor = vec4 ( 1.0 , 1.0 , 1.0 , Cf . a ) ; } }".split(" ")}]}}]},{type:"textline",
b:["}"]}]};a["postprocessing/postprocessing.glslv"]={type:"group",a:[{type:"textline",b:"attribute vec2 a_position ; varying vec2 a ; void main ( ) { a = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"gamma.glslf"},{type:"include",file:"pack.glslf"},{type:"define",name:"SMAA_RESOLVE",b:["1"]},{type:"define",name:"SMAA_EDGE_DETECTION",
b:["2"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{type:"define",name:"AA_METHOD_SMAA_LOW",b:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",b:["4"]},{type:"textline",b:["uniform","sampler2D","u_color",";"]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_RESOLVE"],group:{type:"group",a:[{type:"textline",
b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_blend",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION","&&","SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",
b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},{type:"textline",b:"uniform vec2 u_texel_size ; varying vec2 a ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",
b:["varying","vec4","Cd",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"varying vec4 Ce ; varying vec4 Cf ; varying vec4 Cg ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","Ch",";"]}]}}]},{type:"condition",a:[{type:"if",c:["AA_METHOD","==","AA_METHOD_SMAA_LOW"],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.15"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",
b:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_SMAA_MEDIUM"],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{type:"define",name:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_SMAA_HIGH"],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",
b:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_SMAA_ULTRA"],group:{type:"group",a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.05"]},{type:"define",name:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["16"]},{type:"define",name:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_THRESHOLD",group:{type:"group",
a:[{type:"define",name:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_DEPTH_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS_DIAG",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_CORNER_ROUNDING",group:{type:"group",a:[{type:"define",name:"SMAA_CORNER_ROUNDING",
b:["25"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",group:{type:"group",a:[{type:"define",name:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_THRESHOLD",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{type:"condition",
a:[{type:"ifndef",name:"SMAA_PREDICATION_SCALE",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_PREDICATION_STRENGTH",group:{type:"group",a:[{type:"define",name:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_REPROJECTION",group:{type:"group",a:[{type:"define",name:"SMAA_REPROJECTION",b:["0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_REPROJECTION_WEIGHT_SCALE",group:{type:"group",
a:[{type:"define",name:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{type:"condition",a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{type:"define",name:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{type:"define",name:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{type:"define",name:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",
")"]},{type:"define",name:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{type:"define",name:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{type:"define",name:"SMAA_CORNER_ROUNDING_NORM",b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION"],group:{type:"group",a:[{type:"textline",b:"vec3 Cn ( vec2 Ci , sampler2D Cj ) { float Ck = texture2D ( Cj , Ci ) . r ; float Cl = texture2D ( Cj , Ce . xy ) . r ; float Cm = texture2D ( Cj , Ce . zw ) . r ; return vec3 ( Ck , Cl , Cm ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION"],group:{type:"group",a:[{type:"textline",b:"vec2 Ct ( vec2 Co , sampler2D Cp ) { vec3 Cq = Cn ( Co , Cp ) ; vec2 Cr = abs ( Cq . xx - Cq . yz ) ; vec2 Cs = step ( SMAA_PREDICATION_THRESHOLD , Cr ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * Cs ) ; }".split(" ")}]}}]},{type:"textline",b:"void Cx ( bvec2 Cu , inout vec2 Cv , vec2 Cw ) { if ( Cu . x ) Cv . x = Cw . x ; if ( Cu . y ) Cv . y = Cw . y ; } void Cx ( bvec4 Cy , inout vec4 Cz , vec4 CA ) { Cx ( Cy . xy , Cz . xy , CA . xy ) ; Cx ( Cy . zw , Cz . zw , CA . zw ) ; } vec2 CC ( vec2 CB ) { return sign ( CB ) * floor ( abs ( CB ) + .5 ) ; } vec4 CC ( vec4 CD ) { return sign ( CD ) * floor ( abs ( CD ) + .5 ) ; }".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION"],group:{type:"group",a:[{type:"textline",b:"vec2 CU ( vec2 CE , sampler2D CF".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","CG"]}]}}]},{type:"textline",b:[")","{"]},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",b:"vec2 CH = Ct ( CE , CG ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",
b:"vec2 CH = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{type:"textline",b:"vec3 CI = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float CJ = dot ( texture2D ( CF , CE ) . rgb , CI ) ; float CK = dot ( texture2D ( CF , Ce . xy ) . rgb , CI ) ; float CL = dot ( texture2D ( CF , Ce . zw ) . rgb , CI ) ; vec4 CM ; CM . xy = abs ( CJ - vec2 ( CK , CL ) ) ; vec2 CN = step ( CH , CM . xy ) ; if ( dot ( CN , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float CO = dot ( texture2D ( CF , Cf . xy ) . rgb , CI ) ; float CP = dot ( texture2D ( CF , Cf . zw ) . rgb , CI ) ; CM . zw = abs ( CJ - vec2 ( CO , CP ) ) ; vec2 CQ = max ( CM . xy , CM . zw ) ; float CR = dot ( texture2D ( CF , Cg . xy ) . rgb , CI ) ; float CS = dot ( texture2D ( CF , Cg . zw ) . rgb , CI ) ; CM . zw = abs ( vec2 ( CK , CL ) - vec2 ( CR , CS ) ) ; CQ = max ( CQ . xy , CM . zw ) ; float CT = max ( CQ . x , CQ . y ) ; CN . xy *= step ( CT , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * CM . xy ) ; return CN ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["!","SMAA_DISABLE_DIAG_DETECTION"],group:{type:"group",a:[{type:"textline",b:"vec2 CW ( vec2 CV ) { CV . r = CV . r * abs ( 5.0 * CV . r - 5.0 * 0.75 ) ; return CC ( CV ) ; } vec4 CW ( vec4 CX ) { CX . rb = CX . rb * abs ( 5.0 * CX . rb - 5.0 * 0.75 ) ; return CC ( CX ) ; } vec2 De ( sampler2D CY , vec2 CZ , vec2 C_ , out vec2 Da ) { vec4 Db = vec4 ( CZ , - 1.0 , 1.0 ) ; vec3 Dc = vec3 ( u_texel_size , 1.0 ) ; for ( int Dd = 0 ; Dd < SMAA_MAX_SEARCH_STEPS_DIAG ; Dd ++ ) { if ( Db . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && Db . w > 0.9 ) { Db . xyz += Dc * vec3 ( C_ , 1.0 ) ; Da = texture2D ( CY , Db . xy , 0.0 ) . rg ; Db . w = dot ( Da , vec2 ( 0.5 , 0.5 ) ) ; } } return Db . zw ; } vec2 Dm ( sampler2D Df , vec2 Dg , vec2 Dh , out vec2 Di ) { vec4 Dj = vec4 ( Dg , - 1.0 , 1.0 ) ; Dj . x += 0.25 * u_texel_size . x ; vec3 Dk = vec3 ( u_texel_size , 1.0 ) ; for ( int Dl = 0 ; Dl < SMAA_MAX_SEARCH_STEPS_DIAG ; Dl ++ ) { if ( Dj . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && Dj . w > 0.9 ) { Dj . xyz = Dk * vec3 ( Dh , 1.0 ) + Dj . xyz ; Di = texture2D ( Df , Dj . xy , 0.0 ) . rg ; Di = CW ( Di ) ; Dj . w = dot ( Di , vec2 ( 0.5 , 0.5 ) ) ; } } return Dj . zw ; } vec2 Ds ( sampler2D Dn , vec2 Do , vec2 Dp , float Dq ) { vec2 Dr = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * Dp + Do ; Dr = SMAA_AREATEX_PIXEL_SIZE * Dr + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; Dr . x += 0.5 ; Dr . y += SMAA_AREATEX_SUBTEX_SIZE * Dq ; return texture2D ( Dn , Dr , 0.0 ) . rg ; } vec2 DH ( sampler2D Dt , sampler2D Du , vec2 Dv , vec2 Dw , vec4 Dx ) { vec2 Dy = vec2 ( 0.0 , 0.0 ) ; vec4 Dz ; vec2 DA ; if ( Dw . r > 0.0 ) { Dz . xz = De ( Dt , Dv , vec2 ( - 1.0 , 1.0 ) , DA ) ; Dz . x += float ( DA . y > 0.9 ) ; } else Dz . xz = vec2 ( 0.0 , 0.0 ) ; Dz . yw = De ( Dt , Dv , vec2 ( 1.0 , - 1.0 ) , DA ) ; if ( Dz . x + Dz . y > 2.0 ) { vec4 DB = vec4 ( - Dz . x + 0.25 , Dz . x , Dz . y , - Dz . y - 0.25 ) * u_texel_size . xyxy + Dv . xyxy ; vec4 DC ; DC . xy = texture2D ( Dt , DB . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; DC . zw = texture2D ( Dt , DB . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; DC . yxwz = CW ( DC . xyzw ) ; vec2 DD = vec2 ( 2.0 , 2.0 ) * DC . xz + DC . yw ; Cx ( bvec2 ( step ( 0.9 , Dz . zw ) ) , DD , vec2 ( 0.0 , 0.0 ) ) ; Dy += Ds ( Du , Dz . xy , DD , Dx . z ) ; } Dz . xz = Dm ( Dt , Dv , vec2 ( - 1 , - 1 ) , DA ) ; if ( texture2D ( Dt , Dv + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { Dz . yw = Dm ( Dt , Dv , vec2 ( 1 , 1 ) , DA ) ; Dz . y += float ( DA . y > 0.9 ) ; } else Dz . yw = vec2 ( 0.0 , 0.0 ) ; if ( Dz . x + Dz . y > 2.0 ) { vec4 DE = vec4 ( - Dz . x , - Dz . x , Dz . y , Dz . y ) * u_texel_size . xyxy + Dv . xyxy ; vec4 DF ; DF . x = texture2D ( Dt , DE . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; DF . y = texture2D ( Dt , DE . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; DF . zw = texture2D ( Dt , DE . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 DG = vec2 ( 2.0 , 2.0 ) * DF . xz + DF . yw ; Cx ( bvec2 ( step ( 0.9 , Dz . zw ) ) , DG , vec2 ( 0 , 0 ) ) ; Dy += Ds ( Du , Dz . xy , DG , Dx . w ) . gr ; } return Dy ; }".split(" ")}]}}]},
{type:"textline",b:"float DN ( sampler2D DI , vec2 DJ , float DK ) { vec2 DL = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 DM = SMAA_SEARCHTEX_SIZE * vec2 ( DK , 1.0 ) ; DL += vec2 ( - 1.0 , 1.0 ) ; DM += vec2 ( 0.5 , - 0.5 ) ; DL *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; DM *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return texture2D ( DI , DL * DJ + DM , 0.0 ) . r ; } float DV ( sampler2D DO , sampler2D DP , vec2 DQ , float DR ) { vec2 DS = vec2 ( 0.0 , 1.0 ) ; for ( int DT = 0 ; DT < SMAA_MAX_SEARCH_STEPS ; DT ++ ) { if ( DQ . x > DR && DS . g > 0.8281 && DS . r == 0.0 ) { DS = texture2D ( DO , DQ , 0.0 ) . rg ; DQ = - vec2 ( 2.0 , 0.0 ) * u_texel_size + DQ ; } } float DU = - ( 255.0 / 127.0 ) * DN ( DP , DS , 0.0 ) + 3.25 ; return u_texel_size . x * DU + DQ . x ; } float Ec ( sampler2D DW , sampler2D DX , vec2 DY , float DZ ) { vec2 D_ = vec2 ( 0.0 , 1.0 ) ; for ( int Ea = 0 ; Ea < SMAA_MAX_SEARCH_STEPS ; Ea ++ ) { if ( DY . x < DZ && D_ . g > 0.8281 && D_ . r == 0.0 ) { D_ = texture2D ( DW , DY , 0.0 ) . rg ; DY = vec2 ( 2.0 , 0.0 ) * u_texel_size + DY ; } } float Eb = - ( 255.0 / 127.0 ) * DN ( DX , D_ , 0.5 ) + 3.25 ; return - u_texel_size . x * Eb + DY . x ; } float Ek ( sampler2D Ed , sampler2D Ee , vec2 Ef , float Eg ) { vec2 Eh = vec2 ( 1.0 , 0.0 ) ; for ( int Ei = 0 ; Ei < SMAA_MAX_SEARCH_STEPS ; Ei ++ ) { if ( Ef . y > Eg && Eh . r > 0.8281 && Eh . g == 0.0 ) { Eh = texture2D ( Ed , Ef , 0.0 ) . rg ; Ef = - vec2 ( 0.0 , 2.0 ) * u_texel_size + Ef ; } } float Ej = - ( 255.0 / 127.0 ) * DN ( Ee , Eh . gr , 0.0 ) + 3.25 ; return u_texel_size . y * Ej + Ef . y ; } float Es ( sampler2D El , sampler2D Em , vec2 En , float Eo ) { vec2 Ep = vec2 ( 1.0 , 0.0 ) ; for ( int Eq = 0 ; Eq < SMAA_MAX_SEARCH_STEPS ; Eq ++ ) { if ( En . y < Eo && Ep . r > 0.8281 && Ep . g == 0.0 ) { Ep = texture2D ( El , En , 0.0 ) . rg ; En = vec2 ( 0.0 , 2.0 ) * u_texel_size + En ; } } float Er = - ( 255.0 / 127.0 ) * DN ( Em , Ep . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * Er + En . y ; } vec2 Ez ( sampler2D Et , vec2 Eu , float Ev , float Ew , float Ex ) { vec2 Ey = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * CC ( 4.0 * vec2 ( Ev , Ew ) ) + Eu ; Ey = SMAA_AREATEX_PIXEL_SIZE * Ey + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; Ey . y = SMAA_AREATEX_SUBTEX_SIZE * Ex + Ey . y ; return texture2D ( Et , Ey , 0.0 ) . rg ; } void EH ( sampler2D EA , inout vec2 EB , vec4 EC , vec2 ED ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["!","SMAA_DISABLE_CORNER_DETECTION"],group:{type:"group",a:[{type:"textline",b:"vec2 EE = step ( ED . xy , ED . yx ) ; vec2 EF = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * EE ; EF /= EE . x + EE . y ; vec2 EG = vec2 ( 1.0 , 1.0 ) ; EG . x -= EF . x * texture2D ( EA , EC . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; EG . x -= EF . y * texture2D ( EA , EC . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; EG . y -= EF . x * texture2D ( EA , EC . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; EG . y -= EF . y * texture2D ( EA , EC . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; EB *= clamp ( EG , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"} void EP ( sampler2D EI , inout vec2 EJ , vec4 EK , vec2 EL ) {".split(" ")},{type:"condition",a:[{type:"if",c:["!","SMAA_DISABLE_CORNER_DETECTION"],group:{type:"group",a:[{type:"textline",b:"vec2 EM = step ( EL . xy , EL . yx ) ; vec2 EN = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * EM ; EN /= EM . x + EM . y ; vec2 EO = vec2 ( 1.0 , 1.0 ) ; EO . x -= EN . x * texture2D ( EI , EK . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; EO . x -= EN . y * texture2D ( EI , EK . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; EO . y -= EN . x * texture2D ( EI , EK . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; EO . y -= EN . y * texture2D ( EI , EK . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; EJ *= clamp ( EO , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",b:"vec4 Fh ( vec2 EQ , vec2 ER , sampler2D ES , sampler2D ET , sampler2D EU , vec4 EV ) { vec4 EW = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 EX = texture2D ( ES , EQ ) . rg ; if ( EX . g > 0.0 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["!","SMAA_DISABLE_DIAG_DETECTION"],group:{type:"group",a:[{type:"textline",b:"EW . rg = DH ( ES , ET , EQ , EX , EV ) ; if ( EW . r == - EW . g ) {".split(" ")}]}}]},
{type:"textline",b:"vec2 EY ; vec3 EZ ; EZ . x = DV ( ES , EU , Ce . xy , Cg . x ) ; EZ . y = Cf . y ; EY . x = EZ . x ; float E_ = texture2D ( ES , EZ . xy , 0.0 ) . r ; EZ . z = Ec ( ES , EU , Ce . zw , Cg . y ) ; EY . y = EZ . z ; EY = abs ( CC ( EY / u_texel_size . xx - ER . xx ) ) ; vec2 Fa = sqrt ( EY ) ; float Fb = texture2D ( ES , EZ . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; EW . rg = Ez ( ET , Fa , E_ , Fb , EV . y ) ; EZ . y = EQ . y ; EH ( ES , EW . rg , EZ . xyzy , EY ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","SMAA_DISABLE_DIAG_DETECTION"],group:{type:"group",a:[{type:"textline",b:"} else EX . r = 0.0 ;".split(" ")}]}}]},{type:"textline",b:"} if ( EX . r > 0.0 ) { vec2 Fc ; vec3 Fd ; Fd . y = Ek ( ES , EU , Cf . xy , Cg . z ) ; Fd . x = Ce . x ; Fc . x = Fd . y ; float Fe = texture2D ( ES , Fd . xy , 0.0 ) . g ; Fd . z = Es ( ES , EU , Cf . zw , Cg . w ) ; Fc . y = Fd . z ; Fc = abs ( CC ( Fc / u_texel_size . yy - ER . yy ) ) ; vec2 Ff = sqrt ( Fc ) ; float Fg = texture2D ( ES , Fd . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; EW . ba = Ez ( ET , Ff , Fe , Fg , EV . x ) ; Fd . x = EQ . x ; EP ( ES , EW . ba , Fd . xyxz , Fc ) ; } return EW ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",b:"vec4 Fy ( vec2 Fi , sampler2D Fj , sampler2D Fk".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","Fl"]}]}}]},{type:"textline",b:") { vec4 Fm ; Fm . x = texture2D ( Fk , Cd . xy ) . a ; Fm . y = texture2D ( Fk , Cd . zw ) . g ; Fm . wz = texture2D ( Fk , Fi ) . xz ; if ( dot ( Fm , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 Fn = texture2D ( Fj , Fi , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"vec4 Fo = texture2D ( Fl , a ) ; vec2 Fp = 2.0 * gW ( Fo ) - 1.0 ; Fn . a = sqrt ( 2.0 * length ( Fp ) ) ;".split(" ")}]}}]},{type:"textline",b:"return Fn ; } else { bool Fq = max ( Fm . x , Fm . z ) > max ( Fm . y , Fm . w ) ; vec4 Fr = vec4 ( 0.0 , Fm . y , 0.0 , Fm . w ) ; vec2 Fs = Fm . yw ; Cx ( bvec4 ( Fq , Fq , Fq , Fq ) , Fr , vec4 ( Fm . x , 0.0 , Fm . z , 0.0 ) ) ; Cx ( bvec2 ( Fq , Fq ) , Fs , Fm . xz ) ; Fs /= dot ( Fs , vec2 ( 1.0 , 1.0 ) ) ; vec4 Ft = Fr * vec4 ( u_texel_size , - u_texel_size ) + Fi . xyxy ; vec4 Fu = Fs . x * texture2D ( Fj , Ft . xy , 0.0 ) ; Fu += Fs . y * texture2D ( Fj , Ft . zw , 0.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"vec4 Fv = texture2D ( Fl , Ft . xy ) ; vec2 Fw = 2.0 * gW ( Fv ) - 1.0 ; vec2 Fx = Fs . x * Fw ; Fv = texture2D ( Fl , Ft . zw ) ; Fw = 2.0 * gW ( Fv ) - 1.0 ; Fx += Fs . y * Fw ; Fu . a = sqrt ( 2.0 * length ( Fx ) ) ;".split(" ")}]}}]},{type:"textline",b:["return","Fu",";","}","}"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_RESOLVE"],group:{type:"group",a:[{type:"textline",b:"vec4 FK ( vec2 Fz , sampler2D FA , sampler2D FB".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","sampler2D","FC"]}]}}]},{type:"textline",b:[")","{"]},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:"vec4 FD = texture2D ( FC , a ) ; vec2 FE ; FE = 2.0 * gW ( FD ) - 1.0 ; vec4 FF = texture2D ( FA , Fz ) ; vec4 FG = texture2D ( FB , Fz - FE ) ; float FH = abs ( FF . a * FF . a - FG . a * FG . a ) / 2.0 ; float FI = 0.5 * clamp ( 1.0 - sqrt ( FH ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 FJ = mix ( FF , FG , FI ) ; FJ . a = 1.0 ; return FJ ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"vec4 FF = texture2D ( FA , Fz ) ; vec4 FG = texture2D ( FB , Fz ) ; return mix ( FF , FG , 0.5 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["void","main","(",")","{"]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION"],group:{type:"group",a:[{type:"textline",b:"vec4 FL = vec4 ( CU ( a , u_color".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PREDICATION"],group:{type:"group",a:[{type:"textline",
b:[",","u_predication_tex"]}]}}]},{type:"textline",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",b:"vec4 FL = Fh ( a , Ch , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",b:"vec4 FL = Fy ( a , u_color , u_blend".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],
group:{type:"group",a:[{type:"textline",b:[",","u_velocity_tex"]}]}}]},{type:"textline",b:[")",";"]}]}},{type:"elif",c:["SMAA_PASS","==","SMAA_RESOLVE"],group:{type:"group",a:[{type:"textline",b:"vec4 FL = vec4 ( FK ( a , u_color , u_color_prev".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_REPROJECTION"],group:{type:"group",a:[{type:"textline",b:[",","u_velocity_tex"]}]}}]},{type:"textline",b:[")",")",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec4 FL = texture2D ( u_color , a ) ;".split(" ")}]}}]},
{type:"textline",b:["gl_FragColor","=","FL",";","}"]}]};a["postprocessing/smaa.glslv"]={type:"group",a:[{type:"define",name:"SMAA_EDGE_DETECTION",b:["1"]},{type:"define",name:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["2"]},{type:"define",name:"SMAA_NEIGHBORHOOD_BLENDING",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_LOW",b:["1"]},{type:"define",name:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{type:"define",name:"AA_METHOD_SMAA_HIGH",b:["3"]},{type:"define",name:"AA_METHOD_SMAA_ULTRA",b:["4"]},{type:"textline",b:"attribute vec2 a_position ; uniform vec2 u_texel_size ; varying vec2 a ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",b:["varying","vec4","Cd",";"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"varying vec4 Ce ; varying vec4 Cf ; varying vec4 Cg ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",b:["varying","vec2","Ch",";"]}]}}]},{type:"condition",a:[{type:"if",c:["AA_METHOD","==","AA_METHOD_SMAA_LOW"],
group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_SMAA_MEDIUM"],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_SMAA_HIGH"],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{type:"elif",c:["AA_METHOD","==","AA_METHOD_SMAA_ULTRA"],group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{type:"condition",
a:[{type:"ifndef",name:"SMAA_MAX_SEARCH_STEPS",group:{type:"group",a:[{type:"define",name:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION"],group:{type:"group",a:[{type:"textline",b:"void Ci ( vec2 BN ) { Ce = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + BN . xyxy ; Cf = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + BN . xyxy ; Cg = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + BN . xyxy ; }".split(" ")}]}},
{type:"elif",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",b:"void Cl ( vec2 Cj , out vec2 Ck ) { Ck = Cj / u_texel_size ; Ce = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + Cj . xyxy ; Cf = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + Cj . xyxy ; Cg = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( Ce . xz , Cf . yw ) ; }".split(" ")}]}},{type:"elif",c:["SMAA_PASS",
"==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",b:"void Cn ( vec2 Cm ) { Cd = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + Cm . xyxy ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { a = 2.0 * a_position ;".split(" ")},{type:"condition",a:[{type:"if",c:["SMAA_PASS","==","SMAA_EDGE_DETECTION"],group:{type:"group",a:[{type:"textline",b:["Ci","(","a",")",";"]}]}},{type:"elif",c:["SMAA_PASS","==","SMAA_BLENDING_WEIGHT_CALCULATION"],group:{type:"group",a:[{type:"textline",
b:"Cl ( a , Ch ) ;".split(" ")}]}},{type:"elif",c:["SMAA_PASS","==","SMAA_NEIGHBORHOOD_BLENDING"],group:{type:"group",a:[{type:"textline",b:["Cn","(","a",")",";"]}]}}]},{type:"textline",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"include",file:"depth_fetch.glslf"},
{type:"include",file:"procedural.glslf"},{type:"define",name:"SSAO_QUALITY_8",b:["1"]},{type:"define",name:"SSAO_QUALITY_16",b:["2"]},{type:"define",name:"SSAO_QUALITY_24",b:["3"]},{type:"define",name:"SSAO_QUALITY_32",b:["4"]},{type:"textline",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; varying vec2 a ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; float Cj ( in vec2 Ci ) { return BZ ( u_depth , Ci , u_camera_range ) ; } void main ( ) { float Ck = texture2D ( u_color , a ) . r ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SSAO_WHITE"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( Ck , 1.0 , 0.0 , 1.0 ) ; return ;".split(" ")}]}}]},{type:"textline",b:"vec3 Cl = normalize ( 2.0 * texture2D ( u_ssao_special_tex , a * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float Cm = Cj ( a ) ; float Cn = Cm * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_QUALITY","==","SSAO_QUALITY_8"],group:{type:"group",a:[{type:"textline",b:"const float Co = 8.0 ; const int Cp = 1 ;".split(" ")}]}},
{type:"elif",c:["SSAO_QUALITY","==","SSAO_QUALITY_16"],group:{type:"group",a:[{type:"textline",b:"const float Co = 16.0 ; const int Cp = 2 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","==","SSAO_QUALITY_24"],group:{type:"group",a:[{type:"textline",b:"const float Co = 24.0 ; const int Cp = 3 ;".split(" ")}]}},{type:"elif",c:["SSAO_QUALITY","==","SSAO_QUALITY_32"],group:{type:"group",a:[{type:"textline",b:"const float Co = 32.0 ; const int Cp = 4 ;".split(" ")}]}}]},{type:"textline",b:"float Cq = u_ssao_radius_increase * 0.001 ; const float Cr = 1.0 + 2.4 / Co ; float Cs = 0.0 ; for ( int Ct = 0 ; Ct < Cp ; Ct ++ ) for ( int Cu = - 1 ; Cu <= 1 ; Cu += 2 ) for ( int Cv = - 1 ; Cv <= 1 ; Cv += 2 ) for ( int Cw = - 1 ; Cw <= 1 ; Cw += 2 ) { vec3 Cx = reflect ( normalize ( vec3 ( Cu , Cv , Cw ) ) , Cl ) * ( Cq *= Cr ) ; vec3 Cy = vec3 ( a , Cn ) ; Cy += vec3 ( Cx . xy , Cx . z * Cn * 2.0 ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"Cy . z -= 1.4 * ( Cy . z - Cn ) * step ( Cn , Cy . z ) ;".split(" ")}]}}]},{type:"textline",b:"float Cz = Cj ( Cy . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float CA = clamp ( ( Cn - Cz ) / Cz , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"Cs += mix ( 1.0 , CA , step ( Cz , Cy . z ) ) ;".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:"Cs += mix ( step ( Cy . z , Cz ) , 0.5 , CA ) ;".split(" ")}]}}]},{type:"textline",b:"} Cs = Cs / Co ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_HEMISPHERE"],group:{type:"group",a:[{type:"textline",b:"Cs = clamp ( Cs * Cs + 0.6 * Cs , 0.0 , 1.0 ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"Cs = clamp ( Cs * Cs + Cs , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:"float CB = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * Cm ) ; Cs = mix ( 1.0 , Cs , CB ) ; gl_FragColor = vec4 ( Ck , Cs , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/ssao_blur.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","sampler2D",";"]},{type:"include",file:"precision_statement.glslf"},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"include",file:"depth_fetch.glslf"}]}}]},{type:"textline",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; varying vec2 a ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",
a:[{type:"textline",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float Cj ( in vec2 Ci ) { return BZ ( u_depth , Ci , u_camera_range ) ; }".split(" ")}]}}]},{type:"textline",b:"void main ( ) { float Ck = 0.0 ;".split(" ")},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"float Cl = Cj ( a ) ; float Cm = 0.0 ; float Cn = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{type:"textline",b:"vec2 Co = vec2 ( - 2.0 ) ; for ( int Cp = 0 ; Cp < 4 ; ++ Cp ) { for ( int Cq = 0 ; Cq < 4 ; ++ Cq ) { vec2 Cr = ( Co + vec2 ( float ( Cp ) , float ( Cq ) ) ) * u_texel_size ; float Cs = texture2D ( u_ssao_mask , a + Cr ) . g ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"float Ct = Cj ( a + Cr ) ; float Cu = 1.0 - clamp ( abs ( Ct - Cl ) * Cn , 0.0 , 1.0 ) ; Ck += Cs * Cu ; Cm += Cu ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["Ck","+=","Cs",";"]}]}}]},{type:"textline",b:["}","}"]},{type:"condition",a:[{type:"if",c:["SSAO_BLUR_DEPTH"],group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , a ) . r , Ck / Cm , 0.0 , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"gl_FragColor = vec4 ( texture2D ( u_ssao_mask , a ) . r , Ck / 16.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["postprocessing/velocity.glslf"]={type:"group",a:[{type:"include",file:"precision_statement.glslf"},{type:"include",file:"pack.glslf"},{type:"textline",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; varying vec2 a ; void main ( ) { float BN = texture2D ( u_depth , a ) . x ; vec4 Ci = vec4 ( a * 2.0 - 1.0 , 2.0 * BN - 1.0 , 1.0 ) ; vec4 Cj = u_view_proj_inverse * Ci ; vec4 Ck = Cj / Cj . w ; vec4 Cl = u_view_proj_prev * Ck ; Cl /= Cl . w ; vec2 Cm = ( Ci . xy - Cl . xy ) / 4.0 + 0.5 ; Cm = clamp ( Cm , 0.0 , 1.0 ) ; gl_FragColor = gK ( Cm ) ; }".split(" ")}]};
a["include/precision_statement.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"textline",b:["precision","PRECISION","float",";"]}]};a["include/math.glslv"]={type:"group",a:[{type:"var",name:"EPSILON",b:["0.0001"]},{type:"textline",b:"float b = 0.0 ; float c = 1.0 ; struct d { vec3 a ; vec3 b ; vec3 c ; vec3 d ; vec3 e ; vec3 f ; } ; bool g ( vec3 e , vec3 f ) { return any ( lessThan ( abs ( e - f ) , vec3 ( EPSILON ) ) ) ; } vec3 j ( in vec4 h , in vec3 i ) { return i + 2.0 * cross ( h . xyz , cross ( h . xyz , i ) + h . w * i ) ; } vec4 l ( in vec4 k ) { return vec4 ( - k . xyz , k . w ) / dot ( k , k ) ; } vec3 q ( vec4 m , vec4 n , vec4 o ) { vec3 p = o . xyz * m . w ; p = j ( n , p ) ; p += m . xyz * o . w ; return p ; } vec3 w ( vec4 r , vec4 s , vec4 t ) { vec3 u = t . xyz - r . xyz * t . w ; vec4 v = l ( s ) ; u = j ( v , u ) ; u /= r . w ; return u ; } mat4 x ( ) { return mat4 ( c , b , b , b , b , c , b , b , b , b , c , b , b , b , b , c ) ; } mat4 z ( float y ) { return mat4 ( c , b , b , b , b , cos ( y ) , sin ( y ) , b , b , - sin ( y ) , cos ( y ) , b , b , b , b , c ) ; } mat4 B ( float A ) { return mat4 ( cos ( A ) , b , - sin ( A ) , b , b , c , b , b , sin ( A ) , b , cos ( A ) , b , b , b , b , c ) ; } mat4 D ( float C ) { return mat4 ( cos ( C ) , sin ( C ) , b , b , - sin ( C ) , cos ( C ) , b , b , b , b , c , b , b , b , b , c ) ; } d F ( in d E ) { return d ( E . a , E . b , normalize ( E . c ) , normalize ( E . d ) , normalize ( E . e ) , E . f ) ; }".split(" ")}]};
a["include/to_world.glslv"]={type:"group",a:[{type:"define",name:"SKIN_SLERP",b:["0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"define",name:"MAX_BILLBOARD_ANGLE",b:["(","M_PI","/","4.0",")"]},{type:"textline",b:"const vec3 G = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:"BILLBOARD_SPHERICAL || ! BILLBOARD && ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW )".split(" "),group:{type:"group",a:[{type:"textline",b:"mat4 N ( vec3 H , mat4 I ) { vec3 J = vec3 ( I [ 0 ] [ 0 ] , I [ 1 ] [ 0 ] , I [ 2 ] [ 0 ] ) ; vec3 L = vec3 ( I [ 0 ] [ 1 ] , I [ 1 ] [ 1 ] , I [ 2 ] [ 1 ] ) ; vec3 M = vec3 ( I [ 0 ] [ 2 ] , I [ 1 ] [ 2 ] , I [ 2 ] [ 2 ] ) ; L = cross ( M , J ) ; J = normalize ( J ) ; L = normalize ( L ) ; M = normalize ( M ) ; return mat4 ( vec4 ( J , 0.0 ) , vec4 ( L , 0.0 ) , vec4 ( M , 0.0 ) , vec4 ( H , 1.0 ) ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 T ( vec3 O , vec3 P ) { vec3 Q = O - P ; Q . y = 0.0 ; vec3 R = cross ( G , Q ) ; vec3 S = cross ( Q , R ) ; R = normalize ( R ) ; S = normalize ( S ) ; Q = normalize ( Q ) ; return mat4 ( vec4 ( R , 0.0 ) , vec4 ( S , 0.0 ) , vec4 ( Q , 0.0 ) , vec4 ( P , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["BILLBOARD_JITTERED"],group:{type:"group",a:[{type:"textline",b:"mat4 ac ( in vec3 U , float V , float W , float X , vec3 Y ) { float Z = fract ( length ( Y ) / 0.17 ) ; float _ = X + Z / 10.0 ; float aa = Z ; if ( X != 0.0 ) aa /= X ; U *= 1.0 + 0.5 * sin ( V ) ; float ab = length ( U ) * W * sin ( 2.0 * 3.14 * V * _ + aa ) ; return D ( ab ) ; }".split(" ")}]}}]},
{type:"textline",b:"mat4 an ( in vec3 ad , in vec3 ae , in mat4 af ) {".split(" ")},{type:"condition",a:[{type:"if",c:"BILLBOARD_SPHERICAL || ! BILLBOARD && ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW )".split(" "),group:{type:"group",a:[{type:"textline",b:"mat4 ag = N ( ae , af ) ;".split(" ")}]}},{type:"elif",c:["BILLBOARD_RANDOM"],group:{type:"group",a:[{type:"textline",b:"float ah = fract ( ( ae . x * 1.43 + ae . y * 0.123 + ae . z * 6.1 ) ) ; float ai = 2.0 * M_PI * ah ; vec3 aj = normalize ( vec3 ( af [ 0 ] [ 2 ] , 0.0 , af [ 2 ] [ 2 ] ) ) ; float ak = acos ( aj [ 2 ] ) ; if ( aj [ 0 ] < 0.0 ) ak = 2.0 * M_PI - ak ; float al = ak - ai ; if ( al < 0.0 ) al = 2.0 * M_PI + al ; float am = ai ; if ( al <= MAX_BILLBOARD_ANGLE ) am += al ; else if ( al <= M_PI - MAX_BILLBOARD_ANGLE ) am += MAX_BILLBOARD_ANGLE * ( 2.0 * al - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( al <= M_PI + MAX_BILLBOARD_ANGLE ) am += al - M_PI ; else if ( al <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) am += MAX_BILLBOARD_ANGLE * ( 2.0 * al - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else am += al - 2.0 * M_PI ; mat4 ag = B ( am ) ; ag [ 3 ] = vec4 ( ae , 1.0 ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"mat4 ag = T ( ad , ae ) ;".split(" ")}]}}]},{type:"textline",b:["return","ag",";","}"]},{type:"condition",a:[{type:"if",c:["BILLBOARD_PRES_GLOB_ORIENTATION","&&","!","STATIC_BATCH"],group:{type:"group",a:[{type:"textline",b:"mat4 at ( in vec3 ao , in vec3 ap , in mat4 aq , mat4 ar ) { mat4 as = an ( ao , ap , aq ) ; ar [ 3 ] = vec4 ( 0.0 , 0.0 , 0.0 , 1.0 ) ; as = as * ar ; return as ; }".split(" ")}]}}]},{type:"textline",b:"d aA ( in vec3 au , in vec3 av , in vec3 aw , in vec3 ax , in vec3 ay , in mat4 az ) { au = ( az * vec4 ( au , 1.0 ) ) . xyz ; av = ( az * vec4 ( av , 1.0 ) ) . xyz ; aw = ( az * vec4 ( aw , 0.0 ) ) . xyz ; ax = ( az * vec4 ( ax , 0.0 ) ) . xyz ; ay = ( az * vec4 ( ay , 0.0 ) ) . xyz ; return F ( d ( au , av , aw , ax , ay , vec3 ( 0.0 ) ) ) ; }".split(" ")}]};
a["include/scale_texcoord.glslv"]={type:"group",a:[{type:"textline",b:"vec2 aD ( vec2 aB , vec3 aC ) { return ( aB + 0.5 ) * aC . xy - 0.5 ; }".split(" ")}]};a["include/skin.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["SKINNED"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"vec4 aM ( in vec4 aE , in vec4 aF , in float aG ) { float aH = aE [ 0 ] * aF [ 0 ] + aE [ 1 ] * aF [ 1 ] + aE [ 2 ] * aF [ 2 ] + aE [ 3 ] * aF [ 3 ] ; if ( aH < 0.0 ) { aF *= - 1.0 ; aH = - aH ; } if ( abs ( aH ) >= 1.0 ) return aE ; float aI = acos ( aH ) ; float aJ = sqrt ( 1.0 - aH * aH ) ; if ( abs ( aJ ) < 0.001 ) return vec4 ( aE * 0.5 + aF * 0.5 ) ; float aK = sin ( ( 1.0 - aG ) * aI ) / aJ ; float aL = sin ( aG * aI ) / aJ ; return aE * aK + aF * aL ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"vec3 bb ( in vec3 aN , in vec4 aO , in vec4 aP , in vec4 aQ , in vec4 aR , in float aS ) {".split(" ")},{type:"condition",a:[{type:"if",c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"vec4 aT = aM ( aO , aP , aS ) ; vec4 aU = mix ( aQ , aR , aS ) ; vec3 aV = j ( aT , aN ) ; vec3 aW = aV * aU . w + aU . xyz ; return aW ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 aX = q ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( aN , 1.0 ) ) ; vec3 aY = j ( aO , aX ) ; vec3 aZ = j ( aP , aX ) ; vec3 a_ = aY * aQ . w + aQ . xyz ; vec3 ba = aZ * aR . w + aR . xyz ; vec3 aW = mix ( a_ , ba , aS ) ; return w ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( aW , 1.0 ) ) ;".split(" ")}]}}]},
{type:"textline",b:"} vec3 bl ( in vec3 bc , in vec4 bd , in vec4 be , in float bf ) { vec3 bg = q ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( bc , 0.0 ) ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["SKIN_SLERP"],group:{type:"group",a:[{type:"textline",b:"vec4 bh = aM ( bd , be , bf ) ; vec3 bi = j ( bh , bg ) ; return w ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( bi , 0.0 ) ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 bj = j ( bd , bg ) ; vec3 bk = j ( be , bg ) ; vec3 bi = mix ( bj , bk , bf ) ; return w ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( bi , 0.0 ) ) ;".split(" ")}]}}]},
{type:"textline",b:["}"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 bb ( in vec3 bm , in vec4 bn , in vec4 bo ) { vec3 bp = q ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( bm , 1.0 ) ) ; vec3 bq = j ( bn , bp ) ; vec3 br = bq * bo . w + bo . xyz ; return w ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( br , 1.0 ) ) ; } vec3 bl ( in vec3 bs , in vec4 bt ) { vec3 bu = q ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( bs , 0.0 ) ) ; vec3 bv = j ( bt , bu ) ; return w ( u_arm_rel_trans , u_arm_rel_quat , vec4 ( bv , 0.0 ) ) ; }".split(" ")}]}}]},
{type:"textline",b:"void bK ( inout vec3 bw , inout vec3 bx , inout vec3 by , inout vec3 bz ) {".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:["float","bA","=","u_frame_factor",";"]}]}}]},{type:"textline",b:"if ( a_influence . y > 0.0 ) { vec3 bB = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 bC = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 bD = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 bE = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 bF = a_influence ; for ( int bG = 0 ; bG < 4 ; bG ++ ) { int bH = int ( bF [ bG ] ) ; float bI = fract ( bF [ bG ] ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"bB += bI * bb ( bw , u_quatsb [ bH ] , u_quatsa [ bH ] , u_transb [ bH ] , u_transa [ bH ] , bA ) ; bC += bI * bl ( bx , u_quatsb [ bH ] , u_quatsa [ bH ] , bA ) ; bD += bI * bl ( by , u_quatsb [ bH ] , u_quatsa [ bH ] , bA ) ; bE += bI * bl ( bz , u_quatsb [ bH ] , u_quatsa [ bH ] , bA ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"bB += bI * bb ( bw , u_quatsb [ bH ] , u_transb [ bH ] ) ; bC += bI * bl ( bx , u_quatsb [ bH ] ) ; bD += bI * bl ( by , u_quatsb [ bH ] ) ; bE += bI * bl ( bz , u_quatsb [ bH ] ) ;".split(" ")}]}}]},
{type:"textline",b:"} bw = bB ; bx = bC ; by = bD ; bz = bE ; } if ( ! ( a_influence . y > 0.0 ) ) { int bJ = int ( a_influence [ 0 ] - 1.0 ) ; if ( bJ > - 1 ) {".split(" ")},{type:"condition",a:[{type:"if",c:["FRAMES_BLENDING"],group:{type:"group",a:[{type:"textline",b:"bw = bb ( bw , u_quatsb [ bJ ] , u_quatsa [ bJ ] , u_transb [ bJ ] , u_transa [ bJ ] , bA ) ; bx = bl ( bx , u_quatsb [ bJ ] , u_quatsa [ bJ ] , bA ) ; by = bl ( by , u_quatsb [ bJ ] , u_quatsa [ bJ ] , bA ) ; bz = bl ( bz , u_quatsb [ bJ ] , u_quatsa [ bJ ] , bA ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"bw = bb ( bw , u_quatsb [ bJ ] , u_transb [ bJ ] ) ; bx = bl ( bx , u_quatsb [ bJ ] ) ; by = bl ( by , u_quatsb [ bJ ] ) ; bz = bl ( bz , u_quatsb [ bJ ] ) ;".split(" ")}]}}]},{type:"textline",b:["}","}","}"]}]}}]}]};a["include/wind_bending.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["WIND_BEND"],group:{type:"group",a:[{type:"textline",b:"void bZ ( inout vec3 bL , in vec3 bM , in float bN , in float bO , in float bP , in vec3 bQ , in float bR ) { float bS = length ( bM ) ; float bT = bO * ( 1.0 + 0.1 * fract ( bS ) ) ; float bU = bN * bR * ( 1.0 + sin ( 2.0 * 3.14 * bP * bT + bS ) ) ; float bV = ( bL . y - bM . y ) * abs ( bU ) ; bV += 1.0 ; bV *= bV ; bV = bV * bV - bV ; vec3 bW = bL ; bW . xz += bQ . xz * bV * sign ( bU ) ; vec3 bX = bW - bM ; if ( all ( equal ( bX , vec3 ( 0.0 ) ) ) ) bL = bM ; else { float bY = length ( bL - bM ) ; bL = bM + normalize ( bX ) * bY ; } }".split(" ")},
{type:"condition",a:[{type:"if",c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"vec4 ca ( vec4 b_ ) { return b_ * b_ * ( 3.0 - 2.0 * b_ ) ; } vec4 cc ( vec4 cb ) { return abs ( fract ( cb + 0.5 ) * 2.0 - 1.0 ) ; } vec4 ce ( vec4 cd ) { return ca ( cc ( cd ) ) ; } void cv ( inout vec3 cf , in float cg , in vec3 ch , in vec3 ci , in vec3 cj , in float ck , in float cl , in float cm , in vec3 cn ) { float co ; float cp ; float cq ; vec2 cr ; vec4 cs ; vec2 ct ; vec3 cu ; co = dot ( cj , vec3 ( 1.0 ) ) ; cp = co + cn . g ; cq = dot ( cf , vec3 ( cn . g ) ) ; cr = ( cg + vec2 ( cq , cp ) ) ; cs = ( ( fract ( ( cr . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( ci ) * ck ; cs = ce ( cs ) ; ct = cs . xz + cs . yw ; ct . y = 0.5 - ct . y ; cu = ct . xyx * cn . rbr * vec3 ( cl * ch . x , cm , cl * ch . z ) ; cf += cu ; }".split(" ")}]}}]},
{type:"textline",b:"void cC ( inout vec3 cw , inout vec3 cx , in vec3 cy ) { vec3 cz = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:"vec3 cA = cx ; vec3 cB = a_emitter_center ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 cA = cw ; vec3 cB = cx ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["MAIN_BEND_COL"],group:{type:"group",a:[{type:"condition",a:[{type:"if",
c:["DETAIL_BEND"],group:{type:"group",a:[{type:"textline",b:"cv ( cA , u_time , cy , cz , cB , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail ) ;".split(" ")}]}}]},{type:"textline",b:"bZ ( cA , cB , au_wind_bending_amp , au_wind_bending_freq , u_time , cz , a_bending_col_main ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"bZ ( cA , cB , au_wind_bending_amp , au_wind_bending_freq , u_time , cz , 1.0 ) ;".split(" ")}]}}]},{type:"condition",
a:[{type:"if",c:["BEND_CENTER_ONLY"],group:{type:"group",a:[{type:"textline",b:"cw += cA - cx ; cx = cA ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"cw = cA ; cx = cB ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/std_enums.glsl"]={type:"group",a:[{type:"define",name:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{type:"define",name:"TEXTURE_COORDS_NORMAL",b:["2"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{type:"define",name:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{type:"define",name:"SHADOW_SRC_NONE",b:["1"]},{type:"define",name:"SHADOW_SRC_DEPTH",b:["2"]},{type:"define",name:"SHADOW_SRC_MASK",b:["3"]},{type:"define",name:"SHADOW_DST_NONE",b:["1"]},{type:"define",name:"SHADOW_DST_DEPTH",b:["2"]},{type:"define",name:"SHADOW_DST_MASK",b:["3"]},{type:"define",name:"NO_SHADOWS",b:["1"]},{type:"define",name:"SHADOW_CASTING",b:["2"]},{type:"define",name:"SHADOW_MASK_GENERATION",b:["3"]},{type:"define",name:"SHADOW_MAPPING_OPAQUE",b:["4"]},{type:"define",
name:"SHADOW_MAPPING_BLEND",b:["5"]},{type:"define",name:"SPECULAR_PHONG",b:["1"]},{type:"define",name:"SPECULAR_COOKTORR",b:["2"]},{type:"define",name:"SPECULAR_WARDISO",b:["3"]},{type:"define",name:"SPECULAR_BLINN",b:["4"]},{type:"define",name:"DIFFUSE_LAMBERT",b:["1"]},{type:"define",name:"DIFFUSE_OREN_NAYAR",b:["2"]},{type:"define",name:"DIFFUSE_FRESNEL",b:["3"]},{type:"define",name:"DIFFUSE_MINNAERT",b:["4"]},{type:"define",name:"DIFFUSE_TOON",b:["5"]},{type:"define",name:"MAPPING_TYPE_TEXTURE",
b:["0.0"]},{type:"define",name:"MAPPING_TYPE_POINT",b:["1.0"]},{type:"define",name:"MAPPING_TYPE_VECTOR",b:["2.0"]},{type:"define",name:"MAPPING_TYPE_NORMAL",b:["3.0"]},{type:"define",name:"MTEX_BLEND",b:["0"]},{type:"define",name:"MTEX_ADD",b:["1"]},{type:"define",name:"MTEX_SUB",b:["2"]},{type:"define",name:"MTEX_MUL",b:["3"]},{type:"define",name:"MTEX_SCREEN",b:["4"]},{type:"define",name:"MTEX_OVERLAY",b:["5"]},{type:"define",name:"MTEX_DIFF",b:["6"]},{type:"define",name:"MTEX_DIV",b:["7"]},{type:"define",
name:"MTEX_DARK",b:["8"]},{type:"define",name:"MTEX_LIGHT",b:["9"]},{type:"define",name:"MTEX_BLEND_HUE",b:["10"]},{type:"define",name:"MTEX_BLEND_SAT",b:["11"]},{type:"define",name:"MTEX_BLEND_VAL",b:["12"]},{type:"define",name:"MTEX_BLEND_COLOR",b:["13"]},{type:"define",name:"MTEX_SOFT_LIGHT",b:["14"]},{type:"define",name:"MTEX_LIN_LIGHT",b:["15"]},{type:"define",name:"REFL_NONE",b:["0"]},{type:"define",name:"REFL_MIRRORMAP",b:["1"]},{type:"define",name:"REFL_PLANE",b:["2"]},{type:"define",name:"REFL_CUBE",
b:["3"]}]};a["include/procedural.glslf"]={type:"group",a:[{type:"textline",b:"float cJ = 0.0 ; float cK = 1.0 ; vec4 cM ( vec4 cL ) { return cL - floor ( cL * ( cK / 289.0 ) ) * 289.0 ; } vec3 cM ( vec3 cN ) { return cN - floor ( cN * ( cK / 289.0 ) ) * 289.0 ; } vec2 cM ( vec2 cO ) { return cO - floor ( cO * ( cK / 289.0 ) ) * 289.0 ; } vec4 cQ ( vec4 cP ) { return cP - floor ( cP * ( cK / 7.0 ) ) * 7.0 ; } vec4 cS ( vec4 cR ) { return cM ( ( 34.0 * cR + 5.0 ) * cR ) ; }".split(" ")},{type:"define",
name:"K",b:["0.142857142857"]},{type:"define",name:"K2",b:["0.0714285714285"]},{type:"define",name:"JITTER",b:["0.7"]},{type:"textline",b:"vec2 dd ( vec2 cT ) { vec2 cU = cM ( floor ( cT ) ) ; vec2 cV = fract ( cT ) ; vec4 cW = cV . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 cX = cV . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 cY = cS ( cU . x + vec4 ( cJ , cK , cJ , cK ) ) ; cY = cS ( cY + cU . y + vec4 ( cJ , cJ , cK , cK ) ) ; vec4 cZ = cQ ( cY ) * K + K2 ; vec4 c_ = cQ ( floor ( cY * K ) ) * K + K2 ; vec4 da = cW + JITTER * cZ ; vec4 db = cX + JITTER * c_ ; vec4 dc = da * da + db * db ;".split(" ")},
{type:"condition",a:[{type:"if",c:["1"],group:{type:"group",a:[{type:"textline",b:"dc . xy = min ( dc . xy , dc . zw ) ; dc . x = min ( dc . x , dc . y ) ; return dc . xx ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"dc . xy = ( dc . x < dc . y ) ? dc . xy : dc . yx ; dc . xz = ( dc . x < dc . z ) ? dc . xz : dc . zx ; dc . xw = ( dc . x < dc . w ) ? dc . xw : dc . wx ; dc . y = min ( dc . y , dc . z ) ; dc . y = min ( dc . y , dc . w ) ; return sqrt ( dc . xy ) ;".split(" ")}]}}]},
{type:"textline",b:"} mat3 dt ( vec2 de , float df ) { vec2 dg = cM ( floor ( de ) ) ; vec2 dh = fract ( de ) ; vec4 di = dh . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 dj = dh . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 dk = cS ( dg . x + vec4 ( cJ , cK , cJ , cK ) ) ; dk = cS ( dk + dg . y + vec4 ( cJ , cJ , cK , cK ) ) ; vec4 dl = cQ ( dk ) * K + K2 ; vec4 dm = cQ ( floor ( dk * K ) ) * K + K2 ; vec4 dn = di + JITTER * dl ; vec4 dp = dj + JITTER * dm ; vec4 dq = dn * dn + dp * dp ; dn += df ; dp += df ; vec4 dr = dn * dn + dp * dp ; dn += df ; dp += df ; vec4 ds = dn * dn + dp * dp ; dq . xy = min ( dq . xy , dq . zw ) ; dq . x = min ( dq . x , dq . y ) ; dr . xy = min ( dr . xy , dr . zw ) ; dr . x = min ( dr . x , dr . y ) ; ds . xy = min ( ds . xy , ds . zw ) ; ds . x = min ( ds . x , ds . y ) ; return mat3 ( dq . xx , cJ , dr . xx , cJ , ds . xx , cJ ) ; } vec3 dv ( vec3 du ) { return cM ( ( ( du * 34.0 ) + cK ) * du ) ; } float dJ ( vec2 dw ) { const vec4 dx = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 dy = floor ( dw + dot ( dw , dx . yy ) ) ; vec2 dz = dw - dy + dot ( dy , dx . xx ) ; vec2 dA ; dA = ( dz . x > dz . y ) ? vec2 ( cK , cJ ) : vec2 ( cJ , cK ) ; vec4 dB = dz . xyxy + dx . xxzz ; dB . xy -= dA ; dy = cM ( dy ) ; vec3 dC = dv ( dv ( dy . y + vec3 ( cJ , dA . y , cK ) ) + dy . x + vec3 ( cJ , dA . x , cK ) ) ; vec3 dD = max ( 0.5 - vec3 ( dot ( dz , dz ) , dot ( dB . xy , dB . xy ) , dot ( dB . zw , dB . zw ) ) , cJ ) ; dD = dD * dD ; dD = dD * dD ; vec3 dE = 2.0 * fract ( dC * dx . www ) - cK ; vec3 dF = abs ( dE ) - 0.5 ; vec3 dG = floor ( dE + 0.5 ) ; vec3 dH = dE - dG ; dD *= 1.79284291400159 - 0.85373472095314 * ( dH * dH + dF * dF ) ; vec3 dI ; dI . x = dH . x * dz . x + dF . x * dz . y ; dI . yz = dH . yz * dB . xz + dF . yz * dB . yw ; return 130.0 * dot ( dD , dI ) ; } vec2 dP ( vec2 dK ) { float dL = dot ( dK , vec2 ( 12.9898 , 78.233 ) ) ; float dM = dot ( dK , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float dN = fract ( sin ( dL ) * 43758.5453 ) * 2.0 - cK ; float dO = fract ( sin ( dM ) * 43758.5453 ) * 2.0 - cK ; return vec2 ( dN , dO ) ; }".split(" ")}]};
a["include/shadow.glslf"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"var",name:"CSM_BLEND_BETWEEN_CASCADES",b:["1.0"]},{type:"var",name:"CSM_FADE_LAST_CASCADE",b:["1.0"]},{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:["vec4","dQ",";"]}]}}]},{type:"condition",a:[{type:"if",c:"SHADOW_USAGE == SHADOW_MASK_GENERATION || SHADOW_USAGE == SHADOW_MAPPING_BLEND".split(" "),
group:{type:"group",a:[{type:"textline",b:"const float dR = 0.1 ; const float dS = 0.1 ; const float dT = - 0.01 ; const float dU = 0.05 ; mat4 dV = mat4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 , 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 , - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 , - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; mat4 dW = mat4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 , - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 , - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 , - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ; bool dZ ( vec2 dX , float dY ) { return all ( lessThanEqual ( dX , vec2 ( 1.0 + dY ) ) ) && all ( greaterThanEqual ( dX , vec2 ( 0.0 - dY ) ) ) ; } float el ( vec3 d_ , PRECISION sampler2D ea , float eb ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:"if ( d_ . z > u_perspective_cast_far_bound ) return 1.0 ; else {".split(" ")}]}}]},{type:"textline",b:"d_ . z = clamp ( d_ . z , 0.0 , 1.0 ) ; float ec = 0.0 ; float ed = dP ( d_ . xy ) . x * M_PI ; float ee = cos ( ed ) ; float ef = sin ( ed ) ; mat2 eg = mat2 ( ee , ef , - ef , ee ) ; vec2 eh , ei ; for ( int ej = 0 ; ej < 4 ; ej ++ ) for ( int ek = 0 ; ek < 4 ; ek ++ ) { ei . x = dV [ ej ] [ ek ] ; ei . y = dW [ ej ] [ ek ] ; ei = eg * ei ; eh = d_ . xy + ei * eb / SHADOW_TEX_RES ;".split(" ")},
{type:"condition",a:[{type:"if",c:["!","CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"if ( ! dZ ( eh , dT ) ) ec += 1.0 ; else".split(" ")}]}}]},{type:"textline",b:"ec += step ( d_ . z , texture2D ( ea , eh ) . r ) ; } ec /= 16.0 ; return clamp ( ec , 0.0 , 1.0 ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["PERSPECTIVE_SHADOW_CAST"],group:{type:"group",a:[{type:"textline",b:["}"]}]}}]},{type:"textline",b:"return 1.0 ; } float eD ( vec3 em , PRECISION sampler2D en , vec3 eo , PRECISION sampler2D ep , float eq , float er , float es ) { float et , eu ; em . z = clamp ( em . z , 0.0 , 1.0 ) ; eo . z = clamp ( eo . z , 0.0 , 1.0 ) ; et = 0.0 ; eu = 0.0 ; float ev = dP ( em . xy ) . x * M_PI ; float ew = cos ( ev ) ; float ex = sin ( ev ) ; mat2 ey = mat2 ( ew , ex , - ex , ew ) ; vec2 ez , eA ; for ( int eB = 0 ; eB < 4 ; eB ++ ) for ( int eC = 0 ; eC < 4 ; eC ++ ) { eA . x = dV [ eB ] [ eC ] ; eA . y = dW [ eB ] [ eC ] ; eA = ey * eA ; ez = em . xy + eA * eq / SHADOW_TEX_RES ; et += step ( em . z , texture2D ( en , ez ) . r ) ; ez = eo . xy + eA * er / SHADOW_TEX_RES ; eu += step ( eo . z , texture2D ( ep , ez ) . r ) ; } et = mix ( et , eu , es ) ; et /= 16.0 ; return clamp ( et , 0.0 , 1.0 ) ; } float eH ( vec2 eE ) { float eF = min ( eE . x , eE . y ) ; float eG = min ( 1.0 - eE . x , 1.0 - eE . y ) ; return min ( eF , eG ) ; } float eK ( float eI , float eJ ) { if ( eJ >= 0.0 && eJ <= dS ) eI = ( eI - 1.0 ) / dS * eJ + 1.0 ; return eI ; } float eW ( vec3 eL , vec3 eM , PRECISION sampler2D eN , PRECISION sampler2D eO , float eP , float eQ , float eR , float eS ) { float eT ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_BLEND_BETWEEN_CASCADES"],group:{type:"group",a:[{type:"textline",b:"float eU = eH ( eL . xy ) ; if ( - eS > eR && eU >= 0.0 && eU <= dR && dZ ( eM . xy , 0.0 ) ) { float eV = 1.0 - eU / dR ; eT = eD ( eL , eN , eM , eO , eP , eQ , eV ) ; } else".split(" ")}]}}]},{type:"textline",b:"eT = el ( eL , eN , eP ) ; return eT ; } float fd ( vec3 eX , PRECISION sampler2D eY , float eZ , float e_ , float fa ) { float fb = el ( eX , eY , eZ ) ;".split(" ")},{type:"condition",
a:[{type:"if",c:["CSM_FADE_LAST_CASCADE"],group:{type:"group",a:[{type:"textline",b:"if ( - fa > e_ ) { float fc = eH ( eX . xy ) ; fb = eK ( fb , fc ) ; }".split(" ")}]}}]},{type:"textline",b:"return fb ; } float fk ( float fe ) { float ff = 1.0 ; vec3 fg = cE . xyz / cE . w ;".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"vec3 fh = cF . xyz / cF . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",
a:[{type:"textline",b:"vec3 fi = cG . xyz / cG . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"vec3 fj = cH . xyz / cH . w ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"if ( dZ ( fg . xy , 0.0 ) ) { ff = eW ( fg , fh , u_shadow_map0 , u_shadow_map1 , u_pcf_blur_radii [ 0 ] , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 0 ] , fe ) ; }".split(" ")}]}},{type:"else",
group:{type:"group",a:[{type:"textline",b:"if ( dZ ( fg . xy , dU ) ) { ff = fd ( fg , u_shadow_map0 , u_pcf_blur_radii [ 0 ] , u_csm_center_dists [ 0 ] , fe ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"else { if ( dZ ( fh . xy , 0.0 ) ) {".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"ff = eW ( fh , fi , u_shadow_map1 , u_shadow_map2 , u_pcf_blur_radii [ 1 ] , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 1 ] , fe ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"ff = fd ( fh , u_shadow_map1 , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 1 ] , fe ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"else { if ( dZ ( fi . xy , 0.0 ) ) {".split(" ")},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"ff = eW ( fi , fj , u_shadow_map2 , u_shadow_map3 , u_pcf_blur_radii [ 2 ] , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 2 ] , fe ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"ff = fd ( fi , u_shadow_map2 , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 2 ] , fe ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"else { if ( dZ ( fj . xy , 0.0 ) ) ff = fd ( fj , u_shadow_map3 , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 3 ] , fe ) ; }".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",b:["}"]}]}}]},{type:"textline",
b:["return","ff",";","}"]}]}}]},{type:"textline",b:"float fp ( inout vec3 fl ) {".split(" ")},{type:"condition",a:[{type:"if",c:["SHADOW_USAGE","==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:"vec2 fm = texture2DProj ( u_shadow_mask , cI ) . rg ; vec3 fn = vec3 ( fm . r ) ; float fo = fm . g ; dQ = vec4 ( fn , fo ) ; fl *= dQ . a ; return dQ . r ;".split(" ")}]}},{type:"elif",c:"SHADOW_USAGE == SHADOW_MASK_GENERATION || SHADOW_USAGE == SHADOW_MAPPING_BLEND".split(" "),group:{type:"group",
a:[{type:"textline",b:"return fk ( cD . z ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["return","1.0",";"]}]}}]},{type:"textline",b:["}"]}]};a["include/dynamic_grass.glslv"]={type:"group",a:[{type:"var",name:"PRECISION",b:["lowp"]},{type:"condition",a:[{type:"if",c:["DYNAMIC_GRASS"],group:{type:"group",a:[{type:"textline",b:"vec2 fu ( vec3 fq , float fr , vec2 fs ) { vec2 ft = vec2 ( ( fq . x - fs . x ) / fr , - ( fq . z - fs . y ) / fr ) ; return fract ( ft ) ; } vec2 fy ( vec2 fv , float fw , vec2 fx ) { return vec2 ( fv . x * fw , - fv . y * fw ) + fx ; } d fz ( ) { return d ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; } d ge ( vec3 fA , vec3 fB , vec3 fC , vec3 fD , vec3 fE , PRECISION sampler2D fF , sampler2D fG , vec3 fH , float fI , vec3 fJ , vec4 fK , mat4 fL ) { vec3 fM = j ( fK , vec3 ( 0.0 , - 1.0 , 0.0 ) ) ; float fN = - fM . x ; float fO = - fM . z ; vec2 fP = vec2 ( fJ . x + fI * ( - 1.0 - fN ) / 2.0 , fJ . z + fI * ( 1.0 - fO ) / 2.0 ) ; vec2 fQ = fu ( fE , fI , fP ) ; float fR = fI / 2.0 ; vec2 fS = abs ( fy ( fQ - vec2 ( 0.5 ) , fI , vec2 ( 0.0 ) ) ) ; float fT = fR * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( fS ) > fT ) return fz ( ) ; float fU = fI / fH . z ; vec2 fV = ( fQ - vec2 ( 0.5 ) ) * fU + vec2 ( 0.5 ) ; vec3 fW = fM * ( fI / fH . z - 1.0 ) / 2.0 ; fV . x += fW . x ; fV . y -= fW . z ; vec4 fX = texture2D ( fG , fV ) ; float fY = fX . r ; if ( fY < u_scale_threshold ) return fz ( ) ; float fZ = fH . y - fH . x ; float f_ = fH . y - texture2D ( fF , fV ) . r * fZ ; vec2 ga = fA . xz - fE . xz ; fE . xz = fy ( fQ , fI , fP ) ; fE . y = f_ ; fA . xz = fE . xz + ga ; fA . y *= fY ; fA . y += f_ ; vec3 gb = fX . gba ;".split(" ")},
{type:"condition",a:[{type:"if",c:["BILLBOARD"],group:{type:"group",a:[{type:"textline",b:"fA -= fE ; mat4 gc = an ( fJ , fE , fL ) ; d gd = aA ( fA , fE , fB , fC , fD , gc ) ; gd . b = fE ; gd . f = gb ; return F ( gd ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return F ( d ( fA , fE , fB , fC , fD , gb ) ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}}]}]};a["include/shadow.glslv"]={type:"group",a:[{type:"var",name:"SHADOW_TEX_RES",b:["0.0"]},{type:"condition",
a:[{type:"if",c:"SHADOW_USAGE == SHADOW_MASK_GENERATION || SHADOW_USAGE == SHADOW_MAPPING_BLEND".split(" "),group:{type:"group",a:[{type:"textline",b:"vec4 gk ( mat4 gf , vec4 gg ) { vec2 gh = ( gf * u_v_light_matrix [ 3 ] ) . xy ; float gi = SHADOW_TEX_RES / 2.0 ; gh = floor ( gh * gi + 0.5 ) / gi - gh ; vec4 gj = gf * gg ; gj . xy += gh ; gj = u_b_light_matrix * gj ; return gj ; } void go ( vec3 gl , vec3 gm ) { vec4 gn = u_v_light_matrix * vec4 ( gl + u_normal_offset * gm , 1.0 ) ; cE = gk ( u_p_light_matrix0 , gn ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["CSM_SECTION1"],group:{type:"group",a:[{type:"textline",b:"cF = gk ( u_p_light_matrix1 , gn ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION2"],group:{type:"group",a:[{type:"textline",b:"cG = gk ( u_p_light_matrix2 , gn ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CSM_SECTION3"],group:{type:"group",a:[{type:"textline",b:"cH = gk ( u_p_light_matrix3 , gn ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]}},{type:"elif",c:["SHADOW_USAGE",
"==","SHADOW_MAPPING_OPAQUE"],group:{type:"group",a:[{type:"textline",b:"void go ( vec4 gp ) { float gq = gp . x ; float gr = gp . y ; float gs = gp . w ; cI . x = ( gq + gs ) / 2.0 ; cI . y = ( gr + gs ) / 2.0 ; cI . z = gs ; }".split(" ")}]}}]}]};a["include/gamma.glslf"]={type:"group",a:[{type:"define",name:"GAMMA",b:["1"]},{type:"define",name:"PREMULTIPLY_ALPHA",b:["1"]},{type:"textline",b:"void gv ( inout vec3 gu ) {".split(" ")},{type:"condition",a:[{type:"if",c:["GAMMA"],group:{type:"group",
a:[{type:"textline",b:"gu = max ( vec3 ( 0.0 ) , gu ) ; gu = pow ( gu , vec3 ( 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} void gx ( inout vec3 gw ) {".split(" ")},{type:"condition",a:[{type:"if",c:["GAMMA"],group:{type:"group",a:[{type:"textline",b:"gw = max ( vec3 ( 0.0 ) , gw ) ; gw = pow ( gw , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}}]},{type:"textline",b:"} void gA ( inout vec3 gy , in float gz ) {".split(" ")},{type:"condition",a:[{type:"if",c:["PREMULTIPLY_ALPHA"],group:{type:"group",a:[{type:"textline",
b:"gy = gy * gz ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["include/pack.glslf"]={type:"group",a:[{type:"textline",b:"float gD = 255.0 ; float gE = 0.0 ; float gF = 1.0 ; vec4 gK ( const in float gG ) { vec4 gH = vec4 ( gD * gD * gD , gD * gD , gD , gF ) ; vec4 gI = vec4 ( gE , gF / gD , gF / gD , gF / gD ) ; vec4 gJ = fract ( gG * gH ) ; gJ -= gJ . xxyz * gI ; return gJ ; } float gO ( const in vec4 gL ) { float gM ; vec4 gN = vec4 ( gF / ( gD * gD * gD ) , gF / ( gD * gD ) , gF / gD , gF ) ; gM = dot ( gL , gN ) ; return gM ; } vec4 gK ( const in vec2 gP ) { vec2 gQ = vec2 ( gD , gF ) ; vec2 gR = vec2 ( gE , gF / gD ) ; vec4 gS = fract ( gP . xxyy * gQ . xyxy ) ; gS -= gS . xxzz * gR . xyxy ; if ( gP . r == gF ) gS . rg = vec2 ( gE , gF ) ; if ( gP . g == gF ) gS . ba = vec2 ( gE , gF ) ; return gS ; } vec2 gW ( const in vec4 gT ) { vec2 gU ; vec2 gV = vec2 ( gF / gD , gF ) ; gU . r = dot ( gT . rg , gV ) ; gU . g = dot ( gT . ba , gV ) ; return gU ; }".split(" ")}]};
a["include/fog.glslf"]={type:"group",a:[{type:"var",name:"WAVES_HEIGHT",b:["0.0"]},{type:"textline",b:"void hb ( inout vec3 gX , in float gY , in vec4 gZ ) { float g_ = gZ . w * gY ; float ha = exp ( - g_ * g_ ) ; ha = clamp ( ha , 0.0 , 1.0 ) ; gX = mix ( gZ . rgb , gX , ha ) ; }".split(" ")},{type:"condition",a:[{type:"if",c:["PROCEDURAL_FOG"],group:{type:"group",a:[{type:"textline",b:"vec3 hi ( in mat4 hc , in vec3 hd ) { vec3 he = mix ( hc [ 0 ] . rgb , hc [ 1 ] . rgb , max ( sign ( hd . x ) , 0.0 ) ) ; vec3 hf = mix ( hc [ 2 ] . rgb , hc [ 3 ] . rgb , max ( sign ( hd . z ) , 0.0 ) ) ; vec3 hg = vec3 ( hc [ 0 ] . a , hc [ 1 ] . a , hc [ 2 ] . a ) ; vec3 hh = mix ( he , hf , abs ( hd . z ) ) ; hh = mix ( hh , hg , abs ( hd . y ) ) ; return hh ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["WATER_EFFECTS"],group:{type:"group",a:[{type:"textline",b:"void hk ( inout float hj ) { hj -= 0.5 ; hj = 4.0 * ( hj * hj * hj ) + 0.5 ; } void hB ( inout vec3 hl , in float hm , in vec3 hn , in float ho , in vec4 hp , in vec4 hq , in float hr , in float hs ) { float ht = hq . w * hm ; float hu = exp ( - ht * ht ) ; hu = clamp ( hu , 0.0 , 1.0 ) ; float hv = max ( hn . y , 0.0 ) ; hm = max ( hm - max ( ho / hv , 0.0 ) , 0.0 ) ; float hw = hp . w * hm ; float hx = 1.0 - hw ; hx = max ( hx , 0.0 ) ; hk ( hx ) ; hx += max ( hr - 0.5 , 0.0 ) ; if ( hx < hu ) { vec3 hy = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 hz = hp . rgb ; ho = clamp ( - ho * 0.03 , 0.0 , 0.8 ) ; vec3 hA = mix ( hz , hy , min ( hv , 1.0 ) ) ; hA = mix ( hA , vec3 ( 0.0 ) , ho ) * hs ; hl = mix ( hA , hl , hx ) ; } if ( hx >= hu ) { hl = mix ( hq . rgb , hl , hu ) ; } } void hK ( inout vec3 hC , in float hD , in float hE , in vec4 hF , in float hG ) { float hH = hF . w * hD ; float hI = 1.0 - hH ; hI = clamp ( hI , 0.0 , 1.0 ) ; hk ( hI ) ; hE = clamp ( - hE * 0.03 , 0.0 , 0.8 ) ; vec3 hJ = mix ( hF . rgb , vec3 ( 0.0 ) , hE ) * hG ; hC = mix ( hJ , hC , hI ) ; }".split(" ")}]}}]}]};
a["include/lighting.glslf"]={type:"group",a:[{type:"var",name:"NUM_LIGHTS",b:["0"]},{type:"var",name:"LAMP_IND",b:["0"]},{type:"var",name:"LAMP_SPOT_SIZE",b:["0"]},{type:"var",name:"LAMP_SPOT_BLEND",b:["0"]},{type:"var",name:"LAMP_LIGHT_DIST",b:["0"]},{type:"var",name:"LAMP_LIGHT_FACT_IND",b:["0"]},{type:"var",name:"LAMP_FAC_CHANNELS",b:["rgb"]},{type:"var",name:"LAMP_SHADOW_MAP_IND",b:["0"]},{type:"var",name:"NUM_LFACTORS",b:["0"]},{type:"define",name:"M_PI",b:["3.14159265359"]},{type:"textline",
b:"float hL = 0.0 ; float hM = 1.0 ; float hN = 0.5 ; struct hO { vec4 a ; vec3 b ; } ;".split(" ")},{type:"condition",a:[{type:"if",c:"SPECULAR_SHADER == SPECULAR_PHONG || SPECULAR_SHADER == SPECULAR_COOKTORR".split(" "),group:{type:"group",a:[{type:"textline",b:"float hW ( vec3 hP , vec3 hQ , vec3 hR , float hS , float hT ) { vec3 hU = normalize ( hP + hQ ) ; float hV = ( hM - hS ) * max ( dot ( hR , hU ) , hL ) + hS ; return pow ( hV , hT ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",
c:["SPECULAR_SHADER","==","SPECULAR_WARDISO"],group:{type:"group",a:[{type:"textline",b:"float ih ( vec3 hX , vec3 hY , vec3 hZ , float h_ ) { vec3 ia = normalize ( hX + hY ) ; float ib = max ( dot ( hZ , ia ) , 0.001 ) ; float ic = max ( dot ( hZ , hY ) , 0.01 ) ; float id = max ( dot ( hZ , hX ) , 0.01 ) ; float ie = tan ( acos ( ib ) ) ; float ig = max ( h_ , 0.001 ) ; return id * ( hM / ( 4.0 * M_PI * ig * ig ) ) * ( exp ( - ( ie * ie ) / ( ig * ig ) ) / ( sqrt ( ic * id ) ) ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["SPECULAR_SHADER","==","SPECULAR_TOON"],group:{type:"group",a:[{type:"textline",b:"float iq ( vec3 ii , vec3 ij , vec3 ik , float il , float im ) { vec3 io = normalize ( ii + ij ) ; float ip = acos ( dot ( io , ik ) ) ; if ( ip < il ) return hM ; else if ( ip >= il + im || im == hL ) return hL ; else return hM - ( ip - il ) / im ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SPECULAR_SHADER","==","SPECULAR_BLINN"],group:{type:"group",a:[{type:"textline",
b:"float iJ ( vec3 ir , vec3 is , vec3 it , float iu , float iv , float iw ) { if ( iu < 1.0 || iv == hL ) return hL ; else { if ( iv < 100.0 ) iv = sqrt ( 1.0 / iv ) ; else iv = 10.0 / iv ; vec3 ix = normalize ( is + ir ) ; float iy = ( hM - iw ) * max ( dot ( it , ix ) , hL ) + iw ; if ( iy < hL ) return hL ; else { float iz = max ( dot ( it , is ) , 0.01 ) ; float iA = dot ( it , ir ) ; if ( iA <= 0.01 ) return hL ; else { float iB = max ( dot ( is , ix ) , 0.01 ) ; float iC = hM ; float iD = ( 2.0 * iy * iz ) / iB ; float iE = ( 2.0 * iy * iA ) / iB ; float iF = min ( min ( iC , iD ) , iE ) ; float iG = sqrt ( pow ( iu , 2.0 ) + pow ( iB , 2.0 ) - hM ) ; float iH = pow ( iG - iB , 2.0 ) / pow ( iG + iB , 2.0 ) * ( hM + pow ( iB * ( iG + iB ) - hM , 2.0 ) / pow ( iB * ( iG - iB ) + hM , 2.0 ) ) ; float iI = acos ( iy ) ; return max ( iH * iF * exp ( - pow ( iI , 2.0 ) / ( 2.0 * pow ( iv , 2.0 ) ) ) , hL ) ; } } } }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_OREN_NAYAR"],group:{type:"group",a:[{type:"textline",b:"float jb ( float iK , vec3 iL , vec3 iM , vec3 iN , float iO ) { if ( iO > hL ) { float iP = max ( dot ( iL , iN ) , hL ) ; float iQ = iO * iO ; float iR = hM - hN * ( iQ / ( iQ + 0.33 ) ) ; vec3 iS = iM - iK * iL ; vec3 iT = iN - iP * iL ; if ( length ( iS ) == hL || length ( iT ) == hL || abs ( iK ) > hM || abs ( iP ) > hM ) return iK * iR ; else { float iU = acos ( iK ) ; float iV = acos ( iP ) ; vec3 iW = normalize ( iS ) ; vec3 iX = normalize ( iT ) ; float iY , iZ ; iY = max ( iU , iV ) ; iZ = min ( iU , iV ) ; iZ *= 0.95 ; float i_ = max ( dot ( iW , iX ) , hL ) ; float ja = 0.45 * ( iQ / ( iQ + 0.09 ) ) ; return iK * ( iR + ( ja * i_ * sin ( iY ) * tan ( iZ ) ) ) ; } } else return iK ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_MINNAERT"],group:{type:"group",a:[{type:"textline",b:"float jh ( float jc , vec3 jd , vec3 je , float jf ) { float jg = max ( dot ( jd , je ) , hL ) ; if ( jf <= hM ) return jc * pow ( max ( jg * jc , 0.1 ) , jf - hM ) ; else return jc * pow ( 1.0001 - jg , jf - hM ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_TOON"],group:{type:"group",a:[{type:"textline",b:"float jm ( float ji , float jj , float jk ) { float jl = acos ( ji ) ; if ( jl < jj ) return hM ; else if ( jl > ( jj + jk ) || jk == hL ) return hL ; else return hM - ( ( jl - jj ) / jk ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_FRESNEL"],group:{type:"group",a:[{type:"textline",b:"float jr ( float jn , float jo , float jp ) { float jq ; if ( jo == hL ) { return hM ; } else { jq = hM + abs ( jn ) ; jq = jp + ( hM - jp ) * pow ( jq , jo ) ; return clamp ( jq , hL , hM ) ; } }".split(" ")}]}}]},{type:"textline",b:"void jz ( vec3 js , vec3 jt , vec3 ju , vec2 jv , const float jw , out float jx ) { float jy = ( hM - jw ) * dot ( js , jt ) + jw ; jx = jy ; if ( jw == hN ) return ;".split(" ")},
{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_FRESNEL"],group:{type:"group",a:[{type:"textline",b:"jx = jr ( jy , jv [ 0 ] , jv [ 1 ] ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_OREN_NAYAR"],group:{type:"group",a:[{type:"textline",b:"jx = jb ( jy , js , jt , ju , jv [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_MINNAERT"],group:{type:"group",a:[{type:"textline",
b:"jx = jh ( jy , js , ju , jv [ 0 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["DIFFUSE_SHADER","==","DIFFUSE_TOON"],group:{type:"group",a:[{type:"textline",b:"jx = jm ( jy , jv [ 0 ] , jv [ 1 ] ) ;".split(" ")}]}}]},{type:"textline",b:"jx = max ( jx , hL ) ;".split(" ")}]}}]},{type:"textline",b:"} void jG ( vec3 jA , vec3 jB , vec3 jC , float jD , vec2 jE , out float jF ) {".split(" ")},{type:"condition",a:[{type:"if",c:"SPECULAR_SHADER == SPECULAR_PHONG || SPECULAR_SHADER == SPECULAR_COOKTORR".split(" "),
group:{type:"group",a:[{type:"textline",b:"jF = hW ( jA , jB , jC , jD , jE [ 0 ] ) ;".split(" ")}]}},{type:"elif",c:["SPECULAR_SHADER","==","SPECULAR_WARDISO"],group:{type:"group",a:[{type:"textline",b:"jF = ih ( jA , jB , jC , jE [ 0 ] ) ;".split(" ")}]}},{type:"elif",c:["SPECULAR_SHADER","==","SPECULAR_TOON"],group:{type:"group",a:[{type:"textline",b:"jF = iq ( jA , jB , jC , jE [ 0 ] , jE [ 1 ] ) ;".split(" ")}]}},{type:"elif",c:["SPECULAR_SHADER","==","SPECULAR_BLINN"],group:{type:"group",a:[{type:"textline",
b:"jF = iJ ( jA , jB , jC , jE [ 0 ] , jE [ 1 ] , jD ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:["jF","=","hL",";"]}]}}]},{type:"textline",b:"} void kc ( vec3 jH , vec3 jI , vec3 jJ , vec2 jK , vec4 jL , vec3 jM , vec3 jN , vec3 jO , inout hO jP , float jQ , vec2 jR , vec2 jS , float jT ) { float jU = hL ; if ( jK . r != hL ) jz ( jJ , jI , jH , jR , jT , jU ) ; float jV = hL ; if ( jK . g != hL ) jG ( jI , jH , jJ , jT , jS , jV ) ;".split(" ")},{type:"condition",
a:[{type:"if",c:["USE_NODE_B4W_TRANSLUCENCY"],group:{type:"group",a:[{type:"textline",b:"if ( dot ( jI , jJ ) * dot ( jH , jJ ) < hL ) { float jW = jL . x ; float jX = jL . y ; float jY = jL . z ; float jZ = jL . w ; float j_ = clamp ( abs ( dot ( jI , jJ ) ) , hL , hM ) ; float ka = clamp ( dot ( jH , - jI ) , hL , hM ) ; float kb = pow ( ka , jX ) ; jP . a += jQ * vec4 ( jO * j_ * pow ( jM , vec3 ( jW ) ) , hM ) ; jP . a += jY * mix ( vec4 ( jM , hM ) , vec4 ( hM ) , jZ ) * jQ * vec4 ( jO * j_ * vec3 ( kb ) , hM ) ; } else { jP . b += jO * jN * jV ; jP . a += vec4 ( jO * jM * jU , jV ) ; }".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"jP . b += jO * jN * jV ; jP . a += vec4 ( jO * jM * jU , jV ) ;".split(" ")}]}}]},{type:"textline",b:["}"]},{type:"lamp",name:"POINT",f:[{type:"textline",b:"vec2 ku = kq [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; vec3 kv = kn [ LAMP_IND ] ; vec3 kw = kp [ LAMP_IND ] ; float kx = hL ;".split(" ")},{type:"textline",b:"vec3 ky = kw ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) ky *= km ; vec3 kz = kv - kh ;".split(" ")},{type:"textline",b:"float kA = length ( kz ) ; ky *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + kA * kA ) ; kz = normalize ( kz ) ; kc ( kj , kz , ki , ku , ks , kf , kg , ky , kt , kr , kl , kk , kx ) ;".split(" ")}]},
{type:"lamp",name:"SPOT",f:[{type:"textline",b:"vec2 kB = kq [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; vec3 kC = kn [ LAMP_IND ] ; vec3 kD = kp [ LAMP_IND ] ; vec3 kE = ko [ LAMP_IND ] ; float kF = hL ;".split(" ")},{type:"textline",b:"vec3 kG = kD ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) kG *= km ; vec3 kH = kC - kh ;".split(" ")},{type:"textline",b:"float kI = length ( kH ) ; kG *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + kI * kI ) ; kH = normalize ( kH ) ;".split(" ")},{type:"textline",b:"float kJ = dot ( kH , kE ) ; kJ *= smoothstep ( hL , hM , ( kJ - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; kG *= kJ ; kc ( kj , kH , ki , kB , ks , kf , kg , kG , kt , kr , kl , kk , kF ) ;".split(" ")}]},
{type:"lamp",name:"SUN",f:[{type:"textline",b:"vec2 kK = kq [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; vec3 kL = kp [ LAMP_IND ] ; vec3 kM = ko [ LAMP_IND ] ; float kN = hL ;".split(" ")},{type:"textline",b:"vec3 kO = kL ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) kO *= km ; kc ( kj , kM , ki , kK , ks , kf , kg , kO , kt , kr , kl , kk , kN ) ;".split(" ")}]},{type:"lamp",name:"HEMI",f:[{type:"textline",b:"vec2 kP = kq [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ; vec3 kQ = kp [ LAMP_IND ] ; vec3 kR = ko [ LAMP_IND ] ; float kS = hN ;".split(" ")},
{type:"textline",b:"vec3 kT = kQ ; if ( bool ( LAMP_SHADOW_MAP_IND ) ) kT *= km ; kc ( kj , kR , ki , kP , ks , kf , kg , kT , kt , kr , kl , kk , kS ) ;".split(" ")}]},{type:"condition",a:[{type:"if",c:["NUM_LIGHTS",">","0"],group:{type:"group",a:[{type:"textline",b:"hO kU ( vec3 kd , vec3 ke , vec3 kf , vec3 kg , vec3 kh , vec3 ki , vec3 kj , vec2 kk , vec2 kl , float km , vec3 kn [ NUM_LIGHTS ] , vec3 ko [ NUM_LIGHTS ] , vec3 kp [ NUM_LIGHTS ] , vec4 kq [ NUM_LFACTORS ] , float kr , vec4 ks ) { hO kt ; kt . a = vec4 ( kd + kf * ke , hL ) ; kt . b = vec3 ( hL ) ;".split(" ")},
{type:"lamps_main"},{type:"textline",b:["return","kt",";","}"]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"hO kZ ( vec3 kV , vec3 kW , vec3 kX ) { hO kY ; kY . a = vec4 ( kV + kX * kW , hL ) ; kY . b = vec3 ( hL ) ; return kY ; }".split(" ")}]}}]}]};a["include/caustics.glslf"]={type:"group",a:[{type:"var",name:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{type:"var",name:"CAUST_SCALE",b:["0.0"]},{type:"var",name:"CAUST_BRIGHT",b:["0.0"]},{type:"define",name:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},
{type:"textline",b:"void lz ( inout vec3 k_ , float la , float lb , float lc , vec3 ld , vec3 le , vec3 lf , vec4 lg , vec3 lh , float li ) { if ( li > CAUSTICS_VIEW_DISTANCE ) return ; vec4 lj = lg ; vec3 lk = lh + ld ; lk . xz = 10.0 * sin ( 0.1 * lk . xz ) ; vec3 ll = lk + 2.0 * cross ( - lj . xyz , cross ( - lj . xyz , lk ) + lj . w * lk ) ; vec2 lm = ll . xz ; vec3 ln = le ; float lo = max ( dot ( ld , ln ) , 0.0 ) ; float lp = 0.025 ; lm . s += 0.5 * sin ( dot ( lh + lb , vec3 ( 1.0 ) ) ) ; lm . t += 0.7 * ( - sin ( dot ( lh - lb , vec3 ( - 0.7 ) ) ) ) ; lm . st += 0.23 * cos ( 4.0 * la - CAUST_SPEED . x * lb ) ; lm . st += 3.0 * sin ( la - 0.3 * CAUST_SPEED . y * lb ) ; float lq = CAUST_SCALE * ( 1.0 + max ( 0.1 * la , 0.0 ) ) ; mat3 lr = dt ( ( lm / lq ) , lp ) ; float ls = ( lr * vec3 ( 1.0 , 0.0 , 0.0 ) ) . x ; float lt = ( lr * vec3 ( 0.0 , 1.0 , 0.0 ) ) . x ; float lu = ( lr * vec3 ( 0.0 , 0.0 , 1.0 ) ) . x ; vec3 lv = CAUST_BRIGHT * vec3 ( ls , lt , lu ) ; float lw = lc * lo ; float lx = max ( sign ( la ) , 0.0 ) ; lw = min ( lw + 0.5 * sign ( - ld . y ) * lx , 1.0 ) ; lw *= 1.0 - lx * ( 0.1 * la ) ; lv *= lw ; lv *= lv ; float ly = min ( - la + 10.0 , 1.0 ) ; k_ += max ( ( 2.0 * lf * lv ) * ly , 0.0 ) ; }".split(" ")}]};
a["include/mirror.glslf"]={type:"group",a:[{type:"condition",a:[{type:"if",c:"REFLECTION_TYPE == REFL_PLANE || REFLECTION_TYPE == REFL_CUBE || REFLECTION_TYPE == REFL_MIRRORMAP".split(" "),group:{type:"group",a:[{type:"define",name:"REFL_BUMP",b:["0.1"]},{type:"textline",b:"float lN ( in vec3 lG , vec3 lH , float lI , float lJ ) { vec3 lK = normalize ( lH + lG ) ; float lL = 1.0 - dot ( lG , lK ) ; float lM = lJ + ( 1.0 - lJ ) * pow ( lL , lI ) ; return lM ; } void ma ( inout vec3 lO , vec3 lP , vec3 lQ , float lR ) { vec3 lS = reflect ( - lP , lQ ) ; float lT = u_fresnel_params [ 2 ] ; float lU = u_fresnel_params [ 3 ] ; float lV = 1.0 ; if ( lT != 0.0 ) lV = lN ( lP , lS , lT , lU ) ;".split(" ")},
{type:"condition",a:[{type:"if",c:["REFLECTION_TYPE","==","REFL_CUBE"],group:{type:"group",a:[{type:"textline",b:"vec3 lW = textureCube ( u_cube_reflection , lS ) . xyz ;".split(" ")}]}},{type:"elif",c:["REFLECTION_TYPE","==","REFL_PLANE"],group:{type:"group",a:[{type:"textline",b:"vec3 lX = u_refl_plane . xyz * dot ( lQ , u_refl_plane . xyz ) ; vec3 lY = lQ - lX ; vec2 lZ = ( u_view_matrix_frag * vec4 ( lY , 0.0 ) ) . xy ; vec2 l_ = cI . xy / cI . z ; l_ += lZ * REFL_BUMP ; vec3 lW = texture2D ( u_plane_reflection , l_ ) . rgb ;".split(" ")}]}},
{type:"elif",c:["REFLECTION_TYPE","==","REFL_MIRRORMAP"],group:{type:"group",a:[{type:"textline",b:"vec3 lW = textureCube ( u_mirrormap , lS ) . xyz ; lR = u_mirror_factor ;".split(" ")}]}}]},{type:"textline",b:"gv ( lW . rgb ) ; lO = mix ( lO , lW , lR * lV ) ; }".split(" ")}]}}]}]};a["include/refraction.glslf"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["REFRACTIVE"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"textline",
b:"float mg ( in float mb , inout vec2 mc , in vec2 md ) { vec4 me = texture2D ( u_scene_depth , mc ) ; float mf = gO ( me ) ; if ( mf < lF ) { mc = md ; return mb ; } else { return mf ; } return mb ; }".split(" ")}]}}]},{type:"textline",b:"vec3 mo ( in vec3 mh , in vec2 mi ) { vec2 mj = mh . xy / mh . z ; vec2 mk = mj + mi ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_REFRACTION_CORRECTION"],group:{type:"group",a:[{type:"textline",b:"vec4 ml = texture2DProj ( u_scene_depth , mh ) ; float mm = gO ( ml ) ; mg ( mm , mk , mj ) ;".split(" ")}]}}]},
{type:"textline",b:"vec3 mn = texture2D ( u_refractmap , mk ) . rgb ; gv ( mn ) ; return mn ; }".split(" ")}]}}]}]};a["include/environment.glslf"]={type:"group",a:[{type:"textline",b:"vec3 mr ( vec3 mp ) {".split(" ")},{type:"condition",a:[{type:"if",c:["USE_ENVIRONMENT_LIGHT"],group:{type:"group",a:[{type:"condition",a:[{type:"if",c:["SKY_TEXTURE"],group:{type:"group",a:[{type:"textline",b:"return textureCube ( u_sky_texture , mp ) . rgb ;".split(" ")}]}},{type:"elif",c:["SKY_COLOR"],group:{type:"group",
a:[{type:"textline",b:"float mq = 0.5 * mp . y + 0.5 ; return mix ( u_horizon_color , u_zenith_color , mq ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{type:"textline",b:["}"]}]};a["include/nodes.glslf"]={type:"group",a:[{type:"var",name:"MAPPING_TRS_MATRIX",b:["mat4","(","0.0",")"]},{type:"var",name:"MAPPING_SCALE",b:["vec3","(",
"0.0",")"]},{type:"var",name:"MAPPING_TRANSLATION",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_MAX_CLIP",b:["vec3","(","0.0",")"]},{type:"var",name:"MAPPING_IS_NORMAL",b:["0.0"]},{type:"var",name:"RGB_IND",b:["0"]},{type:"var",name:"VALUE_IND",b:["0"]},{type:"var",name:"LAMP_INDEX",b:["0"]},{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","||","USE_NODE_TEX_COORD_GE"],group:{type:"group",a:[{type:"textline",b:["varying",
"vec3","ms",";"]}]}}]},{type:"textline",b:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; vec3 mt = vec3 ( ZERO_VALUE_NODES ) ; vec3 mu = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_NODE_B4W_REFRACTION"],group:{type:"group",a:[{type:"textline",b:"vec3 my ( in vec3 mv , in float mw ) { vec3 mx = mt ;".split(" ")},{type:"condition",a:[{type:"if",c:["USE_REFRACTION"],group:{type:"group",a:[{type:"textline",b:"mx = mo ( cI , mv . xz * mw ) ;".split(" ")}]}},
{type:"else",group:{type:"group",a:[{type:"textline",b:"mx = texture2D ( u_refractmap , cI . xy / cI . z ) . rgb ; gv ( mx ) ;".split(" ")}]}}]},{type:"textline",b:["return","mx",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:"USE_NODE_HUE_SAT || USE_NODE_MIX_RGB_HUE || USE_NODE_MIX_RGB_SATURATION || USE_NODE_MIX_RGB_VALUE || USE_NODE_MIX_RGB_COLOR || USE_NODE_SEPHSV".split(" "),group:{type:"group",a:[{type:"textline",b:"vec3 mF ( vec3 mz ) { vec4 mA = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; vec4 mB = mix ( vec4 ( mz . bg , mA . wz ) , vec4 ( mz . gb , mA . xy ) , step ( mz . b , mz . g ) ) ; vec4 mC = mix ( vec4 ( mB . xyw , mz . r ) , vec4 ( mz . r , mB . yzx ) , step ( mB . x , mz . r ) ) ; float mD = mC . x - min ( mC . w , mC . y ) ; float mE = 1.0e-10 ; return vec3 ( abs ( mC . z + ( mC . w - mC . y ) / ( 6.0 * mD + mE ) ) , mD / ( mC . x + mE ) , mC . x ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:"USE_NODE_HUE_SAT || USE_NODE_MIX_RGB_HUE || USE_NODE_MIX_RGB_SATURATION || USE_NODE_MIX_RGB_VALUE || USE_NODE_MIX_RGB_COLOR || USE_NODE_COMBHSV".split(" "),group:{type:"group",a:[{type:"textline",b:"vec3 mJ ( vec3 mG ) { vec4 mH = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; vec3 mI = abs ( fract ( vec3 ( mG . r , mG . r , mG . r ) + mH . xyz ) * 6.0 - mH . www ) ; return mG . b * mix ( mH . xxx , clamp ( mI - mH . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , mG . g ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_UV","||","USE_NODE_B4W_PARALLAX","||","USE_NODE_UV_MERGED"],group:{type:"group",a:[{type:"textline",b:"vec3 mL ( vec2 mK ) { return vec3 ( mK * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["USE_NODE_TEXTURE_COLOR","||","USE_NODE_TEXTURE_NORMAL","||","USE_NODE_B4W_PARALLAX"],group:{type:"group",a:[{type:"textline",b:"vec2 mN ( vec3 mM ) { return vec2 ( mM . xy * 0.5 + vec2 ( 0.5 , 0.5 ) ) ; }".split(" ")}]}}]},
{type:"node",name:"CAMERA",g:[{type:"node_out",name:"nr",qualifier:["vec3"],e:!0},{type:"node_out",name:"ns",qualifier:["float"],e:!0},{type:"node_out",name:"nt",qualifier:["float"],e:!0}],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_nr"],f:[{type:"textline",b:"nr = normalize ( nm . xyz ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ns"],f:[{type:"textline",b:"ns = abs ( nm . z ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_nt"],
f:[{type:"textline",b:"nt = length ( nm . xyz ) ;".split(" ")}]}]}]},{type:"node",name:"COMBRGB",g:[{type:"node_in",name:"nu",qualifier:["float"],e:!1},{type:"node_in",name:"nv",qualifier:["float"],e:!1},{type:"node_in",name:"nw",qualifier:["float"],e:!1},{type:"node_out",name:"nx",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"nx = vec3 ( nu , nv , nw ) ;".split(" ")}]},{type:"node",name:"COMBHSV",g:[{type:"node_in",name:"ny",qualifier:["float"],e:!1},{type:"node_in",name:"nz",qualifier:["float"],
e:!1},{type:"node_in",name:"nA",qualifier:["float"],e:!1},{type:"node_out",name:"nB",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"nB = mJ ( vec3 ( ny , nz , nA ) ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_UV",g:[{type:"node_out",name:"nC",qualifier:["vec3"],e:!1},{type:"node_param",name:"mO",qualifier:["varying","vec2"]}],f:[{type:"textline",b:"nC = mL ( mO ) ;".split(" ")}]},{type:"node",name:"GEOMETRY_OR",g:[{type:"node_out",name:"nD",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"nD = 2.0 * clamp ( ms , 0.0 , 1.0 ) - mu ;".split(" ")}]},
{type:"node",name:"GEOMETRY_VC",g:[{type:"node_out",name:"nE",qualifier:["vec3"],e:!1},{type:"node_param",name:"mP",qualifier:["varying","vec3"]}],f:[{type:"textline",b:["nE","=","mP",";"]}]},{type:"node",name:"GEOMETRY_VC1",g:[{type:"node_out",name:"nF",qualifier:["float"],e:!1},{type:"node_param",name:"mQ",qualifier:["varying","float"]}],f:[{type:"textline",b:["nF","=","mQ",";"]}]},{type:"node",name:"GEOMETRY_VC2",g:[{type:"node_out",name:"nG",qualifier:["float"],e:!1},{type:"node_out",name:"nH",
qualifier:["float"],e:!1},{type:"node_param",name:"mR",qualifier:["varying","vec2"]}],f:[{type:"textline",b:"nG = mR [ 0 ] ; nH = mR [ 1 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_VC3",g:[{type:"node_out",name:"nI",qualifier:["float"],e:!1},{type:"node_out",name:"nJ",qualifier:["float"],e:!1},{type:"node_out",name:"nK",qualifier:["float"],e:!1},{type:"node_param",name:"mS",qualifier:["varying","vec3"]}],f:[{type:"textline",b:"nI = mS [ 0 ] ; nJ = mS [ 1 ] ; nK = mS [ 2 ] ;".split(" ")}]},{type:"node",
name:"GEOMETRY_NO",g:[{type:"node_out",name:"nL",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["nL","=","nh",";"]}]},{type:"node",name:"GEOMETRY_FB",g:[{type:"node_out",name:"nM",qualifier:["float"],e:!1}],f:[{type:"textline",b:"nM = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"GEOMETRY_VW",g:[{type:"node_out",name:"nN",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["nN","=","na",";"]}]},{type:"node",name:"GEOMETRY_LO",g:[{type:"node_out",name:"nO",
qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"nO [ 0 ] = nm [ 0 ] ; nO [ 1 ] = nm [ 1 ] ; nO [ 2 ] = nm [ 2 ] ;".split(" ")}]},{type:"node",name:"GEOMETRY_GL",g:[{type:"node_out",name:"nP",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"nP = vec3 ( nl . r , - nl . b , nl . g ) ;".split(" ")}]},{type:"node",name:"HUE_SAT",g:[{type:"node_in",name:"nQ",qualifier:["float"],e:!1},{type:"node_in",name:"nR",qualifier:["float"],e:!1},{type:"node_in",name:"nS",qualifier:["float"],e:!1},{type:"node_in",
name:"nT",qualifier:["float"],e:!1},{type:"node_in",name:"nU",qualifier:["vec3"],e:!1},{type:"node_out",name:"nV",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"vec3 nW = mF ( nU ) ; nW [ 0 ] += ( nQ - 0.5 ) ; if ( nW [ 0 ] > UNITY_VALUE_NODES ) nW [ 0 ] -= UNITY_VALUE_NODES ; else if ( nW [ 0 ] < ZERO_VALUE_NODES ) nW [ 0 ] += UNITY_VALUE_NODES ; nW *= vec3 ( UNITY_VALUE_NODES , nR , nS ) ; nW = mix ( mu , mix ( mt , nW , step ( mt , nW ) ) , step ( nW , mu ) ) ; nV = mix ( nU , mJ ( nW ) , nT ) ;".split(" ")}]},
{type:"node",name:"INVERT",g:[{type:"node_in",name:"nX",qualifier:["float"],e:!1},{type:"node_in",name:"nY",qualifier:["vec3"],e:!1},{type:"node_out",name:"nZ",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"nZ = mix ( nY , mu - nY , nX ) ;".split(" ")}]},{type:"node",name:"LAMP",g:[{type:"node_out",name:"n_",qualifier:["vec3"],e:!0},{type:"node_out",name:"oa",qualifier:["vec3"],e:!1},{type:"node_out",name:"ob",qualifier:["float"],e:!1},{type:"node_out",name:"oc",qualifier:["float"],e:!0}],f:[{type:"node_condition",
a:[{type:"node_if",c:["USE_OUT_n_"],f:[{type:"textline",b:"n_ = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{type:"textline",b:"vec4 od = u_lamp_light_factors [ LAMP_INDEX ] ; vec3 oe = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 of = u_lamp_light_positions [ LAMP_INDEX ] ; float og = od . z ; if ( og != - UNITY_VALUE_NODES ) {".split(" ")},{type:"textline",b:"oa = of - lA ; ob = length ( oa ) ; oa = normalize ( oa ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",
c:["USE_OUT_oc"],f:[{type:"textline",b:"oc = og / ( og + ob * ob ) ; float oh = od . x ; float oi = od . y ; if ( oh > - UNITY_VALUE_NODES ) { float oj = dot ( oa , oe ) ; oj *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( oj - oh ) / oi ) ; oc *= oj ; }".split(" ")}]}]},{type:"textline",b:["}","else","{"]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oa"],f:[{type:"textline",b:["oa","=","oe",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ob"],f:[{type:"textline",
b:"ob = length ( of - lA ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_oc"],f:[{type:"textline",b:["oc","=","UNITY_VALUE_NODES",";"]}]}]},{type:"textline",b:["}"]}]},{type:"node",name:"NORMAL",g:[{type:"node_in",name:"ok",qualifier:["vec3"],e:!1},{type:"node_out",name:"ol",qualifier:["vec3"],e:!0},{type:"node_out",name:"om",qualifier:["float"],e:!0},{type:"node_param",name:"mT",qualifier:["vec3"]}],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ol"],f:[{type:"textline",
b:["ol","=","mT",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_om"],f:[{type:"textline",b:"om = - dot ( ok , mT ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_VECTOR_VIEW",g:[{type:"node_in",name:"on",qualifier:["vec3"],e:!1},{type:"node_out",name:"oo",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"oo = - ( u_view_matrix_frag * vec4 ( on , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{type:"node",name:"BSDF_ANISOTROPIC",g:[{type:"node_in",name:"op",qualifier:["vec3"],e:!1},{type:"node_in",
name:"oq",qualifier:["float"],e:!1},{type:"node_in",name:"or",qualifier:["float"],e:!1},{type:"node_in",name:"os",qualifier:["float"],e:!1},{type:"node_in",name:"ot",qualifier:["vec3"],e:!1},{type:"node_in",name:"ou",qualifier:["vec3"],e:!1},{type:"node_out",name:"ov",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["ov","=","op",";"]},{type:"textline",b:"oq ; or ; os ; ot ; ou ;".split(" ")}]},{type:"node",name:"BSDF_DIFFUSE",g:[{type:"node_in",name:"ow",qualifier:["vec3"],e:!1},{type:"node_in",
name:"ox",qualifier:["float"],e:!1},{type:"node_in",name:"oy",qualifier:["vec3"],e:!1},{type:"node_out",name:"oz",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["oz","=","ow",";"]},{type:"textline",b:["ox",";","oy",";"]}]},{type:"node",name:"BSDF_GLASS",g:[{type:"node_in",name:"oA",qualifier:["vec3"],e:!1},{type:"node_in",name:"oB",qualifier:["float"],e:!1},{type:"node_in",name:"oC",qualifier:["float"],e:!1},{type:"node_in",name:"oD",qualifier:["vec3"],e:!1},{type:"node_out",name:"oE",qualifier:["vec3"],
e:!1}],f:[{type:"textline",b:["oE","=","oA",";"]},{type:"textline",b:"oB ; oC ; oD ;".split(" ")}]},{type:"node",name:"BSDF_GLOSSY",g:[{type:"node_in",name:"oF",qualifier:["vec3"],e:!1},{type:"node_in",name:"oG",qualifier:["float"],e:!1},{type:"node_in",name:"oH",qualifier:["vec3"],e:!1},{type:"node_out",name:"oI",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["oI","=","oF",";"]},{type:"textline",b:["oG",";","oH",";"]}]},{type:"node",name:"BSDF_HAIR",g:[{type:"node_in",name:"oJ",qualifier:["vec3"],
e:!1},{type:"node_in",name:"oK",qualifier:["float"],e:!1},{type:"node_in",name:"oL",qualifier:["float"],e:!1},{type:"node_in",name:"oM",qualifier:["float"],e:!1},{type:"node_out",name:"oN",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["oN","=","oJ",";"]},{type:"textline",b:"oK ; oL ; oM ;".split(" ")}]},{type:"node",name:"BSDF_TRANSPARENT",g:[{type:"node_in",name:"oO",qualifier:["vec3"],e:!1},{type:"node_out",name:"oP",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["oP","=","oO",";"]}]},{type:"node",
name:"BSDF_TRANSLUCENT",g:[{type:"node_in",name:"oQ",qualifier:["vec3"],e:!1},{type:"node_in",name:"oR",qualifier:["vec3"],e:!1},{type:"node_out",name:"oS",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["oS","=","oQ",";"]},{type:"textline",b:["oR",";"]}]},{type:"node",name:"BSDF_REFRACTION",g:[{type:"node_in",name:"oT",qualifier:["vec3"],e:!1},{type:"node_in",name:"oU",qualifier:["float"],e:!1},{type:"node_in",name:"oV",qualifier:["float"],e:!1},{type:"node_in",name:"oW",qualifier:["vec3"],e:!1},
{type:"node_out",name:"oX",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"oX [ 0 ] = oX [ 1 ] = oX [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"oT ; oU ; oV ; oW ;".split(" ")}]},{type:"node",name:"BSDF_TOON",g:[{type:"node_in",name:"oY",qualifier:["vec3"],e:!1},{type:"node_in",name:"oZ",qualifier:["float"],e:!1},{type:"node_in",name:"o_",qualifier:["float"],e:!1},{type:"node_in",name:"pa",qualifier:["vec3"],e:!1},{type:"node_out",name:"pb",qualifier:["vec3"],e:!1}],f:[{type:"textline",
b:["pb","=","oY",";"]},{type:"textline",b:"oZ ; o_ ; pa ;".split(" ")}]},{type:"node",name:"BSDF_VELVET",g:[{type:"node_in",name:"pc",qualifier:["vec3"],e:!1},{type:"node_in",name:"pd",qualifier:["float"],e:!1},{type:"node_in",name:"pe",qualifier:["vec3"],e:!1},{type:"node_out",name:"pf",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["pf","=","pc",";"]},{type:"textline",b:["pd",";","pe",";"]}]},{type:"node",name:"SUBSURFACE_SCATTERING",g:[{type:"node_in",name:"pg",qualifier:["vec3"],e:!1},{type:"node_in",
name:"ph",qualifier:["float"],e:!1},{type:"node_in",name:"pi",qualifier:["vec3"],e:!1},{type:"node_in",name:"pj",qualifier:["float"],e:!1},{type:"node_in",name:"pk",qualifier:["float"],e:!1},{type:"node_in",name:"pl",qualifier:["vec3"],e:!1},{type:"node_out",name:"pm",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"pm [ 0 ] = pm [ 1 ] = pm [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"pg ; pi ; pj ; pk ; pl ; ph ;".split(" ")}]},{type:"node",name:"EMISSION",g:[{type:"node_in",name:"pn",
qualifier:["vec3"],e:!1},{type:"node_in",name:"po",qualifier:["float"],e:!1},{type:"node_out",name:"pp",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["pp","=","pn",";"]},{type:"textline",b:["po",";"]}]},{type:"node",name:"AMBIENT_OCCLUSION",g:[{type:"node_in",name:"pq",qualifier:["vec3"],e:!1},{type:"node_out",name:"pr",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"pr [ 0 ] = pr [ 1 ] = pr [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["pq",";"]}]},{type:"node",name:"HOLDOUT",g:[{type:"node_out",
name:"ps",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"ps [ 0 ] = ps [ 1 ] = ps [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"VOLUME_ABSORPTION",g:[{type:"node_in",name:"pt",qualifier:["vec3"],e:!1},{type:"node_in",name:"pu",qualifier:["float"],e:!1},{type:"node_out",name:"pv",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"pv [ 0 ] = pv [ 1 ] = pv [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["pt",";","pu",";"]}]},{type:"node",name:"VOLUME_SCATTER",g:[{type:"node_in",
name:"pw",qualifier:["vec3"],e:!1},{type:"node_in",name:"px",qualifier:["float"],e:!1},{type:"node_in",name:"py",qualifier:["float"],e:!1},{type:"node_out",name:"pz",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"pz [ 0 ] = pz [ 1 ] = pz [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:"pw ; px ; py ;".split(" ")}]},{type:"node",name:"BUMP",g:[{type:"node_in",name:"pA",qualifier:["float"],e:!1},{type:"node_in",name:"pB",qualifier:["float"],e:!1},{type:"node_in",name:"pC",qualifier:["float"],
e:!1},{type:"node_in",name:"pD",qualifier:["vec3"],e:!1},{type:"node_out",name:"pE",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["pE","=","pD",";"]},{type:"textline",b:"pA ; pB ; pC ;".split(" ")}]},{type:"node",name:"NORMAL_MAP",g:[{type:"node_in",name:"pF",qualifier:["float"],e:!1},{type:"node_in",name:"pG",qualifier:["vec3"],e:!1},{type:"node_out",name:"pH",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["pH","=","pG",";"]},{type:"textline",b:["pF",";"]}]},{type:"node",name:"VECT_TRANSFORM",
g:[{type:"node_in",name:"pI",qualifier:["vec3"],e:!1},{type:"node_out",name:"pJ",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"pJ [ 0 ] = pJ [ 1 ] = pJ [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["pI",";"]}]},{type:"node",name:"BLACKBODY",g:[{type:"node_in",name:"pK",qualifier:["float"],e:!1},{type:"node_out",name:"pL",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"pL [ 0 ] = pL [ 1 ] = pL [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["pK",";"]}]},{type:"node",name:"WAVELENGTH",
g:[{type:"node_in",name:"pM",qualifier:["float"],e:!1},{type:"node_out",name:"pN",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"pN [ 0 ] = pN [ 1 ] = pN [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["pM",";"]}]},{type:"node",name:"SEPXYZ",g:[{type:"node_in",name:"pO",qualifier:["vec3"],e:!1},{type:"node_out",name:"pP",qualifier:["float"],e:!1},{type:"node_out",name:"pQ",qualifier:["float"],e:!1},{type:"node_out",name:"pR",qualifier:["float"],e:!1}],f:[{type:"textline",b:"pP = pO [ 0 ] ; pQ = pO [ 1 ] ; pR = pO [ 2 ] ;".split(" ")}]},
{type:"node",name:"COMBXYZ",g:[{type:"node_in",name:"pS",qualifier:["float"],e:!1},{type:"node_in",name:"pT",qualifier:["float"],e:!1},{type:"node_in",name:"pU",qualifier:["float"],e:!1},{type:"node_out",name:"pV",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"pV [ 0 ] = pS ; pV [ 1 ] = pT ; pV [ 2 ] = pU ;".split(" ")}]},{type:"node",name:"BRIGHTCONTRAST",g:[{type:"node_in",name:"pW",qualifier:["vec3"],e:!1},{type:"node_in",name:"pX",qualifier:["float"],e:!1},{type:"node_in",name:"pY",qualifier:["float"],
e:!1},{type:"node_out",name:"pZ",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float p_ = pX - pY * 0.5 ; pZ = max ( ( UNITY_VALUE_NODES + pY ) * pW + p_ , mt ) ;".split(" ")}]},{type:"node",name:"LIGHT_FALLOFF",g:[{type:"node_in",name:"qa",qualifier:["float"],e:!1},{type:"node_in",name:"qb",qualifier:["float"],e:!1},{type:"node_out",name:"qc",qualifier:["float"],e:!1},{type:"node_out",name:"qd",qualifier:["float"],e:!1},{type:"node_out",name:"qe",qualifier:["float"],e:!1}],f:[{type:"textline",
b:"qc = qd = qe = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["qa",";","qb",";"]}]},{type:"node",name:"TEX_IMAGE",g:[{type:"node_in",name:"qf",qualifier:["vec3"],e:!1},{type:"node_out",name:"qg",qualifier:["vec3"],e:!1},{type:"node_out",name:"qh",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qg [ 0 ] = qg [ 1 ] = qg [ 2 ] = ZERO_VALUE_NODES ; qh = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["qf",";"]}]},{type:"node",name:"TEX_ENVIRONMENT",g:[{type:"node_in",name:"qi",qualifier:["vec3"],
e:!1},{type:"node_out",name:"qj",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"qj [ 0 ] = qj [ 1 ] = qj [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["qi",";"]}]},{type:"node",name:"TEX_SKY",g:[{type:"node_in",name:"qk",qualifier:["vec3"],e:!1},{type:"node_out",name:"ql",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"ql [ 0 ] = ql [ 1 ] = ql [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{type:"textline",b:["qk",";"]}]},{type:"node",name:"TEX_NOISE",g:[{type:"node_in",name:"qm",qualifier:["vec3"],
e:!1},{type:"node_in",name:"qn",qualifier:["float"],e:!1},{type:"node_in",name:"qo",qualifier:["float"],e:!1},{type:"node_in",name:"qp",qualifier:["float"],e:!1},{type:"node_out",name:"qq",qualifier:["vec3"],e:!1},{type:"node_out",name:"qr",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qq [ 0 ] = qq [ 1 ] = qq [ 2 ] = ZERO_VALUE_NODES ; qr = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"qm ; qn ; qo ; qp ;".split(" ")}]},{type:"node",name:"TEX_WAVE",g:[{type:"node_in",name:"qs",qualifier:["vec3"],
e:!1},{type:"node_in",name:"qt",qualifier:["float"],e:!1},{type:"node_in",name:"qu",qualifier:["float"],e:!1},{type:"node_in",name:"qv",qualifier:["float"],e:!1},{type:"node_in",name:"qw",qualifier:["float"],e:!1},{type:"node_out",name:"qx",qualifier:["vec3"],e:!1},{type:"node_out",name:"qy",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qx [ 0 ] = qx [ 1 ] = qx [ 2 ] = ZERO_VALUE_NODES ; qy = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"qs ; qt ; qu ; qv ; qw ;".split(" ")}]},{type:"node",
name:"TEX_VORONOI",g:[{type:"node_in",name:"qz",qualifier:["vec3"],e:!1},{type:"node_in",name:"qA",qualifier:["float"],e:!1},{type:"node_out",name:"qB",qualifier:["vec3"],e:!1},{type:"node_out",name:"qC",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qB [ 0 ] = qB [ 1 ] = qB [ 2 ] = ZERO_VALUE_NODES ; qC = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["qz",";","qA",";"]}]},{type:"node",name:"TEX_MUSGRAVE",g:[{type:"node_in",name:"qD",qualifier:["vec3"],e:!1},{type:"node_in",name:"qE",qualifier:["float"],
e:!1},{type:"node_in",name:"qF",qualifier:["float"],e:!1},{type:"node_in",name:"qG",qualifier:["float"],e:!1},{type:"node_in",name:"qH",qualifier:["float"],e:!1},{type:"node_in",name:"qI",qualifier:["float"],e:!1},{type:"node_in",name:"qJ",qualifier:["float"],e:!1},{type:"node_out",name:"qK",qualifier:["vec3"],e:!1},{type:"node_out",name:"qL",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qK [ 0 ] = qK [ 1 ] = qK [ 2 ] = ZERO_VALUE_NODES ; qL = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",
b:"qD ; qE ; qF ; qG ; qH ; qI ; qJ ;".split(" ")}]},{type:"node",name:"TEX_GRADIENT",g:[{type:"node_in",name:"qM",qualifier:["vec3"],e:!1},{type:"node_out",name:"qN",qualifier:["vec3"],e:!1},{type:"node_out",name:"qO",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qN [ 0 ] = qN [ 1 ] = qN [ 2 ] = ZERO_VALUE_NODES ; qO = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:["qM",";"]}]},{type:"node",name:"TEX_MAGIC",g:[{type:"node_in",name:"qP",qualifier:["vec3"],e:!1},{type:"node_in",name:"qQ",
qualifier:["float"],e:!1},{type:"node_in",name:"qR",qualifier:["float"],e:!1},{type:"node_out",name:"qS",qualifier:["vec3"],e:!1},{type:"node_out",name:"qT",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qS [ 0 ] = qS [ 1 ] = qS [ 2 ] = ZERO_VALUE_NODES ; qT = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"qP ; qQ ; qR ;".split(" ")}]},{type:"node",name:"TEX_CHECKER",g:[{type:"node_in",name:"qU",qualifier:["vec3"],e:!1},{type:"node_in",name:"qV",qualifier:["vec3"],e:!1},{type:"node_in",name:"qW",
qualifier:["vec3"],e:!1},{type:"node_in",name:"qX",qualifier:["float"],e:!1},{type:"node_out",name:"qY",qualifier:["vec3"],e:!1},{type:"node_out",name:"qZ",qualifier:["float"],e:!1}],f:[{type:"textline",b:"qY [ 0 ] = qY [ 1 ] = qY [ 2 ] = ZERO_VALUE_NODES ; qZ = UNITY_VALUE_NODES ;".split(" ")},{type:"textline",b:"qU ; qV ; qW ; qX ;".split(" ")}]},{type:"node",name:"TEX_BRICK",g:[{type:"node_in",name:"q_",qualifier:["vec3"],e:!1},{type:"node_in",name:"ra",qualifier:["vec3"],e:!1},{type:"node_in",
name:"rb",qualifier:["vec3"],e:!1},{type:"node_in",name:"rc",qualifier:["vec3"],e:!1},{type:"node_in",name:"rd",qualifier:["float"],e:!1},{type:"node_in",name:"re",qualifier:["float"],e:!1},{type:"node_in",name:"rf",qualifier:["float"],e:!1},{type:"node_in",name:"rg",qualifier:["float"],e:!1},{type:"node_in",name:"rh",qualifier:["float"],e:!1},{type:"node_out",name:"ri",qualifier:["vec3"],e:!1},{type:"node_out",name:"rj",qualifier:["float"],e:!1}],f:[{type:"textline",b:"ri [ 0 ] = ri [ 1 ] = ri [ 2 ] = ZERO_VALUE_NODES ; rj = UNITY_VALUE_NODES ;".split(" ")},
{type:"textline",b:"q_ ; ra ; rb ; rc ; rd ; re ; rf ; rg ; rh ;".split(" ")}]},{type:"node",name:"ADD_SHADER",g:[{type:"node_in",name:"rk",qualifier:["vec3"],e:!1},{type:"node_in",name:"rl",qualifier:["vec3"],e:!1},{type:"node_out",name:"rm",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"rm = clamp ( rk + rl , mt , mu ) ;".split(" ")}]},{type:"node",name:"MIX_SHADER",g:[{type:"node_in",name:"rn",qualifier:["float"],e:!1},{type:"node_in",name:"ro",qualifier:["vec3"],e:!1},{type:"node_in",name:"rp",
qualifier:["vec3"],e:!1},{type:"node_out",name:"rq",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float rr = clamp ( rn , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; rq = rr * ro + ( UNITY_VALUE_NODES - rr ) * rp ;".split(" ")}]},{type:"node",name:"UV_MERGED",g:[{type:"node_out",name:"rs",qualifier:["vec3"],e:!1},{type:"node_out",name:"rt",qualifier:["vec3"],e:!1},{type:"node_param",name:"mU",qualifier:["varying","vec2"]}],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rs"],f:[{type:"textline",
b:"rs = mL ( mU ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_rt"],f:[{type:"textline",b:"rt = vec3 ( mU , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"TEX_COORD_UV",g:[{type:"node_out",name:"ru",qualifier:["vec3"],e:!1},{type:"node_param",name:"mV",qualifier:["varying","vec2"]}],f:[{type:"textline",b:"ru = vec3 ( mV , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_NO",g:[{type:"node_out",name:"rv",qualifier:["vec3"],e:!1}],f:[{type:"textline",
b:["rv","=","nh",";"]}]},{type:"node",name:"TEX_COORD_GE",g:[{type:"node_out",name:"rw",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"rw = abs ( ms ) ;".split(" ")}]},{type:"node",name:"TEX_COORD_OB",g:[{type:"node_out",name:"rx",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"rx [ 0 ] = rx [ 1 ] = rx [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_CA",g:[{type:"node_out",name:"ry",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"ry [ 0 ] = nm [ 0 ] ; ry [ 1 ] = nm [ 1 ] ; ry [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"TEX_COORD_WI",g:[{type:"node_out",name:"rz",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"rz [ 0 ] = rz [ 1 ] = rz [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"TEX_COORD_RE",g:[{type:"node_out",name:"rA",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"rA [ 0 ] = rA [ 1 ] = rA [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{type:"node",name:"UVMAP",g:[{type:"node_out",name:"rB",qualifier:["vec3"],e:!1},{type:"node_param",name:"mW",qualifier:["varying","vec2"]}],
f:[{type:"textline",b:"rB = vec3 ( mW , ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"PARTICLE_INFO",g:[{type:"node_out",name:"rC",qualifier:["float"],e:!1},{type:"node_out",name:"rD",qualifier:["float"],e:!1},{type:"node_out",name:"rE",qualifier:["float"],e:!1},{type:"node_out",name:"rF",qualifier:["vec3"],e:!1},{type:"node_out",name:"rG",qualifier:["float"],e:!1},{type:"node_out",name:"rH",qualifier:["vec3"],e:!1},{type:"node_out",name:"rI",qualifier:["vec3"],e:!1}],f:[{type:"textline",
b:"rC = ZERO_VALUE_NODES ; rD = ZERO_VALUE_NODES ; rE = ZERO_VALUE_NODES ; rF = vec3 ( ZERO_VALUE_NODES ) ; rG = ZERO_VALUE_NODES ; rH = rF ; rI = rF ;".split(" ")}]},{type:"node",name:"HAIR_INFO",g:[{type:"node_out",name:"rJ",qualifier:["float"],e:!1},{type:"node_out",name:"rK",qualifier:["float"],e:!1},{type:"node_out",name:"rL",qualifier:["float"],e:!1},{type:"node_out",name:"rM",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"rJ = ZERO_VALUE_NODES ; rK = ZERO_VALUE_NODES ; rL = ZERO_VALUE_NODES ; rM = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"OBJECT_INFO",g:[{type:"node_out",name:"rN",qualifier:["vec3"],e:!1},{type:"node_out",name:"rO",qualifier:["float"],e:!1},{type:"node_out",name:"rP",qualifier:["float"],e:!1},{type:"node_out",name:"rQ",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rO = ZERO_VALUE_NODES ; rP = ZERO_VALUE_NODES ; rQ = ZERO_VALUE_NODES ; rN = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"WIREFRAME",g:[{type:"node_in",name:"rR",qualifier:["float"],e:!1},{type:"node_out",name:"rS",
qualifier:["float"],e:!1}],f:[{type:"textline",b:["rS","=","rR",";"]}]},{type:"node",name:"TANGENT",g:[{type:"node_out",name:"rT",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"rT = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{type:"node",name:"LAYER_WEIGHT",g:[{type:"node_in",name:"rU",qualifier:["float"],e:!1},{type:"node_in",name:"rV",qualifier:["vec3"],e:!1},{type:"node_out",name:"rW",qualifier:["float"],e:!1},{type:"node_out",name:"rX",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rW = rX = ZERO_VALUE_NODES ;".split(" ")},
{type:"textline",b:["rV",";","rU",";"]}]},{type:"node",name:"LIGHT_PATH",g:[{type:"node_out",name:"rY",qualifier:["float"],e:!1},{type:"node_out",name:"rZ",qualifier:["float"],e:!1},{type:"node_out",name:"r_",qualifier:["float"],e:!1},{type:"node_out",name:"sa",qualifier:["float"],e:!1},{type:"node_out",name:"sb",qualifier:["float"],e:!1},{type:"node_out",name:"sc",qualifier:["float"],e:!1},{type:"node_out",name:"sd",qualifier:["float"],e:!1},{type:"node_out",name:"se",qualifier:["float"],e:!1},{type:"node_out",
name:"sf",qualifier:["float"],e:!1},{type:"node_out",name:"sg",qualifier:["float"],e:!1}],f:[{type:"textline",b:"rY = rZ = r_ = ZERO_VALUE_NODES ; sa = sb = sc = ZERO_VALUE_NODES ; sd = sd = sf = sg = ZERO_VALUE_NODES ; se = ZERO_VALUE_NODES ;".split(" ")}]},{type:"node",name:"ATTRIBUTE",g:[{type:"node_out",name:"sh",qualifier:["vec3"],e:!1},{type:"node_out",name:"si",qualifier:["vec3"],e:!1},{type:"node_out",name:"sj",qualifier:["float"],e:!1}],f:[{type:"textline",b:"sh = si = vec3 ( ZERO_VALUE_NODES ) ; sj = ZERO_VALUE_NODES ;".split(" ")}]},
{type:"node",name:"SCRIPT",g:[],f:[]},{type:"node",name:"CURVE_VEC",g:[{type:"node_in",name:"sk",qualifier:["float"],e:!1},{type:"node_in",name:"sl",qualifier:["vec3"],e:!1},{type:"node_out",name:"sm",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:["sm","=","sl",";"]},{type:"textline",b:["sk",";"]}]},{type:"node",name:"CURVE_RGB",g:[{type:"node_in",name:"sn",qualifier:["float"],e:!1},{type:"node_in",name:"so",qualifier:["vec3"],e:!1},{type:"node_out",name:"sp",qualifier:["vec3"],e:!1}],f:[{type:"textline",
b:["sp","=","so",";"]},{type:"textline",b:["sn",";"]}]},{type:"node",name:"VALTORGB",g:[{type:"node_in",name:"sq",qualifier:["float"],e:!1},{type:"node_out",name:"sr",qualifier:["vec3"],e:!1},{type:"node_out",name:"ss",qualifier:["float"],e:!1}],f:[{type:"textline",b:"sr [ 0 ] = sr [ 1 ] = sr [ 2 ] = clamp ( sq , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; ss = sr [ 0 ] ;".split(" ")}]},{type:"node",name:"MAPPING",g:[{type:"node_in",name:"st",qualifier:["vec3"],e:!1},{type:"node_out",name:"su",qualifier:["vec3"],
e:!1}],f:[{type:"textline",b:["su","=","st",";"]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_TRS_MATRIX",f:[{type:"textline",b:"su = ( MAPPING_TRS_MATRIX * vec4 ( su , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_SCALE",f:[{type:"textline",b:"su = su * MAPPING_SCALE ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_TRANSLATION",f:[{type:"textline",b:"su = su + MAPPING_TRANSLATION ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_MIN_CLIP",f:[{type:"textline",b:"su = max ( su , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_ifdef",name:"MAPPING_MAX_CLIP",f:[{type:"textline",b:"su = min ( su , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["MAPPING_IS_NORMAL"],f:[{type:"textline",b:"su = normalize ( su ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ADD",g:[{type:"node_in",name:"sv",qualifier:["float"],
e:!1},{type:"node_in",name:"sw",qualifier:["float"],e:!1},{type:"node_out",name:"sx",qualifier:["float"],e:!1}],f:[{type:"textline",b:"sx = sv + sw ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"sx = clamp ( sx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_SUBTRACT",g:[{type:"node_in",name:"sy",qualifier:["float"],e:!1},{type:"node_in",name:"sz",qualifier:["float"],e:!1},{type:"node_out",name:"sA",qualifier:["float"],
e:!1}],f:[{type:"textline",b:"sA = sy - sz ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"sA = clamp ( sA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MULTIPLY",g:[{type:"node_in",name:"sB",qualifier:["float"],e:!1},{type:"node_in",name:"sC",qualifier:["float"],e:!1},{type:"node_out",name:"sD",qualifier:["float"],e:!1}],f:[{type:"textline",b:"sD = sB * sC ;".split(" ")},{type:"node_condition",a:[{type:"node_if",
c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"sD = clamp ( sD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_DIVIDE",g:[{type:"node_in",name:"sE",qualifier:["float"],e:!1},{type:"node_in",name:"sF",qualifier:["float"],e:!1},{type:"node_out",name:"sG",qualifier:["float"],e:!1}],f:[{type:"textline",b:"sG = ( sF != ZERO_VALUE_NODES ) ? sE / sF : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"sG = clamp ( sG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_SINE",g:[{type:"node_in",name:"sH",qualifier:["float"],e:!1},{type:"node_in",name:"sI",qualifier:["float"],e:!1},{type:"node_out",name:"sJ",qualifier:["float"],e:!1}],f:[{type:"textline",b:"sJ = sin ( sH ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"sJ = clamp ( sJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["sI",";"]}]},{type:"node",name:"MATH_COSINE",g:[{type:"node_in",name:"sK",
qualifier:["float"],e:!1},{type:"node_in",name:"sL",qualifier:["float"],e:!1},{type:"node_out",name:"sM",qualifier:["float"],e:!1}],f:[{type:"textline",b:"sM = cos ( sK ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"sM = clamp ( sM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["sL",";"]}]},{type:"node",name:"MATH_TANGENT",g:[{type:"node_in",name:"sN",qualifier:["float"],e:!1},{type:"node_in",name:"sO",qualifier:["float"],
e:!1},{type:"node_out",name:"sP",qualifier:["float"],e:!1}],f:[{type:"textline",b:"sP = tan ( sN ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"sP = clamp ( sP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["sO",";"]}]},{type:"node",name:"MATH_ARCSINE",g:[{type:"node_in",name:"sQ",qualifier:["float"],e:!1},{type:"node_in",name:"sR",qualifier:["float"],e:!1},{type:"node_out",name:"sS",qualifier:["float"],e:!1}],
f:[{type:"textline",b:"sS = ( sQ <= UNITY_VALUE_NODES && sQ >= - UNITY_VALUE_NODES ) ? asin ( sQ ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"sS = clamp ( sS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["sR",";"]}]},{type:"node",name:"MATH_ARCCOSINE",g:[{type:"node_in",name:"sT",qualifier:["float"],e:!1},{type:"node_in",name:"sU",qualifier:["float"],e:!1},{type:"node_out",name:"sV",qualifier:["float"],
e:!1}],f:[{type:"textline",b:"sV = ( sT <= UNITY_VALUE_NODES && sT >= - UNITY_VALUE_NODES ) ? acos ( sT ) : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"sV = clamp ( sV , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["sU",";"]}]},{type:"node",name:"MATH_ARCTANGENT",g:[{type:"node_in",name:"sW",qualifier:["float"],e:!1},{type:"node_in",name:"sX",qualifier:["float"],e:!1},{type:"node_out",name:"sY",
qualifier:["float"],e:!1}],f:[{type:"textline",b:"sY = atan ( sW ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"sY = clamp ( sY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["sX",";"]}]},{type:"node",name:"MATH_POWER",g:[{type:"node_in",name:"sZ",qualifier:["float"],e:!1},{type:"node_in",name:"s_",qualifier:["float"],e:!1},{type:"node_out",name:"ta",qualifier:["float"],e:!1}],f:[{type:"textline",b:"if ( sZ < ZERO_VALUE_NODES || sZ == ZERO_VALUE_NODES && s_ == ZERO_VALUE_NODES ) ta = ZERO_VALUE_NODES ; else ta = pow ( sZ , s_ ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"ta = clamp ( ta , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_LOGARITHM",g:[{type:"node_in",name:"tb",qualifier:["float"],e:!1},{type:"node_in",name:"tc",qualifier:["float"],e:!1},{type:"node_out",name:"td",qualifier:["float"],e:!1}],f:[{type:"textline",b:"td = ( tb > ZERO_VALUE_NODES && tc > ZERO_VALUE_NODES ) ? log2 ( tb ) / log2 ( tc ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"td = clamp ( td , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MINIMUM",g:[{type:"node_in",name:"te",qualifier:["float"],e:!1},{type:"node_in",name:"tf",qualifier:["float"],e:!1},{type:"node_out",name:"tg",qualifier:["float"],e:!1}],f:[{type:"textline",b:"tg = min ( te , tf ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"tg = clamp ( tg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MATH_MAXIMUM",g:[{type:"node_in",name:"th",qualifier:["float"],e:!1},{type:"node_in",name:"ti",qualifier:["float"],e:!1},{type:"node_out",name:"tj",qualifier:["float"],e:!1}],f:[{type:"textline",b:"tj = max ( th , ti ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"tj = clamp ( tj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ROUND",g:[{type:"node_in",name:"tk",qualifier:["float"],e:!1},
{type:"node_in",name:"tl",qualifier:["float"],e:!1},{type:"node_out",name:"tm",qualifier:["float"],e:!1}],f:[{type:"textline",b:"tm = floor ( tk + 0.5 ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"tm = clamp ( tm , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{type:"textline",b:["tl",";"]}]},{type:"node",name:"MATH_LESS_THAN",g:[{type:"node_in",name:"tn",qualifier:["float"],e:!1},{type:"node_in",name:"to",qualifier:["float"],e:!1},
{type:"node_out",name:"tp",qualifier:["float"],e:!1}],f:[{type:"textline",b:"tp = ( tn < to ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"tp = clamp ( tp , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_GREATER_THAN",g:[{type:"node_in",name:"tq",qualifier:["float"],e:!1},{type:"node_in",name:"tr",qualifier:["float"],e:!1},{type:"node_out",name:"ts",qualifier:["float"],
e:!1}],f:[{type:"textline",b:"ts = ( tq > tr ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"ts = clamp ( ts , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_MODULO",g:[{type:"node_in",name:"tt",qualifier:["float"],e:!1},{type:"node_in",name:"tu",qualifier:["float"],e:!1},{type:"node_out",name:"tv",qualifier:["float"],e:!1}],f:[{type:"textline",b:"tv = abs ( tu ) > 0.000001 ? mod ( tt , tu ) : ZERO_VALUE_NODES ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"tv = clamp ( tv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MATH_ABSOLUTE",g:[{type:"node_in",name:"tw",qualifier:["float"],e:!1},{type:"node_in",name:"tx",qualifier:["float"],e:!1},{type:"node_out",name:"ty",qualifier:["float"],e:!1}],f:[{type:"textline",b:"ty = abs ( tw ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MATH_USE_CLAMP"],f:[{type:"textline",b:"ty = clamp ( ty , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{type:"textline",b:["tx",";"]}]},{type:"node",name:"MIX_RGB_MIX",g:[{type:"node_in",name:"tz",qualifier:["float"],e:!1},{type:"node_in",name:"tA",qualifier:["vec3"],e:!1},{type:"node_in",name:"tB",qualifier:["vec3"],e:!1},{type:"node_out",name:"tC",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float tD = clamp ( tz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; tC = mix ( tA , tB , tD ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"tC = clamp ( tC , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_ADD",g:[{type:"node_in",name:"tE",qualifier:["float"],e:!1},{type:"node_in",name:"tF",qualifier:["vec3"],e:!1},{type:"node_in",name:"tG",qualifier:["vec3"],e:!1},{type:"node_out",name:"tH",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float tI = clamp ( tE , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; tH = mix ( tF , tF + tG , tI ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"tH = clamp ( tH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_MULTIPLY",g:[{type:"node_in",name:"tJ",qualifier:["float"],e:!1},{type:"node_in",name:"tK",qualifier:["vec3"],e:!1},{type:"node_in",name:"tL",qualifier:["vec3"],e:!1},{type:"node_out",name:"tM",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float tN = clamp ( tJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; tM = mix ( tK , tK * tL , tN ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"tM = clamp ( tM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SUBTRACT",g:[{type:"node_in",name:"tO",qualifier:["float"],e:!1},{type:"node_in",name:"tP",qualifier:["vec3"],e:!1},{type:"node_in",name:"tQ",qualifier:["vec3"],e:!1},{type:"node_out",name:"tR",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float tS = clamp ( tO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; tR = mix ( tP , tP - tQ , tS ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"tR = clamp ( tR , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{type:"node",name:"MIX_RGB_SCREEN",g:[{type:"node_in",name:"tT",qualifier:["float"],e:!1},{type:"node_in",name:"tU",qualifier:["vec3"],e:!1},{type:"node_in",name:"tV",qualifier:["vec3"],e:!1},{type:"node_out",name:"tW",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float tX = clamp ( tT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float tY = UNITY_VALUE_NODES - tX ; tW = mu - ( vec3 ( tY ) + tX * ( mu - tV ) ) * ( mu - tU ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],
f:[{type:"textline",b:"tW = clamp ( tW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIVIDE",g:[{type:"node_in",name:"tZ",qualifier:["float"],e:!1},{type:"node_in",name:"t_",qualifier:["vec3"],e:!1},{type:"node_in",name:"ua",qualifier:["vec3"],e:!1},{type:"node_out",name:"ub",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float uc = clamp ( tZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float ud = UNITY_VALUE_NODES - uc ; ua += step ( ua , mt ) ; ub = ud * t_ + uc * t_ / ua ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"ub = clamp ( ub , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DIFFERENCE",g:[{type:"node_in",name:"ue",qualifier:["float"],e:!1},{type:"node_in",name:"uf",qualifier:["vec3"],e:!1},{type:"node_in",name:"ug",qualifier:["vec3"],e:!1},{type:"node_out",name:"uh",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float ui = clamp ( ue , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; uh = mix ( uf , abs ( uf - ug ) , ui ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"uh = clamp ( uh , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DARKEN",g:[{type:"node_in",name:"uj",qualifier:["float"],e:!1},{type:"node_in",name:"uk",qualifier:["vec3"],e:!1},{type:"node_in",name:"ul",qualifier:["vec3"],e:!1},{type:"node_out",name:"um",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float un = clamp ( uj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; um = min ( uk . rgb , ul . rgb * un ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"um = clamp ( um , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LIGHTEN",g:[{type:"node_in",name:"uo",qualifier:["float"],e:!1},{type:"node_in",name:"up",qualifier:["vec3"],e:!1},{type:"node_in",name:"uq",qualifier:["vec3"],e:!1},{type:"node_out",name:"ur",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float us = clamp ( uo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; ur = max ( up . rgb , uq . rgb * us ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"ur = clamp ( ur , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_OVERLAY",g:[{type:"node_in",name:"ut",qualifier:["float"],e:!1},{type:"node_in",name:"uu",qualifier:["vec3"],e:!1},{type:"node_in",name:"uv",qualifier:["vec3"],e:!1},{type:"node_out",name:"uw",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float ux = clamp ( ut , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 uy = vec3 ( UNITY_VALUE_NODES - ux ) ; uw = mix ( uu * ( uy + 2.0 * ux * uv ) , mu - ( uy + 2.0 * ux * ( mu - uv ) ) * ( mu - uu ) , step ( 0.5 , uu ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"uw = clamp ( uw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_DODGE",g:[{type:"node_in",name:"uz",qualifier:["float"],e:!1},{type:"node_in",name:"uA",qualifier:["vec3"],e:!1},{type:"node_in",name:"uB",qualifier:["vec3"],e:!1},{type:"node_out",name:"uC",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float uD = clamp ( uz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 uE = mu - uD * uB ; vec3 uF = clamp ( uA / uE , 0.0 , 1.0 ) ; uC = mix ( mix ( uF , mu , step ( uE , mt ) ) , uA , step ( uA , mt ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"uC = clamp ( uC , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_BURN",g:[{type:"node_in",name:"uG",qualifier:["float"],e:!1},{type:"node_in",name:"uH",qualifier:["vec3"],e:!1},{type:"node_in",name:"uI",qualifier:["vec3"],e:!1},{type:"node_out",name:"uJ",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float uK = clamp ( uG , 0.0 , 1.0 ) ; vec3 uL = vec3 ( 1.0 - uK ) ; vec3 uM = uL + uK * uI ; vec3 uN = clamp ( mu - ( mu - uH ) / uM , 0.0 , 1.0 ) ; uJ = mix ( uN , mt , step ( uM , mt ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"uJ = clamp ( uJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_HUE",g:[{type:"node_in",name:"uO",qualifier:["float"],e:!1},{type:"node_in",name:"uP",qualifier:["vec3"],e:!1},{type:"node_in",name:"uQ",qualifier:["vec3"],e:!1},{type:"node_out",name:"uR",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float uS = clamp ( uO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 uT , uU , uV ; uR = uP ; uU = mF ( uQ ) ; if ( uU . y != ZERO_VALUE_NODES ) { uT = mF ( uR ) ; uT . x = uU . x ; uV = mJ ( uT ) ; uR = mix ( uR , uV , uS ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"uR = clamp ( uR , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SATURATION",g:[{type:"node_in",name:"uW",qualifier:["float"],e:!1},{type:"node_in",name:"uX",qualifier:["vec3"],e:!1},{type:"node_in",name:"uY",qualifier:["vec3"],e:!1},{type:"node_out",name:"uZ",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float u_ = clamp ( uW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float va = UNITY_VALUE_NODES - u_ ; uZ = uX ; vec3 vb , vc ; vb = mF ( uZ ) ; if ( vb . y != ZERO_VALUE_NODES ) { vc = mF ( uY ) ; vb . y = va * vb . y + u_ * vc . y ; uZ = mJ ( vb ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"uZ = clamp ( uZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_VALUE",g:[{type:"node_in",name:"vd",qualifier:["float"],e:!1},{type:"node_in",name:"ve",qualifier:["vec3"],e:!1},{type:"node_in",name:"vf",qualifier:["vec3"],e:!1},{type:"node_out",name:"vg",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float vh = clamp ( vd , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float vi = UNITY_VALUE_NODES - vh ; vec3 vj , vk ; vj = mF ( ve ) ; vk = mF ( vf ) ; vj . z = vi * vj . z + vh * vk . z ; vg = mJ ( vj ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"vg = clamp ( vg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_COLOR",g:[{type:"node_in",name:"vl",qualifier:["float"],e:!1},{type:"node_in",name:"vm",qualifier:["vec3"],e:!1},{type:"node_in",name:"vn",qualifier:["vec3"],e:!1},{type:"node_out",name:"vo",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float vp = clamp ( vl , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 vq , vr , vs ; vo = vm ; vr = mF ( vn ) ; if ( vr . y != ZERO_VALUE_NODES ) { vq = mF ( vo ) ; vq . x = vr . x ; vq . y = vr . y ; vs = mJ ( vq ) ; vo = mix ( vo , vs , vp ) ; }".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"vo = clamp ( vo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_SOFT_LIGHT",g:[{type:"node_in",name:"vt",qualifier:["float"],e:!1},{type:"node_in",name:"vu",qualifier:["vec3"],e:!1},{type:"node_in",name:"vv",qualifier:["vec3"],e:!1},{type:"node_out",name:"vw",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float vx = clamp ( vt , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float vy = UNITY_VALUE_NODES - vx ; vec3 vz = vv + vu - vv * vu ; vw = vu * ( vec3 ( vy ) + vec3 ( vx ) * ( ( mu - vu ) * vv + vz ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"vw = clamp ( vw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"MIX_RGB_LINEAR_LIGHT",g:[{type:"node_in",name:"vA",qualifier:["float"],e:!1},{type:"node_in",name:"vB",qualifier:["vec3"],e:!1},{type:"node_in",name:"vC",qualifier:["vec3"],e:!1},{type:"node_out",name:"vD",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"float vE = clamp ( vA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vD = vB + vE * ( 2.0 * vC - mu ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["MIX_RGB_USE_CLAMP"],f:[{type:"textline",b:"vD = clamp ( vD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{type:"node",name:"OUTPUT",g:[{type:"node_in",name:"vF",qualifier:["vec3"],e:!1},{type:"node_in",name:"vG",qualifier:["float"],e:!1}],f:[{type:"textline",b:"nb = vF ; nf = vG ;".split(" ")}]},{type:"node",name:"MATERIAL",g:[{type:"node_in",name:"vH",qualifier:["vec3"],e:!1},{type:"node_in",name:"vI",qualifier:["float"],e:!1},{type:"node_in",
name:"vJ",qualifier:["vec3"],e:!1},{type:"node_in",name:"vK",qualifier:["vec3"],e:!0},{type:"node_out",name:"vL",qualifier:["vec3"],e:!0},{type:"node_out",name:"vM",qualifier:["float"],e:!0},{type:"node_out",name:"vN",qualifier:["vec3"],e:!0},{type:"node_param",name:"mX",qualifier:["const","vec2"]},{type:"node_param",name:"mY",qualifier:["const","vec3"]}],f:[{type:"textline",b:"vec3 vO = clamp ( vH , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",b:"vec3 vP = mY [ 0 ] * clamp ( vJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_NORMAL"],f:[{type:"textline",b:"vec3 vQ = normalize ( vK ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:["vec3","vQ","=","nh",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["!","SHADELESS_MAT","&&","!","NODES_GLOW"],f:[{type:"textline",b:"vec3 vR = nn * vO ;".split(" ")},{type:"textline",b:"vec3 vS = np * u_environment_energy * mr ( vQ ) ; float vT = fp ( vO ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["NUM_LIGHTS",
">","0"],f:[{type:"textline",b:"vec2 vU = vec2 ( mX [ 0 ] , mX [ 1 ] ) ;".split(" ")},{type:"textline",b:"vec2 vV = vec2 ( mY [ 1 ] , mY [ 2 ] ) ; nq = kU ( vR , vS , vO , vP , nl , vQ , na , vV , vU , vT , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , ZERO_VALUE_NODES , vec4 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:"nq = kZ ( vR , vS , vO ) ;".split(" ")}]}]},{type:"textline",b:["ne","=","vT",";"]}]},{type:"node_else",
f:[{type:"textline",b:"nq . a = vec4 ( vO , ZERO_VALUE_NODES ) ; nq . b = mt ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vL"],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",b:"vL = nq . a . rgb ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:["vL","=","mt",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",b:"vL += nq . b ;".split(" ")}]}]}]}]},{type:"node_condition",
a:[{type:"node_if",c:["USE_OUT_vM"],f:[{type:"textline",b:"vM = clamp ( vI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",b:"vM += nq . a . a * vP . r * no ; vM = clamp ( vM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_vN"],f:[{type:"textline",b:["vN","=","vQ",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],
f:[{type:"textline",b:"nc = nq . b ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:["nc","=","mt",";"]}]}]},{type:"textline",b:["nd","=","vQ",";"]}]},{type:"node",name:"MATERIAL_EXT",g:[{type:"node_in",name:"vW",qualifier:["vec3"],e:!1},{type:"node_in",name:"vX",qualifier:["float"],e:!1},{type:"node_in",name:"vY",qualifier:["vec3"],e:!1},{type:"node_in",name:"vZ",qualifier:["vec3"],e:!0},{type:"node_in",name:"v_",qualifier:["float"],e:!1},{type:"node_in",name:"wa",qualifier:["float"],e:!1},
{type:"node_in",name:"wb",qualifier:["vec4"],e:!1},{type:"node_in",name:"wc",qualifier:["float"],e:!1},{type:"node_in",name:"wd",qualifier:["float"],e:!1},{type:"node_out",name:"we",qualifier:["vec3"],e:!0},{type:"node_out",name:"wf",qualifier:["float"],e:!0},{type:"node_out",name:"wg",qualifier:["vec3"],e:!0},{type:"node_out",name:"wh",qualifier:["vec3"],e:!0},{type:"node_out",name:"wi",qualifier:["vec3"],e:!0},{type:"node_param",name:"mZ",qualifier:["const","vec2"]},{type:"node_param",name:"m_",
qualifier:["const","vec3"]}],f:[{type:"textline",b:"vec3 wj = clamp ( vW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"textline",b:"vec3 wk = m_ [ 0 ] * clamp ( vY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_NORMAL"],f:[{type:"textline",b:"vec3 wl = normalize ( vZ ) ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:["vec3","wl","=","nh",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["!","SHADELESS_MAT",
"&&","!","NODES_GLOW"],f:[{type:"textline",b:"float wm = fp ( wj ) ;".split(" ")},{type:"textline",b:"vec3 wn = v_ * wj ;".split(" ")},{type:"textline",b:"vec3 wo = np * u_environment_energy * mr ( wl ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["NUM_LIGHTS",">","0"],f:[{type:"textline",b:"vec2 wp = vec2 ( mZ [ 0 ] , mZ [ 1 ] ) ; vec2 wq = vec2 ( m_ [ 1 ] , m_ [ 2 ] ) ; nq = kU ( wn , wo , wj , wk , nl , wl , na , wq , wp , wm , u_light_positions , u_light_directions , u_light_color_intensities , u_light_factors , wa , wb ) ;".split(" ")}]},
{type:"node_else",f:[{type:"textline",b:"nq = kZ ( wn , wo , wj ) ;".split(" ")}]}]},{type:"textline",b:["ne","=","wm",";"]}]},{type:"node_else",f:[{type:"textline",b:"nq . a = vec4 ( wj , ZERO_VALUE_NODES ) ; nq . b = mt ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_we"],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_DIFFUSE"],f:[{type:"textline",b:"we = nq . a . rgb ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:["we","=","mt",";"]}]}]},{type:"node_condition",
a:[{type:"node_if",c:["REFLECTION_TYPE","!=","REFL_NONE"],f:[{type:"textline",b:"ma ( we , na , wl , wc ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",b:"we += nq . b ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wf"],f:[{type:"textline",b:"wf = clamp ( vX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",b:"wf += nq . a . a * wk . r * wd ; wf = clamp ( wf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wg"],f:[{type:"textline",b:["wg","=","wl",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wh"],f:[{type:"textline",b:"wh = nq . a . rgb ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wi"],f:[{type:"textline",b:"wi = nq . b ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_MATERIAL_SPECULAR"],f:[{type:"textline",b:"nc = nq . b ;".split(" ")}]},{type:"node_else",f:[{type:"textline",b:["nc",
"=","mt",";"]}]}]},{type:"textline",b:["nd","=","wl",";"]}]},{type:"node",name:"RGB",g:[{type:"node_out",name:"wr",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"wr = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{type:"node",name:"RGBTOBW",g:[{type:"node_in",name:"ws",qualifier:["vec3"],e:!1},{type:"node_out",name:"wt",qualifier:["float"],e:!1}],f:[{type:"textline",b:"wt = ws . r * 0.35 + ws . g * 0.45 + ws . b * 0.2 ;".split(" ")}]},{type:"node",name:"SEPRGB",g:[{type:"node_in",name:"wu",qualifier:["vec3"],
e:!1},{type:"node_out",name:"wv",qualifier:["float"],e:!0},{type:"node_out",name:"ww",qualifier:["float"],e:!0},{type:"node_out",name:"wx",qualifier:["float"],e:!0}],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wv"],f:[{type:"textline",b:"wv = wu . r ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_ww"],f:[{type:"textline",b:"ww = wu . g ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wx"],f:[{type:"textline",b:"wx = wu . b ;".split(" ")}]}]}]},
{type:"node",name:"SEPHSV",g:[{type:"node_in",name:"wy",qualifier:["vec3"],e:!1},{type:"node_out",name:"wz",qualifier:["float"],e:!0},{type:"node_out",name:"wA",qualifier:["float"],e:!0},{type:"node_out",name:"wB",qualifier:["float"],e:!0}],f:[{type:"textline",b:"vec3 wC = mF ( wy ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wz"],f:[{type:"textline",b:"wz = wC . r ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wA"],f:[{type:"textline",b:"wA = wC . g ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wB"],f:[{type:"textline",b:"wB = wC . b ;".split(" ")}]}]}]},{type:"node",name:"SQUEEZE",g:[{type:"node_in",name:"wD",qualifier:["float"],e:!1},{type:"node_in",name:"wE",qualifier:["float"],e:!1},{type:"node_in",name:"wF",qualifier:["float"],e:!1},{type:"node_out",name:"wG",qualifier:["float"],e:!1}],f:[{type:"textline",b:"wG = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( ( wD - wF ) * wE ) ) ) ;".split(" ")}]},{type:"node",
name:"GAMMA",g:[{type:"node_in",name:"wH",qualifier:["vec3"],e:!1},{type:"node_in",name:"wI",qualifier:["float"],e:!1},{type:"node_out",name:"wJ",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"wJ = max ( mt , wH ) ; wJ = pow ( wJ , vec3 ( wI ) ) ;".split(" ")}]},{type:"node",name:"B4W_SRGB_TO_LINEAR",g:[{type:"node_in",name:"wK",qualifier:["vec3"],e:!1},{type:"node_out",name:"wL",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"wL = max ( mt , wK ) ; wL = pow ( wL , vec3 ( 2.2 ) ) ;".split(" ")}]},
{type:"node",name:"B4W_LINEAR_TO_SRGB",g:[{type:"node_in",name:"wM",qualifier:["vec3"],e:!1},{type:"node_out",name:"wN",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"wN = max ( mt , wM ) ; wN = pow ( wN , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{type:"node",name:"TEXTURE_EMPTY",g:[{type:"node_out",name:"wO",qualifier:["vec3"],e:!1},{type:"node_out",name:"wP",qualifier:["vec3"],e:!1},{type:"node_out",name:"wQ",qualifier:["float"],e:!1}],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wQ"],
f:[{type:"textline",b:"wO [ 2 ] = wO [ 1 ] = wO [ 0 ] = 0.0 ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wQ"],f:[{type:"textline",b:"wP [ 2 ] = wP [ 1 ] = wP [ 0 ] = 0.0 ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wQ"],f:[{type:"textline",b:["wQ","=","0.0",";"]}]}]}]},{type:"node",name:"TEXTURE_ENVIRONMENT",g:[{type:"node_in",name:"wR",qualifier:["vec3"],e:!1},{type:"node_out",name:"wS",qualifier:["vec3"],e:!0},{type:"node_out",name:"wT",qualifier:["float"],
e:!0},{type:"node_param",name:"node_TEXTURE_ENVIRONMENT_var_texture",qualifier:["uniform","samplerCube"]}],f:[{type:"textline",b:"vec4 wU = textureCube ( node_TEXTURE_ENVIRONMENT_var_texture , wR ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wS"],f:[{type:"textline",b:"wS = wU . xyz ; gv ( wS ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wT"],f:[{type:"textline",b:"wT = wU . w ;".split(" ")}]}]}]},{type:"node",name:"TEXTURE_COLOR",g:[{type:"node_in",
name:"wV",qualifier:["vec3"],e:!0},{type:"node_in",name:"wW",qualifier:["vec3"],e:!0},{type:"node_in",name:"wX",qualifier:["vec3"],e:!0},{type:"node_in",name:"wY",qualifier:["vec3"],e:!0},{type:"node_out",name:"wZ",qualifier:["vec3"],e:!0},{type:"node_out",name:"w_",qualifier:["float"],e:!0},{type:"node_out",name:"xa",qualifier:["vec3"],e:!0},{type:"node_out",name:"xb",qualifier:["float"],e:!0},{type:"node_out",name:"xc",qualifier:["vec3"],e:!0},{type:"node_out",name:"xd",qualifier:["float"],e:!0},
{type:"node_out",name:"xe",qualifier:["vec3"],e:!0},{type:"node_out",name:"xf",qualifier:["float"],e:!0},{type:"node_param",name:"node_TEXTURE_COLOR_var_texture",qualifier:["uniform","sampler2D"]}],f:[{type:"textline",b:"vec4 xg = texture2D ( node_TEXTURE_COLOR_var_texture , mN ( wV ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_wZ"],f:[{type:"textline",b:"wZ = xg . xyz ; gv ( wZ ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_w_"],f:[{type:"textline",
b:"w_ = xg . w ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv2"],f:[{type:"textline",b:"xg = texture2D ( node_TEXTURE_COLOR_var_texture , mN ( wW ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xa"],f:[{type:"textline",b:"xa = xg . xyz ; gv ( xa ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xb"],f:[{type:"textline",b:"xb = xg . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv3"],f:[{type:"textline",
b:"xg = texture2D ( node_TEXTURE_COLOR_var_texture , mN ( wX ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xc"],f:[{type:"textline",b:"xc = xg . xyz ; gv ( xc ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xd"],f:[{type:"textline",b:"xd = xg . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv4"],f:[{type:"textline",b:"xg = texture2D ( node_TEXTURE_COLOR_var_texture , mN ( wY ) ) ;".split(" ")},{type:"node_condition",
a:[{type:"node_if",c:["USE_OUT_xe"],f:[{type:"textline",b:"xe = xg . xyz ; gv ( xe ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xf"],f:[{type:"textline",b:"xf = xg . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"TEXTURE_NORMAL",g:[{type:"node_in",name:"xh",qualifier:["vec3"],e:!0},{type:"node_in",name:"xi",qualifier:["vec3"],e:!0},{type:"node_in",name:"xj",qualifier:["vec3"],e:!0},{type:"node_in",name:"xk",qualifier:["vec3"],e:!0},{type:"node_out",name:"xl",qualifier:["vec3"],
e:!0},{type:"node_out",name:"xm",qualifier:["float"],e:!0},{type:"node_out",name:"xn",qualifier:["vec3"],e:!0},{type:"node_out",name:"xo",qualifier:["float"],e:!0},{type:"node_out",name:"xp",qualifier:["vec3"],e:!0},{type:"node_out",name:"xq",qualifier:["float"],e:!0},{type:"node_out",name:"xr",qualifier:["vec3"],e:!0},{type:"node_out",name:"xs",qualifier:["float"],e:!0},{type:"node_param",name:"node_TEXTURE_NORMAL_var_texture",qualifier:["uniform","sampler2D"]}],f:[{type:"textline",b:"vec4 xt = texture2D ( node_TEXTURE_NORMAL_var_texture , mN ( xh ) ) ;".split(" ")},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xl"],f:[{type:"textline",b:"xl = normalize ( nk * ( xt . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xm"],f:[{type:"textline",b:"xm = xt . w ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv2"],f:[{type:"textline",b:"xt = texture2D ( node_TEXTURE_NORMAL_var_texture , mN ( xi ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xn"],f:[{type:"textline",b:"xn = normalize ( nk * ( xt . xyz - 0.5 ) ) ;".split(" ")}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xo"],f:[{type:"textline",b:"xo = xt . w ;".split(" ")}]}]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_uv3"],f:[{type:"textline",b:"xt = texture2D ( node_TEXTURE_NORMAL_var_texture , mN ( xj ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xp"],f:[{type:"textline",b:"xp = normalize ( nk * ( xt . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xq"],f:[{type:"textline",b:"xq = xt . w ;".split(" ")}]}]}]}]},
{type:"node_condition",a:[{type:"node_if",c:["USE_uv4"],f:[{type:"textline",b:"xt = texture2D ( node_TEXTURE_NORMAL_var_texture , mN ( xk ) ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xr"],f:[{type:"textline",b:"xr = normalize ( nk * ( xt . xyz - 0.5 ) ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xs"],f:[{type:"textline",b:"xs = xt . w ;".split(" ")}]}]}]}]}]},{type:"node",name:"VALUE",g:[{type:"node_out",name:"xu",qualifier:["float"],e:!1}],
f:[{type:"textline",b:"xu = u_node_values [ VALUE_IND ] ;".split(" ")}]},{type:"node",name:"VECT_MATH_ADD",g:[{type:"node_in",name:"xv",qualifier:["vec3"],e:!1},{type:"node_in",name:"xw",qualifier:["vec3"],e:!1},{type:"node_out",name:"xx",qualifier:["vec3"],e:!1},{type:"node_out",name:"xy",qualifier:["float"],e:!0}],f:[{type:"textline",b:"xx = xv + xw ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xy"],f:[{type:"textline",b:"xy = ( abs ( xx [ 0 ] ) + abs ( xx [ 1 ] ) + abs ( xx [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_SUBTRACT",g:[{type:"node_in",name:"xz",qualifier:["vec3"],e:!1},{type:"node_in",name:"xA",qualifier:["vec3"],e:!1},{type:"node_out",name:"xB",qualifier:["vec3"],e:!1},{type:"node_out",name:"xC",qualifier:["float"],e:!0}],f:[{type:"textline",b:"xB = xz - xA ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xC"],f:[{type:"textline",b:"xC = ( abs ( xB [ 0 ] ) + abs ( xB [ 1 ] ) + abs ( xB [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_AVERAGE",
g:[{type:"node_in",name:"xD",qualifier:["vec3"],e:!1},{type:"node_in",name:"xE",qualifier:["vec3"],e:!1},{type:"node_out",name:"xF",qualifier:["vec3"],e:!1},{type:"node_out",name:"xG",qualifier:["float"],e:!0}],f:[{type:"textline",b:"xF = xD + xE ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xG"],f:[{type:"textline",b:"xG = length ( xF ) ;".split(" ")}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xF"],f:[{type:"textline",b:"xF = normalize ( xF ) ;".split(" ")}]}]}]},
{type:"node",name:"VECT_MATH_DOT_PRODUCT",g:[{type:"node_in",name:"xH",qualifier:["vec3"],e:!1},{type:"node_in",name:"xI",qualifier:["vec3"],e:!1},{type:"node_out",name:"xJ",qualifier:["vec3"],e:!1},{type:"node_out",name:"xK",qualifier:["float"],e:!0}],f:[{type:"textline",b:["xJ","=","mt",";"]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xK"],f:[{type:"textline",b:"xK = dot ( xH , xI ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_CROSS_PRODUCT",g:[{type:"node_in",name:"xL",qualifier:["vec3"],
e:!1},{type:"node_in",name:"xM",qualifier:["vec3"],e:!1},{type:"node_out",name:"xN",qualifier:["vec3"],e:!1},{type:"node_out",name:"xO",qualifier:["float"],e:!0}],f:[{type:"textline",b:"xN = cross ( xL , xM ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xO"],f:[{type:"textline",b:"xO = length ( xN ) ;".split(" ")}]}]}]},{type:"node",name:"VECT_MATH_NORMALIZE",g:[{type:"node_in",name:"xP",qualifier:["vec3"],e:!1},{type:"node_in",name:"xQ",qualifier:["vec3"],e:!1},{type:"node_out",
name:"xR",qualifier:["vec3"],e:!1},{type:"node_out",name:"xS",qualifier:["float"],e:!0}],f:[{type:"textline",b:"xR = normalize ( xP ) ;".split(" ")},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_xS"],f:[{type:"textline",b:"xS = length ( xP ) ;".split(" ")}]}]},{type:"textline",b:["xQ",";"]}]},{type:"node",name:"B4W_REFLECT",g:[{type:"node_in",name:"xT",qualifier:["vec3"],e:!1},{type:"node_in",name:"xU",qualifier:["vec3"],e:!1},{type:"node_out",name:"xV",qualifier:["vec3"],e:!1}],f:[{type:"textline",
b:"xV = reflect ( - xT , xU ) ;".split(" ")}]},{type:"node",name:"B4W_PARALLAX",g:[{type:"node_in",name:"xW",qualifier:["vec3"],e:!1},{type:"node_in",name:"xX",qualifier:["float"],e:!1},{type:"node_in",name:"xY",qualifier:["const","float"],e:!1},{type:"node_in",name:"xZ",qualifier:["const","float"],e:!1},{type:"node_out",name:"x_",qualifier:["vec3"],e:!1},{type:"node_param",name:"node_B4W_PARALLAX_var_texture",qualifier:["uniform","sampler2D"]}],f:[{type:"textline",b:"float ya = length ( nm ) ; if ( ya < xZ ) { vec2 yb = mN ( xW ) ; float yc = clamp ( 0.5 * ( xZ - ya ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float yd = xX * yc ;".split(" ")},
{type:"textline",b:"vec3 ye = normalize ( na * nk ) ;".split(" ")},{type:"textline",b:"float yf = UNITY_VALUE_NODES / xY ;".split(" ")},{type:"textline",b:"vec2 yg = ye . xy * yd / ( xY * ye . z ) ; float yh = UNITY_VALUE_NODES ; float yi = texture2D ( node_B4W_PARALLAX_var_texture , yb ) . a ;".split(" ")},{type:"textline",b:"for ( float yj = 1.0 ; yj <= xY ; yj ++ ) { if ( yi < yh ) { yh -= yf ; yb -= yg ; yi = texture2D ( node_B4W_PARALLAX_var_texture , yb ) . a ; } }".split(" ")},{type:"textline",
b:"vec2 yk = yb + yg ; float yl = texture2D ( node_B4W_PARALLAX_var_texture , yk ) . a - ( yh + yf ) ; float ym = yi - yh ; float yn = ym / ( ym - yl ) ;".split(" ")},{type:"textline",b:"yb = yn * yk + ( UNITY_VALUE_NODES - yn ) * yb ; x_ = mL ( yb ) ; } else x_ = xW ;".split(" ")}]},{type:"node",name:"B4W_CLAMP",g:[{type:"node_in",name:"yo",qualifier:["vec3"],e:!1},{type:"node_out",name:"yp",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"yp = clamp ( yo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},
{type:"node",name:"B4W_REFRACTION",g:[{type:"node_in",name:"yq",qualifier:["vec3"],e:!1},{type:"node_in",name:"yr",qualifier:["float"],e:!1},{type:"node_out",name:"ys",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"ys = my ( yq , yr ) ;".split(" ")}]},{type:"node",name:"B4W_TRANSLUCENCY",g:[{type:"node_in",name:"yt",qualifier:["float"],e:!1},{type:"node_in",name:"yu",qualifier:["float"],e:!1},{type:"node_in",name:"yv",qualifier:["float"],e:!1},{type:"node_in",name:"yw",qualifier:["float"],e:!1},
{type:"node_in",name:"yx",qualifier:["float"],e:!1},{type:"node_out",name:"yy",qualifier:["float"],e:!0},{type:"node_out",name:"yz",qualifier:["vec4"],e:!0}],f:[{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_yy"],f:[{type:"textline",b:["yy","=","yt",";"]}]}]},{type:"node_condition",a:[{type:"node_if",c:["USE_OUT_yz"],f:[{type:"textline",b:"yz = vec4 ( yu , yv , yw , yx ) ;".split(" ")}]}]}]},{type:"node",name:"B4W_TIME",g:[{type:"node_out",name:"yA",qualifier:["float"],e:!1}],f:[{type:"textline",
b:["yA","=","u_time",";"]}]},{type:"node",name:"B4W_SMOOTHSTEP",g:[{type:"node_in",name:"yB",qualifier:["float"],e:!1},{type:"node_in",name:"yC",qualifier:["float"],e:!1},{type:"node_in",name:"yD",qualifier:["float"],e:!1},{type:"node_out",name:"yE",qualifier:["float"],e:!1}],f:[{type:"textline",b:"yE = smoothstep ( yC , yD , yB ) ;".split(" ")}]},{type:"node",name:"B4W_GLOW_OUTPUT",g:[{type:"node_in",name:"yF",qualifier:["vec3"],e:!1},{type:"node_in",name:"yG",qualifier:["float"],e:!1}],f:[{type:"textline",
b:"nb = yF ; nf = yG ;".split(" ")}]},{type:"node",name:"B4W_VECTOSCAL",g:[{type:"node_in",name:"yH",qualifier:["vec3"],e:!1},{type:"node_out",name:"yI",qualifier:["float"],e:!1}],f:[{type:"textline",b:"yI = ( yH . r + yH . g + yH . b ) / 3.0 ;".split(" ")}]},{type:"node",name:"B4W_SCALTOVEC",g:[{type:"node_in",name:"yJ",qualifier:["float"],e:!1},{type:"node_out",name:"yK",qualifier:["vec3"],e:!1}],f:[{type:"textline",b:"yK [ 0 ] = yJ ; yK [ 1 ] = yJ ; yK [ 2 ] = yJ ;".split(" ")}]},{type:"nodes_global"},
{type:"textline",b:"void yL ( in vec3 na , out vec3 nb , out vec3 nc , out vec3 nd , out float ne , out float nf ) { nb = mt ; nc = mt ; nd = mt ; ne = ZERO_VALUE_NODES ; nf = ZERO_VALUE_NODES ;".split(" ")},{type:"condition",a:[{type:"if",c:"USE_NODE_MATERIAL || USE_NODE_MATERIAL_EXT || USE_NODE_GEOMETRY_NO || CAUSTICS || CALC_TBN_SPACE || USE_NODE_TEX_COORD_NO".split(" "),group:{type:"group",a:[{type:"textline",b:["vec3","ng","=","lB",";"]},{type:"condition",a:[{type:"if",c:["DOUBLE_SIDED_LIGHTING"],
group:{type:"group",a:[{type:"textline",b:"if ( gl_FrontFacing ) ng = ng ; else ng = - ng ;".split(" ")}]}}]},{type:"textline",b:"vec3 nh = normalize ( ng ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["CALC_TBN_SPACE"],group:{type:"group",a:[{type:"textline",b:"vec3 ni = cross ( ng , lC . xyz ) * lC . w ; mat3 nj = mat3 ( lC . xyz , ni , ng ) ; mat3 nk = nj ;".split(" ")}]}}]},{type:"textline",b:"vec3 nl = lA ; vec4 nm = cD ; float nn = u_emit ; float no = u_specular_alpha ; float np = u_ambient ; hO nq ;".split(" ")},
{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/nodes.glslv"]={type:"group",a:[{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","||","USE_NODE_TEX_COORD_GE"],group:{type:"group",a:[{type:"textline",b:"attribute vec3 a_orco_tex_coord ; varying vec3 ms ;".split(" ")}]}}]},{type:"node",name:"TEX_COORD_UV",g:[{type:"node_param",name:"node_TEX_COORD_UV_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"mV",qualifier:["varying","vec2"]}],f:[{type:"textline",b:["mV","=",
"node_TEX_COORD_UV_var_a_uv",";"]}]},{type:"node",name:"UV_MERGED",g:[{type:"node_param",name:"node_UV_MERGED_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"mU",qualifier:["varying","vec2"]}],f:[{type:"textline",b:["mU","=","node_UV_MERGED_var_a_uv",";"]}]},{type:"node",name:"UVMAP",g:[{type:"node_param",name:"node_UVMAP_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"mW",qualifier:["varying","vec2"]}],f:[{type:"textline",b:["mW","=","node_UVMAP_var_a_uv",";"]}]},
{type:"node",name:"GEOMETRY_UV",g:[{type:"node_param",name:"node_GEOMETRY_UV_var_a_uv",qualifier:["attribute","vec2"]},{type:"node_param",name:"mO",qualifier:["varying","vec2"]}],f:[{type:"textline",b:["mO","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{type:"node",name:"GEOMETRY_VC",g:[{type:"node_param",name:"node_GEOMETRY_VC_var_a_vertex_color",qualifier:["attribute","vec3"]},{type:"node_param",name:"yM",qualifier:["varying","vec3"]}],f:[{type:"textline",b:["yM","=","node_GEOMETRY_VC_var_a_vertex_color",
";"]}]},{type:"node",name:"GEOMETRY_VC1",g:[{type:"node_param",name:"node_GEOMETRY_VC1_var_a_vertex_color",qualifier:["attribute","float"]},{type:"node_param",name:"yN",qualifier:["varying","float"]}],f:[{type:"textline",b:["yN","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC2",g:[{type:"node_param",name:"node_GEOMETRY_VC2_var_a_vertex_color",qualifier:["attribute","vec2"]},{type:"node_param",name:"yO",qualifier:["varying","vec2"]}],f:[{type:"textline",b:["yO","=",
"node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{type:"node",name:"GEOMETRY_VC3",g:[{type:"node_param",name:"node_GEOMETRY_VC3_var_a_vertex_color",qualifier:["attribute","vec3"]},{type:"node_param",name:"yP",qualifier:["varying","vec3"]}],f:[{type:"textline",b:["yP","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{type:"nodes_global"},{type:"textline",b:["void","yQ","(",")","{"]},{type:"condition",a:[{type:"if",c:["USE_NODE_GEOMETRY_OR","||","USE_NODE_TEX_COORD_GE"],group:{type:"group",a:[{type:"textline",
b:["ms","=","a_orco_tex_coord",";"]}]}}]},{type:"nodes_main"},{type:"textline",b:["}"]}]};a["include/particles.glslv"]={type:"group",a:[{type:"var",name:"EPSILON",b:["0.0001"]},{type:"textline",b:"struct yS { float a ; vec3 b ; float c ; vec3 d ; float e ; } ;".split(" ")},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"void yZ ( inout float yT , float yU , vec2 yV , vec2 yW ) { float yX = yW . x - yV . x ; float yY = ( yU - yV . x ) / yX ; yT = mix ( yT , yW . y , clamp ( yY , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},
{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"void zf ( inout vec3 y_ , float za , vec4 zb , vec4 zc ) { float zd = zc . x - zb . x ; float ze = ( za - zb . x ) / zd ; y_ = mix ( y_ , zc . yzw , clamp ( ze , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"float zl ( float zg , float zh , vec2 zi [ SIZE_RAMP_LENGTH ] ) { float zj = zg / zh ; float zk = zi [ 0 ] . y ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","1"],group:{type:"group",a:[{type:"textline",b:"yZ ( zk , zj , zi [ 0 ] , zi [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","2"],group:{type:"group",a:[{type:"textline",b:"yZ ( zk , zj , zi [ 1 ] , zi [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","3"],group:{type:"group",a:[{type:"textline",b:"yZ ( zk , zj , zi [ 2 ] , zi [ 3 ] ) ;".split(" ")}]}}]},{type:"textline",
b:["return","zk",";","}"]}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"vec3 zr ( float zm , float zn , vec4 zo [ COLOR_RAMP_LENGTH ] ) { float zp = zm / zn ; vec3 zq = zo [ 0 ] . yzw ;".split(" ")},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","1"],group:{type:"group",a:[{type:"textline",b:"zf ( zq , zp , zo [ 0 ] , zo [ 1 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","2"],group:{type:"group",
a:[{type:"textline",b:"zf ( zq , zp , zo [ 1 ] , zo [ 2 ] ) ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","3"],group:{type:"group",a:[{type:"textline",b:"zf ( zq , zp , zo [ 2 ] , zo [ 3 ] ) ;".split(" ")}]}}]},{type:"textline",b:["return","zq",";","}"]}]}}]},{type:"textline",b:"float zA ( float zs , float zt , float zu , float zv ) { float zw = max ( 0.01 , min ( zt , zu ) ) ; float zx = max ( 0.01 , min ( zt , zv ) ) ; float zy = zt - zx ; float zz = clamp ( zs / zw , 0.0 , 1.0 ) - step ( zy , zs ) * ( zs - zy ) / zx ; return zz ; } yS zG ( ) { yS zB ; float zC ; if ( u_p_cyclic == 1 ) { zC = mod ( u_p_time , u_p_length ) - a_p_delay ; if ( zC < 0.0 ) zC += u_p_length ; } if ( u_p_cyclic != 1 ) { zC = u_p_time - a_p_delay ; } if ( zC < 0.0 || zC >= a_p_lifetime ) { zB . a = 0.0001 ; zB . b = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( zC < 0.0 || zC >= a_p_lifetime ) ) {".split(" ")},
{type:"condition",a:[{type:"if",c:["WORLD_SPACE"],group:{type:"group",a:[{type:"textline",b:"vec3 zD = a_position ; vec3 zE = a_normal ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"vec3 zD = ( u_model_matrix * vec4 ( a_position , 1.0 ) ) . xyz ; vec3 zE = ( u_model_matrix * vec4 ( a_normal , 0.0 ) ) . xyz ;".split(" ")}]}}]},{type:"textline",b:"zD += u_p_nfactor * zC * zE ; zD += a_p_vels . xyz * zC ; zD . y -= u_p_gravity * zC * zC / 2.0 ; float zF = max ( u_p_mass , EPSILON ) ; zD += ( u_p_wind / zF ) * zC * zC / 2.0 ; zB . b = zD ; zB . e = a_p_vels . w * zC ;".split(" ")},
{type:"condition",a:[{type:"if",c:["SIZE_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"zB . a = zl ( zC , u_p_max_lifetime , u_p_size_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zB . a = 1.0 ;".split(" ")}]}}]},{type:"condition",a:[{type:"if",c:["COLOR_RAMP_LENGTH",">","0"],group:{type:"group",a:[{type:"textline",b:"zB . d = zr ( zC , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{type:"else",group:{type:"group",a:[{type:"textline",b:"zB . d = vec3 ( 1.0 ) ;".split(" ")}]}}]},
{type:"textline",b:"zB . c = zA ( zC , a_p_lifetime , u_p_fade_in , u_p_fade_out ) ; } return zB ; }".split(" ")}]};a["include/blending.glslf"]={type:"group",a:[{type:"textline",b:"float zI = 0.0 ; float zJ = 1.0 ; vec3 zK = vec3 ( zI ) ; vec3 zL = vec3 ( zJ ) ; vec3 zS ( vec3 zM ) { vec4 zN = vec4 ( zI , - zJ / 3.0 , 2.0 / 3.0 , - zJ ) ; vec4 zO = mix ( vec4 ( zM . bg , zN . wz ) , vec4 ( zM . gb , zN . xy ) , step ( zM . b , zM . g ) ) ; vec4 zP = mix ( vec4 ( zO . xyw , zM . r ) , vec4 ( zM . r , zO . yzx ) , step ( zO . x , zM . r ) ) ; float zQ = zP . x - min ( zP . w , zP . y ) ; float zR = 1.0e-10 ; return vec3 ( abs ( zP . z + ( zP . w - zP . y ) / ( 6.0 * zQ + zR ) ) , zQ / ( zP . x + zR ) , zP . x ) ; } vec3 zW ( vec3 zT ) { vec4 zU = vec4 ( zJ , 2.0 / 3.0 , zJ / 3.0 , 3.0 ) ; vec3 zV = abs ( fract ( vec3 ( zT . r , zT . r , zT . r ) + zU . xyz ) * 6.0 - zU . www ) ; return zT . b * mix ( zU . xxx , clamp ( zV - zU . xxx , zI , zJ ) , zT . g ) ; } vec3 z_ ( vec3 zX , vec3 zY , float zZ ) { return mix ( zX , zY , zZ ) ; } vec3 Ad ( vec3 Aa , vec3 Ab , float Ac ) { return Ac * Aa + Ab ; } vec3 Ah ( vec3 Ae , vec3 Af , float Ag ) { return Af - Ag * Ae ; } vec3 Am ( vec3 Ai , vec3 Aj , float Ak ) { float Al = zJ - Ak ; return ( vec3 ( Al ) + Ak * Ai ) * Aj ; } vec3 Ar ( vec3 An , vec3 Ao , float Ap ) { vec3 Aq = vec3 ( zJ - Ap ) ; return zL - ( Aq + Ap * ( zL - An ) ) * ( zL - Ao ) ; } vec3 Aw ( vec3 As , vec3 At , float Au ) { vec3 Av = vec3 ( zJ - Au ) ; return mix ( At * ( Av + 2.0 * Au * As ) , zL - ( Av + 2.0 * Au * ( zL - As ) ) * ( zL - At ) , step ( 0.5 , At ) ) ; } vec3 AA ( vec3 Ax , vec3 Ay , float Az ) { return mix ( Ay , abs ( Ax - Ay ) , Az ) ; } vec3 AE ( vec3 AB , vec3 AC , float AD ) { return mix ( AC , AC / ( AB + step ( AB , zK ) ) , AD ) ; } vec3 AI ( vec3 AF , vec3 AG , float AH ) { return mix ( AG , min ( AF , AG ) , AH ) ; } vec3 AM ( vec3 AJ , vec3 AK , float AL ) { return max ( AL * AJ , AK ) ; } vec3 AT ( vec3 AN , vec3 AO , float AP ) { vec3 AQ = zS ( AO ) ; if ( AQ . y != zI ) { vec3 AR = zS ( AN ) ; vec3 AS = zW ( vec3 ( AQ . x , AR . yz ) ) ; return mix ( AN , AS , AP ) ; } return AN ; } vec3 AZ ( vec3 AU , vec3 AV , float AW ) { vec3 AX = zS ( AU ) ; if ( AX . y != zI ) { vec3 AY = zS ( AV ) ; return zW ( vec3 ( AX . x , mix ( AX . y , AY . y , AW ) , AX . z ) ) ; } return AU ; } vec3 Be ( vec3 A_ , vec3 Ba , float Bb ) { vec3 Bc = zS ( A_ ) ; vec3 Bd = zS ( Ba ) ; return zW ( vec3 ( Bc . xy , mix ( Bc . z , Bd . z , Bb ) ) ) ; } vec3 Bl ( vec3 Bf , vec3 Bg , float Bh ) { vec3 Bi = zS ( Bg ) ; if ( Bi . y != zI ) { vec3 Bj = zS ( Bf ) ; vec3 Bk = zW ( vec3 ( Bi . xy , Bj . z ) ) ; return mix ( Bf , Bk , Bh ) ; } return Bf ; } vec3 Bq ( vec3 Bm , vec3 Bn , float Bo ) { vec3 Bp = zL - ( zL - Bn ) * ( zL - Bm ) ; return mix ( Bm , ( ( zL - Bm ) * Bn * Bm ) + Bm * Bp , Bo ) ; } vec3 Bu ( vec3 Br , vec3 Bs , float Bt ) { return Br + Bt * ( 2.0 * Bs - zJ ) ; } float BA ( float Bv , float Bw , float Bx , float By ) { float Bz = zJ - By ; return ( Bz + Bx * Bv ) * Bw ; } float BG ( float BB , float BC , float BD , float BE ) { float BF = zJ - BE ; return zJ - ( BF + BD * ( zJ - BB ) ) * ( zJ - BC ) ; } float BM ( float BH , float BI , float BJ , float BK ) { float BL = zJ - BK ; return mix ( BI * ( BL + 2.0 * BJ * BH ) , zJ - ( BL + 2.0 * BJ * ( zJ - BH ) ) * ( zJ - BI ) , step ( 0.5 , BI ) ) ; }".split(" ")}]};
a["include/depth_fetch.glslf"]={type:"group",a:[{type:"textline",b:"float BZ ( in sampler2D BS , in vec2 BT , in vec2 BU ) { float BV = texture2D ( BS , BT ) . r ; float BW = BU . x ; float BX = BU . y ; float BY = 2.0 * BW / ( BW + BX - ( 2.0 * BV - 1.0 ) * ( BX - BW ) ) ; return BY ; }".split(" ")}]}};b4w.module.animation=function(a,q){var b=q("__animation"),d=q("__constraints");q("__physics");var c=q("__print"),e=q("__util");a.SLOT_0=b.SLOT_0;a.SLOT_1=b.SLOT_1;a.SLOT_2=b.SLOT_2;a.SLOT_3=b.SLOT_3;a.SLOT_4=b.SLOT_4;a.SLOT_5=b.SLOT_5;a.SLOT_6=b.SLOT_6;a.SLOT_7=b.SLOT_7;a.SLOT_ALL=b.SLOT_ALL;a.OBJ_ANIM_TYPE_NONE=b.OBJ_ANIM_TYPE_NONE;a.OBJ_ANIM_TYPE_ARMATURE=b.OBJ_ANIM_TYPE_ARMATURE;a.OBJ_ANIM_TYPE_OBJECT=b.OBJ_ANIM_TYPE_OBJECT;a.OBJ_ANIM_TYPE_VERTEX=b.OBJ_ANIM_TYPE_VERTEX;a.OBJ_ANIM_TYPE_SOUND=b.OBJ_ANIM_TYPE_SOUND;
a.OBJ_ANIM_TYPE_PARTICLES=b.OBJ_ANIM_TYPE_PARTICLES;a.OBJ_ANIM_TYPE_MATERIAL=b.OBJ_ANIM_TYPE_MATERIAL;a.AB_CYCLIC=b.AB_CYCLIC;a.AB_FINISH_RESET=b.AB_FINISH_RESET;a.AB_FINISH_STOP=b.AB_FINISH_STOP;var g=new Float32Array(4);a.is_animated=function(a){return b.is_animated(a)};a.get_actions=function(){c.error("get_actions() deprecated, use get_anim_names() instead");for(var a=[],d=b.nq(),e=0;e<d.length;e++)a.push(b.aB(d[e].name));return a};a.get_current_action=function(b,d){c.error("get_current_action() deprecated, use get_current_anim_name() instead");
return a.get_current_anim_name(b,d)};a.get_anim_names=function(a){return b.bk(a)?b.get_anim_names(a):[]};a.get_current_anim_name=function(a,c){if(!b.is_animated(a))return null;c=c||b.SLOT_0;return b.Ux(a,c)};a.apply=function(a,d,e){if(e>b.SLOT_7)c.error("Can't apply animation to slot "+e+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{e=e||b.SLOT_0;if(b.is_animated(a)){var g=b.get_slot_num_by_anim(a,d);if(-1!=g&&g!=e){c.error('Animation "'+d+'" is already applied to object "'+
a.name+'" (slot "'+g+'").');return}}b.dC(a,d)?b.apply(a,d,e):c.error('No fcurves in action "'+d+'"')}};a.remove=function(a){b.remove(a)};a.remove_slot_animation=function(a,c){b.is_animated(a)&&(c=c||b.SLOT_0,b.remove_slot_animation(a,c))};a.apply_def=function(a){b.apply_def(a)};a.play=function(a,d,e){b.is_animated(a)?(e=e||b.SLOT_0,b.play(a,d,e),b.update_object_animation(a,0,e,!0)):c.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,c){b.is_animated(a)&&(c=c||b.SLOT_0,b.stop(a,
c))};a.is_play=function(a,c){if(!b.is_animated(a))return!1;c=c||b.SLOT_0;return b.is_play(a,c)};a.set_current_frame_float=function(b,d,e){c.error("set_current_frame_float() deprecated, use set_frame() instead");a.set_frame(b,d,e)};a.get_current_frame_float=function(b,d){c.error("get_current_frame_float() deprecated, use get_frame() instead");return a.get_frame(b,d)};a.set_frame=function(a,c,d){b.is_animated(a)&&(d=d||b.SLOT_0,b.set_current_frame_float(a,c,d),b.update_object_animation(a,0,d,!0))};
a.get_frame=function(a,c){if(!b.is_animated(a))return 0;c=c||b.SLOT_0;return b.get_current_frame_float(a,c)};a.set_speed=function(a,c,d){b.is_animated(a)&&(d=d||b.SLOT_0,b.set_speed(a,c||1,d))};a.get_speed=function(a,c){if(!b.is_animated(a))return 0;c=c||b.SLOT_0;return a.D[c]?b.get_speed(a,c):0};a.get_frame_range=function(a,d){c.error("get_frame_range() deprecated, use get_anim_start_frame() and get_anim_length() instead");if(b.is_animated(a)){d=d||b.SLOT_0;var e=a.D[d];if(e)return[e.start,e.start+
e.length]}return null};a.get_anim_start_frame=function(a,c){return b.is_animated(a)&&(c=c||b.SLOT_0,a.D[c])?b.get_anim_start_frame(a,c):-1};a.get_anim_length=function(a,c){return b.is_animated(a)&&(c=c||b.SLOT_0,a.D[c])?b.get_anim_length(a,c):-1};a.cyclic=function(d,e,g){c.error("cyclic() deprecated, use set_behavior() instead");a.set_behavior(d,e?b.AB_CYCLIC:b.AB_FINISH_RESET,g)};a.is_cyclic=function(a,d){c.error("is_cyclic() deprecated, use get_behavior() instead");if(!b.is_animated(a))return!1;
d=d||b.SLOT_0;return b.is_cyclic(a,d)};a.set_behavior=function(a,c,d){b.is_animated(a)&&(d=d||b.SLOT_0,b.set_behavior(a,c,d))};a.get_behavior=function(a,c){if(!b.is_animated(a))return null;c=c||b.SLOT_0;return b.get_behavior(a,c)};a.apply_smoothing=function(a,c,d,e){e=e||b.SLOT_0;b.is_animated(a)&&b.apply_smoothing(a,c,d,e)};a.update_object_animation=function(a,c,d,e){b.is_animated(a)&&(d=d||b.SLOT_0,b.update_object_animation(a,c||0,d,e||!1))};a.frame_to_sec=function(a){return b.frame_to_sec(a)};
a.get_bone_translation=function(a,b,c){if(!e.is_armature(a))return null;c||(c=new Float32Array(3));d.Yx(a,b,!1,g,null);c[0]=g[0];c[1]=g[1];c[2]=g[2];return c};a.get_first_armature_object=function(a){return e.is_mesh(a)?b.get_first_armature_object(a):null};a.get_slot_num_by_anim=function(a,c){return b.is_animated(a)&&c?b.get_slot_num_by_anim(a,c):null};a.get_anim_type=function(a,c){return b.is_animated(a)?b.get_anim_type(a,c):null};a.apply_to_first_empty_slot=function(a,c){return b.apply_to_first_empty_slot(a,
c)};a.get_skel_mix_factor=function(a){return a.d.Be};a.set_skel_mix_factor=function(a,d,g){e.is_armature(a)?(d=Math.min(Math.max(d,0),1),a.d.Be!=d&&b.set_skel_mix_factor(a,d,g||0)):c.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.anchors=function(a,q){var b=q("__anchors");q("__print");a.attach_move_cb=b.attach_move_cb;a.detach_move_cb=b.detach_move_cb;a.is_anchor=b.is_anchor;a.get_element_id=b.get_element_id};b4w.module.assets=function(a,q){var b=q("__assets");a.AT_ARRAYBUFFER=b.AT_ARRAYBUFFER;a.AT_JSON=b.AT_JSON;a.AT_TEXT=b.AT_TEXT;a.AT_AUDIOBUFFER=b.AT_AUDIOBUFFER;a.AT_IMAGE_ELEMENT=b.AT_IMAGE_ELEMENT;a.AT_AUDIO_ELEMENT=b.AT_AUDIO_ELEMENT;a.enqueue=function(a,c,e){b.enqueue(a,c,e)}};b4w.module.camera=function(a,q){function b(a,b){if(c.is_camera(a))return b||(b=new Float32Array(3)),m.copy(a.d.h,b),b;f.error("get_eye(): Wrong object")}function d(a,b){c.is_target_camera(a)?(m.copy(b,a.d.Lb),p.u(a),g.sync_transform(a)):f.error("set_pivot(): Wrong object or camera move style")}var c=q("__camera");q("__config");var e=q("__container"),g=q("__physics"),f=q("__print"),h=q("__constraints"),p=q("__transform"),l=q("__util"),m=q("vec3"),r=q("vec4");q("quat");var n=q("mat3"),y=q("mat4"),v=
new Float32Array(2),E=new Float32Array(3),x=new Float32Array(3),u=new Float32Array(4),B=new Float32Array(9);a.MS_STATIC=c.MS_STATIC;a.MS_ANIMATION=c.MS_STATIC;a.MS_TARGET_CONTROLS=c.MS_TARGET_CONTROLS;a.MS_EYE_CONTROLS=c.MS_EYE_CONTROLS;a.MS_HOVER_CONTROLS=c.MS_HOVER_CONTROLS;a.is_camera=c.is_camera;a.is_target_camera=c.is_target_camera;a.is_eye_camera=c.is_eye_camera;a.is_hover_camera=c.is_hover_camera;a.set_move_style=function(a,d){if(!c.is_camera(a))return f.error("set_move_style(): Wrong object"),
!1;if(d!=c.MS_STATIC&&d!=c.MS_EYE_CONTROLS&&d!=c.MS_HOVER_CONTROLS&&d!=c.MS_TARGET_CONTROLS)return f.error("set_move_style(): Wrong camera move style"),!1;a.d.ua=d;a.d.Rb=null;a.d.fd=null;a.d.xb=null;a.d.Ua=!1;c.Gy(a);switch(d){case c.MS_TARGET_CONTROLS:var e=b(a,E),h=l.quat_to_dir(a.d.quat,l.AXIS_MY,x),e=m.scaleAndAdd(e,h,10,h);m.copy(e,a.d.Lb)}p.u(a);g.sync_transform(a);return!0};a.get_move_style=function(a){return c.is_camera(a)?c.get_move_style(a):(f.error("get_move_style(): Wrong object"),null)};
a.set_velocity_params=function(a,b){if(!c.is_target_camera(a)&&!c.is_eye_camera(a)&&!c.is_hover_camera(a))return f.error("set_velocity_params(): Wrong object or camera move style"),null;var d=a.d;d.mo=l.clamp(b[0],0,Infinity);d.lo=l.clamp(b[1],0,Infinity);d.no=l.clamp(b[2],0,1)};a.get_velocity_params=function(a,b){if(!c.is_target_camera(a)&&!c.is_eye_camera(a)&&!c.is_hover_camera(a))return f.error("get_velocity_params(): Wrong object or camera move style"),null;b||(b=new Float32Array(3));var d=a.d;
b[0]=d.mo;b[1]=d.lo;b[2]=d.no;return b};a.set_look_at=function(a,b,d,e){var f=a.d;c.ux(b,d,e,f.h,f.quat);p.u(a);g.sync_transform(a)};a.get_eye=b;a.set_pivot=d;a.set_trans_pivot=function(a,b,d){c.is_target_camera(a)?(m.copy(b,a.d.h),m.copy(d,a.d.Lb),p.u(a),g.sync_transform(a)):f.error("set_trans_pivot(): Wrong object or camera move style")};a.get_pivot=function(a,b){if(c.is_target_camera(a))return b||(b=new Float32Array(3)),m.copy(a.d.Lb,b),b;f.error("get_pivot(): Wrong object or camera move style")};
a.rotate_pivot=function(b,c,d){f.error("rotate_pivot() deprecated, use rotate_camera() or rotate_target_camera() instead");a.rotate_target_camera(b,c,d)};a.move_pivot=function(a,b,d){if(c.is_target_camera(a)){var e=a.d;if(e.it){var h=n.fromMat4(e.T,B),l=m.subtract(e.h,e.Lb,x);E[0]=b;E[1]=0;E[2]=d;m.scale(E,m.len(l),E);m.transformMat3(E,h,E);m.add(e.Lb,E,e.Lb);m.add(e.h,E,e.h);p.u(a);g.sync_transform(a)}}else f.error("move_pivot(): wrong object")};a.rotate_hover_cam=function(b,c){f.error("rotate_hover_cam() deprecated, use rotate_camera() or rotate_hover_camera() instead");
a.rotate_hover_camera(b,c,0)};a.get_hover_cam_angle=function(a){f.error("get_hover_cam_angle() deprecated, use get_camera_angles() instead");return c.is_hover_camera(a)?-c.get_camera_angles(a,v)[1]:(f.error("get_hover_cam_angle(): wrong object or camera move style"),null)};a.set_hover_cam_angle=function(a,b){f.error("set_hover_cam_angle() deprecated, use rotate_camera() or rotate_hover_camera() instead");if(c.is_hover_camera(a))if(a.d.Ua){var d=c.get_camera_angles(a,v);(d=-b-d[1])&&c.rotate_hover_camera(a,
0,d);p.u(a);g.sync_transform(a)}else f.error("set_hover_cam_angle(): distance/hover_angle limits are not defined or disabled");else f.error("set_hover_cam_angle(): wrong object or camera move style")};a.get_hover_angle_limits=function(a,b){if(c.is_hover_camera(a))return a.d.xb?(b||(b=new Float32Array(2)),b[0]=a.d.xb.Oa,b[1]=a.d.xb.Za):f.error("get_hover_angle_limits(): camera hasn't angle limits"),b;f.error("get_hover_angle_limits(): wrong object")};a.get_cam_dist_limits=function(a,b){if(c.is_hover_camera(a)||
c.is_target_camera(a))return a.d.Ua?(b||(b=new Float32Array(2)),b[0]=a.d.Gf,b[1]=a.d.Xd):f.error("get_cam_dist_limits(): camera hasn't distance limits"),b;f.error("get_cam_dist_limits(): wrong object")};a.translate_hover_cam_v=function(b,c){f.error("translate_hover_cam_v() deprecated, use hover_cam_set_translation() instead");a.hover_cam_set_translation(b,c)};a.hover_cam_set_translation=function(a,b){if(c.is_hover_camera(a)){var d=a.d;if(d.Ua){var e=m.subtract(b,d.h,E);m.add(e,d.Sb,d.Sb)}p.set_translation(a,
b);p.u(a);g.sync_transform(a)}else f.error("hover_cam_set_translation(): wrong object")};a.set_hover_pivot=function(a,b){if(c.is_hover_camera(a)){var d=a.d;if(d.Ua&&d.xb){var e=m.subtract(b,d.Sb,E),e=m.add(e,d.h,e);p.set_translation(a,e)}m.copy(b,d.Sb);p.u(a);g.sync_transform(a)}else f.error("set_hover_pivot(): Wrong object or camera move style")};a.get_hover_cam_pivot=function(a,b){if(!c.is_hover_camera(a))return f.error("get_hover_cam_pivot(): wrong object"),null;b||(b=new Float32Array(3));m.copy(a.d.Sb,
b);return b};a.has_distance_limits=function(a){return c.is_target_camera(a)||c.is_hover_camera(a)?a.d.Ua:(f.error("has_distance_limits(): wrong object"),null)};a.apply_vertical_limits=function(a,b,d,e){switch(c.get_move_style(a)){case c.MS_TARGET_CONTROLS:case c.MS_EYE_CONTROLS:e|=p.SPACE_WORLD;break;case c.MS_HOVER_CONTROLS:if(b>d){f.error("apply_vertical_limits(): wrong vertical limits");return}break;default:f.error("apply_vertical_limits(): wrong object");return}a.d.fd={Oa:b,Za:d};c.Hz(a,e==p.SPACE_LOCAL);
p.u(a);g.sync_transform(a)};a.clear_vertical_limits=function(a){a.d.fd=null};a.apply_horizontal_limits=function(a,b,d,e){switch(c.get_move_style(a)){case c.MS_TARGET_CONTROLS:case c.MS_EYE_CONTROLS:e|=p.SPACE_WORLD;break;case c.MS_HOVER_CONTROLS:if(b>d){f.error("apply_horizontal_limits(): wrong horizontal limits");return}break;default:f.error("apply_horizontal_limits(): wrong object");return}a.d.Rb={left:b,right:d};c.Dz(a,e==p.SPACE_LOCAL);p.u(a);g.sync_transform(a)};a.clear_horizontal_limits=function(a){a.d.Rb=
null};a.get_horizontal_limits=function(a,b){if(!c.is_target_camera(a)&&!c.is_eye_camera(a)&&!c.is_hover_camera(a))return f.error("get_horizontal_limits(): wrong object"),null;var d=a.d;b=b||new Float32Array(2);return d.Rb?(b[0]=d.Rb.left,b[1]=d.Rb.right,b):null};a.has_horizontal_limits=function(a){if(c.is_target_camera(a)||c.is_eye_camera(a)||c.is_hover_camera(a))return Boolean(a.d.Rb);f.error("has_horizontal_limits(): wrong object")};a.apply_hover_angle_limits=function(a,b,d){c.is_hover_camera(a)?
b<d?f.error("apply_hover_angle_limits(): wrong hover angle limits"):(b=l.angle_wrap_periodic(b,-Math.PI,Math.PI),d=l.angle_wrap_periodic(d,-Math.PI,Math.PI),b=l.clamp(b,-Math.PI/2,0),d=l.clamp(d,-Math.PI/2,0),a.d.xb={Oa:b,Za:d},c.Fy(a),p.u(a),g.sync_transform(a)):f.error("apply_hover_angle_limits(): wrong object")};a.clear_hover_angle_limits=function(a){c.is_hover_camera(a)?a.d.xb=null:f.error("clear_hover_angle_limits(): wrong object")};a.apply_distance_limits=function(a,b,d){if(c.is_target_camera(a)||
c.is_hover_camera(a))if(b>d)f.error("apply_distance_limits(): wrong distance limits");else{var e=a.d;e.Ua=!0;e.Xd=b;e.Gf=d;p.u(a);g.sync_transform(a)}else f.error("apply_distance_limits(): wrong object")};a.clear_distance_limits=function(a){c.is_target_camera(a)||c.is_hover_camera(a)?a.d.Ua=!1:f.error("clear_distance_limits(): wrong object")};a.set_eye_params=function(b,c,d){f.error("set_eye_params() deprecated, use rotate_camera() or rotate_eye_camera() instead");a.rotate_eye_camera(b,c,Math.PI/
2-d)};a.is_look_up=function(a){l.quat_to_dir(a.d.quat,l.AXIS_MY,E);return 0<=E[1]?!0:!1};a.rotate_camera=function(b,d,e,h,l){switch(a.get_move_style(b)){case c.MS_STATIC:break;case c.MS_TARGET_CONTROLS:c.rotate_target_camera(b,d,e,h,l);break;case c.MS_EYE_CONTROLS:c.rotate_eye_camera(b,d,e,h,l);break;case c.MS_HOVER_CONTROLS:c.rotate_hover_camera(b,d,e,h,l);break;default:f.error("rotate_camera(): Wrong object")}p.u(b);g.sync_transform(b)};a.rotate_target_camera=function(a,b,d,e,h){c.is_target_camera(a)?
(c.rotate_target_camera(a,b,d,e,h),p.u(a),g.sync_transform(a)):f.error("rotate_target_camera(): wrong object")};a.rotate_eye_camera=function(a,b,d,e,h){c.is_eye_camera(a)?(c.rotate_eye_camera(a,b,d,e,h),p.u(a),g.sync_transform(a)):f.error("rotate_eye_camera(): wrong object")};a.rotate_hover_camera=function(a,b,d,e,h){c.is_hover_camera(a)?(c.rotate_hover_camera(a,b,d,e,h),p.u(a),g.sync_transform(a)):f.error("rotate_hover_camera(): wrong object")};a.rotate=function(b,c,d){f.error("rotate() deprecated, use rotate_camera() or rotate_eye_camera() instead");
a.rotate_eye_camera(b,c,-d)};a.get_camera_angles=function(a,b){b||(b=new Float32Array(2));c.get_camera_angles(a,b);return b};a.get_camera_angles_char=function(a,b){b||(b=new Float32Array(2));c.get_camera_angles_char(a,b);return b};a.get_angles=function(a,b){f.error("get_angles() deprecated, use get_camera_angles() instead");b||(b=new Float32Array(2));c.get_angles(a,b);return b};a.set_stereo_distance=function(a,b){for(var d=a.d.G,e=0;e<d.length;e++){var f=d[e];f.type!=c.ub&&f.type!=c.Bb||c.uA(f,b,
f.Ad)}};a.get_stereo_distance=function(a){a=a.d.G;for(var b=0;b<a.length;b++){var d=a[b];if(d.type==c.ub||d.type==c.Bb)return d.Xi}return 0};a.is_underwater=function(a){f.error("is_underwater() deprecated, always returns false");return a.d.at};a.translate_view=function(a,b,d,e){a=a.d.G;for(var f=0;f<a.length;f++){var g=a[f];g.ec||c.$e(g,g.wa);var h=E;h[0]=-b;h[1]=-d;h[2]=0;y.translate(g.sa,h,g.sa);y.rotateZ(g.sa,e,g.sa);y.multiply(g.sa,g.ma,g.Ed);c.np(g);c.Cl(g)}};a.get_fov=function(a){return l.Bk(a.d.G[0].sc)};
a.set_fov=function(a,b){for(var d=a.d.G,e=0;e<d.length;e++){var f=d[e];f.sc=l.Zw(b);f.ec||c.$e(f,f.wa);y.multiply(f.sa,f.ma,f.Ed);c.np(f);c.Cl(f)}};a.correct_up=function(a,b){b||(b=l.AXIS_Y);h.correct_up(a,b)};a.zoom_object=function(a,b){if(c.is_target_camera(a)){p.get_object_center(b,!1,E);d(a,E);p.u(a);var e=p.get_object_size(b),h=c.Tx(a)/2,e=e/Math.sin(h),h=p.tz(a,E);p.move_local(a,0,e-h,0);p.u(a);g.sync_transform(a)}else f.error("zoom_object(): wrong object")};a.set_ortho_scale=function(b,d){if(c.is_camera(b)&&
a.is_ortho_camera(b)){var e=b.d;if(c.is_target_camera(b)){var g=m.dist(e.h,e.Lb);e.ah=d/2*e.$g/g}else c.is_hover_camera(b)&&a.has_distance_limits(b)?(g=m.distance(e.h,e.Sb),e.ah=d/2*e.$g/g):b.d.G[0].top=d/2;c.JB(b)}else f.error("set_ortho_scale(): wrong object")};a.get_ortho_scale=function(b){if(c.is_camera(b)&&a.is_ortho_camera(b))return 2*b.d.G[0].top;f.error("get_ortho_scale(): wrong object")};a.is_ortho_camera=function(a){if(c.is_camera(a))return a.d.G[0].type==c.Hc;f.error("is_ortho_camera(): wrong object")};
a.calc_ray=function(a,b,d,g){g||(g=new Float32Array(3));var h=a.d.G[0];switch(h.type){case c.Hb:case c.Jd:case c.ub:case c.Bb:var l=Math.tan(h.sc*Math.PI/360),n=l*h.wa;b=e.El(b,d,v,h);u[0]=(2*b[0]/h.width-1)*n;u[1]=-1;u[2]=(2*b[1]/h.height-1)*l;u[3]=0;r.transformMat4(u,a.d.T,u);g[0]=u[0];g[1]=u[1];g[2]=u[2];m.normalize(g,g);return g;default:return f.error("Non-compatible camera"),g}};a.project_point=function(a,b,d){d||(d=new Float32Array(2));return c.project_point(a,b,d)}};b4w.module.config=function(a,q){var b=q("__config");a.P_LOW=b.P_LOW;a.P_HIGH=b.P_HIGH;a.P_ULTRA=b.P_ULTRA;a.P_CUSTOM=b.P_CUSTOM;a.set=b.set;a.get=b.get;a.reset=b.reset;a.get_std_assets_path=b.get_std_assets_path};b4w.module.controls=function(a,q){var b=q("__controls"),d=q("__print");a.CT_CONTINUOUS=b.CT_CONTINUOUS;a.CT_TRIGGER=b.CT_TRIGGER;a.CT_SHOT=b.CT_SHOT;a.CT_LEVEL=b.CT_LEVEL;a.KEY_BACKSPACE=8;a.KEY_TAB=9;a.KEY_ENTER=13;a.KEY_SHIFT=16;a.KEY_CTRL=17;a.KEY_ALT=18;a.KEY_PAUSE=19;a.KEY_CAPSLOCK=20;a.KEY_ESC=27;a.KEY_SPACE=32;a.KEY_LEFT=37;a.KEY_UP=38;a.KEY_RIGHT=39;a.KEY_DOWN=40;a.KEY_1=49;a.KEY_2=50;a.KEY_3=51;a.KEY_4=52;a.KEY_5=53;a.KEY_6=54;a.KEY_7=55;a.KEY_8=56;a.KEY_9=57;a.KEY_A=65;a.KEY_B=66;a.KEY_C=
67;a.KEY_D=68;a.KEY_E=69;a.KEY_F=70;a.KEY_G=71;a.KEY_H=72;a.KEY_I=73;a.KEY_J=74;a.KEY_K=75;a.KEY_L=76;a.KEY_M=77;a.KEY_N=78;a.KEY_O=79;a.KEY_P=80;a.KEY_Q=81;a.KEY_R=82;a.KEY_S=83;a.KEY_T=84;a.KEY_U=85;a.KEY_V=86;a.KEY_W=87;a.KEY_X=88;a.KEY_Y=89;a.KEY_Z=90;a.KEY_NUM0=96;a.KEY_NUM1=97;a.KEY_NUM2=98;a.KEY_NUM3=99;a.KEY_NUM4=100;a.KEY_NUM5=101;a.KEY_NUM6=102;a.KEY_NUM7=103;a.KEY_NUM8=104;a.KEY_NUM9=105;a.KEY_DEC_POINT=110;a.KEY_SEMI_COLON=186;a.KEY_EQUAL_SIGN=187;a.KEY_COMMA=188;a.KEY_DASH=189;a.KEY_PERIOD=
190;a.KEY_FORWARD_SLASH=191;a.KEY_GRAVE_ACCENT=192;a.KEY_LEFT_SQ_BRACKET=219;a.KEY_BACK_SLASH=220;a.KEY_RIGHT_SQ_BRACKET=221;a.KEY_SINGLE_QUOTE=222;a.PL_SINGLE_TOUCH_MOVE=b.PL_SINGLE_TOUCH_MOVE;a.PL_MULTITOUCH_MOVE_ZOOM=b.PL_MULTITOUCH_MOVE_ZOOM;a.PL_MULTITOUCH_MOVE_PAN=b.PL_MULTITOUCH_MOVE_PAN;a.create_custom_sensor=b.create_custom_sensor;a.create_keyboard_sensor=b.create_keyboard_sensor;a.create_collision_sensor=function(a,d,g){return b.create_collision_sensor(a,d||"ANY",g||!1)};a.create_collision_impulse_sensor=
b.create_collision_impulse_sensor;a.create_ray_sensor=function(a,d,g,f,h,p,l){return b.create_ray_sensor(a,d,g,f||"ANY",h||!1,p||!1,l||!1)};a.create_mouse_click_sensor=b.create_mouse_click_sensor;a.create_mouse_wheel_sensor=b.create_mouse_wheel_sensor;a.create_mouse_move_sensor=b.create_mouse_move_sensor;a.create_touch_move_sensor=b.create_touch_move_sensor;a.create_touch_zoom_sensor=b.create_touch_zoom_sensor;a.create_motion_sensor=b.create_motion_sensor;a.create_vertical_velocity_sensor=b.create_vertical_velocity_sensor;
a.create_gyro_angles_sensor=b.create_gyro_angles_sensor;a.create_gyro_delta_sensor=b.create_gyro_delta_sensor;a.create_timer_sensor=function(a,d){return b.create_timer_sensor(a,d||!1)};a.reset_timer_sensor=b.reset_timer_sensor;a.create_elapsed_sensor=b.create_elapsed_sensor;a.create_timeline_sensor=b.create_timeline_sensor;a.create_selection_sensor=function(a,d){return b.create_selection_sensor(a,d||!1)};a.set_custom_sensor=function(a,d){b.hA(a,d)};a.get_custom_sensor=function(a){return a.value};
a.get_sensor_value=b.get_sensor_value;a.get_sensor_payload=b.get_sensor_payload;a.create_sensor_manifold=function(a,d,g,f,h,p,l){h=h||b.Op;b.create_sensor_manifold(a,d,g,f,h,p,void 0===l?null:l)};a.create_kb_sensor_manifold=function(a,d,g,f,h,p){f=b.create_keyboard_sensor(f);b.create_sensor_manifold(a,d,g,[f],b.Op,h,void 0===p?null:p)};a.check_sensor_manifolds=function(a){return b.check_sensor_manifold(a,null)};a.check_sensor_manifold=b.check_sensor_manifold;a.remove_sensor_manifolds=function(a){d.error("remove_sensor_manifolds() deprecated, use remove_sensor_manifold() instead");
b.remove_sensor_manifold(a,null)};a.remove_sensor_manifold=b.remove_sensor_manifold;a.reset=b.reset;a.register_keyboard_events=b.register_keyboard_events;a.register_mouse_events=function(a,d,g){b.register_mouse_events(a,d,!!g)};a.register_wheel_events=b.register_wheel_events;a.register_touch_events=b.register_touch_events;a.register_device_orientation=b.register_device_orientation;a.unregister_keyboard_events=b.unregister_keyboard_events;a.unregister_mouse_events=b.unregister_mouse_events;a.unregister_wheel_events=
b.unregister_wheel_events;a.unregister_touch_events=b.unregister_touch_events;a.unregister_device_orientation=b.unregister_device_orientation};b4w.module.constraints=function(a,q){var b=q("__camera"),d=q("__constraints"),c=q("__physics"),e=q("__print"),g=q("__transform");a.append_stiff=function(a,b,e,l,m){m=m||1;b instanceof Array&&2==b.length?d.So(a,b[0],b[1],e,l,m):d.To(a,b,e,l,m);g.u(a);c.sync_transform(a)};a.append_semi_stiff=function(a,b,e,l){d.ev(a,b,e,l);g.u(a);c.sync_transform(a)};a.append_semi_stiff_cam=function(a,h,p,l,m,r,n,q){if(!b.is_eye_camera(a))return e.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented."),
null;d.dv(a,h,p,l,m,r,n,q);g.u(a);c.sync_transform(a)};a.append_semi_soft_cam=function(a,h,p,l){if(!b.is_eye_camera(a))return e.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented."),null;if(!l||0>l)l=.25;d.cv(a,h,p,l);g.u(a);c.sync_transform(a)};a.append_stiff_trans=function(a,b,e){d.fv(a,b,e);g.u(a);c.sync_transform(a)};a.append_copy_trans=function(a,b,e){d.Zu(a,b,e);g.u(a);c.sync_transform(a)};a.append_stiff_trans_rot=function(a,b,e,l){d.gv(a,b,e,l);g.u(a);
c.sync_transform(a)};a.append_track=function(a,b){3==b.length?d.jv(a,b):d.iv(a,b);g.u(a);c.sync_transform(a)};a.append_follow=function(a,b,e,l){3==b.length?d.av(a,b,e,l):d.$u(a,b,e,l);g.u(a);c.sync_transform(a)};a.append_stiff_viewport=function(a,b,e){d.append_stiff_viewport(a,b,e);g.u(a);c.sync_transform(a)};a.remove=function(a){a.Wa&&d.remove(a)};a.get_parent=d.get_parent};b4w.module.container=function(a,q){var b=q("__container"),d=q("__print");a.get_canvas=b.get_canvas;a.get_container=b.get_container;a.insert_to_container=function(a,e){2!=arguments.length?d.error("insert_to_container(): two arguments required"):a&&e&&b.insert_to_container(a,e)};a.set_canvas_offsets=b.set_canvas_offsets;a.update_canvas_offsets=b.update_canvas_offsets;a.client_to_canvas_coords=b.client_to_canvas_coords;a.force_offsets_updating=b.force_offsets_updating};b4w.module.data=function(a,q){var b=q("__data");q("__print");q("__util");a.load=b.load;a.unload=function(a){b.unload(a|0)};a.set_debug_resources_root=b.set_debug_resources_root;a.is_primary_loaded=b.is_primary_loaded;a.load_and_add_new=b.load;a.cleanup=a.unload};b4w.module.debug=function(a,q){q("__batch");q("__config");var b=q("__controls"),d=q("__debug"),c=q("__physics"),e=q("__print"),g=q("__scenegraph"),f=q("__scenes"),h=q("__shaders"),p=q("__sfx"),l=q("__textures"),m=q("__util"),r=q("vec3");a.physics_stats=function(){c.Vw()};a.physics_id=function(a){e.log("O",c.wx(a));for(var b=c.Sx().m.p,d=0;d<b.length;d++){var f=b[d];f.Sa.S==a&&e.log("B",f)}};a.visible_objects=function(){for(var a=f.get_active(),b=f.Ia(a,"MESH",f.DATA_ID_ALL),a=f.ca(a,"MAIN_OPAQUE").p,
c=0;c<b.length;c++){var d=b[c],g=d.d;if("DYNAMIC"==g.type)for(var h=0;h<a.length;h++){var l=a[h];if(l.Xa&&l.td==g){e.log(d.name,d);break}}}};a.object_info=function(a){for(var b=f.get_active(),c=f.Ia(b,"MESH",f.DATA_ID_ALL),d=0;d<c.length;d++){var g=c[d];if(g.name==a){e.log("Object",g);for(var h=f.xm(b),l=0;l<h.length;l++){for(var m=h[l],p=m.p,r=[],k=0;k<p.length;k++)p[k].td==g.d&&r.push(p[k]);e.log("Subscene "+m.type,r)}}}};a.objects_stat=function(){var a=f.get_active();console.log("Armatures: "+
f.Ia(a,"ARMATURE",f.DATA_ID_ALL).length);console.log("Cameras: "+f.Ia(a,"CAMERA",f.DATA_ID_ALL).length);console.log("Curves: "+f.Ia(a,"CURVE",f.DATA_ID_ALL).length);console.log("Empties: "+f.Ia(a,"EMPTY",f.DATA_ID_ALL).length);console.log("Lamps: "+f.Ia(a,"LAMP",f.DATA_ID_ALL).length);console.log("Meshes: "+f.Ia(a,"MESH",f.DATA_ID_ALL).length);console.log("Speakers: "+f.Ia(a,"SPEAKER",f.DATA_ID_ALL).length)};a.num_vertices=function(){for(var a=0,b=f.get_active(),b=[f.ca(b,"MAIN_OPAQUE"),f.ca(b,"MAIN_BLEND")],
c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.p,e=0;e<d.length;e++){var g=d[e].B;g&&(a+=g.num_vertices)}}return a};a.num_triangles=function(){for(var a=0,b=f.get_active(),b=[f.ca(b,"MAIN_OPAQUE"),f.ca(b,"MAIN_BLEND")],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.p,e=0;e<d.length;e++){var g=d[e].B;g&&(a+=g.num_triangles)}}return a};a.num_draw_calls=function(){var a=f.get_active(),a=[f.ca(a,"MAIN_OPAQUE"),f.ca(a,"MAIN_BLEND")];return a[0].p.length+a[1].p.length};a.num_shaders=function(){return m.qd(h.qq())};
a.geometry_stats=function(){for(var a=f.get_active(),b=f.xm(a),a={},c=0;c<b.length;c++){var d=b[c];if("SINK"!=d.type&&"WIREFRAME"!=d.type)for(var e=d.p,g=0;g<e.length;g++){var h=e[g].B,l=e[g].td;h&&("COLOR_PICKING"!=d.type&&"OUTLINE_MASK"!=d.type||l.ok||l.nk)&&(a[h.id]=h)}}var e=d=c=b=0,m;for(m in a)h=a[m],h=h.R,h.Lj&&(d++,e+=h.Lj/1048576),b++,c+=h.Np/1048576;return{vbo_number:b,vbo_memory:c,ibo_number:d,ibo_memory:e}};a.num_textures=function(){for(var a=[],b=0,c=f.get_active(),c=[f.ca(c,"MAIN_OPAQUE"),
f.ca(c,"MAIN_BLEND")],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.p,g=0;g<e.length;g++){var h=e[g].B;if(h)for(var h=h.L,l=0;l<h.length;l++){var m=h[l];if("IMAGE"===m.source||"ENVIRONMENT_MAP"===m.source){var p=m.Va;-1===a.indexOf(p)&&(a.push(p),m=m.width*m.height*4/1048576/m.Ol,m*=1.3333,b+=m)}}}}return{number:a.length,memory:b}};a.num_render_targets=function(){for(var a=[],b=0,c=f.get_active(),c=f.xm(c),d=0;d<c.length;d++){var e=c[d];if("SINK"!=e.type){var g=e.i,h=[g.eb,g.Lc];h.push.apply(h,
e.Bd);for(e=0;e<h.length;e++){var m=h[e];l.xi(m)&&-1==a.indexOf(m)&&(a.push(m),b+=g.width*g.height*l.qy(m))}}}return{number:a.length,memory:b/1024/1024}};a.make_camera_frustum_shot=function(){var a=f.get_active();(a=f.ca(a,"MAIN_OPAQUE"))&&f.nr(a.i,a,[1,1,0])};a.make_light_frustum_shot=function(){var a=f.get_active(),b=f.ca(a,"MAIN_OPAQUE"),a=f.fB(a,["SHADOW_CAST"]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=
[1,0,1]}f.nr(d.i,b,e)}};a.scenegraph_to_dot=function(){for(var a=f.ri(),b=0;b<a.length;b++)e.log("\n"+g.Sw(f.zm(a[b])))};a.scenes_to_dot=function(){};a.controls_info=b.debug;a.object_distance=function(a,b){return r.dist(a.d.h,b.d.h)};a.msg=d.msg;a.fbmsg=d.fbmsg;a.print_telemetry=d.print_telemetry;a.plot_telemetry=d.plot_telemetry;a.fbres=function(a,b){function c(){d.fbmsg("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.assert_constants=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,
1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),g=new Float32Array([0,-1,0]),h=new Float32Array([0,0,-1]);if(!m.Ee(a,m.Mu))throw"Wrong VEC3_IDENT";if(!m.Ee(b,m.Gu))throw"Wrong QUAT4_IDENT";if(!m.Ee(c,m.AXIS_X))throw"Wrong AXIS_X";if(!m.Ee(d,m.AXIS_Y))throw"Wrong AXIS_Y";if(!m.Ee(e,m.AXIS_Z))throw"Wrong AXIS_Z";if(!m.Ee(f,m.AXIS_MX))throw"Wrong AXIS_MX";if(!m.Ee(g,m.AXIS_MY))throw"Wrong AXIS_MY";if(!m.Ee(h,m.AXIS_MZ))throw"Wrong AXIS_MZ";
};a.mute_music=function(){for(var a=p.get_speaker_objects(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==p.Bm(c)&&p.mute(c,!0)}};a.check_finite=function(a){d.check_finite(a)};a.set_debug_params=function(a){var b=f.get_active();if(b=f.ca(b,"WIREFRAME"))"string"==typeof a.wireframe_mode&&f.AA(b,a.wireframe_mode),"object"==typeof a.wireframe_edge_color&&f.zA(b,a.wireframe_edge_color);else throw"Wireframe subscene not found.";};a.get_error_quantity=function(){return e.ey()};a.get_warning_quantity=
function(){return e.vy()};a.clear_errors_warnings=function(){return e.clear_errors_warnings()}};b4w.module.geometry=function(a,q){var b=q("__batch"),d=q("__geometry"),c=q("__print"),e=q("__renderer");a.extract_vertex_array=function(a,e,h){if(!d.si(a))return c.error("Wrong object:",a.name),null;if(a=b.ba(a,e,"MAIN")||b.ba(a,e,"NODES")){if((e=a.R)&&e.Ub&&e.Ub[h])return d.qx(e,h);c.error("Attribute not found:"+h);return null}c.error("Wrong material:",e);return null};a.extract_index_array=function(a,e){if(!d.si(a))return c.error("Wrong object:",a.name),null;var h=b.ba(a,e,"MAIN")||b.ba(a,e,"NODES");
if(h){if((h=h.R)&&h.Ub)return h.Oe;c.error("Buffer data not found");return null}c.error("Wrong material:",e);return null};a.update_vertex_array=function(a,e,h,p){var l=["MAIN","NODES","DEPTH","COLOR_ID"];if(d.si(a))for(var m=0;m<l.length;m++){var r=b.ba(a,e,l[m]);r&&(r=r.R)&&r.Ub&&r.Ub[h]&&d.Rk(r,h,0,p)}else c.error("Wrong object:",a.name)};a.override_geometry=function(a,f,h,p,l){var m=["MAIN","NODES","DEPTH","COLOR_ID"];if(d.si(a))if(h instanceof Uint16Array||h instanceof Uint32Array)if(p instanceof
Float32Array)for(var r=0;r<m.length;r++){var n=b.ba(a,f,m[r]);if(n){var q=n.R;if(q){d.AB(q,n.Zd,h);var v=0,E;for(E in q.Ub)var x=q.Ub[E],v=v+p.length/3*x.sd;q.ed=new Float32Array(v);var v=q.ed,u=0;for(E in q.Ub)switch(x=q.Ub[E],E){case "a_position":v.set(p,u);x.offset=u;x.length=p.length;u+=x.length;break;case "a_normal":var B;l&&(B=d.mp(h,p,p));var t=d.kp(h,p,B);v.set(t,u);x.offset=u;x.length=p.length;u+=x.length;break;case "a_tangent":x.offset=u;x.length=p.length/3*x.sd;for(var t=new Float32Array(x.length),
G=0;G<t.length;G+=4)t[G]=1,t[G+3]=1;v.set(t,u);u+=x.length;break;default:x.offset=u,x.length=p.length/3*x.sd,t=new Float32Array(x.length),v.set(t,u),u+=x.length}d.et(q);e.Uo(n);(n=b.rc(a,n))&&n.R&&(n.R=q)}}}else c.error("Wrong positions_array type");else c.error("Wrong ibo_array type");else c.error("Wrong object:",a.name)};a.set_shape_key_value=function(a,b,e){if(!d.check_shape_keys(a))return c.error("Wrong object:",a.name),null;if(!d.Mq(a,b))return c.error("Wrong key name:",b),null;d.pv(a,b,parseFloat(e))};
a.check_shape_keys=function(a){return d.check_shape_keys(a)};a.get_shape_keys_names=function(a){return d.check_shape_keys(a)?d.get_shape_keys_names(a):(c.error("Wrong object:",a.name),null)};a.get_shape_key_value=function(a,b){return d.check_shape_keys(a)?d.Mq(a,b)?d.get_shape_key_value(a,b):(c.error("Wrong key name:",b),null):(c.error("Wrong object:",a.name),null)}};b4w.module.hud=function(a,q){var b=q("__hud");q("__print");a.draw_mixer_strip=b.draw_mixer_strip;a.plot_array=b.plot_array};b4w.module.lights=function(a,q){function b(a){for(var b=g.get_active(),d=g.Ia(b,"LAMP",g.DATA_ID_ALL),m=0;m<d.length;m++){var r=d[m];if("SUN"==r.na.type){var q=r;break}}if(!q)return c.error("There is no sun on the scene"),null;"number"==typeof a.hor_position&&"number"==typeof a.vert_position&&(d=(90-a.vert_position)/180*Math.PI,m=q.d,f.set_rotation_euler(q,[d,(180-a.hor_position)/180*Math.PI,0]),a=new Float32Array(3),h.quat_to_dir(m.quat,h.AXIS_Y,a),m=p.length(m.h),p.copy(a,l),p.scale(l,m,l),f.set_translation(q,
l),f.u(q),a=q.na,a.Up&&(r=q.data.energy,m=b.world.light_settings.environment_energy,d=Math.cos(Math.abs(d)),r*=Math.max(Math.min(3*d,1),0),d=Math.max(d,.1)*m,e.ps(a,r),g.set_environment_colors(b,d,null,null)),g.ug(q,b))}function d(a){if(e.Rm(a))return a.na.type;c.error("get_light_type(): Wrong object");return!1}var c=q("__print"),e=q("__lights"),g=q("__scenes");q("__batch");var f=q("__transform"),h=q("__util"),p=q("vec3"),l=new Float32Array(3),m,r=60;a.get_lamps=function(a){var b=g.get_active(),b=
g.Ia(b,"LAMP",g.DATA_ID_ALL);if(!a)return b;for(var c=[],d=0;d<b.length;d++){var e=b[d];e.na.type===a&&c.push(e)}return c};a.get_sun_params=function(){for(var a=g.get_active(),a=g.Ia(a,"LAMP",g.DATA_ID_ALL),b=null,c=0;c<a.length;c++){var d=a[c];if("SUN"==d.na.type){b=d;break}}return b?(b=b.na.direction,a=180*Math.atan2(b[2],b[0])/Math.PI+90,180<a&&(a-=360),b=180*Math.atan2(b[1],Math.sqrt(b[0]*b[0]+b[2]*b[2]))/Math.PI,c={},c.hor_position=a,c.vert_position=b,c):null};a.set_sun_params=b;a.set_day_time=
function(a){for(var d=g.get_active(),d=g.Ia(d,"LAMP",g.DATA_ID_ALL),e=0;e<d.length;e++){var f=d[e];if("SUN"==f.na.type){var h=f;break}}if(!h)return c.error("There is no sun on the scene"),null;h=-Math.cos(a/12*Math.PI)*r;d={};d.hor_position=12>a?15*a:15*(a-24);d.vert_position=h;b(d)};a.set_date=function(a){(m=a.getDate())?1582==m&&10==a.qE&&4<a.Rw&&15>a.Rw&&c.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):c.error("There is no year 0 in the Julian system!")};a.set_max_sun_angle=
function(a){r=Math.min(Math.max(a,0),90)};a.get_light_params=function(a){if(e.Rm(a))var b=a.na;else return c.error("get_light_params(): Wrong object"),!1;if(a=d(a))switch(a){case "SPOT":var f={light_type:a,light_color:b.color,light_energy:b.Je,light_spot_blend:b.sg,light_spot_size:b.dd,light_distance:b.distance};break;case "POINT":f={light_type:a,light_color:b.color,light_energy:b.Je,light_distance:b.distance};break;default:f={light_type:a,light_color:b.color,light_energy:b.Je}}return f?f:!1};a.get_light_type=
d;a.set_light_params=function(a,b){if(e.Rm(a))var d=a.na;else return c.error("set_light_params(): Wrong object"),!1;var f=g.get_active();"number"==typeof b.light_energy&&(e.ps(d,b.light_energy),g.ug(a,f));"object"==typeof b.light_color&&(e.oA(d,b.light_color),g.ug(a,f));"number"==typeof b.light_spot_blend&&(e.qA(d,b.light_spot_blend),g.ug(a,f));"number"==typeof b.light_spot_size&&(e.rA(d,b.light_spot_size),g.ug(a,f));"number"==typeof b.light_distance&&(e.pA(d,b.light_distance),g.ug(a,f));g.uB()}};b4w.module.material=function(a,q){function b(a,b){for(var c=a.n,d=0;d<c.length;d++){var e=c[d];if(-1<e.Pc.indexOf(b))return"MAIN"==e.type}return!1}function d(a,b){var c=e.ba(a,b,"MAIN");return Boolean(c&&c.ic[0])}function c(a,b){var c=e.ba(a,b,"MAIN");return Boolean(c&&c.ic[1])}var e=q("__batch"),g=q("__config"),f=q("__print"),h=q("__objects"),p=q("__shaders");q("__util");q("vec4");var l=g.o,m="u_colormap0 u_colormap1 u_stencil0 u_specmap u_normalmap0 u_mirrormap".split(" ");a.inherit_material=function(a,
b,c,d){if(h.ti(c)&&h.ti(a)){for(var g=["MAIN","DEPTH","COLOR_ID"],l=!1,p=0;p<g.length;p++){var q=g[p],t=e.ba(a,b,q),G=e.ba(c,d,q);if(t&&G){var l=!0,A=e.rc(c,d,q);"MAIN"==q&&(e.qs(G,t),A&&e.qs(A,t));for(q=0;q<G.Gb.length;q++){var k=G.Gb[q];if(-1!==m.indexOf(k)){var I=t.Gb.indexOf(k);-1!==I&&(G.L[q]=t.L[I],A&&(k=A.Gb.indexOf(k),-1!==k&&(A.L[k]=t.L[I])))}}}}l||f.error("Wrong objects for inheriting material!")}else f.error("Wrong or batched object(s)")};a.get_materials_names=function(a){var b=[];a=a.n;
for(var c=0;c<a.length;c++)for(var d=0;d<a[c].Pc.length;d++)-1==b.indexOf(a[c].Pc[d])&&b.push(a[c].Pc[d]);return b};a.set_diffuse_color=function(a,b,c){var d=e.ba(a,b,"MAIN");d?(d.Mc.set(c),(a=e.rc(a,b,"MAIN"))&&a.Mc.set(c)):f.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_color=function(a,b){var c=e.ba(a,b,"MAIN");if(c){var d=new Float32Array(4);d.set(c.Mc);return d}f.error('Couldn\'t get property "diffuse_color"!')};a.set_diffuse_intensity=function(a,b,c){var d=e.ba(a,b,"MAIN");
if(d){if(d.He=c,a=e.rc(a,b,"MAIN"))a.He=c}else f.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_intensity=function(a,b){var c=e.ba(a,b,"MAIN");if(c)return c.He;f.error('Couldn\'t get property "diffuse_intensity"!')};a.set_specular_color=function(a,b,c){var d=e.ba(a,b,"MAIN");d?(d.yd.set(c),(a=e.rc(a,b,"MAIN"))&&a.yd.set(c)):f.error('Couldn\'t set property "specular_color"!')};a.get_specular_color=function(a,b){var c=e.ba(a,b,"MAIN");if(c){var d=Array(3);d[0]=c.yd[0];d[1]=c.yd[1];
d[2]=c.yd[2];return d}f.error('Couldn\'t get property "specular_color"!')};a.set_specular_intensity=function(a,b,c){d(a,b)||f.error('Property "specular_intensity" is missing!');e.ba(a,b,"MAIN").ic[0]=c;(a=e.rc(a,b,"MAIN"))&&(a.ic[0]=c)};a.get_specular_intensity=function(a,b){d(a,b)||f.error('Property "specular_intensity" is missing!');return e.ba(a,b,"MAIN").ic[0]};a.check_specular_intensity=d;a.set_specular_hardness=function(a,b,d){c(a,b)||f.error('Property "specular_hardness" is missing!');e.ba(a,
b,"MAIN").ic[1]=d;(a=e.rc(a,b,"MAIN"))&&(a.ic[1]=d)};a.get_specular_hardness=function(a,b){c(a,b)||f.error('Property "specular_hardness" is missing!');return e.ba(a,b,"MAIN").ic[1]};a.check_specular_hardness=c;a.set_emit_factor=function(a,b,c){var d=e.ba(a,b,"MAIN");if(d){if(d.$d=c,a=e.rc(a,b,"MAIN"))a.$d=c}else f.error('Couldn\'t set property "emit_factor"!')};a.get_emit_factor=function(a,b){var c=e.ba(a,b,"MAIN");if(c)return c.$d;f.error('Couldn\'t get property "emit_factor"!')};a.set_ambient_factor=
function(a,b,c){var d=e.ba(a,b,"MAIN");if(d){if(d.Md=c,a=e.rc(a,b,"MAIN"))a.Md=c}else f.error('Couldn\'t set property "ambient_factor"!')};a.get_ambient_factor=function(a,b){var c=e.ba(a,b,"MAIN");if(c)return c.Md;f.error('Couldn\'t get property "ambient_factor"!')};a.set_diffuse_color_factor=function(a,b,c){var d=e.ba(a,b,"MAIN");if(d){if(d.Ge=c,a=e.rc(a,b,"MAIN"))a.Ge=c}else f.error('Couldn\'t set property "diffuse_color_factor"!')};a.get_diffuse_color_factor=function(a,b){var c=e.ba(a,b,"MAIN");
if(c)return c.Ge;f.error('Couldn\'t get property "diffuse_color_factor"!')};a.set_alpha_factor=function(a,b,c){var d=e.ba(a,b,"MAIN");if(d){if(d.Ae=c,a=e.rc(a,b,"MAIN"))a.Ae=c}else f.error('Couldn\'t set property "alpha_factor"!')};a.get_alpha_factor=function(a,b){var c=e.ba(a,b,"MAIN");if(c)return c.Ae;f.error('Couldn\'t get property "alpha_factor"!')};a.get_material_extended_params=function(a,c){if(!a||!c)return f.error("missing arguments in get_material_params"),null;if(!b(a,c))return null;var d=
e.ba(a,c,"MAIN");if(!d)return null;var g={};"MAIN"==d.type&&(g.og=d.og,g.BD=d.Yc[2],g.CD=5*(1-d.Yc[3]),g.kg=d.kg,g.xE=e.wb(d,"PARALLAX_STEPS")[1]);return g};a.get_water_material_params=function(a,c){if(!a||!c)return f.error("missing arguments in get_water_material_params"),null;if(!b(a,c))return null;var d=e.ba(a,c,"MAIN");if(!d||!d.of)return null;if(!d)return f.error("material not found"),null;var g={};if("MAIN"==d.type){if(l.sh){var h=g.shallow_water_col=Array(3);h[0]=d.shallow_water_col[0];h[1]=
d.shallow_water_col[1];h[2]=d.shallow_water_col[2];h=g.shore_water_col=Array(3);h[0]=d.shore_water_col[0];h[1]=d.shore_water_col[1];h[2]=d.shore_water_col[2];g.shallow_water_col_fac=d.shallow_water_col_fac;g.shore_water_col_fac=d.shore_water_col_fac}g.foam_factor=d.foam_factor;g.norm_uv_velocity=d.Oh;g.absorb_factor=e.wb(d,"ABSORB")[1];g.sss_strength=e.wb(d,"SSS_STRENGTH")[1];g.sss_width=e.wb(d,"SSS_WIDTH")[1];g.dst_noise_scale0=e.wb(d,"DST_NOISE_SCALE_0")[1];g.dst_noise_scale1=e.wb(d,"DST_NOISE_SCALE_1")[1];
g.dst_noise_freq0=e.wb(d,"DST_NOISE_FREQ_0")[1];g.dst_noise_freq1=e.wb(d,"DST_NOISE_FREQ_1")[1];g.dir_min_shore_fac=e.wb(d,"DIR_MIN_SHR_FAC")[1];g.dir_freq=e.wb(d,"DIR_FREQ")[1];g.dir_noise_scale=e.wb(d,"DIR_NOISE_SCALE")[1];g.dir_noise_freq=e.wb(d,"DIR_NOISE_FREQ")[1];g.dir_min_noise_fac=e.wb(d,"DIR_MIN_NOISE_FAC")[1];g.dst_min_fac=e.wb(d,"DST_MIN_FAC")[1];g.waves_hor_fac=e.wb(d,"WAVES_HOR_FAC")[1]}return g};a.set_material_extended_params=function(a,c,d){if(a&&c&&d){if(!b(a,c))return f.error("setting material params is not possible"),
null;var g=e.ba(a,c,"MAIN");if(g){var h=[g];(g=e.rc(a,c,"MAIN"))&&h.push(g);for(a=0;a<h.length;a++)g=h[a],"number"==typeof d.material_reflectivity&&(g.og=d.material_reflectivity),"number"==typeof d.material_fresnel&&(g.Yc[2]=d.material_fresnel),"number"==typeof d.material_fresnel_factor&&(g.Yc[3]=1-d.material_fresnel_factor/5),"number"==typeof d.material_parallax_scale&&(g.kg=d.material_parallax_scale),"number"==typeof d.material_parallax_steps&&(c=p.t(parseFloat(d.material_parallax_steps)),e.ka(g,
"PARALLAX_STEPS",c),e.rb(g,!0))}else f.error("material not found")}else f.error("missing arguments in set_material_params")};a.set_water_material_params=function(a,c,d){if(!a||!c||!d)return f.error("missing arguments in set_water_material_params"),null;if(!b(a,c))return f.error("setting water material params is not possible"),null;var g=e.ba(a,c,"MAIN");if(!g)return f.error("material not found"),null;var h=[g];(g=e.rc(a,c,"MAIN"))&&h.push(g);for(a=0;a<h.length;a++)g=h[a],l.sh&&("object"==typeof d.shallow_water_col&&
g.shallow_water_col.set(d.shallow_water_col),"number"==typeof d.shallow_water_col_fac&&(g.shallow_water_col_fac=d.shallow_water_col_fac),"object"==typeof d.shore_water_col&&g.shore_water_col.set(d.shore_water_col),"number"==typeof d.shore_water_col_fac&&(g.shore_water_col_fac=d.shore_water_col_fac)),l.shore_smoothing&&g.so&&("boolean"==typeof d.shore_smoothing&&(d.shore_smoothing?e.ka(g,"SHORE_SMOOTHING",1):e.ka(g,"SHORE_SMOOTHING",0)),"number"==typeof d.absorb_factor&&(c=p.t(parseFloat(d.absorb_factor)),
e.ka(g,"ABSORB",c))),"number"==typeof d.foam_factor&&l.Tg&&(g.foam_factor=d.foam_factor),"number"==typeof d.norm_uv_velocity&&(g.Oh=d.norm_uv_velocity),l.water_dynamic&&g.water_dynamic&&("boolean"==typeof d.water_dynamic&&(d.water_dynamic?e.ka(g,"DYNAMIC",1):e.ka(g,"DYNAMIC",0)),"number"==typeof d.waves_height&&(c=p.t(parseFloat(d.waves_height)),e.ka(g,"WAVES_HEIGHT",c)),"number"==typeof d.waves_length&&(c=p.t(parseFloat(d.waves_length)),e.ka(g,"WAVES_LENGTH",c)),"number"==typeof d.sss_strength&&
(c=p.t(parseFloat(d.sss_strength)),e.ka(g,"SSS_STRENGTH",c)),"number"==typeof d.sss_width&&(c=p.t(parseFloat(d.sss_width)),e.ka(g,"SSS_WIDTH",c)),"number"==typeof d.dst_noise_scale0&&(c=p.t(parseFloat(d.dst_noise_scale0)),e.ka(g,"DST_NOISE_SCALE_0",c)),"number"==typeof d.dst_noise_scale1&&(c=p.t(parseFloat(d.dst_noise_scale1)),e.ka(g,"DST_NOISE_SCALE_1",c)),"number"==typeof d.dst_noise_freq0&&(c=p.t(parseFloat(d.dst_noise_freq0)),e.ka(g,"DST_NOISE_FREQ_0",c)),"number"==typeof d.dst_noise_freq1&&(c=
p.t(parseFloat(d.dst_noise_freq1)),e.ka(g,"DST_NOISE_FREQ_1",c)),"number"==typeof d.dir_min_shore_fac&&(c=p.t(parseFloat(d.dir_min_shore_fac)),e.ka(g,"DIR_MIN_SHR_FAC",c)),"number"==typeof d.dir_freq&&(c=p.t(parseFloat(d.dir_freq)),e.ka(g,"DIR_FREQ",c)),"number"==typeof d.dir_noise_scale&&(c=p.t(parseFloat(d.dir_noise_scale)),e.ka(g,"DIR_NOISE_SCALE",c)),"number"==typeof d.dir_noise_freq&&(c=p.t(parseFloat(d.dir_noise_freq)),e.ka(g,"DIR_NOISE_FREQ",c)),"number"==typeof d.dir_min_noise_fac&&(c=p.t(parseFloat(d.dir_min_noise_fac)),
e.ka(g,"DIR_MIN_NOISE_FAC",c)),"number"==typeof d.dst_min_fac&&(c=p.t(parseFloat(d.dst_min_fac)),e.ka(g,"DST_MIN_FAC",c)),"number"==typeof d.waves_hor_fac&&(c=p.t(parseFloat(d.waves_hor_fac)),e.ka(g,"WAVES_HOR_FAC",c))),e.rb(g,!0);return!0}};b4w.module.particles=function(a,q){var b=q("__particles"),d=q("__print");a.set_size=function(a,e,g){b.Yg(a)?b.set_size(a,e,g):d.error('"',a.name,'" has no particle systems')};a.set_normal_factor=function(a,e,g){b.Yg(a)?b.set_normal_factor(a,e,g):d.error('"',a.name,'" has no particle systems')};a.set_factor=function(a,e,g){b.Yg(a)?(g=Math.min(g,1),g=Math.max(g,0),b.set_factor(a,e,g)):d.error('"',a.name,'" has no particle systems')}};b4w.module.physics=function(a,q){var b=q("__physics"),d=q("__print"),c=q("__util");a.CM_WALK=0;a.CM_RUN=1;a.CM_CLIMB=2;a.CM_FLY=3;a.enable_simulation=function(a){b.has_physics(a)?b.enable_simulation(a):d.error("No physics for object "+a.name)};a.disable_simulation=function(a){b.has_physics(a)?b.disable_simulation(a):d.error("No physics for object "+a.name)};a.has_physics=function(a){return b.has_physics(a)};a.has_simulated_physics=function(a){return b.has_simulated_physics(a)};a.has_dynamic_physics=
function(a){return b.has_dynamic_physics(a)};a.set_gravity=function(a,c){b.has_physics(a)?b.set_gravity(a,c):d.error("No physics for object "+a.name)};a.set_damping=function(a,c,f){b.has_physics(a)?b.C("set_damping",a.m.S,c,f):d.error("No physics for object "+a.name)};a.reset_damping=function(a){if(b.has_physics(a)){var c=a.game;b.C("set_damping",a.m.S,c.damping,c.rotation_damping)}else d.error("No physics for object "+a.name)};a.set_transform=function(a,c,f){b.has_physics(a)?b.set_transform.apply(this,
arguments):d.error("No physics for object "+a.name)};a.sync_transform=function(a){b.has_physics(a)?b.sync_transform(a):d.error("No physics for object "+a.name)};a.apply_velocity=function(a){b.has_physics(a)?b.apply_velocity.apply(this,arguments):d.error("No physics for object "+a.name)};a.apply_velocity_world=function(a){b.has_physics(a)?b.apply_velocity_world.apply(this,arguments):d.error("No physics for object "+a.name)};a.apply_force=function(a,c,f,h){b.has_physics(a)?b.apply_force.apply(this,
arguments):d.error("No physics for object "+a.name)};a.apply_torque=function(a,c,f,h){b.has_physics(a)?b.apply_torque.apply(this,arguments):d.error("No physics for object "+a.name)};a.vehicle_throttle=function(a,g){b.has_physics(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||d.error("Wrong object"),b.vehicle_throttle(a,c.clamp(g,-1,1))):d.error("No physics for object "+a.name)};a.vehicle_throttle_inc=function(a,g,f){if(b.has_physics(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||d.error("Wrong object");
g=c.clamp(g,0,1);var h=a.k.Sg;-1==f||1==f?h=Math.max(-1,Math.min(h+f*g,1)):0==f&&0<=h?(h-=g,h=Math.max(0,h)):0==f&&0>h?(h+=g,h=Math.min(0,h)):d.error("Wrong steering direction");b.vehicle_throttle(a,c.clamp(h,-1,1))}else d.error("No physics for object "+a.name)};a.vehicle_steer=function(a,g){b.has_physics(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||d.error("Wrong object"),b.vehicle_steer(a,c.clamp(g,-1,1))):d.error("No physics for object "+a.name)};a.vehicle_steer_inc=function(a,g,f){if(b.has_physics(a)){b.is_vehicle_chassis(a)||
b.is_vehicle_hull(a)||d.error("Wrong object");g=c.clamp(g,0,1);var h=a.k.zh;-1==f||1==f?h=Math.max(-1,Math.min(h+f*g,1)):0==f&&0<=h?(h-=g,h=Math.max(0,h)):0==f&&0>h?(h+=g,h=Math.min(0,h)):d.error("Wrong steering direction");b.vehicle_steer(a,c.clamp(h,-1,1))}else d.error("No physics for object "+a.name)};a.vehicle_brake=function(a,g){b.has_physics(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||d.error("Wrong object"),b.vehicle_brake(a,c.clamp(g,0,1))):d.error("No physics for object "+a.name)};
a.vehicle_brake_inc=function(a,g){if(b.has_physics(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||d.error("Wrong object");g=c.clamp(g,-1,1);var f=a.k.Yh;b.vehicle_brake(a,c.clamp(f+f*g,0,1))}else d.error("No physics for object "+a.name)};a.is_vehicle_chassis=function(a){return b.is_vehicle_chassis(a)};a.is_vehicle_hull=function(a){return b.is_vehicle_hull(a)};a.get_vehicle_name=function(a){if(!b.has_physics(a))return d.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.b4w_vehicle_settings.name;
d.error("Wrong object");return null};a.get_vehicle_throttle=function(a){if(!b.has_physics(a))return d.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.k.Sg;d.error("Wrong object")};a.get_vehicle_steering=function(a){if(!b.has_physics(a))return d.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.k.zh;d.error("Wrong object")};a.get_vehicle_brake=function(a){if(!b.has_physics(a))return d.error("No physics for object "+
a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.k.Yh;d.error("Wrong object")};a.get_vehicle_speed=function(a){if(!b.has_physics(a))return d.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return b.get_vehicle_speed(a);d.error("Wrong object")};a.is_character=function(a){return b.is_character(a)};a.set_character_move_dir=function(a,c,f){b.has_physics(a)?b.set_character_move_dir(a,c,f):d.error("No physics for object "+a.name)};a.set_character_move_type=
function(a,c){b.has_physics(a)?b.set_character_move_type(a,c):d.error("No physics for object "+a.name)};a.set_character_walk_velocity=function(a,c){b.has_physics(a)?b.set_character_walk_velocity(a,c):d.error("No physics for object "+a.name)};a.set_character_run_velocity=function(a,c){b.has_physics(a)?b.set_character_run_velocity(a,c):d.error("No physics for object "+a.name)};a.set_character_fly_velocity=function(a,c){b.has_physics(a)?b.set_character_fly_velocity(a,c):d.error("No physics for object "+
a.name)};a.character_jump=function(a){b.has_physics(a)?b.character_jump(a):d.error("No physics for object "+a.name)};a.character_rotation_inc=function(a,c,f){b.has_physics(a)?b.character_rotation_inc(a,c,f):d.error("No physics for object "+a.name)};a.set_character_rotation_quat=function(a,c){b.has_physics(a)?b.set_character_rotation_quat(a,c):d.error("No physics for object "+a.name)};a.set_character_rotation=function(a,c,f){b.has_physics(a)?b.set_character_rotation(a,c,f):d.error("No physics for object "+
a.name)};a.set_character_rotation_v=function(a,c){b.has_physics(a)?b.set_character_rotation_v(a,c):d.error("No physics for object "+a.name)};a.set_character_rotation_h=function(a,c){b.has_physics(a)?b.set_character_rotation_h(a,c):d.error("No physics for object "+a.name)};a.append_collision_test=function(a,c,f,h){b.has_physics(a)?b.append_collision_test(a,c,f,h||!1):d.error("No physics for object "+a.name)};a.remove_collision_test=function(a,c){b.has_physics(a)?b.remove_collision_test(a,c):d.error("No physics for object "+
a.name)};a.apply_collision_impulse_test=function(a,c){b.has_physics(a)?b.apply_collision_impulse_test(a,c):d.error("No physics for object "+a.name)};a.clear_collision_impulse_test=function(a){b.has_physics(a)?b.clear_collision_impulse_test(a):d.error("No physics for object "+a.name)};a.append_ray_test=function(a,c,d,h,p,l){return b.append_ray_test(a,c,d,h,p,l||!1,!1,!1,!1)};a.append_ray_test_ext=function(a,c,d,h,p,l,m,q,n){return b.append_ray_test(a,c,d,h,p,l||!1,m||!1,q||!1,n||!1)};a.remove_ray_test=
function(a){b.Wq(a)?b.remove_ray_test(a):d.error("Wrong ray test ID")};a.change_ray_test_from_to=function(a,c,f){b.Wq(a)?b.change_ray_test_from_to(a,c,f):d.error("Wrong ray test ID")};a.apply_constraint=function(a,c,f,h,p,l,m,q,n,y){b.has_physics(c)&&b.has_physics(p)?b.apply_constraint(a,c,f,h,p,l,m,q,n,y):d.error("Wrong objects")};a.clear_constraint=function(a){b.has_physics(a)&&b.By(a)?b.clear_constraint(a):d.error("Wrong object")};a.pull_to_constraint_pivot=function(a,c,f,h,p,l){b.has_physics(a)&&
b.has_physics(h)?b.pull_to_constraint_pivot(a,c,f,h,p,l):d.error("Wrong objects")}};b4w.module.rgb=function(a,q){q("__print");var b=q("__util"),d=new Float32Array(3);a.create=function(){return new Float32Array(3)};a.from_values=function(a,b,d){var f=new Float32Array(3);f[0]=a;f[1]=b;f[2]=d;return f};a.set=function(a,b,d,f){f[0]=a;f[1]=b;f[2]=d;return f};a.css_to_rgb=function(a,d,g,f){f=f||new Float32Array(3);f[0]=a/255;f[1]=d/255;f[2]=g/255;b.Ks(f,f);return f};a.rgb_to_css=function(a){a=b.$m(a,d);return[Math.round(255*a[0]),Math.round(255*a[1]),Math.round(255*a[2])]};a.rgb_to_css_hex=
function(a){function e(a){a=Math.round(255*a).toString(16);return 1==a.length?"0"+a:a}a=b.$m(a,d);return"#"+e(a[0])+e(a[1])+e(a[2])}};
b4w.module.rgba=function(a,q){q("__print");var b=q("__util"),d=new Float32Array(3);a.create=function(){var a=new Float32Array(4);a[3]=1;return a};a.from_values=function(a,b,d,f){var h=new Float32Array(4);h[0]=a;h[1]=b;h[2]=d;h[3]=f;return h};a.set=function(a,b,d,f,h){h[0]=a;h[1]=b;h[2]=d;h[3]=f;return h};a.css_to_rgba=function(a,d,g,f,h){h=h||new Float32Array(4);h[0]=a/255;h[1]=d/255;h[2]=g/255;h[3]=f;b.Ks(h,h);return h};a.rgba_to_css=function(a){var e=b.$m(a,d);return[Math.round(255*e[0]),Math.round(255*
e[1]),Math.round(255*e[2]),a[3]]}};b4w.module.scenes=function(a,q){var b=q("__batch"),d=q("__camera"),c=q("__graph"),e=q("__objects"),g=q("__print"),f=q("__physics"),h=q("__scenes"),p=q("__util");a.DATA_ID_ALL=h.DATA_ID_ALL;a.set_active=function(a){var b=h.ri();h.set_active(p.keysearch("name",a,b))};a.get_active=function(){return h.ha()?h.get_active().name:""};a.get_scenes=function(){for(var a=h.ri(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.get_active_camera=function(){if(h.ha())return h.Rj(h.get_active());g.error("No active scene");
return!1};a.get_object_by_name=function(a,b){var c=h.rd(h.sf,a,b|0);if(c)return c;g.error("get object "+a+": not found")};a.get_object_by_dupli_name=function(a,b,c){if(a=h.rd(h.$k,a,b,c|0))return a;g.error("get object "+b+": not found")};a.get_object_by_dupli_name_list=function(a,b){var c=h.rd(h.al,a,b|0);if(c)return c;g.error("get object "+a+": not found")};a.get_object_data_id=function(a){return h.get_object_data_id(a)};a.pick_object=h.pick_object;a.outlining_is_enabled=function(a){return a&&a.d&&
a.d.Fb};a.set_outline_intensity=function(a,b){a&&a.d&&a.d.Fb?a.d.$c=b:g.error("set_outline_intensity(): wrong object")};a.get_outline_intensity=function(a){if(a&&a.d&&a.d.Fb)return a.d.$c;g.error("get_outline_intensity(): wrong object")};a.apply_outline_anim=function(a,b,c,d){a&&a.d&&a.d.Fb?h.apply_outline_anim(a,b,c,d):g.error("apply_outline_anim(): wrong object")};a.apply_outline_anim_def=function(a){if(a&&a.d&&a.d.Fb){var b=a.d.Ei;h.apply_outline_anim(a,b.pk,b.qk,b.rk)}else g.error("apply_outline_anim_def(): wrong object")};
a.clear_outline_anim=function(a){a&&a.d&&a.d.Fb?h.clear_outline_anim(a):g.error("clear_outline_anim(): wrong object")};a.set_outline_color=h.set_outline_color;a.get_outline_color=function(a){var b=h.get_active();if(b=h.ca(b,"OUTLINE"))return a=a||new Float32Array(3),a.set(b.Ue),a};a.set_glow_intensity=function(b,c){g.error("set_glow_intensity() deprecated, use set_outline_intensity() instead");a.set_outline_intensity(b,c)};a.get_glow_intensity=function(b){g.error("get_glow_intensity() deprecated, use get_outline_intensity() instead");
a.get_outline_intensity(b)};a.apply_glow_anim=function(b,c,d,e){g.error("apply_glow_anim() deprecated, use apply_outline_anim() instead");a.apply_outline_anim(b,c,d,e)};a.apply_glow_anim_def=function(b){g.error("apply_glow_anim_def() deprecated, use apply_outline_anim_def() instead");a.apply_outline_anim_def(b)};a.clear_glow_anim=function(b){g.error("clear_glow_anim() deprecated, use clear_outline_anim() instead");a.clear_outline_anim(b)};a.set_glow_color=function(b){g.error("set_glow_color() deprecated, use set_outline_color() instead");
a.set_outline_color(b)};a.get_glow_color=function(b){g.error("get_glow_color() deprecated, use get_outline_color() instead");a.get_outline_color(b)};a.get_shadow_params=function(){if(!h.ha())return g.error("No active scene"),!1;var a=h.get_active(),b=h.ca(a,"SHADOW_CAST");if(!b)return null;var c=a.d.wd,d=h.ca(a,"MAIN_OPAQUE"),e=h.ca(a,"DEPTH"),f={};f.csm_resolution=c.csm_resolution;f.self_shadow_polygon_offset=b.self_shadow_polygon_offset;e&&(f.self_shadow_normal_offset=e.self_shadow_normal_offset);
f.enable_csm=c.enable_csm;f.csm_num=c.csm_num;f.csm_first_cascade_border=c.csm_first_cascade_border;f.first_cascade_blur_radius=c.first_cascade_blur_radius;f.csm_last_cascade_border=c.csm_last_cascade_border;f.last_cascade_blur_radius=c.last_cascade_blur_radius;f.fade_last_cascade=c.fade_last_cascade;f.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(f.csm_borders=h.by(a,d.i),f.blur_radii=new Float32Array(c.csm_num),f.blur_radii.set(d.i.xk.subarray(0,c.csm_num))):(f.csm_borders=null,
f.blur_radii=null);return f};a.set_shadow_params=function(a){if(!h.ha())return g.error("No active scene"),!1;var e=h.get_active();"number"==typeof a.self_shadow_polygon_offset&&c.O(e.d.fb,function(b,c){"SHADOW_CAST"===c.type&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var f=h.ca(e,"DEPTH");f&&("number"==typeof a.self_shadow_normal_offset&&(f.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(f.pcf_blur_radius=a.pcf_blur_radius));var n=h.ca(e,
"MAIN_BLEND");n&&("number"==typeof a.self_shadow_normal_offset&&(n.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(n.pcf_blur_radius=a.pcf_blur_radius),n.ja=!0);n=e.d.wd;"number"==typeof a.csm_first_cascade_border&&(n.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(n.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(n.csm_last_cascade_border=a.csm_last_cascade_border);
"number"==typeof a.last_cascade_blur_radius&&(n.last_cascade_blur_radius=a.last_cascade_blur_radius);if(f){for(var p=f.p,q=0;q<p.length;q++){var E=p[q];E.td.Yb&&(E=E.B,b.nl(E,n),b.rb(E))}f.ja=!0}f=e.camera.d.G;for(q=0;q<f.length;q++)d.ho(f[q],n);h.Fn(e)};a.get_environment_colors=function(){if(!h.ha())return g.error("No active scene"),!1;var a=h.get_active();return h.get_environment_colors(a)};a.set_environment_colors=function(a,b,c){if(!h.ha())return g.error("No active scene"),!1;var d=h.get_active();
h.set_environment_colors(d,parseFloat(a),b,c)};a.get_fog_color_density=function(a){if(!h.ha())return g.error("No active scene"),!1;var b=h.get_active();return h.get_fog_color_density(b,a)};a.set_fog_color_density=function(a){if(!h.ha())return g.error("No active scene"),!1;var b=h.get_active();h.set_fog_color_density(b,a)};a.get_ssao_params=function(){if(!h.ha())return g.error("No active scene"),!1;var a=h.get_active();return h.get_ssao_params(a)};a.set_ssao_params=function(a){if(!h.ha())return g.error("No active scene"),
!1;var b=h.get_active();h.set_ssao_params(b,a)};a.get_color_correction_params=function(){if(!h.ha())return g.error("No active scene"),null;var a=h.get_active(),a=h.ca(a,"COMPOSITING");if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.set_color_correction_params=function(a){if(!h.ha())return g.error("No active scene"),null;var b=h.get_active(),b=h.ca(b,"COMPOSITING");if(!b)return null;"number"==typeof a.brightness&&
(b.brightness=a.brightness);"number"==typeof a.contrast&&(b.contrast=a.contrast);"number"==typeof a.exposure&&(b.exposure=a.exposure);"number"==typeof a.saturation&&(b.saturation=a.saturation);b.ja=!0};a.get_sky_params=function(){if(!h.ha())return g.error("No active scene"),!1;var a=h.get_active();return h.get_sky_params(a)};a.set_sky_params=function(a){if(!h.ha())return g.error("No active scene"),!1;var b=h.get_active();h.set_sky_params(b,a)};a.get_dof_params=function(){if(!h.ha())return g.error("No active scene"),
!1;var a=h.get_active();return h.ca(a,"DOF")?h.get_dof_params(a):null};a.set_dof_params=function(a){if(!h.ha())return g.error("No active scene"),!1;var b=h.get_active();h.set_dof_params(b,a)};a.get_god_rays_params=function(){if(!h.ha())return g.error("No active scene"),!1;var a=h.get_active();return h.ca(a,"GOD_RAYS")?h.get_god_rays_params(a):null};a.set_god_rays_params=function(a){if(!h.ha())return g.error("No active scene"),!1;var b=h.get_active();h.set_god_rays_params(b,a)};a.get_bloom_params=
function(){if(!h.ha())return g.error("No active scene"),!1;var a=h.get_active();return h.ca(a,"BLOOM")?h.get_bloom_params(a):null};a.set_bloom_params=function(a){if(!h.ha())return g.error("No active scene"),!1;var b=h.get_active();h.set_bloom_params(b,a)};a.get_glow_material_params=function(){if(!h.ha())return g.error("No active scene"),!1;var a=h.get_active();return h.ca(a,"GLOW_COMBINE")?h.get_glow_material_params(a):null};a.set_glow_material_params=function(a){if(!h.ha())return g.error("No active scene"),
!1;var b=h.get_active();h.set_glow_material_params(b,a)};a.get_wind_params=function(){return h.get_wind_params()};a.set_wind_params=function(a){if(!h.ha())return g.error("No active scene"),!1;var b=h.get_active();h.set_wind_params(b,a)};a.get_water_surface_level=h.get_water_surface_level;a.set_water_params=function(a){if(!h.ha())return g.error("No active scene"),!1;var b=h.get_active();h.set_water_params(b,a)};a.get_water_mat_params=function(a){if(!h.ha())return g.error("No active scene"),!1;var b=
h.get_active();h.get_water_mat_params(b,a)};a.update_scene_materials_params=function(){if(!h.ha())return g.error("No active scene"),!1;var a=h.get_active();h.gt(a)};a.hide_object=function(a){e.ti(a)||p.ck(a)?h.hide_object(a):g.error("show/hide is only supported for dynamic meshes/empties")};a.show_object=function(a){e.ti(a)||p.ck(a)?h.show_object(a):g.error("show/hide is only supported for dynamic meshes/empties")};a.is_hidden=function(a){if(e.ti(a)||p.ck(a))return h.is_hidden(a);g.error("show/hide is only supported for dynamic meshes/empties");
return!1};a.is_visible=function(a){return a.d.is_visible};a.check_object=function(a){return h.ha()?h.check_object(a,h.get_active()):(g.error("No active scene"),!1)};a.check_object_by_name=function(a,b){return h.rd(h.sf,a,b|0)?!0:!1};a.check_object_by_dupli_name=function(a,b,c){return h.rd(h.$k,a,b,c|0)?!0:!1};a.check_object_by_dupli_name_list=function(a,b){return h.rd(h.al,a,b|0)?!0:!1};a.get_all_objects=function(a,b){var c=h.get_active();a||(a="ALL");b||0===b||(b=h.DATA_ID_ALL);return h.Ia(c,a,b)};
a.get_object_name=function(a){return a?a.name:(g.error("Wrong object name"),"")};a.get_object_type=function(a){return a&&a.type?a.type:(g.error("Wrong object"),"UNDEFINED")};a.get_object_dg_parent=function(a){return a.za};a.get_object_children=function(a){return a.Ic.slice(0)};a.get_first_character=function(){for(var a=h.Ia(h.get_active(),"MESH",h.DATA_ID_ALL),b=0;b<a.length;b++){var c=a[b];if(f.is_character(c))return c}return null};a.get_shore_dist=function(a,b){b||0===b||(b=1);return h.get_shore_dist(a,
b)};a.get_cam_water_depth=function(){return h.get_cam_water_depth()};a.get_type_mesh_object=function(a){return"MESH"==a.type?a.d.type:null};a.get_meta_tags=function(){if(!h.ha())return g.error("No active scene"),!1;var a=h.get_active();return h.get_meta_tags(a)};a.append_object=function(a){if(!a.d.Pm)return g.error('object "'+a.name+'" has been created not by coping.'),!1;var b=a.name;if(h.rd(h.sf,a.name,0))for(var c=1;;){b=a.name+(3>String(c).length?"."+("000"+String(c)).slice(-3):"."+String(c));
if(!h.rd(h.sf,b,0)){a.name=b;g.error('object "'+a.name+'" already exists. Name was replaced by "'+b+'".');break}c++}h.append_object(h.get_active(),a,!0)};a.remove_object=function(a){h.remove_object(a)||g.error('object "'+a.name+'" was not copied.')};a.marker_frame=function(a){var b=h.get_active();if(b.timeline_markers&&a in b.timeline_markers)return h.marker_frame(b,a);g.error('"'+a+'" marker not found.');return 0};a.get_mb_params=function(){var a=h.get_active();return(a=h.ca(a,"MOTION_BLUR"))?{mb_factor:a.mb_factor,
mb_decay_threshold:a.mb_decay_threshold}:null};a.set_mb_params=function(a){var b=h.get_active();(b=h.ca(b,"MOTION_BLUR"))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):g.error("The motion blur subscene doesn't exist.")}};b4w.module.sfx=function(a,q){var b=q("__scenes"),d=q("__sfx"),c=q("__print");a.play=function(a,b,c){d.play(a,b,c)};a.play_def=function(a){d.play_def(a)};a.is_play=function(a){return d.is_play(a)};a.speaker_play=function(a,b,f,h){c.error("speaker_play() deprecated, use play() or play_def() instead");d.cyclic(a,b);h&&d.playrate(a,h);d.play(a,0,f)};a.speaker_stop=function(a){c.error("speaker_stop() deprecated, use stop() instead");d.stop(a)};a.stop=function(a){d.stop(a)};a.pause=function(a){d.NA(a)};
a.resume=function(a){d.PA(a)};a.speaker_playback_rate=function(a,b){c.error("speaker_playback_rate() deprecated, use playrate() instead");d.playrate(a,b)};a.playrate=function(a,b){d.playrate(a,b)};a.get_playrate=function(a){return d.get_playrate(a)};a.cyclic=function(a,b){d.cyclic(a,b)};a.is_cyclic=function(a){return d.is_cyclic(a)};a.listener_reset_speed=function(a,b){d.listener_reset_speed(a,b)};a.speaker_reset_speed=function(a,b,c){d.speaker_reset_speed(a,b,c)};a.get_volume=function(a){return a&&
"object"===typeof a?d.get_volume(a):d.iy()};a.set_volume=function(a,b){a&&"object"===typeof a?d.set_volume(a,b):d.sA(b)};a.mute=function(a,b){a&&"object"===typeof a?d.mute(a,b):d.mz(b)};a.is_muted=function(a){return a&&"object"===typeof a?d.is_muted(a):d.Ry()};a.get_speaker_objects=function(){return d.get_speaker_objects().slice(0)};a.get_speakers=function(){c.error("get_speakers() deprecated, use get_speaker_objects() instead");return a.get_speaker_objects()};a.check_active_speakers=d.check_active_speakers;
a.set_compressor_params=function(a){d.set_compressor_params(b.get_active(),a)};a.get_compressor_params=function(){return d.get_compressor_params(b.get_active())};a.duck=function(a,b,c){a&&"object"===typeof a?d.duck(a,b,c):d.gx(b,c)};a.unduck=function(a){a&&"object"===typeof a?d.unduck(a):d.tB()};a.apply_playlist=d.apply_playlist;a.clear_playlist=d.clear_playlist;a.detect_audio_container=d.detect_audio_container;a.detect_video_container=d.detect_video_container;a.set_positional_params=d.set_positional_params;
a.get_positional_params=d.get_positional_params;a.set_filter_params=d.set_filter_params;a.get_filter_params=d.get_filter_params;a.get_filter_freq_response=d.get_filter_freq_response;a.get_duration=function(a){if(a&&d.ge(a))return d.get_duration(a);c.error('Object "'+(a?a.name:void 0)+'" is not a valid speaker')}};b4w.module.shaders=function(a,q){function b(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ /))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];break;default:a+=b[e]}b.ALU_OPS=a;b.TEX_OPS=c;return b}function d(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);
c.send(b);if(200==c.status)return c.responseText;throw"Error POST XHR: "+c.status;}function c(a){for(var b=h.ri(),c=0;c<b.length;c++)for(var d=h.Ia(b[c],"MESH",h.DATA_ID_ALL),e=0;e<d.length;e++){var f=d[e];if(f.n)for(var g=0;g<f.n.length;g++){var p=f.n[g];if(p.Xb==a&&p.Pc.length)return p.Pc}}return null}function e(a){a.sort(function(a,b){return b.tm.ALU_OPS-a.tm.ALU_OPS});for(var b=0;b<a.length;b++){var d=a[b],e=d.tm,f=d.jC,h=c(d.Pw),h=h?"\t\t("+h.join(", ")+")":"\t\t(NA)";g.groupCollapsed("FRAG --\x3e",
"ALU",e.ALU_OPS,"TEX",e.TEX_OPS,"\t\tVERT --\x3e","ALU",f.ALU_OPS,"TEX",f.TEX_OPS,h);g.groupCollapsed("directives");for(var h=d.pb.Ie,p=0;p<h.length;p++){var q=h[p];g.log(q[0],q[1])}g.groupEnd();g.groupCollapsed("vert src");g.log(d.iC);g.groupEnd();g.groupCollapsed("vert stats");for(var u in f)"ALU_OPS"!=u&&"TEX_OPS"!=u&&g.log(u,f[u]);g.groupEnd();g.groupCollapsed("frag src");g.log(d.Ex);g.groupEnd();g.groupCollapsed("frag stats");for(u in e)"ALU_OPS"!=u&&"TEX_OPS"!=u&&g.log(u,e[u]);g.groupEnd();
g.groupEnd()}}q("__config");var g=q("__print"),f=q("__extensions"),h=q("__scenes"),p=q("__shaders");q("__util");a.report_repeatful_compilation=function(){var a=p.Tw(),b=0,c;for(c in a){var d=a[c],e=d.count;1<e&&g.log(e-1,d.FE,d.WD);b+=e-1}g.log("TOTAL OVERHEAD:",b);return"OK"};a.analyze=function(a){var c=p.qq(),h=0,n;for(n in c)a&&-1===n.indexOf(a)||h++;var h="of "+h+" analyzing...",q={};for(n in c)if(!a||-1!==n.indexOf(a)){var v=c[n],E;var x=v.po;E=v.iq;var u=f.rq();if(u){x=u.getTranslatedShaderSource(x);
E=u.getTranslatedShaderSource(E);var u=d("/nvidia_vert",x),B=b(u),t=d("/nvidia_frag",E),G=b(t);E={iC:x,RE:u,jC:B,Ex:E,AD:t,tm:G}}else g.error("WEBGL_debug_shaders not found (run Chrome with --enable-privileged-webgl-extensions)"),E=void 0;u=v.pb;x=u.bj+" + "+u.mi;E.Pw=v;E.pb=u;v=q[x]=q[x]||[];v.push(E);g.log(h)}for(x in q)g.group("%c"+x,"color: #800"),v=q[x],e(v),g.groupEnd()}};b4w.module.textures=function(a,q){var b=q("__textures"),d=q("__print");a.get_canvas_texture_context=function(a,e){e||(e=0);var g=b.Zx(a,e);if(g)return g;d.error('Canvas texture with ID "'+a+'" not found!')};a.update_canvas_texture_context=function(a,e){e||(e=0);b.DB(a,e)||d.error('Canvas texture with ID "'+a+'" not found!')};a.play_video=function(a,e){e||(e=0);b.play_video(a,e)||d.error('Texture with name "'+a+'" not found!')};a.pause_video=function(a,e){e||(e=0);b.pause_video(a,e)||d.error('Texture with name "'+
a+'" not found!')};a.reset_video=function(a,e){e||(e=0);b.reset_video(a,e)||d.error('Texture with name "'+a+'" not found!')}};b4w.module.time=function(a,q){var b=q("__time");a.set_timeout=b.set_timeout;a.clear_timeout=b.clear_timeout;a.get_timeline=b.get_timeline;a.animate=b.animate};b4w.module.transform=function(a,q){var b=q("__print"),d=q("__physics"),c=q("__transform"),e=q("__util"),g=q("__objects"),f=new Float32Array(3),h=new Float32Array(4);a.SPACE_LOCAL=c.SPACE_LOCAL;a.SPACE_WORLD=c.SPACE_WORLD;a.set_translation=function(a,e,h,q){g.cc(a)?(f[0]=e,f[1]=h,f[2]=q,c.set_translation(a,f),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_v=function(a,e){g.cc(a)?(c.set_translation(a,e),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.set_translation_rel=function(a,h,m,q,n){g.cc(a)?(f[0]=h,f[1]=m,f[2]=q,e.transform_vec3(f,1,n.d.quat,n.d.h,f),c.set_translation(a,f),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_translation=function(a,b){b||(b=new Float32Array(3));c.get_translation(a,b);return b};a.set_rotation=function(a,e,f,q,n){g.cc(a)?(h[0]=e,h[1]=f,h[2]=q,h[3]=n,c.set_rotation(a,h),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.set_rotation_quat=function(){b.error("set_rotation_quat() deprecated, use set_rotation() instead");return a.set_rotation};a.set_rotation_v=function(a,e){g.cc(a)?(c.set_rotation(a,e),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_quat_v=function(){b.error("set_rotation_quat_v() deprecated, use set_rotation_v() instead");return a.set_rotation_v};a.get_rotation=function(a,b){b||(b=new Float32Array(4));c.get_rotation(a,b);return b};a.get_rotation_quat=
function(){b.error("get_rotation_quat() deprecated, use get_rotation() instead");return a.get_rotation};a.set_rotation_euler=function(a,e,h,q){g.cc(a)?(f[0]=e,f[1]=h,f[2]=q,c.set_rotation_euler(a,f),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_v=function(a,e){g.cc(a)?(c.set_rotation_euler(a,e),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale=function(a,d){g.cc(a)?(c.set_scale(a,d),c.u(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.get_scale=function(a){return c.get_scale(a)};a.empty_reset_transform=function(a){if("EMPTY"!=a.type)return b.error("Wrong object: "+a.name),!1;for(var e=0;e<a.Ic.length;e++)if(!g.cc(a.Ic[e])){b.error('Wrong object: "'+a.Ic[e].name+'" is not dynamic.');return}c.set_translation(a,[0,0,0]);c.set_rotation(a,[0,0,0,1]);c.set_scale(a,1);c.u(a);d.sync_transform(a)};a.get_object_size=function(a){return e.is_mesh(a)?c.get_object_size(a):(b.error("Wrong object: "+a.name),0)};
a.get_object_center=function(a,d,f){return e.is_mesh(a)?c.get_object_center(a,d,f):(b.error("Wrong object: "+a.name),null)};a.move_local=function(a,e,f,h){g.cc(a)?(c.move_local(a,e,f,h),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_object_bounding_box=function(a){return c.get_object_bounding_box(a)};a.get_tsr=function(a,d){d||(d=new Float32Array(8));if(g.cc(a))return c.get_tsr(a,d),d;b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_tsr=function(a,
e){g.cc(a)?(c.set_tsr(a,e),c.u(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.distance=function(a,b){return c.distance(a,b)}};b4w.module.tsr=function(a,q){q("__print");var b=q("__tsr");a.create=b.create;a.from_values=b.from_values;a.copy=b.copy;a.identity=b.identity;a.create_sep=b.create_sep;a.set_sep=b.set_sep;a.set_trans=b.set_trans;a.set_scale=b.set_scale;a.set_transcale=b.set_transcale;a.set_quat=b.set_quat;a.get_trans_view=b.get_trans_view;a.get_scale=b.get_scale;a.get_quat_view=b.get_quat_view;a.invert=b.invert;a.to_mat4=function(a,c){c||(c=new Float32Array(16));b.to_mat4(a,c);return c};a.from_mat4=b.from_mat4;a.multiply=
b.multiply;a.transform_vec3=b.transform_vec3;a.transform_vec3_inv=b.transform_vec3_inv;a.transform_vectors=b.transform_vectors;a.transform_dir_vectors=b.transform_dir_vectors;a.transform_dir_vec3=b.transform_dir_vec3;a.transform_tangents=b.transform_tangents;a.translate=b.translate;a.interpolate=b.interpolate};b4w.module.util=function(a,q){var b=q("__print"),d=q("__util"),c=q("vec3");q("mat4");a.AXIS_X=new Float32Array([1,0,0]);a.AXIS_Y=new Float32Array([0,1,0]);a.AXIS_Z=new Float32Array([0,0,1]);a.AXIS_MX=new Float32Array([-1,0,0]);a.AXIS_MY=new Float32Array([0,-1,0]);a.AXIS_MZ=new Float32Array([0,0,-1]);a.f32=function(a){return new Float32Array(a||0)};a.assert=d.assert;a.keyfind=d.keyfind;a.keysearch=d.keysearch;a.matrix_to_quat=function(a){return d.matrix_to_quat(a)};a.euler_to_quat=function(a,b){b||
(b=new Float32Array(4));return d.euler_to_quat(a,b)};a.quat_to_euler=function(a,b){b||(b=new Float32Array(3));return d.quat_to_euler(a,b)};a.sign=d.sign;a.clamp=d.clamp;a.quat_to_dir=d.quat_to_dir;a.ground_project_quat=function(a,b){return d.quat_project(a,d.AXIS_MY,d.AXIS_Y,d.AXIS_MZ,b)};a.cam_quat_to_mesh_quat=function(a,b){return d.cam_quat_to_mesh_quat(a,b)};a.quat_project=function(a,g,f,h,p){return 0!=c.dot(f,h)?(b.error("Wrong in-plane direction"),null):d.quat_project(a,g,f,h,p)};a.hash_code=
d.hash_code;a.smooth=d.smooth;a.smooth_v=d.smooth_v;a.is_vector=d.is_vector;a.correct_cam_quat_up=d.correct_cam_quat_up;a.quat_to_angle_axis=d.quat_to_angle_axis;a.random_from_array=d.random_from_array;a.xz_direction=d.xz_direction;a.line_plane_intersect=d.line_plane_intersect;a.is_mesh=d.is_mesh;a.is_armature=d.is_armature;a.angle_wrap_0_2pi=d.angle_wrap_0_2pi;a.angle_wrap_periodic=d.angle_wrap_periodic;a.smooth_step=d.smooth_step};"object"==typeof module&&module.hm&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,q){var b=q("__version");a.version=b.version;a.version_str=b.version_str;a.type=b.type;a.date=b.date;a.date_str=b.date_str};"object"==typeof module&&module.hm&&b4w.module.version(exports);b4w.module.objects=function(a,q){var b=q("__objects"),d=q("__print"),c=q("__util"),e=q("__scenes"),g=q("__geometry");a.get_meta_tags=function(a){if(a&&a.b4w_object_tags)return b.get_meta_tags(a)};a.copy=function(a,h,p){return c.is_mesh(a)?a.Io?(d.error('object "'+a.name+'" is meta-object.'),!1):b.cc(a)?g.si(a)||g.check_shape_keys(a)||!p?-1==e.Ia(e.get_active(),"MESH",e.DATA_ID_ALL).indexOf(a)?(d.error('object "'+a.name+'" does not belong to the active scene.'),!1):b.copy(a,h||"",p):(d.error('object "'+
a.name+'" has not dynamic geometry for deep copying.'),!1):(d.error('object "'+a.name+'" is not dynamic.'),!1):(d.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.set_nodemat_value=function(a,e,g){if(!c.is_mesh(a))return d.error('The type of the object "'+a.name+'" is not "MESH".'),null;e=e.join("%join%");var l=b.ry(a,e);null!=l?a.d.ie[l]=g:d.error('The Value node "'+e+'" was not found in the object "'+a.name+'".')};a.set_nodemat_rgb=function(a,e,g,l,m){if(!c.is_mesh(a))return d.error('The type of the object "'+
a.name+'" is not "MESH".'),null;e=e.join("%join%");var q=b.ly(a,e);null!=q?(a.d.tc[q]=g,a.d.tc[q+1]=l,a.d.tc[q+2]=m):d.error('The RGB node "'+e+'" was not found in the object "'+a.name+'".')}};b4w.module.main=function(a,q){function b(){}function d(){}function c(){}function e(){window.performance||(x.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(x.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});O.rs(0)}function g(a,b){a.addEventListener("webglcontextlost",function(a){a.preventDefault();x.error("WebGL context lost");h()},!1);A.bd(b);var c=A.xq();c&&x.log("%cRENDERER INFO:","color: #00a",
b.getParameter(c.UNMASKED_VENDOR_WEBGL)+", "+b.getParameter(c.UNMASKED_RENDERER_WEBGL));P.bd(b);k.bd(b);K.bd(b);H.bd(b);G.bd(b);t.BA(a);u.init(a);z.ts(a.width,a.height,1);N.init();d=r();l()}function f(){b=function(){}}function h(){p()||(ba=performance.now()/1E3,N.pause(),J.pause(),K.pause(),n.pause())}function p(){return ma<ba}function l(){T(l);var a=performance.now()/1E3;w||(w=a);var b=a-w;if(!(b<1/ha.Zc)){for(var c=O.get_timeline(),e=0;e<W.length;e++)W[e](c,b);p()||(ma>w&&(b-=ma-Math.max(ba,w)),
c+=b,O.rs(c),G.update(),L.update(),t.update(),m(c,b),d(b));w=a}}function m(a,c){t.is_primary_loaded()&&(I.reset(),X.update(c),F.update(a,c),N.update(a,c),c&&y.update(c),t.is_primary_loaded()&&(J.update(a,c),t.is_primary_loaded()&&(b(c,a),t.is_primary_loaded()&&(B.update(a,c),t.is_primary_loaded()&&(n.update(),z.update(a,c),n.QB(),ia&&(ia(ka.toDataURL()),ia=null))))))}function r(){var a=60,b=0,d=ha.gq,e=ha.yx;return function(f){f<1/ha.Zc||(a=aa.smooth(1/f,a,f,d),f=J.gy(),b=(b+1)%e,0==b&&c(Math.round(a),
f))}}var n=q("__anchors"),y=q("__animation"),v=q("__compat"),E=q("__config"),x=q("__print"),u=q("__container"),B=q("__controls"),t=q("__data"),G=q("__debug"),A=q("__extensions"),k=q("__geometry"),I=q("__hud"),F=q("__nla"),L=q("__assets"),J=q("__physics"),P=q("__renderer"),z=q("__scenes"),N=q("__sfx"),H=q("__shaders"),K=q("__textures"),O=q("__time"),X=q("__transform"),aa=q("__util"),Z=q("__version"),Q=E.context,ha=E.o,ka=null,qa=null,w=0,ba=0,ma=0,W=[],ia=null,ga=["webgl","experimental-webgl"],pa=
null,T=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/ha.Zc)}}();a.init=function(a,b){E.tA();x.xA(ha.console_verbose);var c=Z.version_str()+" "+Z.type()+" ("+Z.date_str()+")";x.log("%cINIT ENGINE","color: #00a",c);if(!window.WebGLRenderingContext)return null;e();ka=a;v.mv();for(var c=null,d=0;d<ga.length;d++){var f=ga[d];try{c=
a.getContext(f,Q)}catch(h){}if(c)break}v.cx(c);if(!c)return null;pa=c;g(ka,c);E.ov();v.nA(c);ha.Lm&&(a.style["touch-action"]="none");x.log("%cSET PRECISION:","color: #00a",ha.precision);b?(I.init(b),qa=b):(E.o.show_hud_debug_info=!1,E.cd.jk=!1);return c};a.set_check_gl_errors=function(a){G.set_check_gl_errors(a)};a.resize=function(a,b,c){!1!==c&&(ka.style.width=a+"px",ka.style.height=b+"px",qa&&(qa.style.width=a+"px",qa.style.height=b+"px"));qa&&(qa.width=a,qa.height=b,I.Ih());if(navigator.userAgent.match(/iPhone/i)||
navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))ha.canvas_resolution_factor=1;c=Math.floor(a*ha.canvas_resolution_factor);b=Math.floor(b*ha.canvas_resolution_factor);ha.allow_hidpi&&1<window.devicePixelRatio&&(c*=window.devicePixelRatio,b*=window.devicePixelRatio);ka.width=c;ka.height=b;if(c>pa.drawingBufferWidth||b>pa.drawingBufferHeight){x.warn("Canvas size exceeds platform limits, downscaling");var d=Math.min(pa.drawingBufferWidth/c,pa.drawingBufferHeight/b);c*=d;b*=d;ka.width=
c;ka.height=b}z.ts(c,b,c/a);z.ha()&&X.u(z.get_active().camera);m(O.get_timeline(),0);t.HB(ka.width,ka.height)};a.set_fps_callback=function(a){c=a};a.clear_fps_callback=function(){c=function(){}};a.set_render_callback=function(a){b=a};a.clear_render_callback=function(){f()};a.global_timeline=function(){return O.get_timeline()};a.redraw=function(){x.error("redraw() deprecated");m(O.get_timeline(),0)};a.pause=h;a.resume=function(){p()&&(ma=performance.now()/1E3,N.resume(),J.resume(),K.play(!0),n.resume())};
a.is_paused=p;a.reset=function(){t.unload(0);qa=ka=null;ma=ba=w=0;c=function(){};d=function(){};b=function(){};W.length=0;pa=null;O.reset()};a.canvas_data_url=function(a){ia=a};a.get_canvas_elem=function(){return ka};a.detect_mobile=function(){return v.detect_mobile()};a.append_loop_cb=function(a){for(var b=0;b<W.length;b++)if(W[b]==a)return;W.push(a)};a.remove_loop_cb=function(a){for(var b=0;b<W.length;b++)if(W[b]==a){W.splice(b,1);break}}};b4w.module.nla=function(a,q){var b=q("__nla"),d=q("__time"),c=q("__print"),e=q("__util");a.set_frame=function(a){a=e.clamp(a,b.get_frame_start(),b.get_frame_end());b.check_nla_scripts()?c.error("The active scene is using NLA script."):b.set_frame(a,d.get_timeline())};a.get_frame=function(){return b.get_frame(d.get_timeline())};a.stop=function(){b.check_nla_scripts()?c.error("The active scene is using NLA script."):b.ZA()};a.play=function(a){b.check_nla_scripts()?c.error("The active scene is using NLA script."):
b.Bz(a)};a.is_play=function(){return b.is_play()};a.get_frame_start=function(){return b.get_frame_start()};a.get_frame_end=function(){return b.get_frame_end()};a.check_nla=function(){return b.check_nla()};a.check_nla_scripts=function(){return b.check_nla_scripts()};a.set_range=function(a,d){b.check_nla_scripts()?c.error("The active scene is using NLA script."):(d=parseFloat(d)||b.get_frame_end(),a=parseFloat(a)||b.get_frame_end(),d=e.clamp(d,b.get_frame_start(),b.get_frame_end()),a=e.clamp(a,b.get_frame_start(),
d),b.set_range(a,d))};a.reset_range=function(){b.check_nla_scripts()?c.error("The active scene is using NLA script."):b.reset_range()};a.set_cyclic=function(a){b.check_nla_scripts()?c.error("The active scene is using NLA script."):b.set_cyclic(a)};a.clear_callback=function(){b.check_nla_scripts()?c.error("The active scene is using NLA script."):b.clear_callback()}};
